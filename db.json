{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/404.html","path":"404.html","modified":1,"renderable":1},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1}],"Cache":[{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1493040666261},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1493040666261},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1493040666261},{"_id":"themes/next/.gitignore","hash":"32ea93f21d8693d5d8fa4eef1c51a21ad0670047","modified":1493040666262},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1493040666262},{"_id":"themes/next/.javascript_ignore","hash":"f9ea3c5395f8feb225a24e2c32baa79afda30c16","modified":1493040666262},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1493040666262},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1493040666262},{"_id":"themes/next/.travis.yml","hash":"c42d9608c8c7fe90de7b1581a8dc3886e90c179e","modified":1493040666262},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1493040666262},{"_id":"themes/next/README.en.md","hash":"4ece25ee5f64447cd522e54cb0fffd9a375f0bd4","modified":1493040666262},{"_id":"themes/next/README.md","hash":"500b5606eb6a09c979d16128f8b00f4bf9bc95ac","modified":1493040666262},{"_id":"themes/next/_config.yml","hash":"75d9d4657a90166906ca0da4d9a63f8870924385","modified":1493089301751},{"_id":"themes/next/bower.json","hash":"be0a430362cb73a7e3cf9ecf51a67edf8214b637","modified":1493040666262},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1493040666262},{"_id":"themes/next/package.json","hash":"7e87b2621104b39a30488654c2a8a0c6a563574b","modified":1493040666266},{"_id":"source/_posts/001.md","hash":"67e5682c3f6b4819582a9ad338b6620002df1d4a","modified":1493044342571},{"_id":"source/_posts/AWS-1-Use-s3cmd命令行管理S3存储.md","hash":"93825c9632fb4157ff4c5f679a50ba3b925956b0","modified":1493046076249},{"_id":"source/_posts/Azure-2-HowTo-Use-Azure-CLI-on-Mac.md","hash":"0b89017ff001427407a2c743101c7cbaab68bb5b","modified":1493046076249},{"_id":"source/_posts/Azure-3-HowTo-Use-Azure-CLI-on-Mac.md","hash":"3a0aa98c63fdc2584e14e4978590c4978aae4562","modified":1493046076249},{"_id":"source/_posts/Azure-4-创建和使用Azure-Redis-Cache.md","hash":"2ade652f5f637f972de5c01d867038699c2ee5d2","modified":1493046076249},{"_id":"source/_posts/CentOS-6-1-使用createrepo搭建本地源.md","hash":"d0519c6baf0fb8f3676ec5ef0146957470013402","modified":1493046076249},{"_id":"source/_posts/CentOS-6-2-初始安装基本优化操作.md","hash":"5921498703e037e45636eedd40dcb80d6c6369e5","modified":1493046076249},{"_id":"source/_posts/CentOS-7-1-修改系统主机名.md","hash":"a091806196b906ecc7d3312a4f2c407e013c2626","modified":1493046076249},{"_id":"source/_posts/CentOS-7-2-系统服务管理方式.md","hash":"e4f423d3848994bae8eb2364a1445124189c5456","modified":1493046076249},{"_id":"source/_posts/CentOS增加新硬盘给根文件系统扩容.md","hash":"141323202249d4e8807612c02f631376e06b95df","modified":1493046305636},{"_id":"source/_posts/Denyhosts增加服务器SSH黑名单机制.md","hash":"01355c68802c347ae28523e6ba77ce723d6de724","modified":1493046076249},{"_id":"source/_posts/Docker-Hub-国内加速.md","hash":"e9b62c4d232d0c4e1124776d01d8b52dc8e9be62","modified":1493046076249},{"_id":"source/_posts/Ghost-2-增加评论模块.md","hash":"8e5c03be646cb8c82562b39f5b13a1963b9327ba","modified":1493046076249},{"_id":"source/_posts/Hello-2016.md","hash":"105d9f05da5bd754eb86cf01616311fd3cba06d3","modified":1493044342571},{"_id":"source/_posts/Hey-Friends.md","hash":"543b3498b826144d43f937237e02bcffd2e8ec75","modified":1493044342571},{"_id":"source/_posts/HowTo-Add-Piwik-Tracking-to-Ghost.md","hash":"0e6e25b4f71bdc1dd53eeba62617672fda0ef89e","modified":1493046076249},{"_id":"source/_posts/HowTo-Automatic-Updates-CENTOS-RHEL-Using-YUM.md","hash":"5f78dc75c189e56678fb5d2ef276144d6f642952","modified":1493046076249},{"_id":"source/_posts/HowTo-Install-CloudStack-4-8-on-CentOS-6-x.md","hash":"83d2c6cf7a43bc08bca4b313e0587f85298d2132","modified":1493046076249},{"_id":"source/_posts/HowTo-Install-Docker-on-CentOS-6-x.md","hash":"aacef6b39860789b399ec7348a0375bf4c905562","modified":1493046076249},{"_id":"source/_posts/HowTo-Install-Fabric-on-CentOS-7-x.md","hash":"7460b60762b093afcfedbf10d5f9227ddacd3aec","modified":1493046076249},{"_id":"source/_posts/HowTo-Install-GitLab.md","hash":"ee1d575efdabe2183f017e4db2d1a2be31e78137","modified":1493046076250},{"_id":"source/_posts/HowTo-Install-KVM-Manage-Server-webvirtmgr.md","hash":"74038738b0e1304a69005ce86022e6c246003765","modified":1493046076302},{"_id":"source/_posts/HowTo-Install-LNMP-on-CentOS-6-x.md","hash":"928db210c67aa93c25571b32bd1ecc75ccc42a9f","modified":1493046076302},{"_id":"source/_posts/HowTo-Install-MongoDB-on-CentOS-6-x.md","hash":"088aed9bb03277129668235954dc7761e4a699bd","modified":1493046076302},{"_id":"source/_posts/HowTo-Install-MySQL-5-5-6-7-on-RHEL-CentOS-5-6-7.md","hash":"6d94e2a3a4610167b0d63db912b6b0b06fcc03b3","modified":1493046076302},{"_id":"source/_posts/HowTo-Install-NextCloud.md","hash":"fdfc92d616bcfd129ea166da1463ef574ab0973e","modified":1493046076302},{"_id":"source/_posts/HowTo-Install-Openfire-on-CentOS.md","hash":"eff3faf24083174d4a33189699df807bd2fc7282","modified":1493046076302},{"_id":"source/_posts/HowTo-Install-PostgreSQL-9-5-on-CentOS-6-x.md","hash":"63f096cb375cd7ed177bcd97c1dfc11cf6a693e2","modified":1493046076302},{"_id":"source/_posts/HowTo-Install-Python-2-7-8-on-CentOS-6-x.md","hash":"f5ec8a2f8b0e3e1749e0192215bf703363ef17f1","modified":1493046076302},{"_id":"source/_posts/HowTo-Install-Python3-on-CentOS-6-x.md","hash":"0c92288a22bf8cebf55ec1cf7eff9697bb712b51","modified":1493046076302},{"_id":"source/_posts/HowTo-Install-Redmine.md","hash":"0ccf2495a78184e60aeb2afe863371d4377969e8","modified":1493046076303},{"_id":"source/_posts/HowTo-Install-Zabbix-2-4-on-CentOS-6-x.md","hash":"19b1c2f88043f78758cba75aa78223eab2c9c3a7","modified":1493046076303},{"_id":"source/_posts/HowTo-Install-a-Tomcat-Server-7.md","hash":"dc95af0471a9bd542253523bc2051c4949aa2232","modified":1493046076303},{"_id":"source/_posts/HowTo-Install-piwik-with-nginx-on-centos-6-x.md","hash":"f86d71ca267d3648f8753e505f7cd862b0d1d4d6","modified":1493046076303},{"_id":"source/_posts/HowTo-Monitor-Tomcat-Head-Memory-for-Zabbix.md","hash":"5c91db6b4569f89a7f99df8e792e6b3947e620c3","modified":1493046076303},{"_id":"source/_posts/HowTo-Monitoring-MySQL-server-for-Zabbix.md","hash":"37f41035195c328c813c02c576e28e35ba4ff9c0","modified":1493046076303},{"_id":"source/_posts/HowTo-Mount-OSS-Bucket-On-ECS.md","hash":"8241224464ea69d17738346f63b7b10aa7ac3ee4","modified":1493046076303},{"_id":"source/_posts/HowTo-Play-Pokemon-GO-in-China.md","hash":"969858a22850024bd47e844ee604fd5ef7b52fa7","modified":1493046076303},{"_id":"source/_posts/HowTo-Reset-Azure-VM-Linux-Password.md","hash":"d43bb96b7652a720b37cff6704bd34e50de5bd47","modified":1493046076303},{"_id":"source/_posts/HowTo-Reset-MySQL-Root-Password.md","hash":"0246917089a94579f5d6033b037c7dc86ee43c28","modified":1493046076303},{"_id":"source/_posts/HowTo-Setup-MariaDB-Galera-Cluster-10-On-CentOS-6-x.md","hash":"4fbc4a8eb5a2f15c659bc0761e4a49a9307b2f44","modified":1493046076303},{"_id":"source/_posts/HowTo-Trun-Off-IPv6-in-CentOS-6-x.md","hash":"80e35dfb972e39f8da71319bc0ae736c104dfcb7","modified":1493046076303},{"_id":"source/_posts/HowTo-Upgrade-Your-Ghost-Version.md","hash":"50382207759566fdf0ca82c30b7d3923d0dc39fc","modified":1493046076303},{"_id":"source/_posts/HowTo-Use-Docker-create-a-Tomcat-Project.md","hash":"b5edecb3238a18dc49d6b75574f42f265f75b9bb","modified":1493046076303},{"_id":"source/_posts/HowTo-Use-Fuse-sshfs-to-Mount-Remote-Filesystems.md","hash":"a05eb3c1120aff9c8dc159c705613b02eb3f2361","modified":1493046076303},{"_id":"source/_posts/HowTo-Use-Remi-Install-Redis.md","hash":"fb5221731fd8146e2945146f66fafff770939325","modified":1493046076304},{"_id":"source/_posts/HowTo-Use-pt-query-digest.md","hash":"6d4c35cf67c62da921edaf6430637eb71a8f9d0f","modified":1493046076304},{"_id":"source/_posts/HowTo-install-Zoomdata.md","hash":"68500f5462a68c207d358322633dfb172c23b22a","modified":1493046076304},{"_id":"source/_posts/HowTo-set-Tomcat-7-automatic-startup-with-CentOS-7.md","hash":"3aae0ee20ab5f244ae003d39d6fc3c82f79fdb30","modified":1493046076304},{"_id":"source/_posts/Linux-中的三个特殊权限.md","hash":"198b21d939a642ef46113350deec4b1fc116a1c7","modified":1493046076304},{"_id":"source/_posts/Linux-笔试试题.md","hash":"368b552de7c1f12acc988dc9c7922aca5fec7f0e","modified":1493046076304},{"_id":"source/_posts/Mac-1-调整Launchpad图标大小.md","hash":"92fb990f4028c1ef78365d813584eb3ade2477d7","modified":1493046076304},{"_id":"source/_posts/Mac-2-解决oh-my-zsh在终端下打开缓慢.md","hash":"3d49da97601db8a67f7139d577b4b6e6ecf0f1af","modified":1493046076304},{"_id":"source/_posts/MacTips：使用命令关闭和启动AirPort.md","hash":"6425233bcc14f6f7e4b79ac29b6f839b9eac341f","modified":1493046076304},{"_id":"source/_posts/Manage-Tomcat-Service-Use-Shell-Script.md","hash":"a1480044bb3df08420ffad7fac1c5595c7bc440d","modified":1493046076304},{"_id":"source/_posts/MySQL-1-常用优化.md","hash":"98b718b5ea0d252c80511bcf232235616ce74a78","modified":1493046076304},{"_id":"source/_posts/MySQL-2-开启慢日志优化.md","hash":"6ea7997fb3bd0d48b28b691bfb7027ef6b92050b","modified":1493046076304},{"_id":"source/_posts/MySQL-3-mysqldump常用参数.md","hash":"8d98f7c822a99048683e8c789c5756c0c3cf7079","modified":1493046076304},{"_id":"source/_posts/MySQL-4-MySQL数据库基础.md","hash":"990f743d2e2bf7650586891e157d01f742048ae8","modified":1493046076304},{"_id":"source/_posts/MySQL-5-清空表命令之：truncate与delete区别.md","hash":"e888e7bbcd87a4a74c7abb30251e9309c3b1ab53","modified":1493046076305},{"_id":"source/_posts/MySQL-6-利用Linux计划任务定时同步MySQL.md","hash":"8227af5271a73a3986e8cc9f77cc2f1c412bc421","modified":1493046076305},{"_id":"source/_posts/MySQL-8-索引创建、删除和查看.md","hash":"334872d94426a850136633d4a1ab76a0869c14e7","modified":1493046076305},{"_id":"source/_posts/OpenStak-介绍.md","hash":"a38a0d752229a8ea6482f7d207707e4066eb8344","modified":1493046076305},{"_id":"source/_posts/Python-1-基础.md","hash":"866cb1db377f4ab8dab11ee5b979fe466ceff96a","modified":1493046076305},{"_id":"source/_posts/SSH-LINUX-Security-Settings.md","hash":"2659781fac26dca1aaf37a24c0e0f89ede46f314","modified":1493046076305},{"_id":"source/_posts/Script-Install-LNMP.md","hash":"8ac5a6a171bb93f1a0e03f69073437053be6124e","modified":1493046076305},{"_id":"source/_posts/Tomcat-1-java-lang-OutOfMemoryError.md","hash":"f1f24aac17f456fb02413e52e49b51b4f01937b3","modified":1493046076305},{"_id":"source/_posts/Tomcat-2-利用JDK自身keytool实现HTTPS.md","hash":"b1c9e197c4b295123c58cd55431ae9063989088c","modified":1493046076305},{"_id":"source/_posts/Tomcat-3-优化设定.md","hash":"479fa0bcc32fe0a6ee3a156ca466ff941d3182c3","modified":1493046076305},{"_id":"source/_posts/Xiang-Xiang-Gong-Zhu.md","hash":"1f6d957554dd177911b1d2399a88404f4e02f6f1","modified":1493044342571},{"_id":"source/_posts/Yum中-releasever和-basearch的取值.md","hash":"6909d6212599027e7cebc115c5502df780f0f14a","modified":1493046076305},{"_id":"source/_posts/hello-world.md","hash":"a08bf464e36707b2b625a6299d6a5bed25dc6541","modified":1493046076305},{"_id":"source/_posts/上海天冷了.md","hash":"616627d10f918c62266b2898d73680e0c2c06f42","modified":1493046305636},{"_id":"source/_posts/世界上最没用的东西.md","hash":"44335e3124279409e7610416fe957db25a2cc6cb","modified":1493043205366},{"_id":"source/_posts/二十四岁.md","hash":"860a90b68e659f20aecc2c8a0372f8f15b543e04","modified":1493043205366},{"_id":"source/_posts/你好，八月.md","hash":"43e610703abca75989b206b5be834cfbfdf0cc45","modified":1493043205366},{"_id":"source/_posts/使用SoureceTree管理你的git项目.md","hash":"31230b8420f03ae4de8f95e09b30b71903ad2313","modified":1493046076305},{"_id":"source/_posts/使用mosh代替ssh连接服务器.md","hash":"73b19bac41c22105da9abc35cf605fc8dd08160a","modified":1493046076305},{"_id":"source/_posts/关于考试.md","hash":"71e7445f7a47940b0cebc0b940fb85473120015f","modified":1493043205366},{"_id":"source/_posts/写的微博.md","hash":"ee899bc7bc94b6c0bbfae62f92910e1d74088489","modified":1493043205366},{"_id":"source/_posts/告别.md","hash":"7fc3648a80cffd00a9edf3bbdcb4140386e97511","modified":1493044342571},{"_id":"source/_posts/四阶魔方特殊情况之处理.md","hash":"ddd17ca04c73e64b6cbe72711f43d2223fe8eae2","modified":1493046076306},{"_id":"source/_posts/在CentOS中配置-SFTP-环境.md","hash":"d0283c0262d4ee4b27504398e3e4d54a404ddf07","modified":1493046076306},{"_id":"source/_posts/在网页中插入歌曲.md","hash":"4a776f5c0a8412e35b7db518e9e84d3c38f7fb0e","modified":1493046076306},{"_id":"source/_posts/如何在CentOS-6-安装更高版本的PHP.md","hash":"0f5bf902b98835d0ef50ceb6e8673ea700fda1d3","modified":1493046076306},{"_id":"source/_posts/我是一个最不会写标题的人.md","hash":"eaf6f07268e808dbbadac564b0a2454991644eea","modified":1493044342571},{"_id":"source/_posts/我的2017.md","hash":"406fbc3dcd516ca778ab2abc2e8d8c2f849c33cb","modified":1493044342572},{"_id":"source/_posts/我的约会日记.md","hash":"b13a04c9bb94c42b9b123d5a4471614ce93767e8","modified":1493044342572},{"_id":"source/_posts/斯人若彩虹，遇上方知有.md","hash":"2e3747a275c6df81ad2ccd6a5f8d40287506575d","modified":1493044342572},{"_id":"source/_posts/无法逃离的孤独.md","hash":"3c60d368dc478e7a8aba37628afc84848e4c2fdb","modified":1493044342572},{"_id":"source/_posts/无题.md","hash":"ed0d24a76e86c2a4bd744d6d6f973a571347e4c3","modified":1493044342572},{"_id":"source/_posts/极简主义.md","hash":"10eebb96f69fb0fe46a073067afb26e507f9d7fa","modified":1493044342572},{"_id":"source/_posts/每日备份MySQL单表数据.md","hash":"8a4f80df04a17a75ca118c71cdef94531041732e","modified":1493046076306},{"_id":"source/_posts/民谣是生.md","hash":"70ad33570f0b52545c797940d9b9dd750da92a1e","modified":1493044342572},{"_id":"source/_posts/爱与痛的边缘.md","hash":"420f76e42772853cbd3852d22568c25b20613519","modified":1493044342572},{"_id":"source/_posts/理解-Linux-的硬链接与软链接.md","hash":"97fa5839bbfd12ea758ee842c714d48ad4e89732","modified":1493046076306},{"_id":"source/_posts/生活在别处.md","hash":"8d63812575ad090a9d8656456be660bc0813fe5d","modified":1493044342572},{"_id":"source/_posts/生者孤独.md","hash":"6178174bc3f17673d881d5d6adde277acca74237","modified":1493044342572},{"_id":"source/_posts/血战钢锯岭.md","hash":"569d0db002e1e553e7807679ae10b769225e7a3b","modified":1493044342572},{"_id":"source/_posts/路途上.md","hash":"074e44de9f2aa541ca5d378918445823116dcb71","modified":1493044342572},{"_id":"source/_posts/这是一道鬼门关.md","hash":"c025f6c2f86d342bfcdd6750e9e799c6458b08b0","modified":1493044342572},{"_id":"source/_posts/龙族路明非.md","hash":"0f2527c778e55597bb114fd2ed32ca1478cf73e5","modified":1493044342572},{"_id":"source/categories/index.md","hash":"9aa91607394df5b182b975b4837b7843d4200e92","modified":1493041158629},{"_id":"source/tags/index.md","hash":"8d967a0c0d8e2a3e541ea598ad84effff4f112ff","modified":1493041088873},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"3b5eafd32abb718e56ccf8d1cee0607ad8ce611d","modified":1493040666261},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"fdd63b77472612337309eb93ec415a059b90756b","modified":1493040666262},{"_id":"themes/next/languages/de.yml","hash":"306db8c865630f32c6b6260ade9d3209fbec8011","modified":1493040666262},{"_id":"themes/next/languages/default.yml","hash":"4cc6aeb1ac09a58330e494c8771773758ab354af","modified":1493040666262},{"_id":"themes/next/languages/en.yml","hash":"e7def07a709ef55684490b700a06998c67f35f39","modified":1493040666262},{"_id":"themes/next/languages/fr-FR.yml","hash":"24180322c83587a153cea110e74e96eacc3355ad","modified":1493040666262},{"_id":"themes/next/languages/id.yml","hash":"2835ea80dadf093fcf47edd957680973f1fb6b85","modified":1493040666262},{"_id":"themes/next/languages/ja.yml","hash":"1c3a05ab80a6f8be63268b66da6f19da7aa2c638","modified":1493040666262},{"_id":"themes/next/languages/ko.yml","hash":"be150543379150f78329815af427bf152c0e9431","modified":1493040666262},{"_id":"themes/next/languages/pt-BR.yml","hash":"958e49571818a34fdf4af3232a07a024050f8f4e","modified":1493040666262},{"_id":"themes/next/languages/pt.yml","hash":"36c8f60dacbe5d27d84d0e0d6974d7679f928da0","modified":1493040666262},{"_id":"themes/next/languages/ru.yml","hash":"1549a7c2fe23caa7cbedcd0aa2b77c46e57caf27","modified":1493040666263},{"_id":"themes/next/languages/zh-Hans.yml","hash":"3c0c7dfd0256457ee24df9e9879226c58cb084b5","modified":1493040666263},{"_id":"themes/next/languages/zh-hk.yml","hash":"1c917997413bf566cb79e0975789f3c9c9128ccd","modified":1493040666263},{"_id":"themes/next/languages/zh-tw.yml","hash":"0b2c18aa76570364003c8d1cd429fa158ae89022","modified":1493040666263},{"_id":"themes/next/layout/_layout.swig","hash":"9d1a23a6add6f3d0f88c2d17979956f14aaa37a4","modified":1493040666263},{"_id":"themes/next/layout/archive.swig","hash":"5de4dca06b05d99e4f6bad617a4b8f4f3592fb01","modified":1493040666265},{"_id":"themes/next/layout/category.swig","hash":"fb55a48fe92621578ab2db0c983c609371b3ed0e","modified":1493040666266},{"_id":"themes/next/layout/index.swig","hash":"03e8a2cda03bad42ac0cb827025eb81f95d496a2","modified":1493040666266},{"_id":"themes/next/layout/page.swig","hash":"4ddaeedf1599d167c4ee166d391e616a7660a4ef","modified":1493040666266},{"_id":"themes/next/layout/post.swig","hash":"2d5f8d7f0a96b611e2d5a5e4d111fc17726a990f","modified":1493040666266},{"_id":"themes/next/layout/schedule.swig","hash":"f93c53f6fd5c712584f6efba6f770c30fa8a3e80","modified":1493040666266},{"_id":"themes/next/layout/tag.swig","hash":"52c506fa2b46a28ae2df10831c61c51a45b2f6c1","modified":1493040666266},{"_id":"themes/next/scripts/merge-configs.js","hash":"13c8b3a2d9fce06c2488820d9248d190c8100e0a","modified":1493040666266},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1493040666266},{"_id":"themes/next/source/404.html","hash":"a5991bb3598c5d934bd97e3bc4ed14b71ebf1e62","modified":1493041873763},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1493040666291},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1493040666291},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1493040666292},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493040666270},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1493040666263},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1493040666263},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"5864f5567ba5efeabcf6ea355013c0b603ee07f2","modified":1493040666263},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"b16fcbf0efd20c018d7545257a8533c497ea7647","modified":1493040666263},{"_id":"themes/next/layout/_macro/post.swig","hash":"7b2683963693516b21095010911091414f112c03","modified":1493040666263},{"_id":"themes/next/layout/_macro/reward.swig","hash":"37e5b7c42ec17b9b6b786c5512bcc481a21c974e","modified":1493040666263},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"911b99ba0445b2c07373128d87a4ef2eb7de341a","modified":1493040666263},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"14e785adeb0e671ba0ff9a553e6f0d8def6c670c","modified":1493040666263},{"_id":"themes/next/layout/_partials/comments.swig","hash":"1c7d3c975e499b9aa3119d6724b030b7b00fc87e","modified":1493040666263},{"_id":"themes/next/layout/_partials/footer.swig","hash":"7172c6053118b7c291a56a7860128a652ae66b83","modified":1493040666263},{"_id":"themes/next/layout/_partials/head.swig","hash":"d4a05c51aac02f1f6248baccf2ddb8ee12b9122f","modified":1493040666263},{"_id":"themes/next/layout/_partials/header.swig","hash":"a1ffbb691dfad3eaf2832a11766e58a179003b8b","modified":1493040666263},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1493040666263},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1493040666263},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1493040666264},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1493040666264},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1493040666264},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"9baf90f7c40b3b10f288e9268c3191e895890cea","modified":1493040666264},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1493040666265},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1493040666265},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1493040666265},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1493040666265},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1493040666265},{"_id":"themes/next/scripts/tags/button.js","hash":"62e6dbeb53d07627a048132c79630b45d9a8f2cc","modified":1493040666266},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1493040666266},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1493040666266},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1493040666266},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1493040666266},{"_id":"themes/next/scripts/tags/note.js","hash":"6752925eedbdb939d8ec4d11bdfb75199f18dd70","modified":1493040666266},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1493040666270},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1493040666270},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1493040666270},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1493040666270},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1493040666270},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1493040666270},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1493040666270},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1493040666270},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1493040666270},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1493040666270},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1493040666271},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1493040666271},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1493040666271},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1493040666271},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1493040666271},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493040666264},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493040666264},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493040666269},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493040666269},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493040666269},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493040666269},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493040666270},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1493040666263},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1493040666263},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"2d1075f4cabcb3956b7b84a8e210f5a66f0a5562","modified":1493040666264},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1493040666264},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1493040666264},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1493040666264},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1493040666264},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1493040666264},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"63315fcf210799f894208c9f512737096df84962","modified":1493040666264},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1493040666264},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"18e7bef8923d83ea42df6c97405e515a876cede4","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"394d008e5e94575280407ad8a1607a028026cbc3","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"3358d11b9a26185a2d36c96049e4340e701646e4","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"92dc60821307fc9769bea9b2d60adaeb798342af","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"a652f202bd5b30c648c228ab8f0e997eb4928e44","modified":1493040666264},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1493040666264},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1493040666264},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1493040666264},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1493040666264},{"_id":"themes/next/layout/_third-party/comments/gentie.swig","hash":"03592d1d731592103a41ebb87437fe4b0a4c78ca","modified":1493040666265},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1493040666265},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"abb92620197a16ed2c0775edf18a0f044a82256e","modified":1493040666265},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"1d0d01aaeb7bcde3671263d736718f8837c20182","modified":1493040666265},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"af9dd8a4aed7d06cf47b363eebff48850888566c","modified":1493040666265},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1493040666265},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"622bc99765c72b312abf523cd9b4b36cdb392118","modified":1493040666265},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1493040666265},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1493040666265},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1493040666269},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"715d5b40dc52f319fe4bff0325beb874774d9bd9","modified":1493040666269},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"78a83c38f69a8747bb74e420e6c9eeef1ea76525","modified":1493040666269},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"c8d35a6b9e3bff6d8fdb66de853065af9d37562d","modified":1493040666269},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"06f432f328a5b8a9ef0dbd5301b002aba600b4ce","modified":1493040666270},{"_id":"themes/next/source/css/_variables/base.styl","hash":"d6a793bcada68d4b6c58392546bc48a482e4a7d3","modified":1493040666270},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1493040666271},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1493040666271},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"aab7be0a6e2724b3faa9338db93c19556c559625","modified":1493040666271},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1493040666271},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1493040666271},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1493040666271},{"_id":"themes/next/source/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1493040666271},{"_id":"themes/next/source/js/src/post-details.js","hash":"af7a417dd1cb02465a7b98211653e7c6192e6d55","modified":1493040666271},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1493040666271},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1493040666271},{"_id":"themes/next/source/js/src/utils.js","hash":"803f684fa7d0e729115a48851023a31f6fb6d0a7","modified":1493040666271},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1493040666273},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1493040666275},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"b614b73ba49ca9136fed7c387ee8df72fe65118f","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1493040666276},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1493040666277},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1493040666277},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1493040666277},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1493040666277},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1493040666277},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1493040666277},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1493040666277},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1493040666277},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1493040666277},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1493040666285},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1493040666286},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1493040666286},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1493040666286},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1493040666286},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1493040666286},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1493040666286},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1493040666286},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1493040666287},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1493040666287},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1493040666290},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1493040666290},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1493040666291},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1493040666291},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1493040666291},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1493040666286},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1493040666265},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1493040666265},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"59ad08bcc6fe9793594869ac2b4c525021453e78","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"ef089a407c90e58eca10c49bc47ec978f96e03ba","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"0dfb4b3ba3180d7285e66f270e1d3fa0f132c3d2","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"711c8830886619d4f4a0598b0cde5499dce50c62","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1493040666268},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1493040666268},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"7804e31c44717c9a9ddf0f8482b9b9c1a0f74538","modified":1493040666268},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1493040666269},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1493040666269},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"013619c472c7e4b08311c464fcbe9fcf5edde603","modified":1493040666269},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"fda14bc35be2e1b332809b55b3d07155a833dbf4","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"82bbaa6322764779a1ac2e2c8390ce901c7972e2","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"e3e23751d4ad24e8714b425d768cf68e37de7ded","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1493040666269},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"79da92119bc246fe05d1626ac98426a83ec90a94","modified":1493040666271},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"d9c0b3dc9158e717fde36f554709e6c3a22b5f85","modified":1493040666273},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1493040666273},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1493040666277},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1493040666277},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1493040666277},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1493040666277},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1493040666277},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1493040666278},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1493040666278},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1493040666290},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1493040666290},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"38e48f275ad00daa9dcdcb8d9b44e576acda4707","modified":1493040666272},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1493040666273},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1493040666285},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1493040666285},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1493040666291},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"8994ffcce84deac0471532f270f97c44fea54dc0","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"740d37f428b8f4574a76fc95cc25e50e0565f45e","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"7778920dd105fa4de3a7ab206eeba30b1a7bac45","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"beccb53dcd658136fb91a0c5678dea8f37d6e0b6","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"8fae54591877a73dff0b29b2be2e8935e3c63575","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"88c7d75646b66b168213190ee4cd874609afd5e3","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"c089419916988d0f51d89b225460fe11b631e0a3","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"e792c8dc41561c96d128e9b421187f1c3dc978a0","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1493040666267},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"963105a531403d7aad6d9e5e23e3bfabb8ec065a","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"8c0276883398651336853d5ec0e9da267a00dd86","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"2e7ec9aaa3293941106b1bdd09055246aa3c3dc6","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"5f6ea57aabfa30a437059bf8352f1ad829dbd4ff","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"7690b9596ec3a49befbe529a5a2649abec0faf76","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"a2ec22ef4a6817bbb2abe8660fcd99fe4ca0cc5e","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"234facd038f144bd0fe09a31ed1357c5d74c517f","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"b8969e1654eec89a0fd10d88b337fee9cb03cd44","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"74d0ba86f698165d13402670382a822c8736a556","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"dd310c2d999185e881db007360176ee2f811df10","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/third-party/gentie.styl","hash":"586a3ec0f1015e7207cd6a2474362e068c341744","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1493040666268},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"bb3be8374c31c372ed0995bd8030d2b920d581de","modified":1493040666268},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1493040666269},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1493040666269},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1493040666272},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1493040666272},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1493040666272},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1493040666272},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1493040666276},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1493040666276},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1493040666279},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1493040666281},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1493040666285},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1493040666275},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1493040666289},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1493040666283}],"Category":[{"name":"似水年华","_id":"cj1wytq4v000441tp944hcujk"},{"name":"Azure","_id":"cj1wytq5i000941tptr9o9fki"},{"name":"CentOS","_id":"cj1wytq6f000r41tph2u68u76"},{"name":"Docker","_id":"cj1wytq7f001q41tpwf64piys"},{"name":"Ghost","_id":"cj1wytq7o001x41tp8lk7qvvi"},{"name":"CloudStack","_id":"cj1wytq83002b41tpb3k5n5ci"},{"name":"Git","_id":"cj1wytq8r002p41tp52ezwcl0"},{"name":"KVM","_id":"cj1wytq94002w41tpoj52axx6"},{"name":"MongoDB","_id":"cj1wytq9e003441tphxisxvtr"},{"name":"MySQL","_id":"cj1wytq9m003b41tpbl9xr3o9"},{"name":"PostgreSQL","_id":"cj1wytq9s003i41tp5qs784k7"},{"name":"Python","_id":"cj1wytqa0003p41tp7pz5zjgq"},{"name":"Zabbix","_id":"cj1wytqai004741tpcgmpihtz"},{"name":"Tomcat","_id":"cj1wytqar004g41tpfeu01ooz"},{"name":"AliCloud","_id":"cj1wytqb8005041tpkltmckl2"},{"name":"Redis","_id":"cj1wytqbl005g41tp6tiy612b"},{"name":"Linux","_id":"cj1wytqc7005x41tp4g4d7evh"},{"name":"Mac","_id":"cj1wytqcm006d41tpdicz01s3"},{"name":"Shell","_id":"cj1wytqd8007141tp3eiiv8lt"},{"name":"OpenStack","_id":"cj1wytqdg007b41tpkbxvzy09"},{"name":"魔方","_id":"cj1wytqdw007z41tpwc33042h"}],"Data":[],"Page":[{"title":"分类","date":"2017-04-24T13:38:30.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: 分类\ndate: 2017-04-24 21:38:30\ntype: \"categories\"\ncomments: false\n---\n","updated":"2017-04-24T13:39:18.629Z","path":"categories/index.html","layout":"page","_id":"cj1wytq4a000141tpi305jx9e","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"标签","date":"2017-04-24T13:37:07.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: 标签\ndate: 2017-04-24 21:37:07\ntype: \"tags\"\ncomments: false\n---\n","updated":"2017-04-24T13:38:08.873Z","path":"tags/index.html","layout":"page","_id":"cj1wytq4o000341tpenlq1rxi","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"2016春节读书笔记","id":"10022","date":"2016-03-04T16:34:54.000Z","_content":"\n\n> 《西部招妻》--马宏杰。\n\n这部作品从中华几千年的娶妻生子传宗接代的观念介入，描述了为了娶妻一家人付出了难以想象的艰辛和退让，让人毛骨悚然。最近接连看了三部纪实文学，其实很久就放在书单里了，春节有空，一口气看完，这里是这个社会最底层的人民，是高速发展的经济和传统文化的碰撞，有很多负能量，有很多你觉得不可思议的观念，但是这才是我们中国最真实现状的一角，无论多么光鲜亮丽的外表都藏满了满目疮痍的现实，或我们，或我们的祖辈，或另一个族群的人，我们固守着传承几千年的风俗文明，却又不得不妥协于这瞬息万变的今天，所谓的中国梦中国强，看来仍旧有非常多的路要走，一个民族国家的强盛应该是取决于最底层的人民，而如何改变则是取决于每个人自身，这个社会的确有万般问题，但是只要人在进步，社会纵究也会进步。\n\n> 《最后的耍猴人》--马宏杰\n\n初读此书时，便十分敬佩作者几十年跟拍耍猴人的故事，进而了解到耍猴人这一个族群沉默而伟大令人震撼的精神，与猴相伴，猴子支撑起了这一辈辈人的艰辛命运，有很多感动的瞬间，读至猴案时，十分忿恨执法者当权者滥用职权，曲解法律赋予人民的权利成为自己徇私舞弊的利器，喜欢这几句话：法律要是缺失了良知作为基础，那么可怕的冷漠就会占据上风，取而代之的就是权力的滥用，人处在世俗之中，不可避免有高低贵贱之分，对于那些善良弱势的人，我们只有通过宽容、理解、帮扶，才能给他们带来改变的希望，推荐大家看看这本书。关注这个传承上千年的群族，河南新野耍猴人的故乡，如果你还能碰到耍猴人，请帮我问问他们是否来自河南新野县。\n\n> 《打工女孩》--张彤禾\n\n一个个真是的故事，细思每座城市其实都很像东莞，读完这本书发现自己游荡在大街上，凌晨四点钟走在城市的街头，回头看着曾经走过的路，我也是那千千万万中走出来的一员，极力摆脱身上的印记，却又对前路踌躇不安，空前发展的工业经济，改变着每一个人的思想、价值观，却同时没有与之匹配的精神文明教育发展，畸形的思潮影响了一代又一代人，这本书写的很真实，还原了改革开放之初对农村和城市社会的影响，时代发展透露出来的悲情，令人毛骨悚然，推荐大家去读，去了解这个群体。\n\n> 《其实，你所知道的世界很陌生》--王路\n\n了解王先生就在最近半年左右，偶然在知乎看到王先生的答文，颇感有趣，于是关注了王先生的公众号，看了一些推送的文章，偶然间在亚马逊发现署名王路的书，且看书名却有些诧异，这种名字一般多是某某之流用的鸡汤文专属称号才对（这里某某之流包含张嘉佳），抱着好奇心态买了这本书，已看过大半，行文与书名给人感觉截然不同，推荐给大家，文字潇洒跳跃，十分钦佩王先生的文采，又甚是喜爱。昨日又已入手王先生新书《唧唧复唧唧》。\n\n> 《德川家康》--山冈庄八\n\n首先述说kindle是一个好的读书工具，《德川家康》也是用它读完的第一本长篇。巧合之下得知这本书，抱着且观一观的态度去看的，因为对日本文学了解的很少，全书共13册，约550万字，要知道《红楼梦》尚只有70万字左右，之前看完的路遥先生所著《平凡的世界》也不过百余万字，除了网文，这算是为看过的数不多的几部长篇了，因每日都是地铁上读读书，预估怎么着也要半年读完，不想三个月就读完了，通读之后，深深被德川家康所折服，更被山冈庄八先生的文学功底所折服，陪我走过人生最艰难的那段时间，读至一半便感叹：这是人生之书啊，凭我的年纪能懂十之一二便已满足，待合适之时，重读此书\n","source":"_posts/001.md","raw":"---\ntitle: 2016春节读书笔记\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: read-2016-03\nid: 10022\ndate: 2016-03-05 00:34:54\n---\n\n\n> 《西部招妻》--马宏杰。\n\n这部作品从中华几千年的娶妻生子传宗接代的观念介入，描述了为了娶妻一家人付出了难以想象的艰辛和退让，让人毛骨悚然。最近接连看了三部纪实文学，其实很久就放在书单里了，春节有空，一口气看完，这里是这个社会最底层的人民，是高速发展的经济和传统文化的碰撞，有很多负能量，有很多你觉得不可思议的观念，但是这才是我们中国最真实现状的一角，无论多么光鲜亮丽的外表都藏满了满目疮痍的现实，或我们，或我们的祖辈，或另一个族群的人，我们固守着传承几千年的风俗文明，却又不得不妥协于这瞬息万变的今天，所谓的中国梦中国强，看来仍旧有非常多的路要走，一个民族国家的强盛应该是取决于最底层的人民，而如何改变则是取决于每个人自身，这个社会的确有万般问题，但是只要人在进步，社会纵究也会进步。\n\n> 《最后的耍猴人》--马宏杰\n\n初读此书时，便十分敬佩作者几十年跟拍耍猴人的故事，进而了解到耍猴人这一个族群沉默而伟大令人震撼的精神，与猴相伴，猴子支撑起了这一辈辈人的艰辛命运，有很多感动的瞬间，读至猴案时，十分忿恨执法者当权者滥用职权，曲解法律赋予人民的权利成为自己徇私舞弊的利器，喜欢这几句话：法律要是缺失了良知作为基础，那么可怕的冷漠就会占据上风，取而代之的就是权力的滥用，人处在世俗之中，不可避免有高低贵贱之分，对于那些善良弱势的人，我们只有通过宽容、理解、帮扶，才能给他们带来改变的希望，推荐大家看看这本书。关注这个传承上千年的群族，河南新野耍猴人的故乡，如果你还能碰到耍猴人，请帮我问问他们是否来自河南新野县。\n\n> 《打工女孩》--张彤禾\n\n一个个真是的故事，细思每座城市其实都很像东莞，读完这本书发现自己游荡在大街上，凌晨四点钟走在城市的街头，回头看着曾经走过的路，我也是那千千万万中走出来的一员，极力摆脱身上的印记，却又对前路踌躇不安，空前发展的工业经济，改变着每一个人的思想、价值观，却同时没有与之匹配的精神文明教育发展，畸形的思潮影响了一代又一代人，这本书写的很真实，还原了改革开放之初对农村和城市社会的影响，时代发展透露出来的悲情，令人毛骨悚然，推荐大家去读，去了解这个群体。\n\n> 《其实，你所知道的世界很陌生》--王路\n\n了解王先生就在最近半年左右，偶然在知乎看到王先生的答文，颇感有趣，于是关注了王先生的公众号，看了一些推送的文章，偶然间在亚马逊发现署名王路的书，且看书名却有些诧异，这种名字一般多是某某之流用的鸡汤文专属称号才对（这里某某之流包含张嘉佳），抱着好奇心态买了这本书，已看过大半，行文与书名给人感觉截然不同，推荐给大家，文字潇洒跳跃，十分钦佩王先生的文采，又甚是喜爱。昨日又已入手王先生新书《唧唧复唧唧》。\n\n> 《德川家康》--山冈庄八\n\n首先述说kindle是一个好的读书工具，《德川家康》也是用它读完的第一本长篇。巧合之下得知这本书，抱着且观一观的态度去看的，因为对日本文学了解的很少，全书共13册，约550万字，要知道《红楼梦》尚只有70万字左右，之前看完的路遥先生所著《平凡的世界》也不过百余万字，除了网文，这算是为看过的数不多的几部长篇了，因每日都是地铁上读读书，预估怎么着也要半年读完，不想三个月就读完了，通读之后，深深被德川家康所折服，更被山冈庄八先生的文学功底所折服，陪我走过人生最艰难的那段时间，读至一半便感叹：这是人生之书啊，凭我的年纪能懂十之一二便已满足，待合适之时，重读此书\n","slug":"read-2016-03","published":1,"updated":"2017-04-24T14:32:22.571Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq3z000041tpfpu837nf","content":"<blockquote>\n<p>《西部招妻》–马宏杰。</p>\n</blockquote>\n<p>这部作品从中华几千年的娶妻生子传宗接代的观念介入，描述了为了娶妻一家人付出了难以想象的艰辛和退让，让人毛骨悚然。最近接连看了三部纪实文学，其实很久就放在书单里了，春节有空，一口气看完，这里是这个社会最底层的人民，是高速发展的经济和传统文化的碰撞，有很多负能量，有很多你觉得不可思议的观念，但是这才是我们中国最真实现状的一角，无论多么光鲜亮丽的外表都藏满了满目疮痍的现实，或我们，或我们的祖辈，或另一个族群的人，我们固守着传承几千年的风俗文明，却又不得不妥协于这瞬息万变的今天，所谓的中国梦中国强，看来仍旧有非常多的路要走，一个民族国家的强盛应该是取决于最底层的人民，而如何改变则是取决于每个人自身，这个社会的确有万般问题，但是只要人在进步，社会纵究也会进步。</p>\n<blockquote>\n<p>《最后的耍猴人》–马宏杰</p>\n</blockquote>\n<p>初读此书时，便十分敬佩作者几十年跟拍耍猴人的故事，进而了解到耍猴人这一个族群沉默而伟大令人震撼的精神，与猴相伴，猴子支撑起了这一辈辈人的艰辛命运，有很多感动的瞬间，读至猴案时，十分忿恨执法者当权者滥用职权，曲解法律赋予人民的权利成为自己徇私舞弊的利器，喜欢这几句话：法律要是缺失了良知作为基础，那么可怕的冷漠就会占据上风，取而代之的就是权力的滥用，人处在世俗之中，不可避免有高低贵贱之分，对于那些善良弱势的人，我们只有通过宽容、理解、帮扶，才能给他们带来改变的希望，推荐大家看看这本书。关注这个传承上千年的群族，河南新野耍猴人的故乡，如果你还能碰到耍猴人，请帮我问问他们是否来自河南新野县。</p>\n<blockquote>\n<p>《打工女孩》–张彤禾</p>\n</blockquote>\n<p>一个个真是的故事，细思每座城市其实都很像东莞，读完这本书发现自己游荡在大街上，凌晨四点钟走在城市的街头，回头看着曾经走过的路，我也是那千千万万中走出来的一员，极力摆脱身上的印记，却又对前路踌躇不安，空前发展的工业经济，改变着每一个人的思想、价值观，却同时没有与之匹配的精神文明教育发展，畸形的思潮影响了一代又一代人，这本书写的很真实，还原了改革开放之初对农村和城市社会的影响，时代发展透露出来的悲情，令人毛骨悚然，推荐大家去读，去了解这个群体。</p>\n<blockquote>\n<p>《其实，你所知道的世界很陌生》–王路</p>\n</blockquote>\n<p>了解王先生就在最近半年左右，偶然在知乎看到王先生的答文，颇感有趣，于是关注了王先生的公众号，看了一些推送的文章，偶然间在亚马逊发现署名王路的书，且看书名却有些诧异，这种名字一般多是某某之流用的鸡汤文专属称号才对（这里某某之流包含张嘉佳），抱着好奇心态买了这本书，已看过大半，行文与书名给人感觉截然不同，推荐给大家，文字潇洒跳跃，十分钦佩王先生的文采，又甚是喜爱。昨日又已入手王先生新书《唧唧复唧唧》。</p>\n<blockquote>\n<p>《德川家康》–山冈庄八</p>\n</blockquote>\n<p>首先述说kindle是一个好的读书工具，《德川家康》也是用它读完的第一本长篇。巧合之下得知这本书，抱着且观一观的态度去看的，因为对日本文学了解的很少，全书共13册，约550万字，要知道《红楼梦》尚只有70万字左右，之前看完的路遥先生所著《平凡的世界》也不过百余万字，除了网文，这算是为看过的数不多的几部长篇了，因每日都是地铁上读读书，预估怎么着也要半年读完，不想三个月就读完了，通读之后，深深被德川家康所折服，更被山冈庄八先生的文学功底所折服，陪我走过人生最艰难的那段时间，读至一半便感叹：这是人生之书啊，凭我的年纪能懂十之一二便已满足，待合适之时，重读此书</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>《西部招妻》–马宏杰。</p>\n</blockquote>\n<p>这部作品从中华几千年的娶妻生子传宗接代的观念介入，描述了为了娶妻一家人付出了难以想象的艰辛和退让，让人毛骨悚然。最近接连看了三部纪实文学，其实很久就放在书单里了，春节有空，一口气看完，这里是这个社会最底层的人民，是高速发展的经济和传统文化的碰撞，有很多负能量，有很多你觉得不可思议的观念，但是这才是我们中国最真实现状的一角，无论多么光鲜亮丽的外表都藏满了满目疮痍的现实，或我们，或我们的祖辈，或另一个族群的人，我们固守着传承几千年的风俗文明，却又不得不妥协于这瞬息万变的今天，所谓的中国梦中国强，看来仍旧有非常多的路要走，一个民族国家的强盛应该是取决于最底层的人民，而如何改变则是取决于每个人自身，这个社会的确有万般问题，但是只要人在进步，社会纵究也会进步。</p>\n<blockquote>\n<p>《最后的耍猴人》–马宏杰</p>\n</blockquote>\n<p>初读此书时，便十分敬佩作者几十年跟拍耍猴人的故事，进而了解到耍猴人这一个族群沉默而伟大令人震撼的精神，与猴相伴，猴子支撑起了这一辈辈人的艰辛命运，有很多感动的瞬间，读至猴案时，十分忿恨执法者当权者滥用职权，曲解法律赋予人民的权利成为自己徇私舞弊的利器，喜欢这几句话：法律要是缺失了良知作为基础，那么可怕的冷漠就会占据上风，取而代之的就是权力的滥用，人处在世俗之中，不可避免有高低贵贱之分，对于那些善良弱势的人，我们只有通过宽容、理解、帮扶，才能给他们带来改变的希望，推荐大家看看这本书。关注这个传承上千年的群族，河南新野耍猴人的故乡，如果你还能碰到耍猴人，请帮我问问他们是否来自河南新野县。</p>\n<blockquote>\n<p>《打工女孩》–张彤禾</p>\n</blockquote>\n<p>一个个真是的故事，细思每座城市其实都很像东莞，读完这本书发现自己游荡在大街上，凌晨四点钟走在城市的街头，回头看着曾经走过的路，我也是那千千万万中走出来的一员，极力摆脱身上的印记，却又对前路踌躇不安，空前发展的工业经济，改变着每一个人的思想、价值观，却同时没有与之匹配的精神文明教育发展，畸形的思潮影响了一代又一代人，这本书写的很真实，还原了改革开放之初对农村和城市社会的影响，时代发展透露出来的悲情，令人毛骨悚然，推荐大家去读，去了解这个群体。</p>\n<blockquote>\n<p>《其实，你所知道的世界很陌生》–王路</p>\n</blockquote>\n<p>了解王先生就在最近半年左右，偶然在知乎看到王先生的答文，颇感有趣，于是关注了王先生的公众号，看了一些推送的文章，偶然间在亚马逊发现署名王路的书，且看书名却有些诧异，这种名字一般多是某某之流用的鸡汤文专属称号才对（这里某某之流包含张嘉佳），抱着好奇心态买了这本书，已看过大半，行文与书名给人感觉截然不同，推荐给大家，文字潇洒跳跃，十分钦佩王先生的文采，又甚是喜爱。昨日又已入手王先生新书《唧唧复唧唧》。</p>\n<blockquote>\n<p>《德川家康》–山冈庄八</p>\n</blockquote>\n<p>首先述说kindle是一个好的读书工具，《德川家康》也是用它读完的第一本长篇。巧合之下得知这本书，抱着且观一观的态度去看的，因为对日本文学了解的很少，全书共13册，约550万字，要知道《红楼梦》尚只有70万字左右，之前看完的路遥先生所著《平凡的世界》也不过百余万字，除了网文，这算是为看过的数不多的几部长篇了，因每日都是地铁上读读书，预估怎么着也要半年读完，不想三个月就读完了，通读之后，深深被德川家康所折服，更被山冈庄八先生的文学功底所折服，陪我走过人生最艰难的那段时间，读至一半便感叹：这是人生之书啊，凭我的年纪能懂十之一二便已满足，待合适之时，重读此书</p>\n"},{"title":"Azure(2) HowTo Use Azure CLI on Mac","id":"56","updated":"2017-04-21T05:29:46.000Z","date":"2016-05-23T23:00:12.000Z","_content":"\n```\n## Install azure-cli on Mac and CentOS\n\n### In Mac\n1. Install brew.\n2. brew install nodejs\n3. echo “registry = https://registry.npm.taobao.org” > ~/.npmrc\n4. npm install azure-cli -g\n\n\n### In CentOS\n1. Install epel\n2. yum install -y nodejs npm\n3. echo “registry = https://registry.npm.taobao.org” > ~/.npmrc\n4. npm install azure-cli -g\n\n```\n","source":"_posts/Azure-2-HowTo-Use-Azure-CLI-on-Mac.md","raw":"---\ntitle: Azure(2) HowTo Use Azure CLI on Mac\ntags: 'Azure'\ncategories: 'Azure'\npermalink: azure-cli-on-mac-0\nid: 56\nupdated: '2017-04-21 13:29:46'\ndate: 2016-05-24 07:00:12\n---\n\n```\n## Install azure-cli on Mac and CentOS\n\n### In Mac\n1. Install brew.\n2. brew install nodejs\n3. echo “registry = https://registry.npm.taobao.org” > ~/.npmrc\n4. npm install azure-cli -g\n\n\n### In CentOS\n1. Install epel\n2. yum install -y nodejs npm\n3. echo “registry = https://registry.npm.taobao.org” > ~/.npmrc\n4. npm install azure-cli -g\n\n```\n","slug":"azure-cli-on-mac-0","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq4k000241tp30wk8l03","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">## Install azure-cli on Mac and CentOS</div><div class=\"line\"></div><div class=\"line\">### In Mac</div><div class=\"line\">1. Install brew.</div><div class=\"line\">2. brew install nodejs</div><div class=\"line\">3. echo “registry = https://registry.npm.taobao.org” &gt; ~/.npmrc</div><div class=\"line\">4. npm install azure-cli -g</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">### In CentOS</div><div class=\"line\">1. Install epel</div><div class=\"line\">2. yum install -y nodejs npm</div><div class=\"line\">3. echo “registry = https://registry.npm.taobao.org” &gt; ~/.npmrc</div><div class=\"line\">4. npm install azure-cli -g</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">## Install azure-cli on Mac and CentOS</div><div class=\"line\"></div><div class=\"line\">### In Mac</div><div class=\"line\">1. Install brew.</div><div class=\"line\">2. brew install nodejs</div><div class=\"line\">3. echo “registry = https://registry.npm.taobao.org” &gt; ~/.npmrc</div><div class=\"line\">4. npm install azure-cli -g</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">### In CentOS</div><div class=\"line\">1. Install epel</div><div class=\"line\">2. yum install -y nodejs npm</div><div class=\"line\">3. echo “registry = https://registry.npm.taobao.org” &gt; ~/.npmrc</div><div class=\"line\">4. npm install azure-cli -g</div></pre></td></tr></table></figure>\n"},{"title":"Azure(3) HowTo Use Azure CLI on Mac","id":"55","updated":"2017-04-21T05:32:20.000Z","date":"2016-05-23T22:20:43.000Z","_content":"\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/D50E240D-1468-486F-8CA7-C5D3DC7463DE.png)\n","source":"_posts/Azure-3-HowTo-Use-Azure-CLI-on-Mac.md","raw":"---\ntitle: Azure(3) HowTo Use Azure CLI on Mac\ntags: 'Azure'\ncategories: 'Azure'\npermalink: azure-cli-on-mac\nid: 55\nupdated: '2017-04-21 13:32:20'\ndate: 2016-05-24 06:20:43\n---\n\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/D50E240D-1468-486F-8CA7-C5D3DC7463DE.png)\n","slug":"azure-cli-on-mac","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq57000641tpiyd1f559","content":"<p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/D50E240D-1468-486F-8CA7-C5D3DC7463DE.png\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/D50E240D-1468-486F-8CA7-C5D3DC7463DE.png\" alt=\"\"></p>\n"},{"title":"Azure(4) 创建和使用Azure Redis Cache","id":"48","updated":"2017-04-21T05:34:30.000Z","date":"2016-05-11T22:12:02.000Z","_content":"\n\n我们以管理员身份，运行PowerShell，执行以下命令。实现创建Standard类型，大小为13GB的Redis Cache\n\n```\n#弹出界面输入用户名密码\nAdd-AzureAccount -Environment AzureChinaCloud\n\n#设置当前订阅名称\nSelect-AzureSubscription '[SubscriptionName]' –Current\n\nSwitch-AzureMode -name AzureResourceManager\n\n#在中国东部数据中心，创建新的资源组\nNew-AzureResourceGroup -name [YourResourceGroupName] -Location 'China East'\n\n#在中国东部数据中心，申请13GB的Redis Cache，类型为Standard，有SLA保证\nNew-AzureRedisCache -ResourceGroupName [YourResourceGroupName] -Name [RedisCacheName] -Location 'China East' -sku 'Standard' -Size '13GB'\n```\n","source":"_posts/Azure-4-创建和使用Azure-Redis-Cache.md","raw":"---\ntitle: Azure(4) 创建和使用Azure Redis Cache\ntags: 'Azure'\ncategories: 'Azure'\npermalink: chuang-jian-he-shi-yong-azure-redis-cache\nid: 48\nupdated: '2017-04-21 13:34:30'\ndate: 2016-05-12 06:12:02\n---\n\n\n我们以管理员身份，运行PowerShell，执行以下命令。实现创建Standard类型，大小为13GB的Redis Cache\n\n```\n#弹出界面输入用户名密码\nAdd-AzureAccount -Environment AzureChinaCloud\n\n#设置当前订阅名称\nSelect-AzureSubscription '[SubscriptionName]' –Current\n\nSwitch-AzureMode -name AzureResourceManager\n\n#在中国东部数据中心，创建新的资源组\nNew-AzureResourceGroup -name [YourResourceGroupName] -Location 'China East'\n\n#在中国东部数据中心，申请13GB的Redis Cache，类型为Standard，有SLA保证\nNew-AzureRedisCache -ResourceGroupName [YourResourceGroupName] -Name [RedisCacheName] -Location 'China East' -sku 'Standard' -Size '13GB'\n```\n","slug":"chuang-jian-he-shi-yong-azure-redis-cache","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq5a000741tpiirppxgx","content":"<p>我们以管理员身份，运行PowerShell，执行以下命令。实现创建Standard类型，大小为13GB的Redis Cache</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">#弹出界面输入用户名密码</div><div class=\"line\">Add-AzureAccount -Environment AzureChinaCloud</div><div class=\"line\"></div><div class=\"line\">#设置当前订阅名称</div><div class=\"line\">Select-AzureSubscription &apos;[SubscriptionName]&apos; –Current</div><div class=\"line\"></div><div class=\"line\">Switch-AzureMode -name AzureResourceManager</div><div class=\"line\"></div><div class=\"line\">#在中国东部数据中心，创建新的资源组</div><div class=\"line\">New-AzureResourceGroup -name [YourResourceGroupName] -Location &apos;China East&apos;</div><div class=\"line\"></div><div class=\"line\">#在中国东部数据中心，申请13GB的Redis Cache，类型为Standard，有SLA保证</div><div class=\"line\">New-AzureRedisCache -ResourceGroupName [YourResourceGroupName] -Name [RedisCacheName] -Location &apos;China East&apos; -sku &apos;Standard&apos; -Size &apos;13GB&apos;</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>我们以管理员身份，运行PowerShell，执行以下命令。实现创建Standard类型，大小为13GB的Redis Cache</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">#弹出界面输入用户名密码</div><div class=\"line\">Add-AzureAccount -Environment AzureChinaCloud</div><div class=\"line\"></div><div class=\"line\">#设置当前订阅名称</div><div class=\"line\">Select-AzureSubscription &apos;[SubscriptionName]&apos; –Current</div><div class=\"line\"></div><div class=\"line\">Switch-AzureMode -name AzureResourceManager</div><div class=\"line\"></div><div class=\"line\">#在中国东部数据中心，创建新的资源组</div><div class=\"line\">New-AzureResourceGroup -name [YourResourceGroupName] -Location &apos;China East&apos;</div><div class=\"line\"></div><div class=\"line\">#在中国东部数据中心，申请13GB的Redis Cache，类型为Standard，有SLA保证</div><div class=\"line\">New-AzureRedisCache -ResourceGroupName [YourResourceGroupName] -Name [RedisCacheName] -Location &apos;China East&apos; -sku &apos;Standard&apos; -Size &apos;13GB&apos;</div></pre></td></tr></table></figure>\n"},{"title":"CentOS 6(1) 使用createrepo搭建本地源","id":"14","updated":"2017-04-21T05:38:27.000Z","date":"2016-03-28T19:37:31.000Z","_content":"\n\n> Tips: 本地搭建本地yum源采用的rpm全部来自CentOS-6.7-bin-DVD1&DVD2\n\n### 1. 测试环境\n\n* MacBook Pro 15-inch i7 16GB\n* VMware Fushion 8 Pro\n* CentOS-6.7-i686-minimal.iso\n\n因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。\n\n### 2. 实验步骤\n\n\n```\n# 2.1 因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。\n[adam@ultraera ~]$ su -\nPassword:\n[root@ultraera ~]#\n\n# 2.2 首先在本地创建一个存放rpm包的目录，我这里选择直接在/下创建，你可以自定义：\n[root@ultraera ~]# mkdir /yumload\n[root@ultraera ~]# cd /yumload/\n[root@ultraera yumload]# pwd\n/yumload\n# 2.3 接下来把两张DVD中的Packages中的rpm包全部拷贝到/yumload:\n[root@ultraera yumload]# cp /media/CentOS_6.5_Final/Packages/* ./\n[root@ultraera yumload]# ll ./*.rpm | wc -l\n\n#两张DVD一共有的rpm包的数量:\n4802\n\n\n# 2.4 然后使用createrepo指令创建本地repo，CentOS6默认不安装createrepo，需要手动安装，没关系，在我们的DVD光盘中已经集成了createrepo的包，如果报需要依赖安装其他包的使用，依次安装即可。\n\n[root@ultraera yumload]# rpm -ivh createrepo-0.9.9-18.el6.noarch.rpm\n\n# 2.5 创建yum仓库，耐心等待，可以加-v参数列出执行信息\n[root@ultraera yumload]# createrepo /yumload/\nSpawning worker 0 with 4802 pkgs\nWorkers Finished\nGathering worker results\nSaving Primary metadata\nSaving file lists metadata\nSaving other metadata\nGenerating sqlite DBs\nSqlite DBs complete\n[root@ultraera yumload]#\n\n# 2.6 在/etc/yum.repo.d/下创建一个repo文件，文件名可以自定义，但一定要以repo结尾，并添加一下内容：\n[ultraera.org]\t#仓库名称可以自定义\nname=This is a local repo\t#描述信息\nbaseurl=file:///yumload/\t#这里填写仓库的url，注意 有三个正斜线\nenabled=1\t#是否开启仓库，1为开启，0为关闭\ngpgcheck=0\t#是否检查gpgkey，1为开启，0为关闭\n\n# 2.7 另外如果想要添加软件包group的信息，可以把DVD1中的repodata文件中的*-comps.xml文件，使用ceraterepo -g 加载本地仓库即可，代码如下：\n[root@ultraera repodata]# createrepo -g [字符可能不一样，后缀正确就行]c6-i386-comps.xml /yumload/\n\n\n# 2.8 到这里本地yum源就已经搭建完成了，接下来重新初始化yum缓存：\n[root@ultraera repodata]# yum clean all\nLoaded plugins: fastestmirror, refresh-packagekit, security\nCleaning repos: ultraera.org\nCleaning up Everything\nCleaning up list of fastest mirrors\n[root@ultraera repodata]# yum makecache\nLoaded plugins: fastestmirror, refresh-packagekit, security\nDetermining fastest mirrors\nultraera.org\t| 2.9 kB\t00:00 ...\nultraera.org/filelists_db\t| 4.9 MB\t00:00 ...\nultraera.org/primary_db\t| 3.5 MB\t00:00 ...\nultraera.org/other_db\t| 2.1 MB\t00:00 ...\nMetadata Cache Created\n\n# 2.9 测试group信息是否添加正确可以用如下代码，只要有正确输出信息就表示成功了\n[root@ultraera ~]# yum grouplist\n\n\n```\n","source":"_posts/CentOS-6-1-使用createrepo搭建本地源.md","raw":"---\ntitle: CentOS 6(1) 使用createrepo搭建本地源\ntags: 'Yum'\ncategories: 'CentOS'\npermalink: centos65shi-yong-createrepoda-jian-ben-di-yuan\nid: 14\nupdated: '2017-04-21 13:38:27'\ndate: 2016-03-29 03:37:31\n---\n\n\n> Tips: 本地搭建本地yum源采用的rpm全部来自CentOS-6.7-bin-DVD1&DVD2\n\n### 1. 测试环境\n\n* MacBook Pro 15-inch i7 16GB\n* VMware Fushion 8 Pro\n* CentOS-6.7-i686-minimal.iso\n\n因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。\n\n### 2. 实验步骤\n\n\n```\n# 2.1 因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。\n[adam@ultraera ~]$ su -\nPassword:\n[root@ultraera ~]#\n\n# 2.2 首先在本地创建一个存放rpm包的目录，我这里选择直接在/下创建，你可以自定义：\n[root@ultraera ~]# mkdir /yumload\n[root@ultraera ~]# cd /yumload/\n[root@ultraera yumload]# pwd\n/yumload\n# 2.3 接下来把两张DVD中的Packages中的rpm包全部拷贝到/yumload:\n[root@ultraera yumload]# cp /media/CentOS_6.5_Final/Packages/* ./\n[root@ultraera yumload]# ll ./*.rpm | wc -l\n\n#两张DVD一共有的rpm包的数量:\n4802\n\n\n# 2.4 然后使用createrepo指令创建本地repo，CentOS6默认不安装createrepo，需要手动安装，没关系，在我们的DVD光盘中已经集成了createrepo的包，如果报需要依赖安装其他包的使用，依次安装即可。\n\n[root@ultraera yumload]# rpm -ivh createrepo-0.9.9-18.el6.noarch.rpm\n\n# 2.5 创建yum仓库，耐心等待，可以加-v参数列出执行信息\n[root@ultraera yumload]# createrepo /yumload/\nSpawning worker 0 with 4802 pkgs\nWorkers Finished\nGathering worker results\nSaving Primary metadata\nSaving file lists metadata\nSaving other metadata\nGenerating sqlite DBs\nSqlite DBs complete\n[root@ultraera yumload]#\n\n# 2.6 在/etc/yum.repo.d/下创建一个repo文件，文件名可以自定义，但一定要以repo结尾，并添加一下内容：\n[ultraera.org]\t#仓库名称可以自定义\nname=This is a local repo\t#描述信息\nbaseurl=file:///yumload/\t#这里填写仓库的url，注意 有三个正斜线\nenabled=1\t#是否开启仓库，1为开启，0为关闭\ngpgcheck=0\t#是否检查gpgkey，1为开启，0为关闭\n\n# 2.7 另外如果想要添加软件包group的信息，可以把DVD1中的repodata文件中的*-comps.xml文件，使用ceraterepo -g 加载本地仓库即可，代码如下：\n[root@ultraera repodata]# createrepo -g [字符可能不一样，后缀正确就行]c6-i386-comps.xml /yumload/\n\n\n# 2.8 到这里本地yum源就已经搭建完成了，接下来重新初始化yum缓存：\n[root@ultraera repodata]# yum clean all\nLoaded plugins: fastestmirror, refresh-packagekit, security\nCleaning repos: ultraera.org\nCleaning up Everything\nCleaning up list of fastest mirrors\n[root@ultraera repodata]# yum makecache\nLoaded plugins: fastestmirror, refresh-packagekit, security\nDetermining fastest mirrors\nultraera.org\t| 2.9 kB\t00:00 ...\nultraera.org/filelists_db\t| 4.9 MB\t00:00 ...\nultraera.org/primary_db\t| 3.5 MB\t00:00 ...\nultraera.org/other_db\t| 2.1 MB\t00:00 ...\nMetadata Cache Created\n\n# 2.9 测试group信息是否添加正确可以用如下代码，只要有正确输出信息就表示成功了\n[root@ultraera ~]# yum grouplist\n\n\n```\n","slug":"centos65shi-yong-createrepoda-jian-ben-di-yuan","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq5e000841tpz1smgvgk","content":"<blockquote>\n<p>Tips: 本地搭建本地yum源采用的rpm全部来自CentOS-6.7-bin-DVD1&amp;DVD2</p>\n</blockquote>\n<h3 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h3><ul>\n<li>MacBook Pro 15-inch i7 16GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>CentOS-6.7-i686-minimal.iso</li>\n</ul>\n<p>因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。</p>\n<h3 id=\"2-实验步骤\"><a href=\"#2-实验步骤\" class=\"headerlink\" title=\"2. 实验步骤\"></a>2. 实验步骤</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 2.1 因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。</div><div class=\"line\">[adam@ultraera ~]$ su -</div><div class=\"line\">Password:</div><div class=\"line\">[root@ultraera ~]#</div><div class=\"line\"></div><div class=\"line\"># 2.2 首先在本地创建一个存放rpm包的目录，我这里选择直接在/下创建，你可以自定义：</div><div class=\"line\">[root@ultraera ~]# mkdir /yumload</div><div class=\"line\">[root@ultraera ~]# cd /yumload/</div><div class=\"line\">[root@ultraera yumload]# pwd</div><div class=\"line\">/yumload</div><div class=\"line\"># 2.3 接下来把两张DVD中的Packages中的rpm包全部拷贝到/yumload:</div><div class=\"line\">[root@ultraera yumload]# cp /media/CentOS_6.5_Final/Packages/* ./</div><div class=\"line\">[root@ultraera yumload]# ll ./*.rpm | wc -l</div><div class=\"line\"></div><div class=\"line\">#两张DVD一共有的rpm包的数量:</div><div class=\"line\">4802</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 2.4 然后使用createrepo指令创建本地repo，CentOS6默认不安装createrepo，需要手动安装，没关系，在我们的DVD光盘中已经集成了createrepo的包，如果报需要依赖安装其他包的使用，依次安装即可。</div><div class=\"line\"></div><div class=\"line\">[root@ultraera yumload]# rpm -ivh createrepo-0.9.9-18.el6.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># 2.5 创建yum仓库，耐心等待，可以加-v参数列出执行信息</div><div class=\"line\">[root@ultraera yumload]# createrepo /yumload/</div><div class=\"line\">Spawning worker 0 with 4802 pkgs</div><div class=\"line\">Workers Finished</div><div class=\"line\">Gathering worker results</div><div class=\"line\">Saving Primary metadata</div><div class=\"line\">Saving file lists metadata</div><div class=\"line\">Saving other metadata</div><div class=\"line\">Generating sqlite DBs</div><div class=\"line\">Sqlite DBs complete</div><div class=\"line\">[root@ultraera yumload]#</div><div class=\"line\"></div><div class=\"line\"># 2.6 在/etc/yum.repo.d/下创建一个repo文件，文件名可以自定义，但一定要以repo结尾，并添加一下内容：</div><div class=\"line\">[ultraera.org]\t#仓库名称可以自定义</div><div class=\"line\">name=This is a local repo\t#描述信息</div><div class=\"line\">baseurl=file:///yumload/\t#这里填写仓库的url，注意 有三个正斜线</div><div class=\"line\">enabled=1\t#是否开启仓库，1为开启，0为关闭</div><div class=\"line\">gpgcheck=0\t#是否检查gpgkey，1为开启，0为关闭</div><div class=\"line\"></div><div class=\"line\"># 2.7 另外如果想要添加软件包group的信息，可以把DVD1中的repodata文件中的*-comps.xml文件，使用ceraterepo -g 加载本地仓库即可，代码如下：</div><div class=\"line\">[root@ultraera repodata]# createrepo -g [字符可能不一样，后缀正确就行]c6-i386-comps.xml /yumload/</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 2.8 到这里本地yum源就已经搭建完成了，接下来重新初始化yum缓存：</div><div class=\"line\">[root@ultraera repodata]# yum clean all</div><div class=\"line\">Loaded plugins: fastestmirror, refresh-packagekit, security</div><div class=\"line\">Cleaning repos: ultraera.org</div><div class=\"line\">Cleaning up Everything</div><div class=\"line\">Cleaning up list of fastest mirrors</div><div class=\"line\">[root@ultraera repodata]# yum makecache</div><div class=\"line\">Loaded plugins: fastestmirror, refresh-packagekit, security</div><div class=\"line\">Determining fastest mirrors</div><div class=\"line\">ultraera.org\t| 2.9 kB\t00:00 ...</div><div class=\"line\">ultraera.org/filelists_db\t| 4.9 MB\t00:00 ...</div><div class=\"line\">ultraera.org/primary_db\t| 3.5 MB\t00:00 ...</div><div class=\"line\">ultraera.org/other_db\t| 2.1 MB\t00:00 ...</div><div class=\"line\">Metadata Cache Created</div><div class=\"line\"></div><div class=\"line\"># 2.9 测试group信息是否添加正确可以用如下代码，只要有正确输出信息就表示成功了</div><div class=\"line\">[root@ultraera ~]# yum grouplist</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>Tips: 本地搭建本地yum源采用的rpm全部来自CentOS-6.7-bin-DVD1&amp;DVD2</p>\n</blockquote>\n<h3 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h3><ul>\n<li>MacBook Pro 15-inch i7 16GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>CentOS-6.7-i686-minimal.iso</li>\n</ul>\n<p>因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。</p>\n<h3 id=\"2-实验步骤\"><a href=\"#2-实验步骤\" class=\"headerlink\" title=\"2. 实验步骤\"></a>2. 实验步骤</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 2.1 因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。</div><div class=\"line\">[adam@ultraera ~]$ su -</div><div class=\"line\">Password:</div><div class=\"line\">[root@ultraera ~]#</div><div class=\"line\"></div><div class=\"line\"># 2.2 首先在本地创建一个存放rpm包的目录，我这里选择直接在/下创建，你可以自定义：</div><div class=\"line\">[root@ultraera ~]# mkdir /yumload</div><div class=\"line\">[root@ultraera ~]# cd /yumload/</div><div class=\"line\">[root@ultraera yumload]# pwd</div><div class=\"line\">/yumload</div><div class=\"line\"># 2.3 接下来把两张DVD中的Packages中的rpm包全部拷贝到/yumload:</div><div class=\"line\">[root@ultraera yumload]# cp /media/CentOS_6.5_Final/Packages/* ./</div><div class=\"line\">[root@ultraera yumload]# ll ./*.rpm | wc -l</div><div class=\"line\"></div><div class=\"line\">#两张DVD一共有的rpm包的数量:</div><div class=\"line\">4802</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 2.4 然后使用createrepo指令创建本地repo，CentOS6默认不安装createrepo，需要手动安装，没关系，在我们的DVD光盘中已经集成了createrepo的包，如果报需要依赖安装其他包的使用，依次安装即可。</div><div class=\"line\"></div><div class=\"line\">[root@ultraera yumload]# rpm -ivh createrepo-0.9.9-18.el6.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># 2.5 创建yum仓库，耐心等待，可以加-v参数列出执行信息</div><div class=\"line\">[root@ultraera yumload]# createrepo /yumload/</div><div class=\"line\">Spawning worker 0 with 4802 pkgs</div><div class=\"line\">Workers Finished</div><div class=\"line\">Gathering worker results</div><div class=\"line\">Saving Primary metadata</div><div class=\"line\">Saving file lists metadata</div><div class=\"line\">Saving other metadata</div><div class=\"line\">Generating sqlite DBs</div><div class=\"line\">Sqlite DBs complete</div><div class=\"line\">[root@ultraera yumload]#</div><div class=\"line\"></div><div class=\"line\"># 2.6 在/etc/yum.repo.d/下创建一个repo文件，文件名可以自定义，但一定要以repo结尾，并添加一下内容：</div><div class=\"line\">[ultraera.org]\t#仓库名称可以自定义</div><div class=\"line\">name=This is a local repo\t#描述信息</div><div class=\"line\">baseurl=file:///yumload/\t#这里填写仓库的url，注意 有三个正斜线</div><div class=\"line\">enabled=1\t#是否开启仓库，1为开启，0为关闭</div><div class=\"line\">gpgcheck=0\t#是否检查gpgkey，1为开启，0为关闭</div><div class=\"line\"></div><div class=\"line\"># 2.7 另外如果想要添加软件包group的信息，可以把DVD1中的repodata文件中的*-comps.xml文件，使用ceraterepo -g 加载本地仓库即可，代码如下：</div><div class=\"line\">[root@ultraera repodata]# createrepo -g [字符可能不一样，后缀正确就行]c6-i386-comps.xml /yumload/</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 2.8 到这里本地yum源就已经搭建完成了，接下来重新初始化yum缓存：</div><div class=\"line\">[root@ultraera repodata]# yum clean all</div><div class=\"line\">Loaded plugins: fastestmirror, refresh-packagekit, security</div><div class=\"line\">Cleaning repos: ultraera.org</div><div class=\"line\">Cleaning up Everything</div><div class=\"line\">Cleaning up list of fastest mirrors</div><div class=\"line\">[root@ultraera repodata]# yum makecache</div><div class=\"line\">Loaded plugins: fastestmirror, refresh-packagekit, security</div><div class=\"line\">Determining fastest mirrors</div><div class=\"line\">ultraera.org\t| 2.9 kB\t00:00 ...</div><div class=\"line\">ultraera.org/filelists_db\t| 4.9 MB\t00:00 ...</div><div class=\"line\">ultraera.org/primary_db\t| 3.5 MB\t00:00 ...</div><div class=\"line\">ultraera.org/other_db\t| 2.1 MB\t00:00 ...</div><div class=\"line\">Metadata Cache Created</div><div class=\"line\"></div><div class=\"line\"># 2.9 测试group信息是否添加正确可以用如下代码，只要有正确输出信息就表示成功了</div><div class=\"line\">[root@ultraera ~]# yum grouplist</div></pre></td></tr></table></figure>\n"},{"title":"CentOS 6(2) 初始安装基本优化操作","id":"4","updated":"2017-04-21T05:40:22.000Z","date":"2016-03-18T21:54:23.000Z","_content":"\n## CentOS 6.x 初始安装基本优化操作\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文件是采用的模板是centos 6.x，相较于centos 5.x与centos 7.x系列有些区别，不能一概而论。\n\n### 1. 测试环境\n\n* MacBook Pro 15-inch i7 8GB\n* VMware Fushion 8 Pro\n* CentOS-6.7-x86_64-minimal.iso\n\n### 2. 默认网卡开机未设定自启动\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;很多初学者，在安装系统的时候，碰到的第一个问题就是不能上网，所以有些同学就担心是不是需要去安装网卡驱动，其实这样想就把问题复杂化了，如果你在实体机安装Linux的系统时，可能会碰到网卡驱动不上导致无法上网的问题，这个时候是需要自行安装驱动的，但是我们使用的VMware的一款虚拟化工具，所以网卡驱动基本就不用考虑，原因是因为我们没有把网卡设置为开机自启动，下面讲如何开启网卡，并设定为开机自启动。\n\n```\n[root@vm02 ~]# ifup eth0\n\nDetermining IP information for eth0... done.\n[root@vm02 ~]# \n[root@vm02 ~]# ifconfig eth0\neth0      Link encap:Ethernet  HWaddr 00:0C:29:B9:60:D8\n          inet addr:172.16.102.129  Bcast:172.16.102.255  Mask:255.255.255.0\n          inet6 addr: fe80::20c:29ff:feb9:60d8/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:127 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:85 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:14010 (13.6 KiB)  TX bytes:11410 (11.1 KiB)\n          \n[root@vm02 ~]# vi /etc/sysconfig/network-scripts/ifcfg-eth0\n\tDEVICE=eth0\n\tHWADDR=00:0C:29:B9:60:D8\n\tTYPE=Ethernet\n\tUUID=7ad636ff-78d9-4afa-9886-706b1de236a8\n\tONBOOT=no\t\t // 默认是no，修改为yes\n\tNM_CONTROLLED=yes\n\tBOOTPROTO=dhcp\n\n```\n\n### 3. 增加第三方Yum源\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CentOS 系统内置的官方源软件更新较慢，而且缺少一些常用软件包，建议安装epel源，EPEL 是 Extra Packages for Enterprise Linux 的缩写（EPEL），是用于 Fedora-based Red Hat Enterprise Linux (RHEL) 的一个高质量软件源，所以同时也适用于 CentOS 或者 Scientific Linux 等发行版。\n\n##### a. 因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：[wget是Linux常用的命令行下载工具]\n\n```\n[root@vm02 ~]# yum install -y wget\nLoaded plugins: fastestmirror\nSetting up Install Process\nbase                                                     | 3.7 kB     00:00\nbase/primary_db                                          | 4.6 MB     00:32\nextras                                                   | 3.4 kB     00:00\nextras/primary_db                                        |  34 kB     00:00\nupdates                                                  | 3.4 kB     00:00\nupdates/primary_db                                       | 4.0 MB     01:05\nResolving Dependencies\n--> Running transaction check\n---> Package wget.x86_64 0:1.12-5.el6_6.1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package        Arch             Version                   Repository      Size\n================================================================================\nInstalling:\n wget           x86_64           1.12-5.el6_6.1            base           483 k\n\nTransaction Summary\n================================================================================\nInstall       1 Package(s)\n\nTotal download size: 483 k\nInstalled size: 1.8 M\nDownloading Packages:\nwget-1.12-5.el6_6.1.x86_64.rpm                           | 483 kB     00:01\nwarning: rpmts_HdrFromFdno: Header V3 RSA/SHA1 Signature, key ID c105b9de: NOKEY\nRetrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6\nImporting GPG key 0xC105B9DE:\n Userid : CentOS-6 Key (CentOS 6 Official Signing Key) <centos-6-key@centos.org>\n Package: centos-release-6-7.el6.centos.12.3.x86_64 (@anaconda-CentOS-201508042137.x86_64/6.7)\n From   : /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\n  Installing : wget-1.12-5.el6_6.1.x86_64                                   1/1\n  Verifying  : wget-1.12-5.el6_6.1.x86_64                                   1/1\n\nInstalled:\n  wget.x86_64 0:1.12-5.el6_6.1\n\nComplete!\n[root@vm02 ~]#\n```\n##### b. 下载并安装epel源\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;不同CentOS版本的epel下载地址：\n\n* CentOS 5 ： https://dl.fedoraproject.org/pub/epel/epel-release-latest-5.noarch.rpm\n* CentOS 6 ： https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\n* CentOS 7 ： https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本次试验用到的CentOS 6 所以我们下载epel-release-latest-6.noarch.rpm\n\n```\n[root@vm02 ~]# wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\n--2016-03-18 11:47:17--  https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\nResolving dl.fedoraproject.org... 209.132.181.26, 209.132.181.23, 209.132.181.24, ...\nConnecting to dl.fedoraproject.org|209.132.181.26|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 14540 (14K) [application/x-rpm]\nSaving to: “epel-release-latest-6.noarch.rpm”\n\n100%[======================================>] 14,540      69.5K/s   in 0.2s\n\n2016-03-18 11:47:25 (69.5 KB/s) - “epel-release-latest-6.noarch.rpm” saved [14540/14540]\n\n[root@vm02 ~]# ls\nanaconda-ks.cfg                   install.log\nepel-release-latest-6.noarch.rpm  install.log.syslog\n```\n\n### 4. 安装vim：Linux使用最广泛的文件编辑工具\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;与我们长久使用Win环境不同的是，在Linux之中，我们接触最多的是command line，所以熟练一款命令行下的文本编辑工具是一项必备技能，我这里推荐大家：vim。\n\n```\n[root@vm02 ~]# yum install -y vim\nLoaded plugins: fastestmirror\nSetting up Install Process\nDetermining fastest mirrors\n * base: mirrors.aliyun.com\n * extras: mirrors.aliyun.com\n * updates: mirrors.aliyun.com\nResolving Dependencies\n--> Running transaction check\n---> Package vim-enhanced.x86_64 2:7.4.629-5.el6 will be installed\n--> Processing Dependency: vim-common = 2:7.4.629-5.el6 for package: 2:vim-enhanced-7.4.629-5.el6.x86_64\n--> Processing Dependency: perl(:MODULE_COMPAT_5.10.1) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64\n--> Processing Dependency: libperl.so()(64bit) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64\n--> Processing Dependency: libgpm.so.2()(64bit) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64\n--> Running transaction check\n---> Package gpm-libs.x86_64 0:1.20.6-12.el6 will be installed\n---> Package perl.x86_64 4:5.10.1-141.el6_7.1 will be installed\n--> Processing Dependency: perl(version) for package: 4:perl-5.10.1-141.el6_7.1.x86_64\n--> Processing Dependency: perl(Pod::Simple) for package: 4:perl-5.10.1-141.el6_7.1.x86_64\n--> Processing Dependency: perl(Module::Pluggable) for package: 4:perl-5.10.1-141.el6_7.1.x86_64\n---> Package perl-libs.x86_64 4:5.10.1-141.el6_7.1 will be installed\n---> Package vim-common.x86_64 2:7.4.629-5.el6 will be installed\n--> Processing Dependency: vim-filesystem for package: 2:vim-common-7.4.629-5.el6.x86_64\n--> Running transaction check\n---> Package perl-Module-Pluggable.x86_64 1:3.90-141.el6_7.1 will be installed\n---> Package perl-Pod-Simple.x86_64 1:3.13-141.el6_7.1 will be installed\n--> Processing Dependency: perl(Pod::Escapes) >= 1.04 for package: 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64\n---> Package perl-version.x86_64 3:0.77-141.el6_7.1 will be installed\n---> Package vim-filesystem.x86_64 2:7.4.629-5.el6 will be installed\n--> Running transaction check\n---> Package perl-Pod-Escapes.x86_64 1:1.04-141.el6_7.1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n=============================================================================================================================================================================\n Package                                          Arch                              Version                                         Repository                          Size\n=============================================================================================================================================================================\nInstalling:\n vim-enhanced                                     x86_64                            2:7.4.629-5.el6                                 base                               1.0 M\nInstalling for dependencies:\n gpm-libs                                         x86_64                            1.20.6-12.el6                                   base                                28 k\n perl                                             x86_64                            4:5.10.1-141.el6_7.1                            updates                             10 M\n perl-Module-Pluggable                            x86_64                            1:3.90-141.el6_7.1                              updates                             40 k\n perl-Pod-Escapes                                 x86_64                            1:1.04-141.el6_7.1                              updates                             33 k\n perl-Pod-Simple                                  x86_64                            1:3.13-141.el6_7.1                              updates                            213 k\n perl-libs                                        x86_64                            4:5.10.1-141.el6_7.1                            updates                            579 k\n perl-version                                     x86_64                            3:0.77-141.el6_7.1                              updates                             52 k\n vim-common                                       x86_64                            2:7.4.629-5.el6                                 base                               6.7 M\n vim-filesystem                                   x86_64                            2:7.4.629-5.el6                                 base                                15 k\n\nTransaction Summary\n=============================================================================================================================================================================\nInstall      10 Package(s)\n\nTotal download size: 19 M\nInstalled size: 59 M\nDownloading Packages:\n(1/10): gpm-libs-1.20.6-12.el6.x86_64.rpm                                                                                                             |  28 kB     00:00\n(2/10): perl-5.10.1-141.el6_7.1.x86_64.rpm                                                                                                            |  10 MB     00:10\n(3/10): perl-Module-Pluggable-3.90-141.el6_7.1.x86_64.rpm                                                                                             |  40 kB     00:00\n(4/10): perl-Pod-Escapes-1.04-141.el6_7.1.x86_64.rpm                                                                                                  |  33 kB     00:00\n(5/10): perl-Pod-Simple-3.13-141.el6_7.1.x86_64.rpm                                                                                                   | 213 kB     00:00\n(6/10): perl-libs-5.10.1-141.el6_7.1.x86_64.rpm                                                                                                       | 579 kB     00:00\n(7/10): perl-version-0.77-141.el6_7.1.x86_64.rpm                                                                                                      |  52 kB     00:00\n(8/10): vim-common-7.4.629-5.el6.x86_64.rpm                                                                                                           | 6.7 MB     00:07\n(9/10): vim-enhanced-7.4.629-5.el6.x86_64.rpm                                                                                                         | 1.0 MB     00:01\n(10/10): vim-filesystem-7.4.629-5.el6.x86_64.rpm                                                                                                      |  15 kB     00:00\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------\nTotal                                                                                                                                        980 kB/s |  19 MB     00:19\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\n  Installing : 1:perl-Pod-Escapes-1.04-141.el6_7.1.x86_64                                                                                                               1/10\n  Installing : 1:perl-Module-Pluggable-3.90-141.el6_7.1.x86_64                                                                                                          2/10\n  Installing : 3:perl-version-0.77-141.el6_7.1.x86_64                                                                                                                   3/10\n  Installing : 4:perl-libs-5.10.1-141.el6_7.1.x86_64                                                                                                                    4/10\n  Installing : 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64                                                                                                                5/10\n  Installing : 4:perl-5.10.1-141.el6_7.1.x86_64                                                                                                                         6/10\n  Installing : 2:vim-filesystem-7.4.629-5.el6.x86_64                                                                                                                    7/10\n  Installing : 2:vim-common-7.4.629-5.el6.x86_64                                                                                                                        8/10\n  Installing : gpm-libs-1.20.6-12.el6.x86_64                                                                                                                            9/10\n  Installing : 2:vim-enhanced-7.4.629-5.el6.x86_64                                                                                                                     10/10\n  Verifying  : 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64                                                                                                                1/10\n  Verifying  : 1:perl-Pod-Escapes-1.04-141.el6_7.1.x86_64                                                                                                               2/10\n  Verifying  : gpm-libs-1.20.6-12.el6.x86_64                                                                                                                            3/10\n  Verifying  : 2:vim-enhanced-7.4.629-5.el6.x86_64                                                                                                                      4/10\n  Verifying  : 2:vim-filesystem-7.4.629-5.el6.x86_64                                                                                                                    5/10\n  Verifying  : 1:perl-Module-Pluggable-3.90-141.el6_7.1.x86_64                                                                                                          6/10\n  Verifying  : 2:vim-common-7.4.629-5.el6.x86_64                                                                                                                        7/10\n  Verifying  : 3:perl-version-0.77-141.el6_7.1.x86_64                                                                                                                   8/10\n  Verifying  : 4:perl-libs-5.10.1-141.el6_7.1.x86_64                                                                                                                    9/10\n  Verifying  : 4:perl-5.10.1-141.el6_7.1.x86_64                                                                                                                        10/10\n\nInstalled:\n  vim-enhanced.x86_64 2:7.4.629-5.el6\n\nDependency Installed:\n  gpm-libs.x86_64 0:1.20.6-12.el6           perl.x86_64 4:5.10.1-141.el6_7.1      perl-Module-Pluggable.x86_64 1:3.90-141.el6_7.1 perl-Pod-Escapes.x86_64 1:1.04-141.el6_7.1\n  perl-Pod-Simple.x86_64 1:3.13-141.el6_7.1 perl-libs.x86_64 4:5.10.1-141.el6_7.1 perl-version.x86_64 3:0.77-141.el6_7.1          vim-common.x86_64 2:7.4.629-5.el6\n  vim-filesystem.x86_64 2:7.4.629-5.el6\n\nComplete!\n[root@vm02 ~]#\n\n```\n\n### 4. 关闭SELinux\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux主要由美国国家安全局开发，并于2000年12月22日发行给开放源代码的开发社区。SELinux旨在加强访问控制架构以对付入侵的威胁或任何企图略过安全架构的应用程序，并且从2.6版的Linux核心就开始集成SELinux；但是SELinux严格的权限控制对于初学者来说并不是非常必要，所以我们建议关闭SELinux，[其实由于SELinux的复杂性，很多运维人员都是选择关闭它，熟悉阿里云ECS的同学可能知道，它是默认关闭SELinux的，但是我们不建议在生产环境关闭SELinux。]\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux的配置文件主要由两个：/etc/sysconfig/selinux、 /etc/selinux/config，其实第一个是第二个路径的软链接。\n\n```\n[root@vm02 ~]# vim /etc/selinux/config\n# This file controls the state of SELinux on the system.\n# SELINUX= can take one of these three values:\n#     enforcing - SELinux security policy is enforced.\n#     permissive - SELinux prints warnings instead of enforcing.\n#     disabled - No SELinux policy is loaded.\nSELINUX=enforcing\n# SELINUXTYPE= can take one of these two values:\n#     targeted - Targeted processes are protected,\n#     mls - Multi Level Security protection.\nSELINUXTYPE=targeted\n\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 的状态模式：\n\n* enforcing : 强制启用SELinux\n* permissive : 只显示警告讯息以替代强制启用SELinux\n* disabled : 停用SELinux\n\n>Tips: SELinux的参数只能在重启后生效。\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 常用的两个命令：getenforce setenforce :\n\n* getenforce 获得SELinux 当前的状态，返回值为如上三种；\n* setenforce 临时改变SELinux的状态，参数为布尔值，0是关闭，1是开启。\n\n> Tips: 状态已经为disabled时，无法使用setenforce 1 启用。\n\n\n### 5. \n\n### 6.\n \n### 7.\n\n### 8.","source":"_posts/CentOS-6-2-初始安装基本优化操作.md","raw":"---\ntitle: CentOS 6(2) 初始安装基本优化操作\ntags: ' - CentOS 6 - Linux - CentOS'\npermalink: centos6-x-base-settings\nid: 4\nupdated: '2017-04-21 13:40:22'\ndate: 2016-03-19 05:54:23\n---\n\n## CentOS 6.x 初始安装基本优化操作\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文件是采用的模板是centos 6.x，相较于centos 5.x与centos 7.x系列有些区别，不能一概而论。\n\n### 1. 测试环境\n\n* MacBook Pro 15-inch i7 8GB\n* VMware Fushion 8 Pro\n* CentOS-6.7-x86_64-minimal.iso\n\n### 2. 默认网卡开机未设定自启动\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;很多初学者，在安装系统的时候，碰到的第一个问题就是不能上网，所以有些同学就担心是不是需要去安装网卡驱动，其实这样想就把问题复杂化了，如果你在实体机安装Linux的系统时，可能会碰到网卡驱动不上导致无法上网的问题，这个时候是需要自行安装驱动的，但是我们使用的VMware的一款虚拟化工具，所以网卡驱动基本就不用考虑，原因是因为我们没有把网卡设置为开机自启动，下面讲如何开启网卡，并设定为开机自启动。\n\n```\n[root@vm02 ~]# ifup eth0\n\nDetermining IP information for eth0... done.\n[root@vm02 ~]# \n[root@vm02 ~]# ifconfig eth0\neth0      Link encap:Ethernet  HWaddr 00:0C:29:B9:60:D8\n          inet addr:172.16.102.129  Bcast:172.16.102.255  Mask:255.255.255.0\n          inet6 addr: fe80::20c:29ff:feb9:60d8/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:127 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:85 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:14010 (13.6 KiB)  TX bytes:11410 (11.1 KiB)\n          \n[root@vm02 ~]# vi /etc/sysconfig/network-scripts/ifcfg-eth0\n\tDEVICE=eth0\n\tHWADDR=00:0C:29:B9:60:D8\n\tTYPE=Ethernet\n\tUUID=7ad636ff-78d9-4afa-9886-706b1de236a8\n\tONBOOT=no\t\t // 默认是no，修改为yes\n\tNM_CONTROLLED=yes\n\tBOOTPROTO=dhcp\n\n```\n\n### 3. 增加第三方Yum源\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CentOS 系统内置的官方源软件更新较慢，而且缺少一些常用软件包，建议安装epel源，EPEL 是 Extra Packages for Enterprise Linux 的缩写（EPEL），是用于 Fedora-based Red Hat Enterprise Linux (RHEL) 的一个高质量软件源，所以同时也适用于 CentOS 或者 Scientific Linux 等发行版。\n\n##### a. 因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：[wget是Linux常用的命令行下载工具]\n\n```\n[root@vm02 ~]# yum install -y wget\nLoaded plugins: fastestmirror\nSetting up Install Process\nbase                                                     | 3.7 kB     00:00\nbase/primary_db                                          | 4.6 MB     00:32\nextras                                                   | 3.4 kB     00:00\nextras/primary_db                                        |  34 kB     00:00\nupdates                                                  | 3.4 kB     00:00\nupdates/primary_db                                       | 4.0 MB     01:05\nResolving Dependencies\n--> Running transaction check\n---> Package wget.x86_64 0:1.12-5.el6_6.1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package        Arch             Version                   Repository      Size\n================================================================================\nInstalling:\n wget           x86_64           1.12-5.el6_6.1            base           483 k\n\nTransaction Summary\n================================================================================\nInstall       1 Package(s)\n\nTotal download size: 483 k\nInstalled size: 1.8 M\nDownloading Packages:\nwget-1.12-5.el6_6.1.x86_64.rpm                           | 483 kB     00:01\nwarning: rpmts_HdrFromFdno: Header V3 RSA/SHA1 Signature, key ID c105b9de: NOKEY\nRetrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6\nImporting GPG key 0xC105B9DE:\n Userid : CentOS-6 Key (CentOS 6 Official Signing Key) <centos-6-key@centos.org>\n Package: centos-release-6-7.el6.centos.12.3.x86_64 (@anaconda-CentOS-201508042137.x86_64/6.7)\n From   : /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\n  Installing : wget-1.12-5.el6_6.1.x86_64                                   1/1\n  Verifying  : wget-1.12-5.el6_6.1.x86_64                                   1/1\n\nInstalled:\n  wget.x86_64 0:1.12-5.el6_6.1\n\nComplete!\n[root@vm02 ~]#\n```\n##### b. 下载并安装epel源\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;不同CentOS版本的epel下载地址：\n\n* CentOS 5 ： https://dl.fedoraproject.org/pub/epel/epel-release-latest-5.noarch.rpm\n* CentOS 6 ： https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\n* CentOS 7 ： https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本次试验用到的CentOS 6 所以我们下载epel-release-latest-6.noarch.rpm\n\n```\n[root@vm02 ~]# wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\n--2016-03-18 11:47:17--  https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\nResolving dl.fedoraproject.org... 209.132.181.26, 209.132.181.23, 209.132.181.24, ...\nConnecting to dl.fedoraproject.org|209.132.181.26|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 14540 (14K) [application/x-rpm]\nSaving to: “epel-release-latest-6.noarch.rpm”\n\n100%[======================================>] 14,540      69.5K/s   in 0.2s\n\n2016-03-18 11:47:25 (69.5 KB/s) - “epel-release-latest-6.noarch.rpm” saved [14540/14540]\n\n[root@vm02 ~]# ls\nanaconda-ks.cfg                   install.log\nepel-release-latest-6.noarch.rpm  install.log.syslog\n```\n\n### 4. 安装vim：Linux使用最广泛的文件编辑工具\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;与我们长久使用Win环境不同的是，在Linux之中，我们接触最多的是command line，所以熟练一款命令行下的文本编辑工具是一项必备技能，我这里推荐大家：vim。\n\n```\n[root@vm02 ~]# yum install -y vim\nLoaded plugins: fastestmirror\nSetting up Install Process\nDetermining fastest mirrors\n * base: mirrors.aliyun.com\n * extras: mirrors.aliyun.com\n * updates: mirrors.aliyun.com\nResolving Dependencies\n--> Running transaction check\n---> Package vim-enhanced.x86_64 2:7.4.629-5.el6 will be installed\n--> Processing Dependency: vim-common = 2:7.4.629-5.el6 for package: 2:vim-enhanced-7.4.629-5.el6.x86_64\n--> Processing Dependency: perl(:MODULE_COMPAT_5.10.1) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64\n--> Processing Dependency: libperl.so()(64bit) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64\n--> Processing Dependency: libgpm.so.2()(64bit) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64\n--> Running transaction check\n---> Package gpm-libs.x86_64 0:1.20.6-12.el6 will be installed\n---> Package perl.x86_64 4:5.10.1-141.el6_7.1 will be installed\n--> Processing Dependency: perl(version) for package: 4:perl-5.10.1-141.el6_7.1.x86_64\n--> Processing Dependency: perl(Pod::Simple) for package: 4:perl-5.10.1-141.el6_7.1.x86_64\n--> Processing Dependency: perl(Module::Pluggable) for package: 4:perl-5.10.1-141.el6_7.1.x86_64\n---> Package perl-libs.x86_64 4:5.10.1-141.el6_7.1 will be installed\n---> Package vim-common.x86_64 2:7.4.629-5.el6 will be installed\n--> Processing Dependency: vim-filesystem for package: 2:vim-common-7.4.629-5.el6.x86_64\n--> Running transaction check\n---> Package perl-Module-Pluggable.x86_64 1:3.90-141.el6_7.1 will be installed\n---> Package perl-Pod-Simple.x86_64 1:3.13-141.el6_7.1 will be installed\n--> Processing Dependency: perl(Pod::Escapes) >= 1.04 for package: 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64\n---> Package perl-version.x86_64 3:0.77-141.el6_7.1 will be installed\n---> Package vim-filesystem.x86_64 2:7.4.629-5.el6 will be installed\n--> Running transaction check\n---> Package perl-Pod-Escapes.x86_64 1:1.04-141.el6_7.1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n=============================================================================================================================================================================\n Package                                          Arch                              Version                                         Repository                          Size\n=============================================================================================================================================================================\nInstalling:\n vim-enhanced                                     x86_64                            2:7.4.629-5.el6                                 base                               1.0 M\nInstalling for dependencies:\n gpm-libs                                         x86_64                            1.20.6-12.el6                                   base                                28 k\n perl                                             x86_64                            4:5.10.1-141.el6_7.1                            updates                             10 M\n perl-Module-Pluggable                            x86_64                            1:3.90-141.el6_7.1                              updates                             40 k\n perl-Pod-Escapes                                 x86_64                            1:1.04-141.el6_7.1                              updates                             33 k\n perl-Pod-Simple                                  x86_64                            1:3.13-141.el6_7.1                              updates                            213 k\n perl-libs                                        x86_64                            4:5.10.1-141.el6_7.1                            updates                            579 k\n perl-version                                     x86_64                            3:0.77-141.el6_7.1                              updates                             52 k\n vim-common                                       x86_64                            2:7.4.629-5.el6                                 base                               6.7 M\n vim-filesystem                                   x86_64                            2:7.4.629-5.el6                                 base                                15 k\n\nTransaction Summary\n=============================================================================================================================================================================\nInstall      10 Package(s)\n\nTotal download size: 19 M\nInstalled size: 59 M\nDownloading Packages:\n(1/10): gpm-libs-1.20.6-12.el6.x86_64.rpm                                                                                                             |  28 kB     00:00\n(2/10): perl-5.10.1-141.el6_7.1.x86_64.rpm                                                                                                            |  10 MB     00:10\n(3/10): perl-Module-Pluggable-3.90-141.el6_7.1.x86_64.rpm                                                                                             |  40 kB     00:00\n(4/10): perl-Pod-Escapes-1.04-141.el6_7.1.x86_64.rpm                                                                                                  |  33 kB     00:00\n(5/10): perl-Pod-Simple-3.13-141.el6_7.1.x86_64.rpm                                                                                                   | 213 kB     00:00\n(6/10): perl-libs-5.10.1-141.el6_7.1.x86_64.rpm                                                                                                       | 579 kB     00:00\n(7/10): perl-version-0.77-141.el6_7.1.x86_64.rpm                                                                                                      |  52 kB     00:00\n(8/10): vim-common-7.4.629-5.el6.x86_64.rpm                                                                                                           | 6.7 MB     00:07\n(9/10): vim-enhanced-7.4.629-5.el6.x86_64.rpm                                                                                                         | 1.0 MB     00:01\n(10/10): vim-filesystem-7.4.629-5.el6.x86_64.rpm                                                                                                      |  15 kB     00:00\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------\nTotal                                                                                                                                        980 kB/s |  19 MB     00:19\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\n  Installing : 1:perl-Pod-Escapes-1.04-141.el6_7.1.x86_64                                                                                                               1/10\n  Installing : 1:perl-Module-Pluggable-3.90-141.el6_7.1.x86_64                                                                                                          2/10\n  Installing : 3:perl-version-0.77-141.el6_7.1.x86_64                                                                                                                   3/10\n  Installing : 4:perl-libs-5.10.1-141.el6_7.1.x86_64                                                                                                                    4/10\n  Installing : 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64                                                                                                                5/10\n  Installing : 4:perl-5.10.1-141.el6_7.1.x86_64                                                                                                                         6/10\n  Installing : 2:vim-filesystem-7.4.629-5.el6.x86_64                                                                                                                    7/10\n  Installing : 2:vim-common-7.4.629-5.el6.x86_64                                                                                                                        8/10\n  Installing : gpm-libs-1.20.6-12.el6.x86_64                                                                                                                            9/10\n  Installing : 2:vim-enhanced-7.4.629-5.el6.x86_64                                                                                                                     10/10\n  Verifying  : 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64                                                                                                                1/10\n  Verifying  : 1:perl-Pod-Escapes-1.04-141.el6_7.1.x86_64                                                                                                               2/10\n  Verifying  : gpm-libs-1.20.6-12.el6.x86_64                                                                                                                            3/10\n  Verifying  : 2:vim-enhanced-7.4.629-5.el6.x86_64                                                                                                                      4/10\n  Verifying  : 2:vim-filesystem-7.4.629-5.el6.x86_64                                                                                                                    5/10\n  Verifying  : 1:perl-Module-Pluggable-3.90-141.el6_7.1.x86_64                                                                                                          6/10\n  Verifying  : 2:vim-common-7.4.629-5.el6.x86_64                                                                                                                        7/10\n  Verifying  : 3:perl-version-0.77-141.el6_7.1.x86_64                                                                                                                   8/10\n  Verifying  : 4:perl-libs-5.10.1-141.el6_7.1.x86_64                                                                                                                    9/10\n  Verifying  : 4:perl-5.10.1-141.el6_7.1.x86_64                                                                                                                        10/10\n\nInstalled:\n  vim-enhanced.x86_64 2:7.4.629-5.el6\n\nDependency Installed:\n  gpm-libs.x86_64 0:1.20.6-12.el6           perl.x86_64 4:5.10.1-141.el6_7.1      perl-Module-Pluggable.x86_64 1:3.90-141.el6_7.1 perl-Pod-Escapes.x86_64 1:1.04-141.el6_7.1\n  perl-Pod-Simple.x86_64 1:3.13-141.el6_7.1 perl-libs.x86_64 4:5.10.1-141.el6_7.1 perl-version.x86_64 3:0.77-141.el6_7.1          vim-common.x86_64 2:7.4.629-5.el6\n  vim-filesystem.x86_64 2:7.4.629-5.el6\n\nComplete!\n[root@vm02 ~]#\n\n```\n\n### 4. 关闭SELinux\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux主要由美国国家安全局开发，并于2000年12月22日发行给开放源代码的开发社区。SELinux旨在加强访问控制架构以对付入侵的威胁或任何企图略过安全架构的应用程序，并且从2.6版的Linux核心就开始集成SELinux；但是SELinux严格的权限控制对于初学者来说并不是非常必要，所以我们建议关闭SELinux，[其实由于SELinux的复杂性，很多运维人员都是选择关闭它，熟悉阿里云ECS的同学可能知道，它是默认关闭SELinux的，但是我们不建议在生产环境关闭SELinux。]\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux的配置文件主要由两个：/etc/sysconfig/selinux、 /etc/selinux/config，其实第一个是第二个路径的软链接。\n\n```\n[root@vm02 ~]# vim /etc/selinux/config\n# This file controls the state of SELinux on the system.\n# SELINUX= can take one of these three values:\n#     enforcing - SELinux security policy is enforced.\n#     permissive - SELinux prints warnings instead of enforcing.\n#     disabled - No SELinux policy is loaded.\nSELINUX=enforcing\n# SELINUXTYPE= can take one of these two values:\n#     targeted - Targeted processes are protected,\n#     mls - Multi Level Security protection.\nSELINUXTYPE=targeted\n\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 的状态模式：\n\n* enforcing : 强制启用SELinux\n* permissive : 只显示警告讯息以替代强制启用SELinux\n* disabled : 停用SELinux\n\n>Tips: SELinux的参数只能在重启后生效。\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 常用的两个命令：getenforce setenforce :\n\n* getenforce 获得SELinux 当前的状态，返回值为如上三种；\n* setenforce 临时改变SELinux的状态，参数为布尔值，0是关闭，1是开启。\n\n> Tips: 状态已经为disabled时，无法使用setenforce 1 启用。\n\n\n### 5. \n\n### 6.\n \n### 7.\n\n### 8.","slug":"centos6-x-base-settings","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq5k000c41tpxy5eus3h","content":"<h2 id=\"CentOS-6-x-初始安装基本优化操作\"><a href=\"#CentOS-6-x-初始安装基本优化操作\" class=\"headerlink\" title=\"CentOS 6.x 初始安装基本优化操作\"></a>CentOS 6.x 初始安装基本优化操作</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文件是采用的模板是centos 6.x，相较于centos 5.x与centos 7.x系列有些区别，不能一概而论。</p>\n<h3 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h3><ul>\n<li>MacBook Pro 15-inch i7 8GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>CentOS-6.7-x86_64-minimal.iso</li>\n</ul>\n<h3 id=\"2-默认网卡开机未设定自启动\"><a href=\"#2-默认网卡开机未设定自启动\" class=\"headerlink\" title=\"2. 默认网卡开机未设定自启动\"></a>2. 默认网卡开机未设定自启动</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;很多初学者，在安装系统的时候，碰到的第一个问题就是不能上网，所以有些同学就担心是不是需要去安装网卡驱动，其实这样想就把问题复杂化了，如果你在实体机安装Linux的系统时，可能会碰到网卡驱动不上导致无法上网的问题，这个时候是需要自行安装驱动的，但是我们使用的VMware的一款虚拟化工具，所以网卡驱动基本就不用考虑，原因是因为我们没有把网卡设置为开机自启动，下面讲如何开启网卡，并设定为开机自启动。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# ifup eth0</div><div class=\"line\"></div><div class=\"line\">Determining IP information for eth0... done.</div><div class=\"line\">[root@vm02 ~]# </div><div class=\"line\">[root@vm02 ~]# ifconfig eth0</div><div class=\"line\">eth0      Link encap:Ethernet  HWaddr 00:0C:29:B9:60:D8</div><div class=\"line\">          inet addr:172.16.102.129  Bcast:172.16.102.255  Mask:255.255.255.0</div><div class=\"line\">          inet6 addr: fe80::20c:29ff:feb9:60d8/64 Scope:Link</div><div class=\"line\">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</div><div class=\"line\">          RX packets:127 errors:0 dropped:0 overruns:0 frame:0</div><div class=\"line\">          TX packets:85 errors:0 dropped:0 overruns:0 carrier:0</div><div class=\"line\">          collisions:0 txqueuelen:1000</div><div class=\"line\">          RX bytes:14010 (13.6 KiB)  TX bytes:11410 (11.1 KiB)</div><div class=\"line\">          </div><div class=\"line\">[root@vm02 ~]# vi /etc/sysconfig/network-scripts/ifcfg-eth0</div><div class=\"line\">\tDEVICE=eth0</div><div class=\"line\">\tHWADDR=00:0C:29:B9:60:D8</div><div class=\"line\">\tTYPE=Ethernet</div><div class=\"line\">\tUUID=7ad636ff-78d9-4afa-9886-706b1de236a8</div><div class=\"line\">\tONBOOT=no\t\t // 默认是no，修改为yes</div><div class=\"line\">\tNM_CONTROLLED=yes</div><div class=\"line\">\tBOOTPROTO=dhcp</div></pre></td></tr></table></figure>\n<h3 id=\"3-增加第三方Yum源\"><a href=\"#3-增加第三方Yum源\" class=\"headerlink\" title=\"3. 增加第三方Yum源\"></a>3. 增加第三方Yum源</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CentOS 系统内置的官方源软件更新较慢，而且缺少一些常用软件包，建议安装epel源，EPEL 是 Extra Packages for Enterprise Linux 的缩写（EPEL），是用于 Fedora-based Red Hat Enterprise Linux (RHEL) 的一个高质量软件源，所以同时也适用于 CentOS 或者 Scientific Linux 等发行版。</p>\n<h5 id=\"a-因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：-wget是Linux常用的命令行下载工具\"><a href=\"#a-因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：-wget是Linux常用的命令行下载工具\" class=\"headerlink\" title=\"a. 因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：[wget是Linux常用的命令行下载工具]\"></a>a. 因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：[wget是Linux常用的命令行下载工具]</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# yum install -y wget</div><div class=\"line\">Loaded plugins: fastestmirror</div><div class=\"line\">Setting up Install Process</div><div class=\"line\">base                                                     | 3.7 kB     00:00</div><div class=\"line\">base/primary_db                                          | 4.6 MB     00:32</div><div class=\"line\">extras                                                   | 3.4 kB     00:00</div><div class=\"line\">extras/primary_db                                        |  34 kB     00:00</div><div class=\"line\">updates                                                  | 3.4 kB     00:00</div><div class=\"line\">updates/primary_db                                       | 4.0 MB     01:05</div><div class=\"line\">Resolving Dependencies</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package wget.x86_64 0:1.12-5.el6_6.1 will be installed</div><div class=\"line\">--&gt; Finished Dependency Resolution</div><div class=\"line\"></div><div class=\"line\">Dependencies Resolved</div><div class=\"line\"></div><div class=\"line\">================================================================================</div><div class=\"line\"> Package        Arch             Version                   Repository      Size</div><div class=\"line\">================================================================================</div><div class=\"line\">Installing:</div><div class=\"line\"> wget           x86_64           1.12-5.el6_6.1            base           483 k</div><div class=\"line\"></div><div class=\"line\">Transaction Summary</div><div class=\"line\">================================================================================</div><div class=\"line\">Install       1 Package(s)</div><div class=\"line\"></div><div class=\"line\">Total download size: 483 k</div><div class=\"line\">Installed size: 1.8 M</div><div class=\"line\">Downloading Packages:</div><div class=\"line\">wget-1.12-5.el6_6.1.x86_64.rpm                           | 483 kB     00:01</div><div class=\"line\">warning: rpmts_HdrFromFdno: Header V3 RSA/SHA1 Signature, key ID c105b9de: NOKEY</div><div class=\"line\">Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div><div class=\"line\">Importing GPG key 0xC105B9DE:</div><div class=\"line\"> Userid : CentOS-6 Key (CentOS 6 Official Signing Key) &lt;centos-6-key@centos.org&gt;</div><div class=\"line\"> Package: centos-release-6-7.el6.centos.12.3.x86_64 (@anaconda-CentOS-201508042137.x86_64/6.7)</div><div class=\"line\"> From   : /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div><div class=\"line\">Running rpm_check_debug</div><div class=\"line\">Running Transaction Test</div><div class=\"line\">Transaction Test Succeeded</div><div class=\"line\">Running Transaction</div><div class=\"line\">  Installing : wget-1.12-5.el6_6.1.x86_64                                   1/1</div><div class=\"line\">  Verifying  : wget-1.12-5.el6_6.1.x86_64                                   1/1</div><div class=\"line\"></div><div class=\"line\">Installed:</div><div class=\"line\">  wget.x86_64 0:1.12-5.el6_6.1</div><div class=\"line\"></div><div class=\"line\">Complete!</div><div class=\"line\">[root@vm02 ~]#</div></pre></td></tr></table></figure>\n<h5 id=\"b-下载并安装epel源\"><a href=\"#b-下载并安装epel源\" class=\"headerlink\" title=\"b. 下载并安装epel源\"></a>b. 下载并安装epel源</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;不同CentOS版本的epel下载地址：</p>\n<ul>\n<li>CentOS 5 ： <a href=\"https://dl.fedoraproject.org/pub/epel/epel-release-latest-5.noarch.rpm\" target=\"_blank\" rel=\"external\">https://dl.fedoraproject.org/pub/epel/epel-release-latest-5.noarch.rpm</a></li>\n<li>CentOS 6 ： <a href=\"https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\" target=\"_blank\" rel=\"external\">https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm</a></li>\n<li>CentOS 7 ： <a href=\"https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\" target=\"_blank\" rel=\"external\">https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</a></li>\n</ul>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本次试验用到的CentOS 6 所以我们下载epel-release-latest-6.noarch.rpm</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm</div><div class=\"line\">--2016-03-18 11:47:17--  https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm</div><div class=\"line\">Resolving dl.fedoraproject.org... 209.132.181.26, 209.132.181.23, 209.132.181.24, ...</div><div class=\"line\">Connecting to dl.fedoraproject.org|209.132.181.26|:443... connected.</div><div class=\"line\">HTTP request sent, awaiting response... 200 OK</div><div class=\"line\">Length: 14540 (14K) [application/x-rpm]</div><div class=\"line\">Saving to: “epel-release-latest-6.noarch.rpm”</div><div class=\"line\"></div><div class=\"line\">100%[======================================&gt;] 14,540      69.5K/s   in 0.2s</div><div class=\"line\"></div><div class=\"line\">2016-03-18 11:47:25 (69.5 KB/s) - “epel-release-latest-6.noarch.rpm” saved [14540/14540]</div><div class=\"line\"></div><div class=\"line\">[root@vm02 ~]# ls</div><div class=\"line\">anaconda-ks.cfg                   install.log</div><div class=\"line\">epel-release-latest-6.noarch.rpm  install.log.syslog</div></pre></td></tr></table></figure>\n<h3 id=\"4-安装vim：Linux使用最广泛的文件编辑工具\"><a href=\"#4-安装vim：Linux使用最广泛的文件编辑工具\" class=\"headerlink\" title=\"4. 安装vim：Linux使用最广泛的文件编辑工具\"></a>4. 安装vim：Linux使用最广泛的文件编辑工具</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;与我们长久使用Win环境不同的是，在Linux之中，我们接触最多的是command line，所以熟练一款命令行下的文本编辑工具是一项必备技能，我这里推荐大家：vim。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# yum install -y vim</div><div class=\"line\">Loaded plugins: fastestmirror</div><div class=\"line\">Setting up Install Process</div><div class=\"line\">Determining fastest mirrors</div><div class=\"line\"> * base: mirrors.aliyun.com</div><div class=\"line\"> * extras: mirrors.aliyun.com</div><div class=\"line\"> * updates: mirrors.aliyun.com</div><div class=\"line\">Resolving Dependencies</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package vim-enhanced.x86_64 2:7.4.629-5.el6 will be installed</div><div class=\"line\">--&gt; Processing Dependency: vim-common = 2:7.4.629-5.el6 for package: 2:vim-enhanced-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Processing Dependency: perl(:MODULE_COMPAT_5.10.1) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Processing Dependency: libperl.so()(64bit) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Processing Dependency: libgpm.so.2()(64bit) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package gpm-libs.x86_64 0:1.20.6-12.el6 will be installed</div><div class=\"line\">---&gt; Package perl.x86_64 4:5.10.1-141.el6_7.1 will be installed</div><div class=\"line\">--&gt; Processing Dependency: perl(version) for package: 4:perl-5.10.1-141.el6_7.1.x86_64</div><div class=\"line\">--&gt; Processing Dependency: perl(Pod::Simple) for package: 4:perl-5.10.1-141.el6_7.1.x86_64</div><div class=\"line\">--&gt; Processing Dependency: perl(Module::Pluggable) for package: 4:perl-5.10.1-141.el6_7.1.x86_64</div><div class=\"line\">---&gt; Package perl-libs.x86_64 4:5.10.1-141.el6_7.1 will be installed</div><div class=\"line\">---&gt; Package vim-common.x86_64 2:7.4.629-5.el6 will be installed</div><div class=\"line\">--&gt; Processing Dependency: vim-filesystem for package: 2:vim-common-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package perl-Module-Pluggable.x86_64 1:3.90-141.el6_7.1 will be installed</div><div class=\"line\">---&gt; Package perl-Pod-Simple.x86_64 1:3.13-141.el6_7.1 will be installed</div><div class=\"line\">--&gt; Processing Dependency: perl(Pod::Escapes) &gt;= 1.04 for package: 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64</div><div class=\"line\">---&gt; Package perl-version.x86_64 3:0.77-141.el6_7.1 will be installed</div><div class=\"line\">---&gt; Package vim-filesystem.x86_64 2:7.4.629-5.el6 will be installed</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package perl-Pod-Escapes.x86_64 1:1.04-141.el6_7.1 will be installed</div><div class=\"line\">--&gt; Finished Dependency Resolution</div><div class=\"line\"></div><div class=\"line\">Dependencies Resolved</div><div class=\"line\"></div><div class=\"line\">=============================================================================================================================================================================</div><div class=\"line\"> Package                                          Arch                              Version                                         Repository                          Size</div><div class=\"line\">=============================================================================================================================================================================</div><div class=\"line\">Installing:</div><div class=\"line\"> vim-enhanced                                     x86_64                            2:7.4.629-5.el6                                 base                               1.0 M</div><div class=\"line\">Installing for dependencies:</div><div class=\"line\"> gpm-libs                                         x86_64                            1.20.6-12.el6                                   base                                28 k</div><div class=\"line\"> perl                                             x86_64                            4:5.10.1-141.el6_7.1                            updates                             10 M</div><div class=\"line\"> perl-Module-Pluggable                            x86_64                            1:3.90-141.el6_7.1                              updates                             40 k</div><div class=\"line\"> perl-Pod-Escapes                                 x86_64                            1:1.04-141.el6_7.1                              updates                             33 k</div><div class=\"line\"> perl-Pod-Simple                                  x86_64                            1:3.13-141.el6_7.1                              updates                            213 k</div><div class=\"line\"> perl-libs                                        x86_64                            4:5.10.1-141.el6_7.1                            updates                            579 k</div><div class=\"line\"> perl-version                                     x86_64                            3:0.77-141.el6_7.1                              updates                             52 k</div><div class=\"line\"> vim-common                                       x86_64                            2:7.4.629-5.el6                                 base                               6.7 M</div><div class=\"line\"> vim-filesystem                                   x86_64                            2:7.4.629-5.el6                                 base                                15 k</div><div class=\"line\"></div><div class=\"line\">Transaction Summary</div><div class=\"line\">=============================================================================================================================================================================</div><div class=\"line\">Install      10 Package(s)</div><div class=\"line\"></div><div class=\"line\">Total download size: 19 M</div><div class=\"line\">Installed size: 59 M</div><div class=\"line\">Downloading Packages:</div><div class=\"line\">(1/10): gpm-libs-1.20.6-12.el6.x86_64.rpm                                                                                                             |  28 kB     00:00</div><div class=\"line\">(2/10): perl-5.10.1-141.el6_7.1.x86_64.rpm                                                                                                            |  10 MB     00:10</div><div class=\"line\">(3/10): perl-Module-Pluggable-3.90-141.el6_7.1.x86_64.rpm                                                                                             |  40 kB     00:00</div><div class=\"line\">(4/10): perl-Pod-Escapes-1.04-141.el6_7.1.x86_64.rpm                                                                                                  |  33 kB     00:00</div><div class=\"line\">(5/10): perl-Pod-Simple-3.13-141.el6_7.1.x86_64.rpm                                                                                                   | 213 kB     00:00</div><div class=\"line\">(6/10): perl-libs-5.10.1-141.el6_7.1.x86_64.rpm                                                                                                       | 579 kB     00:00</div><div class=\"line\">(7/10): perl-version-0.77-141.el6_7.1.x86_64.rpm                                                                                                      |  52 kB     00:00</div><div class=\"line\">(8/10): vim-common-7.4.629-5.el6.x86_64.rpm                                                                                                           | 6.7 MB     00:07</div><div class=\"line\">(9/10): vim-enhanced-7.4.629-5.el6.x86_64.rpm                                                                                                         | 1.0 MB     00:01</div><div class=\"line\">(10/10): vim-filesystem-7.4.629-5.el6.x86_64.rpm                                                                                                      |  15 kB     00:00</div><div class=\"line\">-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------</div><div class=\"line\">Total                                                                                                                                        980 kB/s |  19 MB     00:19</div><div class=\"line\">Running rpm_check_debug</div><div class=\"line\">Running Transaction Test</div><div class=\"line\">Transaction Test Succeeded</div><div class=\"line\">Running Transaction</div><div class=\"line\">  Installing : 1:perl-Pod-Escapes-1.04-141.el6_7.1.x86_64                                                                                                               1/10</div><div class=\"line\">  Installing : 1:perl-Module-Pluggable-3.90-141.el6_7.1.x86_64                                                                                                          2/10</div><div class=\"line\">  Installing : 3:perl-version-0.77-141.el6_7.1.x86_64                                                                                                                   3/10</div><div class=\"line\">  Installing : 4:perl-libs-5.10.1-141.el6_7.1.x86_64                                                                                                                    4/10</div><div class=\"line\">  Installing : 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64                                                                                                                5/10</div><div class=\"line\">  Installing : 4:perl-5.10.1-141.el6_7.1.x86_64                                                                                                                         6/10</div><div class=\"line\">  Installing : 2:vim-filesystem-7.4.629-5.el6.x86_64                                                                                                                    7/10</div><div class=\"line\">  Installing : 2:vim-common-7.4.629-5.el6.x86_64                                                                                                                        8/10</div><div class=\"line\">  Installing : gpm-libs-1.20.6-12.el6.x86_64                                                                                                                            9/10</div><div class=\"line\">  Installing : 2:vim-enhanced-7.4.629-5.el6.x86_64                                                                                                                     10/10</div><div class=\"line\">  Verifying  : 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64                                                                                                                1/10</div><div class=\"line\">  Verifying  : 1:perl-Pod-Escapes-1.04-141.el6_7.1.x86_64                                                                                                               2/10</div><div class=\"line\">  Verifying  : gpm-libs-1.20.6-12.el6.x86_64                                                                                                                            3/10</div><div class=\"line\">  Verifying  : 2:vim-enhanced-7.4.629-5.el6.x86_64                                                                                                                      4/10</div><div class=\"line\">  Verifying  : 2:vim-filesystem-7.4.629-5.el6.x86_64                                                                                                                    5/10</div><div class=\"line\">  Verifying  : 1:perl-Module-Pluggable-3.90-141.el6_7.1.x86_64                                                                                                          6/10</div><div class=\"line\">  Verifying  : 2:vim-common-7.4.629-5.el6.x86_64                                                                                                                        7/10</div><div class=\"line\">  Verifying  : 3:perl-version-0.77-141.el6_7.1.x86_64                                                                                                                   8/10</div><div class=\"line\">  Verifying  : 4:perl-libs-5.10.1-141.el6_7.1.x86_64                                                                                                                    9/10</div><div class=\"line\">  Verifying  : 4:perl-5.10.1-141.el6_7.1.x86_64                                                                                                                        10/10</div><div class=\"line\"></div><div class=\"line\">Installed:</div><div class=\"line\">  vim-enhanced.x86_64 2:7.4.629-5.el6</div><div class=\"line\"></div><div class=\"line\">Dependency Installed:</div><div class=\"line\">  gpm-libs.x86_64 0:1.20.6-12.el6           perl.x86_64 4:5.10.1-141.el6_7.1      perl-Module-Pluggable.x86_64 1:3.90-141.el6_7.1 perl-Pod-Escapes.x86_64 1:1.04-141.el6_7.1</div><div class=\"line\">  perl-Pod-Simple.x86_64 1:3.13-141.el6_7.1 perl-libs.x86_64 4:5.10.1-141.el6_7.1 perl-version.x86_64 3:0.77-141.el6_7.1          vim-common.x86_64 2:7.4.629-5.el6</div><div class=\"line\">  vim-filesystem.x86_64 2:7.4.629-5.el6</div><div class=\"line\"></div><div class=\"line\">Complete!</div><div class=\"line\">[root@vm02 ~]#</div></pre></td></tr></table></figure>\n<h3 id=\"4-关闭SELinux\"><a href=\"#4-关闭SELinux\" class=\"headerlink\" title=\"4. 关闭SELinux\"></a>4. 关闭SELinux</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux主要由美国国家安全局开发，并于2000年12月22日发行给开放源代码的开发社区。SELinux旨在加强访问控制架构以对付入侵的威胁或任何企图略过安全架构的应用程序，并且从2.6版的Linux核心就开始集成SELinux；但是SELinux严格的权限控制对于初学者来说并不是非常必要，所以我们建议关闭SELinux，[其实由于SELinux的复杂性，很多运维人员都是选择关闭它，熟悉阿里云ECS的同学可能知道，它是默认关闭SELinux的，但是我们不建议在生产环境关闭SELinux。]</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux的配置文件主要由两个：/etc/sysconfig/selinux、 /etc/selinux/config，其实第一个是第二个路径的软链接。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/selinux/config</div><div class=\"line\"># This file controls the state of SELinux on the system.</div><div class=\"line\"># SELINUX= can take one of these three values:</div><div class=\"line\">#     enforcing - SELinux security policy is enforced.</div><div class=\"line\">#     permissive - SELinux prints warnings instead of enforcing.</div><div class=\"line\">#     disabled - No SELinux policy is loaded.</div><div class=\"line\">SELINUX=enforcing</div><div class=\"line\"># SELINUXTYPE= can take one of these two values:</div><div class=\"line\">#     targeted - Targeted processes are protected,</div><div class=\"line\">#     mls - Multi Level Security protection.</div><div class=\"line\">SELINUXTYPE=targeted</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 的状态模式：</p>\n<ul>\n<li>enforcing : 强制启用SELinux</li>\n<li>permissive : 只显示警告讯息以替代强制启用SELinux</li>\n<li>disabled : 停用SELinux</li>\n</ul>\n<blockquote>\n<p>Tips: SELinux的参数只能在重启后生效。</p>\n</blockquote>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 常用的两个命令：getenforce setenforce :</p>\n<ul>\n<li>getenforce 获得SELinux 当前的状态，返回值为如上三种；</li>\n<li>setenforce 临时改变SELinux的状态，参数为布尔值，0是关闭，1是开启。</li>\n</ul>\n<blockquote>\n<p>Tips: 状态已经为disabled时，无法使用setenforce 1 启用。</p>\n</blockquote>\n<h3 id=\"5\"><a href=\"#5\" class=\"headerlink\" title=\"5.\"></a>5.</h3><h3 id=\"6\"><a href=\"#6\" class=\"headerlink\" title=\"6.\"></a>6.</h3><h3 id=\"7\"><a href=\"#7\" class=\"headerlink\" title=\"7.\"></a>7.</h3><h3 id=\"8\"><a href=\"#8\" class=\"headerlink\" title=\"8.\"></a>8.</h3>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"CentOS-6-x-初始安装基本优化操作\"><a href=\"#CentOS-6-x-初始安装基本优化操作\" class=\"headerlink\" title=\"CentOS 6.x 初始安装基本优化操作\"></a>CentOS 6.x 初始安装基本优化操作</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文件是采用的模板是centos 6.x，相较于centos 5.x与centos 7.x系列有些区别，不能一概而论。</p>\n<h3 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h3><ul>\n<li>MacBook Pro 15-inch i7 8GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>CentOS-6.7-x86_64-minimal.iso</li>\n</ul>\n<h3 id=\"2-默认网卡开机未设定自启动\"><a href=\"#2-默认网卡开机未设定自启动\" class=\"headerlink\" title=\"2. 默认网卡开机未设定自启动\"></a>2. 默认网卡开机未设定自启动</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;很多初学者，在安装系统的时候，碰到的第一个问题就是不能上网，所以有些同学就担心是不是需要去安装网卡驱动，其实这样想就把问题复杂化了，如果你在实体机安装Linux的系统时，可能会碰到网卡驱动不上导致无法上网的问题，这个时候是需要自行安装驱动的，但是我们使用的VMware的一款虚拟化工具，所以网卡驱动基本就不用考虑，原因是因为我们没有把网卡设置为开机自启动，下面讲如何开启网卡，并设定为开机自启动。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# ifup eth0</div><div class=\"line\"></div><div class=\"line\">Determining IP information for eth0... done.</div><div class=\"line\">[root@vm02 ~]# </div><div class=\"line\">[root@vm02 ~]# ifconfig eth0</div><div class=\"line\">eth0      Link encap:Ethernet  HWaddr 00:0C:29:B9:60:D8</div><div class=\"line\">          inet addr:172.16.102.129  Bcast:172.16.102.255  Mask:255.255.255.0</div><div class=\"line\">          inet6 addr: fe80::20c:29ff:feb9:60d8/64 Scope:Link</div><div class=\"line\">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</div><div class=\"line\">          RX packets:127 errors:0 dropped:0 overruns:0 frame:0</div><div class=\"line\">          TX packets:85 errors:0 dropped:0 overruns:0 carrier:0</div><div class=\"line\">          collisions:0 txqueuelen:1000</div><div class=\"line\">          RX bytes:14010 (13.6 KiB)  TX bytes:11410 (11.1 KiB)</div><div class=\"line\">          </div><div class=\"line\">[root@vm02 ~]# vi /etc/sysconfig/network-scripts/ifcfg-eth0</div><div class=\"line\">\tDEVICE=eth0</div><div class=\"line\">\tHWADDR=00:0C:29:B9:60:D8</div><div class=\"line\">\tTYPE=Ethernet</div><div class=\"line\">\tUUID=7ad636ff-78d9-4afa-9886-706b1de236a8</div><div class=\"line\">\tONBOOT=no\t\t // 默认是no，修改为yes</div><div class=\"line\">\tNM_CONTROLLED=yes</div><div class=\"line\">\tBOOTPROTO=dhcp</div></pre></td></tr></table></figure>\n<h3 id=\"3-增加第三方Yum源\"><a href=\"#3-增加第三方Yum源\" class=\"headerlink\" title=\"3. 增加第三方Yum源\"></a>3. 增加第三方Yum源</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CentOS 系统内置的官方源软件更新较慢，而且缺少一些常用软件包，建议安装epel源，EPEL 是 Extra Packages for Enterprise Linux 的缩写（EPEL），是用于 Fedora-based Red Hat Enterprise Linux (RHEL) 的一个高质量软件源，所以同时也适用于 CentOS 或者 Scientific Linux 等发行版。</p>\n<h5 id=\"a-因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：-wget是Linux常用的命令行下载工具\"><a href=\"#a-因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：-wget是Linux常用的命令行下载工具\" class=\"headerlink\" title=\"a. 因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：[wget是Linux常用的命令行下载工具]\"></a>a. 因为我们使用的是minimal版本的ISO安装，所以系统默认没有wget，我们可以直接用yum安装：[wget是Linux常用的命令行下载工具]</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# yum install -y wget</div><div class=\"line\">Loaded plugins: fastestmirror</div><div class=\"line\">Setting up Install Process</div><div class=\"line\">base                                                     | 3.7 kB     00:00</div><div class=\"line\">base/primary_db                                          | 4.6 MB     00:32</div><div class=\"line\">extras                                                   | 3.4 kB     00:00</div><div class=\"line\">extras/primary_db                                        |  34 kB     00:00</div><div class=\"line\">updates                                                  | 3.4 kB     00:00</div><div class=\"line\">updates/primary_db                                       | 4.0 MB     01:05</div><div class=\"line\">Resolving Dependencies</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package wget.x86_64 0:1.12-5.el6_6.1 will be installed</div><div class=\"line\">--&gt; Finished Dependency Resolution</div><div class=\"line\"></div><div class=\"line\">Dependencies Resolved</div><div class=\"line\"></div><div class=\"line\">================================================================================</div><div class=\"line\"> Package        Arch             Version                   Repository      Size</div><div class=\"line\">================================================================================</div><div class=\"line\">Installing:</div><div class=\"line\"> wget           x86_64           1.12-5.el6_6.1            base           483 k</div><div class=\"line\"></div><div class=\"line\">Transaction Summary</div><div class=\"line\">================================================================================</div><div class=\"line\">Install       1 Package(s)</div><div class=\"line\"></div><div class=\"line\">Total download size: 483 k</div><div class=\"line\">Installed size: 1.8 M</div><div class=\"line\">Downloading Packages:</div><div class=\"line\">wget-1.12-5.el6_6.1.x86_64.rpm                           | 483 kB     00:01</div><div class=\"line\">warning: rpmts_HdrFromFdno: Header V3 RSA/SHA1 Signature, key ID c105b9de: NOKEY</div><div class=\"line\">Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div><div class=\"line\">Importing GPG key 0xC105B9DE:</div><div class=\"line\"> Userid : CentOS-6 Key (CentOS 6 Official Signing Key) &lt;centos-6-key@centos.org&gt;</div><div class=\"line\"> Package: centos-release-6-7.el6.centos.12.3.x86_64 (@anaconda-CentOS-201508042137.x86_64/6.7)</div><div class=\"line\"> From   : /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div><div class=\"line\">Running rpm_check_debug</div><div class=\"line\">Running Transaction Test</div><div class=\"line\">Transaction Test Succeeded</div><div class=\"line\">Running Transaction</div><div class=\"line\">  Installing : wget-1.12-5.el6_6.1.x86_64                                   1/1</div><div class=\"line\">  Verifying  : wget-1.12-5.el6_6.1.x86_64                                   1/1</div><div class=\"line\"></div><div class=\"line\">Installed:</div><div class=\"line\">  wget.x86_64 0:1.12-5.el6_6.1</div><div class=\"line\"></div><div class=\"line\">Complete!</div><div class=\"line\">[root@vm02 ~]#</div></pre></td></tr></table></figure>\n<h5 id=\"b-下载并安装epel源\"><a href=\"#b-下载并安装epel源\" class=\"headerlink\" title=\"b. 下载并安装epel源\"></a>b. 下载并安装epel源</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;不同CentOS版本的epel下载地址：</p>\n<ul>\n<li>CentOS 5 ： <a href=\"https://dl.fedoraproject.org/pub/epel/epel-release-latest-5.noarch.rpm\">https://dl.fedoraproject.org/pub/epel/epel-release-latest-5.noarch.rpm</a></li>\n<li>CentOS 6 ： <a href=\"https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\">https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm</a></li>\n<li>CentOS 7 ： <a href=\"https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\">https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</a></li>\n</ul>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本次试验用到的CentOS 6 所以我们下载epel-release-latest-6.noarch.rpm</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm</div><div class=\"line\">--2016-03-18 11:47:17--  https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm</div><div class=\"line\">Resolving dl.fedoraproject.org... 209.132.181.26, 209.132.181.23, 209.132.181.24, ...</div><div class=\"line\">Connecting to dl.fedoraproject.org|209.132.181.26|:443... connected.</div><div class=\"line\">HTTP request sent, awaiting response... 200 OK</div><div class=\"line\">Length: 14540 (14K) [application/x-rpm]</div><div class=\"line\">Saving to: “epel-release-latest-6.noarch.rpm”</div><div class=\"line\"></div><div class=\"line\">100%[======================================&gt;] 14,540      69.5K/s   in 0.2s</div><div class=\"line\"></div><div class=\"line\">2016-03-18 11:47:25 (69.5 KB/s) - “epel-release-latest-6.noarch.rpm” saved [14540/14540]</div><div class=\"line\"></div><div class=\"line\">[root@vm02 ~]# ls</div><div class=\"line\">anaconda-ks.cfg                   install.log</div><div class=\"line\">epel-release-latest-6.noarch.rpm  install.log.syslog</div></pre></td></tr></table></figure>\n<h3 id=\"4-安装vim：Linux使用最广泛的文件编辑工具\"><a href=\"#4-安装vim：Linux使用最广泛的文件编辑工具\" class=\"headerlink\" title=\"4. 安装vim：Linux使用最广泛的文件编辑工具\"></a>4. 安装vim：Linux使用最广泛的文件编辑工具</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;与我们长久使用Win环境不同的是，在Linux之中，我们接触最多的是command line，所以熟练一款命令行下的文本编辑工具是一项必备技能，我这里推荐大家：vim。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# yum install -y vim</div><div class=\"line\">Loaded plugins: fastestmirror</div><div class=\"line\">Setting up Install Process</div><div class=\"line\">Determining fastest mirrors</div><div class=\"line\"> * base: mirrors.aliyun.com</div><div class=\"line\"> * extras: mirrors.aliyun.com</div><div class=\"line\"> * updates: mirrors.aliyun.com</div><div class=\"line\">Resolving Dependencies</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package vim-enhanced.x86_64 2:7.4.629-5.el6 will be installed</div><div class=\"line\">--&gt; Processing Dependency: vim-common = 2:7.4.629-5.el6 for package: 2:vim-enhanced-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Processing Dependency: perl(:MODULE_COMPAT_5.10.1) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Processing Dependency: libperl.so()(64bit) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Processing Dependency: libgpm.so.2()(64bit) for package: 2:vim-enhanced-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package gpm-libs.x86_64 0:1.20.6-12.el6 will be installed</div><div class=\"line\">---&gt; Package perl.x86_64 4:5.10.1-141.el6_7.1 will be installed</div><div class=\"line\">--&gt; Processing Dependency: perl(version) for package: 4:perl-5.10.1-141.el6_7.1.x86_64</div><div class=\"line\">--&gt; Processing Dependency: perl(Pod::Simple) for package: 4:perl-5.10.1-141.el6_7.1.x86_64</div><div class=\"line\">--&gt; Processing Dependency: perl(Module::Pluggable) for package: 4:perl-5.10.1-141.el6_7.1.x86_64</div><div class=\"line\">---&gt; Package perl-libs.x86_64 4:5.10.1-141.el6_7.1 will be installed</div><div class=\"line\">---&gt; Package vim-common.x86_64 2:7.4.629-5.el6 will be installed</div><div class=\"line\">--&gt; Processing Dependency: vim-filesystem for package: 2:vim-common-7.4.629-5.el6.x86_64</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package perl-Module-Pluggable.x86_64 1:3.90-141.el6_7.1 will be installed</div><div class=\"line\">---&gt; Package perl-Pod-Simple.x86_64 1:3.13-141.el6_7.1 will be installed</div><div class=\"line\">--&gt; Processing Dependency: perl(Pod::Escapes) &gt;= 1.04 for package: 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64</div><div class=\"line\">---&gt; Package perl-version.x86_64 3:0.77-141.el6_7.1 will be installed</div><div class=\"line\">---&gt; Package vim-filesystem.x86_64 2:7.4.629-5.el6 will be installed</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package perl-Pod-Escapes.x86_64 1:1.04-141.el6_7.1 will be installed</div><div class=\"line\">--&gt; Finished Dependency Resolution</div><div class=\"line\"></div><div class=\"line\">Dependencies Resolved</div><div class=\"line\"></div><div class=\"line\">=============================================================================================================================================================================</div><div class=\"line\"> Package                                          Arch                              Version                                         Repository                          Size</div><div class=\"line\">=============================================================================================================================================================================</div><div class=\"line\">Installing:</div><div class=\"line\"> vim-enhanced                                     x86_64                            2:7.4.629-5.el6                                 base                               1.0 M</div><div class=\"line\">Installing for dependencies:</div><div class=\"line\"> gpm-libs                                         x86_64                            1.20.6-12.el6                                   base                                28 k</div><div class=\"line\"> perl                                             x86_64                            4:5.10.1-141.el6_7.1                            updates                             10 M</div><div class=\"line\"> perl-Module-Pluggable                            x86_64                            1:3.90-141.el6_7.1                              updates                             40 k</div><div class=\"line\"> perl-Pod-Escapes                                 x86_64                            1:1.04-141.el6_7.1                              updates                             33 k</div><div class=\"line\"> perl-Pod-Simple                                  x86_64                            1:3.13-141.el6_7.1                              updates                            213 k</div><div class=\"line\"> perl-libs                                        x86_64                            4:5.10.1-141.el6_7.1                            updates                            579 k</div><div class=\"line\"> perl-version                                     x86_64                            3:0.77-141.el6_7.1                              updates                             52 k</div><div class=\"line\"> vim-common                                       x86_64                            2:7.4.629-5.el6                                 base                               6.7 M</div><div class=\"line\"> vim-filesystem                                   x86_64                            2:7.4.629-5.el6                                 base                                15 k</div><div class=\"line\"></div><div class=\"line\">Transaction Summary</div><div class=\"line\">=============================================================================================================================================================================</div><div class=\"line\">Install      10 Package(s)</div><div class=\"line\"></div><div class=\"line\">Total download size: 19 M</div><div class=\"line\">Installed size: 59 M</div><div class=\"line\">Downloading Packages:</div><div class=\"line\">(1/10): gpm-libs-1.20.6-12.el6.x86_64.rpm                                                                                                             |  28 kB     00:00</div><div class=\"line\">(2/10): perl-5.10.1-141.el6_7.1.x86_64.rpm                                                                                                            |  10 MB     00:10</div><div class=\"line\">(3/10): perl-Module-Pluggable-3.90-141.el6_7.1.x86_64.rpm                                                                                             |  40 kB     00:00</div><div class=\"line\">(4/10): perl-Pod-Escapes-1.04-141.el6_7.1.x86_64.rpm                                                                                                  |  33 kB     00:00</div><div class=\"line\">(5/10): perl-Pod-Simple-3.13-141.el6_7.1.x86_64.rpm                                                                                                   | 213 kB     00:00</div><div class=\"line\">(6/10): perl-libs-5.10.1-141.el6_7.1.x86_64.rpm                                                                                                       | 579 kB     00:00</div><div class=\"line\">(7/10): perl-version-0.77-141.el6_7.1.x86_64.rpm                                                                                                      |  52 kB     00:00</div><div class=\"line\">(8/10): vim-common-7.4.629-5.el6.x86_64.rpm                                                                                                           | 6.7 MB     00:07</div><div class=\"line\">(9/10): vim-enhanced-7.4.629-5.el6.x86_64.rpm                                                                                                         | 1.0 MB     00:01</div><div class=\"line\">(10/10): vim-filesystem-7.4.629-5.el6.x86_64.rpm                                                                                                      |  15 kB     00:00</div><div class=\"line\">-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------</div><div class=\"line\">Total                                                                                                                                        980 kB/s |  19 MB     00:19</div><div class=\"line\">Running rpm_check_debug</div><div class=\"line\">Running Transaction Test</div><div class=\"line\">Transaction Test Succeeded</div><div class=\"line\">Running Transaction</div><div class=\"line\">  Installing : 1:perl-Pod-Escapes-1.04-141.el6_7.1.x86_64                                                                                                               1/10</div><div class=\"line\">  Installing : 1:perl-Module-Pluggable-3.90-141.el6_7.1.x86_64                                                                                                          2/10</div><div class=\"line\">  Installing : 3:perl-version-0.77-141.el6_7.1.x86_64                                                                                                                   3/10</div><div class=\"line\">  Installing : 4:perl-libs-5.10.1-141.el6_7.1.x86_64                                                                                                                    4/10</div><div class=\"line\">  Installing : 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64                                                                                                                5/10</div><div class=\"line\">  Installing : 4:perl-5.10.1-141.el6_7.1.x86_64                                                                                                                         6/10</div><div class=\"line\">  Installing : 2:vim-filesystem-7.4.629-5.el6.x86_64                                                                                                                    7/10</div><div class=\"line\">  Installing : 2:vim-common-7.4.629-5.el6.x86_64                                                                                                                        8/10</div><div class=\"line\">  Installing : gpm-libs-1.20.6-12.el6.x86_64                                                                                                                            9/10</div><div class=\"line\">  Installing : 2:vim-enhanced-7.4.629-5.el6.x86_64                                                                                                                     10/10</div><div class=\"line\">  Verifying  : 1:perl-Pod-Simple-3.13-141.el6_7.1.x86_64                                                                                                                1/10</div><div class=\"line\">  Verifying  : 1:perl-Pod-Escapes-1.04-141.el6_7.1.x86_64                                                                                                               2/10</div><div class=\"line\">  Verifying  : gpm-libs-1.20.6-12.el6.x86_64                                                                                                                            3/10</div><div class=\"line\">  Verifying  : 2:vim-enhanced-7.4.629-5.el6.x86_64                                                                                                                      4/10</div><div class=\"line\">  Verifying  : 2:vim-filesystem-7.4.629-5.el6.x86_64                                                                                                                    5/10</div><div class=\"line\">  Verifying  : 1:perl-Module-Pluggable-3.90-141.el6_7.1.x86_64                                                                                                          6/10</div><div class=\"line\">  Verifying  : 2:vim-common-7.4.629-5.el6.x86_64                                                                                                                        7/10</div><div class=\"line\">  Verifying  : 3:perl-version-0.77-141.el6_7.1.x86_64                                                                                                                   8/10</div><div class=\"line\">  Verifying  : 4:perl-libs-5.10.1-141.el6_7.1.x86_64                                                                                                                    9/10</div><div class=\"line\">  Verifying  : 4:perl-5.10.1-141.el6_7.1.x86_64                                                                                                                        10/10</div><div class=\"line\"></div><div class=\"line\">Installed:</div><div class=\"line\">  vim-enhanced.x86_64 2:7.4.629-5.el6</div><div class=\"line\"></div><div class=\"line\">Dependency Installed:</div><div class=\"line\">  gpm-libs.x86_64 0:1.20.6-12.el6           perl.x86_64 4:5.10.1-141.el6_7.1      perl-Module-Pluggable.x86_64 1:3.90-141.el6_7.1 perl-Pod-Escapes.x86_64 1:1.04-141.el6_7.1</div><div class=\"line\">  perl-Pod-Simple.x86_64 1:3.13-141.el6_7.1 perl-libs.x86_64 4:5.10.1-141.el6_7.1 perl-version.x86_64 3:0.77-141.el6_7.1          vim-common.x86_64 2:7.4.629-5.el6</div><div class=\"line\">  vim-filesystem.x86_64 2:7.4.629-5.el6</div><div class=\"line\"></div><div class=\"line\">Complete!</div><div class=\"line\">[root@vm02 ~]#</div></pre></td></tr></table></figure>\n<h3 id=\"4-关闭SELinux\"><a href=\"#4-关闭SELinux\" class=\"headerlink\" title=\"4. 关闭SELinux\"></a>4. 关闭SELinux</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux主要由美国国家安全局开发，并于2000年12月22日发行给开放源代码的开发社区。SELinux旨在加强访问控制架构以对付入侵的威胁或任何企图略过安全架构的应用程序，并且从2.6版的Linux核心就开始集成SELinux；但是SELinux严格的权限控制对于初学者来说并不是非常必要，所以我们建议关闭SELinux，[其实由于SELinux的复杂性，很多运维人员都是选择关闭它，熟悉阿里云ECS的同学可能知道，它是默认关闭SELinux的，但是我们不建议在生产环境关闭SELinux。]</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux的配置文件主要由两个：/etc/sysconfig/selinux、 /etc/selinux/config，其实第一个是第二个路径的软链接。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/selinux/config</div><div class=\"line\"># This file controls the state of SELinux on the system.</div><div class=\"line\"># SELINUX= can take one of these three values:</div><div class=\"line\">#     enforcing - SELinux security policy is enforced.</div><div class=\"line\">#     permissive - SELinux prints warnings instead of enforcing.</div><div class=\"line\">#     disabled - No SELinux policy is loaded.</div><div class=\"line\">SELINUX=enforcing</div><div class=\"line\"># SELINUXTYPE= can take one of these two values:</div><div class=\"line\">#     targeted - Targeted processes are protected,</div><div class=\"line\">#     mls - Multi Level Security protection.</div><div class=\"line\">SELINUXTYPE=targeted</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 的状态模式：</p>\n<ul>\n<li>enforcing : 强制启用SELinux</li>\n<li>permissive : 只显示警告讯息以替代强制启用SELinux</li>\n<li>disabled : 停用SELinux</li>\n</ul>\n<blockquote>\n<p>Tips: SELinux的参数只能在重启后生效。</p>\n</blockquote>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 常用的两个命令：getenforce setenforce :</p>\n<ul>\n<li>getenforce 获得SELinux 当前的状态，返回值为如上三种；</li>\n<li>setenforce 临时改变SELinux的状态，参数为布尔值，0是关闭，1是开启。</li>\n</ul>\n<blockquote>\n<p>Tips: 状态已经为disabled时，无法使用setenforce 1 启用。</p>\n</blockquote>\n<h3 id=\"5\"><a href=\"#5\" class=\"headerlink\" title=\"5.\"></a>5.</h3><h3 id=\"6\"><a href=\"#6\" class=\"headerlink\" title=\"6.\"></a>6.</h3><h3 id=\"7\"><a href=\"#7\" class=\"headerlink\" title=\"7.\"></a>7.</h3><h3 id=\"8\"><a href=\"#8\" class=\"headerlink\" title=\"8.\"></a>8.</h3>"},{"title":"CentOS 7(1) 修改系统主机名","id":"42","updated":"2017-04-21T05:35:12.000Z","date":"2016-05-04T21:41:39.000Z","_content":"\n## CentOS 7 修改主机名\n\n### 方法1: <code> hostname 主机名</code>\n\n这种方式，只能修改临时的主机名，当重启机器后，主机名称又变回来了。\n\n\n### 方法2: <code> hostnamectl set-hostname <主机名>  </code>\n\n使用这种方式修改，可以永久性的修改主机名称！\n","source":"_posts/CentOS-7-1-修改系统主机名.md","raw":"---\ntitle: CentOS 7(1) 修改系统主机名\ntags: 'CentOS'\ncategories: 'CentOS'\npermalink: centos-7-1-xiu-gai-xi-tong-zhu-ji-ming\nid: 42\nupdated: '2017-04-21 13:35:12'\ndate: 2016-05-05 05:41:39\n---\n\n## CentOS 7 修改主机名\n\n### 方法1: <code> hostname 主机名</code>\n\n这种方式，只能修改临时的主机名，当重启机器后，主机名称又变回来了。\n\n\n### 方法2: <code> hostnamectl set-hostname <主机名>  </code>\n\n使用这种方式修改，可以永久性的修改主机名称！\n","slug":"centos-7-1-xiu-gai-xi-tong-zhu-ji-ming","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq5n000e41tpig0mm3bl","content":"<h2 id=\"CentOS-7-修改主机名\"><a href=\"#CentOS-7-修改主机名\" class=\"headerlink\" title=\"CentOS 7 修改主机名\"></a>CentOS 7 修改主机名</h2><h3 id=\"方法1-hostname-主机名\"><a href=\"#方法1-hostname-主机名\" class=\"headerlink\" title=\"方法1:  hostname 主机名\"></a>方法1: <code> hostname 主机名</code></h3><p>这种方式，只能修改临时的主机名，当重启机器后，主机名称又变回来了。</p>\n<h3 id=\"方法2-hostnamectl-set-hostname-lt-主机名-gt\"><a href=\"#方法2-hostnamectl-set-hostname-lt-主机名-gt\" class=\"headerlink\" title=\"方法2:  hostnamectl set-hostname &lt;主机名&gt;  \"></a>方法2: <code> hostnamectl set-hostname &lt;主机名&gt;  </code></h3><p>使用这种方式修改，可以永久性的修改主机名称！</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"CentOS-7-修改主机名\"><a href=\"#CentOS-7-修改主机名\" class=\"headerlink\" title=\"CentOS 7 修改主机名\"></a>CentOS 7 修改主机名</h2><h3 id=\"方法1-hostname-主机名\"><a href=\"#方法1-hostname-主机名\" class=\"headerlink\" title=\"方法1:  hostname 主机名\"></a>方法1: <code> hostname 主机名</code></h3><p>这种方式，只能修改临时的主机名，当重启机器后，主机名称又变回来了。</p>\n<h3 id=\"方法2-hostnamectl-set-hostname-lt-主机名-gt\"><a href=\"#方法2-hostnamectl-set-hostname-lt-主机名-gt\" class=\"headerlink\" title=\"方法2:  hostnamectl set-hostname &lt;主机名&gt;  \"></a>方法2: <code> hostnamectl set-hostname &lt;主机名&gt;  </code></h3><p>使用这种方式修改，可以永久性的修改主机名称！</p>\n"},{"title":"CentOS 7(2) 系统服务管理方式","id":"43","updated":"2017-04-21T05:34:59.000Z","date":"2016-05-04T21:43:55.000Z","_content":"\n## 关闭防火墙：\n```\n   systemctl stop firewalld.service   # 关闭\n   systemctl disable firewalld.service # 开机不自启动\n```\n","source":"_posts/CentOS-7-2-系统服务管理方式.md","raw":"---\ntitle: CentOS 7(2) 系统服务管理方式\ntags: 'CentOS'\ncategories: 'CentOS'\npermalink: centos-7-1-xiu-gai-xi-tong-zhu-ji-ming-2\nid: 43\nupdated: '2017-04-21 13:34:59'\ndate: 2016-05-05 05:43:55\n---\n\n## 关闭防火墙：\n```\n   systemctl stop firewalld.service   # 关闭\n   systemctl disable firewalld.service # 开机不自启动\n```\n","slug":"centos-7-1-xiu-gai-xi-tong-zhu-ji-ming-2","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq60000h41tpymvy98fx","content":"<h2 id=\"关闭防火墙：\"><a href=\"#关闭防火墙：\" class=\"headerlink\" title=\"关闭防火墙：\"></a>关闭防火墙：</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">systemctl stop firewalld.service   # 关闭</div><div class=\"line\">systemctl disable firewalld.service # 开机不自启动</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"关闭防火墙：\"><a href=\"#关闭防火墙：\" class=\"headerlink\" title=\"关闭防火墙：\"></a>关闭防火墙：</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">systemctl stop firewalld.service   # 关闭</div><div class=\"line\">systemctl disable firewalld.service # 开机不自启动</div></pre></td></tr></table></figure>\n"},{"title":"CentOS增加新硬盘给根文件系统扩容","id":"148","updated":"2017-04-21T05:12:33.000Z","date":"2017-04-18T09:48:57.000Z","_content":"\n由于刚开始做磁盘空间规划时，失误给根分区分配磁盘较小，导致后续实验环境无法进行，所以在经过研究后，决定尝试增加根分区的磁盘空间，注意这仅适用于创建在LVM上的文件系统。\n\n### 1. 实验环境\n\n* Parallels Desktop 12\n* CentOS 6.9\n* 根分区空间 6.5GB\n* 已使用 5.8GB\n* 预计 增加12G 磁盘空间\n\n<!-- more -->\n\n### 2. 增加一块物理磁盘\n\nParallels Desktop 不能在线增加磁盘，所以要先将VM关闭，然后添加：![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/m5e1d.jpg)\n\n增加12G的磁盘\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/prgyd.jpg)\n\n然后启动VM，这时可以通过```fdisk -l```查看当前已经增加了一块12G的磁盘\n\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/tat9r.jpg)\n\n\n\n### 3. 格式化磁盘并加入到VGroup组内\n\n#### 3.1 查看当前```pvdisplay``` 磁盘列表，将```/dev/sdb```创建pv块\n\n```\n[root@centos ~]# pvdisplay\n  --- Physical volume ---\n  PV Name               /dev/sda2\n  VG Name               vg_hadoop01\n  PV Size               7.51 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              1922\n  Free PE               0\n  Allocated PE          1922\n  PV UUID               MUCrDa-eJpZ-EXwE-YwwM-S2Az-p2m7-K9q3Fo\n\n[root@centos ~]# pvcreate /dev/sdb\n  Physical volume \"/dev/sdb\" successfully created\n[root@centos ~]# pvdisplay\n  --- Physical volume ---\n  PV Name               /dev/sda2\n  VG Name               vg_hadoop01\n  PV Size               7.51 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              1922\n  Free PE               0\n  Allocated PE          1922\n  PV UUID               MUCrDa-eJpZ-EXwE-YwwM-S2Az-p2m7-K9q3Fo\n\n  --- Physical volume ---\n  PV Name               /dev/sdb\n  VG Name               vg_hadoop01\n  PV Size               12.00 GiB / not usable 4.00 MiB\n  Allocatable           yes\n  PE Size               4.00 MiB\n  Total PE              3071\n  Free PE               3071\n  Allocated PE          0\n  PV UUID               XTpaBR-512W-vQIV-fwwz-So7L-ZCa3-yjDccQ\n```\n\n#### 3.2 查看当前```vgdisplay```VGroup组，将```/dev/sdb```加入根目录所在VGroup\n\n```\n[root@centos ~]# vgdisplay\n  --- Volume group ---\n  VG Name               vg_hadoop01\n  System ID\n  Format                lvm2\n  Metadata Areas        1\n  Metadata Sequence No  3\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                1\n  Act PV                1\n  VG Size               7.51 GiB\n  PE Size               4.00 MiB\n  Total PE              1922\n  Alloc PE / Size       1922 / 7.51 GiB\n  Free  PE / Size       0 / 0\n  VG UUID               szQ4fH-Sr1Z-V6c2-KVMp-ZUik-oUDP-rU8dQS\n\n[root@centos ~]# vgextend vg_hadoop01 /dev/sdb\n  Volume group \"vg_hadoop01\" successfully extended\n[root@centos ~]# vgdisplay\n  --- Volume group ---\n  VG Name               vg_hadoop01\n  System ID\n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  4\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               19.50 GiB\n  PE Size               4.00 MiB\n  Total PE              4993\n  Alloc PE / Size       1922 / 7.51 GiB\n  Free  PE / Size       3071 / 12.00 GiB\n  VG UUID               szQ4fH-Sr1Z-V6c2-KVMp-ZUik-oUDP-rU8dQS\n```\n\n#### 3.3 查看```lvdisplay```根卷的名称，将磁盘加入根卷的LV\n\n```\n[root@centos ~]# lvdisplay\n  --- Logical volume ---\n  LV Path                /dev/vg_hadoop01/lv_root\n  LV Name                lv_root\n  VG Name                vg_hadoop01\n  LV UUID                tJDetu-Theq-BQ5g-3ZFe-Gan7-1SSv-OHeYrH\n  LV Write Access        read/write\n  LV Creation host, time hadoop01, 2017-04-18 07:09:58 +0800\n  LV Status              available\n  # open                 1\n  LV Size                6.71 GiB\n  Current LE             1718\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n\n  --- Logical volume ---\n  LV Path                /dev/vg_hadoop01/lv_swap\n  LV Name                lv_swap\n  VG Name                vg_hadoop01\n  LV UUID                D4K7I6-tPO0-HMbC-VWkR-2HV4-WjAe-M82wYq\n  LV Write Access        read/write\n  LV Creation host, time hadoop01, 2017-04-18 07:09:59 +0800\n  LV Status              available\n  # open                 1\n  LV Size                816.00 MiB\n  Current LE             204\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:1\n\n[root@centos ~]# lvextend -l +100%FREE /dev/vg_hadoop01/lv_root\n  Size of logical volume vg_hadoop01/lv_root changed from 6.71 GiB (1718 extents) to 18.71 GiB (4789 extents).\n  Logical volume lv_root successfully resized.\n[root@centos ~]# lvdisplay\n  --- Logical volume ---\n  LV Path                /dev/vg_hadoop01/lv_root\n  LV Name                lv_root\n  VG Name                vg_hadoop01\n  LV UUID                tJDetu-Theq-BQ5g-3ZFe-Gan7-1SSv-OHeYrH\n  LV Write Access        read/write\n  LV Creation host, time hadoop01, 2017-04-18 07:09:58 +0800\n  LV Status              available\n  # open                 1\n  LV Size                18.71 GiB\n  Current LE             4789\n  Segments               2\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n\n  --- Logical volume ---\n  LV Path                /dev/vg_hadoop01/lv_swap\n  LV Name                lv_swap\n  VG Name                vg_hadoop01\n  LV UUID                D4K7I6-tPO0-HMbC-VWkR-2HV4-WjAe-M82wYq\n  LV Write Access        read/write\n  LV Creation host, time hadoop01, 2017-04-18 07:09:59 +0800\n  LV Status              available\n  # open                 1\n  LV Size                816.00 MiB\n  Current LE             204\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:1\n```\n\n### 更新磁盘分区表\n\n当你增加完成之后，这时使用```df -h```查看的磁盘空间仍然没有变化，因为我们还需要将根卷的分区表刷新。\n\n#### 使用```resize2fs```刷新根卷信息\n\n```\n[root@centos ~]# resize2fs /dev/vg_hadoop01/lv_root\nresize2fs 1.41.12 (17-May-2010)\nFilesystem at /dev/vg_hadoop01/lv_root is mounted on /; on-line resizing required\nold desc_blocks = 1, new_desc_blocks = 2\nPerforming an on-line resize of /dev/vg_hadoop01/lv_root to 4903936 (4k) blocks.\nThe filesystem on /dev/vg_hadoop01/lv_root is now 4903936 blocks long.\n\n[root@centos ~]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/vg_hadoop01-lv_root\n                       19G  5.8G   12G  33% /\ntmpfs                 244M     0  244M   0% /dev/shm\n/dev/sda1             477M   52M  400M  12% /boot\n```\n","source":"_posts/CentOS增加新硬盘给根文件系统扩容.md","raw":"---\ntitle: CentOS增加新硬盘给根文件系统扩容\ntags: 'LVM'\ncategories: 'CentOS'\npermalink: qvfwlg9yq\nid: 148\nupdated: '2017-04-21 13:12:33'\ndate: 2017-04-18 17:48:57\n---\n\n由于刚开始做磁盘空间规划时，失误给根分区分配磁盘较小，导致后续实验环境无法进行，所以在经过研究后，决定尝试增加根分区的磁盘空间，注意这仅适用于创建在LVM上的文件系统。\n\n### 1. 实验环境\n\n* Parallels Desktop 12\n* CentOS 6.9\n* 根分区空间 6.5GB\n* 已使用 5.8GB\n* 预计 增加12G 磁盘空间\n\n<!-- more -->\n\n### 2. 增加一块物理磁盘\n\nParallels Desktop 不能在线增加磁盘，所以要先将VM关闭，然后添加：![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/m5e1d.jpg)\n\n增加12G的磁盘\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/prgyd.jpg)\n\n然后启动VM，这时可以通过```fdisk -l```查看当前已经增加了一块12G的磁盘\n\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/tat9r.jpg)\n\n\n\n### 3. 格式化磁盘并加入到VGroup组内\n\n#### 3.1 查看当前```pvdisplay``` 磁盘列表，将```/dev/sdb```创建pv块\n\n```\n[root@centos ~]# pvdisplay\n  --- Physical volume ---\n  PV Name               /dev/sda2\n  VG Name               vg_hadoop01\n  PV Size               7.51 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              1922\n  Free PE               0\n  Allocated PE          1922\n  PV UUID               MUCrDa-eJpZ-EXwE-YwwM-S2Az-p2m7-K9q3Fo\n\n[root@centos ~]# pvcreate /dev/sdb\n  Physical volume \"/dev/sdb\" successfully created\n[root@centos ~]# pvdisplay\n  --- Physical volume ---\n  PV Name               /dev/sda2\n  VG Name               vg_hadoop01\n  PV Size               7.51 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              1922\n  Free PE               0\n  Allocated PE          1922\n  PV UUID               MUCrDa-eJpZ-EXwE-YwwM-S2Az-p2m7-K9q3Fo\n\n  --- Physical volume ---\n  PV Name               /dev/sdb\n  VG Name               vg_hadoop01\n  PV Size               12.00 GiB / not usable 4.00 MiB\n  Allocatable           yes\n  PE Size               4.00 MiB\n  Total PE              3071\n  Free PE               3071\n  Allocated PE          0\n  PV UUID               XTpaBR-512W-vQIV-fwwz-So7L-ZCa3-yjDccQ\n```\n\n#### 3.2 查看当前```vgdisplay```VGroup组，将```/dev/sdb```加入根目录所在VGroup\n\n```\n[root@centos ~]# vgdisplay\n  --- Volume group ---\n  VG Name               vg_hadoop01\n  System ID\n  Format                lvm2\n  Metadata Areas        1\n  Metadata Sequence No  3\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                1\n  Act PV                1\n  VG Size               7.51 GiB\n  PE Size               4.00 MiB\n  Total PE              1922\n  Alloc PE / Size       1922 / 7.51 GiB\n  Free  PE / Size       0 / 0\n  VG UUID               szQ4fH-Sr1Z-V6c2-KVMp-ZUik-oUDP-rU8dQS\n\n[root@centos ~]# vgextend vg_hadoop01 /dev/sdb\n  Volume group \"vg_hadoop01\" successfully extended\n[root@centos ~]# vgdisplay\n  --- Volume group ---\n  VG Name               vg_hadoop01\n  System ID\n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  4\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               19.50 GiB\n  PE Size               4.00 MiB\n  Total PE              4993\n  Alloc PE / Size       1922 / 7.51 GiB\n  Free  PE / Size       3071 / 12.00 GiB\n  VG UUID               szQ4fH-Sr1Z-V6c2-KVMp-ZUik-oUDP-rU8dQS\n```\n\n#### 3.3 查看```lvdisplay```根卷的名称，将磁盘加入根卷的LV\n\n```\n[root@centos ~]# lvdisplay\n  --- Logical volume ---\n  LV Path                /dev/vg_hadoop01/lv_root\n  LV Name                lv_root\n  VG Name                vg_hadoop01\n  LV UUID                tJDetu-Theq-BQ5g-3ZFe-Gan7-1SSv-OHeYrH\n  LV Write Access        read/write\n  LV Creation host, time hadoop01, 2017-04-18 07:09:58 +0800\n  LV Status              available\n  # open                 1\n  LV Size                6.71 GiB\n  Current LE             1718\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n\n  --- Logical volume ---\n  LV Path                /dev/vg_hadoop01/lv_swap\n  LV Name                lv_swap\n  VG Name                vg_hadoop01\n  LV UUID                D4K7I6-tPO0-HMbC-VWkR-2HV4-WjAe-M82wYq\n  LV Write Access        read/write\n  LV Creation host, time hadoop01, 2017-04-18 07:09:59 +0800\n  LV Status              available\n  # open                 1\n  LV Size                816.00 MiB\n  Current LE             204\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:1\n\n[root@centos ~]# lvextend -l +100%FREE /dev/vg_hadoop01/lv_root\n  Size of logical volume vg_hadoop01/lv_root changed from 6.71 GiB (1718 extents) to 18.71 GiB (4789 extents).\n  Logical volume lv_root successfully resized.\n[root@centos ~]# lvdisplay\n  --- Logical volume ---\n  LV Path                /dev/vg_hadoop01/lv_root\n  LV Name                lv_root\n  VG Name                vg_hadoop01\n  LV UUID                tJDetu-Theq-BQ5g-3ZFe-Gan7-1SSv-OHeYrH\n  LV Write Access        read/write\n  LV Creation host, time hadoop01, 2017-04-18 07:09:58 +0800\n  LV Status              available\n  # open                 1\n  LV Size                18.71 GiB\n  Current LE             4789\n  Segments               2\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n\n  --- Logical volume ---\n  LV Path                /dev/vg_hadoop01/lv_swap\n  LV Name                lv_swap\n  VG Name                vg_hadoop01\n  LV UUID                D4K7I6-tPO0-HMbC-VWkR-2HV4-WjAe-M82wYq\n  LV Write Access        read/write\n  LV Creation host, time hadoop01, 2017-04-18 07:09:59 +0800\n  LV Status              available\n  # open                 1\n  LV Size                816.00 MiB\n  Current LE             204\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:1\n```\n\n### 更新磁盘分区表\n\n当你增加完成之后，这时使用```df -h```查看的磁盘空间仍然没有变化，因为我们还需要将根卷的分区表刷新。\n\n#### 使用```resize2fs```刷新根卷信息\n\n```\n[root@centos ~]# resize2fs /dev/vg_hadoop01/lv_root\nresize2fs 1.41.12 (17-May-2010)\nFilesystem at /dev/vg_hadoop01/lv_root is mounted on /; on-line resizing required\nold desc_blocks = 1, new_desc_blocks = 2\nPerforming an on-line resize of /dev/vg_hadoop01/lv_root to 4903936 (4k) blocks.\nThe filesystem on /dev/vg_hadoop01/lv_root is now 4903936 blocks long.\n\n[root@centos ~]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/vg_hadoop01-lv_root\n                       19G  5.8G   12G  33% /\ntmpfs                 244M     0  244M   0% /dev/shm\n/dev/sda1             477M   52M  400M  12% /boot\n```\n","slug":"qvfwlg9yq","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq63000j41tpeae7ixc2","content":"<p>由于刚开始做磁盘空间规划时，失误给根分区分配磁盘较小，导致后续实验环境无法进行，所以在经过研究后，决定尝试增加根分区的磁盘空间，注意这仅适用于创建在LVM上的文件系统。</p>\n<h3 id=\"1-实验环境\"><a href=\"#1-实验环境\" class=\"headerlink\" title=\"1. 实验环境\"></a>1. 实验环境</h3><ul>\n<li>Parallels Desktop 12</li>\n<li>CentOS 6.9</li>\n<li>根分区空间 6.5GB</li>\n<li>已使用 5.8GB</li>\n<li>预计 增加12G 磁盘空间</li>\n</ul>\n<a id=\"more\"></a>\n<h3 id=\"2-增加一块物理磁盘\"><a href=\"#2-增加一块物理磁盘\" class=\"headerlink\" title=\"2. 增加一块物理磁盘\"></a>2. 增加一块物理磁盘</h3><p>Parallels Desktop 不能在线增加磁盘，所以要先将VM关闭，然后添加：<img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/m5e1d.jpg\" alt=\"\"></p>\n<p>增加12G的磁盘<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/prgyd.jpg\" alt=\"\"></p>\n<p>然后启动VM，这时可以通过<figure class=\"highlight plain\"><figcaption><span>-l```查看当前已经增加了一块12G的磁盘</span></figcaption><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/tat9r.jpg)</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">### 3. 格式化磁盘并加入到VGroup组内</div><div class=\"line\"></div><div class=\"line\">#### 3.1 查看当前```pvdisplay``` 磁盘列表，将```/dev/sdb```创建pv块</div></pre></td></tr></table></figure></p>\n<p>[root@centos ~]# pvdisplay<br>  — Physical volume —<br>  PV Name               /dev/sda2<br>  VG Name               vg_hadoop01<br>  PV Size               7.51 GiB / not usable 3.00 MiB<br>  Allocatable           yes (but full)<br>  PE Size               4.00 MiB<br>  Total PE              1922<br>  Free PE               0<br>  Allocated PE          1922<br>  PV UUID               MUCrDa-eJpZ-EXwE-YwwM-S2Az-p2m7-K9q3Fo</p>\n<p>[root@centos ~]# pvcreate /dev/sdb<br>  Physical volume “/dev/sdb” successfully created<br>[root@centos ~]# pvdisplay<br>  — Physical volume —<br>  PV Name               /dev/sda2<br>  VG Name               vg_hadoop01<br>  PV Size               7.51 GiB / not usable 3.00 MiB<br>  Allocatable           yes (but full)<br>  PE Size               4.00 MiB<br>  Total PE              1922<br>  Free PE               0<br>  Allocated PE          1922<br>  PV UUID               MUCrDa-eJpZ-EXwE-YwwM-S2Az-p2m7-K9q3Fo</p>\n<p>  — Physical volume —<br>  PV Name               /dev/sdb<br>  VG Name               vg_hadoop01<br>  PV Size               12.00 GiB / not usable 4.00 MiB<br>  Allocatable           yes<br>  PE Size               4.00 MiB<br>  Total PE              3071<br>  Free PE               3071<br>  Allocated PE          0<br>  PV UUID               XTpaBR-512W-vQIV-fwwz-So7L-ZCa3-yjDccQ<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">#### 3.2 查看当前```vgdisplay```VGroup组，将```/dev/sdb```加入根目录所在VGroup</div></pre></td></tr></table></figure></p>\n<p>[root@centos ~]# vgdisplay<br>  — Volume group —<br>  VG Name               vg_hadoop01<br>  System ID<br>  Format                lvm2<br>  Metadata Areas        1<br>  Metadata Sequence No  3<br>  VG Access             read/write<br>  VG Status             resizable<br>  MAX LV                0<br>  Cur LV                2<br>  Open LV               2<br>  Max PV                0<br>  Cur PV                1<br>  Act PV                1<br>  VG Size               7.51 GiB<br>  PE Size               4.00 MiB<br>  Total PE              1922<br>  Alloc PE / Size       1922 / 7.51 GiB<br>  Free  PE / Size       0 / 0<br>  VG UUID               szQ4fH-Sr1Z-V6c2-KVMp-ZUik-oUDP-rU8dQS</p>\n<p>[root@centos ~]# vgextend vg_hadoop01 /dev/sdb<br>  Volume group “vg_hadoop01” successfully extended<br>[root@centos ~]# vgdisplay<br>  — Volume group —<br>  VG Name               vg_hadoop01<br>  System ID<br>  Format                lvm2<br>  Metadata Areas        2<br>  Metadata Sequence No  4<br>  VG Access             read/write<br>  VG Status             resizable<br>  MAX LV                0<br>  Cur LV                2<br>  Open LV               2<br>  Max PV                0<br>  Cur PV                2<br>  Act PV                2<br>  VG Size               19.50 GiB<br>  PE Size               4.00 MiB<br>  Total PE              4993<br>  Alloc PE / Size       1922 / 7.51 GiB<br>  Free  PE / Size       3071 / 12.00 GiB<br>  VG UUID               szQ4fH-Sr1Z-V6c2-KVMp-ZUik-oUDP-rU8dQS<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">#### 3.3 查看```lvdisplay```根卷的名称，将磁盘加入根卷的LV</div></pre></td></tr></table></figure></p>\n<p>[root@centos ~]# lvdisplay<br>  — Logical volume —<br>  LV Path                /dev/vg_hadoop01/lv_root<br>  LV Name                lv_root<br>  VG Name                vg_hadoop01<br>  LV UUID                tJDetu-Theq-BQ5g-3ZFe-Gan7-1SSv-OHeYrH<br>  LV Write Access        read/write<br>  LV Creation host, time hadoop01, 2017-04-18 07:09:58 +0800<br>  LV Status              available</p>\n<h1 id=\"open-1\"><a href=\"#open-1\" class=\"headerlink\" title=\"open                 1\"></a>open                 1</h1><p>  LV Size                6.71 GiB<br>  Current LE             1718<br>  Segments               1<br>  Allocation             inherit<br>  Read ahead sectors     auto</p>\n<ul>\n<li><p>currently set to     256<br>Block device           253:0</p>\n<p>— Logical volume —<br>LV Path                /dev/vg_hadoop01/lv_swap<br>LV Name                lv_swap<br>VG Name                vg_hadoop01<br>LV UUID                D4K7I6-tPO0-HMbC-VWkR-2HV4-WjAe-M82wYq<br>LV Write Access        read/write<br>LV Creation host, time hadoop01, 2017-04-18 07:09:59 +0800<br>LV Status              available</p>\n<h1 id=\"open-1-1\"><a href=\"#open-1-1\" class=\"headerlink\" title=\"open                 1\"></a>open                 1</h1><p>LV Size                816.00 MiB<br>Current LE             204<br>Segments               1<br>Allocation             inherit<br>Read ahead sectors     auto</p>\n</li>\n<li>currently set to     256<br>Block device           253:1</li>\n</ul>\n<p>[root@centos ~]# lvextend -l +100%FREE /dev/vg_hadoop01/lv_root<br>  Size of logical volume vg_hadoop01/lv_root changed from 6.71 GiB (1718 extents) to 18.71 GiB (4789 extents).<br>  Logical volume lv_root successfully resized.<br>[root@centos ~]# lvdisplay<br>  — Logical volume —<br>  LV Path                /dev/vg_hadoop01/lv_root<br>  LV Name                lv_root<br>  VG Name                vg_hadoop01<br>  LV UUID                tJDetu-Theq-BQ5g-3ZFe-Gan7-1SSv-OHeYrH<br>  LV Write Access        read/write<br>  LV Creation host, time hadoop01, 2017-04-18 07:09:58 +0800<br>  LV Status              available</p>\n<h1 id=\"open-1-2\"><a href=\"#open-1-2\" class=\"headerlink\" title=\"open                 1\"></a>open                 1</h1><p>  LV Size                18.71 GiB<br>  Current LE             4789<br>  Segments               2<br>  Allocation             inherit<br>  Read ahead sectors     auto</p>\n<ul>\n<li><p>currently set to     256<br>Block device           253:0</p>\n<p>— Logical volume —<br>LV Path                /dev/vg_hadoop01/lv_swap<br>LV Name                lv_swap<br>VG Name                vg_hadoop01<br>LV UUID                D4K7I6-tPO0-HMbC-VWkR-2HV4-WjAe-M82wYq<br>LV Write Access        read/write<br>LV Creation host, time hadoop01, 2017-04-18 07:09:59 +0800<br>LV Status              available</p>\n<h1 id=\"open-1-3\"><a href=\"#open-1-3\" class=\"headerlink\" title=\"open                 1\"></a>open                 1</h1><p>LV Size                816.00 MiB<br>Current LE             204<br>Segments               1<br>Allocation             inherit<br>Read ahead sectors     auto</p>\n</li>\n<li>currently set to     256<br>Block device           253:1<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">### 更新磁盘分区表</div><div class=\"line\"></div><div class=\"line\">当你增加完成之后，这时使用```df -h```查看的磁盘空间仍然没有变化，因为我们还需要将根卷的分区表刷新。</div><div class=\"line\"></div><div class=\"line\">#### 使用```resize2fs```刷新根卷信息</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>[root@centos ~]# resize2fs /dev/vg_hadoop01/lv_root<br>resize2fs 1.41.12 (17-May-2010)<br>Filesystem at /dev/vg_hadoop01/lv_root is mounted on /; on-line resizing required<br>old desc_blocks = 1, new_desc_blocks = 2<br>Performing an on-line resize of /dev/vg_hadoop01/lv_root to 4903936 (4k) blocks.<br>The filesystem on /dev/vg_hadoop01/lv_root is now 4903936 blocks long.</p>\n<p>[root@centos ~]# df -h<br>Filesystem            Size  Used Avail Use% Mounted on<br>/dev/mapper/vg_hadoop01-lv_root<br>                       19G  5.8G   12G  33% /<br>tmpfs                 244M     0  244M   0% /dev/shm<br>/dev/sda1             477M   52M  400M  12% /boot<br>```</p>\n","site":{"data":{}},"excerpt":"<p>由于刚开始做磁盘空间规划时，失误给根分区分配磁盘较小，导致后续实验环境无法进行，所以在经过研究后，决定尝试增加根分区的磁盘空间，注意这仅适用于创建在LVM上的文件系统。</p>\n<h3 id=\"1-实验环境\"><a href=\"#1-实验环境\" class=\"headerlink\" title=\"1. 实验环境\"></a>1. 实验环境</h3><ul>\n<li>Parallels Desktop 12</li>\n<li>CentOS 6.9</li>\n<li>根分区空间 6.5GB</li>\n<li>已使用 5.8GB</li>\n<li>预计 增加12G 磁盘空间</li>\n</ul>","more":"<h3 id=\"2-增加一块物理磁盘\"><a href=\"#2-增加一块物理磁盘\" class=\"headerlink\" title=\"2. 增加一块物理磁盘\"></a>2. 增加一块物理磁盘</h3><p>Parallels Desktop 不能在线增加磁盘，所以要先将VM关闭，然后添加：<img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/m5e1d.jpg\" alt=\"\"></p>\n<p>增加12G的磁盘<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/prgyd.jpg\" alt=\"\"></p>\n<p>然后启动VM，这时可以通过<figure class=\"highlight plain\"><figcaption><span>-l```查看当前已经增加了一块12G的磁盘</span></figcaption><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/tat9r.jpg)</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">### 3. 格式化磁盘并加入到VGroup组内</div><div class=\"line\"></div><div class=\"line\">#### 3.1 查看当前```pvdisplay``` 磁盘列表，将```/dev/sdb```创建pv块</div></pre></td></tr></table></figure></p>\n<p>[root@centos ~]# pvdisplay<br>  — Physical volume —<br>  PV Name               /dev/sda2<br>  VG Name               vg_hadoop01<br>  PV Size               7.51 GiB / not usable 3.00 MiB<br>  Allocatable           yes (but full)<br>  PE Size               4.00 MiB<br>  Total PE              1922<br>  Free PE               0<br>  Allocated PE          1922<br>  PV UUID               MUCrDa-eJpZ-EXwE-YwwM-S2Az-p2m7-K9q3Fo</p>\n<p>[root@centos ~]# pvcreate /dev/sdb<br>  Physical volume “/dev/sdb” successfully created<br>[root@centos ~]# pvdisplay<br>  — Physical volume —<br>  PV Name               /dev/sda2<br>  VG Name               vg_hadoop01<br>  PV Size               7.51 GiB / not usable 3.00 MiB<br>  Allocatable           yes (but full)<br>  PE Size               4.00 MiB<br>  Total PE              1922<br>  Free PE               0<br>  Allocated PE          1922<br>  PV UUID               MUCrDa-eJpZ-EXwE-YwwM-S2Az-p2m7-K9q3Fo</p>\n<p>  — Physical volume —<br>  PV Name               /dev/sdb<br>  VG Name               vg_hadoop01<br>  PV Size               12.00 GiB / not usable 4.00 MiB<br>  Allocatable           yes<br>  PE Size               4.00 MiB<br>  Total PE              3071<br>  Free PE               3071<br>  Allocated PE          0<br>  PV UUID               XTpaBR-512W-vQIV-fwwz-So7L-ZCa3-yjDccQ<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">#### 3.2 查看当前```vgdisplay```VGroup组，将```/dev/sdb```加入根目录所在VGroup</div></pre></td></tr></table></figure></p>\n<p>[root@centos ~]# vgdisplay<br>  — Volume group —<br>  VG Name               vg_hadoop01<br>  System ID<br>  Format                lvm2<br>  Metadata Areas        1<br>  Metadata Sequence No  3<br>  VG Access             read/write<br>  VG Status             resizable<br>  MAX LV                0<br>  Cur LV                2<br>  Open LV               2<br>  Max PV                0<br>  Cur PV                1<br>  Act PV                1<br>  VG Size               7.51 GiB<br>  PE Size               4.00 MiB<br>  Total PE              1922<br>  Alloc PE / Size       1922 / 7.51 GiB<br>  Free  PE / Size       0 / 0<br>  VG UUID               szQ4fH-Sr1Z-V6c2-KVMp-ZUik-oUDP-rU8dQS</p>\n<p>[root@centos ~]# vgextend vg_hadoop01 /dev/sdb<br>  Volume group “vg_hadoop01” successfully extended<br>[root@centos ~]# vgdisplay<br>  — Volume group —<br>  VG Name               vg_hadoop01<br>  System ID<br>  Format                lvm2<br>  Metadata Areas        2<br>  Metadata Sequence No  4<br>  VG Access             read/write<br>  VG Status             resizable<br>  MAX LV                0<br>  Cur LV                2<br>  Open LV               2<br>  Max PV                0<br>  Cur PV                2<br>  Act PV                2<br>  VG Size               19.50 GiB<br>  PE Size               4.00 MiB<br>  Total PE              4993<br>  Alloc PE / Size       1922 / 7.51 GiB<br>  Free  PE / Size       3071 / 12.00 GiB<br>  VG UUID               szQ4fH-Sr1Z-V6c2-KVMp-ZUik-oUDP-rU8dQS<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">#### 3.3 查看```lvdisplay```根卷的名称，将磁盘加入根卷的LV</div></pre></td></tr></table></figure></p>\n<p>[root@centos ~]# lvdisplay<br>  — Logical volume —<br>  LV Path                /dev/vg_hadoop01/lv_root<br>  LV Name                lv_root<br>  VG Name                vg_hadoop01<br>  LV UUID                tJDetu-Theq-BQ5g-3ZFe-Gan7-1SSv-OHeYrH<br>  LV Write Access        read/write<br>  LV Creation host, time hadoop01, 2017-04-18 07:09:58 +0800<br>  LV Status              available</p>\n<h1 id=\"open-1\"><a href=\"#open-1\" class=\"headerlink\" title=\"open                 1\"></a>open                 1</h1><p>  LV Size                6.71 GiB<br>  Current LE             1718<br>  Segments               1<br>  Allocation             inherit<br>  Read ahead sectors     auto</p>\n<ul>\n<li><p>currently set to     256<br>Block device           253:0</p>\n<p>— Logical volume —<br>LV Path                /dev/vg_hadoop01/lv_swap<br>LV Name                lv_swap<br>VG Name                vg_hadoop01<br>LV UUID                D4K7I6-tPO0-HMbC-VWkR-2HV4-WjAe-M82wYq<br>LV Write Access        read/write<br>LV Creation host, time hadoop01, 2017-04-18 07:09:59 +0800<br>LV Status              available</p>\n<h1 id=\"open-1-1\"><a href=\"#open-1-1\" class=\"headerlink\" title=\"open                 1\"></a>open                 1</h1><p>LV Size                816.00 MiB<br>Current LE             204<br>Segments               1<br>Allocation             inherit<br>Read ahead sectors     auto</p>\n</li>\n<li>currently set to     256<br>Block device           253:1</li>\n</ul>\n<p>[root@centos ~]# lvextend -l +100%FREE /dev/vg_hadoop01/lv_root<br>  Size of logical volume vg_hadoop01/lv_root changed from 6.71 GiB (1718 extents) to 18.71 GiB (4789 extents).<br>  Logical volume lv_root successfully resized.<br>[root@centos ~]# lvdisplay<br>  — Logical volume —<br>  LV Path                /dev/vg_hadoop01/lv_root<br>  LV Name                lv_root<br>  VG Name                vg_hadoop01<br>  LV UUID                tJDetu-Theq-BQ5g-3ZFe-Gan7-1SSv-OHeYrH<br>  LV Write Access        read/write<br>  LV Creation host, time hadoop01, 2017-04-18 07:09:58 +0800<br>  LV Status              available</p>\n<h1 id=\"open-1-2\"><a href=\"#open-1-2\" class=\"headerlink\" title=\"open                 1\"></a>open                 1</h1><p>  LV Size                18.71 GiB<br>  Current LE             4789<br>  Segments               2<br>  Allocation             inherit<br>  Read ahead sectors     auto</p>\n<ul>\n<li><p>currently set to     256<br>Block device           253:0</p>\n<p>— Logical volume —<br>LV Path                /dev/vg_hadoop01/lv_swap<br>LV Name                lv_swap<br>VG Name                vg_hadoop01<br>LV UUID                D4K7I6-tPO0-HMbC-VWkR-2HV4-WjAe-M82wYq<br>LV Write Access        read/write<br>LV Creation host, time hadoop01, 2017-04-18 07:09:59 +0800<br>LV Status              available</p>\n<h1 id=\"open-1-3\"><a href=\"#open-1-3\" class=\"headerlink\" title=\"open                 1\"></a>open                 1</h1><p>LV Size                816.00 MiB<br>Current LE             204<br>Segments               1<br>Allocation             inherit<br>Read ahead sectors     auto</p>\n</li>\n<li>currently set to     256<br>Block device           253:1<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">### 更新磁盘分区表</div><div class=\"line\"></div><div class=\"line\">当你增加完成之后，这时使用```df -h```查看的磁盘空间仍然没有变化，因为我们还需要将根卷的分区表刷新。</div><div class=\"line\"></div><div class=\"line\">#### 使用```resize2fs```刷新根卷信息</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>[root@centos ~]# resize2fs /dev/vg_hadoop01/lv_root<br>resize2fs 1.41.12 (17-May-2010)<br>Filesystem at /dev/vg_hadoop01/lv_root is mounted on /; on-line resizing required<br>old desc_blocks = 1, new_desc_blocks = 2<br>Performing an on-line resize of /dev/vg_hadoop01/lv_root to 4903936 (4k) blocks.<br>The filesystem on /dev/vg_hadoop01/lv_root is now 4903936 blocks long.</p>\n<p>[root@centos ~]# df -h<br>Filesystem            Size  Used Avail Use% Mounted on<br>/dev/mapper/vg_hadoop01-lv_root<br>                       19G  5.8G   12G  33% /<br>tmpfs                 244M     0  244M   0% /dev/shm<br>/dev/sda1             477M   52M  400M  12% /boot<br>```</p>"},{"title":"Denyhosts增加服务器SSH黑名单机制","id":"115","updated":"2017-04-21T05:18:14.000Z","date":"2016-11-23T08:24:40.000Z","_content":"\n\n\n##### 查看当前服务器失败登录的统计：\n```\ncat /var/log/secure | awk '/Failed/{print $(NF-3)}' | sort | uniq -c | sort -n |  awk '{print $2\" = \"$1}'\n```\n##### Install denyhosts\n```\n# 需要预先安装epel源\nsudo yum install -y epel-release\nsudo yum install -y denyhosts\n```\n##### 配置文件解析\n默认配置文件/etc/denyhosts。\n```\n# 查看的sshd日志文件\nSECURE_LOG = /var/log/secure\n\n# 将阻止IP写入的配置文件\nHOSTS_DENY = /etc/hosts.deny\n\n# 过多久之后清除，其中w代表周，d代表天，h代表小时，s代表秒，m代表分钟。\nPURGE_DENY = 4h\n\n# 阻止的服务名称\nBLOCK_SERVICE  = sshd\n\n# 允许无效用户（在/etc/passwd未列出）登录失败次数,允许无效用户登录失败的次数.\nDENY_THRESHOLD_INVALID = 1\n\n# 允许普通用户登录失败的次数\nDENY_THRESHOLD_VALID = 5\n\n# 允许root登录失败的次数\nDENY_THRESHOLD_ROOT = 2\nDENY_THRESHOLD_RESTRICTED = 1\n\n# 设定 deny host 写入到该资料夹\nWORK_DIR = /var/lib/denyhosts\n\n# 将deny的host或ip纪录到Work_dir中\nSUSPICIOUS_LOGIN_REPORT_ALLOWED_HOSTS=YES\n\n# 是否做域名反解\nHOSTNAME_LOOKUP=YES\n\n# 将DenyHOts启动的pid纪录到LOCK_FILE中，已确保服务正确启动，防止同时启动多个服务。\nLOCK_FILE = /var/lock/subsys/denyhosts\n\n# 设置管理员邮件地址\nADMIN_EMAIL = luchuanjia@msn.com\nSMTP_HOST = localhost\nSMTP_PORT = 25\nSMTP_FROM = DenyHosts <nobody@localhost>\nSMTP_SUBJECT = DenyHosts Report from $[HOSTNAME]\n\n# 有效用户登录失败计数归零的时间\nAGE_RESET_VALID=1d\n\n# root用户登录失败计数归零的时间\nAGE_RESET_ROOT=25d\n\n# 用户的失败登录计数重置为0的时间(/usr/share/denyhosts/data/restricted-usernames)\nAGE_RESET_RESTRICTED=25d\n\n# 无效用户登录失败计数归零的时间\nAGE_RESET_INVALID=10d\n\n# denyhosts的日志文件位置\nDAEMON_LOG = /var/log/denyhosts\n\n# denyhosts的轮询时间\nDAEMON_SLEEP = 30s\n\n# 该项与PURGE_DENY 设置一样，也是清除hosts.deny中 ssh用户的时间\nDAEMON_PURGE = 1h\n```\n\n##### FAQ\n\n1. 如果想删除一个已经禁止的主机IP，并加入到允许主机例表，只在 /etc/hosts.deny 删除是没用的,还需要以下：\n```\n/var/lib/denyhosts 目录，进入以下操作：\n# 停止denyhosts服务\nsudo service denyhosts stop\n\n# 进入denyhosts的目录\ncd /var/lib/denyhosts\n\n# 查看哪些文件添加了ssh限制,将IP_addr替换成你的IP\nsudo grep IP_addr /usr/share/denyhosts/data/*\n\n# 然后一个个删除文件中你想取消的主机IP所在的行:\n/usr/share/denyhosts/data/hosts\n/usr/share/denyhosts/data/hosts-restricted\n/usr/share/denyhosts/data/hosts-root\n/usr/share/denyhosts/data/hosts-valid\n/usr/share/denyhosts/data/users-hosts\n\n# 添加你想允许的主机IP地址到allowed-hosts:\nsudo echo IP_addr >>/usr/share/denyhosts/data/allowed-hostsps\n\n# 启动 DenyHosts服务：\n service denyhosts start\n```\n\n##### Tips\n\n* 尽量是用key验证登录服务器\n* 尽量从固定IP点登录服务器，然后将该地址加入白名单\n","source":"_posts/Denyhosts增加服务器SSH黑名单机制.md","raw":"---\ntitle: Denyhosts增加服务器SSH黑名单机制\ntags: 'DenyHosts'\ncategories: 'CentOS'\npermalink: denyhosts-linux\nid: 115\nupdated: '2017-04-21 13:18:14'\ndate: 2016-11-23 16:24:40\n---\n\n\n\n##### 查看当前服务器失败登录的统计：\n```\ncat /var/log/secure | awk '/Failed/{print $(NF-3)}' | sort | uniq -c | sort -n |  awk '{print $2\" = \"$1}'\n```\n##### Install denyhosts\n```\n# 需要预先安装epel源\nsudo yum install -y epel-release\nsudo yum install -y denyhosts\n```\n##### 配置文件解析\n默认配置文件/etc/denyhosts。\n```\n# 查看的sshd日志文件\nSECURE_LOG = /var/log/secure\n\n# 将阻止IP写入的配置文件\nHOSTS_DENY = /etc/hosts.deny\n\n# 过多久之后清除，其中w代表周，d代表天，h代表小时，s代表秒，m代表分钟。\nPURGE_DENY = 4h\n\n# 阻止的服务名称\nBLOCK_SERVICE  = sshd\n\n# 允许无效用户（在/etc/passwd未列出）登录失败次数,允许无效用户登录失败的次数.\nDENY_THRESHOLD_INVALID = 1\n\n# 允许普通用户登录失败的次数\nDENY_THRESHOLD_VALID = 5\n\n# 允许root登录失败的次数\nDENY_THRESHOLD_ROOT = 2\nDENY_THRESHOLD_RESTRICTED = 1\n\n# 设定 deny host 写入到该资料夹\nWORK_DIR = /var/lib/denyhosts\n\n# 将deny的host或ip纪录到Work_dir中\nSUSPICIOUS_LOGIN_REPORT_ALLOWED_HOSTS=YES\n\n# 是否做域名反解\nHOSTNAME_LOOKUP=YES\n\n# 将DenyHOts启动的pid纪录到LOCK_FILE中，已确保服务正确启动，防止同时启动多个服务。\nLOCK_FILE = /var/lock/subsys/denyhosts\n\n# 设置管理员邮件地址\nADMIN_EMAIL = luchuanjia@msn.com\nSMTP_HOST = localhost\nSMTP_PORT = 25\nSMTP_FROM = DenyHosts <nobody@localhost>\nSMTP_SUBJECT = DenyHosts Report from $[HOSTNAME]\n\n# 有效用户登录失败计数归零的时间\nAGE_RESET_VALID=1d\n\n# root用户登录失败计数归零的时间\nAGE_RESET_ROOT=25d\n\n# 用户的失败登录计数重置为0的时间(/usr/share/denyhosts/data/restricted-usernames)\nAGE_RESET_RESTRICTED=25d\n\n# 无效用户登录失败计数归零的时间\nAGE_RESET_INVALID=10d\n\n# denyhosts的日志文件位置\nDAEMON_LOG = /var/log/denyhosts\n\n# denyhosts的轮询时间\nDAEMON_SLEEP = 30s\n\n# 该项与PURGE_DENY 设置一样，也是清除hosts.deny中 ssh用户的时间\nDAEMON_PURGE = 1h\n```\n\n##### FAQ\n\n1. 如果想删除一个已经禁止的主机IP，并加入到允许主机例表，只在 /etc/hosts.deny 删除是没用的,还需要以下：\n```\n/var/lib/denyhosts 目录，进入以下操作：\n# 停止denyhosts服务\nsudo service denyhosts stop\n\n# 进入denyhosts的目录\ncd /var/lib/denyhosts\n\n# 查看哪些文件添加了ssh限制,将IP_addr替换成你的IP\nsudo grep IP_addr /usr/share/denyhosts/data/*\n\n# 然后一个个删除文件中你想取消的主机IP所在的行:\n/usr/share/denyhosts/data/hosts\n/usr/share/denyhosts/data/hosts-restricted\n/usr/share/denyhosts/data/hosts-root\n/usr/share/denyhosts/data/hosts-valid\n/usr/share/denyhosts/data/users-hosts\n\n# 添加你想允许的主机IP地址到allowed-hosts:\nsudo echo IP_addr >>/usr/share/denyhosts/data/allowed-hostsps\n\n# 启动 DenyHosts服务：\n service denyhosts start\n```\n\n##### Tips\n\n* 尽量是用key验证登录服务器\n* 尽量从固定IP点登录服务器，然后将该地址加入白名单\n","slug":"denyhosts-linux","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq6a000n41tpdgmr07dy","content":"<h5 id=\"查看当前服务器失败登录的统计：\"><a href=\"#查看当前服务器失败登录的统计：\" class=\"headerlink\" title=\"查看当前服务器失败登录的统计：\"></a>查看当前服务器失败登录的统计：</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cat /var/log/secure | awk &apos;/Failed/&#123;print $(NF-3)&#125;&apos; | sort | uniq -c | sort -n |  awk &apos;&#123;print $2&quot; = &quot;$1&#125;&apos;</div></pre></td></tr></table></figure>\n<h5 id=\"Install-denyhosts\"><a href=\"#Install-denyhosts\" class=\"headerlink\" title=\"Install denyhosts\"></a>Install denyhosts</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 需要预先安装epel源</div><div class=\"line\">sudo yum install -y epel-release</div><div class=\"line\">sudo yum install -y denyhosts</div></pre></td></tr></table></figure>\n<h5 id=\"配置文件解析\"><a href=\"#配置文件解析\" class=\"headerlink\" title=\"配置文件解析\"></a>配置文件解析</h5><p>默认配置文件/etc/denyhosts。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 查看的sshd日志文件</div><div class=\"line\">SECURE_LOG = /var/log/secure</div><div class=\"line\"></div><div class=\"line\"># 将阻止IP写入的配置文件</div><div class=\"line\">HOSTS_DENY = /etc/hosts.deny</div><div class=\"line\"></div><div class=\"line\"># 过多久之后清除，其中w代表周，d代表天，h代表小时，s代表秒，m代表分钟。</div><div class=\"line\">PURGE_DENY = 4h</div><div class=\"line\"></div><div class=\"line\"># 阻止的服务名称</div><div class=\"line\">BLOCK_SERVICE  = sshd</div><div class=\"line\"></div><div class=\"line\"># 允许无效用户（在/etc/passwd未列出）登录失败次数,允许无效用户登录失败的次数.</div><div class=\"line\">DENY_THRESHOLD_INVALID = 1</div><div class=\"line\"></div><div class=\"line\"># 允许普通用户登录失败的次数</div><div class=\"line\">DENY_THRESHOLD_VALID = 5</div><div class=\"line\"></div><div class=\"line\"># 允许root登录失败的次数</div><div class=\"line\">DENY_THRESHOLD_ROOT = 2</div><div class=\"line\">DENY_THRESHOLD_RESTRICTED = 1</div><div class=\"line\"></div><div class=\"line\"># 设定 deny host 写入到该资料夹</div><div class=\"line\">WORK_DIR = /var/lib/denyhosts</div><div class=\"line\"></div><div class=\"line\"># 将deny的host或ip纪录到Work_dir中</div><div class=\"line\">SUSPICIOUS_LOGIN_REPORT_ALLOWED_HOSTS=YES</div><div class=\"line\"></div><div class=\"line\"># 是否做域名反解</div><div class=\"line\">HOSTNAME_LOOKUP=YES</div><div class=\"line\"></div><div class=\"line\"># 将DenyHOts启动的pid纪录到LOCK_FILE中，已确保服务正确启动，防止同时启动多个服务。</div><div class=\"line\">LOCK_FILE = /var/lock/subsys/denyhosts</div><div class=\"line\"></div><div class=\"line\"># 设置管理员邮件地址</div><div class=\"line\">ADMIN_EMAIL = luchuanjia@msn.com</div><div class=\"line\">SMTP_HOST = localhost</div><div class=\"line\">SMTP_PORT = 25</div><div class=\"line\">SMTP_FROM = DenyHosts &lt;nobody@localhost&gt;</div><div class=\"line\">SMTP_SUBJECT = DenyHosts Report from $[HOSTNAME]</div><div class=\"line\"></div><div class=\"line\"># 有效用户登录失败计数归零的时间</div><div class=\"line\">AGE_RESET_VALID=1d</div><div class=\"line\"></div><div class=\"line\"># root用户登录失败计数归零的时间</div><div class=\"line\">AGE_RESET_ROOT=25d</div><div class=\"line\"></div><div class=\"line\"># 用户的失败登录计数重置为0的时间(/usr/share/denyhosts/data/restricted-usernames)</div><div class=\"line\">AGE_RESET_RESTRICTED=25d</div><div class=\"line\"></div><div class=\"line\"># 无效用户登录失败计数归零的时间</div><div class=\"line\">AGE_RESET_INVALID=10d</div><div class=\"line\"></div><div class=\"line\"># denyhosts的日志文件位置</div><div class=\"line\">DAEMON_LOG = /var/log/denyhosts</div><div class=\"line\"></div><div class=\"line\"># denyhosts的轮询时间</div><div class=\"line\">DAEMON_SLEEP = 30s</div><div class=\"line\"></div><div class=\"line\"># 该项与PURGE_DENY 设置一样，也是清除hosts.deny中 ssh用户的时间</div><div class=\"line\">DAEMON_PURGE = 1h</div></pre></td></tr></table></figure></p>\n<h5 id=\"FAQ\"><a href=\"#FAQ\" class=\"headerlink\" title=\"FAQ\"></a>FAQ</h5><ol>\n<li>如果想删除一个已经禁止的主机IP，并加入到允许主机例表，只在 /etc/hosts.deny 删除是没用的,还需要以下：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">/var/lib/denyhosts 目录，进入以下操作：</div><div class=\"line\"># 停止denyhosts服务</div><div class=\"line\">sudo service denyhosts stop</div><div class=\"line\"></div><div class=\"line\"># 进入denyhosts的目录</div><div class=\"line\">cd /var/lib/denyhosts</div><div class=\"line\"></div><div class=\"line\"># 查看哪些文件添加了ssh限制,将IP_addr替换成你的IP</div><div class=\"line\">sudo grep IP_addr /usr/share/denyhosts/data/*</div><div class=\"line\"></div><div class=\"line\"># 然后一个个删除文件中你想取消的主机IP所在的行:</div><div class=\"line\">/usr/share/denyhosts/data/hosts</div><div class=\"line\">/usr/share/denyhosts/data/hosts-restricted</div><div class=\"line\">/usr/share/denyhosts/data/hosts-root</div><div class=\"line\">/usr/share/denyhosts/data/hosts-valid</div><div class=\"line\">/usr/share/denyhosts/data/users-hosts</div><div class=\"line\"></div><div class=\"line\"># 添加你想允许的主机IP地址到allowed-hosts:</div><div class=\"line\">sudo echo IP_addr &gt;&gt;/usr/share/denyhosts/data/allowed-hostsps</div><div class=\"line\"></div><div class=\"line\"># 启动 DenyHosts服务：</div><div class=\"line\"> service denyhosts start</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h5 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h5><ul>\n<li>尽量是用key验证登录服务器</li>\n<li>尽量从固定IP点登录服务器，然后将该地址加入白名单</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h5 id=\"查看当前服务器失败登录的统计：\"><a href=\"#查看当前服务器失败登录的统计：\" class=\"headerlink\" title=\"查看当前服务器失败登录的统计：\"></a>查看当前服务器失败登录的统计：</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cat /var/log/secure | awk &apos;/Failed/&#123;print $(NF-3)&#125;&apos; | sort | uniq -c | sort -n |  awk &apos;&#123;print $2&quot; = &quot;$1&#125;&apos;</div></pre></td></tr></table></figure>\n<h5 id=\"Install-denyhosts\"><a href=\"#Install-denyhosts\" class=\"headerlink\" title=\"Install denyhosts\"></a>Install denyhosts</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 需要预先安装epel源</div><div class=\"line\">sudo yum install -y epel-release</div><div class=\"line\">sudo yum install -y denyhosts</div></pre></td></tr></table></figure>\n<h5 id=\"配置文件解析\"><a href=\"#配置文件解析\" class=\"headerlink\" title=\"配置文件解析\"></a>配置文件解析</h5><p>默认配置文件/etc/denyhosts。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 查看的sshd日志文件</div><div class=\"line\">SECURE_LOG = /var/log/secure</div><div class=\"line\"></div><div class=\"line\"># 将阻止IP写入的配置文件</div><div class=\"line\">HOSTS_DENY = /etc/hosts.deny</div><div class=\"line\"></div><div class=\"line\"># 过多久之后清除，其中w代表周，d代表天，h代表小时，s代表秒，m代表分钟。</div><div class=\"line\">PURGE_DENY = 4h</div><div class=\"line\"></div><div class=\"line\"># 阻止的服务名称</div><div class=\"line\">BLOCK_SERVICE  = sshd</div><div class=\"line\"></div><div class=\"line\"># 允许无效用户（在/etc/passwd未列出）登录失败次数,允许无效用户登录失败的次数.</div><div class=\"line\">DENY_THRESHOLD_INVALID = 1</div><div class=\"line\"></div><div class=\"line\"># 允许普通用户登录失败的次数</div><div class=\"line\">DENY_THRESHOLD_VALID = 5</div><div class=\"line\"></div><div class=\"line\"># 允许root登录失败的次数</div><div class=\"line\">DENY_THRESHOLD_ROOT = 2</div><div class=\"line\">DENY_THRESHOLD_RESTRICTED = 1</div><div class=\"line\"></div><div class=\"line\"># 设定 deny host 写入到该资料夹</div><div class=\"line\">WORK_DIR = /var/lib/denyhosts</div><div class=\"line\"></div><div class=\"line\"># 将deny的host或ip纪录到Work_dir中</div><div class=\"line\">SUSPICIOUS_LOGIN_REPORT_ALLOWED_HOSTS=YES</div><div class=\"line\"></div><div class=\"line\"># 是否做域名反解</div><div class=\"line\">HOSTNAME_LOOKUP=YES</div><div class=\"line\"></div><div class=\"line\"># 将DenyHOts启动的pid纪录到LOCK_FILE中，已确保服务正确启动，防止同时启动多个服务。</div><div class=\"line\">LOCK_FILE = /var/lock/subsys/denyhosts</div><div class=\"line\"></div><div class=\"line\"># 设置管理员邮件地址</div><div class=\"line\">ADMIN_EMAIL = luchuanjia@msn.com</div><div class=\"line\">SMTP_HOST = localhost</div><div class=\"line\">SMTP_PORT = 25</div><div class=\"line\">SMTP_FROM = DenyHosts &lt;nobody@localhost&gt;</div><div class=\"line\">SMTP_SUBJECT = DenyHosts Report from $[HOSTNAME]</div><div class=\"line\"></div><div class=\"line\"># 有效用户登录失败计数归零的时间</div><div class=\"line\">AGE_RESET_VALID=1d</div><div class=\"line\"></div><div class=\"line\"># root用户登录失败计数归零的时间</div><div class=\"line\">AGE_RESET_ROOT=25d</div><div class=\"line\"></div><div class=\"line\"># 用户的失败登录计数重置为0的时间(/usr/share/denyhosts/data/restricted-usernames)</div><div class=\"line\">AGE_RESET_RESTRICTED=25d</div><div class=\"line\"></div><div class=\"line\"># 无效用户登录失败计数归零的时间</div><div class=\"line\">AGE_RESET_INVALID=10d</div><div class=\"line\"></div><div class=\"line\"># denyhosts的日志文件位置</div><div class=\"line\">DAEMON_LOG = /var/log/denyhosts</div><div class=\"line\"></div><div class=\"line\"># denyhosts的轮询时间</div><div class=\"line\">DAEMON_SLEEP = 30s</div><div class=\"line\"></div><div class=\"line\"># 该项与PURGE_DENY 设置一样，也是清除hosts.deny中 ssh用户的时间</div><div class=\"line\">DAEMON_PURGE = 1h</div></pre></td></tr></table></figure></p>\n<h5 id=\"FAQ\"><a href=\"#FAQ\" class=\"headerlink\" title=\"FAQ\"></a>FAQ</h5><ol>\n<li>如果想删除一个已经禁止的主机IP，并加入到允许主机例表，只在 /etc/hosts.deny 删除是没用的,还需要以下：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">/var/lib/denyhosts 目录，进入以下操作：</div><div class=\"line\"># 停止denyhosts服务</div><div class=\"line\">sudo service denyhosts stop</div><div class=\"line\"></div><div class=\"line\"># 进入denyhosts的目录</div><div class=\"line\">cd /var/lib/denyhosts</div><div class=\"line\"></div><div class=\"line\"># 查看哪些文件添加了ssh限制,将IP_addr替换成你的IP</div><div class=\"line\">sudo grep IP_addr /usr/share/denyhosts/data/*</div><div class=\"line\"></div><div class=\"line\"># 然后一个个删除文件中你想取消的主机IP所在的行:</div><div class=\"line\">/usr/share/denyhosts/data/hosts</div><div class=\"line\">/usr/share/denyhosts/data/hosts-restricted</div><div class=\"line\">/usr/share/denyhosts/data/hosts-root</div><div class=\"line\">/usr/share/denyhosts/data/hosts-valid</div><div class=\"line\">/usr/share/denyhosts/data/users-hosts</div><div class=\"line\"></div><div class=\"line\"># 添加你想允许的主机IP地址到allowed-hosts:</div><div class=\"line\">sudo echo IP_addr &gt;&gt;/usr/share/denyhosts/data/allowed-hostsps</div><div class=\"line\"></div><div class=\"line\"># 启动 DenyHosts服务：</div><div class=\"line\"> service denyhosts start</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h5 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h5><ul>\n<li>尽量是用key验证登录服务器</li>\n<li>尽量从固定IP点登录服务器，然后将该地址加入白名单</li>\n</ul>\n"},{"title":"Docker Hub 国内加速","id":"129","updated":"2017-04-21T05:17:31.000Z","date":"2017-01-07T07:32:23.000Z","_content":"\n因为Docker Hub没有在国内部署站点或者增加了国内的CDN，这导致国内的开发者在使用docker pull 获取images的时候速度非常的慢，甚至于因为网络的原因会失败。\n\n但是Docker Hub有着非常丰富的镜像资源，所以我这一直是个问题困扰着我，一次偶然机会发现了[DaoCloud](https://www.daocloud.io)提供了国内镜像加速服务，并且提供的Docker Hub Mirror详细的文档。\n\n#### 1. 注册DaoCloud账号\n首先，你需要到一DaoCloud账号，注册很方便，点击地址：[signup](https://account.daocloud.io/signup)\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/o6wh3.jpg)\n\n#### 2. 登录到你的DaoCloud账号内，然后入下图操作\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/n9mt7.jpg)\n\n#### 3. 查看你的DaoCloud加速器地址\n[链接](https://www.daocloud.io/mirror#accelerator-doc)\n\n选择你相对应平台的的加速器设置\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/4wuea.jpg)\n","source":"_posts/Docker-Hub-国内加速.md","raw":"---\ntitle: Docker Hub 国内加速\ntags: 'Docker'\ncategories: 'Docker'\npermalink: docker-hub-guo-nei-jia-su\nid: 129\nupdated: '2017-04-21 13:17:31'\ndate: 2017-01-07 15:32:23\n---\n\n因为Docker Hub没有在国内部署站点或者增加了国内的CDN，这导致国内的开发者在使用docker pull 获取images的时候速度非常的慢，甚至于因为网络的原因会失败。\n\n但是Docker Hub有着非常丰富的镜像资源，所以我这一直是个问题困扰着我，一次偶然机会发现了[DaoCloud](https://www.daocloud.io)提供了国内镜像加速服务，并且提供的Docker Hub Mirror详细的文档。\n\n#### 1. 注册DaoCloud账号\n首先，你需要到一DaoCloud账号，注册很方便，点击地址：[signup](https://account.daocloud.io/signup)\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/o6wh3.jpg)\n\n#### 2. 登录到你的DaoCloud账号内，然后入下图操作\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/n9mt7.jpg)\n\n#### 3. 查看你的DaoCloud加速器地址\n[链接](https://www.daocloud.io/mirror#accelerator-doc)\n\n选择你相对应平台的的加速器设置\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/4wuea.jpg)\n","slug":"docker-hub-guo-nei-jia-su","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq6c000p41tposkfrl02","content":"<p>因为Docker Hub没有在国内部署站点或者增加了国内的CDN，这导致国内的开发者在使用docker pull 获取images的时候速度非常的慢，甚至于因为网络的原因会失败。</p>\n<p>但是Docker Hub有着非常丰富的镜像资源，所以我这一直是个问题困扰着我，一次偶然机会发现了<a href=\"https://www.daocloud.io\" target=\"_blank\" rel=\"external\">DaoCloud</a>提供了国内镜像加速服务，并且提供的Docker Hub Mirror详细的文档。</p>\n<h4 id=\"1-注册DaoCloud账号\"><a href=\"#1-注册DaoCloud账号\" class=\"headerlink\" title=\"1. 注册DaoCloud账号\"></a>1. 注册DaoCloud账号</h4><p>首先，你需要到一DaoCloud账号，注册很方便，点击地址：<a href=\"https://account.daocloud.io/signup\" target=\"_blank\" rel=\"external\">signup</a><br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/o6wh3.jpg\" alt=\"\"></p>\n<h4 id=\"2-登录到你的DaoCloud账号内，然后入下图操作\"><a href=\"#2-登录到你的DaoCloud账号内，然后入下图操作\" class=\"headerlink\" title=\"2. 登录到你的DaoCloud账号内，然后入下图操作\"></a>2. 登录到你的DaoCloud账号内，然后入下图操作</h4><p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/n9mt7.jpg\" alt=\"\"></p>\n<h4 id=\"3-查看你的DaoCloud加速器地址\"><a href=\"#3-查看你的DaoCloud加速器地址\" class=\"headerlink\" title=\"3. 查看你的DaoCloud加速器地址\"></a>3. 查看你的DaoCloud加速器地址</h4><p><a href=\"https://www.daocloud.io/mirror#accelerator-doc\" target=\"_blank\" rel=\"external\">链接</a></p>\n<p>选择你相对应平台的的加速器设置<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/4wuea.jpg\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>因为Docker Hub没有在国内部署站点或者增加了国内的CDN，这导致国内的开发者在使用docker pull 获取images的时候速度非常的慢，甚至于因为网络的原因会失败。</p>\n<p>但是Docker Hub有着非常丰富的镜像资源，所以我这一直是个问题困扰着我，一次偶然机会发现了<a href=\"https://www.daocloud.io\">DaoCloud</a>提供了国内镜像加速服务，并且提供的Docker Hub Mirror详细的文档。</p>\n<h4 id=\"1-注册DaoCloud账号\"><a href=\"#1-注册DaoCloud账号\" class=\"headerlink\" title=\"1. 注册DaoCloud账号\"></a>1. 注册DaoCloud账号</h4><p>首先，你需要到一DaoCloud账号，注册很方便，点击地址：<a href=\"https://account.daocloud.io/signup\">signup</a><br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/o6wh3.jpg\" alt=\"\"></p>\n<h4 id=\"2-登录到你的DaoCloud账号内，然后入下图操作\"><a href=\"#2-登录到你的DaoCloud账号内，然后入下图操作\" class=\"headerlink\" title=\"2. 登录到你的DaoCloud账号内，然后入下图操作\"></a>2. 登录到你的DaoCloud账号内，然后入下图操作</h4><p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/n9mt7.jpg\" alt=\"\"></p>\n<h4 id=\"3-查看你的DaoCloud加速器地址\"><a href=\"#3-查看你的DaoCloud加速器地址\" class=\"headerlink\" title=\"3. 查看你的DaoCloud加速器地址\"></a>3. 查看你的DaoCloud加速器地址</h4><p><a href=\"https://www.daocloud.io/mirror#accelerator-doc\">链接</a></p>\n<p>选择你相对应平台的的加速器设置<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/4wuea.jpg\" alt=\"\"></p>\n"},{"title":"Ghost(2) 增加评论模块","id":"114","updated":"2017-04-21T05:20:04.000Z","date":"2016-11-18T04:09:13.000Z","_content":"\n<p>Ghost作为一个更加纯粹的博客平台，并没有打算为其开发内置的文章评论功能。而是将评论功能托管给第三方，好处也是让用户更有精力集中于网站内容的建设。实现的办法也很简单，只需要向Ghost主题的模板Handlebars(.hbs)插入第三方评论组件的JavaScript代码来为Ghost博客增加评论功能。 </p>\n<p><em>国内最常用的多说评论框，支持国内常见的社交网络一键注册登录、盖楼讨论和分享而且对新用户上手简单。而Disqus功能强大、完善的社交网络和多国语言支持并且为其插件启用全球CDN加速。总的来说两个插件各有所长。</em></p>\n<p>基于默认主题Casper的安装指南：</p>\n<ul>\n<li><a href=\"index.html#comments.hbs\">创建一个模板</a></li>\n<li><a href=\"index.html#Duoshuo\">安装多说评论系统</a></li>\n<li><a href=\"index.html#Disqus\">安装Disqus</a></li>\n</ul>\n<hr>\n<h4 id=\"comments.hbs\">创建一个模板</h4>\n<p>为了在需要评论框代码的时候方便引用，我选择事先在主题文件夹<code>content\\themes\\casper\\partials</code>下面创建一个叫做<strong>comments.hbs</strong>的模板文件，也就是评论框的专属模板。</p>\n<p>现在我只需要在我的Casper主题下面的post.hbs模板中的</p>\n<pre><code>            &lt;/section&gt;\n\n        &lt;/footer&gt;\n    &lt;/article&gt;\n&lt;/main&gt;\n</code></pre>\n<p>前面部分添加一句<code>{{&gt; comments}}</code>就可以展示评论框了。</p>\n<p>添加后就像这样：</p>\n<pre><code>            &lt;/section&gt;\n            {{&gt; comments}}\n        &lt;/footer&gt;\n    &lt;/article&gt;\n&lt;/main&gt;\n</code></pre>\n<p>这样以来的好处就可以在任何主题中轻松移植评论框代码。</p>\n<p>开始之前：对评论框Html代码进行简要说明。</p>\n<ul>\n<li><code>&lt;section class=\"post-comments\"&gt;...&lt;/section&gt;</code>用于展示评论框</li>\n<li><code>&lt;script type=\"text/javascript\"&gt;...&lt;/script&gt;</code>评论框公共代码</li>\n<li><code>{{slug}}</code> 引用文章短名作为第三方社交平台识别文章的特征标志</li>\n<li><code>{{title}}</code> 引用文章标题</li>\n<li><code>{{url absolute=\"true\"}}</code> 获取永久链接</li>\n</ul>\n<hr>\n<h4 id=\"Duoshuo\">安装多说评论框</h4>\n<p>1.将下面的评论框代码插入<strong>comments.hbs</strong>文件。 <br>\n多说评论框：</p>\n<pre><code>&lt;section class=\"post-comments\"&gt;\n    &lt;div class=\"ds-thread\" data-thread-key=\"{{slug}}\" data-title=\"{{title}}\" data-url=\"{{url absolute=\"true\"}}\"&gt;&lt;/div&gt;\n    &lt;!-- 务必插入多说公共JS代码 --&gt;\n&lt;/section&gt;\n</code></pre>\n<p>2.如何获取多说公共JS代码？</p>\n<p>登录多说 &gt; 点击“我要安装”&gt; 创建站点 &gt; 获取公共代码（如图）</p>\n<p><img src=\"https://www.binarization.com/content/images/2015/02/duoshuo-javascript.PNG\" alt=\"多说公共JS代码\"></p>\n<hr>\n<h4 id=\"Disqus\">安装Disqus评论框</h4>\n<p>1.将下面的评论框代码插入<strong>comments.hbs</strong>文件。 <br>\nDisqus评论框评论框：</p>\n<pre><code>  &lt;section class=\"post-comments\"&gt;&lt;div id=\"disqus_thread\"&gt;&lt;/div&gt;\n      &lt;!-- 务必插入Disqus公共JS代码 --&gt;\n  &lt;/section&gt;\n</code></pre>\n<p>2.获取Disqus的公共JS代码</p>\n<p>注册Disqus &gt; 安装平台选则 Universal Code &gt; 直接复制代码</p>\n<p>3.添加完毕后，重新启动Ghost博客。</p>\n<p>4.Disqus不能成功加载的时候可以在JavaScript中强制使用HTTPS以链接Disqus服务器。具体方法就是在<code>s.src</code>的提供的URL中加入<code>https://</code>。 </p>\n","source":"_posts/Ghost-2-增加评论模块.md","raw":"---\ntitle: Ghost(2) 增加评论模块\ntags: 'Ghost'\ncategories: 'Ghost'\npermalink: ghostzeng-jia-ping-lun-mo-kuai\nid: 114\nupdated: '2017-04-21 13:20:04'\ndate: 2016-11-18 12:09:13\n---\n\n<p>Ghost作为一个更加纯粹的博客平台，并没有打算为其开发内置的文章评论功能。而是将评论功能托管给第三方，好处也是让用户更有精力集中于网站内容的建设。实现的办法也很简单，只需要向Ghost主题的模板Handlebars(.hbs)插入第三方评论组件的JavaScript代码来为Ghost博客增加评论功能。 </p>\n<p><em>国内最常用的多说评论框，支持国内常见的社交网络一键注册登录、盖楼讨论和分享而且对新用户上手简单。而Disqus功能强大、完善的社交网络和多国语言支持并且为其插件启用全球CDN加速。总的来说两个插件各有所长。</em></p>\n<p>基于默认主题Casper的安装指南：</p>\n<ul>\n<li><a href=\"index.html#comments.hbs\">创建一个模板</a></li>\n<li><a href=\"index.html#Duoshuo\">安装多说评论系统</a></li>\n<li><a href=\"index.html#Disqus\">安装Disqus</a></li>\n</ul>\n<hr>\n<h4 id=\"comments.hbs\">创建一个模板</h4>\n<p>为了在需要评论框代码的时候方便引用，我选择事先在主题文件夹<code>content\\themes\\casper\\partials</code>下面创建一个叫做<strong>comments.hbs</strong>的模板文件，也就是评论框的专属模板。</p>\n<p>现在我只需要在我的Casper主题下面的post.hbs模板中的</p>\n<pre><code>            &lt;/section&gt;\n\n        &lt;/footer&gt;\n    &lt;/article&gt;\n&lt;/main&gt;\n</code></pre>\n<p>前面部分添加一句<code>{{&gt; comments}}</code>就可以展示评论框了。</p>\n<p>添加后就像这样：</p>\n<pre><code>            &lt;/section&gt;\n            {{&gt; comments}}\n        &lt;/footer&gt;\n    &lt;/article&gt;\n&lt;/main&gt;\n</code></pre>\n<p>这样以来的好处就可以在任何主题中轻松移植评论框代码。</p>\n<p>开始之前：对评论框Html代码进行简要说明。</p>\n<ul>\n<li><code>&lt;section class=\"post-comments\"&gt;...&lt;/section&gt;</code>用于展示评论框</li>\n<li><code>&lt;script type=\"text/javascript\"&gt;...&lt;/script&gt;</code>评论框公共代码</li>\n<li><code>{{slug}}</code> 引用文章短名作为第三方社交平台识别文章的特征标志</li>\n<li><code>{{title}}</code> 引用文章标题</li>\n<li><code>{{url absolute=\"true\"}}</code> 获取永久链接</li>\n</ul>\n<hr>\n<h4 id=\"Duoshuo\">安装多说评论框</h4>\n<p>1.将下面的评论框代码插入<strong>comments.hbs</strong>文件。 <br>\n多说评论框：</p>\n<pre><code>&lt;section class=\"post-comments\"&gt;\n    &lt;div class=\"ds-thread\" data-thread-key=\"{{slug}}\" data-title=\"{{title}}\" data-url=\"{{url absolute=\"true\"}}\"&gt;&lt;/div&gt;\n    &lt;!-- 务必插入多说公共JS代码 --&gt;\n&lt;/section&gt;\n</code></pre>\n<p>2.如何获取多说公共JS代码？</p>\n<p>登录多说 &gt; 点击“我要安装”&gt; 创建站点 &gt; 获取公共代码（如图）</p>\n<p><img src=\"https://www.binarization.com/content/images/2015/02/duoshuo-javascript.PNG\" alt=\"多说公共JS代码\"></p>\n<hr>\n<h4 id=\"Disqus\">安装Disqus评论框</h4>\n<p>1.将下面的评论框代码插入<strong>comments.hbs</strong>文件。 <br>\nDisqus评论框评论框：</p>\n<pre><code>  &lt;section class=\"post-comments\"&gt;&lt;div id=\"disqus_thread\"&gt;&lt;/div&gt;\n      &lt;!-- 务必插入Disqus公共JS代码 --&gt;\n  &lt;/section&gt;\n</code></pre>\n<p>2.获取Disqus的公共JS代码</p>\n<p>注册Disqus &gt; 安装平台选则 Universal Code &gt; 直接复制代码</p>\n<p>3.添加完毕后，重新启动Ghost博客。</p>\n<p>4.Disqus不能成功加载的时候可以在JavaScript中强制使用HTTPS以链接Disqus服务器。具体方法就是在<code>s.src</code>的提供的URL中加入<code>https://</code>。 </p>\n","slug":"ghostzeng-jia-ping-lun-mo-kuai","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq6g000t41tp3es8xczr","content":"<p>Ghost作为一个更加纯粹的博客平台，并没有打算为其开发内置的文章评论功能。而是将评论功能托管给第三方，好处也是让用户更有精力集中于网站内容的建设。实现的办法也很简单，只需要向Ghost主题的模板Handlebars(.hbs)插入第三方评论组件的JavaScript代码来为Ghost博客增加评论功能。 </p><br><p><em>国内最常用的多说评论框，支持国内常见的社交网络一键注册登录、盖楼讨论和分享而且对新用户上手简单。而Disqus功能强大、完善的社交网络和多国语言支持并且为其插件启用全球CDN加速。总的来说两个插件各有所长。</em></p><br><p>基于默认主题Casper的安装指南：</p><br><ul><br><li><a href=\"index.html#comments.hbs\">创建一个模板</a></li><br><li><a href=\"index.html#Duoshuo\">安装多说评论系统</a></li><br><li><a href=\"index.html#Disqus\">安装Disqus</a></li><br></ul><br><hr><br><h4 id=\"comments.hbs\">创建一个模板</h4><br><p>为了在需要评论框代码的时候方便引用，我选择事先在主题文件夹<code>content\\themes\\casper\\partials</code>下面创建一个叫做<strong>comments.hbs</strong>的模板文件，也就是评论框的专属模板。</p><br><p>现在我只需要在我的Casper主题下面的post.hbs模板中的</p><br><pre><code>            &lt;/section&gt;<br><br>        &lt;/footer&gt;<br>    &lt;/article&gt;<br>&lt;/main&gt;<br></code></pre><br><p>前面部分添加一句<code>{{&gt; comments}}</code>就可以展示评论框了。</p><br><p>添加后就像这样：</p><br><pre><code>            &lt;/section&gt;<br>            {{&gt; comments}}<br>        &lt;/footer&gt;<br>    &lt;/article&gt;<br>&lt;/main&gt;<br></code></pre><br><p>这样以来的好处就可以在任何主题中轻松移植评论框代码。</p><br><p>开始之前：对评论框Html代码进行简要说明。</p><br><ul><br><li><code>&lt;section class=”post-comments”&gt;…&lt;/section&gt;</code>用于展示评论框</li><br><li><code>&lt;script type=”text/javascript”&gt;…&lt;/script&gt;</code>评论框公共代码</li><br><li><code>{{slug}}</code> 引用文章短名作为第三方社交平台识别文章的特征标志</li><br><li><code>{{title}}</code> 引用文章标题</li><br><li><code>{{url absolute=\"true\"}}</code> 获取永久链接</li><br></ul><br><hr><br><h4 id=\"Duoshuo\">安装多说评论框</h4><br><p>1.将下面的评论框代码插入<strong>comments.hbs</strong>文件。 <br><br>多说评论框：</p><br><pre><code>&lt;section class=”post-comments”&gt;<br>    &lt;div class=”ds-thread” data-thread-key=”{{slug}}“ data-title=”{{title}}“ data-url=”{{url absolute=\"true\"}}“&gt;&lt;/div&gt;<br>    &lt;!– 务必插入多说公共JS代码 –&gt;<br>&lt;/section&gt;<br></code></pre><br><p>2.如何获取多说公共JS代码？</p><br><p>登录多说 &gt; 点击“我要安装”&gt; 创建站点 &gt; 获取公共代码（如图）</p><br><p><img src=\"https://www.binarization.com/content/images/2015/02/duoshuo-javascript.PNG\" alt=\"多说公共JS代码\"></p><br><hr><br><h4 id=\"Disqus\">安装Disqus评论框</h4><br><p>1.将下面的评论框代码插入<strong>comments.hbs</strong>文件。 <br><br>Disqus评论框评论框：</p><br><pre><code>  &lt;section class=”post-comments”&gt;&lt;div id=”disqus_thread”&gt;&lt;/div&gt;<br>      &lt;!– 务必插入Disqus公共JS代码 –&gt;<br>  &lt;/section&gt;<br></code></pre><br><p>2.获取Disqus的公共JS代码</p><br><p>注册Disqus &gt; 安装平台选则 Universal Code &gt; 直接复制代码</p><br><p>3.添加完毕后，重新启动Ghost博客。</p><br><p>4.Disqus不能成功加载的时候可以在JavaScript中强制使用HTTPS以链接Disqus服务器。具体方法就是在<code>s.src</code>的提供的URL中加入<code>https://</code>。 </p>\n","site":{"data":{}},"excerpt":"","more":"<p>Ghost作为一个更加纯粹的博客平台，并没有打算为其开发内置的文章评论功能。而是将评论功能托管给第三方，好处也是让用户更有精力集中于网站内容的建设。实现的办法也很简单，只需要向Ghost主题的模板Handlebars(.hbs)插入第三方评论组件的JavaScript代码来为Ghost博客增加评论功能。 </p><br><p><em>国内最常用的多说评论框，支持国内常见的社交网络一键注册登录、盖楼讨论和分享而且对新用户上手简单。而Disqus功能强大、完善的社交网络和多国语言支持并且为其插件启用全球CDN加速。总的来说两个插件各有所长。</em></p><br><p>基于默认主题Casper的安装指南：</p><br><ul><br><li><a href=\"index.html#comments.hbs\">创建一个模板</a></li><br><li><a href=\"index.html#Duoshuo\">安装多说评论系统</a></li><br><li><a href=\"index.html#Disqus\">安装Disqus</a></li><br></ul><br><hr><br><h4 id=\"comments.hbs\">创建一个模板</h4><br><p>为了在需要评论框代码的时候方便引用，我选择事先在主题文件夹<code>content\\themes\\casper\\partials</code>下面创建一个叫做<strong>comments.hbs</strong>的模板文件，也就是评论框的专属模板。</p><br><p>现在我只需要在我的Casper主题下面的post.hbs模板中的</p><br><pre><code>            &lt;/section&gt;<br><br>        &lt;/footer&gt;<br>    &lt;/article&gt;<br>&lt;/main&gt;<br></code></pre><br><p>前面部分添加一句<code>{{&gt; comments}}</code>就可以展示评论框了。</p><br><p>添加后就像这样：</p><br><pre><code>            &lt;/section&gt;<br>            {{&gt; comments}}<br>        &lt;/footer&gt;<br>    &lt;/article&gt;<br>&lt;/main&gt;<br></code></pre><br><p>这样以来的好处就可以在任何主题中轻松移植评论框代码。</p><br><p>开始之前：对评论框Html代码进行简要说明。</p><br><ul><br><li><code>&lt;section class=”post-comments”&gt;…&lt;/section&gt;</code>用于展示评论框</li><br><li><code>&lt;script type=”text/javascript”&gt;…&lt;/script&gt;</code>评论框公共代码</li><br><li><code>{{slug}}</code> 引用文章短名作为第三方社交平台识别文章的特征标志</li><br><li><code>{{title}}</code> 引用文章标题</li><br><li><code>{{url absolute=\"true\"}}</code> 获取永久链接</li><br></ul><br><hr><br><h4 id=\"Duoshuo\">安装多说评论框</h4><br><p>1.将下面的评论框代码插入<strong>comments.hbs</strong>文件。 <br><br>多说评论框：</p><br><pre><code>&lt;section class=”post-comments”&gt;<br>    &lt;div class=”ds-thread” data-thread-key=”{{slug}}“ data-title=”{{title}}“ data-url=”{{url absolute=\"true\"}}“&gt;&lt;/div&gt;<br>    &lt;!– 务必插入多说公共JS代码 –&gt;<br>&lt;/section&gt;<br></code></pre><br><p>2.如何获取多说公共JS代码？</p><br><p>登录多说 &gt; 点击“我要安装”&gt; 创建站点 &gt; 获取公共代码（如图）</p><br><p><img src=\"https://www.binarization.com/content/images/2015/02/duoshuo-javascript.PNG\" alt=\"多说公共JS代码\"></p><br><hr><br><h4 id=\"Disqus\">安装Disqus评论框</h4><br><p>1.将下面的评论框代码插入<strong>comments.hbs</strong>文件。 <br><br>Disqus评论框评论框：</p><br><pre><code>  &lt;section class=”post-comments”&gt;&lt;div id=”disqus_thread”&gt;&lt;/div&gt;<br>      &lt;!– 务必插入Disqus公共JS代码 –&gt;<br>  &lt;/section&gt;<br></code></pre><br><p>2.获取Disqus的公共JS代码</p><br><p>注册Disqus &gt; 安装平台选则 Universal Code &gt; 直接复制代码</p><br><p>3.添加完毕后，重新启动Ghost博客。</p><br><p>4.Disqus不能成功加载的时候可以在JavaScript中强制使用HTTPS以链接Disqus服务器。具体方法就是在<code>s.src</code>的提供的URL中加入<code>https://</code>。 </p>\n"},{"title":"Hello 2016","id":"10022","date":"2015-12-31T16:34:54.000Z","_content":"\n\n我今年24岁了，没什么特别的，就是人生一步一步走来，到了现在，其实我真是有点急躁了；做IT的时间不短了，但是直到如今也并没有一个好的发展，前途并不明朗，我曾经一度怀疑自己的坚持是否正确，像很多人一样，从充满了理想抱负和耀眼的光芒，而随着时间的推移一步一步走向平淡，我相信绝大多数的生命轨迹都是如此，无可避免地成为一个平庸的人，这世界上最后牛逼的人总是很少一部分，他们是我们孩童时期的标杆，要迎头赶上或是超越，我们要做的就是快点长大，等待着接替他们掌管整个世界；可是随着时间的推移，我们逐渐发现了现实与乌托邦的差距，没法让别人觉得你很牛逼，我们只能在父母面前牛逼，开始收起所有的棱角锋芒，如履薄冰的在社会行走，或许大多数人忘记了当时的梦想，或许开始希望日子过的慢一点，不为新年的到来而欢呼雀跃，或许，我到了这样的年纪。\n\n很多人也包括我都觉得24岁来讲理想是很不现实的事情，身边的朋友有些已经组建家庭承担起一个大家长的责任，有些则事业有成，还有一些如我一般碌碌无为者居多；我相信有一部分人像我一样羡慕婚姻带来的幸福而又惶恐承担相应的责任，嫉妒他人事业有成而又不肯努力，到了这个光景，接受自己是一个普通人Loser是一个挺不好受的事情，意味着有大把的事情让我们感到苍白无力，像离你而去的人，达不成的事，这足以令我们感到无比可怖，而其实我们所恐惧的就是恐惧本身，接受现实，毕竟都那么大了。\n\n愈近岁末愈是多思考，渐渐少了许多玩耍的心思，历年也都会写点这样的文字，总结过去的经历，也对新的一年，有些期许；比之往年，多了些成熟稳重，也摆脱了上半年初糟糕的心思，经历了一段不好的时期，努力调整，随后也进入一个平稳的发展状态，规划自己的职业发展，耐心努力地去做，效果不错，给2015年一个总结：目标完成。有个很不错的公司和可爱的同事，做着自己喜欢的事，也有了方向和目标，虽然经常懒癌发作导致不能按计划达成，总体上来说对自己现状还是比较满意，可能唯一不满意的就是自己的不够努力了啊。\n\n2016年，新的一年，总归要有些心得期许，希望家人身体健康，自己保持心态的稳定，工作上能有平稳发展，达成自己定下的目标，总之许下天马行空的愿望，不如自己努力来的好。\n\n我怀念逝去的亲人，即便是过去两年了，我仍然无法释怀，这个是我生命中最重要的人，也给予了我难能可贵的品质，是她的陪伴让我勇敢的面对生活，时至今日，我也时常会思念她，继而让我审视自身的作为，也正是如此不断鞭策我前进，不敢有丝毫怠慢自己的人生，我相信有天国的存在，也希望她感受到我的思念和努力，能为我的努力而欣慰。\n","source":"_posts/Hello-2016.md","raw":"---\ntitle: Hello 2016\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: hello-2016\nid: 10022\ndate: 2016-01-01 00:34:54\n---\n\n\n我今年24岁了，没什么特别的，就是人生一步一步走来，到了现在，其实我真是有点急躁了；做IT的时间不短了，但是直到如今也并没有一个好的发展，前途并不明朗，我曾经一度怀疑自己的坚持是否正确，像很多人一样，从充满了理想抱负和耀眼的光芒，而随着时间的推移一步一步走向平淡，我相信绝大多数的生命轨迹都是如此，无可避免地成为一个平庸的人，这世界上最后牛逼的人总是很少一部分，他们是我们孩童时期的标杆，要迎头赶上或是超越，我们要做的就是快点长大，等待着接替他们掌管整个世界；可是随着时间的推移，我们逐渐发现了现实与乌托邦的差距，没法让别人觉得你很牛逼，我们只能在父母面前牛逼，开始收起所有的棱角锋芒，如履薄冰的在社会行走，或许大多数人忘记了当时的梦想，或许开始希望日子过的慢一点，不为新年的到来而欢呼雀跃，或许，我到了这样的年纪。\n\n很多人也包括我都觉得24岁来讲理想是很不现实的事情，身边的朋友有些已经组建家庭承担起一个大家长的责任，有些则事业有成，还有一些如我一般碌碌无为者居多；我相信有一部分人像我一样羡慕婚姻带来的幸福而又惶恐承担相应的责任，嫉妒他人事业有成而又不肯努力，到了这个光景，接受自己是一个普通人Loser是一个挺不好受的事情，意味着有大把的事情让我们感到苍白无力，像离你而去的人，达不成的事，这足以令我们感到无比可怖，而其实我们所恐惧的就是恐惧本身，接受现实，毕竟都那么大了。\n\n愈近岁末愈是多思考，渐渐少了许多玩耍的心思，历年也都会写点这样的文字，总结过去的经历，也对新的一年，有些期许；比之往年，多了些成熟稳重，也摆脱了上半年初糟糕的心思，经历了一段不好的时期，努力调整，随后也进入一个平稳的发展状态，规划自己的职业发展，耐心努力地去做，效果不错，给2015年一个总结：目标完成。有个很不错的公司和可爱的同事，做着自己喜欢的事，也有了方向和目标，虽然经常懒癌发作导致不能按计划达成，总体上来说对自己现状还是比较满意，可能唯一不满意的就是自己的不够努力了啊。\n\n2016年，新的一年，总归要有些心得期许，希望家人身体健康，自己保持心态的稳定，工作上能有平稳发展，达成自己定下的目标，总之许下天马行空的愿望，不如自己努力来的好。\n\n我怀念逝去的亲人，即便是过去两年了，我仍然无法释怀，这个是我生命中最重要的人，也给予了我难能可贵的品质，是她的陪伴让我勇敢的面对生活，时至今日，我也时常会思念她，继而让我审视自身的作为，也正是如此不断鞭策我前进，不敢有丝毫怠慢自己的人生，我相信有天国的存在，也希望她感受到我的思念和努力，能为我的努力而欣慰。\n","slug":"hello-2016","published":1,"updated":"2017-04-24T14:32:22.571Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq6i000v41tp37oj9v5n","content":"<p>我今年24岁了，没什么特别的，就是人生一步一步走来，到了现在，其实我真是有点急躁了；做IT的时间不短了，但是直到如今也并没有一个好的发展，前途并不明朗，我曾经一度怀疑自己的坚持是否正确，像很多人一样，从充满了理想抱负和耀眼的光芒，而随着时间的推移一步一步走向平淡，我相信绝大多数的生命轨迹都是如此，无可避免地成为一个平庸的人，这世界上最后牛逼的人总是很少一部分，他们是我们孩童时期的标杆，要迎头赶上或是超越，我们要做的就是快点长大，等待着接替他们掌管整个世界；可是随着时间的推移，我们逐渐发现了现实与乌托邦的差距，没法让别人觉得你很牛逼，我们只能在父母面前牛逼，开始收起所有的棱角锋芒，如履薄冰的在社会行走，或许大多数人忘记了当时的梦想，或许开始希望日子过的慢一点，不为新年的到来而欢呼雀跃，或许，我到了这样的年纪。</p>\n<p>很多人也包括我都觉得24岁来讲理想是很不现实的事情，身边的朋友有些已经组建家庭承担起一个大家长的责任，有些则事业有成，还有一些如我一般碌碌无为者居多；我相信有一部分人像我一样羡慕婚姻带来的幸福而又惶恐承担相应的责任，嫉妒他人事业有成而又不肯努力，到了这个光景，接受自己是一个普通人Loser是一个挺不好受的事情，意味着有大把的事情让我们感到苍白无力，像离你而去的人，达不成的事，这足以令我们感到无比可怖，而其实我们所恐惧的就是恐惧本身，接受现实，毕竟都那么大了。</p>\n<p>愈近岁末愈是多思考，渐渐少了许多玩耍的心思，历年也都会写点这样的文字，总结过去的经历，也对新的一年，有些期许；比之往年，多了些成熟稳重，也摆脱了上半年初糟糕的心思，经历了一段不好的时期，努力调整，随后也进入一个平稳的发展状态，规划自己的职业发展，耐心努力地去做，效果不错，给2015年一个总结：目标完成。有个很不错的公司和可爱的同事，做着自己喜欢的事，也有了方向和目标，虽然经常懒癌发作导致不能按计划达成，总体上来说对自己现状还是比较满意，可能唯一不满意的就是自己的不够努力了啊。</p>\n<p>2016年，新的一年，总归要有些心得期许，希望家人身体健康，自己保持心态的稳定，工作上能有平稳发展，达成自己定下的目标，总之许下天马行空的愿望，不如自己努力来的好。</p>\n<p>我怀念逝去的亲人，即便是过去两年了，我仍然无法释怀，这个是我生命中最重要的人，也给予了我难能可贵的品质，是她的陪伴让我勇敢的面对生活，时至今日，我也时常会思念她，继而让我审视自身的作为，也正是如此不断鞭策我前进，不敢有丝毫怠慢自己的人生，我相信有天国的存在，也希望她感受到我的思念和努力，能为我的努力而欣慰。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>我今年24岁了，没什么特别的，就是人生一步一步走来，到了现在，其实我真是有点急躁了；做IT的时间不短了，但是直到如今也并没有一个好的发展，前途并不明朗，我曾经一度怀疑自己的坚持是否正确，像很多人一样，从充满了理想抱负和耀眼的光芒，而随着时间的推移一步一步走向平淡，我相信绝大多数的生命轨迹都是如此，无可避免地成为一个平庸的人，这世界上最后牛逼的人总是很少一部分，他们是我们孩童时期的标杆，要迎头赶上或是超越，我们要做的就是快点长大，等待着接替他们掌管整个世界；可是随着时间的推移，我们逐渐发现了现实与乌托邦的差距，没法让别人觉得你很牛逼，我们只能在父母面前牛逼，开始收起所有的棱角锋芒，如履薄冰的在社会行走，或许大多数人忘记了当时的梦想，或许开始希望日子过的慢一点，不为新年的到来而欢呼雀跃，或许，我到了这样的年纪。</p>\n<p>很多人也包括我都觉得24岁来讲理想是很不现实的事情，身边的朋友有些已经组建家庭承担起一个大家长的责任，有些则事业有成，还有一些如我一般碌碌无为者居多；我相信有一部分人像我一样羡慕婚姻带来的幸福而又惶恐承担相应的责任，嫉妒他人事业有成而又不肯努力，到了这个光景，接受自己是一个普通人Loser是一个挺不好受的事情，意味着有大把的事情让我们感到苍白无力，像离你而去的人，达不成的事，这足以令我们感到无比可怖，而其实我们所恐惧的就是恐惧本身，接受现实，毕竟都那么大了。</p>\n<p>愈近岁末愈是多思考，渐渐少了许多玩耍的心思，历年也都会写点这样的文字，总结过去的经历，也对新的一年，有些期许；比之往年，多了些成熟稳重，也摆脱了上半年初糟糕的心思，经历了一段不好的时期，努力调整，随后也进入一个平稳的发展状态，规划自己的职业发展，耐心努力地去做，效果不错，给2015年一个总结：目标完成。有个很不错的公司和可爱的同事，做着自己喜欢的事，也有了方向和目标，虽然经常懒癌发作导致不能按计划达成，总体上来说对自己现状还是比较满意，可能唯一不满意的就是自己的不够努力了啊。</p>\n<p>2016年，新的一年，总归要有些心得期许，希望家人身体健康，自己保持心态的稳定，工作上能有平稳发展，达成自己定下的目标，总之许下天马行空的愿望，不如自己努力来的好。</p>\n<p>我怀念逝去的亲人，即便是过去两年了，我仍然无法释怀，这个是我生命中最重要的人，也给予了我难能可贵的品质，是她的陪伴让我勇敢的面对生活，时至今日，我也时常会思念她，继而让我审视自身的作为，也正是如此不断鞭策我前进，不敢有丝毫怠慢自己的人生，我相信有天国的存在，也希望她感受到我的思念和努力，能为我的努力而欣慰。</p>\n"},{"title":"Hey Friends","id":"10023","date":"2016-07-22T16:34:54.000Z","_content":"\n\n吃一口饭，喝一杯水，夜晚抬头看星星与月亮，随手拍死一个蚊子；\n听一首歌，看一场电影，记录下来感动瞬间，分享到朋友圈；\n\n忘记了上顿饭吃了什么，忘记了一天要喝8杯水，抬头看不懂星星和月亮的美，第二天还能看到蚊子叮咬过的痕迹；\n\n喜欢的音乐、电影、书籍，感动了你自己，于沉浸中转身，想要分享却找不到合适的人；\n\n心中有万壑千山，笔下滴墨未浸；\n\n我要睡觉了，但是睡不着，希望你认真看完下面的话。\n\n以前看过一段话：不要成为一个无穷无尽的逗比，不要因害怕冷场而笑得最大声闹得最起劲，不要急于亲近而忘了拿捏矜持放低骄傲，不要因在真爱的人面前莫名自卑而准备了一箩筐段子随时逗TA开心为自己解围。喜欢的人等你足够优秀时一定能在一起，逗比没什么不好，但因为你给的嬉笑太盛，于是没有人再欣赏你的认真。\n\n我人蠢笨，做事犯傻，经常忘记东西，不够聪明，很多毛病和缺点，多到我自己都在厌烦自己，我做着不找边际的梦想，过着碌碌无为的人生，永远叫嚷着减肥却饮食不节制也不坚持运动，朋友不多，前半生的简单重复，没鼓起勇气做牛逼的事情，没读过多少书，上学时间经常换学校，没留下多少朋友，所以，我很珍惜现在所拥有的一切。\n\n我热爱生活，唯一能做的是认真努力对待每一天，我很感恩珍惜现在所拥有的一切，朋友，家人，平淡的生活，我总是想努力维持在一个好的状态，讨厌隔阂，却又拙于处理这些问题，我性格开朗，稀里糊涂，像个没长大的孩子，经常犯二犯傻令人扶额凝语。\n\n我不在意朋友自己之间善意的玩笑，不在意被说多少次人傻犯蠢，智商堪忧，腿短腰粗脸大翘屁股，不介意被说唱歌难听，不介意人丑还自恋，我觉得这并没什么，我也经常自嘲，也会被带入你的节奏哼唱“卖弄美色”；接触这几年，我相信你们也明白我的性格，我觉得友情很重要，朋友是可以互相损讽，朋友是在需要的时候温柔相待，我是个逗比，我不会因朋友玩笑不开心，我在意的是嬉笑背后尊重我的认真。\n\n我很尊重你，也很敬佩你，我非常珍惜我们的友谊，不希望有隔阂，这会让我辗转反侧无意入眠，也是我写下这些话的原因，你是个非常优秀的姑娘，你的坦荡潇洒，另我自愧弗如，你身上有着许多耀眼的闪光点，与你为友是我的荣幸；我在做人说话方面得罪过不少人，以至如今我父母仍旧时常提醒我，但大多数仍是无心之举，我不喜欢狡辩，因我之过错越过你的底线，对不起，我很认真的道歉，以后会注意，昨夜的“不识相”实非有意说的，至于你之后说：“除了‘挂’衣服不来我房间”，我也错听为”除了‘换’衣服不来我房间“，以为你也是玩笑，所以才接了下句；言语不知轻重我非常抱歉；话还是要说清楚，朋友之间不应该有隔阂，今天都在想，搞不清楚如何处理和朋友相处的关系，是否要装作成熟不苟言笑，但是我估计很难改掉犯二的毛病，如此这般，我也不是我要做的我，生活也会索然无趣；总之，我会改正自己的毛病，也望你以后多多担待，不希望这样的事情在我们的友谊中埋下隔阂的种子，我希望，以后有自己喜欢的音乐电影书等等可以无顾虑的互相分享，对看不爽的人事一起吐槽，碰到喜欢的姑娘还可以找你当军师，可以促膝长谈，可以玩笑互损，可以简单纯粹快乐，可以给好朋友打上forever的标签，以后也会有争执但不会留下仇恨，就这样吧，晚安。\n\n> Update Time: 2016/12/09\n\n*心情早已平复，终究还是不能无情，希望你早日好起来*\n","source":"_posts/Hey-Friends.md","raw":"---\ntitle: Hey Friends\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: hey-friends-2\nid: 10023\ndate: 2016-07-23 00:34:54\n---\n\n\n吃一口饭，喝一杯水，夜晚抬头看星星与月亮，随手拍死一个蚊子；\n听一首歌，看一场电影，记录下来感动瞬间，分享到朋友圈；\n\n忘记了上顿饭吃了什么，忘记了一天要喝8杯水，抬头看不懂星星和月亮的美，第二天还能看到蚊子叮咬过的痕迹；\n\n喜欢的音乐、电影、书籍，感动了你自己，于沉浸中转身，想要分享却找不到合适的人；\n\n心中有万壑千山，笔下滴墨未浸；\n\n我要睡觉了，但是睡不着，希望你认真看完下面的话。\n\n以前看过一段话：不要成为一个无穷无尽的逗比，不要因害怕冷场而笑得最大声闹得最起劲，不要急于亲近而忘了拿捏矜持放低骄傲，不要因在真爱的人面前莫名自卑而准备了一箩筐段子随时逗TA开心为自己解围。喜欢的人等你足够优秀时一定能在一起，逗比没什么不好，但因为你给的嬉笑太盛，于是没有人再欣赏你的认真。\n\n我人蠢笨，做事犯傻，经常忘记东西，不够聪明，很多毛病和缺点，多到我自己都在厌烦自己，我做着不找边际的梦想，过着碌碌无为的人生，永远叫嚷着减肥却饮食不节制也不坚持运动，朋友不多，前半生的简单重复，没鼓起勇气做牛逼的事情，没读过多少书，上学时间经常换学校，没留下多少朋友，所以，我很珍惜现在所拥有的一切。\n\n我热爱生活，唯一能做的是认真努力对待每一天，我很感恩珍惜现在所拥有的一切，朋友，家人，平淡的生活，我总是想努力维持在一个好的状态，讨厌隔阂，却又拙于处理这些问题，我性格开朗，稀里糊涂，像个没长大的孩子，经常犯二犯傻令人扶额凝语。\n\n我不在意朋友自己之间善意的玩笑，不在意被说多少次人傻犯蠢，智商堪忧，腿短腰粗脸大翘屁股，不介意被说唱歌难听，不介意人丑还自恋，我觉得这并没什么，我也经常自嘲，也会被带入你的节奏哼唱“卖弄美色”；接触这几年，我相信你们也明白我的性格，我觉得友情很重要，朋友是可以互相损讽，朋友是在需要的时候温柔相待，我是个逗比，我不会因朋友玩笑不开心，我在意的是嬉笑背后尊重我的认真。\n\n我很尊重你，也很敬佩你，我非常珍惜我们的友谊，不希望有隔阂，这会让我辗转反侧无意入眠，也是我写下这些话的原因，你是个非常优秀的姑娘，你的坦荡潇洒，另我自愧弗如，你身上有着许多耀眼的闪光点，与你为友是我的荣幸；我在做人说话方面得罪过不少人，以至如今我父母仍旧时常提醒我，但大多数仍是无心之举，我不喜欢狡辩，因我之过错越过你的底线，对不起，我很认真的道歉，以后会注意，昨夜的“不识相”实非有意说的，至于你之后说：“除了‘挂’衣服不来我房间”，我也错听为”除了‘换’衣服不来我房间“，以为你也是玩笑，所以才接了下句；言语不知轻重我非常抱歉；话还是要说清楚，朋友之间不应该有隔阂，今天都在想，搞不清楚如何处理和朋友相处的关系，是否要装作成熟不苟言笑，但是我估计很难改掉犯二的毛病，如此这般，我也不是我要做的我，生活也会索然无趣；总之，我会改正自己的毛病，也望你以后多多担待，不希望这样的事情在我们的友谊中埋下隔阂的种子，我希望，以后有自己喜欢的音乐电影书等等可以无顾虑的互相分享，对看不爽的人事一起吐槽，碰到喜欢的姑娘还可以找你当军师，可以促膝长谈，可以玩笑互损，可以简单纯粹快乐，可以给好朋友打上forever的标签，以后也会有争执但不会留下仇恨，就这样吧，晚安。\n\n> Update Time: 2016/12/09\n\n*心情早已平复，终究还是不能无情，希望你早日好起来*\n","slug":"hey-friends-2","published":1,"updated":"2017-04-24T14:32:22.571Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq6n000z41tpo9xokckp","content":"<p>吃一口饭，喝一杯水，夜晚抬头看星星与月亮，随手拍死一个蚊子；<br>听一首歌，看一场电影，记录下来感动瞬间，分享到朋友圈；</p>\n<p>忘记了上顿饭吃了什么，忘记了一天要喝8杯水，抬头看不懂星星和月亮的美，第二天还能看到蚊子叮咬过的痕迹；</p>\n<p>喜欢的音乐、电影、书籍，感动了你自己，于沉浸中转身，想要分享却找不到合适的人；</p>\n<p>心中有万壑千山，笔下滴墨未浸；</p>\n<p>我要睡觉了，但是睡不着，希望你认真看完下面的话。</p>\n<p>以前看过一段话：不要成为一个无穷无尽的逗比，不要因害怕冷场而笑得最大声闹得最起劲，不要急于亲近而忘了拿捏矜持放低骄傲，不要因在真爱的人面前莫名自卑而准备了一箩筐段子随时逗TA开心为自己解围。喜欢的人等你足够优秀时一定能在一起，逗比没什么不好，但因为你给的嬉笑太盛，于是没有人再欣赏你的认真。</p>\n<p>我人蠢笨，做事犯傻，经常忘记东西，不够聪明，很多毛病和缺点，多到我自己都在厌烦自己，我做着不找边际的梦想，过着碌碌无为的人生，永远叫嚷着减肥却饮食不节制也不坚持运动，朋友不多，前半生的简单重复，没鼓起勇气做牛逼的事情，没读过多少书，上学时间经常换学校，没留下多少朋友，所以，我很珍惜现在所拥有的一切。</p>\n<p>我热爱生活，唯一能做的是认真努力对待每一天，我很感恩珍惜现在所拥有的一切，朋友，家人，平淡的生活，我总是想努力维持在一个好的状态，讨厌隔阂，却又拙于处理这些问题，我性格开朗，稀里糊涂，像个没长大的孩子，经常犯二犯傻令人扶额凝语。</p>\n<p>我不在意朋友自己之间善意的玩笑，不在意被说多少次人傻犯蠢，智商堪忧，腿短腰粗脸大翘屁股，不介意被说唱歌难听，不介意人丑还自恋，我觉得这并没什么，我也经常自嘲，也会被带入你的节奏哼唱“卖弄美色”；接触这几年，我相信你们也明白我的性格，我觉得友情很重要，朋友是可以互相损讽，朋友是在需要的时候温柔相待，我是个逗比，我不会因朋友玩笑不开心，我在意的是嬉笑背后尊重我的认真。</p>\n<p>我很尊重你，也很敬佩你，我非常珍惜我们的友谊，不希望有隔阂，这会让我辗转反侧无意入眠，也是我写下这些话的原因，你是个非常优秀的姑娘，你的坦荡潇洒，另我自愧弗如，你身上有着许多耀眼的闪光点，与你为友是我的荣幸；我在做人说话方面得罪过不少人，以至如今我父母仍旧时常提醒我，但大多数仍是无心之举，我不喜欢狡辩，因我之过错越过你的底线，对不起，我很认真的道歉，以后会注意，昨夜的“不识相”实非有意说的，至于你之后说：“除了‘挂’衣服不来我房间”，我也错听为”除了‘换’衣服不来我房间“，以为你也是玩笑，所以才接了下句；言语不知轻重我非常抱歉；话还是要说清楚，朋友之间不应该有隔阂，今天都在想，搞不清楚如何处理和朋友相处的关系，是否要装作成熟不苟言笑，但是我估计很难改掉犯二的毛病，如此这般，我也不是我要做的我，生活也会索然无趣；总之，我会改正自己的毛病，也望你以后多多担待，不希望这样的事情在我们的友谊中埋下隔阂的种子，我希望，以后有自己喜欢的音乐电影书等等可以无顾虑的互相分享，对看不爽的人事一起吐槽，碰到喜欢的姑娘还可以找你当军师，可以促膝长谈，可以玩笑互损，可以简单纯粹快乐，可以给好朋友打上forever的标签，以后也会有争执但不会留下仇恨，就这样吧，晚安。</p>\n<blockquote>\n<p>Update Time: 2016/12/09</p>\n</blockquote>\n<p><em>心情早已平复，终究还是不能无情，希望你早日好起来</em></p>\n","site":{"data":{}},"excerpt":"","more":"<p>吃一口饭，喝一杯水，夜晚抬头看星星与月亮，随手拍死一个蚊子；<br>听一首歌，看一场电影，记录下来感动瞬间，分享到朋友圈；</p>\n<p>忘记了上顿饭吃了什么，忘记了一天要喝8杯水，抬头看不懂星星和月亮的美，第二天还能看到蚊子叮咬过的痕迹；</p>\n<p>喜欢的音乐、电影、书籍，感动了你自己，于沉浸中转身，想要分享却找不到合适的人；</p>\n<p>心中有万壑千山，笔下滴墨未浸；</p>\n<p>我要睡觉了，但是睡不着，希望你认真看完下面的话。</p>\n<p>以前看过一段话：不要成为一个无穷无尽的逗比，不要因害怕冷场而笑得最大声闹得最起劲，不要急于亲近而忘了拿捏矜持放低骄傲，不要因在真爱的人面前莫名自卑而准备了一箩筐段子随时逗TA开心为自己解围。喜欢的人等你足够优秀时一定能在一起，逗比没什么不好，但因为你给的嬉笑太盛，于是没有人再欣赏你的认真。</p>\n<p>我人蠢笨，做事犯傻，经常忘记东西，不够聪明，很多毛病和缺点，多到我自己都在厌烦自己，我做着不找边际的梦想，过着碌碌无为的人生，永远叫嚷着减肥却饮食不节制也不坚持运动，朋友不多，前半生的简单重复，没鼓起勇气做牛逼的事情，没读过多少书，上学时间经常换学校，没留下多少朋友，所以，我很珍惜现在所拥有的一切。</p>\n<p>我热爱生活，唯一能做的是认真努力对待每一天，我很感恩珍惜现在所拥有的一切，朋友，家人，平淡的生活，我总是想努力维持在一个好的状态，讨厌隔阂，却又拙于处理这些问题，我性格开朗，稀里糊涂，像个没长大的孩子，经常犯二犯傻令人扶额凝语。</p>\n<p>我不在意朋友自己之间善意的玩笑，不在意被说多少次人傻犯蠢，智商堪忧，腿短腰粗脸大翘屁股，不介意被说唱歌难听，不介意人丑还自恋，我觉得这并没什么，我也经常自嘲，也会被带入你的节奏哼唱“卖弄美色”；接触这几年，我相信你们也明白我的性格，我觉得友情很重要，朋友是可以互相损讽，朋友是在需要的时候温柔相待，我是个逗比，我不会因朋友玩笑不开心，我在意的是嬉笑背后尊重我的认真。</p>\n<p>我很尊重你，也很敬佩你，我非常珍惜我们的友谊，不希望有隔阂，这会让我辗转反侧无意入眠，也是我写下这些话的原因，你是个非常优秀的姑娘，你的坦荡潇洒，另我自愧弗如，你身上有着许多耀眼的闪光点，与你为友是我的荣幸；我在做人说话方面得罪过不少人，以至如今我父母仍旧时常提醒我，但大多数仍是无心之举，我不喜欢狡辩，因我之过错越过你的底线，对不起，我很认真的道歉，以后会注意，昨夜的“不识相”实非有意说的，至于你之后说：“除了‘挂’衣服不来我房间”，我也错听为”除了‘换’衣服不来我房间“，以为你也是玩笑，所以才接了下句；言语不知轻重我非常抱歉；话还是要说清楚，朋友之间不应该有隔阂，今天都在想，搞不清楚如何处理和朋友相处的关系，是否要装作成熟不苟言笑，但是我估计很难改掉犯二的毛病，如此这般，我也不是我要做的我，生活也会索然无趣；总之，我会改正自己的毛病，也望你以后多多担待，不希望这样的事情在我们的友谊中埋下隔阂的种子，我希望，以后有自己喜欢的音乐电影书等等可以无顾虑的互相分享，对看不爽的人事一起吐槽，碰到喜欢的姑娘还可以找你当军师，可以促膝长谈，可以玩笑互损，可以简单纯粹快乐，可以给好朋友打上forever的标签，以后也会有争执但不会留下仇恨，就这样吧，晚安。</p>\n<blockquote>\n<p>Update Time: 2016/12/09</p>\n</blockquote>\n<p><em>心情早已平复，终究还是不能无情，希望你早日好起来</em></p>\n"},{"title":"HowTo Add Piwik Tracking to Ghost","id":"37","updated":"2017-04-21T05:36:03.000Z","date":"2016-04-27T08:51:58.000Z","_content":"\nThis is what about piwik on wiki. [goto](https://en.wikipedia.org/wiki/Piwik)\n\n## Step 1 - Getting your Piwik Tracking code\nThe first step to having Piwik tracking your Ghost blog will be to add a new website in Piwik, if you are unfamiliar with this process you can checkout the Piwik documention on Managing Websites. With your Ghost blog added into Piwik you will end up with tracking code that will look similar to the following:\n```\n<!-- Piwik -->\n<script type=\"text/javascript\">\n    var _paq = _paq || [];\n    (function(){ var u=((\"https:\" == document.location.protocol) ? \"https://{$PIWIK_URL}/\" : \"http://{$PIWIK_URL}/\");\n    _paq.push(['setSiteId', {$IDSITE}]);\n    _paq.push(['setTrackerUrl', u+'piwik.php']);\n    _paq.push(['trackPageView']);\n    _paq.push(['enableLinkTracking']);\n    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript'; g.defer=true; g.async=true; g.src=u+'piwik.js';\n    s.parentNode.insertBefore(g,s); })();\n</script>\n<!-- End Piwik Code -->\n```\n> Where <code>$PIWIK_URL</code> will be the domain name you have setup for Piwik.\n\n## Step 2 - Adding Piwik Tracking Code To Ghost Theme File\n\nPiwik recommends that you add the tracking code right above the <code>&#60;/body&#62;</code> tag, which you can find in your Ghost's <code>default.hbs</code> theme file. You will find the <code>default.hbs</code> file in <code>/path/to/ghost/content/themes/your-theme/default.hbs</code>\nHow you add the tracking code to your <code>default.hbs</code> will depend on if you are editing the file on your local computer or directly on the server. If you are editing your theme locally you can edit this file in any text editor and when you are finished upload this file to your server. Otherwise if you are editing this file directly on the server you can use the command line editor, <code>vim</code>, to add the tracking code.\n\n## Step 3 - Restart Ghost\nFor the changes in your theme to take effect you will need to restart Ghost. Restarting Ghost will load up a fresh copy of your theme files, with your Piwik tracking code. How you restart Ghost depends on how you started Ghost. If you followed our <a href=\"https://www.howtoinstallghost.com/how-to-start-ghost-with-forever/\">Keep Ghost Running with forever</a>, then you can restart Ghost with <code>forever restart ghost</code>.\nWithin a few moments you will start to see data coming in for your Ghost blog!\nIf you have any questions about setting this up or run into any issues please leave us a comment below and we will do what we can to help.\n","source":"_posts/HowTo-Add-Piwik-Tracking-to-Ghost.md","raw":"---\ntitle: HowTo Add Piwik Tracking to Ghost\ntags: 'Piwik'\ncategories: 'Ghost'\npermalink: how-to-add-piwik-tracking-to-ghost\nid: 37\nupdated: '2017-04-21 13:36:03'\ndate: 2016-04-27 16:51:58\n---\n\nThis is what about piwik on wiki. [goto](https://en.wikipedia.org/wiki/Piwik)\n\n## Step 1 - Getting your Piwik Tracking code\nThe first step to having Piwik tracking your Ghost blog will be to add a new website in Piwik, if you are unfamiliar with this process you can checkout the Piwik documention on Managing Websites. With your Ghost blog added into Piwik you will end up with tracking code that will look similar to the following:\n```\n<!-- Piwik -->\n<script type=\"text/javascript\">\n    var _paq = _paq || [];\n    (function(){ var u=((\"https:\" == document.location.protocol) ? \"https://{$PIWIK_URL}/\" : \"http://{$PIWIK_URL}/\");\n    _paq.push(['setSiteId', {$IDSITE}]);\n    _paq.push(['setTrackerUrl', u+'piwik.php']);\n    _paq.push(['trackPageView']);\n    _paq.push(['enableLinkTracking']);\n    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript'; g.defer=true; g.async=true; g.src=u+'piwik.js';\n    s.parentNode.insertBefore(g,s); })();\n</script>\n<!-- End Piwik Code -->\n```\n> Where <code>$PIWIK_URL</code> will be the domain name you have setup for Piwik.\n\n## Step 2 - Adding Piwik Tracking Code To Ghost Theme File\n\nPiwik recommends that you add the tracking code right above the <code>&#60;/body&#62;</code> tag, which you can find in your Ghost's <code>default.hbs</code> theme file. You will find the <code>default.hbs</code> file in <code>/path/to/ghost/content/themes/your-theme/default.hbs</code>\nHow you add the tracking code to your <code>default.hbs</code> will depend on if you are editing the file on your local computer or directly on the server. If you are editing your theme locally you can edit this file in any text editor and when you are finished upload this file to your server. Otherwise if you are editing this file directly on the server you can use the command line editor, <code>vim</code>, to add the tracking code.\n\n## Step 3 - Restart Ghost\nFor the changes in your theme to take effect you will need to restart Ghost. Restarting Ghost will load up a fresh copy of your theme files, with your Piwik tracking code. How you restart Ghost depends on how you started Ghost. If you followed our <a href=\"https://www.howtoinstallghost.com/how-to-start-ghost-with-forever/\">Keep Ghost Running with forever</a>, then you can restart Ghost with <code>forever restart ghost</code>.\nWithin a few moments you will start to see data coming in for your Ghost blog!\nIf you have any questions about setting this up or run into any issues please leave us a comment below and we will do what we can to help.\n","slug":"how-to-add-piwik-tracking-to-ghost","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq6p001141tpsctduonw","content":"<p>This is what about piwik on wiki. <a href=\"https://en.wikipedia.org/wiki/Piwik\" target=\"_blank\" rel=\"external\">goto</a></p>\n<h2 id=\"Step-1-Getting-your-Piwik-Tracking-code\"><a href=\"#Step-1-Getting-your-Piwik-Tracking-code\" class=\"headerlink\" title=\"Step 1 - Getting your Piwik Tracking code\"></a>Step 1 - Getting your Piwik Tracking code</h2><p>The first step to having Piwik tracking your Ghost blog will be to add a new website in Piwik, if you are unfamiliar with this process you can checkout the Piwik documention on Managing Websites. With your Ghost blog added into Piwik you will end up with tracking code that will look similar to the following:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!-- Piwik --&gt;</div><div class=\"line\">&lt;script type=&quot;text/javascript&quot;&gt;</div><div class=\"line\">    var _paq = _paq || [];</div><div class=\"line\">    (function()&#123; var u=((&quot;https:&quot; == document.location.protocol) ? &quot;https://&#123;$PIWIK_URL&#125;/&quot; : &quot;http://&#123;$PIWIK_URL&#125;/&quot;);</div><div class=\"line\">    _paq.push([&apos;setSiteId&apos;, &#123;$IDSITE&#125;]);</div><div class=\"line\">    _paq.push([&apos;setTrackerUrl&apos;, u+&apos;piwik.php&apos;]);</div><div class=\"line\">    _paq.push([&apos;trackPageView&apos;]);</div><div class=\"line\">    _paq.push([&apos;enableLinkTracking&apos;]);</div><div class=\"line\">    var d=document, g=d.createElement(&apos;script&apos;), s=d.getElementsByTagName(&apos;script&apos;)[0]; g.type=&apos;text/javascript&apos;; g.defer=true; g.async=true; g.src=u+&apos;piwik.js&apos;;</div><div class=\"line\">    s.parentNode.insertBefore(g,s); &#125;)();</div><div class=\"line\">&lt;/script&gt;</div><div class=\"line\">&lt;!-- End Piwik Code --&gt;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Where <code>$PIWIK_URL</code> will be the domain name you have setup for Piwik.</p>\n</blockquote>\n<h2 id=\"Step-2-Adding-Piwik-Tracking-Code-To-Ghost-Theme-File\"><a href=\"#Step-2-Adding-Piwik-Tracking-Code-To-Ghost-Theme-File\" class=\"headerlink\" title=\"Step 2 - Adding Piwik Tracking Code To Ghost Theme File\"></a>Step 2 - Adding Piwik Tracking Code To Ghost Theme File</h2><p>Piwik recommends that you add the tracking code right above the <code>&#60;/body&#62;</code> tag, which you can find in your Ghost’s <code>default.hbs</code> theme file. You will find the <code>default.hbs</code> file in <code>/path/to/ghost/content/themes/your-theme/default.hbs</code><br>How you add the tracking code to your <code>default.hbs</code> will depend on if you are editing the file on your local computer or directly on the server. If you are editing your theme locally you can edit this file in any text editor and when you are finished upload this file to your server. Otherwise if you are editing this file directly on the server you can use the command line editor, <code>vim</code>, to add the tracking code.</p>\n<h2 id=\"Step-3-Restart-Ghost\"><a href=\"#Step-3-Restart-Ghost\" class=\"headerlink\" title=\"Step 3 - Restart Ghost\"></a>Step 3 - Restart Ghost</h2><p>For the changes in your theme to take effect you will need to restart Ghost. Restarting Ghost will load up a fresh copy of your theme files, with your Piwik tracking code. How you restart Ghost depends on how you started Ghost. If you followed our <a href=\"https://www.howtoinstallghost.com/how-to-start-ghost-with-forever/\" target=\"_blank\" rel=\"external\">Keep Ghost Running with forever</a>, then you can restart Ghost with <code>forever restart ghost</code>.<br>Within a few moments you will start to see data coming in for your Ghost blog!<br>If you have any questions about setting this up or run into any issues please leave us a comment below and we will do what we can to help.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>This is what about piwik on wiki. <a href=\"https://en.wikipedia.org/wiki/Piwik\">goto</a></p>\n<h2 id=\"Step-1-Getting-your-Piwik-Tracking-code\"><a href=\"#Step-1-Getting-your-Piwik-Tracking-code\" class=\"headerlink\" title=\"Step 1 - Getting your Piwik Tracking code\"></a>Step 1 - Getting your Piwik Tracking code</h2><p>The first step to having Piwik tracking your Ghost blog will be to add a new website in Piwik, if you are unfamiliar with this process you can checkout the Piwik documention on Managing Websites. With your Ghost blog added into Piwik you will end up with tracking code that will look similar to the following:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!-- Piwik --&gt;</div><div class=\"line\">&lt;script type=&quot;text/javascript&quot;&gt;</div><div class=\"line\">    var _paq = _paq || [];</div><div class=\"line\">    (function()&#123; var u=((&quot;https:&quot; == document.location.protocol) ? &quot;https://&#123;$PIWIK_URL&#125;/&quot; : &quot;http://&#123;$PIWIK_URL&#125;/&quot;);</div><div class=\"line\">    _paq.push([&apos;setSiteId&apos;, &#123;$IDSITE&#125;]);</div><div class=\"line\">    _paq.push([&apos;setTrackerUrl&apos;, u+&apos;piwik.php&apos;]);</div><div class=\"line\">    _paq.push([&apos;trackPageView&apos;]);</div><div class=\"line\">    _paq.push([&apos;enableLinkTracking&apos;]);</div><div class=\"line\">    var d=document, g=d.createElement(&apos;script&apos;), s=d.getElementsByTagName(&apos;script&apos;)[0]; g.type=&apos;text/javascript&apos;; g.defer=true; g.async=true; g.src=u+&apos;piwik.js&apos;;</div><div class=\"line\">    s.parentNode.insertBefore(g,s); &#125;)();</div><div class=\"line\">&lt;/script&gt;</div><div class=\"line\">&lt;!-- End Piwik Code --&gt;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Where <code>$PIWIK_URL</code> will be the domain name you have setup for Piwik.</p>\n</blockquote>\n<h2 id=\"Step-2-Adding-Piwik-Tracking-Code-To-Ghost-Theme-File\"><a href=\"#Step-2-Adding-Piwik-Tracking-Code-To-Ghost-Theme-File\" class=\"headerlink\" title=\"Step 2 - Adding Piwik Tracking Code To Ghost Theme File\"></a>Step 2 - Adding Piwik Tracking Code To Ghost Theme File</h2><p>Piwik recommends that you add the tracking code right above the <code>&#60;/body&#62;</code> tag, which you can find in your Ghost’s <code>default.hbs</code> theme file. You will find the <code>default.hbs</code> file in <code>/path/to/ghost/content/themes/your-theme/default.hbs</code><br>How you add the tracking code to your <code>default.hbs</code> will depend on if you are editing the file on your local computer or directly on the server. If you are editing your theme locally you can edit this file in any text editor and when you are finished upload this file to your server. Otherwise if you are editing this file directly on the server you can use the command line editor, <code>vim</code>, to add the tracking code.</p>\n<h2 id=\"Step-3-Restart-Ghost\"><a href=\"#Step-3-Restart-Ghost\" class=\"headerlink\" title=\"Step 3 - Restart Ghost\"></a>Step 3 - Restart Ghost</h2><p>For the changes in your theme to take effect you will need to restart Ghost. Restarting Ghost will load up a fresh copy of your theme files, with your Piwik tracking code. How you restart Ghost depends on how you started Ghost. If you followed our <a href=\"https://www.howtoinstallghost.com/how-to-start-ghost-with-forever/\">Keep Ghost Running with forever</a>, then you can restart Ghost with <code>forever restart ghost</code>.<br>Within a few moments you will start to see data coming in for your Ghost blog!<br>If you have any questions about setting this up or run into any issues please leave us a comment below and we will do what we can to help.</p>\n"},{"title":"HowTo Automatic Updates CENTOS/RHEL Using YUM","id":"135","updated":"2017-04-21T05:16:33.000Z","date":"2017-02-19T01:56:42.000Z","_content":"\n大家若工作遇到需要管理的Linux集群机器较多时，同时我们知道系统的安全更新补丁维护这些非常重要，无论你在安装时优化维护做的再好，随着时间的推移，如果不去更新的话，系统早晚都会不安全，所以定期更新我们的系统补丁是一个运维人员的基本工作内容\n\n\n\n### Install yum-cron\n\n```\nsudo yum install -y yum-cron\n```\n\n因为我的服务器系统多为CentOS 6，6的配置文件在<code>/etc/sysconfig/yum-cron</code>，你可以用以下命令查看配置文件位置：\n\n```\nrpm -ql yum-cron\n/etc/cron.daily/0yum.cron\n/etc/rc.d/init.d/yum-cron\n/etc/sysconfig/yum-cron\n/etc/yum/yum-daily.yum\n/etc/yum/yum-weekly.yum\n/usr/share/doc/yum-cron-3.2.29\n/usr/share/doc/yum-cron-3.2.29/COPYING\n/usr/share/man/man8/yum-cron.8.gz\n```\n\n\n\n### Configure “/etc/sysconfig/yum-cron”\n\nyum-cron的默认设置是会在每天自动检查和安装系统更新包，在安装完成后有些配置需要注意下：\n\n##### 1. 对于不需要更新的可以忽略掉\n\n```\nYUM_PARAMETER=\"--exclude='kernel*' --exclude='php*'\"\n```\n\n##### 2. 设置管理员邮箱\n\n```\nMAILTO=\"luchuanjia@msn.com\"\n```\n\n##### 3. 不自动安装，仅检查，通知管理邮箱\n\n```\nCHECK_ONLY=yes\n```\n\n##### 4. 不自动安装，仅下载\n\n```\nDOWNLOAD_ONLY=yes\n```\n\n\n\n### Automatic Starting yum-cron\n\n```\nchkconfig yum-cron on\n```\n\n","source":"_posts/HowTo-Automatic-Updates-CENTOS-RHEL-Using-YUM.md","raw":"---\ntitle: HowTo Automatic Updates CENTOS/RHEL Using YUM\ntags: 'CentOS'\ncategories: 'CentOS'\npermalink: howto-automatic-updates-centos-rhel-using-yum\nid: 135\nupdated: '2017-04-21 13:16:33'\ndate: 2017-02-19 09:56:42\n---\n\n大家若工作遇到需要管理的Linux集群机器较多时，同时我们知道系统的安全更新补丁维护这些非常重要，无论你在安装时优化维护做的再好，随着时间的推移，如果不去更新的话，系统早晚都会不安全，所以定期更新我们的系统补丁是一个运维人员的基本工作内容\n\n\n\n### Install yum-cron\n\n```\nsudo yum install -y yum-cron\n```\n\n因为我的服务器系统多为CentOS 6，6的配置文件在<code>/etc/sysconfig/yum-cron</code>，你可以用以下命令查看配置文件位置：\n\n```\nrpm -ql yum-cron\n/etc/cron.daily/0yum.cron\n/etc/rc.d/init.d/yum-cron\n/etc/sysconfig/yum-cron\n/etc/yum/yum-daily.yum\n/etc/yum/yum-weekly.yum\n/usr/share/doc/yum-cron-3.2.29\n/usr/share/doc/yum-cron-3.2.29/COPYING\n/usr/share/man/man8/yum-cron.8.gz\n```\n\n\n\n### Configure “/etc/sysconfig/yum-cron”\n\nyum-cron的默认设置是会在每天自动检查和安装系统更新包，在安装完成后有些配置需要注意下：\n\n##### 1. 对于不需要更新的可以忽略掉\n\n```\nYUM_PARAMETER=\"--exclude='kernel*' --exclude='php*'\"\n```\n\n##### 2. 设置管理员邮箱\n\n```\nMAILTO=\"luchuanjia@msn.com\"\n```\n\n##### 3. 不自动安装，仅检查，通知管理邮箱\n\n```\nCHECK_ONLY=yes\n```\n\n##### 4. 不自动安装，仅下载\n\n```\nDOWNLOAD_ONLY=yes\n```\n\n\n\n### Automatic Starting yum-cron\n\n```\nchkconfig yum-cron on\n```\n\n","slug":"howto-automatic-updates-centos-rhel-using-yum","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq6y001641tpjlr4ultm","content":"<p>大家若工作遇到需要管理的Linux集群机器较多时，同时我们知道系统的安全更新补丁维护这些非常重要，无论你在安装时优化维护做的再好，随着时间的推移，如果不去更新的话，系统早晚都会不安全，所以定期更新我们的系统补丁是一个运维人员的基本工作内容</p>\n<h3 id=\"Install-yum-cron\"><a href=\"#Install-yum-cron\" class=\"headerlink\" title=\"Install yum-cron\"></a>Install yum-cron</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo yum install -y yum-cron</div></pre></td></tr></table></figure>\n<p>因为我的服务器系统多为CentOS 6，6的配置文件在<code>/etc/sysconfig/yum-cron</code>，你可以用以下命令查看配置文件位置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -ql yum-cron</div><div class=\"line\">/etc/cron.daily/0yum.cron</div><div class=\"line\">/etc/rc.d/init.d/yum-cron</div><div class=\"line\">/etc/sysconfig/yum-cron</div><div class=\"line\">/etc/yum/yum-daily.yum</div><div class=\"line\">/etc/yum/yum-weekly.yum</div><div class=\"line\">/usr/share/doc/yum-cron-3.2.29</div><div class=\"line\">/usr/share/doc/yum-cron-3.2.29/COPYING</div><div class=\"line\">/usr/share/man/man8/yum-cron.8.gz</div></pre></td></tr></table></figure>\n<h3 id=\"Configure-“-etc-sysconfig-yum-cron”\"><a href=\"#Configure-“-etc-sysconfig-yum-cron”\" class=\"headerlink\" title=\"Configure “/etc/sysconfig/yum-cron”\"></a>Configure “/etc/sysconfig/yum-cron”</h3><p>yum-cron的默认设置是会在每天自动检查和安装系统更新包，在安装完成后有些配置需要注意下：</p>\n<h5 id=\"1-对于不需要更新的可以忽略掉\"><a href=\"#1-对于不需要更新的可以忽略掉\" class=\"headerlink\" title=\"1. 对于不需要更新的可以忽略掉\"></a>1. 对于不需要更新的可以忽略掉</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">YUM_PARAMETER=&quot;--exclude=&apos;kernel*&apos; --exclude=&apos;php*&apos;&quot;</div></pre></td></tr></table></figure>\n<h5 id=\"2-设置管理员邮箱\"><a href=\"#2-设置管理员邮箱\" class=\"headerlink\" title=\"2. 设置管理员邮箱\"></a>2. 设置管理员邮箱</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">MAILTO=&quot;luchuanjia@msn.com&quot;</div></pre></td></tr></table></figure>\n<h5 id=\"3-不自动安装，仅检查，通知管理邮箱\"><a href=\"#3-不自动安装，仅检查，通知管理邮箱\" class=\"headerlink\" title=\"3. 不自动安装，仅检查，通知管理邮箱\"></a>3. 不自动安装，仅检查，通知管理邮箱</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">CHECK_ONLY=yes</div></pre></td></tr></table></figure>\n<h5 id=\"4-不自动安装，仅下载\"><a href=\"#4-不自动安装，仅下载\" class=\"headerlink\" title=\"4. 不自动安装，仅下载\"></a>4. 不自动安装，仅下载</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">DOWNLOAD_ONLY=yes</div></pre></td></tr></table></figure>\n<h3 id=\"Automatic-Starting-yum-cron\"><a href=\"#Automatic-Starting-yum-cron\" class=\"headerlink\" title=\"Automatic Starting yum-cron\"></a>Automatic Starting yum-cron</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig yum-cron on</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>大家若工作遇到需要管理的Linux集群机器较多时，同时我们知道系统的安全更新补丁维护这些非常重要，无论你在安装时优化维护做的再好，随着时间的推移，如果不去更新的话，系统早晚都会不安全，所以定期更新我们的系统补丁是一个运维人员的基本工作内容</p>\n<h3 id=\"Install-yum-cron\"><a href=\"#Install-yum-cron\" class=\"headerlink\" title=\"Install yum-cron\"></a>Install yum-cron</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo yum install -y yum-cron</div></pre></td></tr></table></figure>\n<p>因为我的服务器系统多为CentOS 6，6的配置文件在<code>/etc/sysconfig/yum-cron</code>，你可以用以下命令查看配置文件位置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -ql yum-cron</div><div class=\"line\">/etc/cron.daily/0yum.cron</div><div class=\"line\">/etc/rc.d/init.d/yum-cron</div><div class=\"line\">/etc/sysconfig/yum-cron</div><div class=\"line\">/etc/yum/yum-daily.yum</div><div class=\"line\">/etc/yum/yum-weekly.yum</div><div class=\"line\">/usr/share/doc/yum-cron-3.2.29</div><div class=\"line\">/usr/share/doc/yum-cron-3.2.29/COPYING</div><div class=\"line\">/usr/share/man/man8/yum-cron.8.gz</div></pre></td></tr></table></figure>\n<h3 id=\"Configure-“-etc-sysconfig-yum-cron”\"><a href=\"#Configure-“-etc-sysconfig-yum-cron”\" class=\"headerlink\" title=\"Configure “/etc/sysconfig/yum-cron”\"></a>Configure “/etc/sysconfig/yum-cron”</h3><p>yum-cron的默认设置是会在每天自动检查和安装系统更新包，在安装完成后有些配置需要注意下：</p>\n<h5 id=\"1-对于不需要更新的可以忽略掉\"><a href=\"#1-对于不需要更新的可以忽略掉\" class=\"headerlink\" title=\"1. 对于不需要更新的可以忽略掉\"></a>1. 对于不需要更新的可以忽略掉</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">YUM_PARAMETER=&quot;--exclude=&apos;kernel*&apos; --exclude=&apos;php*&apos;&quot;</div></pre></td></tr></table></figure>\n<h5 id=\"2-设置管理员邮箱\"><a href=\"#2-设置管理员邮箱\" class=\"headerlink\" title=\"2. 设置管理员邮箱\"></a>2. 设置管理员邮箱</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">MAILTO=&quot;luchuanjia@msn.com&quot;</div></pre></td></tr></table></figure>\n<h5 id=\"3-不自动安装，仅检查，通知管理邮箱\"><a href=\"#3-不自动安装，仅检查，通知管理邮箱\" class=\"headerlink\" title=\"3. 不自动安装，仅检查，通知管理邮箱\"></a>3. 不自动安装，仅检查，通知管理邮箱</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">CHECK_ONLY=yes</div></pre></td></tr></table></figure>\n<h5 id=\"4-不自动安装，仅下载\"><a href=\"#4-不自动安装，仅下载\" class=\"headerlink\" title=\"4. 不自动安装，仅下载\"></a>4. 不自动安装，仅下载</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">DOWNLOAD_ONLY=yes</div></pre></td></tr></table></figure>\n<h3 id=\"Automatic-Starting-yum-cron\"><a href=\"#Automatic-Starting-yum-cron\" class=\"headerlink\" title=\"Automatic Starting yum-cron\"></a>Automatic Starting yum-cron</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig yum-cron on</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Install CloudStack 4.8 on CentOS 6.x","id":"52","updated":"2017-04-21T05:33:18.000Z","date":"2016-05-17T18:38:59.000Z","_content":"\n```\n\n#!/bin/bash\n\n# Install  CloudStack.sh\n\n# setting static ip in : /etc/sysconfig/network-scripts/ifcfg-eth0\n\n# Check Service\n\n# Install\n\n# hostname --fqdn\n\n# service network restart\n\n# trun off selinux in : /etc/selinux/config\n#SELinux=disabed\n\n# trun off iptables.\nservice iptables stop\nservice ip6tables stop\n\nchkconfig iptables off\nchkconfig ip6tables off\n\n#NTP\nyum install -y ntp\nchkconfig ntpd on\nservice ntpd start\n\n# adding cloudstack repos\n[cloudstack]\nname=cloudstack\nbaseurl=http://cloudstack.apt-get.eu/centos/6/4.5/\nenabled=1\ngpgcheck=0\n\n#NFS\nyum install -y nfs-utils\n\n# /etc/exports\n/secondary *(rw,async,no_root_squash,no_subtree_check)\n/primary *(rw,async,no_root_squash,no_subtree_check)\n# add top to /etc/sysconfig/nfs\nLOCKD_TCPPORT=32803\nLOCKD_UDPPORT=32769\nMOUNTD_PORT=892\nRQUOTAD_PORT=875\nSTATD_PORT=662\nSTATD_OUTGOING_PORT=2020\n# add iptable rules to /etc/sysconfig/iptables\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 111 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 111 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 2049 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 32803 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 32769 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 892 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 892 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 875 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 875 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 662 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 662 -j ACCEPT\n# service iptables restart\nservice rpcbind start\nservice nfs start\nchkconfig rpcbind on\nchkconfig nfs on\n\n# MySQL server\nyum install -y mysql-server\n# adding configure file in /etc/my.cnf : [mysqld]\ninnodb_rollback_on_timeout=1\ninnodb_lock_wait_timeout=600\nmax_connections=350\nlog-bin=mysql-bin\nbinlog-format = 'ROW'\n\nservice mysqld start\nchkconfig mysqld on\nmysql_secure_installation \t# remeber the root pass.\n\n# Cloudstack-management\nyum -y install cloudstack-management\ncloudstack-setup-databases cloud:[password]@localhost --deploy-as=root:[password]\ncloudstack-setup-management\n\n#System Template Setup\n/usr/share/cloudstack-common/scripts/storage/secondary/cloud-install-sys-tmplt -m /secondary -u http://cloudstack.apt-get.eu/systemvm/4.6/systemvm64template-4.6.0-kvm.qcow2.bz2 -h kvm -F\n\n\n# Install kvm\nyum -y install cloudstack-agent\n\n# qemu configuration : /etc/libvirt/qemu.conf\nvnc_listen=0.0.0.0\n# Libvirt Configuration : /etc/libvirt/libvirtd.conf\nlisten_tls = 0\nlisten_tcp = 1\ntcp_port = \"16059\"\nauth_tcp = \"none\"\nmdns_adv = 0\n#  /etc/sysconfig/libvirtd\nLIBVIRTD_ARGS=\"--listen\"\n\nservice libvirtd restart\n\nlsmod | grep kvm:\nkvm_intel              55496  0\nkvm                   337772  1 kvm_intel\n\n\n##### UI Setting ####\nhttp://[ip]:8080/client\n\n\n\n```\n","source":"_posts/HowTo-Install-CloudStack-4-8-on-CentOS-6-x.md","raw":"---\ntitle: HowTo Install CloudStack 4.8 on CentOS 6.x\ntags: 'CloudStack'\ncategories: 'CloudStack'\npermalink: how-to-install-cloudstack-on-centos-6-x\nid: 52\nupdated: '2017-04-21 13:33:18'\ndate: 2016-05-18 02:38:59\n---\n\n```\n\n#!/bin/bash\n\n# Install  CloudStack.sh\n\n# setting static ip in : /etc/sysconfig/network-scripts/ifcfg-eth0\n\n# Check Service\n\n# Install\n\n# hostname --fqdn\n\n# service network restart\n\n# trun off selinux in : /etc/selinux/config\n#SELinux=disabed\n\n# trun off iptables.\nservice iptables stop\nservice ip6tables stop\n\nchkconfig iptables off\nchkconfig ip6tables off\n\n#NTP\nyum install -y ntp\nchkconfig ntpd on\nservice ntpd start\n\n# adding cloudstack repos\n[cloudstack]\nname=cloudstack\nbaseurl=http://cloudstack.apt-get.eu/centos/6/4.5/\nenabled=1\ngpgcheck=0\n\n#NFS\nyum install -y nfs-utils\n\n# /etc/exports\n/secondary *(rw,async,no_root_squash,no_subtree_check)\n/primary *(rw,async,no_root_squash,no_subtree_check)\n# add top to /etc/sysconfig/nfs\nLOCKD_TCPPORT=32803\nLOCKD_UDPPORT=32769\nMOUNTD_PORT=892\nRQUOTAD_PORT=875\nSTATD_PORT=662\nSTATD_OUTGOING_PORT=2020\n# add iptable rules to /etc/sysconfig/iptables\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 111 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 111 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 2049 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 32803 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 32769 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 892 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 892 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 875 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 875 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 662 -j ACCEPT\n-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 662 -j ACCEPT\n# service iptables restart\nservice rpcbind start\nservice nfs start\nchkconfig rpcbind on\nchkconfig nfs on\n\n# MySQL server\nyum install -y mysql-server\n# adding configure file in /etc/my.cnf : [mysqld]\ninnodb_rollback_on_timeout=1\ninnodb_lock_wait_timeout=600\nmax_connections=350\nlog-bin=mysql-bin\nbinlog-format = 'ROW'\n\nservice mysqld start\nchkconfig mysqld on\nmysql_secure_installation \t# remeber the root pass.\n\n# Cloudstack-management\nyum -y install cloudstack-management\ncloudstack-setup-databases cloud:[password]@localhost --deploy-as=root:[password]\ncloudstack-setup-management\n\n#System Template Setup\n/usr/share/cloudstack-common/scripts/storage/secondary/cloud-install-sys-tmplt -m /secondary -u http://cloudstack.apt-get.eu/systemvm/4.6/systemvm64template-4.6.0-kvm.qcow2.bz2 -h kvm -F\n\n\n# Install kvm\nyum -y install cloudstack-agent\n\n# qemu configuration : /etc/libvirt/qemu.conf\nvnc_listen=0.0.0.0\n# Libvirt Configuration : /etc/libvirt/libvirtd.conf\nlisten_tls = 0\nlisten_tcp = 1\ntcp_port = \"16059\"\nauth_tcp = \"none\"\nmdns_adv = 0\n#  /etc/sysconfig/libvirtd\nLIBVIRTD_ARGS=\"--listen\"\n\nservice libvirtd restart\n\nlsmod | grep kvm:\nkvm_intel              55496  0\nkvm                   337772  1 kvm_intel\n\n\n##### UI Setting ####\nhttp://[ip]:8080/client\n\n\n\n```\n","slug":"how-to-install-cloudstack-on-centos-6-x","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq71001941tp7h7zlszq","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\"># Install  CloudStack.sh</div><div class=\"line\"></div><div class=\"line\"># setting static ip in : /etc/sysconfig/network-scripts/ifcfg-eth0</div><div class=\"line\"></div><div class=\"line\"># Check Service</div><div class=\"line\"></div><div class=\"line\"># Install</div><div class=\"line\"></div><div class=\"line\"># hostname --fqdn</div><div class=\"line\"></div><div class=\"line\"># service network restart</div><div class=\"line\"></div><div class=\"line\"># trun off selinux in : /etc/selinux/config</div><div class=\"line\">#SELinux=disabed</div><div class=\"line\"></div><div class=\"line\"># trun off iptables.</div><div class=\"line\">service iptables stop</div><div class=\"line\">service ip6tables stop</div><div class=\"line\"></div><div class=\"line\">chkconfig iptables off</div><div class=\"line\">chkconfig ip6tables off</div><div class=\"line\"></div><div class=\"line\">#NTP</div><div class=\"line\">yum install -y ntp</div><div class=\"line\">chkconfig ntpd on</div><div class=\"line\">service ntpd start</div><div class=\"line\"></div><div class=\"line\"># adding cloudstack repos</div><div class=\"line\">[cloudstack]</div><div class=\"line\">name=cloudstack</div><div class=\"line\">baseurl=http://cloudstack.apt-get.eu/centos/6/4.5/</div><div class=\"line\">enabled=1</div><div class=\"line\">gpgcheck=0</div><div class=\"line\"></div><div class=\"line\">#NFS</div><div class=\"line\">yum install -y nfs-utils</div><div class=\"line\"></div><div class=\"line\"># /etc/exports</div><div class=\"line\">/secondary *(rw,async,no_root_squash,no_subtree_check)</div><div class=\"line\">/primary *(rw,async,no_root_squash,no_subtree_check)</div><div class=\"line\"># add top to /etc/sysconfig/nfs</div><div class=\"line\">LOCKD_TCPPORT=32803</div><div class=\"line\">LOCKD_UDPPORT=32769</div><div class=\"line\">MOUNTD_PORT=892</div><div class=\"line\">RQUOTAD_PORT=875</div><div class=\"line\">STATD_PORT=662</div><div class=\"line\">STATD_OUTGOING_PORT=2020</div><div class=\"line\"># add iptable rules to /etc/sysconfig/iptables</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 111 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 111 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 2049 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 32803 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 32769 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 892 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 892 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 875 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 875 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 662 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 662 -j ACCEPT</div><div class=\"line\"># service iptables restart</div><div class=\"line\">service rpcbind start</div><div class=\"line\">service nfs start</div><div class=\"line\">chkconfig rpcbind on</div><div class=\"line\">chkconfig nfs on</div><div class=\"line\"></div><div class=\"line\"># MySQL server</div><div class=\"line\">yum install -y mysql-server</div><div class=\"line\"># adding configure file in /etc/my.cnf : [mysqld]</div><div class=\"line\">innodb_rollback_on_timeout=1</div><div class=\"line\">innodb_lock_wait_timeout=600</div><div class=\"line\">max_connections=350</div><div class=\"line\">log-bin=mysql-bin</div><div class=\"line\">binlog-format = &apos;ROW&apos;</div><div class=\"line\"></div><div class=\"line\">service mysqld start</div><div class=\"line\">chkconfig mysqld on</div><div class=\"line\">mysql_secure_installation \t# remeber the root pass.</div><div class=\"line\"></div><div class=\"line\"># Cloudstack-management</div><div class=\"line\">yum -y install cloudstack-management</div><div class=\"line\">cloudstack-setup-databases cloud:[password]@localhost --deploy-as=root:[password]</div><div class=\"line\">cloudstack-setup-management</div><div class=\"line\"></div><div class=\"line\">#System Template Setup</div><div class=\"line\">/usr/share/cloudstack-common/scripts/storage/secondary/cloud-install-sys-tmplt -m /secondary -u http://cloudstack.apt-get.eu/systemvm/4.6/systemvm64template-4.6.0-kvm.qcow2.bz2 -h kvm -F</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># Install kvm</div><div class=\"line\">yum -y install cloudstack-agent</div><div class=\"line\"></div><div class=\"line\"># qemu configuration : /etc/libvirt/qemu.conf</div><div class=\"line\">vnc_listen=0.0.0.0</div><div class=\"line\"># Libvirt Configuration : /etc/libvirt/libvirtd.conf</div><div class=\"line\">listen_tls = 0</div><div class=\"line\">listen_tcp = 1</div><div class=\"line\">tcp_port = &quot;16059&quot;</div><div class=\"line\">auth_tcp = &quot;none&quot;</div><div class=\"line\">mdns_adv = 0</div><div class=\"line\">#  /etc/sysconfig/libvirtd</div><div class=\"line\">LIBVIRTD_ARGS=&quot;--listen&quot;</div><div class=\"line\"></div><div class=\"line\">service libvirtd restart</div><div class=\"line\"></div><div class=\"line\">lsmod | grep kvm:</div><div class=\"line\">kvm_intel              55496  0</div><div class=\"line\">kvm                   337772  1 kvm_intel</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">##### UI Setting ####</div><div class=\"line\">http://[ip]:8080/client</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\"># Install  CloudStack.sh</div><div class=\"line\"></div><div class=\"line\"># setting static ip in : /etc/sysconfig/network-scripts/ifcfg-eth0</div><div class=\"line\"></div><div class=\"line\"># Check Service</div><div class=\"line\"></div><div class=\"line\"># Install</div><div class=\"line\"></div><div class=\"line\"># hostname --fqdn</div><div class=\"line\"></div><div class=\"line\"># service network restart</div><div class=\"line\"></div><div class=\"line\"># trun off selinux in : /etc/selinux/config</div><div class=\"line\">#SELinux=disabed</div><div class=\"line\"></div><div class=\"line\"># trun off iptables.</div><div class=\"line\">service iptables stop</div><div class=\"line\">service ip6tables stop</div><div class=\"line\"></div><div class=\"line\">chkconfig iptables off</div><div class=\"line\">chkconfig ip6tables off</div><div class=\"line\"></div><div class=\"line\">#NTP</div><div class=\"line\">yum install -y ntp</div><div class=\"line\">chkconfig ntpd on</div><div class=\"line\">service ntpd start</div><div class=\"line\"></div><div class=\"line\"># adding cloudstack repos</div><div class=\"line\">[cloudstack]</div><div class=\"line\">name=cloudstack</div><div class=\"line\">baseurl=http://cloudstack.apt-get.eu/centos/6/4.5/</div><div class=\"line\">enabled=1</div><div class=\"line\">gpgcheck=0</div><div class=\"line\"></div><div class=\"line\">#NFS</div><div class=\"line\">yum install -y nfs-utils</div><div class=\"line\"></div><div class=\"line\"># /etc/exports</div><div class=\"line\">/secondary *(rw,async,no_root_squash,no_subtree_check)</div><div class=\"line\">/primary *(rw,async,no_root_squash,no_subtree_check)</div><div class=\"line\"># add top to /etc/sysconfig/nfs</div><div class=\"line\">LOCKD_TCPPORT=32803</div><div class=\"line\">LOCKD_UDPPORT=32769</div><div class=\"line\">MOUNTD_PORT=892</div><div class=\"line\">RQUOTAD_PORT=875</div><div class=\"line\">STATD_PORT=662</div><div class=\"line\">STATD_OUTGOING_PORT=2020</div><div class=\"line\"># add iptable rules to /etc/sysconfig/iptables</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 111 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 111 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 2049 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 32803 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 32769 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 892 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 892 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 875 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 875 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p tcp --dport 662 -j ACCEPT</div><div class=\"line\">-A INPUT -s 172.16.10.0/24 -m state --state NEW -p udp --dport 662 -j ACCEPT</div><div class=\"line\"># service iptables restart</div><div class=\"line\">service rpcbind start</div><div class=\"line\">service nfs start</div><div class=\"line\">chkconfig rpcbind on</div><div class=\"line\">chkconfig nfs on</div><div class=\"line\"></div><div class=\"line\"># MySQL server</div><div class=\"line\">yum install -y mysql-server</div><div class=\"line\"># adding configure file in /etc/my.cnf : [mysqld]</div><div class=\"line\">innodb_rollback_on_timeout=1</div><div class=\"line\">innodb_lock_wait_timeout=600</div><div class=\"line\">max_connections=350</div><div class=\"line\">log-bin=mysql-bin</div><div class=\"line\">binlog-format = &apos;ROW&apos;</div><div class=\"line\"></div><div class=\"line\">service mysqld start</div><div class=\"line\">chkconfig mysqld on</div><div class=\"line\">mysql_secure_installation \t# remeber the root pass.</div><div class=\"line\"></div><div class=\"line\"># Cloudstack-management</div><div class=\"line\">yum -y install cloudstack-management</div><div class=\"line\">cloudstack-setup-databases cloud:[password]@localhost --deploy-as=root:[password]</div><div class=\"line\">cloudstack-setup-management</div><div class=\"line\"></div><div class=\"line\">#System Template Setup</div><div class=\"line\">/usr/share/cloudstack-common/scripts/storage/secondary/cloud-install-sys-tmplt -m /secondary -u http://cloudstack.apt-get.eu/systemvm/4.6/systemvm64template-4.6.0-kvm.qcow2.bz2 -h kvm -F</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># Install kvm</div><div class=\"line\">yum -y install cloudstack-agent</div><div class=\"line\"></div><div class=\"line\"># qemu configuration : /etc/libvirt/qemu.conf</div><div class=\"line\">vnc_listen=0.0.0.0</div><div class=\"line\"># Libvirt Configuration : /etc/libvirt/libvirtd.conf</div><div class=\"line\">listen_tls = 0</div><div class=\"line\">listen_tcp = 1</div><div class=\"line\">tcp_port = &quot;16059&quot;</div><div class=\"line\">auth_tcp = &quot;none&quot;</div><div class=\"line\">mdns_adv = 0</div><div class=\"line\">#  /etc/sysconfig/libvirtd</div><div class=\"line\">LIBVIRTD_ARGS=&quot;--listen&quot;</div><div class=\"line\"></div><div class=\"line\">service libvirtd restart</div><div class=\"line\"></div><div class=\"line\">lsmod | grep kvm:</div><div class=\"line\">kvm_intel              55496  0</div><div class=\"line\">kvm                   337772  1 kvm_intel</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">##### UI Setting ####</div><div class=\"line\">http://[ip]:8080/client</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Install Docker on CentOS 6.x","id":"65","updated":"2017-04-21T05:26:57.000Z","date":"2016-07-07T00:03:28.000Z","_content":"\n### **1. Add the EPEL Repository**\n```\nrpm -iUvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n```\n### **2. Update your system**\n```\nyum update -y\n```\n\n### **3. Install**\n```\nyum install -y docker-io\n```\n\n\n### **4. Configure**\n```\nservice docker start\nchkconfig docker on\n\ndocker info\n```\n### **5. Download a Docker Container**\n```\ndocker pull centos\n```\n### **6. Run a Docker Container**\n```\ndocker run -i -t centos /bin/bash\n```\n\n### **7. Find Docker Container**\n```\ndocker search ubuntu\n```\n\n### **FAQ**\n\n#### **1. Faild to start docker on CentOS 6.x**\n<code>***/usr/bin/docker: relocation error: /usr/bin/docker: symbol dm_task_get_info_with_deferred_remove, version Base not defined in file libdevmapper.so.1.02 with link time reference***</code>\n```\nthe lib-device-mapper that you have isn't exporting a symbol (\"Base\") that Docker needs.\nthis by upgrading lib-device-mapper to version 1.02.90.\n\n# You may have to enable the public_ol6_latest repo in order to get this package.\nsudo yum-config-manager --enable public_ol6_latest\nsudo yum install device-mapper-event-libs\n```\n\n#### **2. Faild to use docker**\n<code>***Get http:///var/run/docker.sock/v1.19/info: dial unix /var/run/docker.sock: no such file or directory. Are you trying to connect to a TLS-enabled daemon without TLS?***</code>\n```\n# this is because docker no restart ok.\n\npkill -9 docker && service docker start\n```\n\n#### **3. HowTo save 'docker run -i -t xxx /bin/bash'**\n```\ndocker ps -l\ndocker commit ID newname\ndocker images\n```\n\n","source":"_posts/HowTo-Install-Docker-on-CentOS-6-x.md","raw":"---\ntitle: HowTo Install Docker on CentOS 6.x\ntags: 'Docker'\ncategories: 'Docker'\npermalink: how-to-install-docker-on-centos-6-x-2\nid: 65\nupdated: '2017-04-21 13:26:57'\ndate: 2016-07-07 08:03:28\n---\n\n### **1. Add the EPEL Repository**\n```\nrpm -iUvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n```\n### **2. Update your system**\n```\nyum update -y\n```\n\n### **3. Install**\n```\nyum install -y docker-io\n```\n\n\n### **4. Configure**\n```\nservice docker start\nchkconfig docker on\n\ndocker info\n```\n### **5. Download a Docker Container**\n```\ndocker pull centos\n```\n### **6. Run a Docker Container**\n```\ndocker run -i -t centos /bin/bash\n```\n\n### **7. Find Docker Container**\n```\ndocker search ubuntu\n```\n\n### **FAQ**\n\n#### **1. Faild to start docker on CentOS 6.x**\n<code>***/usr/bin/docker: relocation error: /usr/bin/docker: symbol dm_task_get_info_with_deferred_remove, version Base not defined in file libdevmapper.so.1.02 with link time reference***</code>\n```\nthe lib-device-mapper that you have isn't exporting a symbol (\"Base\") that Docker needs.\nthis by upgrading lib-device-mapper to version 1.02.90.\n\n# You may have to enable the public_ol6_latest repo in order to get this package.\nsudo yum-config-manager --enable public_ol6_latest\nsudo yum install device-mapper-event-libs\n```\n\n#### **2. Faild to use docker**\n<code>***Get http:///var/run/docker.sock/v1.19/info: dial unix /var/run/docker.sock: no such file or directory. Are you trying to connect to a TLS-enabled daemon without TLS?***</code>\n```\n# this is because docker no restart ok.\n\npkill -9 docker && service docker start\n```\n\n#### **3. HowTo save 'docker run -i -t xxx /bin/bash'**\n```\ndocker ps -l\ndocker commit ID newname\ndocker images\n```\n\n","slug":"how-to-install-docker-on-centos-6-x-2","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq75001d41tpxctajc9f","content":"<h3 id=\"1-Add-the-EPEL-Repository\"><a href=\"#1-Add-the-EPEL-Repository\" class=\"headerlink\" title=\"1. Add the EPEL Repository\"></a><strong>1. Add the EPEL Repository</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -iUvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</div></pre></td></tr></table></figure>\n<h3 id=\"2-Update-your-system\"><a href=\"#2-Update-your-system\" class=\"headerlink\" title=\"2. Update your system\"></a><strong>2. Update your system</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum update -y</div></pre></td></tr></table></figure>\n<h3 id=\"3-Install\"><a href=\"#3-Install\" class=\"headerlink\" title=\"3. Install\"></a><strong>3. Install</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y docker-io</div></pre></td></tr></table></figure>\n<h3 id=\"4-Configure\"><a href=\"#4-Configure\" class=\"headerlink\" title=\"4. Configure\"></a><strong>4. Configure</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">service docker start</div><div class=\"line\">chkconfig docker on</div><div class=\"line\"></div><div class=\"line\">docker info</div></pre></td></tr></table></figure>\n<h3 id=\"5-Download-a-Docker-Container\"><a href=\"#5-Download-a-Docker-Container\" class=\"headerlink\" title=\"5. Download a Docker Container\"></a><strong>5. Download a Docker Container</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker pull centos</div></pre></td></tr></table></figure>\n<h3 id=\"6-Run-a-Docker-Container\"><a href=\"#6-Run-a-Docker-Container\" class=\"headerlink\" title=\"6. Run a Docker Container\"></a><strong>6. Run a Docker Container</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker run -i -t centos /bin/bash</div></pre></td></tr></table></figure>\n<h3 id=\"7-Find-Docker-Container\"><a href=\"#7-Find-Docker-Container\" class=\"headerlink\" title=\"7. Find Docker Container\"></a><strong>7. Find Docker Container</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker search ubuntu</div></pre></td></tr></table></figure>\n<h3 id=\"FAQ\"><a href=\"#FAQ\" class=\"headerlink\" title=\"FAQ\"></a><strong>FAQ</strong></h3><h4 id=\"1-Faild-to-start-docker-on-CentOS-6-x\"><a href=\"#1-Faild-to-start-docker-on-CentOS-6-x\" class=\"headerlink\" title=\"1. Faild to start docker on CentOS 6.x\"></a><strong>1. Faild to start docker on CentOS 6.x</strong></h4><p><code><strong><em>/usr/bin/docker: relocation error: /usr/bin/docker: symbol dm_task_get_info_with_deferred_remove, version Base not defined in file libdevmapper.so.1.02 with link time reference</em></strong></code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">the lib-device-mapper that you have isn&apos;t exporting a symbol (&quot;Base&quot;) that Docker needs.</div><div class=\"line\">this by upgrading lib-device-mapper to version 1.02.90.</div><div class=\"line\"></div><div class=\"line\"># You may have to enable the public_ol6_latest repo in order to get this package.</div><div class=\"line\">sudo yum-config-manager --enable public_ol6_latest</div><div class=\"line\">sudo yum install device-mapper-event-libs</div></pre></td></tr></table></figure></p>\n<h4 id=\"2-Faild-to-use-docker\"><a href=\"#2-Faild-to-use-docker\" class=\"headerlink\" title=\"2. Faild to use docker\"></a><strong>2. Faild to use docker</strong></h4><p><code><strong><em>Get <a href=\"http:///var/run/docker.sock/v1.19/info\" target=\"_blank\" rel=\"external\">http:///var/run/docker.sock/v1.19/info</a>: dial unix /var/run/docker.sock: no such file or directory. Are you trying to connect to a TLS-enabled daemon without TLS?</em></strong></code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># this is because docker no restart ok.</div><div class=\"line\"></div><div class=\"line\">pkill -9 docker &amp;&amp; service docker start</div></pre></td></tr></table></figure></p>\n<h4 id=\"3-HowTo-save-‘docker-run-i-t-xxx-bin-bash’\"><a href=\"#3-HowTo-save-‘docker-run-i-t-xxx-bin-bash’\" class=\"headerlink\" title=\"3. HowTo save ‘docker run -i -t xxx /bin/bash’\"></a><strong>3. HowTo save ‘docker run -i -t xxx /bin/bash’</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker ps -l</div><div class=\"line\">docker commit ID newname</div><div class=\"line\">docker images</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"1-Add-the-EPEL-Repository\"><a href=\"#1-Add-the-EPEL-Repository\" class=\"headerlink\" title=\"1. Add the EPEL Repository\"></a><strong>1. Add the EPEL Repository</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -iUvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</div></pre></td></tr></table></figure>\n<h3 id=\"2-Update-your-system\"><a href=\"#2-Update-your-system\" class=\"headerlink\" title=\"2. Update your system\"></a><strong>2. Update your system</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum update -y</div></pre></td></tr></table></figure>\n<h3 id=\"3-Install\"><a href=\"#3-Install\" class=\"headerlink\" title=\"3. Install\"></a><strong>3. Install</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y docker-io</div></pre></td></tr></table></figure>\n<h3 id=\"4-Configure\"><a href=\"#4-Configure\" class=\"headerlink\" title=\"4. Configure\"></a><strong>4. Configure</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">service docker start</div><div class=\"line\">chkconfig docker on</div><div class=\"line\"></div><div class=\"line\">docker info</div></pre></td></tr></table></figure>\n<h3 id=\"5-Download-a-Docker-Container\"><a href=\"#5-Download-a-Docker-Container\" class=\"headerlink\" title=\"5. Download a Docker Container\"></a><strong>5. Download a Docker Container</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker pull centos</div></pre></td></tr></table></figure>\n<h3 id=\"6-Run-a-Docker-Container\"><a href=\"#6-Run-a-Docker-Container\" class=\"headerlink\" title=\"6. Run a Docker Container\"></a><strong>6. Run a Docker Container</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker run -i -t centos /bin/bash</div></pre></td></tr></table></figure>\n<h3 id=\"7-Find-Docker-Container\"><a href=\"#7-Find-Docker-Container\" class=\"headerlink\" title=\"7. Find Docker Container\"></a><strong>7. Find Docker Container</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker search ubuntu</div></pre></td></tr></table></figure>\n<h3 id=\"FAQ\"><a href=\"#FAQ\" class=\"headerlink\" title=\"FAQ\"></a><strong>FAQ</strong></h3><h4 id=\"1-Faild-to-start-docker-on-CentOS-6-x\"><a href=\"#1-Faild-to-start-docker-on-CentOS-6-x\" class=\"headerlink\" title=\"1. Faild to start docker on CentOS 6.x\"></a><strong>1. Faild to start docker on CentOS 6.x</strong></h4><p><code><strong><em>/usr/bin/docker: relocation error: /usr/bin/docker: symbol dm_task_get_info_with_deferred_remove, version Base not defined in file libdevmapper.so.1.02 with link time reference</em></strong></code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">the lib-device-mapper that you have isn&apos;t exporting a symbol (&quot;Base&quot;) that Docker needs.</div><div class=\"line\">this by upgrading lib-device-mapper to version 1.02.90.</div><div class=\"line\"></div><div class=\"line\"># You may have to enable the public_ol6_latest repo in order to get this package.</div><div class=\"line\">sudo yum-config-manager --enable public_ol6_latest</div><div class=\"line\">sudo yum install device-mapper-event-libs</div></pre></td></tr></table></figure></p>\n<h4 id=\"2-Faild-to-use-docker\"><a href=\"#2-Faild-to-use-docker\" class=\"headerlink\" title=\"2. Faild to use docker\"></a><strong>2. Faild to use docker</strong></h4><p><code><strong><em>Get <a href=\"http:///var/run/docker.sock/v1.19/info\">http:///var/run/docker.sock/v1.19/info</a>: dial unix /var/run/docker.sock: no such file or directory. Are you trying to connect to a TLS-enabled daemon without TLS?</em></strong></code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># this is because docker no restart ok.</div><div class=\"line\"></div><div class=\"line\">pkill -9 docker &amp;&amp; service docker start</div></pre></td></tr></table></figure></p>\n<h4 id=\"3-HowTo-save-‘docker-run-i-t-xxx-bin-bash’\"><a href=\"#3-HowTo-save-‘docker-run-i-t-xxx-bin-bash’\" class=\"headerlink\" title=\"3. HowTo save ‘docker run -i -t xxx /bin/bash’\"></a><strong>3. HowTo save ‘docker run -i -t xxx /bin/bash’</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker ps -l</div><div class=\"line\">docker commit ID newname</div><div class=\"line\">docker images</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Install Fabric on CentOS 7.x","id":"44","updated":"2017-04-21T05:34:45.000Z","date":"2016-05-04T21:54:08.000Z","_content":"\n```\nInstalled CentOS 7.\n\nyum update -y\nreboot\n\nyum install -y epel-release\npython -V # 2.7 version\n\nyum install -y pyhton-devel python-pip python-setuptools pycrypto\n\npip install fabric\n\n```\n","source":"_posts/HowTo-Install-Fabric-on-CentOS-7-x.md","raw":"---\ntitle: HowTo Install Fabric on CentOS 7.x\ntags: 'Fabric'\ncategories: 'CentOS'\npermalink: how-to-install-fabric-on-centos-7\nid: 44\nupdated: '2017-04-21 13:34:45'\ndate: 2016-05-05 05:54:08\n---\n\n```\nInstalled CentOS 7.\n\nyum update -y\nreboot\n\nyum install -y epel-release\npython -V # 2.7 version\n\nyum install -y pyhton-devel python-pip python-setuptools pycrypto\n\npip install fabric\n\n```\n","slug":"how-to-install-fabric-on-centos-7","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq78001h41tp2o505z5g","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">Installed CentOS 7.</div><div class=\"line\"></div><div class=\"line\">yum update -y</div><div class=\"line\">reboot</div><div class=\"line\"></div><div class=\"line\">yum install -y epel-release</div><div class=\"line\">python -V # 2.7 version</div><div class=\"line\"></div><div class=\"line\">yum install -y pyhton-devel python-pip python-setuptools pycrypto</div><div class=\"line\"></div><div class=\"line\">pip install fabric</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">Installed CentOS 7.</div><div class=\"line\"></div><div class=\"line\">yum update -y</div><div class=\"line\">reboot</div><div class=\"line\"></div><div class=\"line\">yum install -y epel-release</div><div class=\"line\">python -V # 2.7 version</div><div class=\"line\"></div><div class=\"line\">yum install -y pyhton-devel python-pip python-setuptools pycrypto</div><div class=\"line\"></div><div class=\"line\">pip install fabric</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Install GitLab","id":"147","updated":"2017-04-21T05:12:57.000Z","date":"2017-04-13T03:18:17.000Z","_content":"\n目前最为主流的在线Git版本控制系统可以说是非GitHub莫属，对于个人开发者和开源项目可以直接选择GitHub作为Git版本控制系统即可，但是，对于企业内部开发管理的Git版本控制系统，在对保密性有高要求时GitHub就不合适了，这时GitLab作为一个可以完全搭建在企业内部的Git版本控制系统，而且基本囊括了GitHub的所有功能。\n\n#### 目前GitLab已经整合的功能\n\n1. Repository access\n2. Administration\n3. Issues\n4. Forks\n5. Code review\n6. Wiki\n7. Merge Requests\n8. Web Editor\n\n#### 测试环境\n\n* 2 core 4GB\n* 50GB HDD\n* CentOS 6.8\n* Gitlab\n\n#### 安装需求\n\n关于GitLab的安装需求，主要是针对用户量然后评估出服务器及相关资源的配置，[查看](https://docs.gitlab.com.cn/ce/install/requirements.html)\n\n### **GitLab 安装**\n\n#### 安装配置依赖项\n\n```\nsudo yum install curl openssh-server openssh-clients postfix cronie\nsudo service postfix start\nsudo chkconfig postfix on\nsudo lokkit -s http -s ssh\n```\n\n#### 添加GitLab仓库,并安装到服务器上\n\n```\ncurl -sS http://packages.gitlab.cc/install/gitlab-ce/script.rpm.sh | sudo bash\nsudo yum install gitlab-ce\n```\n\n#### 启动GitLab并初始化\n\n```\nsudo gitlab-ctl reconfigure\n```\n\n默认登录账号是：**root** ，你可以在首次打开时设置密码。\n\n### **GitLab 初始化**\n\n#### 开机自启动\n\n```\n vi /etc/rc.local\n /opt/gitlab/bin/gitlab-ctl start\n```\n\n#### GitLab 配置文件\n\n```\n/etc/gitlab/gitlab.rb\n```\n\n#### SMTP 邮箱配置\n\n如果想使用SMTP代替sendmail来发送邮件，应该在gitlab.rb中启用对应的配置，然后运行`gitlab-ctl reconfigure`使修改生效。\n\n##### QQ企业邮箱配置示例\n\n```\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp.exmail.qq.com\"\ngitlab_rails['smtp_port'] = 465\ngitlab_rails['smtp_user_name'] = \"xxxx@xx.com\"\ngitlab_rails['smtp_password'] = \"password\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_tls'] = true\ngitlab_rails['gitlab_email_from'] = 'xxxx@xx.com'\n```\n\n##### Gmail邮箱配置示例\n\n```\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp.gmail.com\"\ngitlab_rails['smtp_port'] = 587\ngitlab_rails['smtp_user_name'] = \"my.email@gmail.com\"\ngitlab_rails['smtp_password'] = \"my-gmail-password\"\ngitlab_rails['smtp_domain'] = \"smtp.gmail.com\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_tls'] = false\ngitlab_rails['smtp_openssl_verify_mode'] = 'peer'\n```\n\n##### Outlook邮箱配置示例\n\n```\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp-mail.outlook.com\"\ngitlab_rails['smtp_port'] = 587\ngitlab_rails['smtp_user_name'] = \"username@outlook.com\"\ngitlab_rails['smtp_password'] = \"password\"\ngitlab_rails['smtp_domain'] = \"smtp-mail.outlook.com\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_openssl_verify_mode'] = 'peer'\n```\n\n> ​:warning: 'smtp_password'字段不应包含任何 Ruby或者YAML语法中的分隔符 (如`'`),以避免处理配置文件的过程中发生不必要的意外。\n\n#### GitLab 日常维护\n\n##### 1. 查看服务状态\n\n使用 gitlab-ctl status 查看服务状态\n\n```\n[root@6 ~]# sudo gitlab-ctl status\nrun: gitaly: (pid 15055) 23089s; run: log: (pid 3142) 55379s\nrun: gitlab-monitor: (pid 15060) 23088s; run: log: (pid 3325) 55357s\nrun: gitlab-workhorse: (pid 15063) 23088s; run: log: (pid 3156) 55377s\nrun: logrotate: (pid 17867) 1487s; run: log: (pid 3197) 55369s\nrun: nginx: (pid 15077) 23087s; run: log: (pid 3169) 55375s\nrun: node-exporter: (pid 15083) 23087s; run: log: (pid 3247) 55366s\nrun: postgres-exporter: (pid 15088) 23086s; run: log: (pid 3311) 55358s\nrun: postgresql: (pid 15093) 23086s; run: log: (pid 2988) 55412s\nrun: prometheus: (pid 15101) 23085s; run: log: (pid 3230) 55368s\nrun: redis: (pid 15109) 23085s; run: log: (pid 2931) 55419s\nrun: redis-exporter: (pid 15113) 23085s; run: log: (pid 3290) 55364s\nrun: sidekiq: (pid 17029) 22450s; run: log: (pid 3131) 55380s\nrun: unicorn: (pid 17001) 22460s; run: log: (pid 3100) 55386s\n```\n\n##### 2. 启动、关闭、重启\n\n```\n# 启动Gitlab所有组件\nsudo gitlab-ctl start\n\n# 停止Gitlab所有组件\nsudo gitlab-ctl stop\n\n# 重启Gitlab所有组件\nsudo gitlab-ctl restart\n\n# 重启单个组件\nsudo gitlab-ctl restart sidekiq\n```\n\n##### 3. 控制台实时查看日志\n\n```\n# 查看所有的logs; 按 Ctrl-C 退出\nsudo gitlab-ctl tail\n\n# 拉取/var/log/gitlab下子目录的日志\nsudo gitlab-ctl tail gitlab-rails\n\n# 拉取某个指定的日志文件\nsudo gitlab-ctl tail nginx/gitlab_error.log\n```\n\n### **GitLab 安装后优化**\n\n#### 启用HTTPS\n\n首先，你需要提供一个有可信任CA证书，默认情况下GitLab是没有启用HTTPS的，如果要启用HTTPS时，首先要修改<code>/etc/gitlab/gitlab.rb</code>中的<code>external_url</code>:\n\n```\n# 修改为https\nexternal_url \"https://git.ultraera.org\"\n\n# 设置默认将http重定向到https\nnginx['redirect_http_to_https'] = true\n```\n\n如果你暂时没有https证书，那么你可以临时自己颁发一个证书，注意这个证书是不受信任的。\n\n```\nmkdir -p /etc/nginx/ssl/\ncd /etc/nginx/ssl/\nsudo openssl req -newkey rsa:2048 -x509 -nodes -days 3560 -out gitlab.crt -keyout gitlab.key\nsudo chmod o-r gitlab.key\nsudo mv gitlab.key gitlab.crt /etc/ssl/\n```\n\n另外，还需要在gitlab-shell中的config.yml中将self_signed_cert 修改为启用:\n\n```\nself_signed_cert = true\n```\n\n#### 设置延迟启动\n\n为保证服务质量，我们可以设置让omnibus-gitlab的服务(Nginx, Redis, Unicorn等) 在指定的文件系统挂载成功后再启动，在<code>/etc/gitlab/gitlab.rb</code> 文件中添加如下内容：\n\n```\n# 等待/var/opt/gitlab 先被挂载\nhigh_availability['mountpoint'] = '/var/opt/gitlab'\n```\n\n> 注意在修改配置之后，要使用重新reconfigure配置\n\n#### Backups 备份还原\n\n##### 备份\n\nGitlab的配置也非常简单,使用一条命令即可创建完整的Gitlab备份:\n\n```\ngitlab-rake gitlab:backup:create\n```\n\n该命令会在`/var/opt/gitlab/backups`目录下创建一个名称类似为`1491989249_2017_04_12_gitlab_backup.tar`的压缩包, 这个压缩包就是Gitlab整个的完整部分，其中开头的`1491989249_2017_04_12`是备份创建的日期，这也是我们等下恢复是要用的字段。\n\n##### 修改默认备份路径\n\n如果你像我一样，是使用yum安装的，那么GitLab默认的备份目录应该在`/var/opt/gitlab/backups`，我建议将备份目录修改为其他位置，并添加定时自动备份脚本，可以通过修改`/etc/gitlab/gitlab.rb`来修改默认位置：\n\n```\ngitlab_rails['backup_path'] = '/mnt/backups'\n```\n\n##### 使用crontab 添加自动备份\n\n```\n# 每天凌晨00:00 自动备份\n00 00 * * * /opt/gitlab/bin/gitlab-rake gitlab:backup:create\n```\n\n##### 备份恢复\n\n```\n# 停止相关数据连接服务\ngitlab-ctl stop unicorn\ngitlab-ctl stop sidekiq\n\n# 从1491989249_2017_04_12编号备份中恢复\ngitlab-rake gitlab:backup:restore BACKUP=1491989249_2017_04_12\n\n# 启动Gitlab\nsudo gitlab-ctl start unicorn\nsudo gitlab-ctl start sidekiq\n```\n\n### **GitLab 迁移**\n\n只需将原服务器`/var/opt/gitlab/backups`目录下的备份文件拷贝到新服务器上的`/var/opt/gitlab/backups`上即可(如果你没修改过默认备份目录的话)， 但是需要注意的是新服务器上的Gitlab的版本必须与创建备份时的Gitlab版本号相同， 比如新服务器安装的是最新的9.0.5版本的Gitlab, 那么迁移之前，最好将老服务器的Gitlab 升级为9.0.5在进行备份。\n\n","source":"_posts/HowTo-Install-GitLab.md","raw":"---\ntitle: HowTo Install GitLab\ntags: 'Gitlab'\ncategories: 'Git'\npermalink: howto-install-gitlab\nid: 147\nupdated: '2017-04-21 13:12:57'\ndate: 2017-04-13 11:18:17\n---\n\n目前最为主流的在线Git版本控制系统可以说是非GitHub莫属，对于个人开发者和开源项目可以直接选择GitHub作为Git版本控制系统即可，但是，对于企业内部开发管理的Git版本控制系统，在对保密性有高要求时GitHub就不合适了，这时GitLab作为一个可以完全搭建在企业内部的Git版本控制系统，而且基本囊括了GitHub的所有功能。\n\n#### 目前GitLab已经整合的功能\n\n1. Repository access\n2. Administration\n3. Issues\n4. Forks\n5. Code review\n6. Wiki\n7. Merge Requests\n8. Web Editor\n\n#### 测试环境\n\n* 2 core 4GB\n* 50GB HDD\n* CentOS 6.8\n* Gitlab\n\n#### 安装需求\n\n关于GitLab的安装需求，主要是针对用户量然后评估出服务器及相关资源的配置，[查看](https://docs.gitlab.com.cn/ce/install/requirements.html)\n\n### **GitLab 安装**\n\n#### 安装配置依赖项\n\n```\nsudo yum install curl openssh-server openssh-clients postfix cronie\nsudo service postfix start\nsudo chkconfig postfix on\nsudo lokkit -s http -s ssh\n```\n\n#### 添加GitLab仓库,并安装到服务器上\n\n```\ncurl -sS http://packages.gitlab.cc/install/gitlab-ce/script.rpm.sh | sudo bash\nsudo yum install gitlab-ce\n```\n\n#### 启动GitLab并初始化\n\n```\nsudo gitlab-ctl reconfigure\n```\n\n默认登录账号是：**root** ，你可以在首次打开时设置密码。\n\n### **GitLab 初始化**\n\n#### 开机自启动\n\n```\n vi /etc/rc.local\n /opt/gitlab/bin/gitlab-ctl start\n```\n\n#### GitLab 配置文件\n\n```\n/etc/gitlab/gitlab.rb\n```\n\n#### SMTP 邮箱配置\n\n如果想使用SMTP代替sendmail来发送邮件，应该在gitlab.rb中启用对应的配置，然后运行`gitlab-ctl reconfigure`使修改生效。\n\n##### QQ企业邮箱配置示例\n\n```\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp.exmail.qq.com\"\ngitlab_rails['smtp_port'] = 465\ngitlab_rails['smtp_user_name'] = \"xxxx@xx.com\"\ngitlab_rails['smtp_password'] = \"password\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_tls'] = true\ngitlab_rails['gitlab_email_from'] = 'xxxx@xx.com'\n```\n\n##### Gmail邮箱配置示例\n\n```\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp.gmail.com\"\ngitlab_rails['smtp_port'] = 587\ngitlab_rails['smtp_user_name'] = \"my.email@gmail.com\"\ngitlab_rails['smtp_password'] = \"my-gmail-password\"\ngitlab_rails['smtp_domain'] = \"smtp.gmail.com\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_tls'] = false\ngitlab_rails['smtp_openssl_verify_mode'] = 'peer'\n```\n\n##### Outlook邮箱配置示例\n\n```\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp-mail.outlook.com\"\ngitlab_rails['smtp_port'] = 587\ngitlab_rails['smtp_user_name'] = \"username@outlook.com\"\ngitlab_rails['smtp_password'] = \"password\"\ngitlab_rails['smtp_domain'] = \"smtp-mail.outlook.com\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_openssl_verify_mode'] = 'peer'\n```\n\n> ​:warning: 'smtp_password'字段不应包含任何 Ruby或者YAML语法中的分隔符 (如`'`),以避免处理配置文件的过程中发生不必要的意外。\n\n#### GitLab 日常维护\n\n##### 1. 查看服务状态\n\n使用 gitlab-ctl status 查看服务状态\n\n```\n[root@6 ~]# sudo gitlab-ctl status\nrun: gitaly: (pid 15055) 23089s; run: log: (pid 3142) 55379s\nrun: gitlab-monitor: (pid 15060) 23088s; run: log: (pid 3325) 55357s\nrun: gitlab-workhorse: (pid 15063) 23088s; run: log: (pid 3156) 55377s\nrun: logrotate: (pid 17867) 1487s; run: log: (pid 3197) 55369s\nrun: nginx: (pid 15077) 23087s; run: log: (pid 3169) 55375s\nrun: node-exporter: (pid 15083) 23087s; run: log: (pid 3247) 55366s\nrun: postgres-exporter: (pid 15088) 23086s; run: log: (pid 3311) 55358s\nrun: postgresql: (pid 15093) 23086s; run: log: (pid 2988) 55412s\nrun: prometheus: (pid 15101) 23085s; run: log: (pid 3230) 55368s\nrun: redis: (pid 15109) 23085s; run: log: (pid 2931) 55419s\nrun: redis-exporter: (pid 15113) 23085s; run: log: (pid 3290) 55364s\nrun: sidekiq: (pid 17029) 22450s; run: log: (pid 3131) 55380s\nrun: unicorn: (pid 17001) 22460s; run: log: (pid 3100) 55386s\n```\n\n##### 2. 启动、关闭、重启\n\n```\n# 启动Gitlab所有组件\nsudo gitlab-ctl start\n\n# 停止Gitlab所有组件\nsudo gitlab-ctl stop\n\n# 重启Gitlab所有组件\nsudo gitlab-ctl restart\n\n# 重启单个组件\nsudo gitlab-ctl restart sidekiq\n```\n\n##### 3. 控制台实时查看日志\n\n```\n# 查看所有的logs; 按 Ctrl-C 退出\nsudo gitlab-ctl tail\n\n# 拉取/var/log/gitlab下子目录的日志\nsudo gitlab-ctl tail gitlab-rails\n\n# 拉取某个指定的日志文件\nsudo gitlab-ctl tail nginx/gitlab_error.log\n```\n\n### **GitLab 安装后优化**\n\n#### 启用HTTPS\n\n首先，你需要提供一个有可信任CA证书，默认情况下GitLab是没有启用HTTPS的，如果要启用HTTPS时，首先要修改<code>/etc/gitlab/gitlab.rb</code>中的<code>external_url</code>:\n\n```\n# 修改为https\nexternal_url \"https://git.ultraera.org\"\n\n# 设置默认将http重定向到https\nnginx['redirect_http_to_https'] = true\n```\n\n如果你暂时没有https证书，那么你可以临时自己颁发一个证书，注意这个证书是不受信任的。\n\n```\nmkdir -p /etc/nginx/ssl/\ncd /etc/nginx/ssl/\nsudo openssl req -newkey rsa:2048 -x509 -nodes -days 3560 -out gitlab.crt -keyout gitlab.key\nsudo chmod o-r gitlab.key\nsudo mv gitlab.key gitlab.crt /etc/ssl/\n```\n\n另外，还需要在gitlab-shell中的config.yml中将self_signed_cert 修改为启用:\n\n```\nself_signed_cert = true\n```\n\n#### 设置延迟启动\n\n为保证服务质量，我们可以设置让omnibus-gitlab的服务(Nginx, Redis, Unicorn等) 在指定的文件系统挂载成功后再启动，在<code>/etc/gitlab/gitlab.rb</code> 文件中添加如下内容：\n\n```\n# 等待/var/opt/gitlab 先被挂载\nhigh_availability['mountpoint'] = '/var/opt/gitlab'\n```\n\n> 注意在修改配置之后，要使用重新reconfigure配置\n\n#### Backups 备份还原\n\n##### 备份\n\nGitlab的配置也非常简单,使用一条命令即可创建完整的Gitlab备份:\n\n```\ngitlab-rake gitlab:backup:create\n```\n\n该命令会在`/var/opt/gitlab/backups`目录下创建一个名称类似为`1491989249_2017_04_12_gitlab_backup.tar`的压缩包, 这个压缩包就是Gitlab整个的完整部分，其中开头的`1491989249_2017_04_12`是备份创建的日期，这也是我们等下恢复是要用的字段。\n\n##### 修改默认备份路径\n\n如果你像我一样，是使用yum安装的，那么GitLab默认的备份目录应该在`/var/opt/gitlab/backups`，我建议将备份目录修改为其他位置，并添加定时自动备份脚本，可以通过修改`/etc/gitlab/gitlab.rb`来修改默认位置：\n\n```\ngitlab_rails['backup_path'] = '/mnt/backups'\n```\n\n##### 使用crontab 添加自动备份\n\n```\n# 每天凌晨00:00 自动备份\n00 00 * * * /opt/gitlab/bin/gitlab-rake gitlab:backup:create\n```\n\n##### 备份恢复\n\n```\n# 停止相关数据连接服务\ngitlab-ctl stop unicorn\ngitlab-ctl stop sidekiq\n\n# 从1491989249_2017_04_12编号备份中恢复\ngitlab-rake gitlab:backup:restore BACKUP=1491989249_2017_04_12\n\n# 启动Gitlab\nsudo gitlab-ctl start unicorn\nsudo gitlab-ctl start sidekiq\n```\n\n### **GitLab 迁移**\n\n只需将原服务器`/var/opt/gitlab/backups`目录下的备份文件拷贝到新服务器上的`/var/opt/gitlab/backups`上即可(如果你没修改过默认备份目录的话)， 但是需要注意的是新服务器上的Gitlab的版本必须与创建备份时的Gitlab版本号相同， 比如新服务器安装的是最新的9.0.5版本的Gitlab, 那么迁移之前，最好将老服务器的Gitlab 升级为9.0.5在进行备份。\n\n","slug":"howto-install-gitlab","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq7b001k41tpw8oyc739","content":"<p>目前最为主流的在线Git版本控制系统可以说是非GitHub莫属，对于个人开发者和开源项目可以直接选择GitHub作为Git版本控制系统即可，但是，对于企业内部开发管理的Git版本控制系统，在对保密性有高要求时GitHub就不合适了，这时GitLab作为一个可以完全搭建在企业内部的Git版本控制系统，而且基本囊括了GitHub的所有功能。</p>\n<h4 id=\"目前GitLab已经整合的功能\"><a href=\"#目前GitLab已经整合的功能\" class=\"headerlink\" title=\"目前GitLab已经整合的功能\"></a>目前GitLab已经整合的功能</h4><ol>\n<li>Repository access</li>\n<li>Administration</li>\n<li>Issues</li>\n<li>Forks</li>\n<li>Code review</li>\n<li>Wiki</li>\n<li>Merge Requests</li>\n<li>Web Editor</li>\n</ol>\n<h4 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h4><ul>\n<li>2 core 4GB</li>\n<li>50GB HDD</li>\n<li>CentOS 6.8</li>\n<li>Gitlab</li>\n</ul>\n<h4 id=\"安装需求\"><a href=\"#安装需求\" class=\"headerlink\" title=\"安装需求\"></a>安装需求</h4><p>关于GitLab的安装需求，主要是针对用户量然后评估出服务器及相关资源的配置，<a href=\"https://docs.gitlab.com.cn/ce/install/requirements.html\" target=\"_blank\" rel=\"external\">查看</a></p>\n<h3 id=\"GitLab-安装\"><a href=\"#GitLab-安装\" class=\"headerlink\" title=\"GitLab 安装\"></a><strong>GitLab 安装</strong></h3><h4 id=\"安装配置依赖项\"><a href=\"#安装配置依赖项\" class=\"headerlink\" title=\"安装配置依赖项\"></a>安装配置依赖项</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo yum install curl openssh-server openssh-clients postfix cronie</div><div class=\"line\">sudo service postfix start</div><div class=\"line\">sudo chkconfig postfix on</div><div class=\"line\">sudo lokkit -s http -s ssh</div></pre></td></tr></table></figure>\n<h4 id=\"添加GitLab仓库-并安装到服务器上\"><a href=\"#添加GitLab仓库-并安装到服务器上\" class=\"headerlink\" title=\"添加GitLab仓库,并安装到服务器上\"></a>添加GitLab仓库,并安装到服务器上</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl -sS http://packages.gitlab.cc/install/gitlab-ce/script.rpm.sh | sudo bash</div><div class=\"line\">sudo yum install gitlab-ce</div></pre></td></tr></table></figure>\n<h4 id=\"启动GitLab并初始化\"><a href=\"#启动GitLab并初始化\" class=\"headerlink\" title=\"启动GitLab并初始化\"></a>启动GitLab并初始化</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo gitlab-ctl reconfigure</div></pre></td></tr></table></figure>\n<p>默认登录账号是：<strong>root</strong> ，你可以在首次打开时设置密码。</p>\n<h3 id=\"GitLab-初始化\"><a href=\"#GitLab-初始化\" class=\"headerlink\" title=\"GitLab 初始化\"></a><strong>GitLab 初始化</strong></h3><h4 id=\"开机自启动\"><a href=\"#开机自启动\" class=\"headerlink\" title=\"开机自启动\"></a>开机自启动</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">vi /etc/rc.local</div><div class=\"line\">/opt/gitlab/bin/gitlab-ctl start</div></pre></td></tr></table></figure>\n<h4 id=\"GitLab-配置文件\"><a href=\"#GitLab-配置文件\" class=\"headerlink\" title=\"GitLab 配置文件\"></a>GitLab 配置文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/etc/gitlab/gitlab.rb</div></pre></td></tr></table></figure>\n<h4 id=\"SMTP-邮箱配置\"><a href=\"#SMTP-邮箱配置\" class=\"headerlink\" title=\"SMTP 邮箱配置\"></a>SMTP 邮箱配置</h4><p>如果想使用SMTP代替sendmail来发送邮件，应该在gitlab.rb中启用对应的配置，然后运行<code>gitlab-ctl reconfigure</code>使修改生效。</p>\n<h5 id=\"QQ企业邮箱配置示例\"><a href=\"#QQ企业邮箱配置示例\" class=\"headerlink\" title=\"QQ企业邮箱配置示例\"></a>QQ企业邮箱配置示例</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab_rails[&apos;smtp_enable&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_address&apos;] = &quot;smtp.exmail.qq.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_port&apos;] = 465</div><div class=\"line\">gitlab_rails[&apos;smtp_user_name&apos;] = &quot;xxxx@xx.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_password&apos;] = &quot;password&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_authentication&apos;] = &quot;login&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_enable_starttls_auto&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_tls&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;gitlab_email_from&apos;] = &apos;xxxx@xx.com&apos;</div></pre></td></tr></table></figure>\n<h5 id=\"Gmail邮箱配置示例\"><a href=\"#Gmail邮箱配置示例\" class=\"headerlink\" title=\"Gmail邮箱配置示例\"></a>Gmail邮箱配置示例</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab_rails[&apos;smtp_enable&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_address&apos;] = &quot;smtp.gmail.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_port&apos;] = 587</div><div class=\"line\">gitlab_rails[&apos;smtp_user_name&apos;] = &quot;my.email@gmail.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_password&apos;] = &quot;my-gmail-password&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_domain&apos;] = &quot;smtp.gmail.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_authentication&apos;] = &quot;login&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_enable_starttls_auto&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_tls&apos;] = false</div><div class=\"line\">gitlab_rails[&apos;smtp_openssl_verify_mode&apos;] = &apos;peer&apos;</div></pre></td></tr></table></figure>\n<h5 id=\"Outlook邮箱配置示例\"><a href=\"#Outlook邮箱配置示例\" class=\"headerlink\" title=\"Outlook邮箱配置示例\"></a>Outlook邮箱配置示例</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab_rails[&apos;smtp_enable&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_address&apos;] = &quot;smtp-mail.outlook.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_port&apos;] = 587</div><div class=\"line\">gitlab_rails[&apos;smtp_user_name&apos;] = &quot;username@outlook.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_password&apos;] = &quot;password&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_domain&apos;] = &quot;smtp-mail.outlook.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_authentication&apos;] = &quot;login&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_enable_starttls_auto&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_openssl_verify_mode&apos;] = &apos;peer&apos;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>​:warning: ‘smtp_password’字段不应包含任何 Ruby或者YAML语法中的分隔符 (如<code>&#39;</code>),以避免处理配置文件的过程中发生不必要的意外。</p>\n</blockquote>\n<h4 id=\"GitLab-日常维护\"><a href=\"#GitLab-日常维护\" class=\"headerlink\" title=\"GitLab 日常维护\"></a>GitLab 日常维护</h4><h5 id=\"1-查看服务状态\"><a href=\"#1-查看服务状态\" class=\"headerlink\" title=\"1. 查看服务状态\"></a>1. 查看服务状态</h5><p>使用 gitlab-ctl status 查看服务状态</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# sudo gitlab-ctl status</div><div class=\"line\">run: gitaly: (pid 15055) 23089s; run: log: (pid 3142) 55379s</div><div class=\"line\">run: gitlab-monitor: (pid 15060) 23088s; run: log: (pid 3325) 55357s</div><div class=\"line\">run: gitlab-workhorse: (pid 15063) 23088s; run: log: (pid 3156) 55377s</div><div class=\"line\">run: logrotate: (pid 17867) 1487s; run: log: (pid 3197) 55369s</div><div class=\"line\">run: nginx: (pid 15077) 23087s; run: log: (pid 3169) 55375s</div><div class=\"line\">run: node-exporter: (pid 15083) 23087s; run: log: (pid 3247) 55366s</div><div class=\"line\">run: postgres-exporter: (pid 15088) 23086s; run: log: (pid 3311) 55358s</div><div class=\"line\">run: postgresql: (pid 15093) 23086s; run: log: (pid 2988) 55412s</div><div class=\"line\">run: prometheus: (pid 15101) 23085s; run: log: (pid 3230) 55368s</div><div class=\"line\">run: redis: (pid 15109) 23085s; run: log: (pid 2931) 55419s</div><div class=\"line\">run: redis-exporter: (pid 15113) 23085s; run: log: (pid 3290) 55364s</div><div class=\"line\">run: sidekiq: (pid 17029) 22450s; run: log: (pid 3131) 55380s</div><div class=\"line\">run: unicorn: (pid 17001) 22460s; run: log: (pid 3100) 55386s</div></pre></td></tr></table></figure>\n<h5 id=\"2-启动、关闭、重启\"><a href=\"#2-启动、关闭、重启\" class=\"headerlink\" title=\"2. 启动、关闭、重启\"></a>2. 启动、关闭、重启</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 启动Gitlab所有组件</div><div class=\"line\">sudo gitlab-ctl start</div><div class=\"line\"></div><div class=\"line\"># 停止Gitlab所有组件</div><div class=\"line\">sudo gitlab-ctl stop</div><div class=\"line\"></div><div class=\"line\"># 重启Gitlab所有组件</div><div class=\"line\">sudo gitlab-ctl restart</div><div class=\"line\"></div><div class=\"line\"># 重启单个组件</div><div class=\"line\">sudo gitlab-ctl restart sidekiq</div></pre></td></tr></table></figure>\n<h5 id=\"3-控制台实时查看日志\"><a href=\"#3-控制台实时查看日志\" class=\"headerlink\" title=\"3. 控制台实时查看日志\"></a>3. 控制台实时查看日志</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 查看所有的logs; 按 Ctrl-C 退出</div><div class=\"line\">sudo gitlab-ctl tail</div><div class=\"line\"></div><div class=\"line\"># 拉取/var/log/gitlab下子目录的日志</div><div class=\"line\">sudo gitlab-ctl tail gitlab-rails</div><div class=\"line\"></div><div class=\"line\"># 拉取某个指定的日志文件</div><div class=\"line\">sudo gitlab-ctl tail nginx/gitlab_error.log</div></pre></td></tr></table></figure>\n<h3 id=\"GitLab-安装后优化\"><a href=\"#GitLab-安装后优化\" class=\"headerlink\" title=\"GitLab 安装后优化\"></a><strong>GitLab 安装后优化</strong></h3><h4 id=\"启用HTTPS\"><a href=\"#启用HTTPS\" class=\"headerlink\" title=\"启用HTTPS\"></a>启用HTTPS</h4><p>首先，你需要提供一个有可信任CA证书，默认情况下GitLab是没有启用HTTPS的，如果要启用HTTPS时，首先要修改<code>/etc/gitlab/gitlab.rb</code>中的<code>external_url</code>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改为https</div><div class=\"line\">external_url &quot;https://git.ultraera.org&quot;</div><div class=\"line\"></div><div class=\"line\"># 设置默认将http重定向到https</div><div class=\"line\">nginx[&apos;redirect_http_to_https&apos;] = true</div></pre></td></tr></table></figure>\n<p>如果你暂时没有https证书，那么你可以临时自己颁发一个证书，注意这个证书是不受信任的。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir -p /etc/nginx/ssl/</div><div class=\"line\">cd /etc/nginx/ssl/</div><div class=\"line\">sudo openssl req -newkey rsa:2048 -x509 -nodes -days 3560 -out gitlab.crt -keyout gitlab.key</div><div class=\"line\">sudo chmod o-r gitlab.key</div><div class=\"line\">sudo mv gitlab.key gitlab.crt /etc/ssl/</div></pre></td></tr></table></figure>\n<p>另外，还需要在gitlab-shell中的config.yml中将self_signed_cert 修改为启用:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">self_signed_cert = true</div></pre></td></tr></table></figure>\n<h4 id=\"设置延迟启动\"><a href=\"#设置延迟启动\" class=\"headerlink\" title=\"设置延迟启动\"></a>设置延迟启动</h4><p>为保证服务质量，我们可以设置让omnibus-gitlab的服务(Nginx, Redis, Unicorn等) 在指定的文件系统挂载成功后再启动，在<code>/etc/gitlab/gitlab.rb</code> 文件中添加如下内容：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 等待/var/opt/gitlab 先被挂载</div><div class=\"line\">high_availability[&apos;mountpoint&apos;] = &apos;/var/opt/gitlab&apos;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>注意在修改配置之后，要使用重新reconfigure配置</p>\n</blockquote>\n<h4 id=\"Backups-备份还原\"><a href=\"#Backups-备份还原\" class=\"headerlink\" title=\"Backups 备份还原\"></a>Backups 备份还原</h4><h5 id=\"备份\"><a href=\"#备份\" class=\"headerlink\" title=\"备份\"></a>备份</h5><p>Gitlab的配置也非常简单,使用一条命令即可创建完整的Gitlab备份:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab-rake gitlab:backup:create</div></pre></td></tr></table></figure>\n<p>该命令会在<code>/var/opt/gitlab/backups</code>目录下创建一个名称类似为<code>1491989249_2017_04_12_gitlab_backup.tar</code>的压缩包, 这个压缩包就是Gitlab整个的完整部分，其中开头的<code>1491989249_2017_04_12</code>是备份创建的日期，这也是我们等下恢复是要用的字段。</p>\n<h5 id=\"修改默认备份路径\"><a href=\"#修改默认备份路径\" class=\"headerlink\" title=\"修改默认备份路径\"></a>修改默认备份路径</h5><p>如果你像我一样，是使用yum安装的，那么GitLab默认的备份目录应该在<code>/var/opt/gitlab/backups</code>，我建议将备份目录修改为其他位置，并添加定时自动备份脚本，可以通过修改<code>/etc/gitlab/gitlab.rb</code>来修改默认位置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab_rails[&apos;backup_path&apos;] = &apos;/mnt/backups&apos;</div></pre></td></tr></table></figure>\n<h5 id=\"使用crontab-添加自动备份\"><a href=\"#使用crontab-添加自动备份\" class=\"headerlink\" title=\"使用crontab 添加自动备份\"></a>使用crontab 添加自动备份</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 每天凌晨00:00 自动备份</div><div class=\"line\">00 00 * * * /opt/gitlab/bin/gitlab-rake gitlab:backup:create</div></pre></td></tr></table></figure>\n<h5 id=\"备份恢复\"><a href=\"#备份恢复\" class=\"headerlink\" title=\"备份恢复\"></a>备份恢复</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 停止相关数据连接服务</div><div class=\"line\">gitlab-ctl stop unicorn</div><div class=\"line\">gitlab-ctl stop sidekiq</div><div class=\"line\"></div><div class=\"line\"># 从1491989249_2017_04_12编号备份中恢复</div><div class=\"line\">gitlab-rake gitlab:backup:restore BACKUP=1491989249_2017_04_12</div><div class=\"line\"></div><div class=\"line\"># 启动Gitlab</div><div class=\"line\">sudo gitlab-ctl start unicorn</div><div class=\"line\">sudo gitlab-ctl start sidekiq</div></pre></td></tr></table></figure>\n<h3 id=\"GitLab-迁移\"><a href=\"#GitLab-迁移\" class=\"headerlink\" title=\"GitLab 迁移\"></a><strong>GitLab 迁移</strong></h3><p>只需将原服务器<code>/var/opt/gitlab/backups</code>目录下的备份文件拷贝到新服务器上的<code>/var/opt/gitlab/backups</code>上即可(如果你没修改过默认备份目录的话)， 但是需要注意的是新服务器上的Gitlab的版本必须与创建备份时的Gitlab版本号相同， 比如新服务器安装的是最新的9.0.5版本的Gitlab, 那么迁移之前，最好将老服务器的Gitlab 升级为9.0.5在进行备份。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>目前最为主流的在线Git版本控制系统可以说是非GitHub莫属，对于个人开发者和开源项目可以直接选择GitHub作为Git版本控制系统即可，但是，对于企业内部开发管理的Git版本控制系统，在对保密性有高要求时GitHub就不合适了，这时GitLab作为一个可以完全搭建在企业内部的Git版本控制系统，而且基本囊括了GitHub的所有功能。</p>\n<h4 id=\"目前GitLab已经整合的功能\"><a href=\"#目前GitLab已经整合的功能\" class=\"headerlink\" title=\"目前GitLab已经整合的功能\"></a>目前GitLab已经整合的功能</h4><ol>\n<li>Repository access</li>\n<li>Administration</li>\n<li>Issues</li>\n<li>Forks</li>\n<li>Code review</li>\n<li>Wiki</li>\n<li>Merge Requests</li>\n<li>Web Editor</li>\n</ol>\n<h4 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h4><ul>\n<li>2 core 4GB</li>\n<li>50GB HDD</li>\n<li>CentOS 6.8</li>\n<li>Gitlab</li>\n</ul>\n<h4 id=\"安装需求\"><a href=\"#安装需求\" class=\"headerlink\" title=\"安装需求\"></a>安装需求</h4><p>关于GitLab的安装需求，主要是针对用户量然后评估出服务器及相关资源的配置，<a href=\"https://docs.gitlab.com.cn/ce/install/requirements.html\">查看</a></p>\n<h3 id=\"GitLab-安装\"><a href=\"#GitLab-安装\" class=\"headerlink\" title=\"GitLab 安装\"></a><strong>GitLab 安装</strong></h3><h4 id=\"安装配置依赖项\"><a href=\"#安装配置依赖项\" class=\"headerlink\" title=\"安装配置依赖项\"></a>安装配置依赖项</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo yum install curl openssh-server openssh-clients postfix cronie</div><div class=\"line\">sudo service postfix start</div><div class=\"line\">sudo chkconfig postfix on</div><div class=\"line\">sudo lokkit -s http -s ssh</div></pre></td></tr></table></figure>\n<h4 id=\"添加GitLab仓库-并安装到服务器上\"><a href=\"#添加GitLab仓库-并安装到服务器上\" class=\"headerlink\" title=\"添加GitLab仓库,并安装到服务器上\"></a>添加GitLab仓库,并安装到服务器上</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl -sS http://packages.gitlab.cc/install/gitlab-ce/script.rpm.sh | sudo bash</div><div class=\"line\">sudo yum install gitlab-ce</div></pre></td></tr></table></figure>\n<h4 id=\"启动GitLab并初始化\"><a href=\"#启动GitLab并初始化\" class=\"headerlink\" title=\"启动GitLab并初始化\"></a>启动GitLab并初始化</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo gitlab-ctl reconfigure</div></pre></td></tr></table></figure>\n<p>默认登录账号是：<strong>root</strong> ，你可以在首次打开时设置密码。</p>\n<h3 id=\"GitLab-初始化\"><a href=\"#GitLab-初始化\" class=\"headerlink\" title=\"GitLab 初始化\"></a><strong>GitLab 初始化</strong></h3><h4 id=\"开机自启动\"><a href=\"#开机自启动\" class=\"headerlink\" title=\"开机自启动\"></a>开机自启动</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">vi /etc/rc.local</div><div class=\"line\">/opt/gitlab/bin/gitlab-ctl start</div></pre></td></tr></table></figure>\n<h4 id=\"GitLab-配置文件\"><a href=\"#GitLab-配置文件\" class=\"headerlink\" title=\"GitLab 配置文件\"></a>GitLab 配置文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/etc/gitlab/gitlab.rb</div></pre></td></tr></table></figure>\n<h4 id=\"SMTP-邮箱配置\"><a href=\"#SMTP-邮箱配置\" class=\"headerlink\" title=\"SMTP 邮箱配置\"></a>SMTP 邮箱配置</h4><p>如果想使用SMTP代替sendmail来发送邮件，应该在gitlab.rb中启用对应的配置，然后运行<code>gitlab-ctl reconfigure</code>使修改生效。</p>\n<h5 id=\"QQ企业邮箱配置示例\"><a href=\"#QQ企业邮箱配置示例\" class=\"headerlink\" title=\"QQ企业邮箱配置示例\"></a>QQ企业邮箱配置示例</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab_rails[&apos;smtp_enable&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_address&apos;] = &quot;smtp.exmail.qq.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_port&apos;] = 465</div><div class=\"line\">gitlab_rails[&apos;smtp_user_name&apos;] = &quot;xxxx@xx.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_password&apos;] = &quot;password&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_authentication&apos;] = &quot;login&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_enable_starttls_auto&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_tls&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;gitlab_email_from&apos;] = &apos;xxxx@xx.com&apos;</div></pre></td></tr></table></figure>\n<h5 id=\"Gmail邮箱配置示例\"><a href=\"#Gmail邮箱配置示例\" class=\"headerlink\" title=\"Gmail邮箱配置示例\"></a>Gmail邮箱配置示例</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab_rails[&apos;smtp_enable&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_address&apos;] = &quot;smtp.gmail.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_port&apos;] = 587</div><div class=\"line\">gitlab_rails[&apos;smtp_user_name&apos;] = &quot;my.email@gmail.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_password&apos;] = &quot;my-gmail-password&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_domain&apos;] = &quot;smtp.gmail.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_authentication&apos;] = &quot;login&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_enable_starttls_auto&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_tls&apos;] = false</div><div class=\"line\">gitlab_rails[&apos;smtp_openssl_verify_mode&apos;] = &apos;peer&apos;</div></pre></td></tr></table></figure>\n<h5 id=\"Outlook邮箱配置示例\"><a href=\"#Outlook邮箱配置示例\" class=\"headerlink\" title=\"Outlook邮箱配置示例\"></a>Outlook邮箱配置示例</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab_rails[&apos;smtp_enable&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_address&apos;] = &quot;smtp-mail.outlook.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_port&apos;] = 587</div><div class=\"line\">gitlab_rails[&apos;smtp_user_name&apos;] = &quot;username@outlook.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_password&apos;] = &quot;password&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_domain&apos;] = &quot;smtp-mail.outlook.com&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_authentication&apos;] = &quot;login&quot;</div><div class=\"line\">gitlab_rails[&apos;smtp_enable_starttls_auto&apos;] = true</div><div class=\"line\">gitlab_rails[&apos;smtp_openssl_verify_mode&apos;] = &apos;peer&apos;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>​:warning: ‘smtp_password’字段不应包含任何 Ruby或者YAML语法中的分隔符 (如<code>&#39;</code>),以避免处理配置文件的过程中发生不必要的意外。</p>\n</blockquote>\n<h4 id=\"GitLab-日常维护\"><a href=\"#GitLab-日常维护\" class=\"headerlink\" title=\"GitLab 日常维护\"></a>GitLab 日常维护</h4><h5 id=\"1-查看服务状态\"><a href=\"#1-查看服务状态\" class=\"headerlink\" title=\"1. 查看服务状态\"></a>1. 查看服务状态</h5><p>使用 gitlab-ctl status 查看服务状态</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# sudo gitlab-ctl status</div><div class=\"line\">run: gitaly: (pid 15055) 23089s; run: log: (pid 3142) 55379s</div><div class=\"line\">run: gitlab-monitor: (pid 15060) 23088s; run: log: (pid 3325) 55357s</div><div class=\"line\">run: gitlab-workhorse: (pid 15063) 23088s; run: log: (pid 3156) 55377s</div><div class=\"line\">run: logrotate: (pid 17867) 1487s; run: log: (pid 3197) 55369s</div><div class=\"line\">run: nginx: (pid 15077) 23087s; run: log: (pid 3169) 55375s</div><div class=\"line\">run: node-exporter: (pid 15083) 23087s; run: log: (pid 3247) 55366s</div><div class=\"line\">run: postgres-exporter: (pid 15088) 23086s; run: log: (pid 3311) 55358s</div><div class=\"line\">run: postgresql: (pid 15093) 23086s; run: log: (pid 2988) 55412s</div><div class=\"line\">run: prometheus: (pid 15101) 23085s; run: log: (pid 3230) 55368s</div><div class=\"line\">run: redis: (pid 15109) 23085s; run: log: (pid 2931) 55419s</div><div class=\"line\">run: redis-exporter: (pid 15113) 23085s; run: log: (pid 3290) 55364s</div><div class=\"line\">run: sidekiq: (pid 17029) 22450s; run: log: (pid 3131) 55380s</div><div class=\"line\">run: unicorn: (pid 17001) 22460s; run: log: (pid 3100) 55386s</div></pre></td></tr></table></figure>\n<h5 id=\"2-启动、关闭、重启\"><a href=\"#2-启动、关闭、重启\" class=\"headerlink\" title=\"2. 启动、关闭、重启\"></a>2. 启动、关闭、重启</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 启动Gitlab所有组件</div><div class=\"line\">sudo gitlab-ctl start</div><div class=\"line\"></div><div class=\"line\"># 停止Gitlab所有组件</div><div class=\"line\">sudo gitlab-ctl stop</div><div class=\"line\"></div><div class=\"line\"># 重启Gitlab所有组件</div><div class=\"line\">sudo gitlab-ctl restart</div><div class=\"line\"></div><div class=\"line\"># 重启单个组件</div><div class=\"line\">sudo gitlab-ctl restart sidekiq</div></pre></td></tr></table></figure>\n<h5 id=\"3-控制台实时查看日志\"><a href=\"#3-控制台实时查看日志\" class=\"headerlink\" title=\"3. 控制台实时查看日志\"></a>3. 控制台实时查看日志</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 查看所有的logs; 按 Ctrl-C 退出</div><div class=\"line\">sudo gitlab-ctl tail</div><div class=\"line\"></div><div class=\"line\"># 拉取/var/log/gitlab下子目录的日志</div><div class=\"line\">sudo gitlab-ctl tail gitlab-rails</div><div class=\"line\"></div><div class=\"line\"># 拉取某个指定的日志文件</div><div class=\"line\">sudo gitlab-ctl tail nginx/gitlab_error.log</div></pre></td></tr></table></figure>\n<h3 id=\"GitLab-安装后优化\"><a href=\"#GitLab-安装后优化\" class=\"headerlink\" title=\"GitLab 安装后优化\"></a><strong>GitLab 安装后优化</strong></h3><h4 id=\"启用HTTPS\"><a href=\"#启用HTTPS\" class=\"headerlink\" title=\"启用HTTPS\"></a>启用HTTPS</h4><p>首先，你需要提供一个有可信任CA证书，默认情况下GitLab是没有启用HTTPS的，如果要启用HTTPS时，首先要修改<code>/etc/gitlab/gitlab.rb</code>中的<code>external_url</code>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改为https</div><div class=\"line\">external_url &quot;https://git.ultraera.org&quot;</div><div class=\"line\"></div><div class=\"line\"># 设置默认将http重定向到https</div><div class=\"line\">nginx[&apos;redirect_http_to_https&apos;] = true</div></pre></td></tr></table></figure>\n<p>如果你暂时没有https证书，那么你可以临时自己颁发一个证书，注意这个证书是不受信任的。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir -p /etc/nginx/ssl/</div><div class=\"line\">cd /etc/nginx/ssl/</div><div class=\"line\">sudo openssl req -newkey rsa:2048 -x509 -nodes -days 3560 -out gitlab.crt -keyout gitlab.key</div><div class=\"line\">sudo chmod o-r gitlab.key</div><div class=\"line\">sudo mv gitlab.key gitlab.crt /etc/ssl/</div></pre></td></tr></table></figure>\n<p>另外，还需要在gitlab-shell中的config.yml中将self_signed_cert 修改为启用:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">self_signed_cert = true</div></pre></td></tr></table></figure>\n<h4 id=\"设置延迟启动\"><a href=\"#设置延迟启动\" class=\"headerlink\" title=\"设置延迟启动\"></a>设置延迟启动</h4><p>为保证服务质量，我们可以设置让omnibus-gitlab的服务(Nginx, Redis, Unicorn等) 在指定的文件系统挂载成功后再启动，在<code>/etc/gitlab/gitlab.rb</code> 文件中添加如下内容：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 等待/var/opt/gitlab 先被挂载</div><div class=\"line\">high_availability[&apos;mountpoint&apos;] = &apos;/var/opt/gitlab&apos;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>注意在修改配置之后，要使用重新reconfigure配置</p>\n</blockquote>\n<h4 id=\"Backups-备份还原\"><a href=\"#Backups-备份还原\" class=\"headerlink\" title=\"Backups 备份还原\"></a>Backups 备份还原</h4><h5 id=\"备份\"><a href=\"#备份\" class=\"headerlink\" title=\"备份\"></a>备份</h5><p>Gitlab的配置也非常简单,使用一条命令即可创建完整的Gitlab备份:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab-rake gitlab:backup:create</div></pre></td></tr></table></figure>\n<p>该命令会在<code>/var/opt/gitlab/backups</code>目录下创建一个名称类似为<code>1491989249_2017_04_12_gitlab_backup.tar</code>的压缩包, 这个压缩包就是Gitlab整个的完整部分，其中开头的<code>1491989249_2017_04_12</code>是备份创建的日期，这也是我们等下恢复是要用的字段。</p>\n<h5 id=\"修改默认备份路径\"><a href=\"#修改默认备份路径\" class=\"headerlink\" title=\"修改默认备份路径\"></a>修改默认备份路径</h5><p>如果你像我一样，是使用yum安装的，那么GitLab默认的备份目录应该在<code>/var/opt/gitlab/backups</code>，我建议将备份目录修改为其他位置，并添加定时自动备份脚本，可以通过修改<code>/etc/gitlab/gitlab.rb</code>来修改默认位置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab_rails[&apos;backup_path&apos;] = &apos;/mnt/backups&apos;</div></pre></td></tr></table></figure>\n<h5 id=\"使用crontab-添加自动备份\"><a href=\"#使用crontab-添加自动备份\" class=\"headerlink\" title=\"使用crontab 添加自动备份\"></a>使用crontab 添加自动备份</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 每天凌晨00:00 自动备份</div><div class=\"line\">00 00 * * * /opt/gitlab/bin/gitlab-rake gitlab:backup:create</div></pre></td></tr></table></figure>\n<h5 id=\"备份恢复\"><a href=\"#备份恢复\" class=\"headerlink\" title=\"备份恢复\"></a>备份恢复</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 停止相关数据连接服务</div><div class=\"line\">gitlab-ctl stop unicorn</div><div class=\"line\">gitlab-ctl stop sidekiq</div><div class=\"line\"></div><div class=\"line\"># 从1491989249_2017_04_12编号备份中恢复</div><div class=\"line\">gitlab-rake gitlab:backup:restore BACKUP=1491989249_2017_04_12</div><div class=\"line\"></div><div class=\"line\"># 启动Gitlab</div><div class=\"line\">sudo gitlab-ctl start unicorn</div><div class=\"line\">sudo gitlab-ctl start sidekiq</div></pre></td></tr></table></figure>\n<h3 id=\"GitLab-迁移\"><a href=\"#GitLab-迁移\" class=\"headerlink\" title=\"GitLab 迁移\"></a><strong>GitLab 迁移</strong></h3><p>只需将原服务器<code>/var/opt/gitlab/backups</code>目录下的备份文件拷贝到新服务器上的<code>/var/opt/gitlab/backups</code>上即可(如果你没修改过默认备份目录的话)， 但是需要注意的是新服务器上的Gitlab的版本必须与创建备份时的Gitlab版本号相同， 比如新服务器安装的是最新的9.0.5版本的Gitlab, 那么迁移之前，最好将老服务器的Gitlab 升级为9.0.5在进行备份。</p>\n"},{"title":"HowTo Install KVM Manage Server : webvirtmgr","id":"74","updated":"2017-04-21T05:24:45.000Z","date":"2016-07-27T09:34:01.000Z","_content":"\n生产环境的KVM宿主机越来越多，需要对宿主机的状态进行调控。这里用webvirtmgr进行管理。图形化的WEB，让人能更方便的查看kvm 宿主机的情况和操作.\n\n\n***[GitHub Project.](https://github.com/retspen/webvirtmgr)***\n\n\n###  Install\n\n#### 安装支持的软件源\n```\nyum install -y epel-release\n```\n\n#### 安装相关软件\n```\nyum -y install git python-pip libvirt-python libxml2-python python-websockify supervisor nginx\n```\n\n#### 从git-hub中下载相关的webvirtmgr代码\n```\ncd /usr/local/src/\ngit clone git://github.com/retspen/webvirtmgr.git\n```\n\n#### 安装webvirtmgr\n```\ncd webvirtmgr/\npip install -r requirements.txt\n```\n\n#### 安装数据库\n```\nyum install python-sqlite2\n```\n\n#### 对django进行环境配置\n```\n./manage.py syncdb\n\nYou just installed Django's auth system, which means you don't have any superusers defined.\nWould you like to create one now? (yes/no): yes\nUsername (leave blank to use 'root'): admin\nEmail address: luchuanjia@msn.com\nPassword:*********\nPassword (again):*********\n\n./manage.py collectstatic #生成配置文件\n./manage.py createsuperuser #添加管理员账号\n```\n\n#### 拷贝web到 相关目录\n```\ncd ..\nrm -rf /var/www\nmkdir -pv /var/www\ncp -Rv webvirtmgr /var/www/webvirtmgr\n```\n\n#### 设置ssh\n```\nssh-keygen\nssh-copy-id 192.168.2.32\nssh 192.168.2.32 -L localhost:8000:localhost:8000 -L localhost:6080:localhost:6080\n```\n\n#### 编辑nginx配置文件\n```\nmv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak\nvim /etc/nginx/conf.d/webvirtmgr.conf  #添加下面内容到文件中\n\nserver {\n    listen 80 default_server;\n\n    server_name $hostname;\n    #access_log /var/log/nginx/webvirtmgr_access_log;\n\n    location /static/ {\n        root /var/www/webvirtmgr/webvirtmgr; # or /srv instead of /var\n        expires max;\n    }\n\n    location / {\n        proxy_pass http://127.0.0.1:8000;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-for $proxy_add_x_forwarded_for;\n        proxy_set_header Host $host:$server_port;\n        proxy_set_header X-Forwarded-Proto $remote_addr;\n        proxy_connect_timeout 600;\n        proxy_read_timeout 600;\n        proxy_send_timeout 600;\n        client_max_body_size 1024M; # Set higher depending on your needs\n    }\n}\n```\n\n#### 启动nginx\n```\nservice nginx start\n```\n\n#### 修改防火墙规则 ( 如果关闭selinux，此步可省略)\n```\n/usr/sbin/setsebool httpd_can_network_connect true\n```\n\n#### 设置 supervisor\n```\nchown -R nginx:nginx /var/www/webvirtmgr\nvim /etc/supervisord.conf #在文件末尾添加\n\n[program:webvirtmgr]\ncommand=/usr/bin/python /var/www/webvirtmgr/manage.py run_gunicorn -c /var/www/webvirtmgr/conf/gunicorn.conf.py\ndirectory=/var/www/webvirtmgr\nautostart=true\nautorestart=true\nlogfile=/var/log/supervisor/webvirtmgr.log\nlog_stderr=true\nuser=nginx\n\n[program:webvirtmgr-console]\ncommand=/usr/bin/python /var/www/webvirtmgr/console/webvirtmgr-console\ndirectory=/var/www/webvirtmgr\nautostart=true\nautorestart=true\nstdout_logfile=/var/log/supervisor/webvirtmgr-console.log\nredirect_stderr=true\nuser=nginx\n\n修改/var/www/webvirtmgr/conf/gunicorn.conf.py\nbind = \"0:8000\"\n```\n\n#### 设置开机启动\n```\nchkconfig supervisord on\nchkconfig nginx on\nvim /etc/rc.local\n      /usr/sbin/setsebool httpd_can_network_connect true\n```\n\n#### 启动进程\n```\nservice nginx start\nservice supervisord start\n```\n\n#### 访问\n```\nhttp://$server_ip/login/\n```\n\n","source":"_posts/HowTo-Install-KVM-Manage-Server-webvirtmgr.md","raw":"---\ntitle: 'HowTo Install KVM Manage Server : webvirtmgr'\ntags: 'KVM'\ncategories: 'KVM'\npermalink: install-kvm-web-manage-server-webvirtmgr\nid: 74\nupdated: '2017-04-21 13:24:45'\ndate: 2016-07-27 17:34:01\n---\n\n生产环境的KVM宿主机越来越多，需要对宿主机的状态进行调控。这里用webvirtmgr进行管理。图形化的WEB，让人能更方便的查看kvm 宿主机的情况和操作.\n\n\n***[GitHub Project.](https://github.com/retspen/webvirtmgr)***\n\n\n###  Install\n\n#### 安装支持的软件源\n```\nyum install -y epel-release\n```\n\n#### 安装相关软件\n```\nyum -y install git python-pip libvirt-python libxml2-python python-websockify supervisor nginx\n```\n\n#### 从git-hub中下载相关的webvirtmgr代码\n```\ncd /usr/local/src/\ngit clone git://github.com/retspen/webvirtmgr.git\n```\n\n#### 安装webvirtmgr\n```\ncd webvirtmgr/\npip install -r requirements.txt\n```\n\n#### 安装数据库\n```\nyum install python-sqlite2\n```\n\n#### 对django进行环境配置\n```\n./manage.py syncdb\n\nYou just installed Django's auth system, which means you don't have any superusers defined.\nWould you like to create one now? (yes/no): yes\nUsername (leave blank to use 'root'): admin\nEmail address: luchuanjia@msn.com\nPassword:*********\nPassword (again):*********\n\n./manage.py collectstatic #生成配置文件\n./manage.py createsuperuser #添加管理员账号\n```\n\n#### 拷贝web到 相关目录\n```\ncd ..\nrm -rf /var/www\nmkdir -pv /var/www\ncp -Rv webvirtmgr /var/www/webvirtmgr\n```\n\n#### 设置ssh\n```\nssh-keygen\nssh-copy-id 192.168.2.32\nssh 192.168.2.32 -L localhost:8000:localhost:8000 -L localhost:6080:localhost:6080\n```\n\n#### 编辑nginx配置文件\n```\nmv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak\nvim /etc/nginx/conf.d/webvirtmgr.conf  #添加下面内容到文件中\n\nserver {\n    listen 80 default_server;\n\n    server_name $hostname;\n    #access_log /var/log/nginx/webvirtmgr_access_log;\n\n    location /static/ {\n        root /var/www/webvirtmgr/webvirtmgr; # or /srv instead of /var\n        expires max;\n    }\n\n    location / {\n        proxy_pass http://127.0.0.1:8000;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-for $proxy_add_x_forwarded_for;\n        proxy_set_header Host $host:$server_port;\n        proxy_set_header X-Forwarded-Proto $remote_addr;\n        proxy_connect_timeout 600;\n        proxy_read_timeout 600;\n        proxy_send_timeout 600;\n        client_max_body_size 1024M; # Set higher depending on your needs\n    }\n}\n```\n\n#### 启动nginx\n```\nservice nginx start\n```\n\n#### 修改防火墙规则 ( 如果关闭selinux，此步可省略)\n```\n/usr/sbin/setsebool httpd_can_network_connect true\n```\n\n#### 设置 supervisor\n```\nchown -R nginx:nginx /var/www/webvirtmgr\nvim /etc/supervisord.conf #在文件末尾添加\n\n[program:webvirtmgr]\ncommand=/usr/bin/python /var/www/webvirtmgr/manage.py run_gunicorn -c /var/www/webvirtmgr/conf/gunicorn.conf.py\ndirectory=/var/www/webvirtmgr\nautostart=true\nautorestart=true\nlogfile=/var/log/supervisor/webvirtmgr.log\nlog_stderr=true\nuser=nginx\n\n[program:webvirtmgr-console]\ncommand=/usr/bin/python /var/www/webvirtmgr/console/webvirtmgr-console\ndirectory=/var/www/webvirtmgr\nautostart=true\nautorestart=true\nstdout_logfile=/var/log/supervisor/webvirtmgr-console.log\nredirect_stderr=true\nuser=nginx\n\n修改/var/www/webvirtmgr/conf/gunicorn.conf.py\nbind = \"0:8000\"\n```\n\n#### 设置开机启动\n```\nchkconfig supervisord on\nchkconfig nginx on\nvim /etc/rc.local\n      /usr/sbin/setsebool httpd_can_network_connect true\n```\n\n#### 启动进程\n```\nservice nginx start\nservice supervisord start\n```\n\n#### 访问\n```\nhttp://$server_ip/login/\n```\n\n","slug":"install-kvm-web-manage-server-webvirtmgr","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq7e001o41tpel8jujny","content":"<p>生产环境的KVM宿主机越来越多，需要对宿主机的状态进行调控。这里用webvirtmgr进行管理。图形化的WEB，让人能更方便的查看kvm 宿主机的情况和操作.</p>\n<p><strong><em><a href=\"https://github.com/retspen/webvirtmgr\" target=\"_blank\" rel=\"external\">GitHub Project.</a></em></strong></p>\n<h3 id=\"Install\"><a href=\"#Install\" class=\"headerlink\" title=\"Install\"></a>Install</h3><h4 id=\"安装支持的软件源\"><a href=\"#安装支持的软件源\" class=\"headerlink\" title=\"安装支持的软件源\"></a>安装支持的软件源</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y epel-release</div></pre></td></tr></table></figure>\n<h4 id=\"安装相关软件\"><a href=\"#安装相关软件\" class=\"headerlink\" title=\"安装相关软件\"></a>安装相关软件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install git python-pip libvirt-python libxml2-python python-websockify supervisor nginx</div></pre></td></tr></table></figure>\n<h4 id=\"从git-hub中下载相关的webvirtmgr代码\"><a href=\"#从git-hub中下载相关的webvirtmgr代码\" class=\"headerlink\" title=\"从git-hub中下载相关的webvirtmgr代码\"></a>从git-hub中下载相关的webvirtmgr代码</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /usr/local/src/</div><div class=\"line\">git clone git://github.com/retspen/webvirtmgr.git</div></pre></td></tr></table></figure>\n<h4 id=\"安装webvirtmgr\"><a href=\"#安装webvirtmgr\" class=\"headerlink\" title=\"安装webvirtmgr\"></a>安装webvirtmgr</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd webvirtmgr/</div><div class=\"line\">pip install -r requirements.txt</div></pre></td></tr></table></figure>\n<h4 id=\"安装数据库\"><a href=\"#安装数据库\" class=\"headerlink\" title=\"安装数据库\"></a>安装数据库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install python-sqlite2</div></pre></td></tr></table></figure>\n<h4 id=\"对django进行环境配置\"><a href=\"#对django进行环境配置\" class=\"headerlink\" title=\"对django进行环境配置\"></a>对django进行环境配置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">./manage.py syncdb</div><div class=\"line\"></div><div class=\"line\">You just installed Django&apos;s auth system, which means you don&apos;t have any superusers defined.</div><div class=\"line\">Would you like to create one now? (yes/no): yes</div><div class=\"line\">Username (leave blank to use &apos;root&apos;): admin</div><div class=\"line\">Email address: luchuanjia@msn.com</div><div class=\"line\">Password:*********</div><div class=\"line\">Password (again):*********</div><div class=\"line\"></div><div class=\"line\">./manage.py collectstatic #生成配置文件</div><div class=\"line\">./manage.py createsuperuser #添加管理员账号</div></pre></td></tr></table></figure>\n<h4 id=\"拷贝web到-相关目录\"><a href=\"#拷贝web到-相关目录\" class=\"headerlink\" title=\"拷贝web到 相关目录\"></a>拷贝web到 相关目录</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd ..</div><div class=\"line\">rm -rf /var/www</div><div class=\"line\">mkdir -pv /var/www</div><div class=\"line\">cp -Rv webvirtmgr /var/www/webvirtmgr</div></pre></td></tr></table></figure>\n<h4 id=\"设置ssh\"><a href=\"#设置ssh\" class=\"headerlink\" title=\"设置ssh\"></a>设置ssh</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh-keygen</div><div class=\"line\">ssh-copy-id 192.168.2.32</div><div class=\"line\">ssh 192.168.2.32 -L localhost:8000:localhost:8000 -L localhost:6080:localhost:6080</div></pre></td></tr></table></figure>\n<h4 id=\"编辑nginx配置文件\"><a href=\"#编辑nginx配置文件\" class=\"headerlink\" title=\"编辑nginx配置文件\"></a>编辑nginx配置文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak</div><div class=\"line\">vim /etc/nginx/conf.d/webvirtmgr.conf  #添加下面内容到文件中</div><div class=\"line\"></div><div class=\"line\">server &#123;</div><div class=\"line\">    listen 80 default_server;</div><div class=\"line\"></div><div class=\"line\">    server_name $hostname;</div><div class=\"line\">    #access_log /var/log/nginx/webvirtmgr_access_log;</div><div class=\"line\"></div><div class=\"line\">    location /static/ &#123;</div><div class=\"line\">        root /var/www/webvirtmgr/webvirtmgr; # or /srv instead of /var</div><div class=\"line\">        expires max;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    location / &#123;</div><div class=\"line\">        proxy_pass http://127.0.0.1:8000;</div><div class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</div><div class=\"line\">        proxy_set_header X-Forwarded-for $proxy_add_x_forwarded_for;</div><div class=\"line\">        proxy_set_header Host $host:$server_port;</div><div class=\"line\">        proxy_set_header X-Forwarded-Proto $remote_addr;</div><div class=\"line\">        proxy_connect_timeout 600;</div><div class=\"line\">        proxy_read_timeout 600;</div><div class=\"line\">        proxy_send_timeout 600;</div><div class=\"line\">        client_max_body_size 1024M; # Set higher depending on your needs</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"启动nginx\"><a href=\"#启动nginx\" class=\"headerlink\" title=\"启动nginx\"></a>启动nginx</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service nginx start</div></pre></td></tr></table></figure>\n<h4 id=\"修改防火墙规则-如果关闭selinux，此步可省略\"><a href=\"#修改防火墙规则-如果关闭selinux，此步可省略\" class=\"headerlink\" title=\"修改防火墙规则 ( 如果关闭selinux，此步可省略)\"></a>修改防火墙规则 ( 如果关闭selinux，此步可省略)</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/usr/sbin/setsebool httpd_can_network_connect true</div></pre></td></tr></table></figure>\n<h4 id=\"设置-supervisor\"><a href=\"#设置-supervisor\" class=\"headerlink\" title=\"设置 supervisor\"></a>设置 supervisor</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">chown -R nginx:nginx /var/www/webvirtmgr</div><div class=\"line\">vim /etc/supervisord.conf #在文件末尾添加</div><div class=\"line\"></div><div class=\"line\">[program:webvirtmgr]</div><div class=\"line\">command=/usr/bin/python /var/www/webvirtmgr/manage.py run_gunicorn -c /var/www/webvirtmgr/conf/gunicorn.conf.py</div><div class=\"line\">directory=/var/www/webvirtmgr</div><div class=\"line\">autostart=true</div><div class=\"line\">autorestart=true</div><div class=\"line\">logfile=/var/log/supervisor/webvirtmgr.log</div><div class=\"line\">log_stderr=true</div><div class=\"line\">user=nginx</div><div class=\"line\"></div><div class=\"line\">[program:webvirtmgr-console]</div><div class=\"line\">command=/usr/bin/python /var/www/webvirtmgr/console/webvirtmgr-console</div><div class=\"line\">directory=/var/www/webvirtmgr</div><div class=\"line\">autostart=true</div><div class=\"line\">autorestart=true</div><div class=\"line\">stdout_logfile=/var/log/supervisor/webvirtmgr-console.log</div><div class=\"line\">redirect_stderr=true</div><div class=\"line\">user=nginx</div><div class=\"line\"></div><div class=\"line\">修改/var/www/webvirtmgr/conf/gunicorn.conf.py</div><div class=\"line\">bind = &quot;0:8000&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"设置开机启动\"><a href=\"#设置开机启动\" class=\"headerlink\" title=\"设置开机启动\"></a>设置开机启动</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig supervisord on</div><div class=\"line\">chkconfig nginx on</div><div class=\"line\">vim /etc/rc.local</div><div class=\"line\">      /usr/sbin/setsebool httpd_can_network_connect true</div></pre></td></tr></table></figure>\n<h4 id=\"启动进程\"><a href=\"#启动进程\" class=\"headerlink\" title=\"启动进程\"></a>启动进程</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">service nginx start</div><div class=\"line\">service supervisord start</div></pre></td></tr></table></figure>\n<h4 id=\"访问\"><a href=\"#访问\" class=\"headerlink\" title=\"访问\"></a>访问</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">http://$server_ip/login/</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>生产环境的KVM宿主机越来越多，需要对宿主机的状态进行调控。这里用webvirtmgr进行管理。图形化的WEB，让人能更方便的查看kvm 宿主机的情况和操作.</p>\n<p><strong><em><a href=\"https://github.com/retspen/webvirtmgr\">GitHub Project.</a></em></strong></p>\n<h3 id=\"Install\"><a href=\"#Install\" class=\"headerlink\" title=\"Install\"></a>Install</h3><h4 id=\"安装支持的软件源\"><a href=\"#安装支持的软件源\" class=\"headerlink\" title=\"安装支持的软件源\"></a>安装支持的软件源</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y epel-release</div></pre></td></tr></table></figure>\n<h4 id=\"安装相关软件\"><a href=\"#安装相关软件\" class=\"headerlink\" title=\"安装相关软件\"></a>安装相关软件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install git python-pip libvirt-python libxml2-python python-websockify supervisor nginx</div></pre></td></tr></table></figure>\n<h4 id=\"从git-hub中下载相关的webvirtmgr代码\"><a href=\"#从git-hub中下载相关的webvirtmgr代码\" class=\"headerlink\" title=\"从git-hub中下载相关的webvirtmgr代码\"></a>从git-hub中下载相关的webvirtmgr代码</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /usr/local/src/</div><div class=\"line\">git clone git://github.com/retspen/webvirtmgr.git</div></pre></td></tr></table></figure>\n<h4 id=\"安装webvirtmgr\"><a href=\"#安装webvirtmgr\" class=\"headerlink\" title=\"安装webvirtmgr\"></a>安装webvirtmgr</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd webvirtmgr/</div><div class=\"line\">pip install -r requirements.txt</div></pre></td></tr></table></figure>\n<h4 id=\"安装数据库\"><a href=\"#安装数据库\" class=\"headerlink\" title=\"安装数据库\"></a>安装数据库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install python-sqlite2</div></pre></td></tr></table></figure>\n<h4 id=\"对django进行环境配置\"><a href=\"#对django进行环境配置\" class=\"headerlink\" title=\"对django进行环境配置\"></a>对django进行环境配置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">./manage.py syncdb</div><div class=\"line\"></div><div class=\"line\">You just installed Django&apos;s auth system, which means you don&apos;t have any superusers defined.</div><div class=\"line\">Would you like to create one now? (yes/no): yes</div><div class=\"line\">Username (leave blank to use &apos;root&apos;): admin</div><div class=\"line\">Email address: luchuanjia@msn.com</div><div class=\"line\">Password:*********</div><div class=\"line\">Password (again):*********</div><div class=\"line\"></div><div class=\"line\">./manage.py collectstatic #生成配置文件</div><div class=\"line\">./manage.py createsuperuser #添加管理员账号</div></pre></td></tr></table></figure>\n<h4 id=\"拷贝web到-相关目录\"><a href=\"#拷贝web到-相关目录\" class=\"headerlink\" title=\"拷贝web到 相关目录\"></a>拷贝web到 相关目录</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd ..</div><div class=\"line\">rm -rf /var/www</div><div class=\"line\">mkdir -pv /var/www</div><div class=\"line\">cp -Rv webvirtmgr /var/www/webvirtmgr</div></pre></td></tr></table></figure>\n<h4 id=\"设置ssh\"><a href=\"#设置ssh\" class=\"headerlink\" title=\"设置ssh\"></a>设置ssh</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh-keygen</div><div class=\"line\">ssh-copy-id 192.168.2.32</div><div class=\"line\">ssh 192.168.2.32 -L localhost:8000:localhost:8000 -L localhost:6080:localhost:6080</div></pre></td></tr></table></figure>\n<h4 id=\"编辑nginx配置文件\"><a href=\"#编辑nginx配置文件\" class=\"headerlink\" title=\"编辑nginx配置文件\"></a>编辑nginx配置文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak</div><div class=\"line\">vim /etc/nginx/conf.d/webvirtmgr.conf  #添加下面内容到文件中</div><div class=\"line\"></div><div class=\"line\">server &#123;</div><div class=\"line\">    listen 80 default_server;</div><div class=\"line\"></div><div class=\"line\">    server_name $hostname;</div><div class=\"line\">    #access_log /var/log/nginx/webvirtmgr_access_log;</div><div class=\"line\"></div><div class=\"line\">    location /static/ &#123;</div><div class=\"line\">        root /var/www/webvirtmgr/webvirtmgr; # or /srv instead of /var</div><div class=\"line\">        expires max;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    location / &#123;</div><div class=\"line\">        proxy_pass http://127.0.0.1:8000;</div><div class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</div><div class=\"line\">        proxy_set_header X-Forwarded-for $proxy_add_x_forwarded_for;</div><div class=\"line\">        proxy_set_header Host $host:$server_port;</div><div class=\"line\">        proxy_set_header X-Forwarded-Proto $remote_addr;</div><div class=\"line\">        proxy_connect_timeout 600;</div><div class=\"line\">        proxy_read_timeout 600;</div><div class=\"line\">        proxy_send_timeout 600;</div><div class=\"line\">        client_max_body_size 1024M; # Set higher depending on your needs</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"启动nginx\"><a href=\"#启动nginx\" class=\"headerlink\" title=\"启动nginx\"></a>启动nginx</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service nginx start</div></pre></td></tr></table></figure>\n<h4 id=\"修改防火墙规则-如果关闭selinux，此步可省略\"><a href=\"#修改防火墙规则-如果关闭selinux，此步可省略\" class=\"headerlink\" title=\"修改防火墙规则 ( 如果关闭selinux，此步可省略)\"></a>修改防火墙规则 ( 如果关闭selinux，此步可省略)</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/usr/sbin/setsebool httpd_can_network_connect true</div></pre></td></tr></table></figure>\n<h4 id=\"设置-supervisor\"><a href=\"#设置-supervisor\" class=\"headerlink\" title=\"设置 supervisor\"></a>设置 supervisor</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">chown -R nginx:nginx /var/www/webvirtmgr</div><div class=\"line\">vim /etc/supervisord.conf #在文件末尾添加</div><div class=\"line\"></div><div class=\"line\">[program:webvirtmgr]</div><div class=\"line\">command=/usr/bin/python /var/www/webvirtmgr/manage.py run_gunicorn -c /var/www/webvirtmgr/conf/gunicorn.conf.py</div><div class=\"line\">directory=/var/www/webvirtmgr</div><div class=\"line\">autostart=true</div><div class=\"line\">autorestart=true</div><div class=\"line\">logfile=/var/log/supervisor/webvirtmgr.log</div><div class=\"line\">log_stderr=true</div><div class=\"line\">user=nginx</div><div class=\"line\"></div><div class=\"line\">[program:webvirtmgr-console]</div><div class=\"line\">command=/usr/bin/python /var/www/webvirtmgr/console/webvirtmgr-console</div><div class=\"line\">directory=/var/www/webvirtmgr</div><div class=\"line\">autostart=true</div><div class=\"line\">autorestart=true</div><div class=\"line\">stdout_logfile=/var/log/supervisor/webvirtmgr-console.log</div><div class=\"line\">redirect_stderr=true</div><div class=\"line\">user=nginx</div><div class=\"line\"></div><div class=\"line\">修改/var/www/webvirtmgr/conf/gunicorn.conf.py</div><div class=\"line\">bind = &quot;0:8000&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"设置开机启动\"><a href=\"#设置开机启动\" class=\"headerlink\" title=\"设置开机启动\"></a>设置开机启动</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig supervisord on</div><div class=\"line\">chkconfig nginx on</div><div class=\"line\">vim /etc/rc.local</div><div class=\"line\">      /usr/sbin/setsebool httpd_can_network_connect true</div></pre></td></tr></table></figure>\n<h4 id=\"启动进程\"><a href=\"#启动进程\" class=\"headerlink\" title=\"启动进程\"></a>启动进程</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">service nginx start</div><div class=\"line\">service supervisord start</div></pre></td></tr></table></figure>\n<h4 id=\"访问\"><a href=\"#访问\" class=\"headerlink\" title=\"访问\"></a>访问</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">http://$server_ip/login/</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Install LNMP on CentOS 6.x","id":"118","updated":"2017-04-21T05:19:04.000Z","date":"2016-11-28T02:33:09.000Z","_content":"\n> egrep -v \"^ *#|^ *$\"     去除所有以#号开头的文件\n\n#### Demo system\n```\n[Alex@Test01 ~]$ uname -a\nLinux Test01 2.6.32-504.el6.x86_64 #1 SMP Wed Oct 15 04:27:16 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux\n[Alex@Test01 ~]$ ip addr | grep eth0\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    inet 10.0.2.128/24 brd 10.0.2.255 scope global eth0\n```\n\n#### Install httpd\n```\n[Alex@Test01 yum.repos.d]$ sudo yum install -y httpd\n[Alex@Test01 ~]$ rpm -qa | grep httpd\nhttpd-2.2.15-39.el6.centos.x86_64\nhttpd-tools-2.2.15-39.el6.centos.x86_64\n\n# remove welcome page\n[Alex@Test01 yum.repos.d]$ sudo rm -f /etc/httpd/conf.d/welcome.conf\n# remove default error page\n[Alex@Test01 yum.repos.d]$ sudo rm -f /var/www/error/noindex.html\n```\n\n#### Configure httpd . Replace the server name to you own one.\n```\n[Alex@Test01 ~]# sudo vi /etc/httpd/conf/httpd.conf\n# line 44: change\n ServerTokens Prod\n# line 76: change to ON\n KeepAlive On\n# line 262: Admin's address\n ServerAdmin luchuanjia@msn.com\n# line 338: change\n AllowOverride All\n# line 276: change to your server's name\n ServerName www.ultraera.org:80\n# line 402: add file name that it can access only with directory's name\n DirectoryIndex index.html index.htm\n# line 536: change\n ServerSignature Off\n# line 759: comment out\n# AddDefaultCharset UTF-8\n[Alex@Test01 ~]# sudo /etc/init.d/httpd start\n Starting httpd:[  OK  ]\n[Alex@Test01 ~]# sudo chkconfig httpd on     # set httpd start with system.\n```\n#### create a HTML test page\n```\n[Alex@Test01 ~]# sudo vi /var/www/html/index.html\nit's ok.\n```\n![](http://s3.51cto.com/wyfs02/M00/70/DE/wKioL1XAUfuQoFfwAACC5LJWQgg039.jpg)\n\n#### Install PHP.\n```\n[Alex@Test01 ~]$ sudo yum install -y php php-mbstring php-pear\n[Alex@Test01 ~]$ rpm -qa | grep php\nphp-common-5.3.3-46.el6_6.x86_64\nphp-5.3.3-46.el6_6.x86_64\nphp-mbstring-5.3.3-46.el6_6.x86_64\nphp-cli-5.3.3-46.el6_6.x86_64\nphp-pear-1.9.4-4.el6.noarch\n\n[Alex@Test01 ~]$ sudo vi /etc/httpd/conf/httpd.conf\n# line 402 add file name that it can access only with directory's name\n  DirectoryIndex index.html index.htm index.php\n[Alex@Test01 ~]$ sudo vi /etc/php.ini\n# line 946 set your timezone\ndate.timezone = \"Asia/Shanghai\"\n[Alex@Test01 ~]$ sudo /etc/init.d/httpd restart\n Stopping httpd:[  OK  ]\n Starting httpd:[  OK  ]\n```\n\n#### create a php test page.\n```\n[Alex@Test01 ~]# sudo vi /var/www/html/index.php\n\n<?php\n    phpinfo();\n?>\n```\n![](http://s3.51cto.com/wyfs02/M02/70/DE/wKioL1XAUguwJCl2AARE16t4hyw682.jpg)\n\n#### Install MySQL\n```\n[Alex@Test01 ~]$ sudo -y install mysql-server\n[Alex@Test01 ~]$ rpm -qa | grep mysql-server\nmysql-server-5.1.73-5.el6_6.x86_64\n\n[Alex@Test01 ~]$ sudo vi /etc/my.cnf\n[mysqld]\ndatadir=/var/lib/mysql\nsocket=/var/lib/mysql/mysql.sock\nuser=mysql\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n# add\ncharacter-set-server=utf8\n\n[Alex@Test01 ~]$ sudo /etc/rc.d/init.d/mysqld start\n\nInitializing MySQL database:  WARNING: The host 'www.ultraera.org' could not be looked up with resolveip.\nThis probably means that your libc libraries are not 100 % compatible\nwith this binary MySQL version. The MySQL daemon, mysqld, should work\nnormally with the exception that host name resolving will not work.\nThis means that you should use IP addresses instead of hostnames\nwhen specifying MySQL privileges !\nInstalling MySQL system tables...\nOK\nFilling help tables...\nOK\n...\n...\n...\nYou can test the MySQL daemon with mysql-test-run.pl\ncd /usr/mysql-test ; perl mysql-test-run.pl\n\nPlease report any problems with the /usr/bin/mysqlbug script!\n\n                                              [  OK  ]\nStarting mysqld:                      [  OK  ]\n[Alex@Test01 ~]$ sudo chkconfig mysqld on\n```\n\n#### Initial settings for MySQL\n```\n[root@www ~]#mysql_secure_installation\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\n# Enter\n Enter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\n# set root password\n Set root password? [Y/n]y\n New password:    # input any password\n Re-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\nBy default, a MySQL installation has an anonymous user, allowing anyone\nto log into MySQL without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\n# remove anonymous users\n Remove anonymous users? [Y/n]y\n\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\n# disallow root login remotely\n Disallow root login remotely? [Y/n]y\n\n ... Success!\n\nBy default, MySQL comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\n# remove test database\n Remove test database and access to it? [Y/n]y\n\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\n# reload privilege tables\n Reload privilege tables now? [Y/n]y\n\n ... Success!\n\nCleaning up...\n\nAll done!  If you've completed all of the above steps, your MySQL\ninstallation should now be secure.\n\nThanks for using MySQL!\n\n# try to connect with root\n [root@www ~]#mysql -u root -p\n Enter password:# MySQL root password\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 10\nServer version: 5.1.73 Source distribution\n\nCopyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\n# display user list\n mysql>select user,host,password from mysql.user;\n+------+-----------+-------------------------------------------+\n| user | host      | password                                  |\n+------+-----------+-------------------------------------------+\n| root | localhost | ***************************************** |\n| root | 127.0.0.1 | ***************************************** |\n+------+-----------+-------------------------------------------+\n2 rows in set (0.00 sec)\n\n# display database list\n mysql>show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n+--------------------+\n2 rows in set (0.00 sec)\nmysql>exit\nBye\n```\n","source":"_posts/HowTo-Install-LNMP-on-CentOS-6-x.md","raw":"---\ntitle: HowTo Install LNMP on CentOS 6.x\ntags: 'LNMP'\ncategories: 'CentOS'\npermalink: centos6-6-yum-install-lamp\nid: 118\nupdated: '2017-04-21 13:19:04'\ndate: 2016-11-28 10:33:09\n---\n\n> egrep -v \"^ *#|^ *$\"     去除所有以#号开头的文件\n\n#### Demo system\n```\n[Alex@Test01 ~]$ uname -a\nLinux Test01 2.6.32-504.el6.x86_64 #1 SMP Wed Oct 15 04:27:16 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux\n[Alex@Test01 ~]$ ip addr | grep eth0\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    inet 10.0.2.128/24 brd 10.0.2.255 scope global eth0\n```\n\n#### Install httpd\n```\n[Alex@Test01 yum.repos.d]$ sudo yum install -y httpd\n[Alex@Test01 ~]$ rpm -qa | grep httpd\nhttpd-2.2.15-39.el6.centos.x86_64\nhttpd-tools-2.2.15-39.el6.centos.x86_64\n\n# remove welcome page\n[Alex@Test01 yum.repos.d]$ sudo rm -f /etc/httpd/conf.d/welcome.conf\n# remove default error page\n[Alex@Test01 yum.repos.d]$ sudo rm -f /var/www/error/noindex.html\n```\n\n#### Configure httpd . Replace the server name to you own one.\n```\n[Alex@Test01 ~]# sudo vi /etc/httpd/conf/httpd.conf\n# line 44: change\n ServerTokens Prod\n# line 76: change to ON\n KeepAlive On\n# line 262: Admin's address\n ServerAdmin luchuanjia@msn.com\n# line 338: change\n AllowOverride All\n# line 276: change to your server's name\n ServerName www.ultraera.org:80\n# line 402: add file name that it can access only with directory's name\n DirectoryIndex index.html index.htm\n# line 536: change\n ServerSignature Off\n# line 759: comment out\n# AddDefaultCharset UTF-8\n[Alex@Test01 ~]# sudo /etc/init.d/httpd start\n Starting httpd:[  OK  ]\n[Alex@Test01 ~]# sudo chkconfig httpd on     # set httpd start with system.\n```\n#### create a HTML test page\n```\n[Alex@Test01 ~]# sudo vi /var/www/html/index.html\nit's ok.\n```\n![](http://s3.51cto.com/wyfs02/M00/70/DE/wKioL1XAUfuQoFfwAACC5LJWQgg039.jpg)\n\n#### Install PHP.\n```\n[Alex@Test01 ~]$ sudo yum install -y php php-mbstring php-pear\n[Alex@Test01 ~]$ rpm -qa | grep php\nphp-common-5.3.3-46.el6_6.x86_64\nphp-5.3.3-46.el6_6.x86_64\nphp-mbstring-5.3.3-46.el6_6.x86_64\nphp-cli-5.3.3-46.el6_6.x86_64\nphp-pear-1.9.4-4.el6.noarch\n\n[Alex@Test01 ~]$ sudo vi /etc/httpd/conf/httpd.conf\n# line 402 add file name that it can access only with directory's name\n  DirectoryIndex index.html index.htm index.php\n[Alex@Test01 ~]$ sudo vi /etc/php.ini\n# line 946 set your timezone\ndate.timezone = \"Asia/Shanghai\"\n[Alex@Test01 ~]$ sudo /etc/init.d/httpd restart\n Stopping httpd:[  OK  ]\n Starting httpd:[  OK  ]\n```\n\n#### create a php test page.\n```\n[Alex@Test01 ~]# sudo vi /var/www/html/index.php\n\n<?php\n    phpinfo();\n?>\n```\n![](http://s3.51cto.com/wyfs02/M02/70/DE/wKioL1XAUguwJCl2AARE16t4hyw682.jpg)\n\n#### Install MySQL\n```\n[Alex@Test01 ~]$ sudo -y install mysql-server\n[Alex@Test01 ~]$ rpm -qa | grep mysql-server\nmysql-server-5.1.73-5.el6_6.x86_64\n\n[Alex@Test01 ~]$ sudo vi /etc/my.cnf\n[mysqld]\ndatadir=/var/lib/mysql\nsocket=/var/lib/mysql/mysql.sock\nuser=mysql\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n# add\ncharacter-set-server=utf8\n\n[Alex@Test01 ~]$ sudo /etc/rc.d/init.d/mysqld start\n\nInitializing MySQL database:  WARNING: The host 'www.ultraera.org' could not be looked up with resolveip.\nThis probably means that your libc libraries are not 100 % compatible\nwith this binary MySQL version. The MySQL daemon, mysqld, should work\nnormally with the exception that host name resolving will not work.\nThis means that you should use IP addresses instead of hostnames\nwhen specifying MySQL privileges !\nInstalling MySQL system tables...\nOK\nFilling help tables...\nOK\n...\n...\n...\nYou can test the MySQL daemon with mysql-test-run.pl\ncd /usr/mysql-test ; perl mysql-test-run.pl\n\nPlease report any problems with the /usr/bin/mysqlbug script!\n\n                                              [  OK  ]\nStarting mysqld:                      [  OK  ]\n[Alex@Test01 ~]$ sudo chkconfig mysqld on\n```\n\n#### Initial settings for MySQL\n```\n[root@www ~]#mysql_secure_installation\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\n# Enter\n Enter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\n# set root password\n Set root password? [Y/n]y\n New password:    # input any password\n Re-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\nBy default, a MySQL installation has an anonymous user, allowing anyone\nto log into MySQL without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\n# remove anonymous users\n Remove anonymous users? [Y/n]y\n\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\n# disallow root login remotely\n Disallow root login remotely? [Y/n]y\n\n ... Success!\n\nBy default, MySQL comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\n# remove test database\n Remove test database and access to it? [Y/n]y\n\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\n# reload privilege tables\n Reload privilege tables now? [Y/n]y\n\n ... Success!\n\nCleaning up...\n\nAll done!  If you've completed all of the above steps, your MySQL\ninstallation should now be secure.\n\nThanks for using MySQL!\n\n# try to connect with root\n [root@www ~]#mysql -u root -p\n Enter password:# MySQL root password\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 10\nServer version: 5.1.73 Source distribution\n\nCopyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\n# display user list\n mysql>select user,host,password from mysql.user;\n+------+-----------+-------------------------------------------+\n| user | host      | password                                  |\n+------+-----------+-------------------------------------------+\n| root | localhost | ***************************************** |\n| root | 127.0.0.1 | ***************************************** |\n+------+-----------+-------------------------------------------+\n2 rows in set (0.00 sec)\n\n# display database list\n mysql>show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n+--------------------+\n2 rows in set (0.00 sec)\nmysql>exit\nBye\n```\n","slug":"centos6-6-yum-install-lamp","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq7g001r41tpxr4ow1gf","content":"<blockquote>\n<p>egrep -v “^ <em>#|^ </em>$”     去除所有以#号开头的文件</p>\n</blockquote>\n<h4 id=\"Demo-system\"><a href=\"#Demo-system\" class=\"headerlink\" title=\"Demo system\"></a>Demo system</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]$ uname -a</div><div class=\"line\">Linux Test01 2.6.32-504.el6.x86_64 #1 SMP Wed Oct 15 04:27:16 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</div><div class=\"line\">[Alex@Test01 ~]$ ip addr | grep eth0</div><div class=\"line\">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</div><div class=\"line\">    inet 10.0.2.128/24 brd 10.0.2.255 scope global eth0</div></pre></td></tr></table></figure>\n<h4 id=\"Install-httpd\"><a href=\"#Install-httpd\" class=\"headerlink\" title=\"Install httpd\"></a>Install httpd</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 yum.repos.d]$ sudo yum install -y httpd</div><div class=\"line\">[Alex@Test01 ~]$ rpm -qa | grep httpd</div><div class=\"line\">httpd-2.2.15-39.el6.centos.x86_64</div><div class=\"line\">httpd-tools-2.2.15-39.el6.centos.x86_64</div><div class=\"line\"></div><div class=\"line\"># remove welcome page</div><div class=\"line\">[Alex@Test01 yum.repos.d]$ sudo rm -f /etc/httpd/conf.d/welcome.conf</div><div class=\"line\"># remove default error page</div><div class=\"line\">[Alex@Test01 yum.repos.d]$ sudo rm -f /var/www/error/noindex.html</div></pre></td></tr></table></figure>\n<h4 id=\"Configure-httpd-Replace-the-server-name-to-you-own-one\"><a href=\"#Configure-httpd-Replace-the-server-name-to-you-own-one\" class=\"headerlink\" title=\"Configure httpd . Replace the server name to you own one.\"></a>Configure httpd . Replace the server name to you own one.</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]# sudo vi /etc/httpd/conf/httpd.conf</div><div class=\"line\"># line 44: change</div><div class=\"line\"> ServerTokens Prod</div><div class=\"line\"># line 76: change to ON</div><div class=\"line\"> KeepAlive On</div><div class=\"line\"># line 262: Admin&apos;s address</div><div class=\"line\"> ServerAdmin luchuanjia@msn.com</div><div class=\"line\"># line 338: change</div><div class=\"line\"> AllowOverride All</div><div class=\"line\"># line 276: change to your server&apos;s name</div><div class=\"line\"> ServerName www.ultraera.org:80</div><div class=\"line\"># line 402: add file name that it can access only with directory&apos;s name</div><div class=\"line\"> DirectoryIndex index.html index.htm</div><div class=\"line\"># line 536: change</div><div class=\"line\"> ServerSignature Off</div><div class=\"line\"># line 759: comment out</div><div class=\"line\"># AddDefaultCharset UTF-8</div><div class=\"line\">[Alex@Test01 ~]# sudo /etc/init.d/httpd start</div><div class=\"line\"> Starting httpd:[  OK  ]</div><div class=\"line\">[Alex@Test01 ~]# sudo chkconfig httpd on     # set httpd start with system.</div></pre></td></tr></table></figure>\n<h4 id=\"create-a-HTML-test-page\"><a href=\"#create-a-HTML-test-page\" class=\"headerlink\" title=\"create a HTML test page\"></a>create a HTML test page</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]# sudo vi /var/www/html/index.html</div><div class=\"line\">it&apos;s ok.</div></pre></td></tr></table></figure>\n<p><img src=\"http://s3.51cto.com/wyfs02/M00/70/DE/wKioL1XAUfuQoFfwAACC5LJWQgg039.jpg\" alt=\"\"></p>\n<h4 id=\"Install-PHP\"><a href=\"#Install-PHP\" class=\"headerlink\" title=\"Install PHP.\"></a>Install PHP.</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]$ sudo yum install -y php php-mbstring php-pear</div><div class=\"line\">[Alex@Test01 ~]$ rpm -qa | grep php</div><div class=\"line\">php-common-5.3.3-46.el6_6.x86_64</div><div class=\"line\">php-5.3.3-46.el6_6.x86_64</div><div class=\"line\">php-mbstring-5.3.3-46.el6_6.x86_64</div><div class=\"line\">php-cli-5.3.3-46.el6_6.x86_64</div><div class=\"line\">php-pear-1.9.4-4.el6.noarch</div><div class=\"line\"></div><div class=\"line\">[Alex@Test01 ~]$ sudo vi /etc/httpd/conf/httpd.conf</div><div class=\"line\"># line 402 add file name that it can access only with directory&apos;s name</div><div class=\"line\">  DirectoryIndex index.html index.htm index.php</div><div class=\"line\">[Alex@Test01 ~]$ sudo vi /etc/php.ini</div><div class=\"line\"># line 946 set your timezone</div><div class=\"line\">date.timezone = &quot;Asia/Shanghai&quot;</div><div class=\"line\">[Alex@Test01 ~]$ sudo /etc/init.d/httpd restart</div><div class=\"line\"> Stopping httpd:[  OK  ]</div><div class=\"line\"> Starting httpd:[  OK  ]</div></pre></td></tr></table></figure>\n<h4 id=\"create-a-php-test-page\"><a href=\"#create-a-php-test-page\" class=\"headerlink\" title=\"create a php test page.\"></a>create a php test page.</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]# sudo vi /var/www/html/index.php</div><div class=\"line\"></div><div class=\"line\">&lt;?php</div><div class=\"line\">    phpinfo();</div><div class=\"line\">?&gt;</div></pre></td></tr></table></figure>\n<p><img src=\"http://s3.51cto.com/wyfs02/M02/70/DE/wKioL1XAUguwJCl2AARE16t4hyw682.jpg\" alt=\"\"></p>\n<h4 id=\"Install-MySQL\"><a href=\"#Install-MySQL\" class=\"headerlink\" title=\"Install MySQL\"></a>Install MySQL</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]$ sudo -y install mysql-server</div><div class=\"line\">[Alex@Test01 ~]$ rpm -qa | grep mysql-server</div><div class=\"line\">mysql-server-5.1.73-5.el6_6.x86_64</div><div class=\"line\"></div><div class=\"line\">[Alex@Test01 ~]$ sudo vi /etc/my.cnf</div><div class=\"line\">[mysqld]</div><div class=\"line\">datadir=/var/lib/mysql</div><div class=\"line\">socket=/var/lib/mysql/mysql.sock</div><div class=\"line\">user=mysql</div><div class=\"line\"># Disabling symbolic-links is recommended to prevent assorted security risks</div><div class=\"line\">symbolic-links=0</div><div class=\"line\"># add</div><div class=\"line\">character-set-server=utf8</div><div class=\"line\"></div><div class=\"line\">[Alex@Test01 ~]$ sudo /etc/rc.d/init.d/mysqld start</div><div class=\"line\"></div><div class=\"line\">Initializing MySQL database:  WARNING: The host &apos;www.ultraera.org&apos; could not be looked up with resolveip.</div><div class=\"line\">This probably means that your libc libraries are not 100 % compatible</div><div class=\"line\">with this binary MySQL version. The MySQL daemon, mysqld, should work</div><div class=\"line\">normally with the exception that host name resolving will not work.</div><div class=\"line\">This means that you should use IP addresses instead of hostnames</div><div class=\"line\">when specifying MySQL privileges !</div><div class=\"line\">Installing MySQL system tables...</div><div class=\"line\">OK</div><div class=\"line\">Filling help tables...</div><div class=\"line\">OK</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\">You can test the MySQL daemon with mysql-test-run.pl</div><div class=\"line\">cd /usr/mysql-test ; perl mysql-test-run.pl</div><div class=\"line\"></div><div class=\"line\">Please report any problems with the /usr/bin/mysqlbug script!</div><div class=\"line\"></div><div class=\"line\">                                              [  OK  ]</div><div class=\"line\">Starting mysqld:                      [  OK  ]</div><div class=\"line\">[Alex@Test01 ~]$ sudo chkconfig mysqld on</div></pre></td></tr></table></figure>\n<h4 id=\"Initial-settings-for-MySQL\"><a href=\"#Initial-settings-for-MySQL\" class=\"headerlink\" title=\"Initial settings for MySQL\"></a>Initial settings for MySQL</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@www ~]#mysql_secure_installation</div><div class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</div><div class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</div><div class=\"line\"></div><div class=\"line\">In order to log into MySQL to secure it, we&apos;ll need the current</div><div class=\"line\">password for the root user.  If you&apos;ve just installed MySQL, and</div><div class=\"line\">you haven&apos;t set the root password yet, the password will be blank,</div><div class=\"line\">so you should just press enter here.</div><div class=\"line\"></div><div class=\"line\"># Enter</div><div class=\"line\"> Enter current password for root (enter for none):</div><div class=\"line\">OK, successfully used password, moving on...</div><div class=\"line\"></div><div class=\"line\">Setting the root password ensures that nobody can log into the MySQL</div><div class=\"line\">root user without the proper authorisation.</div><div class=\"line\"></div><div class=\"line\"># set root password</div><div class=\"line\"> Set root password? [Y/n]y</div><div class=\"line\"> New password:    # input any password</div><div class=\"line\"> Re-enter new password:</div><div class=\"line\">Password updated successfully!</div><div class=\"line\">Reloading privilege tables..</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, a MySQL installation has an anonymous user, allowing anyone</div><div class=\"line\">to log into MySQL without having to have a user account created for</div><div class=\"line\">them.  This is intended only for testing, and to make the installation</div><div class=\"line\">go a bit smoother.  You should remove them before moving into a</div><div class=\"line\">production environment.</div><div class=\"line\"></div><div class=\"line\"># remove anonymous users</div><div class=\"line\"> Remove anonymous users? [Y/n]y</div><div class=\"line\"></div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Normally, root should only be allowed to connect from &apos;localhost&apos;.  This</div><div class=\"line\">ensures that someone cannot guess at the root password from the network.</div><div class=\"line\"></div><div class=\"line\"># disallow root login remotely</div><div class=\"line\"> Disallow root login remotely? [Y/n]y</div><div class=\"line\"></div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, MySQL comes with a database named &apos;test&apos; that anyone can</div><div class=\"line\">access.  This is also intended only for testing, and should be removed</div><div class=\"line\">before moving into a production environment.</div><div class=\"line\"></div><div class=\"line\"># remove test database</div><div class=\"line\"> Remove test database and access to it? [Y/n]y</div><div class=\"line\"></div><div class=\"line\"> - Dropping test database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"> - Removing privileges on test database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Reloading the privilege tables will ensure that all changes made so far</div><div class=\"line\">will take effect immediately.</div><div class=\"line\"></div><div class=\"line\"># reload privilege tables</div><div class=\"line\"> Reload privilege tables now? [Y/n]y</div><div class=\"line\"></div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Cleaning up...</div><div class=\"line\"></div><div class=\"line\">All done!  If you&apos;ve completed all of the above steps, your MySQL</div><div class=\"line\">installation should now be secure.</div><div class=\"line\"></div><div class=\"line\">Thanks for using MySQL!</div><div class=\"line\"></div><div class=\"line\"># try to connect with root</div><div class=\"line\"> [root@www ~]#mysql -u root -p</div><div class=\"line\"> Enter password:# MySQL root password</div><div class=\"line\">Welcome to the MySQL monitor.  Commands end with ; or \\g.</div><div class=\"line\">Your MySQL connection id is 10</div><div class=\"line\">Server version: 5.1.73 Source distribution</div><div class=\"line\"></div><div class=\"line\">Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.</div><div class=\"line\"></div><div class=\"line\">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class=\"line\">affiliates. Other names may be trademarks of their respective</div><div class=\"line\">owners.</div><div class=\"line\"></div><div class=\"line\">Type &apos;help;&apos; or &apos;\\h&apos; for help. Type &apos;\\c&apos; to clear the current input statement.</div><div class=\"line\"></div><div class=\"line\"># display user list</div><div class=\"line\"> mysql&gt;select user,host,password from mysql.user;</div><div class=\"line\">+------+-----------+-------------------------------------------+</div><div class=\"line\">| user | host      | password                                  |</div><div class=\"line\">+------+-----------+-------------------------------------------+</div><div class=\"line\">| root | localhost | ***************************************** |</div><div class=\"line\">| root | 127.0.0.1 | ***************************************** |</div><div class=\"line\">+------+-----------+-------------------------------------------+</div><div class=\"line\">2 rows in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\"># display database list</div><div class=\"line\"> mysql&gt;show databases;</div><div class=\"line\">+--------------------+</div><div class=\"line\">| Database           |</div><div class=\"line\">+--------------------+</div><div class=\"line\">| information_schema |</div><div class=\"line\">| mysql              |</div><div class=\"line\">+--------------------+</div><div class=\"line\">2 rows in set (0.00 sec)</div><div class=\"line\">mysql&gt;exit</div><div class=\"line\">Bye</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>egrep -v “^ <em>#|^ </em>$”     去除所有以#号开头的文件</p>\n</blockquote>\n<h4 id=\"Demo-system\"><a href=\"#Demo-system\" class=\"headerlink\" title=\"Demo system\"></a>Demo system</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]$ uname -a</div><div class=\"line\">Linux Test01 2.6.32-504.el6.x86_64 #1 SMP Wed Oct 15 04:27:16 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</div><div class=\"line\">[Alex@Test01 ~]$ ip addr | grep eth0</div><div class=\"line\">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</div><div class=\"line\">    inet 10.0.2.128/24 brd 10.0.2.255 scope global eth0</div></pre></td></tr></table></figure>\n<h4 id=\"Install-httpd\"><a href=\"#Install-httpd\" class=\"headerlink\" title=\"Install httpd\"></a>Install httpd</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 yum.repos.d]$ sudo yum install -y httpd</div><div class=\"line\">[Alex@Test01 ~]$ rpm -qa | grep httpd</div><div class=\"line\">httpd-2.2.15-39.el6.centos.x86_64</div><div class=\"line\">httpd-tools-2.2.15-39.el6.centos.x86_64</div><div class=\"line\"></div><div class=\"line\"># remove welcome page</div><div class=\"line\">[Alex@Test01 yum.repos.d]$ sudo rm -f /etc/httpd/conf.d/welcome.conf</div><div class=\"line\"># remove default error page</div><div class=\"line\">[Alex@Test01 yum.repos.d]$ sudo rm -f /var/www/error/noindex.html</div></pre></td></tr></table></figure>\n<h4 id=\"Configure-httpd-Replace-the-server-name-to-you-own-one\"><a href=\"#Configure-httpd-Replace-the-server-name-to-you-own-one\" class=\"headerlink\" title=\"Configure httpd . Replace the server name to you own one.\"></a>Configure httpd . Replace the server name to you own one.</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]# sudo vi /etc/httpd/conf/httpd.conf</div><div class=\"line\"># line 44: change</div><div class=\"line\"> ServerTokens Prod</div><div class=\"line\"># line 76: change to ON</div><div class=\"line\"> KeepAlive On</div><div class=\"line\"># line 262: Admin&apos;s address</div><div class=\"line\"> ServerAdmin luchuanjia@msn.com</div><div class=\"line\"># line 338: change</div><div class=\"line\"> AllowOverride All</div><div class=\"line\"># line 276: change to your server&apos;s name</div><div class=\"line\"> ServerName www.ultraera.org:80</div><div class=\"line\"># line 402: add file name that it can access only with directory&apos;s name</div><div class=\"line\"> DirectoryIndex index.html index.htm</div><div class=\"line\"># line 536: change</div><div class=\"line\"> ServerSignature Off</div><div class=\"line\"># line 759: comment out</div><div class=\"line\"># AddDefaultCharset UTF-8</div><div class=\"line\">[Alex@Test01 ~]# sudo /etc/init.d/httpd start</div><div class=\"line\"> Starting httpd:[  OK  ]</div><div class=\"line\">[Alex@Test01 ~]# sudo chkconfig httpd on     # set httpd start with system.</div></pre></td></tr></table></figure>\n<h4 id=\"create-a-HTML-test-page\"><a href=\"#create-a-HTML-test-page\" class=\"headerlink\" title=\"create a HTML test page\"></a>create a HTML test page</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]# sudo vi /var/www/html/index.html</div><div class=\"line\">it&apos;s ok.</div></pre></td></tr></table></figure>\n<p><img src=\"http://s3.51cto.com/wyfs02/M00/70/DE/wKioL1XAUfuQoFfwAACC5LJWQgg039.jpg\" alt=\"\"></p>\n<h4 id=\"Install-PHP\"><a href=\"#Install-PHP\" class=\"headerlink\" title=\"Install PHP.\"></a>Install PHP.</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]$ sudo yum install -y php php-mbstring php-pear</div><div class=\"line\">[Alex@Test01 ~]$ rpm -qa | grep php</div><div class=\"line\">php-common-5.3.3-46.el6_6.x86_64</div><div class=\"line\">php-5.3.3-46.el6_6.x86_64</div><div class=\"line\">php-mbstring-5.3.3-46.el6_6.x86_64</div><div class=\"line\">php-cli-5.3.3-46.el6_6.x86_64</div><div class=\"line\">php-pear-1.9.4-4.el6.noarch</div><div class=\"line\"></div><div class=\"line\">[Alex@Test01 ~]$ sudo vi /etc/httpd/conf/httpd.conf</div><div class=\"line\"># line 402 add file name that it can access only with directory&apos;s name</div><div class=\"line\">  DirectoryIndex index.html index.htm index.php</div><div class=\"line\">[Alex@Test01 ~]$ sudo vi /etc/php.ini</div><div class=\"line\"># line 946 set your timezone</div><div class=\"line\">date.timezone = &quot;Asia/Shanghai&quot;</div><div class=\"line\">[Alex@Test01 ~]$ sudo /etc/init.d/httpd restart</div><div class=\"line\"> Stopping httpd:[  OK  ]</div><div class=\"line\"> Starting httpd:[  OK  ]</div></pre></td></tr></table></figure>\n<h4 id=\"create-a-php-test-page\"><a href=\"#create-a-php-test-page\" class=\"headerlink\" title=\"create a php test page.\"></a>create a php test page.</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]# sudo vi /var/www/html/index.php</div><div class=\"line\"></div><div class=\"line\">&lt;?php</div><div class=\"line\">    phpinfo();</div><div class=\"line\">?&gt;</div></pre></td></tr></table></figure>\n<p><img src=\"http://s3.51cto.com/wyfs02/M02/70/DE/wKioL1XAUguwJCl2AARE16t4hyw682.jpg\" alt=\"\"></p>\n<h4 id=\"Install-MySQL\"><a href=\"#Install-MySQL\" class=\"headerlink\" title=\"Install MySQL\"></a>Install MySQL</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">[Alex@Test01 ~]$ sudo -y install mysql-server</div><div class=\"line\">[Alex@Test01 ~]$ rpm -qa | grep mysql-server</div><div class=\"line\">mysql-server-5.1.73-5.el6_6.x86_64</div><div class=\"line\"></div><div class=\"line\">[Alex@Test01 ~]$ sudo vi /etc/my.cnf</div><div class=\"line\">[mysqld]</div><div class=\"line\">datadir=/var/lib/mysql</div><div class=\"line\">socket=/var/lib/mysql/mysql.sock</div><div class=\"line\">user=mysql</div><div class=\"line\"># Disabling symbolic-links is recommended to prevent assorted security risks</div><div class=\"line\">symbolic-links=0</div><div class=\"line\"># add</div><div class=\"line\">character-set-server=utf8</div><div class=\"line\"></div><div class=\"line\">[Alex@Test01 ~]$ sudo /etc/rc.d/init.d/mysqld start</div><div class=\"line\"></div><div class=\"line\">Initializing MySQL database:  WARNING: The host &apos;www.ultraera.org&apos; could not be looked up with resolveip.</div><div class=\"line\">This probably means that your libc libraries are not 100 % compatible</div><div class=\"line\">with this binary MySQL version. The MySQL daemon, mysqld, should work</div><div class=\"line\">normally with the exception that host name resolving will not work.</div><div class=\"line\">This means that you should use IP addresses instead of hostnames</div><div class=\"line\">when specifying MySQL privileges !</div><div class=\"line\">Installing MySQL system tables...</div><div class=\"line\">OK</div><div class=\"line\">Filling help tables...</div><div class=\"line\">OK</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\">You can test the MySQL daemon with mysql-test-run.pl</div><div class=\"line\">cd /usr/mysql-test ; perl mysql-test-run.pl</div><div class=\"line\"></div><div class=\"line\">Please report any problems with the /usr/bin/mysqlbug script!</div><div class=\"line\"></div><div class=\"line\">                                              [  OK  ]</div><div class=\"line\">Starting mysqld:                      [  OK  ]</div><div class=\"line\">[Alex@Test01 ~]$ sudo chkconfig mysqld on</div></pre></td></tr></table></figure>\n<h4 id=\"Initial-settings-for-MySQL\"><a href=\"#Initial-settings-for-MySQL\" class=\"headerlink\" title=\"Initial settings for MySQL\"></a>Initial settings for MySQL</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@www ~]#mysql_secure_installation</div><div class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</div><div class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</div><div class=\"line\"></div><div class=\"line\">In order to log into MySQL to secure it, we&apos;ll need the current</div><div class=\"line\">password for the root user.  If you&apos;ve just installed MySQL, and</div><div class=\"line\">you haven&apos;t set the root password yet, the password will be blank,</div><div class=\"line\">so you should just press enter here.</div><div class=\"line\"></div><div class=\"line\"># Enter</div><div class=\"line\"> Enter current password for root (enter for none):</div><div class=\"line\">OK, successfully used password, moving on...</div><div class=\"line\"></div><div class=\"line\">Setting the root password ensures that nobody can log into the MySQL</div><div class=\"line\">root user without the proper authorisation.</div><div class=\"line\"></div><div class=\"line\"># set root password</div><div class=\"line\"> Set root password? [Y/n]y</div><div class=\"line\"> New password:    # input any password</div><div class=\"line\"> Re-enter new password:</div><div class=\"line\">Password updated successfully!</div><div class=\"line\">Reloading privilege tables..</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, a MySQL installation has an anonymous user, allowing anyone</div><div class=\"line\">to log into MySQL without having to have a user account created for</div><div class=\"line\">them.  This is intended only for testing, and to make the installation</div><div class=\"line\">go a bit smoother.  You should remove them before moving into a</div><div class=\"line\">production environment.</div><div class=\"line\"></div><div class=\"line\"># remove anonymous users</div><div class=\"line\"> Remove anonymous users? [Y/n]y</div><div class=\"line\"></div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Normally, root should only be allowed to connect from &apos;localhost&apos;.  This</div><div class=\"line\">ensures that someone cannot guess at the root password from the network.</div><div class=\"line\"></div><div class=\"line\"># disallow root login remotely</div><div class=\"line\"> Disallow root login remotely? [Y/n]y</div><div class=\"line\"></div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, MySQL comes with a database named &apos;test&apos; that anyone can</div><div class=\"line\">access.  This is also intended only for testing, and should be removed</div><div class=\"line\">before moving into a production environment.</div><div class=\"line\"></div><div class=\"line\"># remove test database</div><div class=\"line\"> Remove test database and access to it? [Y/n]y</div><div class=\"line\"></div><div class=\"line\"> - Dropping test database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"> - Removing privileges on test database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Reloading the privilege tables will ensure that all changes made so far</div><div class=\"line\">will take effect immediately.</div><div class=\"line\"></div><div class=\"line\"># reload privilege tables</div><div class=\"line\"> Reload privilege tables now? [Y/n]y</div><div class=\"line\"></div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Cleaning up...</div><div class=\"line\"></div><div class=\"line\">All done!  If you&apos;ve completed all of the above steps, your MySQL</div><div class=\"line\">installation should now be secure.</div><div class=\"line\"></div><div class=\"line\">Thanks for using MySQL!</div><div class=\"line\"></div><div class=\"line\"># try to connect with root</div><div class=\"line\"> [root@www ~]#mysql -u root -p</div><div class=\"line\"> Enter password:# MySQL root password</div><div class=\"line\">Welcome to the MySQL monitor.  Commands end with ; or \\g.</div><div class=\"line\">Your MySQL connection id is 10</div><div class=\"line\">Server version: 5.1.73 Source distribution</div><div class=\"line\"></div><div class=\"line\">Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.</div><div class=\"line\"></div><div class=\"line\">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class=\"line\">affiliates. Other names may be trademarks of their respective</div><div class=\"line\">owners.</div><div class=\"line\"></div><div class=\"line\">Type &apos;help;&apos; or &apos;\\h&apos; for help. Type &apos;\\c&apos; to clear the current input statement.</div><div class=\"line\"></div><div class=\"line\"># display user list</div><div class=\"line\"> mysql&gt;select user,host,password from mysql.user;</div><div class=\"line\">+------+-----------+-------------------------------------------+</div><div class=\"line\">| user | host      | password                                  |</div><div class=\"line\">+------+-----------+-------------------------------------------+</div><div class=\"line\">| root | localhost | ***************************************** |</div><div class=\"line\">| root | 127.0.0.1 | ***************************************** |</div><div class=\"line\">+------+-----------+-------------------------------------------+</div><div class=\"line\">2 rows in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\"># display database list</div><div class=\"line\"> mysql&gt;show databases;</div><div class=\"line\">+--------------------+</div><div class=\"line\">| Database           |</div><div class=\"line\">+--------------------+</div><div class=\"line\">| information_schema |</div><div class=\"line\">| mysql              |</div><div class=\"line\">+--------------------+</div><div class=\"line\">2 rows in set (0.00 sec)</div><div class=\"line\">mysql&gt;exit</div><div class=\"line\">Bye</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Install MongoDB  on CentOS 6.x","id":"12","updated":"2017-04-21T05:38:53.000Z","date":"2016-03-26T21:55:28.000Z","_content":"\n\n## 1. Overiew\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在CentOS Linux 中安装软件的方式有很多种，我会在后续的文章中整理给大家，我比较喜欢的方式是尽量用Yum 安装，不用自己动手去解决软件包之间的依赖关系，“能Yum 就Yum ，不能Yum 想着法Yum 。”  -- 这是我遵循的真理；今天给大家整理的就是如何使用Yum 来安装Mongodb ，在本文中会给出在32位与64位系统的区别，以及Mongodb 的版本，本文适用于CentOS 6/7 的Linux发行版本，所以同样适用于红帽体系的OS，如 RedHat Enterprise Linux 6/7 、 Fedora 。\n\n## 2. Packages\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业内常用的Mongodb 的Yum 仓库有Mongodb-org 与 Mongodb-10gen ,这里提供的Mongodb-org 的repository 仓库，支持以下软件包列表：\n\n* 2.1 mongodb-org\n\n    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个是源数据包，主要是用来组织自动安装下面的4个软件包.\n\n* 2.2 mongodb-org-sever\n\n   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个Mongodb Server端，包含了相关的配置和初始化脚本。\n\n* 2.3 mongodb-org-mongos\n\n   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个是Mongodb的守护进程。\n\n* 2.4 mongodb-org-shell\n\n    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个是mongodb 的shell环境。\n\n* 2.5 mongodb-org-tools\n\n   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个包里包含了下列mongodb 的工具：mongoimport bsondump, mongodump, mongoexport, mongofiles, mongooplog, mongoperf, mongorestore, mongostat, and mongotop 。\n\n\n## 3. 添加相对应版本的Mongodb repo file.\n\n### 3.1 Mongodb 2.6 + OS x64\n\n```\n[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo\n\n[mongodb-org-2.6]\nname=MongoDB 2.6 Repository\nbaseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/\ngpgcheck=0\nenabled=1\n\n```\n\n### 3.2 Mongodb 2.6 + OS i686\n\n```\n[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo\n\n[mongodb-org-2.6]\nname=MongoDB 2.6 Repository\nbaseurl=http://downloads-distro.mongodb.org/repo/redhat/os/i686/\ngpgcheck=0\nenabled=1\n\n```\n\n### 3.3 Mongodb 3.2  + OS x64\n\n```\n[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo\n\n[mongodb-org-3.2]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/x86_64/\ngpgcheck=0\nenabled=1\n\n```\n\n### 3.4 Mongodb 3.2  + OS i686\n\n```\n[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo\n\n[mongodb-org-3.2]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/i686/\ngpgcheck=0\nenabled=1\n\n```\n\n## 4. Install MongoDB\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;安装最新版本的 Mongodb ，安装都方式一样，请注意安装相对应的源保证正确安装Mongodb，请使用如下命令：\n\n```\n[root@vm02 ~]# yum clean all\n[root@vm02 ~]# yum makecache\n[root@vm02 ~]# yum install mongodb-org\n\n```\n\n## 5. Run MongoDB\n\n### 5.1 配置SELinux\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 默认为开启状态，会导致我们的Mongodb 无法使用，解决方式有两种：\n\n1. [关闭SELinux](http://blog.ultraera.org/centos6-x-base-settings/)\n2. 添加Mongodb 通过SELinux 设定，指令如下：\n\n```\nsemanage port -a -t mongod_port_t -p tcp 27017\n\n```\n> Tips: 在CentOS 7 ，SELinux 会限定你去修改Mongodb的data目录及lib目录。\n\n\n### 5.2 Start MongoDB\n\n```\n[root@vm02 ~]# sudo service mongod start\nStarting mongod:                                           [  OK  ]\n[root@vm02 ~]#\n\n```\n### 5.3 检查MongoDB日志文件验证服务正常启动， /var/log/mongodb/mongodb.log\n\n```\n[root@vm02 ~]# cat /var/log/mongodb/mongod.log  # 看到如下内容表示mongodb启动成功了。\n2016-03-24T04:09:28.582+0800 I NETWORK  [initandlisten] waiting for connections on port 27017\n\n```\n\n### 5.4 设置MongoDB 开机自启动\n\n```\n[root@vm02 ~]# chkconfig mongod on\n\n```\n\n### 5.5 设置MongoDB 允许其他服务器访问\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;默认情况下，mongodb 只监听 127.0.0.1 ，但是实际生产环境中可能需要其他服务器访问，所以这里添加监听其他网络端口，修改mongodb的配置文件：/etc/mongodb.conf\n\n```\n[root@vm02 ~]# vim /etc/mongodb.conf\n\n# line 29 增加一行：\n    bindIp: 172.16.102.129\n\n# 注意不要把1270.0.1 去除，这会导致本地无法使用MongoDB .\n\n```\n\n## 6. Use MongoDB\n\n### 6.1 检查mongodb 状态\n\n```\n[root@vm02 ~]# service mongod status\nmongod (pid 6502) is running...\n[root@vm02 ~]#\n\n```\n\n### 6.2 mongodb 自带检测工具\n\n```\n[root@vm02 ~]# mongostat\ninsert query update delete getmore command % dirty % used flushes  vsize   res qr|qw ar|aw netIn netOut conn                      time\n    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:09+08:00\n    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:10+08:00\n    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:11+08:00\n\n```\n\n### 6.3 进入mongodb 命令行模式\n\n```\n[root@vm02 ~]# mongo\nMongoDB shell version: 3.2.4\nconnecting to: test\nServer has startup warnings:\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/enabled is 'always'.\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] **        We suggest setting it to 'never'\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/defrag is 'always'.\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] **        We suggest setting it to 'never'\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: soft rlimits too low. rlimits set to 1024 processes, 64000 files. Number of processes should be at least 32000 : 0.5 times number of files.\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]\n>\n\n```\n\n## 7. Uninstall MongoDB\n\n### 7.1 关闭mongodb\n\n```\n[root@vm02 ~]# service mongod stop\n\n```\n\n### 7.2 卸载mongodb 软件包\n\n```\n[root@vm02 ~]# yum erase $(rpm -qa | grep mongodb-org)\n\n```\n\n### 7.3 删除mongodb文件：数据库文件和日志文件\n\n```\n[root@vm02 ~]# rm -rf /var/log/mongodb\n[root@vm02 ~]# rm -rf /var/lib/mongo\n\n```\n\n\n## 8. FAQ\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q : Mongodb 占用99%CPU并且查询速度很慢?\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A : 数据库需要首先建立索引，类似图书的目录文件，否则当你在数据库内查找数据的时候，就类似于在整本字典一页页翻查一个字如此。\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/HowTo-Install-MongoDB-on-CentOS-6-x.md","raw":"---\ntitle: HowTo Install MongoDB  on CentOS 6.x\ntags: 'MongoDB'\ncategories: 'MongoDB'\npermalink: mongodb01\nid: 12\nupdated: '2017-04-21 13:38:53'\ndate: 2016-03-27 05:55:28\n---\n\n\n## 1. Overiew\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在CentOS Linux 中安装软件的方式有很多种，我会在后续的文章中整理给大家，我比较喜欢的方式是尽量用Yum 安装，不用自己动手去解决软件包之间的依赖关系，“能Yum 就Yum ，不能Yum 想着法Yum 。”  -- 这是我遵循的真理；今天给大家整理的就是如何使用Yum 来安装Mongodb ，在本文中会给出在32位与64位系统的区别，以及Mongodb 的版本，本文适用于CentOS 6/7 的Linux发行版本，所以同样适用于红帽体系的OS，如 RedHat Enterprise Linux 6/7 、 Fedora 。\n\n## 2. Packages\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业内常用的Mongodb 的Yum 仓库有Mongodb-org 与 Mongodb-10gen ,这里提供的Mongodb-org 的repository 仓库，支持以下软件包列表：\n\n* 2.1 mongodb-org\n\n    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个是源数据包，主要是用来组织自动安装下面的4个软件包.\n\n* 2.2 mongodb-org-sever\n\n   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个Mongodb Server端，包含了相关的配置和初始化脚本。\n\n* 2.3 mongodb-org-mongos\n\n   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个是Mongodb的守护进程。\n\n* 2.4 mongodb-org-shell\n\n    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个是mongodb 的shell环境。\n\n* 2.5 mongodb-org-tools\n\n   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个包里包含了下列mongodb 的工具：mongoimport bsondump, mongodump, mongoexport, mongofiles, mongooplog, mongoperf, mongorestore, mongostat, and mongotop 。\n\n\n## 3. 添加相对应版本的Mongodb repo file.\n\n### 3.1 Mongodb 2.6 + OS x64\n\n```\n[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo\n\n[mongodb-org-2.6]\nname=MongoDB 2.6 Repository\nbaseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/\ngpgcheck=0\nenabled=1\n\n```\n\n### 3.2 Mongodb 2.6 + OS i686\n\n```\n[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo\n\n[mongodb-org-2.6]\nname=MongoDB 2.6 Repository\nbaseurl=http://downloads-distro.mongodb.org/repo/redhat/os/i686/\ngpgcheck=0\nenabled=1\n\n```\n\n### 3.3 Mongodb 3.2  + OS x64\n\n```\n[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo\n\n[mongodb-org-3.2]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/x86_64/\ngpgcheck=0\nenabled=1\n\n```\n\n### 3.4 Mongodb 3.2  + OS i686\n\n```\n[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo\n\n[mongodb-org-3.2]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/i686/\ngpgcheck=0\nenabled=1\n\n```\n\n## 4. Install MongoDB\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;安装最新版本的 Mongodb ，安装都方式一样，请注意安装相对应的源保证正确安装Mongodb，请使用如下命令：\n\n```\n[root@vm02 ~]# yum clean all\n[root@vm02 ~]# yum makecache\n[root@vm02 ~]# yum install mongodb-org\n\n```\n\n## 5. Run MongoDB\n\n### 5.1 配置SELinux\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 默认为开启状态，会导致我们的Mongodb 无法使用，解决方式有两种：\n\n1. [关闭SELinux](http://blog.ultraera.org/centos6-x-base-settings/)\n2. 添加Mongodb 通过SELinux 设定，指令如下：\n\n```\nsemanage port -a -t mongod_port_t -p tcp 27017\n\n```\n> Tips: 在CentOS 7 ，SELinux 会限定你去修改Mongodb的data目录及lib目录。\n\n\n### 5.2 Start MongoDB\n\n```\n[root@vm02 ~]# sudo service mongod start\nStarting mongod:                                           [  OK  ]\n[root@vm02 ~]#\n\n```\n### 5.3 检查MongoDB日志文件验证服务正常启动， /var/log/mongodb/mongodb.log\n\n```\n[root@vm02 ~]# cat /var/log/mongodb/mongod.log  # 看到如下内容表示mongodb启动成功了。\n2016-03-24T04:09:28.582+0800 I NETWORK  [initandlisten] waiting for connections on port 27017\n\n```\n\n### 5.4 设置MongoDB 开机自启动\n\n```\n[root@vm02 ~]# chkconfig mongod on\n\n```\n\n### 5.5 设置MongoDB 允许其他服务器访问\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;默认情况下，mongodb 只监听 127.0.0.1 ，但是实际生产环境中可能需要其他服务器访问，所以这里添加监听其他网络端口，修改mongodb的配置文件：/etc/mongodb.conf\n\n```\n[root@vm02 ~]# vim /etc/mongodb.conf\n\n# line 29 增加一行：\n    bindIp: 172.16.102.129\n\n# 注意不要把1270.0.1 去除，这会导致本地无法使用MongoDB .\n\n```\n\n## 6. Use MongoDB\n\n### 6.1 检查mongodb 状态\n\n```\n[root@vm02 ~]# service mongod status\nmongod (pid 6502) is running...\n[root@vm02 ~]#\n\n```\n\n### 6.2 mongodb 自带检测工具\n\n```\n[root@vm02 ~]# mongostat\ninsert query update delete getmore command % dirty % used flushes  vsize   res qr|qw ar|aw netIn netOut conn                      time\n    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:09+08:00\n    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:10+08:00\n    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:11+08:00\n\n```\n\n### 6.3 进入mongodb 命令行模式\n\n```\n[root@vm02 ~]# mongo\nMongoDB shell version: 3.2.4\nconnecting to: test\nServer has startup warnings:\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/enabled is 'always'.\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] **        We suggest setting it to 'never'\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/defrag is 'always'.\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] **        We suggest setting it to 'never'\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: soft rlimits too low. rlimits set to 1024 processes, 64000 files. Number of processes should be at least 32000 : 0.5 times number of files.\n2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]\n>\n\n```\n\n## 7. Uninstall MongoDB\n\n### 7.1 关闭mongodb\n\n```\n[root@vm02 ~]# service mongod stop\n\n```\n\n### 7.2 卸载mongodb 软件包\n\n```\n[root@vm02 ~]# yum erase $(rpm -qa | grep mongodb-org)\n\n```\n\n### 7.3 删除mongodb文件：数据库文件和日志文件\n\n```\n[root@vm02 ~]# rm -rf /var/log/mongodb\n[root@vm02 ~]# rm -rf /var/lib/mongo\n\n```\n\n\n## 8. FAQ\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q : Mongodb 占用99%CPU并且查询速度很慢?\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A : 数据库需要首先建立索引，类似图书的目录文件，否则当你在数据库内查找数据的时候，就类似于在整本字典一页页翻查一个字如此。\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"mongodb01","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq7m001u41tpba8qjofg","content":"<h2 id=\"1-Overiew\"><a href=\"#1-Overiew\" class=\"headerlink\" title=\"1. Overiew\"></a>1. Overiew</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在CentOS Linux 中安装软件的方式有很多种，我会在后续的文章中整理给大家，我比较喜欢的方式是尽量用Yum 安装，不用自己动手去解决软件包之间的依赖关系，“能Yum 就Yum ，不能Yum 想着法Yum 。”  – 这是我遵循的真理；今天给大家整理的就是如何使用Yum 来安装Mongodb ，在本文中会给出在32位与64位系统的区别，以及Mongodb 的版本，本文适用于CentOS 6/7 的Linux发行版本，所以同样适用于红帽体系的OS，如 RedHat Enterprise Linux 6/7 、 Fedora 。</p>\n<h2 id=\"2-Packages\"><a href=\"#2-Packages\" class=\"headerlink\" title=\"2. Packages\"></a>2. Packages</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业内常用的Mongodb 的Yum 仓库有Mongodb-org 与 Mongodb-10gen ,这里提供的Mongodb-org 的repository 仓库，支持以下软件包列表：</p>\n<ul>\n<li><p>2.1 mongodb-org</p>\n<p>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个是源数据包，主要是用来组织自动安装下面的4个软件包.</p>\n</li>\n<li><p>2.2 mongodb-org-sever</p>\n<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个Mongodb Server端，包含了相关的配置和初始化脚本。</p>\n</li>\n<li><p>2.3 mongodb-org-mongos</p>\n<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个是Mongodb的守护进程。</p>\n</li>\n<li><p>2.4 mongodb-org-shell</p>\n<p>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个是mongodb 的shell环境。</p>\n</li>\n<li><p>2.5 mongodb-org-tools</p>\n<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个包里包含了下列mongodb 的工具：mongoimport bsondump, mongodump, mongoexport, mongofiles, mongooplog, mongoperf, mongorestore, mongostat, and mongotop 。</p>\n</li>\n</ul>\n<h2 id=\"3-添加相对应版本的Mongodb-repo-file\"><a href=\"#3-添加相对应版本的Mongodb-repo-file\" class=\"headerlink\" title=\"3. 添加相对应版本的Mongodb repo file.\"></a>3. 添加相对应版本的Mongodb repo file.</h2><h3 id=\"3-1-Mongodb-2-6-OS-x64\"><a href=\"#3-1-Mongodb-2-6-OS-x64\" class=\"headerlink\" title=\"3.1 Mongodb 2.6 + OS x64\"></a>3.1 Mongodb 2.6 + OS x64</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo</div><div class=\"line\"></div><div class=\"line\">[mongodb-org-2.6]</div><div class=\"line\">name=MongoDB 2.6 Repository</div><div class=\"line\">baseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">enabled=1</div></pre></td></tr></table></figure>\n<h3 id=\"3-2-Mongodb-2-6-OS-i686\"><a href=\"#3-2-Mongodb-2-6-OS-i686\" class=\"headerlink\" title=\"3.2 Mongodb 2.6 + OS i686\"></a>3.2 Mongodb 2.6 + OS i686</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo</div><div class=\"line\"></div><div class=\"line\">[mongodb-org-2.6]</div><div class=\"line\">name=MongoDB 2.6 Repository</div><div class=\"line\">baseurl=http://downloads-distro.mongodb.org/repo/redhat/os/i686/</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">enabled=1</div></pre></td></tr></table></figure>\n<h3 id=\"3-3-Mongodb-3-2-OS-x64\"><a href=\"#3-3-Mongodb-3-2-OS-x64\" class=\"headerlink\" title=\"3.3 Mongodb 3.2  + OS x64\"></a>3.3 Mongodb 3.2  + OS x64</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo</div><div class=\"line\"></div><div class=\"line\">[mongodb-org-3.2]</div><div class=\"line\">name=MongoDB Repository</div><div class=\"line\">baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/x86_64/</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">enabled=1</div></pre></td></tr></table></figure>\n<h3 id=\"3-4-Mongodb-3-2-OS-i686\"><a href=\"#3-4-Mongodb-3-2-OS-i686\" class=\"headerlink\" title=\"3.4 Mongodb 3.2  + OS i686\"></a>3.4 Mongodb 3.2  + OS i686</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo</div><div class=\"line\"></div><div class=\"line\">[mongodb-org-3.2]</div><div class=\"line\">name=MongoDB Repository</div><div class=\"line\">baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/i686/</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">enabled=1</div></pre></td></tr></table></figure>\n<h2 id=\"4-Install-MongoDB\"><a href=\"#4-Install-MongoDB\" class=\"headerlink\" title=\"4. Install MongoDB\"></a>4. Install MongoDB</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;安装最新版本的 Mongodb ，安装都方式一样，请注意安装相对应的源保证正确安装Mongodb，请使用如下命令：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# yum clean all</div><div class=\"line\">[root@vm02 ~]# yum makecache</div><div class=\"line\">[root@vm02 ~]# yum install mongodb-org</div></pre></td></tr></table></figure>\n<h2 id=\"5-Run-MongoDB\"><a href=\"#5-Run-MongoDB\" class=\"headerlink\" title=\"5. Run MongoDB\"></a>5. Run MongoDB</h2><h3 id=\"5-1-配置SELinux\"><a href=\"#5-1-配置SELinux\" class=\"headerlink\" title=\"5.1 配置SELinux\"></a>5.1 配置SELinux</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 默认为开启状态，会导致我们的Mongodb 无法使用，解决方式有两种：</p>\n<ol>\n<li><a href=\"http://blog.ultraera.org/centos6-x-base-settings/\" target=\"_blank\" rel=\"external\">关闭SELinux</a></li>\n<li>添加Mongodb 通过SELinux 设定，指令如下：</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">semanage port -a -t mongod_port_t -p tcp 27017</div></pre></td></tr></table></figure>\n<blockquote>\n<p>Tips: 在CentOS 7 ，SELinux 会限定你去修改Mongodb的data目录及lib目录。</p>\n</blockquote>\n<h3 id=\"5-2-Start-MongoDB\"><a href=\"#5-2-Start-MongoDB\" class=\"headerlink\" title=\"5.2 Start MongoDB\"></a>5.2 Start MongoDB</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# sudo service mongod start</div><div class=\"line\">Starting mongod:                                           [  OK  ]</div><div class=\"line\">[root@vm02 ~]#</div></pre></td></tr></table></figure>\n<h3 id=\"5-3-检查MongoDB日志文件验证服务正常启动，-var-log-mongodb-mongodb-log\"><a href=\"#5-3-检查MongoDB日志文件验证服务正常启动，-var-log-mongodb-mongodb-log\" class=\"headerlink\" title=\"5.3 检查MongoDB日志文件验证服务正常启动， /var/log/mongodb/mongodb.log\"></a>5.3 检查MongoDB日志文件验证服务正常启动， /var/log/mongodb/mongodb.log</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# cat /var/log/mongodb/mongod.log  # 看到如下内容表示mongodb启动成功了。</div><div class=\"line\">2016-03-24T04:09:28.582+0800 I NETWORK  [initandlisten] waiting for connections on port 27017</div></pre></td></tr></table></figure>\n<h3 id=\"5-4-设置MongoDB-开机自启动\"><a href=\"#5-4-设置MongoDB-开机自启动\" class=\"headerlink\" title=\"5.4 设置MongoDB 开机自启动\"></a>5.4 设置MongoDB 开机自启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# chkconfig mongod on</div></pre></td></tr></table></figure>\n<h3 id=\"5-5-设置MongoDB-允许其他服务器访问\"><a href=\"#5-5-设置MongoDB-允许其他服务器访问\" class=\"headerlink\" title=\"5.5 设置MongoDB 允许其他服务器访问\"></a>5.5 设置MongoDB 允许其他服务器访问</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;默认情况下，mongodb 只监听 127.0.0.1 ，但是实际生产环境中可能需要其他服务器访问，所以这里添加监听其他网络端口，修改mongodb的配置文件：/etc/mongodb.conf</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/mongodb.conf</div><div class=\"line\"></div><div class=\"line\"># line 29 增加一行：</div><div class=\"line\">    bindIp: 172.16.102.129</div><div class=\"line\"></div><div class=\"line\"># 注意不要把1270.0.1 去除，这会导致本地无法使用MongoDB .</div></pre></td></tr></table></figure>\n<h2 id=\"6-Use-MongoDB\"><a href=\"#6-Use-MongoDB\" class=\"headerlink\" title=\"6. Use MongoDB\"></a>6. Use MongoDB</h2><h3 id=\"6-1-检查mongodb-状态\"><a href=\"#6-1-检查mongodb-状态\" class=\"headerlink\" title=\"6.1 检查mongodb 状态\"></a>6.1 检查mongodb 状态</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# service mongod status</div><div class=\"line\">mongod (pid 6502) is running...</div><div class=\"line\">[root@vm02 ~]#</div></pre></td></tr></table></figure>\n<h3 id=\"6-2-mongodb-自带检测工具\"><a href=\"#6-2-mongodb-自带检测工具\" class=\"headerlink\" title=\"6.2 mongodb 自带检测工具\"></a>6.2 mongodb 自带检测工具</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# mongostat</div><div class=\"line\">insert query update delete getmore command % dirty % used flushes  vsize   res qr|qw ar|aw netIn netOut conn                      time</div><div class=\"line\">    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:09+08:00</div><div class=\"line\">    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:10+08:00</div><div class=\"line\">    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:11+08:00</div></pre></td></tr></table></figure>\n<h3 id=\"6-3-进入mongodb-命令行模式\"><a href=\"#6-3-进入mongodb-命令行模式\" class=\"headerlink\" title=\"6.3 进入mongodb 命令行模式\"></a>6.3 进入mongodb 命令行模式</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# mongo</div><div class=\"line\">MongoDB shell version: 3.2.4</div><div class=\"line\">connecting to: test</div><div class=\"line\">Server has startup warnings:</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/enabled is &apos;always&apos;.</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] **        We suggest setting it to &apos;never&apos;</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/defrag is &apos;always&apos;.</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] **        We suggest setting it to &apos;never&apos;</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: soft rlimits too low. rlimits set to 1024 processes, 64000 files. Number of processes should be at least 32000 : 0.5 times number of files.</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]</div><div class=\"line\">&gt;</div></pre></td></tr></table></figure>\n<h2 id=\"7-Uninstall-MongoDB\"><a href=\"#7-Uninstall-MongoDB\" class=\"headerlink\" title=\"7. Uninstall MongoDB\"></a>7. Uninstall MongoDB</h2><h3 id=\"7-1-关闭mongodb\"><a href=\"#7-1-关闭mongodb\" class=\"headerlink\" title=\"7.1 关闭mongodb\"></a>7.1 关闭mongodb</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# service mongod stop</div></pre></td></tr></table></figure>\n<h3 id=\"7-2-卸载mongodb-软件包\"><a href=\"#7-2-卸载mongodb-软件包\" class=\"headerlink\" title=\"7.2 卸载mongodb 软件包\"></a>7.2 卸载mongodb 软件包</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# yum erase $(rpm -qa | grep mongodb-org)</div></pre></td></tr></table></figure>\n<h3 id=\"7-3-删除mongodb文件：数据库文件和日志文件\"><a href=\"#7-3-删除mongodb文件：数据库文件和日志文件\" class=\"headerlink\" title=\"7.3 删除mongodb文件：数据库文件和日志文件\"></a>7.3 删除mongodb文件：数据库文件和日志文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# rm -rf /var/log/mongodb</div><div class=\"line\">[root@vm02 ~]# rm -rf /var/lib/mongo</div></pre></td></tr></table></figure>\n<h2 id=\"8-FAQ\"><a href=\"#8-FAQ\" class=\"headerlink\" title=\"8. FAQ\"></a>8. FAQ</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q : Mongodb 占用99%CPU并且查询速度很慢?</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A : 数据库需要首先建立索引，类似图书的目录文件，否则当你在数据库内查找数据的时候，就类似于在整本字典一页页翻查一个字如此。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"1-Overiew\"><a href=\"#1-Overiew\" class=\"headerlink\" title=\"1. Overiew\"></a>1. Overiew</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在CentOS Linux 中安装软件的方式有很多种，我会在后续的文章中整理给大家，我比较喜欢的方式是尽量用Yum 安装，不用自己动手去解决软件包之间的依赖关系，“能Yum 就Yum ，不能Yum 想着法Yum 。”  – 这是我遵循的真理；今天给大家整理的就是如何使用Yum 来安装Mongodb ，在本文中会给出在32位与64位系统的区别，以及Mongodb 的版本，本文适用于CentOS 6/7 的Linux发行版本，所以同样适用于红帽体系的OS，如 RedHat Enterprise Linux 6/7 、 Fedora 。</p>\n<h2 id=\"2-Packages\"><a href=\"#2-Packages\" class=\"headerlink\" title=\"2. Packages\"></a>2. Packages</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业内常用的Mongodb 的Yum 仓库有Mongodb-org 与 Mongodb-10gen ,这里提供的Mongodb-org 的repository 仓库，支持以下软件包列表：</p>\n<ul>\n<li><p>2.1 mongodb-org</p>\n<p>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个是源数据包，主要是用来组织自动安装下面的4个软件包.</p>\n</li>\n<li><p>2.2 mongodb-org-sever</p>\n<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个Mongodb Server端，包含了相关的配置和初始化脚本。</p>\n</li>\n<li><p>2.3 mongodb-org-mongos</p>\n<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个是Mongodb的守护进程。</p>\n</li>\n<li><p>2.4 mongodb-org-shell</p>\n<p>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个是mongodb 的shell环境。</p>\n</li>\n<li><p>2.5 mongodb-org-tools</p>\n<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这个包里包含了下列mongodb 的工具：mongoimport bsondump, mongodump, mongoexport, mongofiles, mongooplog, mongoperf, mongorestore, mongostat, and mongotop 。</p>\n</li>\n</ul>\n<h2 id=\"3-添加相对应版本的Mongodb-repo-file\"><a href=\"#3-添加相对应版本的Mongodb-repo-file\" class=\"headerlink\" title=\"3. 添加相对应版本的Mongodb repo file.\"></a>3. 添加相对应版本的Mongodb repo file.</h2><h3 id=\"3-1-Mongodb-2-6-OS-x64\"><a href=\"#3-1-Mongodb-2-6-OS-x64\" class=\"headerlink\" title=\"3.1 Mongodb 2.6 + OS x64\"></a>3.1 Mongodb 2.6 + OS x64</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo</div><div class=\"line\"></div><div class=\"line\">[mongodb-org-2.6]</div><div class=\"line\">name=MongoDB 2.6 Repository</div><div class=\"line\">baseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">enabled=1</div></pre></td></tr></table></figure>\n<h3 id=\"3-2-Mongodb-2-6-OS-i686\"><a href=\"#3-2-Mongodb-2-6-OS-i686\" class=\"headerlink\" title=\"3.2 Mongodb 2.6 + OS i686\"></a>3.2 Mongodb 2.6 + OS i686</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo</div><div class=\"line\"></div><div class=\"line\">[mongodb-org-2.6]</div><div class=\"line\">name=MongoDB 2.6 Repository</div><div class=\"line\">baseurl=http://downloads-distro.mongodb.org/repo/redhat/os/i686/</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">enabled=1</div></pre></td></tr></table></figure>\n<h3 id=\"3-3-Mongodb-3-2-OS-x64\"><a href=\"#3-3-Mongodb-3-2-OS-x64\" class=\"headerlink\" title=\"3.3 Mongodb 3.2  + OS x64\"></a>3.3 Mongodb 3.2  + OS x64</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo</div><div class=\"line\"></div><div class=\"line\">[mongodb-org-3.2]</div><div class=\"line\">name=MongoDB Repository</div><div class=\"line\">baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/x86_64/</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">enabled=1</div></pre></td></tr></table></figure>\n<h3 id=\"3-4-Mongodb-3-2-OS-i686\"><a href=\"#3-4-Mongodb-3-2-OS-i686\" class=\"headerlink\" title=\"3.4 Mongodb 3.2  + OS i686\"></a>3.4 Mongodb 3.2  + OS i686</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo</div><div class=\"line\"></div><div class=\"line\">[mongodb-org-3.2]</div><div class=\"line\">name=MongoDB Repository</div><div class=\"line\">baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/i686/</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">enabled=1</div></pre></td></tr></table></figure>\n<h2 id=\"4-Install-MongoDB\"><a href=\"#4-Install-MongoDB\" class=\"headerlink\" title=\"4. Install MongoDB\"></a>4. Install MongoDB</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;安装最新版本的 Mongodb ，安装都方式一样，请注意安装相对应的源保证正确安装Mongodb，请使用如下命令：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# yum clean all</div><div class=\"line\">[root@vm02 ~]# yum makecache</div><div class=\"line\">[root@vm02 ~]# yum install mongodb-org</div></pre></td></tr></table></figure>\n<h2 id=\"5-Run-MongoDB\"><a href=\"#5-Run-MongoDB\" class=\"headerlink\" title=\"5. Run MongoDB\"></a>5. Run MongoDB</h2><h3 id=\"5-1-配置SELinux\"><a href=\"#5-1-配置SELinux\" class=\"headerlink\" title=\"5.1 配置SELinux\"></a>5.1 配置SELinux</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELinux 默认为开启状态，会导致我们的Mongodb 无法使用，解决方式有两种：</p>\n<ol>\n<li><a href=\"http://blog.ultraera.org/centos6-x-base-settings/\">关闭SELinux</a></li>\n<li>添加Mongodb 通过SELinux 设定，指令如下：</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">semanage port -a -t mongod_port_t -p tcp 27017</div></pre></td></tr></table></figure>\n<blockquote>\n<p>Tips: 在CentOS 7 ，SELinux 会限定你去修改Mongodb的data目录及lib目录。</p>\n</blockquote>\n<h3 id=\"5-2-Start-MongoDB\"><a href=\"#5-2-Start-MongoDB\" class=\"headerlink\" title=\"5.2 Start MongoDB\"></a>5.2 Start MongoDB</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# sudo service mongod start</div><div class=\"line\">Starting mongod:                                           [  OK  ]</div><div class=\"line\">[root@vm02 ~]#</div></pre></td></tr></table></figure>\n<h3 id=\"5-3-检查MongoDB日志文件验证服务正常启动，-var-log-mongodb-mongodb-log\"><a href=\"#5-3-检查MongoDB日志文件验证服务正常启动，-var-log-mongodb-mongodb-log\" class=\"headerlink\" title=\"5.3 检查MongoDB日志文件验证服务正常启动， /var/log/mongodb/mongodb.log\"></a>5.3 检查MongoDB日志文件验证服务正常启动， /var/log/mongodb/mongodb.log</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# cat /var/log/mongodb/mongod.log  # 看到如下内容表示mongodb启动成功了。</div><div class=\"line\">2016-03-24T04:09:28.582+0800 I NETWORK  [initandlisten] waiting for connections on port 27017</div></pre></td></tr></table></figure>\n<h3 id=\"5-4-设置MongoDB-开机自启动\"><a href=\"#5-4-设置MongoDB-开机自启动\" class=\"headerlink\" title=\"5.4 设置MongoDB 开机自启动\"></a>5.4 设置MongoDB 开机自启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# chkconfig mongod on</div></pre></td></tr></table></figure>\n<h3 id=\"5-5-设置MongoDB-允许其他服务器访问\"><a href=\"#5-5-设置MongoDB-允许其他服务器访问\" class=\"headerlink\" title=\"5.5 设置MongoDB 允许其他服务器访问\"></a>5.5 设置MongoDB 允许其他服务器访问</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;默认情况下，mongodb 只监听 127.0.0.1 ，但是实际生产环境中可能需要其他服务器访问，所以这里添加监听其他网络端口，修改mongodb的配置文件：/etc/mongodb.conf</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# vim /etc/mongodb.conf</div><div class=\"line\"></div><div class=\"line\"># line 29 增加一行：</div><div class=\"line\">    bindIp: 172.16.102.129</div><div class=\"line\"></div><div class=\"line\"># 注意不要把1270.0.1 去除，这会导致本地无法使用MongoDB .</div></pre></td></tr></table></figure>\n<h2 id=\"6-Use-MongoDB\"><a href=\"#6-Use-MongoDB\" class=\"headerlink\" title=\"6. Use MongoDB\"></a>6. Use MongoDB</h2><h3 id=\"6-1-检查mongodb-状态\"><a href=\"#6-1-检查mongodb-状态\" class=\"headerlink\" title=\"6.1 检查mongodb 状态\"></a>6.1 检查mongodb 状态</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# service mongod status</div><div class=\"line\">mongod (pid 6502) is running...</div><div class=\"line\">[root@vm02 ~]#</div></pre></td></tr></table></figure>\n<h3 id=\"6-2-mongodb-自带检测工具\"><a href=\"#6-2-mongodb-自带检测工具\" class=\"headerlink\" title=\"6.2 mongodb 自带检测工具\"></a>6.2 mongodb 自带检测工具</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# mongostat</div><div class=\"line\">insert query update delete getmore command % dirty % used flushes  vsize   res qr|qw ar|aw netIn netOut conn                      time</div><div class=\"line\">    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:09+08:00</div><div class=\"line\">    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:10+08:00</div><div class=\"line\">    *0    *0     *0     *0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:11+08:00</div></pre></td></tr></table></figure>\n<h3 id=\"6-3-进入mongodb-命令行模式\"><a href=\"#6-3-进入mongodb-命令行模式\" class=\"headerlink\" title=\"6.3 进入mongodb 命令行模式\"></a>6.3 进入mongodb 命令行模式</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# mongo</div><div class=\"line\">MongoDB shell version: 3.2.4</div><div class=\"line\">connecting to: test</div><div class=\"line\">Server has startup warnings:</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/enabled is &apos;always&apos;.</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] **        We suggest setting it to &apos;never&apos;</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/defrag is &apos;always&apos;.</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] **        We suggest setting it to &apos;never&apos;</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten] ** WARNING: soft rlimits too low. rlimits set to 1024 processes, 64000 files. Number of processes should be at least 32000 : 0.5 times number of files.</div><div class=\"line\">2016-03-24T04:09:28.577+0800 I CONTROL  [initandlisten]</div><div class=\"line\">&gt;</div></pre></td></tr></table></figure>\n<h2 id=\"7-Uninstall-MongoDB\"><a href=\"#7-Uninstall-MongoDB\" class=\"headerlink\" title=\"7. Uninstall MongoDB\"></a>7. Uninstall MongoDB</h2><h3 id=\"7-1-关闭mongodb\"><a href=\"#7-1-关闭mongodb\" class=\"headerlink\" title=\"7.1 关闭mongodb\"></a>7.1 关闭mongodb</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# service mongod stop</div></pre></td></tr></table></figure>\n<h3 id=\"7-2-卸载mongodb-软件包\"><a href=\"#7-2-卸载mongodb-软件包\" class=\"headerlink\" title=\"7.2 卸载mongodb 软件包\"></a>7.2 卸载mongodb 软件包</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# yum erase $(rpm -qa | grep mongodb-org)</div></pre></td></tr></table></figure>\n<h3 id=\"7-3-删除mongodb文件：数据库文件和日志文件\"><a href=\"#7-3-删除mongodb文件：数据库文件和日志文件\" class=\"headerlink\" title=\"7.3 删除mongodb文件：数据库文件和日志文件\"></a>7.3 删除mongodb文件：数据库文件和日志文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm02 ~]# rm -rf /var/log/mongodb</div><div class=\"line\">[root@vm02 ~]# rm -rf /var/lib/mongo</div></pre></td></tr></table></figure>\n<h2 id=\"8-FAQ\"><a href=\"#8-FAQ\" class=\"headerlink\" title=\"8. FAQ\"></a>8. FAQ</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q : Mongodb 占用99%CPU并且查询速度很慢?</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A : 数据库需要首先建立索引，类似图书的目录文件，否则当你在数据库内查找数据的时候，就类似于在整本字典一页页翻查一个字如此。</p>\n"},{"title":"HowTo Install MySQL 5.5/6/7 on RHEL/CentOS 5/6/7","id":"64","updated":"2017-04-21T05:25:55.000Z","date":"2016-07-06T21:35:32.000Z","_content":"\n## <font color=red>Install Mysql 5.5 on RHEL/CentOS 5/6/7 </font>\n\n### **Setup 1. Use Repository.**\n\nFirst, to set up the yum repository, install the mysql－community-server 5.5 RPM based on your CentOS/RHEL release: <br>\n\n---\n#### **mysql-server-5.5.repo for CentOS/RHEL 5.x**\n```\nrpm -Uvh http://mirror.webtatic.com/yum/el5/latest.rpm\n```\n#### * **Only Install MySQL 5.5 On CentOS 5.x**\nIf you already have MySql client or server installed (rpm -q mysql mysql-server), then you can upgrade using the following method:<br>\n```\nyum install mysql.`uname -i` yum-plugin-replace\nyum replace mysql --replace-with mysql55w\n```\n\n“yum install mysql” is only there to make sure yum-plugin-replace can resolve dependencies correctly if only mysql-server was installed.<br>\nOtherwise, to install MySql client and server, then run:<br>\n```\nyum install mysql55w mysql55w-server\n```\n---\n\n#### **mysql-server-5.5.repo for CentOS/RHEL 6.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.5-community/el/6/x86_64/mysql-community-release-el6-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.5-community/el/6/i386/mysql-community-release-el6-5.noarch.rpm\n```\n\n#### **mysql-server-5.5.repo for CentOS/RHEL 7.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.5-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.5-community/el/7/i386/mysql-community-release-el7-5.noarch.rpm\n```\n\n### **Setup 2. Install MySQL Server 5.5**\nIf you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br>\n```\n# It's RHEL/CentOS 6/7\nyum remove -y mysql-server\nyum remove -y mysql*\n```\n\nIf you don't have mysql-server was installed.<br>\nOtherwise, to install MySql client and server, then run:<br>\n```\nyum install -y mysql-community-server\n```\n\n### **Setup 3. Service Configure**\nYou should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br>\n```\nservice mysqld start\n```\nThis will issue a password prompt for the user. If you don't have a root user password, remove the \"-p\"<br>\n```\nmysql_secure_installation\n```\n\n## <font color=red>Install Mysql 5.6 on RHEL/CentOS 5/6/7 </font>\n\n### **Setup 1. Use Repository.**\n\nFirst, to set up the yum repository, install the mysql－community-server 5.6 RPM based on your CentOS/RHEL release: <br>\n\n#### **mysql-server-5.6.repo for CentOS/RHEL 5.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/5/x86_64/mysql-community-release-el5-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/5/i386/mysql-community-release-el5-5.noarch.rpm\n```\n\n#### **mysql-server-5.6.repo for CentOS/RHEL 6.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/x86_64/mysql-community-release-el6-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/i386/mysql-community-release-el6-5.noarch.rpm\n```\n\n#### **mysql-server-5.6.repo for CentOS/RHEL 7.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/7/i386/mysql-community-release-el7-5.noarch.rpm\n```\n\n\n### **Setup 2. Install MySQL Server 5.6**\nIf you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br>\n```\nyum remove -y mysql-server\nyum remove -y mysql*\n```\n\nIf you don't have mysql-server was installed.<br>\nOtherwise, to install MySql client and server, then run:<br>\n```\nyum install -y mysql-community-server\n```\n\n### **Setup 3. Service Configure**\nYou should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br>\n```\nservice mysqld start\n```\nThis will issue a password prompt for the user. If you don't have a root user password, remove the \"-p\"<br>\n```\nmysql_secure_installation\n```\n\n## <font color=red>Install Mysql 5.7 on RHEL/CentOS 5/6/7 </font>\n\n### **Setup 1. Use Repository.**\n\nFirst, to set up the yum repository, install the mysql－community-server 5.7 RPM based on your CentOS/RHEL release: <br>\n\n#### **mysql-server-5.7.repo for CentOS/RHEL 5.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/5/x86_64/mysql-community-release-el5-7.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/5/i386/mysql-community-release-el5-7.noarch.rpm\n```\n\n#### **mysql-server-5.7.repo for CentOS/RHEL 6.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/6/x86_64/mysql-community-release-el6-7.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/6/i386/mysql-community-release-el6-7.noarch.rpm\n```\n\n#### **mysql-server-5.7.repo for CentOS/RHEL 7.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql-community-release-el7-7.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/7/i386/mysql-community-release-el7-7.noarch.rpm\n```\n\n\n### **Setup 2. Install MySQL Server 5.7**\nIf you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br>\n```\nyum remove -y mysql-server\nyum remove -y mysql*\n```\n\nIf you don't have mysql-server was installed.<br>\nOtherwise, to install MySql client and server, then run:<br>\n```\nyum install -y mysql-community-server\n```\n\n### **Setup 3. Service Configure**\nYou should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br>\n```\nservice mysqld start\n```\nThis will issue a password prompt for the user. If you don't have a root user password, remove the \"-p\"<br>\n```\nmysql_secure_installation\n```\n\n\n\n\n\n\n","source":"_posts/HowTo-Install-MySQL-5-5-6-7-on-RHEL-CentOS-5-6-7.md","raw":"---\ntitle: HowTo Install MySQL 5.5/6/7 on RHEL/CentOS 5/6/7\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: how-to-install-mysql-5-6-on-centos\nid: 64\nupdated: '2017-04-21 13:25:55'\ndate: 2016-07-07 05:35:32\n---\n\n## <font color=red>Install Mysql 5.5 on RHEL/CentOS 5/6/7 </font>\n\n### **Setup 1. Use Repository.**\n\nFirst, to set up the yum repository, install the mysql－community-server 5.5 RPM based on your CentOS/RHEL release: <br>\n\n---\n#### **mysql-server-5.5.repo for CentOS/RHEL 5.x**\n```\nrpm -Uvh http://mirror.webtatic.com/yum/el5/latest.rpm\n```\n#### * **Only Install MySQL 5.5 On CentOS 5.x**\nIf you already have MySql client or server installed (rpm -q mysql mysql-server), then you can upgrade using the following method:<br>\n```\nyum install mysql.`uname -i` yum-plugin-replace\nyum replace mysql --replace-with mysql55w\n```\n\n“yum install mysql” is only there to make sure yum-plugin-replace can resolve dependencies correctly if only mysql-server was installed.<br>\nOtherwise, to install MySql client and server, then run:<br>\n```\nyum install mysql55w mysql55w-server\n```\n---\n\n#### **mysql-server-5.5.repo for CentOS/RHEL 6.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.5-community/el/6/x86_64/mysql-community-release-el6-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.5-community/el/6/i386/mysql-community-release-el6-5.noarch.rpm\n```\n\n#### **mysql-server-5.5.repo for CentOS/RHEL 7.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.5-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.5-community/el/7/i386/mysql-community-release-el7-5.noarch.rpm\n```\n\n### **Setup 2. Install MySQL Server 5.5**\nIf you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br>\n```\n# It's RHEL/CentOS 6/7\nyum remove -y mysql-server\nyum remove -y mysql*\n```\n\nIf you don't have mysql-server was installed.<br>\nOtherwise, to install MySql client and server, then run:<br>\n```\nyum install -y mysql-community-server\n```\n\n### **Setup 3. Service Configure**\nYou should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br>\n```\nservice mysqld start\n```\nThis will issue a password prompt for the user. If you don't have a root user password, remove the \"-p\"<br>\n```\nmysql_secure_installation\n```\n\n## <font color=red>Install Mysql 5.6 on RHEL/CentOS 5/6/7 </font>\n\n### **Setup 1. Use Repository.**\n\nFirst, to set up the yum repository, install the mysql－community-server 5.6 RPM based on your CentOS/RHEL release: <br>\n\n#### **mysql-server-5.6.repo for CentOS/RHEL 5.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/5/x86_64/mysql-community-release-el5-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/5/i386/mysql-community-release-el5-5.noarch.rpm\n```\n\n#### **mysql-server-5.6.repo for CentOS/RHEL 6.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/x86_64/mysql-community-release-el6-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/i386/mysql-community-release-el6-5.noarch.rpm\n```\n\n#### **mysql-server-5.6.repo for CentOS/RHEL 7.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.6-community/el/7/i386/mysql-community-release-el7-5.noarch.rpm\n```\n\n\n### **Setup 2. Install MySQL Server 5.6**\nIf you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br>\n```\nyum remove -y mysql-server\nyum remove -y mysql*\n```\n\nIf you don't have mysql-server was installed.<br>\nOtherwise, to install MySql client and server, then run:<br>\n```\nyum install -y mysql-community-server\n```\n\n### **Setup 3. Service Configure**\nYou should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br>\n```\nservice mysqld start\n```\nThis will issue a password prompt for the user. If you don't have a root user password, remove the \"-p\"<br>\n```\nmysql_secure_installation\n```\n\n## <font color=red>Install Mysql 5.7 on RHEL/CentOS 5/6/7 </font>\n\n### **Setup 1. Use Repository.**\n\nFirst, to set up the yum repository, install the mysql－community-server 5.7 RPM based on your CentOS/RHEL release: <br>\n\n#### **mysql-server-5.7.repo for CentOS/RHEL 5.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/5/x86_64/mysql-community-release-el5-7.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/5/i386/mysql-community-release-el5-7.noarch.rpm\n```\n\n#### **mysql-server-5.7.repo for CentOS/RHEL 6.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/6/x86_64/mysql-community-release-el6-7.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/6/i386/mysql-community-release-el6-7.noarch.rpm\n```\n\n#### **mysql-server-5.7.repo for CentOS/RHEL 7.x**\n```\n# For x86_64\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql-community-release-el7-7.noarch.rpm\n\n# For i386\nyum install http://repo.mysql.com/yum/mysql-5.7-community/el/7/i386/mysql-community-release-el7-7.noarch.rpm\n```\n\n\n### **Setup 2. Install MySQL Server 5.7**\nIf you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br>\n```\nyum remove -y mysql-server\nyum remove -y mysql*\n```\n\nIf you don't have mysql-server was installed.<br>\nOtherwise, to install MySql client and server, then run:<br>\n```\nyum install -y mysql-community-server\n```\n\n### **Setup 3. Service Configure**\nYou should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br>\n```\nservice mysqld start\n```\nThis will issue a password prompt for the user. If you don't have a root user password, remove the \"-p\"<br>\n```\nmysql_secure_installation\n```\n\n\n\n\n\n\n","slug":"how-to-install-mysql-5-6-on-centos","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq7q001y41tp452sfdmo","content":"<h2 id=\"Install-Mysql-5-5-on-RHEL-CentOS-5-6-7\"><a href=\"#Install-Mysql-5-5-on-RHEL-CentOS-5-6-7\" class=\"headerlink\" title=\"Install Mysql 5.5 on RHEL/CentOS 5/6/7 \"></a><font color=\"red\">Install Mysql 5.5 on RHEL/CentOS 5/6/7 </font></h2><h3 id=\"Setup-1-Use-Repository\"><a href=\"#Setup-1-Use-Repository\" class=\"headerlink\" title=\"Setup 1. Use Repository.\"></a><strong>Setup 1. Use Repository.</strong></h3><p>First, to set up the yum repository, install the mysql－community-server 5.5 RPM based on your CentOS/RHEL release: <br></p>\n<hr>\n<h4 id=\"mysql-server-5-5-repo-for-CentOS-RHEL-5-x\"><a href=\"#mysql-server-5-5-repo-for-CentOS-RHEL-5-x\" class=\"headerlink\" title=\"mysql-server-5.5.repo for CentOS/RHEL 5.x\"></a><strong>mysql-server-5.5.repo for CentOS/RHEL 5.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -Uvh http://mirror.webtatic.com/yum/el5/latest.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"Only-Install-MySQL-5-5-On-CentOS-5-x\"><a href=\"#Only-Install-MySQL-5-5-On-CentOS-5-x\" class=\"headerlink\" title=\" *Only Install MySQL 5.5 On CentOS 5.x\"></a><em> <em>*Only Install MySQL 5.5 On CentOS 5.x</em></em></h4><p>If you already have MySql client or server installed (rpm -q mysql mysql-server), then you can upgrade using the following method:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install mysql.`uname -i` yum-plugin-replace</div><div class=\"line\">yum replace mysql --replace-with mysql55w</div></pre></td></tr></table></figure></p>\n<p>“yum install mysql” is only there to make sure yum-plugin-replace can resolve dependencies correctly if only mysql-server was installed.<br><br>Otherwise, to install MySql client and server, then run:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install mysql55w mysql55w-server</div></pre></td></tr></table></figure></p>\n<hr>\n<h4 id=\"mysql-server-5-5-repo-for-CentOS-RHEL-6-x\"><a href=\"#mysql-server-5-5-repo-for-CentOS-RHEL-6-x\" class=\"headerlink\" title=\"mysql-server-5.5.repo for CentOS/RHEL 6.x\"></a><strong>mysql-server-5.5.repo for CentOS/RHEL 6.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.5-community/el/6/x86_64/mysql-community-release-el6-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.5-community/el/6/i386/mysql-community-release-el6-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-5-repo-for-CentOS-RHEL-7-x\"><a href=\"#mysql-server-5-5-repo-for-CentOS-RHEL-7-x\" class=\"headerlink\" title=\"mysql-server-5.5.repo for CentOS/RHEL 7.x\"></a><strong>mysql-server-5.5.repo for CentOS/RHEL 7.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.5-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.5-community/el/7/i386/mysql-community-release-el7-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h3 id=\"Setup-2-Install-MySQL-Server-5-5\"><a href=\"#Setup-2-Install-MySQL-Server-5-5\" class=\"headerlink\" title=\"Setup 2. Install MySQL Server 5.5\"></a><strong>Setup 2. Install MySQL Server 5.5</strong></h3><p>If you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># It&apos;s RHEL/CentOS 6/7</div><div class=\"line\">yum remove -y mysql-server</div><div class=\"line\">yum remove -y mysql*</div></pre></td></tr></table></figure></p>\n<p>If you don’t have mysql-server was installed.<br><br>Otherwise, to install MySql client and server, then run:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y mysql-community-server</div></pre></td></tr></table></figure></p>\n<h3 id=\"Setup-3-Service-Configure\"><a href=\"#Setup-3-Service-Configure\" class=\"headerlink\" title=\"Setup 3. Service Configure\"></a><strong>Setup 3. Service Configure</strong></h3><p>You should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service mysqld start</div></pre></td></tr></table></figure></p>\n<p>This will issue a password prompt for the user. If you don’t have a root user password, remove the “-p”<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql_secure_installation</div></pre></td></tr></table></figure></p>\n<h2 id=\"Install-Mysql-5-6-on-RHEL-CentOS-5-6-7\"><a href=\"#Install-Mysql-5-6-on-RHEL-CentOS-5-6-7\" class=\"headerlink\" title=\"Install Mysql 5.6 on RHEL/CentOS 5/6/7 \"></a><font color=\"red\">Install Mysql 5.6 on RHEL/CentOS 5/6/7 </font></h2><h3 id=\"Setup-1-Use-Repository-1\"><a href=\"#Setup-1-Use-Repository-1\" class=\"headerlink\" title=\"Setup 1. Use Repository.\"></a><strong>Setup 1. Use Repository.</strong></h3><p>First, to set up the yum repository, install the mysql－community-server 5.6 RPM based on your CentOS/RHEL release: <br></p>\n<h4 id=\"mysql-server-5-6-repo-for-CentOS-RHEL-5-x\"><a href=\"#mysql-server-5-6-repo-for-CentOS-RHEL-5-x\" class=\"headerlink\" title=\"mysql-server-5.6.repo for CentOS/RHEL 5.x\"></a><strong>mysql-server-5.6.repo for CentOS/RHEL 5.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/5/x86_64/mysql-community-release-el5-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/5/i386/mysql-community-release-el5-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-6-repo-for-CentOS-RHEL-6-x\"><a href=\"#mysql-server-5-6-repo-for-CentOS-RHEL-6-x\" class=\"headerlink\" title=\"mysql-server-5.6.repo for CentOS/RHEL 6.x\"></a><strong>mysql-server-5.6.repo for CentOS/RHEL 6.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/x86_64/mysql-community-release-el6-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/i386/mysql-community-release-el6-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-6-repo-for-CentOS-RHEL-7-x\"><a href=\"#mysql-server-5-6-repo-for-CentOS-RHEL-7-x\" class=\"headerlink\" title=\"mysql-server-5.6.repo for CentOS/RHEL 7.x\"></a><strong>mysql-server-5.6.repo for CentOS/RHEL 7.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/7/i386/mysql-community-release-el7-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h3 id=\"Setup-2-Install-MySQL-Server-5-6\"><a href=\"#Setup-2-Install-MySQL-Server-5-6\" class=\"headerlink\" title=\"Setup 2. Install MySQL Server 5.6\"></a><strong>Setup 2. Install MySQL Server 5.6</strong></h3><p>If you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum remove -y mysql-server</div><div class=\"line\">yum remove -y mysql*</div></pre></td></tr></table></figure></p>\n<p>If you don’t have mysql-server was installed.<br><br>Otherwise, to install MySql client and server, then run:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y mysql-community-server</div></pre></td></tr></table></figure></p>\n<h3 id=\"Setup-3-Service-Configure-1\"><a href=\"#Setup-3-Service-Configure-1\" class=\"headerlink\" title=\"Setup 3. Service Configure\"></a><strong>Setup 3. Service Configure</strong></h3><p>You should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service mysqld start</div></pre></td></tr></table></figure></p>\n<p>This will issue a password prompt for the user. If you don’t have a root user password, remove the “-p”<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql_secure_installation</div></pre></td></tr></table></figure></p>\n<h2 id=\"Install-Mysql-5-7-on-RHEL-CentOS-5-6-7\"><a href=\"#Install-Mysql-5-7-on-RHEL-CentOS-5-6-7\" class=\"headerlink\" title=\"Install Mysql 5.7 on RHEL/CentOS 5/6/7 \"></a><font color=\"red\">Install Mysql 5.7 on RHEL/CentOS 5/6/7 </font></h2><h3 id=\"Setup-1-Use-Repository-2\"><a href=\"#Setup-1-Use-Repository-2\" class=\"headerlink\" title=\"Setup 1. Use Repository.\"></a><strong>Setup 1. Use Repository.</strong></h3><p>First, to set up the yum repository, install the mysql－community-server 5.7 RPM based on your CentOS/RHEL release: <br></p>\n<h4 id=\"mysql-server-5-7-repo-for-CentOS-RHEL-5-x\"><a href=\"#mysql-server-5-7-repo-for-CentOS-RHEL-5-x\" class=\"headerlink\" title=\"mysql-server-5.7.repo for CentOS/RHEL 5.x\"></a><strong>mysql-server-5.7.repo for CentOS/RHEL 5.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/5/x86_64/mysql-community-release-el5-7.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/5/i386/mysql-community-release-el5-7.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-7-repo-for-CentOS-RHEL-6-x\"><a href=\"#mysql-server-5-7-repo-for-CentOS-RHEL-6-x\" class=\"headerlink\" title=\"mysql-server-5.7.repo for CentOS/RHEL 6.x\"></a><strong>mysql-server-5.7.repo for CentOS/RHEL 6.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/6/x86_64/mysql-community-release-el6-7.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/6/i386/mysql-community-release-el6-7.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-7-repo-for-CentOS-RHEL-7-x\"><a href=\"#mysql-server-5-7-repo-for-CentOS-RHEL-7-x\" class=\"headerlink\" title=\"mysql-server-5.7.repo for CentOS/RHEL 7.x\"></a><strong>mysql-server-5.7.repo for CentOS/RHEL 7.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql-community-release-el7-7.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/7/i386/mysql-community-release-el7-7.noarch.rpm</div></pre></td></tr></table></figure>\n<h3 id=\"Setup-2-Install-MySQL-Server-5-7\"><a href=\"#Setup-2-Install-MySQL-Server-5-7\" class=\"headerlink\" title=\"Setup 2. Install MySQL Server 5.7\"></a><strong>Setup 2. Install MySQL Server 5.7</strong></h3><p>If you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum remove -y mysql-server</div><div class=\"line\">yum remove -y mysql*</div></pre></td></tr></table></figure></p>\n<p>If you don’t have mysql-server was installed.<br><br>Otherwise, to install MySql client and server, then run:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y mysql-community-server</div></pre></td></tr></table></figure></p>\n<h3 id=\"Setup-3-Service-Configure-2\"><a href=\"#Setup-3-Service-Configure-2\" class=\"headerlink\" title=\"Setup 3. Service Configure\"></a><strong>Setup 3. Service Configure</strong></h3><p>You should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service mysqld start</div></pre></td></tr></table></figure></p>\n<p>This will issue a password prompt for the user. If you don’t have a root user password, remove the “-p”<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql_secure_installation</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Install-Mysql-5-5-on-RHEL-CentOS-5-6-7\"><a href=\"#Install-Mysql-5-5-on-RHEL-CentOS-5-6-7\" class=\"headerlink\" title=\"Install Mysql 5.5 on RHEL/CentOS 5/6/7 \"></a><font color=red>Install Mysql 5.5 on RHEL/CentOS 5/6/7 </font></h2><h3 id=\"Setup-1-Use-Repository\"><a href=\"#Setup-1-Use-Repository\" class=\"headerlink\" title=\"Setup 1. Use Repository.\"></a><strong>Setup 1. Use Repository.</strong></h3><p>First, to set up the yum repository, install the mysql－community-server 5.5 RPM based on your CentOS/RHEL release: <br></p>\n<hr>\n<h4 id=\"mysql-server-5-5-repo-for-CentOS-RHEL-5-x\"><a href=\"#mysql-server-5-5-repo-for-CentOS-RHEL-5-x\" class=\"headerlink\" title=\"mysql-server-5.5.repo for CentOS/RHEL 5.x\"></a><strong>mysql-server-5.5.repo for CentOS/RHEL 5.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -Uvh http://mirror.webtatic.com/yum/el5/latest.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"Only-Install-MySQL-5-5-On-CentOS-5-x\"><a href=\"#Only-Install-MySQL-5-5-On-CentOS-5-x\" class=\"headerlink\" title=\" *Only Install MySQL 5.5 On CentOS 5.x\"></a><em> <em>*Only Install MySQL 5.5 On CentOS 5.x</em></em></h4><p>If you already have MySql client or server installed (rpm -q mysql mysql-server), then you can upgrade using the following method:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install mysql.`uname -i` yum-plugin-replace</div><div class=\"line\">yum replace mysql --replace-with mysql55w</div></pre></td></tr></table></figure></p>\n<p>“yum install mysql” is only there to make sure yum-plugin-replace can resolve dependencies correctly if only mysql-server was installed.<br><br>Otherwise, to install MySql client and server, then run:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install mysql55w mysql55w-server</div></pre></td></tr></table></figure></p>\n<hr>\n<h4 id=\"mysql-server-5-5-repo-for-CentOS-RHEL-6-x\"><a href=\"#mysql-server-5-5-repo-for-CentOS-RHEL-6-x\" class=\"headerlink\" title=\"mysql-server-5.5.repo for CentOS/RHEL 6.x\"></a><strong>mysql-server-5.5.repo for CentOS/RHEL 6.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.5-community/el/6/x86_64/mysql-community-release-el6-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.5-community/el/6/i386/mysql-community-release-el6-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-5-repo-for-CentOS-RHEL-7-x\"><a href=\"#mysql-server-5-5-repo-for-CentOS-RHEL-7-x\" class=\"headerlink\" title=\"mysql-server-5.5.repo for CentOS/RHEL 7.x\"></a><strong>mysql-server-5.5.repo for CentOS/RHEL 7.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.5-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.5-community/el/7/i386/mysql-community-release-el7-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h3 id=\"Setup-2-Install-MySQL-Server-5-5\"><a href=\"#Setup-2-Install-MySQL-Server-5-5\" class=\"headerlink\" title=\"Setup 2. Install MySQL Server 5.5\"></a><strong>Setup 2. Install MySQL Server 5.5</strong></h3><p>If you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># It&apos;s RHEL/CentOS 6/7</div><div class=\"line\">yum remove -y mysql-server</div><div class=\"line\">yum remove -y mysql*</div></pre></td></tr></table></figure></p>\n<p>If you don’t have mysql-server was installed.<br><br>Otherwise, to install MySql client and server, then run:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y mysql-community-server</div></pre></td></tr></table></figure></p>\n<h3 id=\"Setup-3-Service-Configure\"><a href=\"#Setup-3-Service-Configure\" class=\"headerlink\" title=\"Setup 3. Service Configure\"></a><strong>Setup 3. Service Configure</strong></h3><p>You should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service mysqld start</div></pre></td></tr></table></figure></p>\n<p>This will issue a password prompt for the user. If you don’t have a root user password, remove the “-p”<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql_secure_installation</div></pre></td></tr></table></figure></p>\n<h2 id=\"Install-Mysql-5-6-on-RHEL-CentOS-5-6-7\"><a href=\"#Install-Mysql-5-6-on-RHEL-CentOS-5-6-7\" class=\"headerlink\" title=\"Install Mysql 5.6 on RHEL/CentOS 5/6/7 \"></a><font color=red>Install Mysql 5.6 on RHEL/CentOS 5/6/7 </font></h2><h3 id=\"Setup-1-Use-Repository-1\"><a href=\"#Setup-1-Use-Repository-1\" class=\"headerlink\" title=\"Setup 1. Use Repository.\"></a><strong>Setup 1. Use Repository.</strong></h3><p>First, to set up the yum repository, install the mysql－community-server 5.6 RPM based on your CentOS/RHEL release: <br></p>\n<h4 id=\"mysql-server-5-6-repo-for-CentOS-RHEL-5-x\"><a href=\"#mysql-server-5-6-repo-for-CentOS-RHEL-5-x\" class=\"headerlink\" title=\"mysql-server-5.6.repo for CentOS/RHEL 5.x\"></a><strong>mysql-server-5.6.repo for CentOS/RHEL 5.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/5/x86_64/mysql-community-release-el5-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/5/i386/mysql-community-release-el5-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-6-repo-for-CentOS-RHEL-6-x\"><a href=\"#mysql-server-5-6-repo-for-CentOS-RHEL-6-x\" class=\"headerlink\" title=\"mysql-server-5.6.repo for CentOS/RHEL 6.x\"></a><strong>mysql-server-5.6.repo for CentOS/RHEL 6.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/x86_64/mysql-community-release-el6-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/i386/mysql-community-release-el6-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-6-repo-for-CentOS-RHEL-7-x\"><a href=\"#mysql-server-5-6-repo-for-CentOS-RHEL-7-x\" class=\"headerlink\" title=\"mysql-server-5.6.repo for CentOS/RHEL 7.x\"></a><strong>mysql-server-5.6.repo for CentOS/RHEL 7.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.6-community/el/7/i386/mysql-community-release-el7-5.noarch.rpm</div></pre></td></tr></table></figure>\n<h3 id=\"Setup-2-Install-MySQL-Server-5-6\"><a href=\"#Setup-2-Install-MySQL-Server-5-6\" class=\"headerlink\" title=\"Setup 2. Install MySQL Server 5.6\"></a><strong>Setup 2. Install MySQL Server 5.6</strong></h3><p>If you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum remove -y mysql-server</div><div class=\"line\">yum remove -y mysql*</div></pre></td></tr></table></figure></p>\n<p>If you don’t have mysql-server was installed.<br><br>Otherwise, to install MySql client and server, then run:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y mysql-community-server</div></pre></td></tr></table></figure></p>\n<h3 id=\"Setup-3-Service-Configure-1\"><a href=\"#Setup-3-Service-Configure-1\" class=\"headerlink\" title=\"Setup 3. Service Configure\"></a><strong>Setup 3. Service Configure</strong></h3><p>You should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service mysqld start</div></pre></td></tr></table></figure></p>\n<p>This will issue a password prompt for the user. If you don’t have a root user password, remove the “-p”<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql_secure_installation</div></pre></td></tr></table></figure></p>\n<h2 id=\"Install-Mysql-5-7-on-RHEL-CentOS-5-6-7\"><a href=\"#Install-Mysql-5-7-on-RHEL-CentOS-5-6-7\" class=\"headerlink\" title=\"Install Mysql 5.7 on RHEL/CentOS 5/6/7 \"></a><font color=red>Install Mysql 5.7 on RHEL/CentOS 5/6/7 </font></h2><h3 id=\"Setup-1-Use-Repository-2\"><a href=\"#Setup-1-Use-Repository-2\" class=\"headerlink\" title=\"Setup 1. Use Repository.\"></a><strong>Setup 1. Use Repository.</strong></h3><p>First, to set up the yum repository, install the mysql－community-server 5.7 RPM based on your CentOS/RHEL release: <br></p>\n<h4 id=\"mysql-server-5-7-repo-for-CentOS-RHEL-5-x\"><a href=\"#mysql-server-5-7-repo-for-CentOS-RHEL-5-x\" class=\"headerlink\" title=\"mysql-server-5.7.repo for CentOS/RHEL 5.x\"></a><strong>mysql-server-5.7.repo for CentOS/RHEL 5.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/5/x86_64/mysql-community-release-el5-7.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/5/i386/mysql-community-release-el5-7.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-7-repo-for-CentOS-RHEL-6-x\"><a href=\"#mysql-server-5-7-repo-for-CentOS-RHEL-6-x\" class=\"headerlink\" title=\"mysql-server-5.7.repo for CentOS/RHEL 6.x\"></a><strong>mysql-server-5.7.repo for CentOS/RHEL 6.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/6/x86_64/mysql-community-release-el6-7.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/6/i386/mysql-community-release-el6-7.noarch.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"mysql-server-5-7-repo-for-CentOS-RHEL-7-x\"><a href=\"#mysql-server-5-7-repo-for-CentOS-RHEL-7-x\" class=\"headerlink\" title=\"mysql-server-5.7.repo for CentOS/RHEL 7.x\"></a><strong>mysql-server-5.7.repo for CentOS/RHEL 7.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># For x86_64</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql-community-release-el7-7.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"># For i386</div><div class=\"line\">yum install http://repo.mysql.com/yum/mysql-5.7-community/el/7/i386/mysql-community-release-el7-7.noarch.rpm</div></pre></td></tr></table></figure>\n<h3 id=\"Setup-2-Install-MySQL-Server-5-7\"><a href=\"#Setup-2-Install-MySQL-Server-5-7\" class=\"headerlink\" title=\"Setup 2. Install MySQL Server 5.7\"></a><strong>Setup 2. Install MySQL Server 5.7</strong></h3><p>If you already have MySql client or server installed (rpm -q mysql mysql-server), then you must uninstall using the following method:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum remove -y mysql-server</div><div class=\"line\">yum remove -y mysql*</div></pre></td></tr></table></figure></p>\n<p>If you don’t have mysql-server was installed.<br><br>Otherwise, to install MySql client and server, then run:<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y mysql-community-server</div></pre></td></tr></table></figure></p>\n<h3 id=\"Setup-3-Service-Configure-2\"><a href=\"#Setup-3-Service-Configure-2\" class=\"headerlink\" title=\"Setup 3. Service Configure\"></a><strong>Setup 3. Service Configure</strong></h3><p>You should upgrade existing tables before setting the server to become a production machine, which can be done by starting the server and running the mysql_upgrade script (this may take time depending on the size of the database).<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service mysqld start</div></pre></td></tr></table></figure></p>\n<p>This will issue a password prompt for the user. If you don’t have a root user password, remove the “-p”<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql_secure_installation</div></pre></td></tr></table></figure></p>\n"},{"title":"HowTo Install NextCloud","id":"140","updated":"2017-04-21T05:15:27.000Z","date":"2017-02-27T06:57:00.000Z","_content":"\n\n随着最近一个云盘厂家不再提供个人服务，或者开始各种收费限速，自己存放在第三方云盘厂商的数据被盗取，数据的安全性和数据的稳定性都得不到保证，而且随着智能终端的普及，我也有一些更加高质量的图片文件需要大量储存，所以我想到了自建存储服务的方式，在甄别了OwnCloud，Seafiles和NextCloud，最后选择了NextCloud作为自己今后数据存储节点，NextCloud源自OwnCloud，但是近些年来OwnCloud的发展进度几乎停滞，多数开发者也转战NextCloud，当然NextCloud也继承了搭建简单，依赖于PHP环境的特性。\n\n#### **运行环境**\n\n* 阿里云ECS CentOS 6.x\n* 免费SSL证书(腾讯云申请)\n\n#### **1. 搭建LNMP环境**\n\n##### 1.1 软件版本\n\n* PHP 5.6.30   [安装教程](https://samzong.me/php54-centos6/)\n* MySQL 5.6.35  [安装教程](https://samzong.me/how-to-install-mysql-5-6-on-centos/)\n* Nginx 1.10.2\n\n##### 1.2 基础环境安装\n\n```\n[root@ultraera ~]# yum update -y\n[root@ultraera ~]# yum groupinstall -y \"Base\"\n[root@ultraera ~]# yum groupinstall -y \"Development tools\"\n\n# Install epel\n[root@ultraera ~]# yum install -y epel-release\n\n# Install remi\n[root@ultraera ~]# yum install http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n\n# Install mysql-community\n[root@ultraera ~]# yum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/x86_64/mysql-community-release-el6-7.noarch.rpm\n```\n\n##### 1.3 Install LNMP\n\n```\n# Install MySQL\n[root@ultraera ~]# yum --enablerepo=mysql-community install -y mysql-server mysql-libs mysql-devel\n[root@ultraera ~]# service mysqld start\n[root@ultraera ~]# mysql_secure_installation\n[root@ultraera ~]# chkconfig mysqld on\n\n# Install Nginx\n[root@ultraera ~]# yum --enablerepo=epel install -y nginx\n[root@ultraera ~]# service nginx start\n[root@ultraera ~]# chkconfig nginx on\n\n# Install PHP and php-fpm\n[root@ultraera ~]# yum --enablerepo=remi-php56 install php php-fpm php-mysql php-gd php-xml php-redis php-libs php-devel php-zlib\n[root@ultraera ~]# service php-fpm start\n[root@ultraera ~]# chkconfig php-fpm on\n[root@ultraera ~]# service nginx restart\n```\n\n##### 1.4 下载NextCloud\n\n```\n[root@ultraera ~]# wget https://download.nextcloud.com/server/releases/nextcloud-11.0.1.tar.bz2\n[root@ultraera ~]# tar xf nextcloud-11.0.1.tar.bz2\n[root@ultraera ~]# mv nextcloud-11.0.1 /opt/nextcloud\n```\n\n##### 1.5 配置Nginx和php-fpm\n\n因为php-fpm默认运行的用户身份是apache，我们这里使用的环境是nginx，所有要修改php-fpm配置文件的用户和组，注意不要为了省事直接改为root，这在php-fpm中是不允许的\n\n```\n[root@ultraera ~]# vim /etc/php-fpm.d/www.conf\nuser=nginx\ngroup=nginx\n[root@ultraera ~]# service php-fpm restart\n```\n\n因为NextCloud默认是以Apache的身份运行的，所以我们需要单独配置NextCloud的Nginx配置文件，以下配置文件，你可以直接拿去用，注意在文件中说明了，需要修改的地方：\n\n```\n[root@ultraera ~]# vim /etc/nginx/conf.d/nextcloud.conf\n upstream php-handler {\n  \t# 这里是你php-fpm的服务端口，默认是9000\n    server 127.0.0.1:9000;\n    #server unix:/var/run/php5-fpm.sock;\n}\n\nserver {\n  \t# 你的域名\n    listen pan.ultraera.org:80;\n    server_name pan.ultraera.org;\n    # enforce https\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    # 你的域名\n    listen pan.ultraera.org:443 ssl;\n    server_name pan.ultraera.org;\n\n  \t# 以下是你的ssl证书文件存放路径\n    ssl_certificate /etc/nginx/ssl/1_pan.ultraera.org_bundle.crt;\n    ssl_certificate_key /etc/nginx/ssl/2_pan.ultraera.org.key;\n\n    # Add headers to serve security related headers\n    # Before enabling Strict-Transport-Security headers please read into this\n    # topic first.\n    # add_header Strict-Transport-Security \"max-age=15768000;\n    # includeSubDomains; preload;\";\n    add_header X-Content-Type-Options nosniff;\n    add_header X-Frame-Options \"SAMEORIGIN\";\n    add_header X-XSS-Protection \"1; mode=block\";\n    add_header X-Robots-Tag none;\n    add_header X-Download-Options noopen;\n    add_header X-Permitted-Cross-Domain-Policies none;\n\tadd_header Strict-Transport-Security \"max-age=15552000; includeSubdomains; \";\n\n    # 设定你的NextCloud的根目录，请根据实际修改\n    root /opt/nextcloud/;\n\n    location = /robots.txt {\n        allow all;\n        log_not_found off;\n        access_log off;\n    }\n\n    # The following 2 rules are only needed for the user_webfinger app.\n    # Uncomment it if you're planning to use this app.\n    #rewrite ^/.well-known/host-meta /public.php?service=host-meta last;\n    #rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json\n    # last;\n\n    location = /.well-known/carddav {\n      return 301 $scheme://$host/remote.php/dav;\n    }\n    location = /.well-known/caldav {\n      return 301 $scheme://$host/remote.php/dav;\n    }\n\n    # set max upload size\n    client_max_body_size 512M;\n    fastcgi_buffers 64 4K;\n\n    # Disable gzip to avoid the removal of the ETag header\n    gzip off;\n\n    # Uncomment if your server is build with the ngx_pagespeed module\n    # This module is currently not supported.\n    #pagespeed off;\n\n    error_page 403 /core/templates/403.php;\n    error_page 404 /core/templates/404.php;\n\n    location / {\n        rewrite ^ /index.php$uri;\n   }\n\n    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)/ {\n        deny all;\n    }\n    location ~ ^/(?:\\.|autotest|occ|issue|indie|db_|console) {\n        deny all;\n    }\n\n    location ~ ^/(?:index|remote|public|cron|core/ajax/update|status|ocs/v[12]|updater/.+|ocs-provider/.+|core/templates/40[34])\\.php(?:$|/) {\n        include fastcgi_params;\n        fastcgi_split_path_info ^(.+\\.php)(/.*)$;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param PATH_INFO $fastcgi_path_info;\n        fastcgi_param HTTPS on;\n        #Avoid sending the security headers twice\n        fastcgi_param modHeadersAvailable true;\n        fastcgi_param front_controller_active true;\n        fastcgi_pass php-handler;\n        fastcgi_intercept_errors on;\n        fastcgi_request_buffering off;\n    }\n\n    location ~ ^/(?:updater|ocs-provider)(?:$|/) {\n        try_files $uri/ =404;\n        index index.php;\n    }\n\n    # Adding the cache control header for js and css files\n    # Make sure it is BELOW the PHP block\n    location ~* \\.(?:css|js|woff|svg|gif)$ {\n        try_files $uri /index.php$uri$is_args$args;\n        add_header Cache-Control \"public, max-age=7200\";\n        # Add headers to serve security related headers (It is intended to\n        # have those duplicated to the ones above)\n        # Before enabling Strict-Transport-Security headers please read into\n        # this topic first.\n        # add_header Strict-Transport-Security \"max-age=15768000;\n        #  includeSubDomains; preload;\";\n        add_header X-Content-Type-Options nosniff;\n        add_header X-Frame-Options \"SAMEORIGIN\";\n        add_header X-XSS-Protection \"1; mode=block\";\n        add_header X-Robots-Tag none;\n        add_header X-Download-Options noopen;\n        add_header X-Permitted-Cross-Domain-Policies none;\n        # Optional: Don't log access to assets\n        access_log off;\n    }\n\n    location ~* \\.(?:png|html|ttf|ico|jpg|jpeg)$ {\n        try_files $uri /index.php$uri$is_args$args;\n        # Optional: Don't log access to other assets\n        access_log off;\n    }\n}\n[root@ultraera ~]# service nginx restart\n```\n\n##### 1.6 文件权限调整\n\n因为NextCloud运行是以nginx程序，注意修改目录所属用户和组为nginx\n\n```\n[root@ultraera ~]# chown -R nginx:nginx /opt/nextcloud\n```\n\n##### 1.7 创建MySQL数据库\n\n```\nmysql> CREATE DATABASE nextcloud CHARACTER SET UTF-8;\nmysql> GRANT ALL PRIVILEGES ON nextcloud.* TO 'nextcloud'@'localhost' IDENTIFIED BY 'your_password';\nmysql> FLUSH PRIVILEGES;\n```\n\n#### 2. 初始化NextCloud\n\n在浏览器打开你在nginx中配置的域名，NextCloud初始化非常简单，设定一个管理员账户和密码，然后设定数据库即可，按照我们上一步针对MySQL的设定，你会非常清楚地知道你的数据库信息：\n\n<center>![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/jjkqh.png)</center>\n\n登录之后的界面是这样：\n\n<center>![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/7n28v.png)</center>\n\n你可以在登录之后，在你的右上角点击头像选择Admin进入管理界面查看和修改你的服务器设置，你还可以在浏览器上方看到你的服务器现有哪些问题，会有对应文档提醒你如何解决这些问题。\n\n<center>![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/yx34e.png)</center>\n\n\n\n#### **3. Other**\n\n##### 3.1 修改默认data目录\n\n在我们首次打开NextCloud网页时，需要我们设定datadir目录，这里有个默认目录在nextcloud项目包，这其实是不安全的，我们最后将目录路径修改为其他位置:\n\n```\n[root@ultraera ~]# mkdir /nextcloud_files/\n[root@ultraera ~]# chown -R nginx:nginx /nextcloud_files/\n\n# 修改datadirectory的路径\n[root@ultraera ~]# vim /opt/nextcloud/config/config.php\ndatadirectory' => '/nextcloud/data\n```\n\n##### 3.2 无法登陆到个人用户界面\n\n我在安装时碰到这个问题，折腾了很久才解决，因为我们是使用nginx程序，但是php-fpm默认用户身份为apache，所以<code>/var/lib/php/session</code>目录的所属用户和组都是apache，导致我们没有权限去写入session，所以无法登入系统，报错信息可以在NextCloud的log文件下看到：\n\n```\n[root@ultraera ~]# tail -n 1 /usr/nextcloud/data/nextcloud.log\n{\"reqId\":\"NNnIwMCCPDMQtzZW5Ndc\",\"remoteAddr\":\"180.166.66.226\",\"app\":\"PHP\",\"message\":\"session_write_close(): Failed to write session data (files). Please verify that the current setting of session.save_path is correct (\\/var\\/lib\\/php\\/session) at \\/usr\\/nextcloud\\/lib\\/private\\/Session\\/Internal.php#104\",\"level\":3,\"time\":\"2017-02-24T10:46:13+00:00\",\"method\":\"POST\",\"url\":\"\\/index.php\",\"user\":\"samzong\",\"version\":\"11.0.0.10\"}\n\n# 修改/var/lib/php/的属组为nginx即可\n[root@ultraera ~]# chgrp -R nginx /var/lib/php\n```\n\n##### 3.3 增加redis组件，提高性能\n\n关于如何安装redis我在之前的文章中也有讲到，大家可以去看下 [安装教程](https://samzong.me/redis01/)\n\n```\n[root@ultraera ~]# yum --enablerepo=remi install -y redis\n\n# 增加php的redis插件\n[root@ultraera ~]# yum --enablerepo=remi-php56 install php-redis\n\n# 配置文件增加redis\n  'memcache.local' => '\\\\OC\\\\Memcache\\\\Redis',\n  'memcache.locking' => '\\\\OC\\\\Memcache\\\\Redis',\n  'redis' =>\n   array (\n    'host' => 'localhost',\n    'port' => 6379,\n   )\n\n# 重启令服务生效\n[root@ultraera ~]# service php-fpm restart\n[root@ultraera ~]# service nginx restart\n```\n\n\n\n我的NextCloud配置如下：\n\n```\n<?php\n$CONFIG = array (\n  'memcache.local' => '\\\\OC\\\\Memcache\\\\Redis',\n  'memcache.locking' => '\\\\OC\\\\Memcache\\\\Redis',\n  'redis' =>\n  array (\n    'host' => 'localhost',\n    'port' => 6379,\n  ),\n  'enable_previews' => false,\n  'instanceid' => 'ockhup01dxbf',\n  'passwordsalt' => 'TlJgWGrE0N7vOrRfZkOojwdYh/BixL',\n  'secret' => '/IQh0LioZp5eYFQJhicY7n324Q80WQUYOzWL+8OcxcXVw3Ef',\n  'trusted_domains' =>\n  array (\n    0 => 'pan.ultraera.org',\n  ),\n  'datadirectory' => '/nextcloud',\n  'overwrite.cli.url' => 'https://pan.ultraera.org',\n  'dbtype' => 'mysql',\n  'version' => '11.0.0.10',\n  'dbname' => 'nextcloud',\n  'dbhost' => 'localhost',\n  'dbport' => '',\n  'dbtableprefix' => 'oc_',\n  'dbuser' => 'nextcloud',\n  'dbpassword' => 'nextcloud',\n  'logtimezone' => 'CST',\n  'installed' => true,\n  'mail_from_address' => 'luchuanjia',\n  'mail_smtpmode' => 'php',\n  'mail_domain' => 'msn.com',\n);\n```\n\n##### 3.4 SSL证书\n\n现国内提供免费的SSL证书的服务商很多，作为个人站点，免费SSL证书是个挺不错的选择，我在之前nginx配置时将ssl的配置方式写在了配置文件中了，注意如果不启用ssl时，不要启用https的虚拟主机，当然你可以自己生成一个ssl证书来提供服务，但这样在别人访问你的网站时，会不提示不受信任的证书，具体如何获取的证书的方式，因各个厂家方式有些区别，这里就不赘述，可以联系对应的厂商的技术人员咨询。\n\n#### **4. 使用现状**\n\n在将服务搭建完成之后，对于存储的文件加密，现在通过jobs，每日凌晨将文件推送到oss内，保存2天的数据，避免因为服务器宕机导致文件丢失；使用端，自己的电脑和手机，还有家人的手机，都安装了应用，后台自动将拍照图片等自动上传到云盘，使用起来目前很稳定，只是iOS应用是收费的，因为NextCloud源于OwnCloud，如果你之前购买了OwnCloud的App也可以直接使用，当然NextCloud也有很多其他功能，可以根据你的实际需求发掘。\n","source":"_posts/HowTo-Install-NextCloud.md","raw":"---\ntitle: HowTo Install NextCloud\ntags: 'NextCloud'\ncategories: 'CentOS'\npermalink: install-nextcloud\nid: 140\nupdated: '2017-04-21 13:15:27'\ndate: 2017-02-27 14:57:00\n---\n\n\n随着最近一个云盘厂家不再提供个人服务，或者开始各种收费限速，自己存放在第三方云盘厂商的数据被盗取，数据的安全性和数据的稳定性都得不到保证，而且随着智能终端的普及，我也有一些更加高质量的图片文件需要大量储存，所以我想到了自建存储服务的方式，在甄别了OwnCloud，Seafiles和NextCloud，最后选择了NextCloud作为自己今后数据存储节点，NextCloud源自OwnCloud，但是近些年来OwnCloud的发展进度几乎停滞，多数开发者也转战NextCloud，当然NextCloud也继承了搭建简单，依赖于PHP环境的特性。\n\n#### **运行环境**\n\n* 阿里云ECS CentOS 6.x\n* 免费SSL证书(腾讯云申请)\n\n#### **1. 搭建LNMP环境**\n\n##### 1.1 软件版本\n\n* PHP 5.6.30   [安装教程](https://samzong.me/php54-centos6/)\n* MySQL 5.6.35  [安装教程](https://samzong.me/how-to-install-mysql-5-6-on-centos/)\n* Nginx 1.10.2\n\n##### 1.2 基础环境安装\n\n```\n[root@ultraera ~]# yum update -y\n[root@ultraera ~]# yum groupinstall -y \"Base\"\n[root@ultraera ~]# yum groupinstall -y \"Development tools\"\n\n# Install epel\n[root@ultraera ~]# yum install -y epel-release\n\n# Install remi\n[root@ultraera ~]# yum install http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n\n# Install mysql-community\n[root@ultraera ~]# yum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/x86_64/mysql-community-release-el6-7.noarch.rpm\n```\n\n##### 1.3 Install LNMP\n\n```\n# Install MySQL\n[root@ultraera ~]# yum --enablerepo=mysql-community install -y mysql-server mysql-libs mysql-devel\n[root@ultraera ~]# service mysqld start\n[root@ultraera ~]# mysql_secure_installation\n[root@ultraera ~]# chkconfig mysqld on\n\n# Install Nginx\n[root@ultraera ~]# yum --enablerepo=epel install -y nginx\n[root@ultraera ~]# service nginx start\n[root@ultraera ~]# chkconfig nginx on\n\n# Install PHP and php-fpm\n[root@ultraera ~]# yum --enablerepo=remi-php56 install php php-fpm php-mysql php-gd php-xml php-redis php-libs php-devel php-zlib\n[root@ultraera ~]# service php-fpm start\n[root@ultraera ~]# chkconfig php-fpm on\n[root@ultraera ~]# service nginx restart\n```\n\n##### 1.4 下载NextCloud\n\n```\n[root@ultraera ~]# wget https://download.nextcloud.com/server/releases/nextcloud-11.0.1.tar.bz2\n[root@ultraera ~]# tar xf nextcloud-11.0.1.tar.bz2\n[root@ultraera ~]# mv nextcloud-11.0.1 /opt/nextcloud\n```\n\n##### 1.5 配置Nginx和php-fpm\n\n因为php-fpm默认运行的用户身份是apache，我们这里使用的环境是nginx，所有要修改php-fpm配置文件的用户和组，注意不要为了省事直接改为root，这在php-fpm中是不允许的\n\n```\n[root@ultraera ~]# vim /etc/php-fpm.d/www.conf\nuser=nginx\ngroup=nginx\n[root@ultraera ~]# service php-fpm restart\n```\n\n因为NextCloud默认是以Apache的身份运行的，所以我们需要单独配置NextCloud的Nginx配置文件，以下配置文件，你可以直接拿去用，注意在文件中说明了，需要修改的地方：\n\n```\n[root@ultraera ~]# vim /etc/nginx/conf.d/nextcloud.conf\n upstream php-handler {\n  \t# 这里是你php-fpm的服务端口，默认是9000\n    server 127.0.0.1:9000;\n    #server unix:/var/run/php5-fpm.sock;\n}\n\nserver {\n  \t# 你的域名\n    listen pan.ultraera.org:80;\n    server_name pan.ultraera.org;\n    # enforce https\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    # 你的域名\n    listen pan.ultraera.org:443 ssl;\n    server_name pan.ultraera.org;\n\n  \t# 以下是你的ssl证书文件存放路径\n    ssl_certificate /etc/nginx/ssl/1_pan.ultraera.org_bundle.crt;\n    ssl_certificate_key /etc/nginx/ssl/2_pan.ultraera.org.key;\n\n    # Add headers to serve security related headers\n    # Before enabling Strict-Transport-Security headers please read into this\n    # topic first.\n    # add_header Strict-Transport-Security \"max-age=15768000;\n    # includeSubDomains; preload;\";\n    add_header X-Content-Type-Options nosniff;\n    add_header X-Frame-Options \"SAMEORIGIN\";\n    add_header X-XSS-Protection \"1; mode=block\";\n    add_header X-Robots-Tag none;\n    add_header X-Download-Options noopen;\n    add_header X-Permitted-Cross-Domain-Policies none;\n\tadd_header Strict-Transport-Security \"max-age=15552000; includeSubdomains; \";\n\n    # 设定你的NextCloud的根目录，请根据实际修改\n    root /opt/nextcloud/;\n\n    location = /robots.txt {\n        allow all;\n        log_not_found off;\n        access_log off;\n    }\n\n    # The following 2 rules are only needed for the user_webfinger app.\n    # Uncomment it if you're planning to use this app.\n    #rewrite ^/.well-known/host-meta /public.php?service=host-meta last;\n    #rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json\n    # last;\n\n    location = /.well-known/carddav {\n      return 301 $scheme://$host/remote.php/dav;\n    }\n    location = /.well-known/caldav {\n      return 301 $scheme://$host/remote.php/dav;\n    }\n\n    # set max upload size\n    client_max_body_size 512M;\n    fastcgi_buffers 64 4K;\n\n    # Disable gzip to avoid the removal of the ETag header\n    gzip off;\n\n    # Uncomment if your server is build with the ngx_pagespeed module\n    # This module is currently not supported.\n    #pagespeed off;\n\n    error_page 403 /core/templates/403.php;\n    error_page 404 /core/templates/404.php;\n\n    location / {\n        rewrite ^ /index.php$uri;\n   }\n\n    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)/ {\n        deny all;\n    }\n    location ~ ^/(?:\\.|autotest|occ|issue|indie|db_|console) {\n        deny all;\n    }\n\n    location ~ ^/(?:index|remote|public|cron|core/ajax/update|status|ocs/v[12]|updater/.+|ocs-provider/.+|core/templates/40[34])\\.php(?:$|/) {\n        include fastcgi_params;\n        fastcgi_split_path_info ^(.+\\.php)(/.*)$;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param PATH_INFO $fastcgi_path_info;\n        fastcgi_param HTTPS on;\n        #Avoid sending the security headers twice\n        fastcgi_param modHeadersAvailable true;\n        fastcgi_param front_controller_active true;\n        fastcgi_pass php-handler;\n        fastcgi_intercept_errors on;\n        fastcgi_request_buffering off;\n    }\n\n    location ~ ^/(?:updater|ocs-provider)(?:$|/) {\n        try_files $uri/ =404;\n        index index.php;\n    }\n\n    # Adding the cache control header for js and css files\n    # Make sure it is BELOW the PHP block\n    location ~* \\.(?:css|js|woff|svg|gif)$ {\n        try_files $uri /index.php$uri$is_args$args;\n        add_header Cache-Control \"public, max-age=7200\";\n        # Add headers to serve security related headers (It is intended to\n        # have those duplicated to the ones above)\n        # Before enabling Strict-Transport-Security headers please read into\n        # this topic first.\n        # add_header Strict-Transport-Security \"max-age=15768000;\n        #  includeSubDomains; preload;\";\n        add_header X-Content-Type-Options nosniff;\n        add_header X-Frame-Options \"SAMEORIGIN\";\n        add_header X-XSS-Protection \"1; mode=block\";\n        add_header X-Robots-Tag none;\n        add_header X-Download-Options noopen;\n        add_header X-Permitted-Cross-Domain-Policies none;\n        # Optional: Don't log access to assets\n        access_log off;\n    }\n\n    location ~* \\.(?:png|html|ttf|ico|jpg|jpeg)$ {\n        try_files $uri /index.php$uri$is_args$args;\n        # Optional: Don't log access to other assets\n        access_log off;\n    }\n}\n[root@ultraera ~]# service nginx restart\n```\n\n##### 1.6 文件权限调整\n\n因为NextCloud运行是以nginx程序，注意修改目录所属用户和组为nginx\n\n```\n[root@ultraera ~]# chown -R nginx:nginx /opt/nextcloud\n```\n\n##### 1.7 创建MySQL数据库\n\n```\nmysql> CREATE DATABASE nextcloud CHARACTER SET UTF-8;\nmysql> GRANT ALL PRIVILEGES ON nextcloud.* TO 'nextcloud'@'localhost' IDENTIFIED BY 'your_password';\nmysql> FLUSH PRIVILEGES;\n```\n\n#### 2. 初始化NextCloud\n\n在浏览器打开你在nginx中配置的域名，NextCloud初始化非常简单，设定一个管理员账户和密码，然后设定数据库即可，按照我们上一步针对MySQL的设定，你会非常清楚地知道你的数据库信息：\n\n<center>![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/jjkqh.png)</center>\n\n登录之后的界面是这样：\n\n<center>![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/7n28v.png)</center>\n\n你可以在登录之后，在你的右上角点击头像选择Admin进入管理界面查看和修改你的服务器设置，你还可以在浏览器上方看到你的服务器现有哪些问题，会有对应文档提醒你如何解决这些问题。\n\n<center>![](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/yx34e.png)</center>\n\n\n\n#### **3. Other**\n\n##### 3.1 修改默认data目录\n\n在我们首次打开NextCloud网页时，需要我们设定datadir目录，这里有个默认目录在nextcloud项目包，这其实是不安全的，我们最后将目录路径修改为其他位置:\n\n```\n[root@ultraera ~]# mkdir /nextcloud_files/\n[root@ultraera ~]# chown -R nginx:nginx /nextcloud_files/\n\n# 修改datadirectory的路径\n[root@ultraera ~]# vim /opt/nextcloud/config/config.php\ndatadirectory' => '/nextcloud/data\n```\n\n##### 3.2 无法登陆到个人用户界面\n\n我在安装时碰到这个问题，折腾了很久才解决，因为我们是使用nginx程序，但是php-fpm默认用户身份为apache，所以<code>/var/lib/php/session</code>目录的所属用户和组都是apache，导致我们没有权限去写入session，所以无法登入系统，报错信息可以在NextCloud的log文件下看到：\n\n```\n[root@ultraera ~]# tail -n 1 /usr/nextcloud/data/nextcloud.log\n{\"reqId\":\"NNnIwMCCPDMQtzZW5Ndc\",\"remoteAddr\":\"180.166.66.226\",\"app\":\"PHP\",\"message\":\"session_write_close(): Failed to write session data (files). Please verify that the current setting of session.save_path is correct (\\/var\\/lib\\/php\\/session) at \\/usr\\/nextcloud\\/lib\\/private\\/Session\\/Internal.php#104\",\"level\":3,\"time\":\"2017-02-24T10:46:13+00:00\",\"method\":\"POST\",\"url\":\"\\/index.php\",\"user\":\"samzong\",\"version\":\"11.0.0.10\"}\n\n# 修改/var/lib/php/的属组为nginx即可\n[root@ultraera ~]# chgrp -R nginx /var/lib/php\n```\n\n##### 3.3 增加redis组件，提高性能\n\n关于如何安装redis我在之前的文章中也有讲到，大家可以去看下 [安装教程](https://samzong.me/redis01/)\n\n```\n[root@ultraera ~]# yum --enablerepo=remi install -y redis\n\n# 增加php的redis插件\n[root@ultraera ~]# yum --enablerepo=remi-php56 install php-redis\n\n# 配置文件增加redis\n  'memcache.local' => '\\\\OC\\\\Memcache\\\\Redis',\n  'memcache.locking' => '\\\\OC\\\\Memcache\\\\Redis',\n  'redis' =>\n   array (\n    'host' => 'localhost',\n    'port' => 6379,\n   )\n\n# 重启令服务生效\n[root@ultraera ~]# service php-fpm restart\n[root@ultraera ~]# service nginx restart\n```\n\n\n\n我的NextCloud配置如下：\n\n```\n<?php\n$CONFIG = array (\n  'memcache.local' => '\\\\OC\\\\Memcache\\\\Redis',\n  'memcache.locking' => '\\\\OC\\\\Memcache\\\\Redis',\n  'redis' =>\n  array (\n    'host' => 'localhost',\n    'port' => 6379,\n  ),\n  'enable_previews' => false,\n  'instanceid' => 'ockhup01dxbf',\n  'passwordsalt' => 'TlJgWGrE0N7vOrRfZkOojwdYh/BixL',\n  'secret' => '/IQh0LioZp5eYFQJhicY7n324Q80WQUYOzWL+8OcxcXVw3Ef',\n  'trusted_domains' =>\n  array (\n    0 => 'pan.ultraera.org',\n  ),\n  'datadirectory' => '/nextcloud',\n  'overwrite.cli.url' => 'https://pan.ultraera.org',\n  'dbtype' => 'mysql',\n  'version' => '11.0.0.10',\n  'dbname' => 'nextcloud',\n  'dbhost' => 'localhost',\n  'dbport' => '',\n  'dbtableprefix' => 'oc_',\n  'dbuser' => 'nextcloud',\n  'dbpassword' => 'nextcloud',\n  'logtimezone' => 'CST',\n  'installed' => true,\n  'mail_from_address' => 'luchuanjia',\n  'mail_smtpmode' => 'php',\n  'mail_domain' => 'msn.com',\n);\n```\n\n##### 3.4 SSL证书\n\n现国内提供免费的SSL证书的服务商很多，作为个人站点，免费SSL证书是个挺不错的选择，我在之前nginx配置时将ssl的配置方式写在了配置文件中了，注意如果不启用ssl时，不要启用https的虚拟主机，当然你可以自己生成一个ssl证书来提供服务，但这样在别人访问你的网站时，会不提示不受信任的证书，具体如何获取的证书的方式，因各个厂家方式有些区别，这里就不赘述，可以联系对应的厂商的技术人员咨询。\n\n#### **4. 使用现状**\n\n在将服务搭建完成之后，对于存储的文件加密，现在通过jobs，每日凌晨将文件推送到oss内，保存2天的数据，避免因为服务器宕机导致文件丢失；使用端，自己的电脑和手机，还有家人的手机，都安装了应用，后台自动将拍照图片等自动上传到云盘，使用起来目前很稳定，只是iOS应用是收费的，因为NextCloud源于OwnCloud，如果你之前购买了OwnCloud的App也可以直接使用，当然NextCloud也有很多其他功能，可以根据你的实际需求发掘。\n","slug":"install-nextcloud","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq7u002141tpx3ngt7nl","content":"<p>随着最近一个云盘厂家不再提供个人服务，或者开始各种收费限速，自己存放在第三方云盘厂商的数据被盗取，数据的安全性和数据的稳定性都得不到保证，而且随着智能终端的普及，我也有一些更加高质量的图片文件需要大量储存，所以我想到了自建存储服务的方式，在甄别了OwnCloud，Seafiles和NextCloud，最后选择了NextCloud作为自己今后数据存储节点，NextCloud源自OwnCloud，但是近些年来OwnCloud的发展进度几乎停滞，多数开发者也转战NextCloud，当然NextCloud也继承了搭建简单，依赖于PHP环境的特性。</p>\n<h4 id=\"运行环境\"><a href=\"#运行环境\" class=\"headerlink\" title=\"运行环境\"></a><strong>运行环境</strong></h4><ul>\n<li>阿里云ECS CentOS 6.x</li>\n<li>免费SSL证书(腾讯云申请)</li>\n</ul>\n<h4 id=\"1-搭建LNMP环境\"><a href=\"#1-搭建LNMP环境\" class=\"headerlink\" title=\"1. 搭建LNMP环境\"></a><strong>1. 搭建LNMP环境</strong></h4><h5 id=\"1-1-软件版本\"><a href=\"#1-1-软件版本\" class=\"headerlink\" title=\"1.1 软件版本\"></a>1.1 软件版本</h5><ul>\n<li>PHP 5.6.30   <a href=\"https://samzong.me/php54-centos6/\" target=\"_blank\" rel=\"external\">安装教程</a></li>\n<li>MySQL 5.6.35  <a href=\"https://samzong.me/how-to-install-mysql-5-6-on-centos/\" target=\"_blank\" rel=\"external\">安装教程</a></li>\n<li>Nginx 1.10.2</li>\n</ul>\n<h5 id=\"1-2-基础环境安装\"><a href=\"#1-2-基础环境安装\" class=\"headerlink\" title=\"1.2 基础环境安装\"></a>1.2 基础环境安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# yum update -y</div><div class=\"line\">[root@ultraera ~]# yum groupinstall -y &quot;Base&quot;</div><div class=\"line\">[root@ultraera ~]# yum groupinstall -y &quot;Development tools&quot;</div><div class=\"line\"></div><div class=\"line\"># Install epel</div><div class=\"line\">[root@ultraera ~]# yum install -y epel-release</div><div class=\"line\"></div><div class=\"line\"># Install remi</div><div class=\"line\">[root@ultraera ~]# yum install http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</div><div class=\"line\"></div><div class=\"line\"># Install mysql-community</div><div class=\"line\">[root@ultraera ~]# yum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/x86_64/mysql-community-release-el6-7.noarch.rpm</div></pre></td></tr></table></figure>\n<h5 id=\"1-3-Install-LNMP\"><a href=\"#1-3-Install-LNMP\" class=\"headerlink\" title=\"1.3 Install LNMP\"></a>1.3 Install LNMP</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Install MySQL</div><div class=\"line\">[root@ultraera ~]# yum --enablerepo=mysql-community install -y mysql-server mysql-libs mysql-devel</div><div class=\"line\">[root@ultraera ~]# service mysqld start</div><div class=\"line\">[root@ultraera ~]# mysql_secure_installation</div><div class=\"line\">[root@ultraera ~]# chkconfig mysqld on</div><div class=\"line\"></div><div class=\"line\"># Install Nginx</div><div class=\"line\">[root@ultraera ~]# yum --enablerepo=epel install -y nginx</div><div class=\"line\">[root@ultraera ~]# service nginx start</div><div class=\"line\">[root@ultraera ~]# chkconfig nginx on</div><div class=\"line\"></div><div class=\"line\"># Install PHP and php-fpm</div><div class=\"line\">[root@ultraera ~]# yum --enablerepo=remi-php56 install php php-fpm php-mysql php-gd php-xml php-redis php-libs php-devel php-zlib</div><div class=\"line\">[root@ultraera ~]# service php-fpm start</div><div class=\"line\">[root@ultraera ~]# chkconfig php-fpm on</div><div class=\"line\">[root@ultraera ~]# service nginx restart</div></pre></td></tr></table></figure>\n<h5 id=\"1-4-下载NextCloud\"><a href=\"#1-4-下载NextCloud\" class=\"headerlink\" title=\"1.4 下载NextCloud\"></a>1.4 下载NextCloud</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# wget https://download.nextcloud.com/server/releases/nextcloud-11.0.1.tar.bz2</div><div class=\"line\">[root@ultraera ~]# tar xf nextcloud-11.0.1.tar.bz2</div><div class=\"line\">[root@ultraera ~]# mv nextcloud-11.0.1 /opt/nextcloud</div></pre></td></tr></table></figure>\n<h5 id=\"1-5-配置Nginx和php-fpm\"><a href=\"#1-5-配置Nginx和php-fpm\" class=\"headerlink\" title=\"1.5 配置Nginx和php-fpm\"></a>1.5 配置Nginx和php-fpm</h5><p>因为php-fpm默认运行的用户身份是apache，我们这里使用的环境是nginx，所有要修改php-fpm配置文件的用户和组，注意不要为了省事直接改为root，这在php-fpm中是不允许的</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vim /etc/php-fpm.d/www.conf</div><div class=\"line\">user=nginx</div><div class=\"line\">group=nginx</div><div class=\"line\">[root@ultraera ~]# service php-fpm restart</div></pre></td></tr></table></figure>\n<p>因为NextCloud默认是以Apache的身份运行的，所以我们需要单独配置NextCloud的Nginx配置文件，以下配置文件，你可以直接拿去用，注意在文件中说明了，需要修改的地方：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vim /etc/nginx/conf.d/nextcloud.conf</div><div class=\"line\"> upstream php-handler &#123;</div><div class=\"line\">  \t# 这里是你php-fpm的服务端口，默认是9000</div><div class=\"line\">    server 127.0.0.1:9000;</div><div class=\"line\">    #server unix:/var/run/php5-fpm.sock;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">server &#123;</div><div class=\"line\">  \t# 你的域名</div><div class=\"line\">    listen pan.ultraera.org:80;</div><div class=\"line\">    server_name pan.ultraera.org;</div><div class=\"line\">    # enforce https</div><div class=\"line\">    return 301 https://$server_name$request_uri;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">server &#123;</div><div class=\"line\">    # 你的域名</div><div class=\"line\">    listen pan.ultraera.org:443 ssl;</div><div class=\"line\">    server_name pan.ultraera.org;</div><div class=\"line\"></div><div class=\"line\">  \t# 以下是你的ssl证书文件存放路径</div><div class=\"line\">    ssl_certificate /etc/nginx/ssl/1_pan.ultraera.org_bundle.crt;</div><div class=\"line\">    ssl_certificate_key /etc/nginx/ssl/2_pan.ultraera.org.key;</div><div class=\"line\"></div><div class=\"line\">    # Add headers to serve security related headers</div><div class=\"line\">    # Before enabling Strict-Transport-Security headers please read into this</div><div class=\"line\">    # topic first.</div><div class=\"line\">    # add_header Strict-Transport-Security &quot;max-age=15768000;</div><div class=\"line\">    # includeSubDomains; preload;&quot;;</div><div class=\"line\">    add_header X-Content-Type-Options nosniff;</div><div class=\"line\">    add_header X-Frame-Options &quot;SAMEORIGIN&quot;;</div><div class=\"line\">    add_header X-XSS-Protection &quot;1; mode=block&quot;;</div><div class=\"line\">    add_header X-Robots-Tag none;</div><div class=\"line\">    add_header X-Download-Options noopen;</div><div class=\"line\">    add_header X-Permitted-Cross-Domain-Policies none;</div><div class=\"line\">\tadd_header Strict-Transport-Security &quot;max-age=15552000; includeSubdomains; &quot;;</div><div class=\"line\"></div><div class=\"line\">    # 设定你的NextCloud的根目录，请根据实际修改</div><div class=\"line\">    root /opt/nextcloud/;</div><div class=\"line\"></div><div class=\"line\">    location = /robots.txt &#123;</div><div class=\"line\">        allow all;</div><div class=\"line\">        log_not_found off;</div><div class=\"line\">        access_log off;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    # The following 2 rules are only needed for the user_webfinger app.</div><div class=\"line\">    # Uncomment it if you&apos;re planning to use this app.</div><div class=\"line\">    #rewrite ^/.well-known/host-meta /public.php?service=host-meta last;</div><div class=\"line\">    #rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json</div><div class=\"line\">    # last;</div><div class=\"line\"></div><div class=\"line\">    location = /.well-known/carddav &#123;</div><div class=\"line\">      return 301 $scheme://$host/remote.php/dav;</div><div class=\"line\">    &#125;</div><div class=\"line\">    location = /.well-known/caldav &#123;</div><div class=\"line\">      return 301 $scheme://$host/remote.php/dav;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    # set max upload size</div><div class=\"line\">    client_max_body_size 512M;</div><div class=\"line\">    fastcgi_buffers 64 4K;</div><div class=\"line\"></div><div class=\"line\">    # Disable gzip to avoid the removal of the ETag header</div><div class=\"line\">    gzip off;</div><div class=\"line\"></div><div class=\"line\">    # Uncomment if your server is build with the ngx_pagespeed module</div><div class=\"line\">    # This module is currently not supported.</div><div class=\"line\">    #pagespeed off;</div><div class=\"line\"></div><div class=\"line\">    error_page 403 /core/templates/403.php;</div><div class=\"line\">    error_page 404 /core/templates/404.php;</div><div class=\"line\"></div><div class=\"line\">    location / &#123;</div><div class=\"line\">        rewrite ^ /index.php$uri;</div><div class=\"line\">   &#125;</div><div class=\"line\"></div><div class=\"line\">    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)/ &#123;</div><div class=\"line\">        deny all;</div><div class=\"line\">    &#125;</div><div class=\"line\">    location ~ ^/(?:\\.|autotest|occ|issue|indie|db_|console) &#123;</div><div class=\"line\">        deny all;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    location ~ ^/(?:index|remote|public|cron|core/ajax/update|status|ocs/v[12]|updater/.+|ocs-provider/.+|core/templates/40[34])\\.php(?:$|/) &#123;</div><div class=\"line\">        include fastcgi_params;</div><div class=\"line\">        fastcgi_split_path_info ^(.+\\.php)(/.*)$;</div><div class=\"line\">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class=\"line\">        fastcgi_param PATH_INFO $fastcgi_path_info;</div><div class=\"line\">        fastcgi_param HTTPS on;</div><div class=\"line\">        #Avoid sending the security headers twice</div><div class=\"line\">        fastcgi_param modHeadersAvailable true;</div><div class=\"line\">        fastcgi_param front_controller_active true;</div><div class=\"line\">        fastcgi_pass php-handler;</div><div class=\"line\">        fastcgi_intercept_errors on;</div><div class=\"line\">        fastcgi_request_buffering off;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    location ~ ^/(?:updater|ocs-provider)(?:$|/) &#123;</div><div class=\"line\">        try_files $uri/ =404;</div><div class=\"line\">        index index.php;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    # Adding the cache control header for js and css files</div><div class=\"line\">    # Make sure it is BELOW the PHP block</div><div class=\"line\">    location ~* \\.(?:css|js|woff|svg|gif)$ &#123;</div><div class=\"line\">        try_files $uri /index.php$uri$is_args$args;</div><div class=\"line\">        add_header Cache-Control &quot;public, max-age=7200&quot;;</div><div class=\"line\">        # Add headers to serve security related headers (It is intended to</div><div class=\"line\">        # have those duplicated to the ones above)</div><div class=\"line\">        # Before enabling Strict-Transport-Security headers please read into</div><div class=\"line\">        # this topic first.</div><div class=\"line\">        # add_header Strict-Transport-Security &quot;max-age=15768000;</div><div class=\"line\">        #  includeSubDomains; preload;&quot;;</div><div class=\"line\">        add_header X-Content-Type-Options nosniff;</div><div class=\"line\">        add_header X-Frame-Options &quot;SAMEORIGIN&quot;;</div><div class=\"line\">        add_header X-XSS-Protection &quot;1; mode=block&quot;;</div><div class=\"line\">        add_header X-Robots-Tag none;</div><div class=\"line\">        add_header X-Download-Options noopen;</div><div class=\"line\">        add_header X-Permitted-Cross-Domain-Policies none;</div><div class=\"line\">        # Optional: Don&apos;t log access to assets</div><div class=\"line\">        access_log off;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    location ~* \\.(?:png|html|ttf|ico|jpg|jpeg)$ &#123;</div><div class=\"line\">        try_files $uri /index.php$uri$is_args$args;</div><div class=\"line\">        # Optional: Don&apos;t log access to other assets</div><div class=\"line\">        access_log off;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\">[root@ultraera ~]# service nginx restart</div></pre></td></tr></table></figure>\n<h5 id=\"1-6-文件权限调整\"><a href=\"#1-6-文件权限调整\" class=\"headerlink\" title=\"1.6 文件权限调整\"></a>1.6 文件权限调整</h5><p>因为NextCloud运行是以nginx程序，注意修改目录所属用户和组为nginx</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# chown -R nginx:nginx /opt/nextcloud</div></pre></td></tr></table></figure>\n<h5 id=\"1-7-创建MySQL数据库\"><a href=\"#1-7-创建MySQL数据库\" class=\"headerlink\" title=\"1.7 创建MySQL数据库\"></a>1.7 创建MySQL数据库</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; CREATE DATABASE nextcloud CHARACTER SET UTF-8;</div><div class=\"line\">mysql&gt; GRANT ALL PRIVILEGES ON nextcloud.* TO &apos;nextcloud&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;your_password&apos;;</div><div class=\"line\">mysql&gt; FLUSH PRIVILEGES;</div></pre></td></tr></table></figure>\n<h4 id=\"2-初始化NextCloud\"><a href=\"#2-初始化NextCloud\" class=\"headerlink\" title=\"2. 初始化NextCloud\"></a>2. 初始化NextCloud</h4><p>在浏览器打开你在nginx中配置的域名，NextCloud初始化非常简单，设定一个管理员账户和密码，然后设定数据库即可，按照我们上一步针对MySQL的设定，你会非常清楚地知道你的数据库信息：</p>\n<center><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/jjkqh.png\" alt=\"\"></center>\n\n<p>登录之后的界面是这样：</p>\n<center><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/7n28v.png\" alt=\"\"></center>\n\n<p>你可以在登录之后，在你的右上角点击头像选择Admin进入管理界面查看和修改你的服务器设置，你还可以在浏览器上方看到你的服务器现有哪些问题，会有对应文档提醒你如何解决这些问题。</p>\n<center><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/yx34e.png\" alt=\"\"></center>\n\n\n\n<h4 id=\"3-Other\"><a href=\"#3-Other\" class=\"headerlink\" title=\"3. Other\"></a><strong>3. Other</strong></h4><h5 id=\"3-1-修改默认data目录\"><a href=\"#3-1-修改默认data目录\" class=\"headerlink\" title=\"3.1 修改默认data目录\"></a>3.1 修改默认data目录</h5><p>在我们首次打开NextCloud网页时，需要我们设定datadir目录，这里有个默认目录在nextcloud项目包，这其实是不安全的，我们最后将目录路径修改为其他位置:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# mkdir /nextcloud_files/</div><div class=\"line\">[root@ultraera ~]# chown -R nginx:nginx /nextcloud_files/</div><div class=\"line\"></div><div class=\"line\"># 修改datadirectory的路径</div><div class=\"line\">[root@ultraera ~]# vim /opt/nextcloud/config/config.php</div><div class=\"line\">datadirectory&apos; =&gt; &apos;/nextcloud/data</div></pre></td></tr></table></figure>\n<h5 id=\"3-2-无法登陆到个人用户界面\"><a href=\"#3-2-无法登陆到个人用户界面\" class=\"headerlink\" title=\"3.2 无法登陆到个人用户界面\"></a>3.2 无法登陆到个人用户界面</h5><p>我在安装时碰到这个问题，折腾了很久才解决，因为我们是使用nginx程序，但是php-fpm默认用户身份为apache，所以<code>/var/lib/php/session</code>目录的所属用户和组都是apache，导致我们没有权限去写入session，所以无法登入系统，报错信息可以在NextCloud的log文件下看到：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# tail -n 1 /usr/nextcloud/data/nextcloud.log</div><div class=\"line\">&#123;&quot;reqId&quot;:&quot;NNnIwMCCPDMQtzZW5Ndc&quot;,&quot;remoteAddr&quot;:&quot;180.166.66.226&quot;,&quot;app&quot;:&quot;PHP&quot;,&quot;message&quot;:&quot;session_write_close(): Failed to write session data (files). Please verify that the current setting of session.save_path is correct (\\/var\\/lib\\/php\\/session) at \\/usr\\/nextcloud\\/lib\\/private\\/Session\\/Internal.php#104&quot;,&quot;level&quot;:3,&quot;time&quot;:&quot;2017-02-24T10:46:13+00:00&quot;,&quot;method&quot;:&quot;POST&quot;,&quot;url&quot;:&quot;\\/index.php&quot;,&quot;user&quot;:&quot;samzong&quot;,&quot;version&quot;:&quot;11.0.0.10&quot;&#125;</div><div class=\"line\"></div><div class=\"line\"># 修改/var/lib/php/的属组为nginx即可</div><div class=\"line\">[root@ultraera ~]# chgrp -R nginx /var/lib/php</div></pre></td></tr></table></figure>\n<h5 id=\"3-3-增加redis组件，提高性能\"><a href=\"#3-3-增加redis组件，提高性能\" class=\"headerlink\" title=\"3.3 增加redis组件，提高性能\"></a>3.3 增加redis组件，提高性能</h5><p>关于如何安装redis我在之前的文章中也有讲到，大家可以去看下 <a href=\"https://samzong.me/redis01/\" target=\"_blank\" rel=\"external\">安装教程</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# yum --enablerepo=remi install -y redis</div><div class=\"line\"></div><div class=\"line\"># 增加php的redis插件</div><div class=\"line\">[root@ultraera ~]# yum --enablerepo=remi-php56 install php-redis</div><div class=\"line\"></div><div class=\"line\"># 配置文件增加redis</div><div class=\"line\">  &apos;memcache.local&apos; =&gt; &apos;\\\\OC\\\\Memcache\\\\Redis&apos;,</div><div class=\"line\">  &apos;memcache.locking&apos; =&gt; &apos;\\\\OC\\\\Memcache\\\\Redis&apos;,</div><div class=\"line\">  &apos;redis&apos; =&gt;</div><div class=\"line\">   array (</div><div class=\"line\">    &apos;host&apos; =&gt; &apos;localhost&apos;,</div><div class=\"line\">    &apos;port&apos; =&gt; 6379,</div><div class=\"line\">   )</div><div class=\"line\"></div><div class=\"line\"># 重启令服务生效</div><div class=\"line\">[root@ultraera ~]# service php-fpm restart</div><div class=\"line\">[root@ultraera ~]# service nginx restart</div></pre></td></tr></table></figure>\n<p>我的NextCloud配置如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?php</div><div class=\"line\">$CONFIG = array (</div><div class=\"line\">  &apos;memcache.local&apos; =&gt; &apos;\\\\OC\\\\Memcache\\\\Redis&apos;,</div><div class=\"line\">  &apos;memcache.locking&apos; =&gt; &apos;\\\\OC\\\\Memcache\\\\Redis&apos;,</div><div class=\"line\">  &apos;redis&apos; =&gt;</div><div class=\"line\">  array (</div><div class=\"line\">    &apos;host&apos; =&gt; &apos;localhost&apos;,</div><div class=\"line\">    &apos;port&apos; =&gt; 6379,</div><div class=\"line\">  ),</div><div class=\"line\">  &apos;enable_previews&apos; =&gt; false,</div><div class=\"line\">  &apos;instanceid&apos; =&gt; &apos;ockhup01dxbf&apos;,</div><div class=\"line\">  &apos;passwordsalt&apos; =&gt; &apos;TlJgWGrE0N7vOrRfZkOojwdYh/BixL&apos;,</div><div class=\"line\">  &apos;secret&apos; =&gt; &apos;/IQh0LioZp5eYFQJhicY7n324Q80WQUYOzWL+8OcxcXVw3Ef&apos;,</div><div class=\"line\">  &apos;trusted_domains&apos; =&gt;</div><div class=\"line\">  array (</div><div class=\"line\">    0 =&gt; &apos;pan.ultraera.org&apos;,</div><div class=\"line\">  ),</div><div class=\"line\">  &apos;datadirectory&apos; =&gt; &apos;/nextcloud&apos;,</div><div class=\"line\">  &apos;overwrite.cli.url&apos; =&gt; &apos;https://pan.ultraera.org&apos;,</div><div class=\"line\">  &apos;dbtype&apos; =&gt; &apos;mysql&apos;,</div><div class=\"line\">  &apos;version&apos; =&gt; &apos;11.0.0.10&apos;,</div><div class=\"line\">  &apos;dbname&apos; =&gt; &apos;nextcloud&apos;,</div><div class=\"line\">  &apos;dbhost&apos; =&gt; &apos;localhost&apos;,</div><div class=\"line\">  &apos;dbport&apos; =&gt; &apos;&apos;,</div><div class=\"line\">  &apos;dbtableprefix&apos; =&gt; &apos;oc_&apos;,</div><div class=\"line\">  &apos;dbuser&apos; =&gt; &apos;nextcloud&apos;,</div><div class=\"line\">  &apos;dbpassword&apos; =&gt; &apos;nextcloud&apos;,</div><div class=\"line\">  &apos;logtimezone&apos; =&gt; &apos;CST&apos;,</div><div class=\"line\">  &apos;installed&apos; =&gt; true,</div><div class=\"line\">  &apos;mail_from_address&apos; =&gt; &apos;luchuanjia&apos;,</div><div class=\"line\">  &apos;mail_smtpmode&apos; =&gt; &apos;php&apos;,</div><div class=\"line\">  &apos;mail_domain&apos; =&gt; &apos;msn.com&apos;,</div><div class=\"line\">);</div></pre></td></tr></table></figure>\n<h5 id=\"3-4-SSL证书\"><a href=\"#3-4-SSL证书\" class=\"headerlink\" title=\"3.4 SSL证书\"></a>3.4 SSL证书</h5><p>现国内提供免费的SSL证书的服务商很多，作为个人站点，免费SSL证书是个挺不错的选择，我在之前nginx配置时将ssl的配置方式写在了配置文件中了，注意如果不启用ssl时，不要启用https的虚拟主机，当然你可以自己生成一个ssl证书来提供服务，但这样在别人访问你的网站时，会不提示不受信任的证书，具体如何获取的证书的方式，因各个厂家方式有些区别，这里就不赘述，可以联系对应的厂商的技术人员咨询。</p>\n<h4 id=\"4-使用现状\"><a href=\"#4-使用现状\" class=\"headerlink\" title=\"4. 使用现状\"></a><strong>4. 使用现状</strong></h4><p>在将服务搭建完成之后，对于存储的文件加密，现在通过jobs，每日凌晨将文件推送到oss内，保存2天的数据，避免因为服务器宕机导致文件丢失；使用端，自己的电脑和手机，还有家人的手机，都安装了应用，后台自动将拍照图片等自动上传到云盘，使用起来目前很稳定，只是iOS应用是收费的，因为NextCloud源于OwnCloud，如果你之前购买了OwnCloud的App也可以直接使用，当然NextCloud也有很多其他功能，可以根据你的实际需求发掘。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>随着最近一个云盘厂家不再提供个人服务，或者开始各种收费限速，自己存放在第三方云盘厂商的数据被盗取，数据的安全性和数据的稳定性都得不到保证，而且随着智能终端的普及，我也有一些更加高质量的图片文件需要大量储存，所以我想到了自建存储服务的方式，在甄别了OwnCloud，Seafiles和NextCloud，最后选择了NextCloud作为自己今后数据存储节点，NextCloud源自OwnCloud，但是近些年来OwnCloud的发展进度几乎停滞，多数开发者也转战NextCloud，当然NextCloud也继承了搭建简单，依赖于PHP环境的特性。</p>\n<h4 id=\"运行环境\"><a href=\"#运行环境\" class=\"headerlink\" title=\"运行环境\"></a><strong>运行环境</strong></h4><ul>\n<li>阿里云ECS CentOS 6.x</li>\n<li>免费SSL证书(腾讯云申请)</li>\n</ul>\n<h4 id=\"1-搭建LNMP环境\"><a href=\"#1-搭建LNMP环境\" class=\"headerlink\" title=\"1. 搭建LNMP环境\"></a><strong>1. 搭建LNMP环境</strong></h4><h5 id=\"1-1-软件版本\"><a href=\"#1-1-软件版本\" class=\"headerlink\" title=\"1.1 软件版本\"></a>1.1 软件版本</h5><ul>\n<li>PHP 5.6.30   <a href=\"https://samzong.me/php54-centos6/\">安装教程</a></li>\n<li>MySQL 5.6.35  <a href=\"https://samzong.me/how-to-install-mysql-5-6-on-centos/\">安装教程</a></li>\n<li>Nginx 1.10.2</li>\n</ul>\n<h5 id=\"1-2-基础环境安装\"><a href=\"#1-2-基础环境安装\" class=\"headerlink\" title=\"1.2 基础环境安装\"></a>1.2 基础环境安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# yum update -y</div><div class=\"line\">[root@ultraera ~]# yum groupinstall -y &quot;Base&quot;</div><div class=\"line\">[root@ultraera ~]# yum groupinstall -y &quot;Development tools&quot;</div><div class=\"line\"></div><div class=\"line\"># Install epel</div><div class=\"line\">[root@ultraera ~]# yum install -y epel-release</div><div class=\"line\"></div><div class=\"line\"># Install remi</div><div class=\"line\">[root@ultraera ~]# yum install http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</div><div class=\"line\"></div><div class=\"line\"># Install mysql-community</div><div class=\"line\">[root@ultraera ~]# yum install http://repo.mysql.com/yum/mysql-5.6-community/el/6/x86_64/mysql-community-release-el6-7.noarch.rpm</div></pre></td></tr></table></figure>\n<h5 id=\"1-3-Install-LNMP\"><a href=\"#1-3-Install-LNMP\" class=\"headerlink\" title=\"1.3 Install LNMP\"></a>1.3 Install LNMP</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Install MySQL</div><div class=\"line\">[root@ultraera ~]# yum --enablerepo=mysql-community install -y mysql-server mysql-libs mysql-devel</div><div class=\"line\">[root@ultraera ~]# service mysqld start</div><div class=\"line\">[root@ultraera ~]# mysql_secure_installation</div><div class=\"line\">[root@ultraera ~]# chkconfig mysqld on</div><div class=\"line\"></div><div class=\"line\"># Install Nginx</div><div class=\"line\">[root@ultraera ~]# yum --enablerepo=epel install -y nginx</div><div class=\"line\">[root@ultraera ~]# service nginx start</div><div class=\"line\">[root@ultraera ~]# chkconfig nginx on</div><div class=\"line\"></div><div class=\"line\"># Install PHP and php-fpm</div><div class=\"line\">[root@ultraera ~]# yum --enablerepo=remi-php56 install php php-fpm php-mysql php-gd php-xml php-redis php-libs php-devel php-zlib</div><div class=\"line\">[root@ultraera ~]# service php-fpm start</div><div class=\"line\">[root@ultraera ~]# chkconfig php-fpm on</div><div class=\"line\">[root@ultraera ~]# service nginx restart</div></pre></td></tr></table></figure>\n<h5 id=\"1-4-下载NextCloud\"><a href=\"#1-4-下载NextCloud\" class=\"headerlink\" title=\"1.4 下载NextCloud\"></a>1.4 下载NextCloud</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# wget https://download.nextcloud.com/server/releases/nextcloud-11.0.1.tar.bz2</div><div class=\"line\">[root@ultraera ~]# tar xf nextcloud-11.0.1.tar.bz2</div><div class=\"line\">[root@ultraera ~]# mv nextcloud-11.0.1 /opt/nextcloud</div></pre></td></tr></table></figure>\n<h5 id=\"1-5-配置Nginx和php-fpm\"><a href=\"#1-5-配置Nginx和php-fpm\" class=\"headerlink\" title=\"1.5 配置Nginx和php-fpm\"></a>1.5 配置Nginx和php-fpm</h5><p>因为php-fpm默认运行的用户身份是apache，我们这里使用的环境是nginx，所有要修改php-fpm配置文件的用户和组，注意不要为了省事直接改为root，这在php-fpm中是不允许的</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vim /etc/php-fpm.d/www.conf</div><div class=\"line\">user=nginx</div><div class=\"line\">group=nginx</div><div class=\"line\">[root@ultraera ~]# service php-fpm restart</div></pre></td></tr></table></figure>\n<p>因为NextCloud默认是以Apache的身份运行的，所以我们需要单独配置NextCloud的Nginx配置文件，以下配置文件，你可以直接拿去用，注意在文件中说明了，需要修改的地方：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vim /etc/nginx/conf.d/nextcloud.conf</div><div class=\"line\"> upstream php-handler &#123;</div><div class=\"line\">  \t# 这里是你php-fpm的服务端口，默认是9000</div><div class=\"line\">    server 127.0.0.1:9000;</div><div class=\"line\">    #server unix:/var/run/php5-fpm.sock;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">server &#123;</div><div class=\"line\">  \t# 你的域名</div><div class=\"line\">    listen pan.ultraera.org:80;</div><div class=\"line\">    server_name pan.ultraera.org;</div><div class=\"line\">    # enforce https</div><div class=\"line\">    return 301 https://$server_name$request_uri;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">server &#123;</div><div class=\"line\">    # 你的域名</div><div class=\"line\">    listen pan.ultraera.org:443 ssl;</div><div class=\"line\">    server_name pan.ultraera.org;</div><div class=\"line\"></div><div class=\"line\">  \t# 以下是你的ssl证书文件存放路径</div><div class=\"line\">    ssl_certificate /etc/nginx/ssl/1_pan.ultraera.org_bundle.crt;</div><div class=\"line\">    ssl_certificate_key /etc/nginx/ssl/2_pan.ultraera.org.key;</div><div class=\"line\"></div><div class=\"line\">    # Add headers to serve security related headers</div><div class=\"line\">    # Before enabling Strict-Transport-Security headers please read into this</div><div class=\"line\">    # topic first.</div><div class=\"line\">    # add_header Strict-Transport-Security &quot;max-age=15768000;</div><div class=\"line\">    # includeSubDomains; preload;&quot;;</div><div class=\"line\">    add_header X-Content-Type-Options nosniff;</div><div class=\"line\">    add_header X-Frame-Options &quot;SAMEORIGIN&quot;;</div><div class=\"line\">    add_header X-XSS-Protection &quot;1; mode=block&quot;;</div><div class=\"line\">    add_header X-Robots-Tag none;</div><div class=\"line\">    add_header X-Download-Options noopen;</div><div class=\"line\">    add_header X-Permitted-Cross-Domain-Policies none;</div><div class=\"line\">\tadd_header Strict-Transport-Security &quot;max-age=15552000; includeSubdomains; &quot;;</div><div class=\"line\"></div><div class=\"line\">    # 设定你的NextCloud的根目录，请根据实际修改</div><div class=\"line\">    root /opt/nextcloud/;</div><div class=\"line\"></div><div class=\"line\">    location = /robots.txt &#123;</div><div class=\"line\">        allow all;</div><div class=\"line\">        log_not_found off;</div><div class=\"line\">        access_log off;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    # The following 2 rules are only needed for the user_webfinger app.</div><div class=\"line\">    # Uncomment it if you&apos;re planning to use this app.</div><div class=\"line\">    #rewrite ^/.well-known/host-meta /public.php?service=host-meta last;</div><div class=\"line\">    #rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json</div><div class=\"line\">    # last;</div><div class=\"line\"></div><div class=\"line\">    location = /.well-known/carddav &#123;</div><div class=\"line\">      return 301 $scheme://$host/remote.php/dav;</div><div class=\"line\">    &#125;</div><div class=\"line\">    location = /.well-known/caldav &#123;</div><div class=\"line\">      return 301 $scheme://$host/remote.php/dav;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    # set max upload size</div><div class=\"line\">    client_max_body_size 512M;</div><div class=\"line\">    fastcgi_buffers 64 4K;</div><div class=\"line\"></div><div class=\"line\">    # Disable gzip to avoid the removal of the ETag header</div><div class=\"line\">    gzip off;</div><div class=\"line\"></div><div class=\"line\">    # Uncomment if your server is build with the ngx_pagespeed module</div><div class=\"line\">    # This module is currently not supported.</div><div class=\"line\">    #pagespeed off;</div><div class=\"line\"></div><div class=\"line\">    error_page 403 /core/templates/403.php;</div><div class=\"line\">    error_page 404 /core/templates/404.php;</div><div class=\"line\"></div><div class=\"line\">    location / &#123;</div><div class=\"line\">        rewrite ^ /index.php$uri;</div><div class=\"line\">   &#125;</div><div class=\"line\"></div><div class=\"line\">    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)/ &#123;</div><div class=\"line\">        deny all;</div><div class=\"line\">    &#125;</div><div class=\"line\">    location ~ ^/(?:\\.|autotest|occ|issue|indie|db_|console) &#123;</div><div class=\"line\">        deny all;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    location ~ ^/(?:index|remote|public|cron|core/ajax/update|status|ocs/v[12]|updater/.+|ocs-provider/.+|core/templates/40[34])\\.php(?:$|/) &#123;</div><div class=\"line\">        include fastcgi_params;</div><div class=\"line\">        fastcgi_split_path_info ^(.+\\.php)(/.*)$;</div><div class=\"line\">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class=\"line\">        fastcgi_param PATH_INFO $fastcgi_path_info;</div><div class=\"line\">        fastcgi_param HTTPS on;</div><div class=\"line\">        #Avoid sending the security headers twice</div><div class=\"line\">        fastcgi_param modHeadersAvailable true;</div><div class=\"line\">        fastcgi_param front_controller_active true;</div><div class=\"line\">        fastcgi_pass php-handler;</div><div class=\"line\">        fastcgi_intercept_errors on;</div><div class=\"line\">        fastcgi_request_buffering off;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    location ~ ^/(?:updater|ocs-provider)(?:$|/) &#123;</div><div class=\"line\">        try_files $uri/ =404;</div><div class=\"line\">        index index.php;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    # Adding the cache control header for js and css files</div><div class=\"line\">    # Make sure it is BELOW the PHP block</div><div class=\"line\">    location ~* \\.(?:css|js|woff|svg|gif)$ &#123;</div><div class=\"line\">        try_files $uri /index.php$uri$is_args$args;</div><div class=\"line\">        add_header Cache-Control &quot;public, max-age=7200&quot;;</div><div class=\"line\">        # Add headers to serve security related headers (It is intended to</div><div class=\"line\">        # have those duplicated to the ones above)</div><div class=\"line\">        # Before enabling Strict-Transport-Security headers please read into</div><div class=\"line\">        # this topic first.</div><div class=\"line\">        # add_header Strict-Transport-Security &quot;max-age=15768000;</div><div class=\"line\">        #  includeSubDomains; preload;&quot;;</div><div class=\"line\">        add_header X-Content-Type-Options nosniff;</div><div class=\"line\">        add_header X-Frame-Options &quot;SAMEORIGIN&quot;;</div><div class=\"line\">        add_header X-XSS-Protection &quot;1; mode=block&quot;;</div><div class=\"line\">        add_header X-Robots-Tag none;</div><div class=\"line\">        add_header X-Download-Options noopen;</div><div class=\"line\">        add_header X-Permitted-Cross-Domain-Policies none;</div><div class=\"line\">        # Optional: Don&apos;t log access to assets</div><div class=\"line\">        access_log off;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    location ~* \\.(?:png|html|ttf|ico|jpg|jpeg)$ &#123;</div><div class=\"line\">        try_files $uri /index.php$uri$is_args$args;</div><div class=\"line\">        # Optional: Don&apos;t log access to other assets</div><div class=\"line\">        access_log off;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\">[root@ultraera ~]# service nginx restart</div></pre></td></tr></table></figure>\n<h5 id=\"1-6-文件权限调整\"><a href=\"#1-6-文件权限调整\" class=\"headerlink\" title=\"1.6 文件权限调整\"></a>1.6 文件权限调整</h5><p>因为NextCloud运行是以nginx程序，注意修改目录所属用户和组为nginx</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# chown -R nginx:nginx /opt/nextcloud</div></pre></td></tr></table></figure>\n<h5 id=\"1-7-创建MySQL数据库\"><a href=\"#1-7-创建MySQL数据库\" class=\"headerlink\" title=\"1.7 创建MySQL数据库\"></a>1.7 创建MySQL数据库</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; CREATE DATABASE nextcloud CHARACTER SET UTF-8;</div><div class=\"line\">mysql&gt; GRANT ALL PRIVILEGES ON nextcloud.* TO &apos;nextcloud&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;your_password&apos;;</div><div class=\"line\">mysql&gt; FLUSH PRIVILEGES;</div></pre></td></tr></table></figure>\n<h4 id=\"2-初始化NextCloud\"><a href=\"#2-初始化NextCloud\" class=\"headerlink\" title=\"2. 初始化NextCloud\"></a>2. 初始化NextCloud</h4><p>在浏览器打开你在nginx中配置的域名，NextCloud初始化非常简单，设定一个管理员账户和密码，然后设定数据库即可，按照我们上一步针对MySQL的设定，你会非常清楚地知道你的数据库信息：</p>\n<center><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/jjkqh.png\" alt=\"\"></center>\n\n<p>登录之后的界面是这样：</p>\n<center><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/7n28v.png\" alt=\"\"></center>\n\n<p>你可以在登录之后，在你的右上角点击头像选择Admin进入管理界面查看和修改你的服务器设置，你还可以在浏览器上方看到你的服务器现有哪些问题，会有对应文档提醒你如何解决这些问题。</p>\n<center><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/yx34e.png\" alt=\"\"></center>\n\n\n\n<h4 id=\"3-Other\"><a href=\"#3-Other\" class=\"headerlink\" title=\"3. Other\"></a><strong>3. Other</strong></h4><h5 id=\"3-1-修改默认data目录\"><a href=\"#3-1-修改默认data目录\" class=\"headerlink\" title=\"3.1 修改默认data目录\"></a>3.1 修改默认data目录</h5><p>在我们首次打开NextCloud网页时，需要我们设定datadir目录，这里有个默认目录在nextcloud项目包，这其实是不安全的，我们最后将目录路径修改为其他位置:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# mkdir /nextcloud_files/</div><div class=\"line\">[root@ultraera ~]# chown -R nginx:nginx /nextcloud_files/</div><div class=\"line\"></div><div class=\"line\"># 修改datadirectory的路径</div><div class=\"line\">[root@ultraera ~]# vim /opt/nextcloud/config/config.php</div><div class=\"line\">datadirectory&apos; =&gt; &apos;/nextcloud/data</div></pre></td></tr></table></figure>\n<h5 id=\"3-2-无法登陆到个人用户界面\"><a href=\"#3-2-无法登陆到个人用户界面\" class=\"headerlink\" title=\"3.2 无法登陆到个人用户界面\"></a>3.2 无法登陆到个人用户界面</h5><p>我在安装时碰到这个问题，折腾了很久才解决，因为我们是使用nginx程序，但是php-fpm默认用户身份为apache，所以<code>/var/lib/php/session</code>目录的所属用户和组都是apache，导致我们没有权限去写入session，所以无法登入系统，报错信息可以在NextCloud的log文件下看到：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# tail -n 1 /usr/nextcloud/data/nextcloud.log</div><div class=\"line\">&#123;&quot;reqId&quot;:&quot;NNnIwMCCPDMQtzZW5Ndc&quot;,&quot;remoteAddr&quot;:&quot;180.166.66.226&quot;,&quot;app&quot;:&quot;PHP&quot;,&quot;message&quot;:&quot;session_write_close(): Failed to write session data (files). Please verify that the current setting of session.save_path is correct (\\/var\\/lib\\/php\\/session) at \\/usr\\/nextcloud\\/lib\\/private\\/Session\\/Internal.php#104&quot;,&quot;level&quot;:3,&quot;time&quot;:&quot;2017-02-24T10:46:13+00:00&quot;,&quot;method&quot;:&quot;POST&quot;,&quot;url&quot;:&quot;\\/index.php&quot;,&quot;user&quot;:&quot;samzong&quot;,&quot;version&quot;:&quot;11.0.0.10&quot;&#125;</div><div class=\"line\"></div><div class=\"line\"># 修改/var/lib/php/的属组为nginx即可</div><div class=\"line\">[root@ultraera ~]# chgrp -R nginx /var/lib/php</div></pre></td></tr></table></figure>\n<h5 id=\"3-3-增加redis组件，提高性能\"><a href=\"#3-3-增加redis组件，提高性能\" class=\"headerlink\" title=\"3.3 增加redis组件，提高性能\"></a>3.3 增加redis组件，提高性能</h5><p>关于如何安装redis我在之前的文章中也有讲到，大家可以去看下 <a href=\"https://samzong.me/redis01/\">安装教程</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# yum --enablerepo=remi install -y redis</div><div class=\"line\"></div><div class=\"line\"># 增加php的redis插件</div><div class=\"line\">[root@ultraera ~]# yum --enablerepo=remi-php56 install php-redis</div><div class=\"line\"></div><div class=\"line\"># 配置文件增加redis</div><div class=\"line\">  &apos;memcache.local&apos; =&gt; &apos;\\\\OC\\\\Memcache\\\\Redis&apos;,</div><div class=\"line\">  &apos;memcache.locking&apos; =&gt; &apos;\\\\OC\\\\Memcache\\\\Redis&apos;,</div><div class=\"line\">  &apos;redis&apos; =&gt;</div><div class=\"line\">   array (</div><div class=\"line\">    &apos;host&apos; =&gt; &apos;localhost&apos;,</div><div class=\"line\">    &apos;port&apos; =&gt; 6379,</div><div class=\"line\">   )</div><div class=\"line\"></div><div class=\"line\"># 重启令服务生效</div><div class=\"line\">[root@ultraera ~]# service php-fpm restart</div><div class=\"line\">[root@ultraera ~]# service nginx restart</div></pre></td></tr></table></figure>\n<p>我的NextCloud配置如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?php</div><div class=\"line\">$CONFIG = array (</div><div class=\"line\">  &apos;memcache.local&apos; =&gt; &apos;\\\\OC\\\\Memcache\\\\Redis&apos;,</div><div class=\"line\">  &apos;memcache.locking&apos; =&gt; &apos;\\\\OC\\\\Memcache\\\\Redis&apos;,</div><div class=\"line\">  &apos;redis&apos; =&gt;</div><div class=\"line\">  array (</div><div class=\"line\">    &apos;host&apos; =&gt; &apos;localhost&apos;,</div><div class=\"line\">    &apos;port&apos; =&gt; 6379,</div><div class=\"line\">  ),</div><div class=\"line\">  &apos;enable_previews&apos; =&gt; false,</div><div class=\"line\">  &apos;instanceid&apos; =&gt; &apos;ockhup01dxbf&apos;,</div><div class=\"line\">  &apos;passwordsalt&apos; =&gt; &apos;TlJgWGrE0N7vOrRfZkOojwdYh/BixL&apos;,</div><div class=\"line\">  &apos;secret&apos; =&gt; &apos;/IQh0LioZp5eYFQJhicY7n324Q80WQUYOzWL+8OcxcXVw3Ef&apos;,</div><div class=\"line\">  &apos;trusted_domains&apos; =&gt;</div><div class=\"line\">  array (</div><div class=\"line\">    0 =&gt; &apos;pan.ultraera.org&apos;,</div><div class=\"line\">  ),</div><div class=\"line\">  &apos;datadirectory&apos; =&gt; &apos;/nextcloud&apos;,</div><div class=\"line\">  &apos;overwrite.cli.url&apos; =&gt; &apos;https://pan.ultraera.org&apos;,</div><div class=\"line\">  &apos;dbtype&apos; =&gt; &apos;mysql&apos;,</div><div class=\"line\">  &apos;version&apos; =&gt; &apos;11.0.0.10&apos;,</div><div class=\"line\">  &apos;dbname&apos; =&gt; &apos;nextcloud&apos;,</div><div class=\"line\">  &apos;dbhost&apos; =&gt; &apos;localhost&apos;,</div><div class=\"line\">  &apos;dbport&apos; =&gt; &apos;&apos;,</div><div class=\"line\">  &apos;dbtableprefix&apos; =&gt; &apos;oc_&apos;,</div><div class=\"line\">  &apos;dbuser&apos; =&gt; &apos;nextcloud&apos;,</div><div class=\"line\">  &apos;dbpassword&apos; =&gt; &apos;nextcloud&apos;,</div><div class=\"line\">  &apos;logtimezone&apos; =&gt; &apos;CST&apos;,</div><div class=\"line\">  &apos;installed&apos; =&gt; true,</div><div class=\"line\">  &apos;mail_from_address&apos; =&gt; &apos;luchuanjia&apos;,</div><div class=\"line\">  &apos;mail_smtpmode&apos; =&gt; &apos;php&apos;,</div><div class=\"line\">  &apos;mail_domain&apos; =&gt; &apos;msn.com&apos;,</div><div class=\"line\">);</div></pre></td></tr></table></figure>\n<h5 id=\"3-4-SSL证书\"><a href=\"#3-4-SSL证书\" class=\"headerlink\" title=\"3.4 SSL证书\"></a>3.4 SSL证书</h5><p>现国内提供免费的SSL证书的服务商很多，作为个人站点，免费SSL证书是个挺不错的选择，我在之前nginx配置时将ssl的配置方式写在了配置文件中了，注意如果不启用ssl时，不要启用https的虚拟主机，当然你可以自己生成一个ssl证书来提供服务，但这样在别人访问你的网站时，会不提示不受信任的证书，具体如何获取的证书的方式，因各个厂家方式有些区别，这里就不赘述，可以联系对应的厂商的技术人员咨询。</p>\n<h4 id=\"4-使用现状\"><a href=\"#4-使用现状\" class=\"headerlink\" title=\"4. 使用现状\"></a><strong>4. 使用现状</strong></h4><p>在将服务搭建完成之后，对于存储的文件加密，现在通过jobs，每日凌晨将文件推送到oss内，保存2天的数据，避免因为服务器宕机导致文件丢失；使用端，自己的电脑和手机，还有家人的手机，都安装了应用，后台自动将拍照图片等自动上传到云盘，使用起来目前很稳定，只是iOS应用是收费的，因为NextCloud源于OwnCloud，如果你之前购买了OwnCloud的App也可以直接使用，当然NextCloud也有很多其他功能，可以根据你的实际需求发掘。</p>\n"},{"title":"HowTo Install Openfire  on CentOS","id":"83","updated":"2017-04-21T05:23:17.000Z","date":"2016-08-02T08:04:48.000Z","_content":"\n#### Install Centos 6.x x86_64\n  *略.*\n\n#### 安装依赖软件\n```\nyum -y install wget java glibc.i686\n```\n\n#### 下载openfire 3.8 到本地\n```\nwget http://download.igniterealtime.org/openfire/openfire-3.8.1-1.i386.rpm\n```\n\n#### 安装openfire 3.8\n```\nyum -y install ./openfire*rpm\n```\n#### 设置服务开启自启动\n```\nchkconfig openfire on\n\n```\n#### Yum Install mysql-server\n详见： [How to Install MySQL 5.5/6/7 on RHEL/CentOS 5/6/7](http://blog.ultraera.org/how-to-install-mysql-5-6-on-centos/)\n\n#### 创建openfire数据库\n```\nmysql -u root -p\n\ncreate database openfire character set utf8;\ngrant all privileges on openfire.* to 'openfire'@'127.0.0.1' identified by 'openfire' with grant option;\n```\n#### 启动openfire\n```\nhttp://Host:9090\n```\n\n#### 之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错\n\n#### FAQ\nopenfire安装完毕后无法登录控制台\n```\n报错：Login failed:make sure your username and password are correct and that you’re an admin or moderator\n\n解决方案如下：\n1.使用Mysql查看工具进入数据库，进入表“ofuser”，将该表清空，然后执行该SQL\nINSERT INTO ofUser (username, plainPassword, name, email, creationDate, modificationDate)\n    VALUES ('admin', 'admin', 'Administrator', 'admin@example.com', '0', '0');\n\n2.关闭openfire服务，就是从其控制台stop然后再start，再用用户名：admin,密码：admin登录即可\n```\n\nopenfire 进程无法启动\n```\n报错：nohup: failed to run command `/opt/openfire/jre/bin/java': No such file or directory\n\n解决方案如下：\n经检查是由于openfire未能正确识别jre环境变量导致，安装时自带的jre是32位，但操作系统却是64位操作平台。\n，故在/etc/init.d/openfire的启动脚本修改，\nJAVA_HOME=\"/usr/lib/jvm/jre-$VERSION.x86_64\"\n```\n","source":"_posts/HowTo-Install-Openfire-on-CentOS.md","raw":"---\ntitle: HowTo Install Openfire  on CentOS\ntags: 'Openfire'\ncategories: 'CentOS'\npermalink: install-openfire\nid: 83\nupdated: '2017-04-21 13:23:17'\ndate: 2016-08-02 16:04:48\n---\n\n#### Install Centos 6.x x86_64\n  *略.*\n\n#### 安装依赖软件\n```\nyum -y install wget java glibc.i686\n```\n\n#### 下载openfire 3.8 到本地\n```\nwget http://download.igniterealtime.org/openfire/openfire-3.8.1-1.i386.rpm\n```\n\n#### 安装openfire 3.8\n```\nyum -y install ./openfire*rpm\n```\n#### 设置服务开启自启动\n```\nchkconfig openfire on\n\n```\n#### Yum Install mysql-server\n详见： [How to Install MySQL 5.5/6/7 on RHEL/CentOS 5/6/7](http://blog.ultraera.org/how-to-install-mysql-5-6-on-centos/)\n\n#### 创建openfire数据库\n```\nmysql -u root -p\n\ncreate database openfire character set utf8;\ngrant all privileges on openfire.* to 'openfire'@'127.0.0.1' identified by 'openfire' with grant option;\n```\n#### 启动openfire\n```\nhttp://Host:9090\n```\n\n#### 之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错\n\n#### FAQ\nopenfire安装完毕后无法登录控制台\n```\n报错：Login failed:make sure your username and password are correct and that you’re an admin or moderator\n\n解决方案如下：\n1.使用Mysql查看工具进入数据库，进入表“ofuser”，将该表清空，然后执行该SQL\nINSERT INTO ofUser (username, plainPassword, name, email, creationDate, modificationDate)\n    VALUES ('admin', 'admin', 'Administrator', 'admin@example.com', '0', '0');\n\n2.关闭openfire服务，就是从其控制台stop然后再start，再用用户名：admin,密码：admin登录即可\n```\n\nopenfire 进程无法启动\n```\n报错：nohup: failed to run command `/opt/openfire/jre/bin/java': No such file or directory\n\n解决方案如下：\n经检查是由于openfire未能正确识别jre环境变量导致，安装时自带的jre是32位，但操作系统却是64位操作平台。\n，故在/etc/init.d/openfire的启动脚本修改，\nJAVA_HOME=\"/usr/lib/jvm/jre-$VERSION.x86_64\"\n```\n","slug":"install-openfire","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq7w002441tp9t58e6hc","content":"<h4 id=\"Install-Centos-6-x-x86-64\"><a href=\"#Install-Centos-6-x-x86-64\" class=\"headerlink\" title=\"Install Centos 6.x x86_64\"></a>Install Centos 6.x x86_64</h4><p>  <em>略.</em></p>\n<h4 id=\"安装依赖软件\"><a href=\"#安装依赖软件\" class=\"headerlink\" title=\"安装依赖软件\"></a>安装依赖软件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install wget java glibc.i686</div></pre></td></tr></table></figure>\n<h4 id=\"下载openfire-3-8-到本地\"><a href=\"#下载openfire-3-8-到本地\" class=\"headerlink\" title=\"下载openfire 3.8 到本地\"></a>下载openfire 3.8 到本地</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://download.igniterealtime.org/openfire/openfire-3.8.1-1.i386.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"安装openfire-3-8\"><a href=\"#安装openfire-3-8\" class=\"headerlink\" title=\"安装openfire 3.8\"></a>安装openfire 3.8</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install ./openfire*rpm</div></pre></td></tr></table></figure>\n<h4 id=\"设置服务开启自启动\"><a href=\"#设置服务开启自启动\" class=\"headerlink\" title=\"设置服务开启自启动\"></a>设置服务开启自启动</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig openfire on</div></pre></td></tr></table></figure>\n<h4 id=\"Yum-Install-mysql-server\"><a href=\"#Yum-Install-mysql-server\" class=\"headerlink\" title=\"Yum Install mysql-server\"></a>Yum Install mysql-server</h4><p>详见： <a href=\"http://blog.ultraera.org/how-to-install-mysql-5-6-on-centos/\" target=\"_blank\" rel=\"external\">How to Install MySQL 5.5/6/7 on RHEL/CentOS 5/6/7</a></p>\n<h4 id=\"创建openfire数据库\"><a href=\"#创建openfire数据库\" class=\"headerlink\" title=\"创建openfire数据库\"></a>创建openfire数据库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -u root -p</div><div class=\"line\"></div><div class=\"line\">create database openfire character set utf8;</div><div class=\"line\">grant all privileges on openfire.* to &apos;openfire&apos;@&apos;127.0.0.1&apos; identified by &apos;openfire&apos; with grant option;</div></pre></td></tr></table></figure>\n<h4 id=\"启动openfire\"><a href=\"#启动openfire\" class=\"headerlink\" title=\"启动openfire\"></a>启动openfire</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">http://Host:9090</div></pre></td></tr></table></figure>\n<h4 id=\"之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错\"><a href=\"#之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错\" class=\"headerlink\" title=\"之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错\"></a>之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错</h4><h4 id=\"FAQ\"><a href=\"#FAQ\" class=\"headerlink\" title=\"FAQ\"></a>FAQ</h4><p>openfire安装完毕后无法登录控制台<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">报错：Login failed:make sure your username and password are correct and that you’re an admin or moderator</div><div class=\"line\"></div><div class=\"line\">解决方案如下：</div><div class=\"line\">1.使用Mysql查看工具进入数据库，进入表“ofuser”，将该表清空，然后执行该SQL</div><div class=\"line\">INSERT INTO ofUser (username, plainPassword, name, email, creationDate, modificationDate)</div><div class=\"line\">    VALUES (&apos;admin&apos;, &apos;admin&apos;, &apos;Administrator&apos;, &apos;admin@example.com&apos;, &apos;0&apos;, &apos;0&apos;);</div><div class=\"line\"></div><div class=\"line\">2.关闭openfire服务，就是从其控制台stop然后再start，再用用户名：admin,密码：admin登录即可</div></pre></td></tr></table></figure></p>\n<p>openfire 进程无法启动<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">报错：nohup: failed to run command `/opt/openfire/jre/bin/java&apos;: No such file or directory</div><div class=\"line\"></div><div class=\"line\">解决方案如下：</div><div class=\"line\">经检查是由于openfire未能正确识别jre环境变量导致，安装时自带的jre是32位，但操作系统却是64位操作平台。</div><div class=\"line\">，故在/etc/init.d/openfire的启动脚本修改，</div><div class=\"line\">JAVA_HOME=&quot;/usr/lib/jvm/jre-$VERSION.x86_64&quot;</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"Install-Centos-6-x-x86-64\"><a href=\"#Install-Centos-6-x-x86-64\" class=\"headerlink\" title=\"Install Centos 6.x x86_64\"></a>Install Centos 6.x x86_64</h4><p>  <em>略.</em></p>\n<h4 id=\"安装依赖软件\"><a href=\"#安装依赖软件\" class=\"headerlink\" title=\"安装依赖软件\"></a>安装依赖软件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install wget java glibc.i686</div></pre></td></tr></table></figure>\n<h4 id=\"下载openfire-3-8-到本地\"><a href=\"#下载openfire-3-8-到本地\" class=\"headerlink\" title=\"下载openfire 3.8 到本地\"></a>下载openfire 3.8 到本地</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://download.igniterealtime.org/openfire/openfire-3.8.1-1.i386.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"安装openfire-3-8\"><a href=\"#安装openfire-3-8\" class=\"headerlink\" title=\"安装openfire 3.8\"></a>安装openfire 3.8</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install ./openfire*rpm</div></pre></td></tr></table></figure>\n<h4 id=\"设置服务开启自启动\"><a href=\"#设置服务开启自启动\" class=\"headerlink\" title=\"设置服务开启自启动\"></a>设置服务开启自启动</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig openfire on</div></pre></td></tr></table></figure>\n<h4 id=\"Yum-Install-mysql-server\"><a href=\"#Yum-Install-mysql-server\" class=\"headerlink\" title=\"Yum Install mysql-server\"></a>Yum Install mysql-server</h4><p>详见： <a href=\"http://blog.ultraera.org/how-to-install-mysql-5-6-on-centos/\">How to Install MySQL 5.5/6/7 on RHEL/CentOS 5/6/7</a></p>\n<h4 id=\"创建openfire数据库\"><a href=\"#创建openfire数据库\" class=\"headerlink\" title=\"创建openfire数据库\"></a>创建openfire数据库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -u root -p</div><div class=\"line\"></div><div class=\"line\">create database openfire character set utf8;</div><div class=\"line\">grant all privileges on openfire.* to &apos;openfire&apos;@&apos;127.0.0.1&apos; identified by &apos;openfire&apos; with grant option;</div></pre></td></tr></table></figure>\n<h4 id=\"启动openfire\"><a href=\"#启动openfire\" class=\"headerlink\" title=\"启动openfire\"></a>启动openfire</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">http://Host:9090</div></pre></td></tr></table></figure>\n<h4 id=\"之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错\"><a href=\"#之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错\" class=\"headerlink\" title=\"之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错\"></a>之后的初始化步骤，请根据实际操作，注意设定数据库地址用户名和密码时不要出错</h4><h4 id=\"FAQ\"><a href=\"#FAQ\" class=\"headerlink\" title=\"FAQ\"></a>FAQ</h4><p>openfire安装完毕后无法登录控制台<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">报错：Login failed:make sure your username and password are correct and that you’re an admin or moderator</div><div class=\"line\"></div><div class=\"line\">解决方案如下：</div><div class=\"line\">1.使用Mysql查看工具进入数据库，进入表“ofuser”，将该表清空，然后执行该SQL</div><div class=\"line\">INSERT INTO ofUser (username, plainPassword, name, email, creationDate, modificationDate)</div><div class=\"line\">    VALUES (&apos;admin&apos;, &apos;admin&apos;, &apos;Administrator&apos;, &apos;admin@example.com&apos;, &apos;0&apos;, &apos;0&apos;);</div><div class=\"line\"></div><div class=\"line\">2.关闭openfire服务，就是从其控制台stop然后再start，再用用户名：admin,密码：admin登录即可</div></pre></td></tr></table></figure></p>\n<p>openfire 进程无法启动<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">报错：nohup: failed to run command `/opt/openfire/jre/bin/java&apos;: No such file or directory</div><div class=\"line\"></div><div class=\"line\">解决方案如下：</div><div class=\"line\">经检查是由于openfire未能正确识别jre环境变量导致，安装时自带的jre是32位，但操作系统却是64位操作平台。</div><div class=\"line\">，故在/etc/init.d/openfire的启动脚本修改，</div><div class=\"line\">JAVA_HOME=&quot;/usr/lib/jvm/jre-$VERSION.x86_64&quot;</div></pre></td></tr></table></figure></p>\n"},{"title":"HowTo Install PostgreSQL 9.5 on CentOS 6.x","id":"99","updated":"2017-04-21T05:21:54.000Z","date":"2016-10-19T23:25:37.000Z","_content":"\n### CentOS 6\n\n\n##### 1. Install PostgreSQL repository and the PostgreSQL server by running the following:\n```\nsudo yum install https://download.postgresql.org/pub/repos/yum/9.5/redhat/rhel-6-x86_64/pgdg-centos95-9.5-2.noarch.rpm\n\nsudo yum install postgresql95-serve\n```\n\n##### 2. Create the PostgreSQL database cluster.\n```\nsduo service postgresql-9.5 initdb\n```\n\n##### 3. Enable automatic PostgreSQL server startup.\n```\nsudo chkconfig postgresql-9.5 on\n```\n\n##### 4. Start the PostgreSQL server.\n```\nsudo service postgresql-9.5 start\n```\n\n### CentOS 7\n\n\n##### 1. Install PostgreSQL repository and the PostgreSQL server by running the following:\n```\nsudo yum install https://download.postgresql.org/pub/repos/yum/9.5 /redhat/rhel-7-x86_64/pgdg-centos95-9.5-2.noarch.rpm\n\nsudo yum install postgresql95-serve\n```\n\n##### 2. Create the PostgreSQL database cluster.\n```\nsudo /usr/pgsql-9.5/bin/postgresql95-setup initdb\n```\n\n##### 3. Enable automatic PostgreSQL server startup.\n```\nsudo systemctl enable postgresql-9.5\n```\n\n##### 4. Start the PostgreSQL server.\n```\nsudo systemctl start postgresql-9.5\n```\n\n### Configurations for CentOS\nWhen installing in CentOs env. you will also need to make the following configurations.\n\n##### 1. Change authentication to md5.\n```\nsudo vi /var/lib/pgsql/9.5/data/pg_hba.conf\n```\n\n##### 2. Change METHOD to md5.\n```\n# IPv4 local connections:\nhost    all             all             127.0.0.1/32            md5\n\n# IPv6 local connections:\nhost    all             all             ::1/128                 md5\n```\n\n##### 3. Restart PostgreSQL\n","source":"_posts/HowTo-Install-PostgreSQL-9-5-on-CentOS-6-x.md","raw":"---\ntitle: HowTo Install PostgreSQL 9.5 on CentOS 6.x\ntags: 'PostgreSQL'\ncategories: 'PostgreSQL'\npermalink: install-and-set-up-postgresql-9-5-on-centos\nid: 99\nupdated: '2017-04-21 13:21:54'\ndate: 2016-10-20 07:25:37\n---\n\n### CentOS 6\n\n\n##### 1. Install PostgreSQL repository and the PostgreSQL server by running the following:\n```\nsudo yum install https://download.postgresql.org/pub/repos/yum/9.5/redhat/rhel-6-x86_64/pgdg-centos95-9.5-2.noarch.rpm\n\nsudo yum install postgresql95-serve\n```\n\n##### 2. Create the PostgreSQL database cluster.\n```\nsduo service postgresql-9.5 initdb\n```\n\n##### 3. Enable automatic PostgreSQL server startup.\n```\nsudo chkconfig postgresql-9.5 on\n```\n\n##### 4. Start the PostgreSQL server.\n```\nsudo service postgresql-9.5 start\n```\n\n### CentOS 7\n\n\n##### 1. Install PostgreSQL repository and the PostgreSQL server by running the following:\n```\nsudo yum install https://download.postgresql.org/pub/repos/yum/9.5 /redhat/rhel-7-x86_64/pgdg-centos95-9.5-2.noarch.rpm\n\nsudo yum install postgresql95-serve\n```\n\n##### 2. Create the PostgreSQL database cluster.\n```\nsudo /usr/pgsql-9.5/bin/postgresql95-setup initdb\n```\n\n##### 3. Enable automatic PostgreSQL server startup.\n```\nsudo systemctl enable postgresql-9.5\n```\n\n##### 4. Start the PostgreSQL server.\n```\nsudo systemctl start postgresql-9.5\n```\n\n### Configurations for CentOS\nWhen installing in CentOs env. you will also need to make the following configurations.\n\n##### 1. Change authentication to md5.\n```\nsudo vi /var/lib/pgsql/9.5/data/pg_hba.conf\n```\n\n##### 2. Change METHOD to md5.\n```\n# IPv4 local connections:\nhost    all             all             127.0.0.1/32            md5\n\n# IPv6 local connections:\nhost    all             all             ::1/128                 md5\n```\n\n##### 3. Restart PostgreSQL\n","slug":"install-and-set-up-postgresql-9-5-on-centos","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq7y002741tpi1lzi4n4","content":"<h3 id=\"CentOS-6\"><a href=\"#CentOS-6\" class=\"headerlink\" title=\"CentOS 6\"></a>CentOS 6</h3><h5 id=\"1-Install-PostgreSQL-repository-and-the-PostgreSQL-server-by-running-the-following\"><a href=\"#1-Install-PostgreSQL-repository-and-the-PostgreSQL-server-by-running-the-following\" class=\"headerlink\" title=\"1. Install PostgreSQL repository and the PostgreSQL server by running the following:\"></a>1. Install PostgreSQL repository and the PostgreSQL server by running the following:</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo yum install https://download.postgresql.org/pub/repos/yum/9.5/redhat/rhel-6-x86_64/pgdg-centos95-9.5-2.noarch.rpm</div><div class=\"line\"></div><div class=\"line\">sudo yum install postgresql95-serve</div></pre></td></tr></table></figure>\n<h5 id=\"2-Create-the-PostgreSQL-database-cluster\"><a href=\"#2-Create-the-PostgreSQL-database-cluster\" class=\"headerlink\" title=\"2. Create the PostgreSQL database cluster.\"></a>2. Create the PostgreSQL database cluster.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sduo service postgresql-9.5 initdb</div></pre></td></tr></table></figure>\n<h5 id=\"3-Enable-automatic-PostgreSQL-server-startup\"><a href=\"#3-Enable-automatic-PostgreSQL-server-startup\" class=\"headerlink\" title=\"3. Enable automatic PostgreSQL server startup.\"></a>3. Enable automatic PostgreSQL server startup.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo chkconfig postgresql-9.5 on</div></pre></td></tr></table></figure>\n<h5 id=\"4-Start-the-PostgreSQL-server\"><a href=\"#4-Start-the-PostgreSQL-server\" class=\"headerlink\" title=\"4. Start the PostgreSQL server.\"></a>4. Start the PostgreSQL server.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo service postgresql-9.5 start</div></pre></td></tr></table></figure>\n<h3 id=\"CentOS-7\"><a href=\"#CentOS-7\" class=\"headerlink\" title=\"CentOS 7\"></a>CentOS 7</h3><h5 id=\"1-Install-PostgreSQL-repository-and-the-PostgreSQL-server-by-running-the-following-1\"><a href=\"#1-Install-PostgreSQL-repository-and-the-PostgreSQL-server-by-running-the-following-1\" class=\"headerlink\" title=\"1. Install PostgreSQL repository and the PostgreSQL server by running the following:\"></a>1. Install PostgreSQL repository and the PostgreSQL server by running the following:</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo yum install https://download.postgresql.org/pub/repos/yum/9.5 /redhat/rhel-7-x86_64/pgdg-centos95-9.5-2.noarch.rpm</div><div class=\"line\"></div><div class=\"line\">sudo yum install postgresql95-serve</div></pre></td></tr></table></figure>\n<h5 id=\"2-Create-the-PostgreSQL-database-cluster-1\"><a href=\"#2-Create-the-PostgreSQL-database-cluster-1\" class=\"headerlink\" title=\"2. Create the PostgreSQL database cluster.\"></a>2. Create the PostgreSQL database cluster.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo /usr/pgsql-9.5/bin/postgresql95-setup initdb</div></pre></td></tr></table></figure>\n<h5 id=\"3-Enable-automatic-PostgreSQL-server-startup-1\"><a href=\"#3-Enable-automatic-PostgreSQL-server-startup-1\" class=\"headerlink\" title=\"3. Enable automatic PostgreSQL server startup.\"></a>3. Enable automatic PostgreSQL server startup.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo systemctl enable postgresql-9.5</div></pre></td></tr></table></figure>\n<h5 id=\"4-Start-the-PostgreSQL-server-1\"><a href=\"#4-Start-the-PostgreSQL-server-1\" class=\"headerlink\" title=\"4. Start the PostgreSQL server.\"></a>4. Start the PostgreSQL server.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo systemctl start postgresql-9.5</div></pre></td></tr></table></figure>\n<h3 id=\"Configurations-for-CentOS\"><a href=\"#Configurations-for-CentOS\" class=\"headerlink\" title=\"Configurations for CentOS\"></a>Configurations for CentOS</h3><p>When installing in CentOs env. you will also need to make the following configurations.</p>\n<h5 id=\"1-Change-authentication-to-md5\"><a href=\"#1-Change-authentication-to-md5\" class=\"headerlink\" title=\"1. Change authentication to md5.\"></a>1. Change authentication to md5.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo vi /var/lib/pgsql/9.5/data/pg_hba.conf</div></pre></td></tr></table></figure>\n<h5 id=\"2-Change-METHOD-to-md5\"><a href=\"#2-Change-METHOD-to-md5\" class=\"headerlink\" title=\"2. Change METHOD to md5.\"></a>2. Change METHOD to md5.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># IPv4 local connections:</div><div class=\"line\">host    all             all             127.0.0.1/32            md5</div><div class=\"line\"></div><div class=\"line\"># IPv6 local connections:</div><div class=\"line\">host    all             all             ::1/128                 md5</div></pre></td></tr></table></figure>\n<h5 id=\"3-Restart-PostgreSQL\"><a href=\"#3-Restart-PostgreSQL\" class=\"headerlink\" title=\"3. Restart PostgreSQL\"></a>3. Restart PostgreSQL</h5>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"CentOS-6\"><a href=\"#CentOS-6\" class=\"headerlink\" title=\"CentOS 6\"></a>CentOS 6</h3><h5 id=\"1-Install-PostgreSQL-repository-and-the-PostgreSQL-server-by-running-the-following\"><a href=\"#1-Install-PostgreSQL-repository-and-the-PostgreSQL-server-by-running-the-following\" class=\"headerlink\" title=\"1. Install PostgreSQL repository and the PostgreSQL server by running the following:\"></a>1. Install PostgreSQL repository and the PostgreSQL server by running the following:</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo yum install https://download.postgresql.org/pub/repos/yum/9.5/redhat/rhel-6-x86_64/pgdg-centos95-9.5-2.noarch.rpm</div><div class=\"line\"></div><div class=\"line\">sudo yum install postgresql95-serve</div></pre></td></tr></table></figure>\n<h5 id=\"2-Create-the-PostgreSQL-database-cluster\"><a href=\"#2-Create-the-PostgreSQL-database-cluster\" class=\"headerlink\" title=\"2. Create the PostgreSQL database cluster.\"></a>2. Create the PostgreSQL database cluster.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sduo service postgresql-9.5 initdb</div></pre></td></tr></table></figure>\n<h5 id=\"3-Enable-automatic-PostgreSQL-server-startup\"><a href=\"#3-Enable-automatic-PostgreSQL-server-startup\" class=\"headerlink\" title=\"3. Enable automatic PostgreSQL server startup.\"></a>3. Enable automatic PostgreSQL server startup.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo chkconfig postgresql-9.5 on</div></pre></td></tr></table></figure>\n<h5 id=\"4-Start-the-PostgreSQL-server\"><a href=\"#4-Start-the-PostgreSQL-server\" class=\"headerlink\" title=\"4. Start the PostgreSQL server.\"></a>4. Start the PostgreSQL server.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo service postgresql-9.5 start</div></pre></td></tr></table></figure>\n<h3 id=\"CentOS-7\"><a href=\"#CentOS-7\" class=\"headerlink\" title=\"CentOS 7\"></a>CentOS 7</h3><h5 id=\"1-Install-PostgreSQL-repository-and-the-PostgreSQL-server-by-running-the-following-1\"><a href=\"#1-Install-PostgreSQL-repository-and-the-PostgreSQL-server-by-running-the-following-1\" class=\"headerlink\" title=\"1. Install PostgreSQL repository and the PostgreSQL server by running the following:\"></a>1. Install PostgreSQL repository and the PostgreSQL server by running the following:</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo yum install https://download.postgresql.org/pub/repos/yum/9.5 /redhat/rhel-7-x86_64/pgdg-centos95-9.5-2.noarch.rpm</div><div class=\"line\"></div><div class=\"line\">sudo yum install postgresql95-serve</div></pre></td></tr></table></figure>\n<h5 id=\"2-Create-the-PostgreSQL-database-cluster-1\"><a href=\"#2-Create-the-PostgreSQL-database-cluster-1\" class=\"headerlink\" title=\"2. Create the PostgreSQL database cluster.\"></a>2. Create the PostgreSQL database cluster.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo /usr/pgsql-9.5/bin/postgresql95-setup initdb</div></pre></td></tr></table></figure>\n<h5 id=\"3-Enable-automatic-PostgreSQL-server-startup-1\"><a href=\"#3-Enable-automatic-PostgreSQL-server-startup-1\" class=\"headerlink\" title=\"3. Enable automatic PostgreSQL server startup.\"></a>3. Enable automatic PostgreSQL server startup.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo systemctl enable postgresql-9.5</div></pre></td></tr></table></figure>\n<h5 id=\"4-Start-the-PostgreSQL-server-1\"><a href=\"#4-Start-the-PostgreSQL-server-1\" class=\"headerlink\" title=\"4. Start the PostgreSQL server.\"></a>4. Start the PostgreSQL server.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo systemctl start postgresql-9.5</div></pre></td></tr></table></figure>\n<h3 id=\"Configurations-for-CentOS\"><a href=\"#Configurations-for-CentOS\" class=\"headerlink\" title=\"Configurations for CentOS\"></a>Configurations for CentOS</h3><p>When installing in CentOs env. you will also need to make the following configurations.</p>\n<h5 id=\"1-Change-authentication-to-md5\"><a href=\"#1-Change-authentication-to-md5\" class=\"headerlink\" title=\"1. Change authentication to md5.\"></a>1. Change authentication to md5.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo vi /var/lib/pgsql/9.5/data/pg_hba.conf</div></pre></td></tr></table></figure>\n<h5 id=\"2-Change-METHOD-to-md5\"><a href=\"#2-Change-METHOD-to-md5\" class=\"headerlink\" title=\"2. Change METHOD to md5.\"></a>2. Change METHOD to md5.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># IPv4 local connections:</div><div class=\"line\">host    all             all             127.0.0.1/32            md5</div><div class=\"line\"></div><div class=\"line\"># IPv6 local connections:</div><div class=\"line\">host    all             all             ::1/128                 md5</div></pre></td></tr></table></figure>\n<h5 id=\"3-Restart-PostgreSQL\"><a href=\"#3-Restart-PostgreSQL\" class=\"headerlink\" title=\"3. Restart PostgreSQL\"></a>3. Restart PostgreSQL</h5>"},{"title":"HowTo Install Python 2.7.8 on CentOS 6.x","id":"40","updated":"2017-04-21T05:35:49.000Z","date":"2016-05-04T03:04:19.000Z","_content":"\nCentOS 6.5 still come with Python 2.6 and I need 2.7, below a simple tutorial how to achieve this with no pain and not messing with installed Python.\n\nUpdate CentOS and install development tools\n\n```\nyum -y update\nyum groupinstall -y 'development tools'\n```\n\nAlso you need the packages below to enable SSL, bz2, zlib for Python and some utils:\n```\nyum install -y zlib-devel bzip2-devel openssl-devel xz-libs wget\n```\n\n## Installing Python 2.7.8 from source\nDownload Python and extract it\n```\nwget http://www.python.org/ftp/python/2.7.8/Python-2.7.8.tar.xz\nxz -d Python-2.7.8.tar.xz\ntar -xvf Python-2.7.8.tar\n```\n\n## Installation process\nSince we already installed all the dependencies we are ready to go:\n```\n# Enter the directory:\ncd Python-2.7.8\n\n# Run the configure:\n./configure --prefix=/usr/local\n\n# compile and install it:\nmake\nmake altinstall\n\n# Checking Python version:\n[root@nicetry ~]# python2.7 -V\nPython 2.7.8\n```\nIf you need set <code>PATH</code> variable check the line below:\n```\nexport PATH=\"/usr/local/bin:$PATH\"\n```\n\n## Installing pip and virtualenv\nNow we have Python installed, but something is missing isn't? Yes! We need pip and virtualenv.\n\n### Install setuptools\n```\nwget --no-check-certificate https://pypi.python.org/packages/source/s/setuptools/setuptools-1.4.2.tar.gz\n\n# Extract the files:\ntar -xvf setuptools-1.4.2.tar.gz\ncd setuptools-1.4.2\n\n# Install setuptools using the Python 2.7.8:\npython2.7 setup.py install\n```\n\n### Install pip\n```\ncurl https://raw.githubusercontent.com/pypa/pip/master/contrib/get-pip.py | python2.7 -\n```\n\n### And finally virtualenv\n```\npip2.7 install virtualenv\n```\n\nAnd that's all, we have Python 2.7.8 installed on CentOS.\n","source":"_posts/HowTo-Install-Python-2-7-8-on-CentOS-6-x.md","raw":"---\ntitle: HowTo Install Python 2.7.8 on CentOS 6.x\ntags: 'Python'\ncategories: 'Python'\npermalink: installing-python-2-7-8-on-centos-6-5\nid: 40\nupdated: '2017-04-21 13:35:49'\ndate: 2016-05-04 11:04:19\n---\n\nCentOS 6.5 still come with Python 2.6 and I need 2.7, below a simple tutorial how to achieve this with no pain and not messing with installed Python.\n\nUpdate CentOS and install development tools\n\n```\nyum -y update\nyum groupinstall -y 'development tools'\n```\n\nAlso you need the packages below to enable SSL, bz2, zlib for Python and some utils:\n```\nyum install -y zlib-devel bzip2-devel openssl-devel xz-libs wget\n```\n\n## Installing Python 2.7.8 from source\nDownload Python and extract it\n```\nwget http://www.python.org/ftp/python/2.7.8/Python-2.7.8.tar.xz\nxz -d Python-2.7.8.tar.xz\ntar -xvf Python-2.7.8.tar\n```\n\n## Installation process\nSince we already installed all the dependencies we are ready to go:\n```\n# Enter the directory:\ncd Python-2.7.8\n\n# Run the configure:\n./configure --prefix=/usr/local\n\n# compile and install it:\nmake\nmake altinstall\n\n# Checking Python version:\n[root@nicetry ~]# python2.7 -V\nPython 2.7.8\n```\nIf you need set <code>PATH</code> variable check the line below:\n```\nexport PATH=\"/usr/local/bin:$PATH\"\n```\n\n## Installing pip and virtualenv\nNow we have Python installed, but something is missing isn't? Yes! We need pip and virtualenv.\n\n### Install setuptools\n```\nwget --no-check-certificate https://pypi.python.org/packages/source/s/setuptools/setuptools-1.4.2.tar.gz\n\n# Extract the files:\ntar -xvf setuptools-1.4.2.tar.gz\ncd setuptools-1.4.2\n\n# Install setuptools using the Python 2.7.8:\npython2.7 setup.py install\n```\n\n### Install pip\n```\ncurl https://raw.githubusercontent.com/pypa/pip/master/contrib/get-pip.py | python2.7 -\n```\n\n### And finally virtualenv\n```\npip2.7 install virtualenv\n```\n\nAnd that's all, we have Python 2.7.8 installed on CentOS.\n","slug":"installing-python-2-7-8-on-centos-6-5","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq82002a41tpbwaykvob","content":"<p>CentOS 6.5 still come with Python 2.6 and I need 2.7, below a simple tutorial how to achieve this with no pain and not messing with installed Python.</p>\n<p>Update CentOS and install development tools</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y update</div><div class=\"line\">yum groupinstall -y &apos;development tools&apos;</div></pre></td></tr></table></figure>\n<p>Also you need the packages below to enable SSL, bz2, zlib for Python and some utils:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y zlib-devel bzip2-devel openssl-devel xz-libs wget</div></pre></td></tr></table></figure></p>\n<h2 id=\"Installing-Python-2-7-8-from-source\"><a href=\"#Installing-Python-2-7-8-from-source\" class=\"headerlink\" title=\"Installing Python 2.7.8 from source\"></a>Installing Python 2.7.8 from source</h2><p>Download Python and extract it<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://www.python.org/ftp/python/2.7.8/Python-2.7.8.tar.xz</div><div class=\"line\">xz -d Python-2.7.8.tar.xz</div><div class=\"line\">tar -xvf Python-2.7.8.tar</div></pre></td></tr></table></figure></p>\n<h2 id=\"Installation-process\"><a href=\"#Installation-process\" class=\"headerlink\" title=\"Installation process\"></a>Installation process</h2><p>Since we already installed all the dependencies we are ready to go:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Enter the directory:</div><div class=\"line\">cd Python-2.7.8</div><div class=\"line\"></div><div class=\"line\"># Run the configure:</div><div class=\"line\">./configure --prefix=/usr/local</div><div class=\"line\"></div><div class=\"line\"># compile and install it:</div><div class=\"line\">make</div><div class=\"line\">make altinstall</div><div class=\"line\"></div><div class=\"line\"># Checking Python version:</div><div class=\"line\">[root@nicetry ~]# python2.7 -V</div><div class=\"line\">Python 2.7.8</div></pre></td></tr></table></figure></p>\n<p>If you need set <code>PATH</code> variable check the line below:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">export PATH=&quot;/usr/local/bin:$PATH&quot;</div></pre></td></tr></table></figure></p>\n<h2 id=\"Installing-pip-and-virtualenv\"><a href=\"#Installing-pip-and-virtualenv\" class=\"headerlink\" title=\"Installing pip and virtualenv\"></a>Installing pip and virtualenv</h2><p>Now we have Python installed, but something is missing isn’t? Yes! We need pip and virtualenv.</p>\n<h3 id=\"Install-setuptools\"><a href=\"#Install-setuptools\" class=\"headerlink\" title=\"Install setuptools\"></a>Install setuptools</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget --no-check-certificate https://pypi.python.org/packages/source/s/setuptools/setuptools-1.4.2.tar.gz</div><div class=\"line\"></div><div class=\"line\"># Extract the files:</div><div class=\"line\">tar -xvf setuptools-1.4.2.tar.gz</div><div class=\"line\">cd setuptools-1.4.2</div><div class=\"line\"></div><div class=\"line\"># Install setuptools using the Python 2.7.8:</div><div class=\"line\">python2.7 setup.py install</div></pre></td></tr></table></figure>\n<h3 id=\"Install-pip\"><a href=\"#Install-pip\" class=\"headerlink\" title=\"Install pip\"></a>Install pip</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl https://raw.githubusercontent.com/pypa/pip/master/contrib/get-pip.py | python2.7 -</div></pre></td></tr></table></figure>\n<h3 id=\"And-finally-virtualenv\"><a href=\"#And-finally-virtualenv\" class=\"headerlink\" title=\"And finally virtualenv\"></a>And finally virtualenv</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pip2.7 install virtualenv</div></pre></td></tr></table></figure>\n<p>And that’s all, we have Python 2.7.8 installed on CentOS.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>CentOS 6.5 still come with Python 2.6 and I need 2.7, below a simple tutorial how to achieve this with no pain and not messing with installed Python.</p>\n<p>Update CentOS and install development tools</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y update</div><div class=\"line\">yum groupinstall -y &apos;development tools&apos;</div></pre></td></tr></table></figure>\n<p>Also you need the packages below to enable SSL, bz2, zlib for Python and some utils:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y zlib-devel bzip2-devel openssl-devel xz-libs wget</div></pre></td></tr></table></figure></p>\n<h2 id=\"Installing-Python-2-7-8-from-source\"><a href=\"#Installing-Python-2-7-8-from-source\" class=\"headerlink\" title=\"Installing Python 2.7.8 from source\"></a>Installing Python 2.7.8 from source</h2><p>Download Python and extract it<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://www.python.org/ftp/python/2.7.8/Python-2.7.8.tar.xz</div><div class=\"line\">xz -d Python-2.7.8.tar.xz</div><div class=\"line\">tar -xvf Python-2.7.8.tar</div></pre></td></tr></table></figure></p>\n<h2 id=\"Installation-process\"><a href=\"#Installation-process\" class=\"headerlink\" title=\"Installation process\"></a>Installation process</h2><p>Since we already installed all the dependencies we are ready to go:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Enter the directory:</div><div class=\"line\">cd Python-2.7.8</div><div class=\"line\"></div><div class=\"line\"># Run the configure:</div><div class=\"line\">./configure --prefix=/usr/local</div><div class=\"line\"></div><div class=\"line\"># compile and install it:</div><div class=\"line\">make</div><div class=\"line\">make altinstall</div><div class=\"line\"></div><div class=\"line\"># Checking Python version:</div><div class=\"line\">[root@nicetry ~]# python2.7 -V</div><div class=\"line\">Python 2.7.8</div></pre></td></tr></table></figure></p>\n<p>If you need set <code>PATH</code> variable check the line below:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">export PATH=&quot;/usr/local/bin:$PATH&quot;</div></pre></td></tr></table></figure></p>\n<h2 id=\"Installing-pip-and-virtualenv\"><a href=\"#Installing-pip-and-virtualenv\" class=\"headerlink\" title=\"Installing pip and virtualenv\"></a>Installing pip and virtualenv</h2><p>Now we have Python installed, but something is missing isn’t? Yes! We need pip and virtualenv.</p>\n<h3 id=\"Install-setuptools\"><a href=\"#Install-setuptools\" class=\"headerlink\" title=\"Install setuptools\"></a>Install setuptools</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget --no-check-certificate https://pypi.python.org/packages/source/s/setuptools/setuptools-1.4.2.tar.gz</div><div class=\"line\"></div><div class=\"line\"># Extract the files:</div><div class=\"line\">tar -xvf setuptools-1.4.2.tar.gz</div><div class=\"line\">cd setuptools-1.4.2</div><div class=\"line\"></div><div class=\"line\"># Install setuptools using the Python 2.7.8:</div><div class=\"line\">python2.7 setup.py install</div></pre></td></tr></table></figure>\n<h3 id=\"Install-pip\"><a href=\"#Install-pip\" class=\"headerlink\" title=\"Install pip\"></a>Install pip</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl https://raw.githubusercontent.com/pypa/pip/master/contrib/get-pip.py | python2.7 -</div></pre></td></tr></table></figure>\n<h3 id=\"And-finally-virtualenv\"><a href=\"#And-finally-virtualenv\" class=\"headerlink\" title=\"And finally virtualenv\"></a>And finally virtualenv</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pip2.7 install virtualenv</div></pre></td></tr></table></figure>\n<p>And that’s all, we have Python 2.7.8 installed on CentOS.</p>\n"},{"title":"HowTo Install Python3 on CentOS 6.x","id":"110","updated":"2017-04-21T05:20:29.000Z","date":"2016-12-08T12:12:37.000Z","_content":"\n接触过Python2.x与Python3.x的应该知道，它们二者的区别也是蛮大的，而随着Python3.x的盛行，越来越多的应用运行与Python3.x的环境之上，但是我们的CentOS的系列，目前都默认安装时Python2.x（CentOS 7.x也是），所以不得不我们需要自己行动手安装Python 3.x的环境。\n\nMirosoft平台与Mac平台，不在考虑范围，他们都有相应的软件包与图形化安装工具，可以很好的解决这个问题，所以今天我们的环境是在CentOS 6.x系列上进行。\n\n> Demo ：CentOS 6.8\n\n#### Method 1. Build & Install From Source-File\n\n1. Python3.x 源码文件下载，请选择适合的版本。 [下载页面](https://www.python.org/ftp/python/)\n2. 我这里使用版本 Python 3.5\n```\n[cent@demo ~]$ wget https://www.python.org/ftp/python/3.5.0/Python-3.5.0.tgz\n```\n3. 安装系统基本工具：\n```\n# yum-utils\n[cent@demo ~]$ sudo yum install -y yum-utils\n\n# 构建python 编译环境\n[cent@demo ~]$ sudo yum-builddep python\n```\n4. 开始编译 & 安装\n并且源码安装的同时，会将pip3与setuptools一同安装.\n```\n[cent@demo ~]$ tar xf Python-3.5.0.tgz\n[cent@demo ~]$ cd Python-3.5.0\n[cent@demo ~]$ ./configure\n[cent@demo ~]$ make\n[cent@demo ~]$ sudo make install\n```\n5. 检查版本\n```\n[cent@demo ~]$ python3 -V\nPython 3.5.0\n\n# 如果希望系统默认为Python3\n[cent@demo ~]$ alias python='usr/bin/python3.5'\n```\n\n#### Method 2. Install From EPEL repos\n也许有的同学会说，编译安装，那是上古时期的做法了，yum在线安装才是王道，当然这种说法也有可取之处，所以接下来讲下如何使用yum安装，需要注意的是yum安装是需要时间测试和增加到相应的源仓库，一般会稍慢于源码安装的方式，这里采用EPEL源，这是一个非常棒的第三方源仓库，之前的文章中也多次提到，这里就不做过多描述，请看下面的命令：\n```\n[cent@demo ~]$ sudo yum install -y epel-release\n[cent@demo ~]$ sudo yum install -y python34\n\n# 因为yum安装时没能同时安装pip与setuptools，所以我们要手动安装，这里采用拿第三方包解决问题\n\n[cent@demo ~]$ curl -O https://bootstrap.pypa.io/get-pip.py\n[cent@demo ~]$ sudo python3 get-pip.py\n\n[cent@demo ~]$  python3 -V\nPython 3.4.3\n```\n","source":"_posts/HowTo-Install-Python3-on-CentOS-6-x.md","raw":"---\ntitle: HowTo Install Python3 on CentOS 6.x\ntags: 'Python3'\ncategories: 'Python'\npermalink: installing-python3-on-centos-6\nid: 110\nupdated: '2017-04-21 13:20:29'\ndate: 2016-12-08 20:12:37\n---\n\n接触过Python2.x与Python3.x的应该知道，它们二者的区别也是蛮大的，而随着Python3.x的盛行，越来越多的应用运行与Python3.x的环境之上，但是我们的CentOS的系列，目前都默认安装时Python2.x（CentOS 7.x也是），所以不得不我们需要自己行动手安装Python 3.x的环境。\n\nMirosoft平台与Mac平台，不在考虑范围，他们都有相应的软件包与图形化安装工具，可以很好的解决这个问题，所以今天我们的环境是在CentOS 6.x系列上进行。\n\n> Demo ：CentOS 6.8\n\n#### Method 1. Build & Install From Source-File\n\n1. Python3.x 源码文件下载，请选择适合的版本。 [下载页面](https://www.python.org/ftp/python/)\n2. 我这里使用版本 Python 3.5\n```\n[cent@demo ~]$ wget https://www.python.org/ftp/python/3.5.0/Python-3.5.0.tgz\n```\n3. 安装系统基本工具：\n```\n# yum-utils\n[cent@demo ~]$ sudo yum install -y yum-utils\n\n# 构建python 编译环境\n[cent@demo ~]$ sudo yum-builddep python\n```\n4. 开始编译 & 安装\n并且源码安装的同时，会将pip3与setuptools一同安装.\n```\n[cent@demo ~]$ tar xf Python-3.5.0.tgz\n[cent@demo ~]$ cd Python-3.5.0\n[cent@demo ~]$ ./configure\n[cent@demo ~]$ make\n[cent@demo ~]$ sudo make install\n```\n5. 检查版本\n```\n[cent@demo ~]$ python3 -V\nPython 3.5.0\n\n# 如果希望系统默认为Python3\n[cent@demo ~]$ alias python='usr/bin/python3.5'\n```\n\n#### Method 2. Install From EPEL repos\n也许有的同学会说，编译安装，那是上古时期的做法了，yum在线安装才是王道，当然这种说法也有可取之处，所以接下来讲下如何使用yum安装，需要注意的是yum安装是需要时间测试和增加到相应的源仓库，一般会稍慢于源码安装的方式，这里采用EPEL源，这是一个非常棒的第三方源仓库，之前的文章中也多次提到，这里就不做过多描述，请看下面的命令：\n```\n[cent@demo ~]$ sudo yum install -y epel-release\n[cent@demo ~]$ sudo yum install -y python34\n\n# 因为yum安装时没能同时安装pip与setuptools，所以我们要手动安装，这里采用拿第三方包解决问题\n\n[cent@demo ~]$ curl -O https://bootstrap.pypa.io/get-pip.py\n[cent@demo ~]$ sudo python3 get-pip.py\n\n[cent@demo ~]$  python3 -V\nPython 3.4.3\n```\n","slug":"installing-python3-on-centos-6","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq84002d41tp7ulnkkav","content":"<p>接触过Python2.x与Python3.x的应该知道，它们二者的区别也是蛮大的，而随着Python3.x的盛行，越来越多的应用运行与Python3.x的环境之上，但是我们的CentOS的系列，目前都默认安装时Python2.x（CentOS 7.x也是），所以不得不我们需要自己行动手安装Python 3.x的环境。</p>\n<p>Mirosoft平台与Mac平台，不在考虑范围，他们都有相应的软件包与图形化安装工具，可以很好的解决这个问题，所以今天我们的环境是在CentOS 6.x系列上进行。</p>\n<blockquote>\n<p>Demo ：CentOS 6.8</p>\n</blockquote>\n<h4 id=\"Method-1-Build-amp-Install-From-Source-File\"><a href=\"#Method-1-Build-amp-Install-From-Source-File\" class=\"headerlink\" title=\"Method 1. Build &amp; Install From Source-File\"></a>Method 1. Build &amp; Install From Source-File</h4><ol>\n<li>Python3.x 源码文件下载，请选择适合的版本。 <a href=\"https://www.python.org/ftp/python/\" target=\"_blank\" rel=\"external\">下载页面</a></li>\n<li><p>我这里使用版本 Python 3.5</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@demo ~]$ wget https://www.python.org/ftp/python/3.5.0/Python-3.5.0.tgz</div></pre></td></tr></table></figure>\n</li>\n<li><p>安装系统基本工具：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># yum-utils</div><div class=\"line\">[cent@demo ~]$ sudo yum install -y yum-utils</div><div class=\"line\"></div><div class=\"line\"># 构建python 编译环境</div><div class=\"line\">[cent@demo ~]$ sudo yum-builddep python</div></pre></td></tr></table></figure>\n</li>\n<li><p>开始编译 &amp; 安装<br>并且源码安装的同时，会将pip3与setuptools一同安装.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@demo ~]$ tar xf Python-3.5.0.tgz</div><div class=\"line\">[cent@demo ~]$ cd Python-3.5.0</div><div class=\"line\">[cent@demo ~]$ ./configure</div><div class=\"line\">[cent@demo ~]$ make</div><div class=\"line\">[cent@demo ~]$ sudo make install</div></pre></td></tr></table></figure>\n</li>\n<li><p>检查版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@demo ~]$ python3 -V</div><div class=\"line\">Python 3.5.0</div><div class=\"line\"></div><div class=\"line\"># 如果希望系统默认为Python3</div><div class=\"line\">[cent@demo ~]$ alias python=&apos;usr/bin/python3.5&apos;</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h4 id=\"Method-2-Install-From-EPEL-repos\"><a href=\"#Method-2-Install-From-EPEL-repos\" class=\"headerlink\" title=\"Method 2. Install From EPEL repos\"></a>Method 2. Install From EPEL repos</h4><p>也许有的同学会说，编译安装，那是上古时期的做法了，yum在线安装才是王道，当然这种说法也有可取之处，所以接下来讲下如何使用yum安装，需要注意的是yum安装是需要时间测试和增加到相应的源仓库，一般会稍慢于源码安装的方式，这里采用EPEL源，这是一个非常棒的第三方源仓库，之前的文章中也多次提到，这里就不做过多描述，请看下面的命令：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@demo ~]$ sudo yum install -y epel-release</div><div class=\"line\">[cent@demo ~]$ sudo yum install -y python34</div><div class=\"line\"></div><div class=\"line\"># 因为yum安装时没能同时安装pip与setuptools，所以我们要手动安装，这里采用拿第三方包解决问题</div><div class=\"line\"></div><div class=\"line\">[cent@demo ~]$ curl -O https://bootstrap.pypa.io/get-pip.py</div><div class=\"line\">[cent@demo ~]$ sudo python3 get-pip.py</div><div class=\"line\"></div><div class=\"line\">[cent@demo ~]$  python3 -V</div><div class=\"line\">Python 3.4.3</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>接触过Python2.x与Python3.x的应该知道，它们二者的区别也是蛮大的，而随着Python3.x的盛行，越来越多的应用运行与Python3.x的环境之上，但是我们的CentOS的系列，目前都默认安装时Python2.x（CentOS 7.x也是），所以不得不我们需要自己行动手安装Python 3.x的环境。</p>\n<p>Mirosoft平台与Mac平台，不在考虑范围，他们都有相应的软件包与图形化安装工具，可以很好的解决这个问题，所以今天我们的环境是在CentOS 6.x系列上进行。</p>\n<blockquote>\n<p>Demo ：CentOS 6.8</p>\n</blockquote>\n<h4 id=\"Method-1-Build-amp-Install-From-Source-File\"><a href=\"#Method-1-Build-amp-Install-From-Source-File\" class=\"headerlink\" title=\"Method 1. Build &amp; Install From Source-File\"></a>Method 1. Build &amp; Install From Source-File</h4><ol>\n<li>Python3.x 源码文件下载，请选择适合的版本。 <a href=\"https://www.python.org/ftp/python/\">下载页面</a></li>\n<li><p>我这里使用版本 Python 3.5</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@demo ~]$ wget https://www.python.org/ftp/python/3.5.0/Python-3.5.0.tgz</div></pre></td></tr></table></figure>\n</li>\n<li><p>安装系统基本工具：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># yum-utils</div><div class=\"line\">[cent@demo ~]$ sudo yum install -y yum-utils</div><div class=\"line\"></div><div class=\"line\"># 构建python 编译环境</div><div class=\"line\">[cent@demo ~]$ sudo yum-builddep python</div></pre></td></tr></table></figure>\n</li>\n<li><p>开始编译 &amp; 安装<br>并且源码安装的同时，会将pip3与setuptools一同安装.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@demo ~]$ tar xf Python-3.5.0.tgz</div><div class=\"line\">[cent@demo ~]$ cd Python-3.5.0</div><div class=\"line\">[cent@demo ~]$ ./configure</div><div class=\"line\">[cent@demo ~]$ make</div><div class=\"line\">[cent@demo ~]$ sudo make install</div></pre></td></tr></table></figure>\n</li>\n<li><p>检查版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@demo ~]$ python3 -V</div><div class=\"line\">Python 3.5.0</div><div class=\"line\"></div><div class=\"line\"># 如果希望系统默认为Python3</div><div class=\"line\">[cent@demo ~]$ alias python=&apos;usr/bin/python3.5&apos;</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h4 id=\"Method-2-Install-From-EPEL-repos\"><a href=\"#Method-2-Install-From-EPEL-repos\" class=\"headerlink\" title=\"Method 2. Install From EPEL repos\"></a>Method 2. Install From EPEL repos</h4><p>也许有的同学会说，编译安装，那是上古时期的做法了，yum在线安装才是王道，当然这种说法也有可取之处，所以接下来讲下如何使用yum安装，需要注意的是yum安装是需要时间测试和增加到相应的源仓库，一般会稍慢于源码安装的方式，这里采用EPEL源，这是一个非常棒的第三方源仓库，之前的文章中也多次提到，这里就不做过多描述，请看下面的命令：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@demo ~]$ sudo yum install -y epel-release</div><div class=\"line\">[cent@demo ~]$ sudo yum install -y python34</div><div class=\"line\"></div><div class=\"line\"># 因为yum安装时没能同时安装pip与setuptools，所以我们要手动安装，这里采用拿第三方包解决问题</div><div class=\"line\"></div><div class=\"line\">[cent@demo ~]$ curl -O https://bootstrap.pypa.io/get-pip.py</div><div class=\"line\">[cent@demo ~]$ sudo python3 get-pip.py</div><div class=\"line\"></div><div class=\"line\">[cent@demo ~]$  python3 -V</div><div class=\"line\">Python 3.4.3</div></pre></td></tr></table></figure></p>\n"},{"title":"HowTo Install Redmine","id":"139","updated":"2017-04-21T05:15:43.000Z","date":"2017-02-22T04:30:36.000Z","_content":"\n#### Runtime environment\n\n* CentOS 6.x\n* Redmine 3.3.2\n* Ruby 2.2.6\n* rails 4.2\n* MySQL 5.1\n* Nginx 1.10\n\n#### 1. 安装rvm\n\n##### 1.1 导入公钥\n\n```\n[root@localhost ~]# curl -sSL https://rvm.io/mpapis.asc | gpg --import\n```\n\n##### 1.2 安装\n\n```\n[root@localhost ~]# curl -L https://get.rvm.io | bash -s stable\n```\n\n##### 1.3 加载rvm环境并安装基础依赖包\n\n```\n[root@localhost ~]# source /etc/profile.d/rvm.sh\n[root@localhost ~]# rvm requirements\n```\n\n#### 2. 安装ruby\n\n```\n[root@localhost ~]# rvm install 2.2.6\n...\n[root@localhost ~]# rvm use 2.2.6 --default\n```\n\n#### 3. 安装rails\n\n##### 3.1 更换gem源\n\n默认gem的源站点是https://rubygems.org 由于国内的网络原因导致无法连接，所以导致无法使用gem安装，这里换成国内淘宝的gem镜像站点\n\n```\n[root@localhost ~]# gem sources -l\n*** CURRENT SOURCES ***\n\nhttps://rubygems.org/\n[root@localhost ~]# gem sources --remove https://rubygems.org/\n[root@localhost ~]# gem sources -a https://ruby.taobao.org/\n[root@localhost ~]# gem sources -l\n*** CURRENT SOURCES ***\n\nhttps://ruby.taobao.org/\n```\n\n##### 3.2 安装\n\n```\n[root@localhost ~]# gem install rails -v=4.2\n```\n\n#### 4. 安装MySQL\n\n```\n[root@localhost ~]# yum install -y mysql-server mysql-libs mysql-devel mysql\n[root@localhost ~]# service mysqld start\n[root@localhost ~]# mysql_secure_installation\n```\n\n#### 5. 安装redmine\n\n##### 5.1 下载Redmine 3.3.2\n\n```\n[root@localhost ~]# wget http://www.redmine.org/releases/redmine-3.3.2.tar.gz\n[root@localhost ~]# tar xf redmine-3.3.2.tar.gz\n[root@localhost ~]# mv redmine-3.3.2 /opt\n```\n\n##### 5.2 安装管理ruby的包管理工具bundler\n\n```\n# 注意，一定要在redmine目录下操作\n[root@localhost ~]# cd /opt/redmine-3.3.2\n[root@localhost redmine-3.3.2]# gem install bundler\n```\n\n##### 5.3 安装redmine运行所需要的依赖包\n\n```\n[root@localhost redmine-3.3.2]# bundle install --without development test rmagick\n```\n\n##### 5.4 为rails生产cookies秘钥\n\n```\n[root@localhost redmine-3.3.2]# rake generate_secret_token\n```\n\n##### 5.5 创建redmine的数据库\n\n```\nmysql> create database redmine character set utf8;\nmysql> grant all privileges on redmine.* to 'redmine'@'localhost' identified by 'redmine_pass';\n```\n\n##### 5.6 修改redmine的database.yml\n\n```\n[root@localhost redmine-3.3.2]# cp config/database.yml.example config/database.yml\n[root@localhost redmine-3.3.2]# vim config/database.yml\nproduction:\n  adapter: mysql2\n  database: redmine\n  host: localhost\n  username: redmine\n  password: \"redmine_pass\"\n  encoding: utf8\n```\n\n##### 5.7 创建数据库结构\n\n```\n[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake db:migrate\n```\n\n##### 5.8 生产缺省数据\n\n```\n[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake redmine:load_default_data\n# 选择默认语言，之后可更改，初始为en\n```\n\n##### 5.9 测试是否安装成功\n\n```\n[root@localhost redmine-3.3.2]# bundle exec rails server webrick -e production -b 0.0.0.0\n```\n\n> 默认运行3000端口，默认管理员admin/admin\n\n\n\n#### 6. 配置Redmine在Nginx上运行\n\nRedmine常用的解决办法是使用passenger+nginx，但是Nginx不支持装载模块，所以需要重新编译安装Nginx，安装Nginx的Passenger有两种方式\n\n* 采用Passenger提供的脚本进行安装，适合新环境\n* 手动编译安装Nginx增加Passenger模块，适合已存在Nginx环境\n\n##### 6.1 采用Passenger提供脚本安装\n\n```\n[root@localhost redmine-3.3.2]# gem install passenger\n[root@localhost redmine-3.3.2]# passenger-install-nginx-module --auto --prefix=/opt/nginx\n```\n\n##### 6.2 采用重新编译Nginx增加Passenger模块\n\n```\n# 获取passenger的安装路径\n[root@localhost ~]# passenger-config --root\n/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2\n\n# 重新编译Nginx并添加模块\n[root@localhost ~]# wget http://nginx.org/download/nginx-1.10.3.tar.gz\n[root@localhost ~]# tar xf nginx-1.10.3.tar.gz\n[root@localhost ~]# cd nginx-1.10.3\n[root@localhost nginx-1.10.3]# ./configure ... -add-module=/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2\n```\n\n##### 6.3 增加HTTP模块内以下配置\n\n```\npassenger_root /usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2\n```\n\n##### 6.4 配置nginx.conf 修改server模块中location的配置\n\n```\n# ...\nserver\t{\n  # ...\n  passenger_enabled on;\n  location / {\n    root /opt/redmine-3.3.2/public;\n    index index.html index.htm;\n  }\n}\n# ...\n```\n\n##### 6.5 启动Nginx\n\n```\n[root@localhost ~]# /root/nginx-1.10.3/sbin/nginx -c /root/nginx-1.10.3/conf/nginx.conf\n```\n\n#### 7. 其他\n\n到这里，所有的安装都完成了，过程中我遇到这些问题，你也注意下：\n\n##### 7.1 Could not find gem 'mysql2 (~> 0.3.11)' in any of the gem sources listed in your Gemfile.\n\n```\n[root@localhost redmine-3.3.2]# rm -f Gemfile.lock\n[root@localhost redmine-3.3.2]# bundle install\n```\n\n\n\n\n\n##### 7.2 curl-tools\n\n```\nyum install libcurl-devel\n```\n\n\n\n","source":"_posts/HowTo-Install-Redmine.md","raw":"---\ntitle: HowTo Install Redmine\ntags: 'Redmine'\ncategories: 'CentOS'\npermalink: howto-install-redmine\nid: 139\nupdated: '2017-04-21 13:15:43'\ndate: 2017-02-22 12:30:36\n---\n\n#### Runtime environment\n\n* CentOS 6.x\n* Redmine 3.3.2\n* Ruby 2.2.6\n* rails 4.2\n* MySQL 5.1\n* Nginx 1.10\n\n#### 1. 安装rvm\n\n##### 1.1 导入公钥\n\n```\n[root@localhost ~]# curl -sSL https://rvm.io/mpapis.asc | gpg --import\n```\n\n##### 1.2 安装\n\n```\n[root@localhost ~]# curl -L https://get.rvm.io | bash -s stable\n```\n\n##### 1.3 加载rvm环境并安装基础依赖包\n\n```\n[root@localhost ~]# source /etc/profile.d/rvm.sh\n[root@localhost ~]# rvm requirements\n```\n\n#### 2. 安装ruby\n\n```\n[root@localhost ~]# rvm install 2.2.6\n...\n[root@localhost ~]# rvm use 2.2.6 --default\n```\n\n#### 3. 安装rails\n\n##### 3.1 更换gem源\n\n默认gem的源站点是https://rubygems.org 由于国内的网络原因导致无法连接，所以导致无法使用gem安装，这里换成国内淘宝的gem镜像站点\n\n```\n[root@localhost ~]# gem sources -l\n*** CURRENT SOURCES ***\n\nhttps://rubygems.org/\n[root@localhost ~]# gem sources --remove https://rubygems.org/\n[root@localhost ~]# gem sources -a https://ruby.taobao.org/\n[root@localhost ~]# gem sources -l\n*** CURRENT SOURCES ***\n\nhttps://ruby.taobao.org/\n```\n\n##### 3.2 安装\n\n```\n[root@localhost ~]# gem install rails -v=4.2\n```\n\n#### 4. 安装MySQL\n\n```\n[root@localhost ~]# yum install -y mysql-server mysql-libs mysql-devel mysql\n[root@localhost ~]# service mysqld start\n[root@localhost ~]# mysql_secure_installation\n```\n\n#### 5. 安装redmine\n\n##### 5.1 下载Redmine 3.3.2\n\n```\n[root@localhost ~]# wget http://www.redmine.org/releases/redmine-3.3.2.tar.gz\n[root@localhost ~]# tar xf redmine-3.3.2.tar.gz\n[root@localhost ~]# mv redmine-3.3.2 /opt\n```\n\n##### 5.2 安装管理ruby的包管理工具bundler\n\n```\n# 注意，一定要在redmine目录下操作\n[root@localhost ~]# cd /opt/redmine-3.3.2\n[root@localhost redmine-3.3.2]# gem install bundler\n```\n\n##### 5.3 安装redmine运行所需要的依赖包\n\n```\n[root@localhost redmine-3.3.2]# bundle install --without development test rmagick\n```\n\n##### 5.4 为rails生产cookies秘钥\n\n```\n[root@localhost redmine-3.3.2]# rake generate_secret_token\n```\n\n##### 5.5 创建redmine的数据库\n\n```\nmysql> create database redmine character set utf8;\nmysql> grant all privileges on redmine.* to 'redmine'@'localhost' identified by 'redmine_pass';\n```\n\n##### 5.6 修改redmine的database.yml\n\n```\n[root@localhost redmine-3.3.2]# cp config/database.yml.example config/database.yml\n[root@localhost redmine-3.3.2]# vim config/database.yml\nproduction:\n  adapter: mysql2\n  database: redmine\n  host: localhost\n  username: redmine\n  password: \"redmine_pass\"\n  encoding: utf8\n```\n\n##### 5.7 创建数据库结构\n\n```\n[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake db:migrate\n```\n\n##### 5.8 生产缺省数据\n\n```\n[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake redmine:load_default_data\n# 选择默认语言，之后可更改，初始为en\n```\n\n##### 5.9 测试是否安装成功\n\n```\n[root@localhost redmine-3.3.2]# bundle exec rails server webrick -e production -b 0.0.0.0\n```\n\n> 默认运行3000端口，默认管理员admin/admin\n\n\n\n#### 6. 配置Redmine在Nginx上运行\n\nRedmine常用的解决办法是使用passenger+nginx，但是Nginx不支持装载模块，所以需要重新编译安装Nginx，安装Nginx的Passenger有两种方式\n\n* 采用Passenger提供的脚本进行安装，适合新环境\n* 手动编译安装Nginx增加Passenger模块，适合已存在Nginx环境\n\n##### 6.1 采用Passenger提供脚本安装\n\n```\n[root@localhost redmine-3.3.2]# gem install passenger\n[root@localhost redmine-3.3.2]# passenger-install-nginx-module --auto --prefix=/opt/nginx\n```\n\n##### 6.2 采用重新编译Nginx增加Passenger模块\n\n```\n# 获取passenger的安装路径\n[root@localhost ~]# passenger-config --root\n/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2\n\n# 重新编译Nginx并添加模块\n[root@localhost ~]# wget http://nginx.org/download/nginx-1.10.3.tar.gz\n[root@localhost ~]# tar xf nginx-1.10.3.tar.gz\n[root@localhost ~]# cd nginx-1.10.3\n[root@localhost nginx-1.10.3]# ./configure ... -add-module=/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2\n```\n\n##### 6.3 增加HTTP模块内以下配置\n\n```\npassenger_root /usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2\n```\n\n##### 6.4 配置nginx.conf 修改server模块中location的配置\n\n```\n# ...\nserver\t{\n  # ...\n  passenger_enabled on;\n  location / {\n    root /opt/redmine-3.3.2/public;\n    index index.html index.htm;\n  }\n}\n# ...\n```\n\n##### 6.5 启动Nginx\n\n```\n[root@localhost ~]# /root/nginx-1.10.3/sbin/nginx -c /root/nginx-1.10.3/conf/nginx.conf\n```\n\n#### 7. 其他\n\n到这里，所有的安装都完成了，过程中我遇到这些问题，你也注意下：\n\n##### 7.1 Could not find gem 'mysql2 (~> 0.3.11)' in any of the gem sources listed in your Gemfile.\n\n```\n[root@localhost redmine-3.3.2]# rm -f Gemfile.lock\n[root@localhost redmine-3.3.2]# bundle install\n```\n\n\n\n\n\n##### 7.2 curl-tools\n\n```\nyum install libcurl-devel\n```\n\n\n\n","slug":"howto-install-redmine","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq86002h41tp67t1zrv4","content":"<h4 id=\"Runtime-environment\"><a href=\"#Runtime-environment\" class=\"headerlink\" title=\"Runtime environment\"></a>Runtime environment</h4><ul>\n<li>CentOS 6.x</li>\n<li>Redmine 3.3.2</li>\n<li>Ruby 2.2.6</li>\n<li>rails 4.2</li>\n<li>MySQL 5.1</li>\n<li>Nginx 1.10</li>\n</ul>\n<h4 id=\"1-安装rvm\"><a href=\"#1-安装rvm\" class=\"headerlink\" title=\"1. 安装rvm\"></a>1. 安装rvm</h4><h5 id=\"1-1-导入公钥\"><a href=\"#1-1-导入公钥\" class=\"headerlink\" title=\"1.1 导入公钥\"></a>1.1 导入公钥</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# curl -sSL https://rvm.io/mpapis.asc | gpg --import</div></pre></td></tr></table></figure>\n<h5 id=\"1-2-安装\"><a href=\"#1-2-安装\" class=\"headerlink\" title=\"1.2 安装\"></a>1.2 安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# curl -L https://get.rvm.io | bash -s stable</div></pre></td></tr></table></figure>\n<h5 id=\"1-3-加载rvm环境并安装基础依赖包\"><a href=\"#1-3-加载rvm环境并安装基础依赖包\" class=\"headerlink\" title=\"1.3 加载rvm环境并安装基础依赖包\"></a>1.3 加载rvm环境并安装基础依赖包</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# source /etc/profile.d/rvm.sh</div><div class=\"line\">[root@localhost ~]# rvm requirements</div></pre></td></tr></table></figure>\n<h4 id=\"2-安装ruby\"><a href=\"#2-安装ruby\" class=\"headerlink\" title=\"2. 安装ruby\"></a>2. 安装ruby</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# rvm install 2.2.6</div><div class=\"line\">...</div><div class=\"line\">[root@localhost ~]# rvm use 2.2.6 --default</div></pre></td></tr></table></figure>\n<h4 id=\"3-安装rails\"><a href=\"#3-安装rails\" class=\"headerlink\" title=\"3. 安装rails\"></a>3. 安装rails</h4><h5 id=\"3-1-更换gem源\"><a href=\"#3-1-更换gem源\" class=\"headerlink\" title=\"3.1 更换gem源\"></a>3.1 更换gem源</h5><p>默认gem的源站点是<a href=\"https://rubygems.org\" target=\"_blank\" rel=\"external\">https://rubygems.org</a> 由于国内的网络原因导致无法连接，所以导致无法使用gem安装，这里换成国内淘宝的gem镜像站点</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# gem sources -l</div><div class=\"line\">*** CURRENT SOURCES ***</div><div class=\"line\"></div><div class=\"line\">https://rubygems.org/</div><div class=\"line\">[root@localhost ~]# gem sources --remove https://rubygems.org/</div><div class=\"line\">[root@localhost ~]# gem sources -a https://ruby.taobao.org/</div><div class=\"line\">[root@localhost ~]# gem sources -l</div><div class=\"line\">*** CURRENT SOURCES ***</div><div class=\"line\"></div><div class=\"line\">https://ruby.taobao.org/</div></pre></td></tr></table></figure>\n<h5 id=\"3-2-安装\"><a href=\"#3-2-安装\" class=\"headerlink\" title=\"3.2 安装\"></a>3.2 安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# gem install rails -v=4.2</div></pre></td></tr></table></figure>\n<h4 id=\"4-安装MySQL\"><a href=\"#4-安装MySQL\" class=\"headerlink\" title=\"4. 安装MySQL\"></a>4. 安装MySQL</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# yum install -y mysql-server mysql-libs mysql-devel mysql</div><div class=\"line\">[root@localhost ~]# service mysqld start</div><div class=\"line\">[root@localhost ~]# mysql_secure_installation</div></pre></td></tr></table></figure>\n<h4 id=\"5-安装redmine\"><a href=\"#5-安装redmine\" class=\"headerlink\" title=\"5. 安装redmine\"></a>5. 安装redmine</h4><h5 id=\"5-1-下载Redmine-3-3-2\"><a href=\"#5-1-下载Redmine-3-3-2\" class=\"headerlink\" title=\"5.1 下载Redmine 3.3.2\"></a>5.1 下载Redmine 3.3.2</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# wget http://www.redmine.org/releases/redmine-3.3.2.tar.gz</div><div class=\"line\">[root@localhost ~]# tar xf redmine-3.3.2.tar.gz</div><div class=\"line\">[root@localhost ~]# mv redmine-3.3.2 /opt</div></pre></td></tr></table></figure>\n<h5 id=\"5-2-安装管理ruby的包管理工具bundler\"><a href=\"#5-2-安装管理ruby的包管理工具bundler\" class=\"headerlink\" title=\"5.2 安装管理ruby的包管理工具bundler\"></a>5.2 安装管理ruby的包管理工具bundler</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 注意，一定要在redmine目录下操作</div><div class=\"line\">[root@localhost ~]# cd /opt/redmine-3.3.2</div><div class=\"line\">[root@localhost redmine-3.3.2]# gem install bundler</div></pre></td></tr></table></figure>\n<h5 id=\"5-3-安装redmine运行所需要的依赖包\"><a href=\"#5-3-安装redmine运行所需要的依赖包\" class=\"headerlink\" title=\"5.3 安装redmine运行所需要的依赖包\"></a>5.3 安装redmine运行所需要的依赖包</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# bundle install --without development test rmagick</div></pre></td></tr></table></figure>\n<h5 id=\"5-4-为rails生产cookies秘钥\"><a href=\"#5-4-为rails生产cookies秘钥\" class=\"headerlink\" title=\"5.4 为rails生产cookies秘钥\"></a>5.4 为rails生产cookies秘钥</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# rake generate_secret_token</div></pre></td></tr></table></figure>\n<h5 id=\"5-5-创建redmine的数据库\"><a href=\"#5-5-创建redmine的数据库\" class=\"headerlink\" title=\"5.5 创建redmine的数据库\"></a>5.5 创建redmine的数据库</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; create database redmine character set utf8;</div><div class=\"line\">mysql&gt; grant all privileges on redmine.* to &apos;redmine&apos;@&apos;localhost&apos; identified by &apos;redmine_pass&apos;;</div></pre></td></tr></table></figure>\n<h5 id=\"5-6-修改redmine的database-yml\"><a href=\"#5-6-修改redmine的database-yml\" class=\"headerlink\" title=\"5.6 修改redmine的database.yml\"></a>5.6 修改redmine的database.yml</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# cp config/database.yml.example config/database.yml</div><div class=\"line\">[root@localhost redmine-3.3.2]# vim config/database.yml</div><div class=\"line\">production:</div><div class=\"line\">  adapter: mysql2</div><div class=\"line\">  database: redmine</div><div class=\"line\">  host: localhost</div><div class=\"line\">  username: redmine</div><div class=\"line\">  password: &quot;redmine_pass&quot;</div><div class=\"line\">  encoding: utf8</div></pre></td></tr></table></figure>\n<h5 id=\"5-7-创建数据库结构\"><a href=\"#5-7-创建数据库结构\" class=\"headerlink\" title=\"5.7 创建数据库结构\"></a>5.7 创建数据库结构</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake db:migrate</div></pre></td></tr></table></figure>\n<h5 id=\"5-8-生产缺省数据\"><a href=\"#5-8-生产缺省数据\" class=\"headerlink\" title=\"5.8 生产缺省数据\"></a>5.8 生产缺省数据</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake redmine:load_default_data</div><div class=\"line\"># 选择默认语言，之后可更改，初始为en</div></pre></td></tr></table></figure>\n<h5 id=\"5-9-测试是否安装成功\"><a href=\"#5-9-测试是否安装成功\" class=\"headerlink\" title=\"5.9 测试是否安装成功\"></a>5.9 测试是否安装成功</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# bundle exec rails server webrick -e production -b 0.0.0.0</div></pre></td></tr></table></figure>\n<blockquote>\n<p>默认运行3000端口，默认管理员admin/admin</p>\n</blockquote>\n<h4 id=\"6-配置Redmine在Nginx上运行\"><a href=\"#6-配置Redmine在Nginx上运行\" class=\"headerlink\" title=\"6. 配置Redmine在Nginx上运行\"></a>6. 配置Redmine在Nginx上运行</h4><p>Redmine常用的解决办法是使用passenger+nginx，但是Nginx不支持装载模块，所以需要重新编译安装Nginx，安装Nginx的Passenger有两种方式</p>\n<ul>\n<li>采用Passenger提供的脚本进行安装，适合新环境</li>\n<li>手动编译安装Nginx增加Passenger模块，适合已存在Nginx环境</li>\n</ul>\n<h5 id=\"6-1-采用Passenger提供脚本安装\"><a href=\"#6-1-采用Passenger提供脚本安装\" class=\"headerlink\" title=\"6.1 采用Passenger提供脚本安装\"></a>6.1 采用Passenger提供脚本安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# gem install passenger</div><div class=\"line\">[root@localhost redmine-3.3.2]# passenger-install-nginx-module --auto --prefix=/opt/nginx</div></pre></td></tr></table></figure>\n<h5 id=\"6-2-采用重新编译Nginx增加Passenger模块\"><a href=\"#6-2-采用重新编译Nginx增加Passenger模块\" class=\"headerlink\" title=\"6.2 采用重新编译Nginx增加Passenger模块\"></a>6.2 采用重新编译Nginx增加Passenger模块</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 获取passenger的安装路径</div><div class=\"line\">[root@localhost ~]# passenger-config --root</div><div class=\"line\">/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2</div><div class=\"line\"></div><div class=\"line\"># 重新编译Nginx并添加模块</div><div class=\"line\">[root@localhost ~]# wget http://nginx.org/download/nginx-1.10.3.tar.gz</div><div class=\"line\">[root@localhost ~]# tar xf nginx-1.10.3.tar.gz</div><div class=\"line\">[root@localhost ~]# cd nginx-1.10.3</div><div class=\"line\">[root@localhost nginx-1.10.3]# ./configure ... -add-module=/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2</div></pre></td></tr></table></figure>\n<h5 id=\"6-3-增加HTTP模块内以下配置\"><a href=\"#6-3-增加HTTP模块内以下配置\" class=\"headerlink\" title=\"6.3 增加HTTP模块内以下配置\"></a>6.3 增加HTTP模块内以下配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">passenger_root /usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2</div></pre></td></tr></table></figure>\n<h5 id=\"6-4-配置nginx-conf-修改server模块中location的配置\"><a href=\"#6-4-配置nginx-conf-修改server模块中location的配置\" class=\"headerlink\" title=\"6.4 配置nginx.conf 修改server模块中location的配置\"></a>6.4 配置nginx.conf 修改server模块中location的配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ...</div><div class=\"line\">server\t&#123;</div><div class=\"line\">  # ...</div><div class=\"line\">  passenger_enabled on;</div><div class=\"line\">  location / &#123;</div><div class=\"line\">    root /opt/redmine-3.3.2/public;</div><div class=\"line\">    index index.html index.htm;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"># ...</div></pre></td></tr></table></figure>\n<h5 id=\"6-5-启动Nginx\"><a href=\"#6-5-启动Nginx\" class=\"headerlink\" title=\"6.5 启动Nginx\"></a>6.5 启动Nginx</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# /root/nginx-1.10.3/sbin/nginx -c /root/nginx-1.10.3/conf/nginx.conf</div></pre></td></tr></table></figure>\n<h4 id=\"7-其他\"><a href=\"#7-其他\" class=\"headerlink\" title=\"7. 其他\"></a>7. 其他</h4><p>到这里，所有的安装都完成了，过程中我遇到这些问题，你也注意下：</p>\n<h5 id=\"7-1-Could-not-find-gem-‘mysql2-gt-0-3-11-’-in-any-of-the-gem-sources-listed-in-your-Gemfile\"><a href=\"#7-1-Could-not-find-gem-‘mysql2-gt-0-3-11-’-in-any-of-the-gem-sources-listed-in-your-Gemfile\" class=\"headerlink\" title=\"7.1 Could not find gem ‘mysql2 (~&gt; 0.3.11)’ in any of the gem sources listed in your Gemfile.\"></a>7.1 Could not find gem ‘mysql2 (~&gt; 0.3.11)’ in any of the gem sources listed in your Gemfile.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# rm -f Gemfile.lock</div><div class=\"line\">[root@localhost redmine-3.3.2]# bundle install</div></pre></td></tr></table></figure>\n<h5 id=\"7-2-curl-tools\"><a href=\"#7-2-curl-tools\" class=\"headerlink\" title=\"7.2 curl-tools\"></a>7.2 curl-tools</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install libcurl-devel</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"Runtime-environment\"><a href=\"#Runtime-environment\" class=\"headerlink\" title=\"Runtime environment\"></a>Runtime environment</h4><ul>\n<li>CentOS 6.x</li>\n<li>Redmine 3.3.2</li>\n<li>Ruby 2.2.6</li>\n<li>rails 4.2</li>\n<li>MySQL 5.1</li>\n<li>Nginx 1.10</li>\n</ul>\n<h4 id=\"1-安装rvm\"><a href=\"#1-安装rvm\" class=\"headerlink\" title=\"1. 安装rvm\"></a>1. 安装rvm</h4><h5 id=\"1-1-导入公钥\"><a href=\"#1-1-导入公钥\" class=\"headerlink\" title=\"1.1 导入公钥\"></a>1.1 导入公钥</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# curl -sSL https://rvm.io/mpapis.asc | gpg --import</div></pre></td></tr></table></figure>\n<h5 id=\"1-2-安装\"><a href=\"#1-2-安装\" class=\"headerlink\" title=\"1.2 安装\"></a>1.2 安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# curl -L https://get.rvm.io | bash -s stable</div></pre></td></tr></table></figure>\n<h5 id=\"1-3-加载rvm环境并安装基础依赖包\"><a href=\"#1-3-加载rvm环境并安装基础依赖包\" class=\"headerlink\" title=\"1.3 加载rvm环境并安装基础依赖包\"></a>1.3 加载rvm环境并安装基础依赖包</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# source /etc/profile.d/rvm.sh</div><div class=\"line\">[root@localhost ~]# rvm requirements</div></pre></td></tr></table></figure>\n<h4 id=\"2-安装ruby\"><a href=\"#2-安装ruby\" class=\"headerlink\" title=\"2. 安装ruby\"></a>2. 安装ruby</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# rvm install 2.2.6</div><div class=\"line\">...</div><div class=\"line\">[root@localhost ~]# rvm use 2.2.6 --default</div></pre></td></tr></table></figure>\n<h4 id=\"3-安装rails\"><a href=\"#3-安装rails\" class=\"headerlink\" title=\"3. 安装rails\"></a>3. 安装rails</h4><h5 id=\"3-1-更换gem源\"><a href=\"#3-1-更换gem源\" class=\"headerlink\" title=\"3.1 更换gem源\"></a>3.1 更换gem源</h5><p>默认gem的源站点是<a href=\"https://rubygems.org\">https://rubygems.org</a> 由于国内的网络原因导致无法连接，所以导致无法使用gem安装，这里换成国内淘宝的gem镜像站点</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# gem sources -l</div><div class=\"line\">*** CURRENT SOURCES ***</div><div class=\"line\"></div><div class=\"line\">https://rubygems.org/</div><div class=\"line\">[root@localhost ~]# gem sources --remove https://rubygems.org/</div><div class=\"line\">[root@localhost ~]# gem sources -a https://ruby.taobao.org/</div><div class=\"line\">[root@localhost ~]# gem sources -l</div><div class=\"line\">*** CURRENT SOURCES ***</div><div class=\"line\"></div><div class=\"line\">https://ruby.taobao.org/</div></pre></td></tr></table></figure>\n<h5 id=\"3-2-安装\"><a href=\"#3-2-安装\" class=\"headerlink\" title=\"3.2 安装\"></a>3.2 安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# gem install rails -v=4.2</div></pre></td></tr></table></figure>\n<h4 id=\"4-安装MySQL\"><a href=\"#4-安装MySQL\" class=\"headerlink\" title=\"4. 安装MySQL\"></a>4. 安装MySQL</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# yum install -y mysql-server mysql-libs mysql-devel mysql</div><div class=\"line\">[root@localhost ~]# service mysqld start</div><div class=\"line\">[root@localhost ~]# mysql_secure_installation</div></pre></td></tr></table></figure>\n<h4 id=\"5-安装redmine\"><a href=\"#5-安装redmine\" class=\"headerlink\" title=\"5. 安装redmine\"></a>5. 安装redmine</h4><h5 id=\"5-1-下载Redmine-3-3-2\"><a href=\"#5-1-下载Redmine-3-3-2\" class=\"headerlink\" title=\"5.1 下载Redmine 3.3.2\"></a>5.1 下载Redmine 3.3.2</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# wget http://www.redmine.org/releases/redmine-3.3.2.tar.gz</div><div class=\"line\">[root@localhost ~]# tar xf redmine-3.3.2.tar.gz</div><div class=\"line\">[root@localhost ~]# mv redmine-3.3.2 /opt</div></pre></td></tr></table></figure>\n<h5 id=\"5-2-安装管理ruby的包管理工具bundler\"><a href=\"#5-2-安装管理ruby的包管理工具bundler\" class=\"headerlink\" title=\"5.2 安装管理ruby的包管理工具bundler\"></a>5.2 安装管理ruby的包管理工具bundler</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 注意，一定要在redmine目录下操作</div><div class=\"line\">[root@localhost ~]# cd /opt/redmine-3.3.2</div><div class=\"line\">[root@localhost redmine-3.3.2]# gem install bundler</div></pre></td></tr></table></figure>\n<h5 id=\"5-3-安装redmine运行所需要的依赖包\"><a href=\"#5-3-安装redmine运行所需要的依赖包\" class=\"headerlink\" title=\"5.3 安装redmine运行所需要的依赖包\"></a>5.3 安装redmine运行所需要的依赖包</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# bundle install --without development test rmagick</div></pre></td></tr></table></figure>\n<h5 id=\"5-4-为rails生产cookies秘钥\"><a href=\"#5-4-为rails生产cookies秘钥\" class=\"headerlink\" title=\"5.4 为rails生产cookies秘钥\"></a>5.4 为rails生产cookies秘钥</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# rake generate_secret_token</div></pre></td></tr></table></figure>\n<h5 id=\"5-5-创建redmine的数据库\"><a href=\"#5-5-创建redmine的数据库\" class=\"headerlink\" title=\"5.5 创建redmine的数据库\"></a>5.5 创建redmine的数据库</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; create database redmine character set utf8;</div><div class=\"line\">mysql&gt; grant all privileges on redmine.* to &apos;redmine&apos;@&apos;localhost&apos; identified by &apos;redmine_pass&apos;;</div></pre></td></tr></table></figure>\n<h5 id=\"5-6-修改redmine的database-yml\"><a href=\"#5-6-修改redmine的database-yml\" class=\"headerlink\" title=\"5.6 修改redmine的database.yml\"></a>5.6 修改redmine的database.yml</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# cp config/database.yml.example config/database.yml</div><div class=\"line\">[root@localhost redmine-3.3.2]# vim config/database.yml</div><div class=\"line\">production:</div><div class=\"line\">  adapter: mysql2</div><div class=\"line\">  database: redmine</div><div class=\"line\">  host: localhost</div><div class=\"line\">  username: redmine</div><div class=\"line\">  password: &quot;redmine_pass&quot;</div><div class=\"line\">  encoding: utf8</div></pre></td></tr></table></figure>\n<h5 id=\"5-7-创建数据库结构\"><a href=\"#5-7-创建数据库结构\" class=\"headerlink\" title=\"5.7 创建数据库结构\"></a>5.7 创建数据库结构</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake db:migrate</div></pre></td></tr></table></figure>\n<h5 id=\"5-8-生产缺省数据\"><a href=\"#5-8-生产缺省数据\" class=\"headerlink\" title=\"5.8 生产缺省数据\"></a>5.8 生产缺省数据</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake redmine:load_default_data</div><div class=\"line\"># 选择默认语言，之后可更改，初始为en</div></pre></td></tr></table></figure>\n<h5 id=\"5-9-测试是否安装成功\"><a href=\"#5-9-测试是否安装成功\" class=\"headerlink\" title=\"5.9 测试是否安装成功\"></a>5.9 测试是否安装成功</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# bundle exec rails server webrick -e production -b 0.0.0.0</div></pre></td></tr></table></figure>\n<blockquote>\n<p>默认运行3000端口，默认管理员admin/admin</p>\n</blockquote>\n<h4 id=\"6-配置Redmine在Nginx上运行\"><a href=\"#6-配置Redmine在Nginx上运行\" class=\"headerlink\" title=\"6. 配置Redmine在Nginx上运行\"></a>6. 配置Redmine在Nginx上运行</h4><p>Redmine常用的解决办法是使用passenger+nginx，但是Nginx不支持装载模块，所以需要重新编译安装Nginx，安装Nginx的Passenger有两种方式</p>\n<ul>\n<li>采用Passenger提供的脚本进行安装，适合新环境</li>\n<li>手动编译安装Nginx增加Passenger模块，适合已存在Nginx环境</li>\n</ul>\n<h5 id=\"6-1-采用Passenger提供脚本安装\"><a href=\"#6-1-采用Passenger提供脚本安装\" class=\"headerlink\" title=\"6.1 采用Passenger提供脚本安装\"></a>6.1 采用Passenger提供脚本安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# gem install passenger</div><div class=\"line\">[root@localhost redmine-3.3.2]# passenger-install-nginx-module --auto --prefix=/opt/nginx</div></pre></td></tr></table></figure>\n<h5 id=\"6-2-采用重新编译Nginx增加Passenger模块\"><a href=\"#6-2-采用重新编译Nginx增加Passenger模块\" class=\"headerlink\" title=\"6.2 采用重新编译Nginx增加Passenger模块\"></a>6.2 采用重新编译Nginx增加Passenger模块</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 获取passenger的安装路径</div><div class=\"line\">[root@localhost ~]# passenger-config --root</div><div class=\"line\">/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2</div><div class=\"line\"></div><div class=\"line\"># 重新编译Nginx并添加模块</div><div class=\"line\">[root@localhost ~]# wget http://nginx.org/download/nginx-1.10.3.tar.gz</div><div class=\"line\">[root@localhost ~]# tar xf nginx-1.10.3.tar.gz</div><div class=\"line\">[root@localhost ~]# cd nginx-1.10.3</div><div class=\"line\">[root@localhost nginx-1.10.3]# ./configure ... -add-module=/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2</div></pre></td></tr></table></figure>\n<h5 id=\"6-3-增加HTTP模块内以下配置\"><a href=\"#6-3-增加HTTP模块内以下配置\" class=\"headerlink\" title=\"6.3 增加HTTP模块内以下配置\"></a>6.3 增加HTTP模块内以下配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">passenger_root /usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2</div></pre></td></tr></table></figure>\n<h5 id=\"6-4-配置nginx-conf-修改server模块中location的配置\"><a href=\"#6-4-配置nginx-conf-修改server模块中location的配置\" class=\"headerlink\" title=\"6.4 配置nginx.conf 修改server模块中location的配置\"></a>6.4 配置nginx.conf 修改server模块中location的配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ...</div><div class=\"line\">server\t&#123;</div><div class=\"line\">  # ...</div><div class=\"line\">  passenger_enabled on;</div><div class=\"line\">  location / &#123;</div><div class=\"line\">    root /opt/redmine-3.3.2/public;</div><div class=\"line\">    index index.html index.htm;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"># ...</div></pre></td></tr></table></figure>\n<h5 id=\"6-5-启动Nginx\"><a href=\"#6-5-启动Nginx\" class=\"headerlink\" title=\"6.5 启动Nginx\"></a>6.5 启动Nginx</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost ~]# /root/nginx-1.10.3/sbin/nginx -c /root/nginx-1.10.3/conf/nginx.conf</div></pre></td></tr></table></figure>\n<h4 id=\"7-其他\"><a href=\"#7-其他\" class=\"headerlink\" title=\"7. 其他\"></a>7. 其他</h4><p>到这里，所有的安装都完成了，过程中我遇到这些问题，你也注意下：</p>\n<h5 id=\"7-1-Could-not-find-gem-‘mysql2-gt-0-3-11-’-in-any-of-the-gem-sources-listed-in-your-Gemfile\"><a href=\"#7-1-Could-not-find-gem-‘mysql2-gt-0-3-11-’-in-any-of-the-gem-sources-listed-in-your-Gemfile\" class=\"headerlink\" title=\"7.1 Could not find gem ‘mysql2 (~&gt; 0.3.11)’ in any of the gem sources listed in your Gemfile.\"></a>7.1 Could not find gem ‘mysql2 (~&gt; 0.3.11)’ in any of the gem sources listed in your Gemfile.</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@localhost redmine-3.3.2]# rm -f Gemfile.lock</div><div class=\"line\">[root@localhost redmine-3.3.2]# bundle install</div></pre></td></tr></table></figure>\n<h5 id=\"7-2-curl-tools\"><a href=\"#7-2-curl-tools\" class=\"headerlink\" title=\"7.2 curl-tools\"></a>7.2 curl-tools</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install libcurl-devel</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Install Zabbix 2.4 on CentOS 6.x","id":"53","updated":"2017-04-21T05:32:54.000Z","date":"2016-05-19T22:12:40.000Z","_content":"","source":"_posts/HowTo-Install-Zabbix-2-4-on-CentOS-6-x.md","raw":"---\ntitle: HowTo Install Zabbix 2.4 on CentOS 6.x\ntags: 'Zabbix'\ncategories: 'Zabbix'\npermalink: how-to-install-zabbix-2-4-on-centos-6-x\nid: 53\nupdated: '2017-04-21 13:32:54'\ndate: 2016-05-20 06:12:40\n---\n","slug":"how-to-install-zabbix-2-4-on-centos-6-x","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq8e002k41tp0mxkvfpw","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"HowTo Install a Tomcat Server 7","id":"93","updated":"2017-04-21T05:22:05.000Z","date":"2016-09-19T02:25:53.000Z","_content":"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文件是采用的模板是CentOS 6，同样适用于CentOS 系列其他发行版本。\n\n#### 1. 测试环境\n* VMware Fushion 8 Pro # windows Use [VirtualBox](https://www.virtualbox.org/wiki/Downloads)\n* [CentOS-6.8-x86_64-minimal.iso](http://mirrors.aliyun.com/centos/6.8/isos/x86_64/CentOS-6.8-x86_64-minimal.iso)\n* [JDK 7](http://www.oracle.com/technetwork/java/javase/downloads/index.html)\n* [Tomcat 7](http://ftp.riken.jp/net/apache/tomcat/tomcat-7/)\n\n#### 2. Install Java SE Development Kit 7 (JDK7)\n\n```\n[root@ultraera ~]# curl -LO -H \"Cookie: oraclelicense=accept-securebackup-cookie\" \\\n\"http://download.oracle.com/otn-pub/java/jdk/7u75-b13/jdk-7u75-linux-x64.rpm\"\n[root@ultraera ~]# rpm -Uvh jdk-7u75-linux-x64.rpm\nPreparing...                ########################################### [100%]\n   1:jdk                    ########################################### [100%]\nUnpacking JAR files...\n        rt.jar...\n        jsse.jar...\n        charsets.jar...\n        tools.jar...\n        localedata.jar...\n        jfxrt.jar...\n```\n#### 3. Build Java Environment.\n```\n[root@ultraera ~]# vi /etc/profile\n# add follows to the end\nexport JAVA_HOME=/usr/java/default\nexport PATH=$PATH:$JAVA_HOME/bin\nexport CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar\n[root@ultraera ~]# source /etc/profile\n[root@ultraera ~]# java -version\njava version \"1.7.0_75\"\nJava(TM) SE Runtime Environment (build 1.7.0_75-b13)\nJava HotSpot(TM) 64-Bit Server VM (build 24.75-b04, mixed mode)\n```\n#### 4. Download Tomcat7\nMake sure the latest one and download it from the site below.\n=》 http://ftp.riken.jp/net/apache/tomcat/tomcat-7/\n\n```\n[root@ultraera ~]# wget http://ftp.riken.jp/net/apache/tomcat/tomcat-7/v7.0.70/bin/apache-tomcat-7.0.70.tar.gz\n[root@ultraera ~]# tar zxvf apache-tomcat-7.0.70.tar.gz\n[root@ultraera ~]# mv apache-tomcat-7.0.70 /usr/tomcat7\n[root@ultraera ~]# useradd -M -d /usr/tomcat7 tomcat7\n[root@ultraera ~]# chown -R tomcat7. /usr/tomcat7\n```\n#### 5. create a script , use service manage tomcat7\n```\n[root@ultraera ~]# cat /etc/rc.d/init.d/tomcat7\n #!/bin/bash\n\n# Tomcat7: Start/Stop Tomcat 7\n#\n# chkconfig: - 90 10\n# description: Tomcat is a Java application Server.\n\n. /etc/init.d/functions\n. /etc/sysconfig/network\n\nCATALINA_HOME=/usr/tomcat7\nTOMCAT_USER=tomcat7\n\nLOCKFILE=/var/lock/subsys/tomcat7\n\nRETVAL=0\nstart(){\n    echo \"Starting Tomcat7: \"\n    su - $TOMCAT_USER -c \"$CATALINA_HOME/bin/startup.sh\"\n    RETVAL=$?\n    echo\n    [ $RETVAL -eq 0 ] && touch $LOCKFILE\n    return $RETVAL\n}\n\nstop(){\n    echo \"Shutting down Tomcat7: \"\n    $CATALINA_HOME/bin/shutdown.sh\n    RETVAL=$?\n    echo\n    [ $RETVAL -eq 0 ] && rm -f $LOCKFILE\n    return $RETVAL\n}\n\ncase \"$1\" in\n    start)\n        start\n        ;;\n    stop)\n        stop\n        ;;\n    restart)\n        stop\n        start\n        ;;\n    *)\n        echo $\"Usage: $0 {start|stop|restart}\"\n        exit 1\n        ;;\nesac\nexit $?\n```\n#### 6. Add tomcat7 to system service\n\n```shell\n[root@ultraera ~]# chmod 755 /etc/rc.d/init.d/tomcat7\n[root@ultraera ~]# /etc/rc.d/init.d/tomcat7 start\nStarting Tomcat7:\nUsing CATALINA_BASE:   /usr/tomcat7\nUsing CATALINA_HOME:   /usr/tomcat7\nUsing CATALINA_TMPDIR: /usr/tomcat7/temp\nUsing JRE_HOME:        /usr/java/default\nUsing CLASSPATH:       /usr/tomcat7/bin/bootstrap.jar:/usr/tomcat7/bin/tomcat-juli.jar\nTomcat started.\n[root@ultraera ~]# netstat -ntlp | grep java\ntcp        0      0 ::ffff:127.0.0.1:8005       :::*                        LISTEN      6326/java\ntcp        0      0 :::8009                     :::*                        LISTEN      6326/java\ntcp        0      0 :::8080                    :::*                        LISTEN      6326/java\n[root@ultraera ~]# ps axu | grep java\ntomcat7       6326  8.3 85.6 5229768 2910176 ?     Sl   Aug22 3216:38 /usr/bin/java -Djava.util.logging.config.file=/usr/tomcat7/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -server -Djava.endorsed.dirs=/usr/tomcat7/endorsed -classpath /usr/tomcat7/bin/bootstrap.jar:/usr/tomcat7/bin/tomcat-juli.jar -Dcatalina.base=/usr/tomcat7 -Dcatalina.home=/usr/tomcat7 -Djava.io.tmpdir=/usr/tomcat7/temp org.apache.catalina.startup.Bootstrap start\n[root@ultraera ~]# chkconfig --add tomcat7\n[root@ultraera ~]# chkconfig tomcat7 on\n```\n#### 7. 打开浏览器测试Tomcat Server搭建完成，默认页面如下\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/09/tomcat7.jpg)\n\n#### 8. 使用curl 测试\n```\n[root@ultraera ~]# curl -I http://localhost:8080\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nContent-Type: text/html;charset=ISO-8859-1\nTransfer-Encoding: chunked\nDate: Sun, 18 Sep 2016 11:14:06 GMT\n```\n\n#### 9. Tomcat 文件树\n\n```\n[root@ultraera /usr/tomcat7]# tree\n.\n├── bin\n│   ├── bootstrap.jar\n│   ├── catalina.bat\n│   ├── catalina.sh\n│   ├── catalina-tasks.xml\n│   ├── commons-daemon.jar\n│   ├── commons-daemon-native.tar.gz\n│   ├── configtest.bat\n│   ├── configtest.sh\n│   ├── daemon.sh\n│   ├── digest.bat\n│   ├── digest.sh\n│   ├── setclasspath.bat\n│   ├── setclasspath.sh\n│   ├── shutdown.bat\n│   ├── shutdown.sh\n│   ├── startup.bat\n│   ├── startup.sh\n│   ├── tomcat-juli.jar\n│   ├── tomcat-native.tar.gz\n│   ├── tool-wrapper.bat\n│   ├── tool-wrapper.sh\n│   ├── version.bat\n│   └── version.sh\n├── conf\n│   ├── catalina.policy\n│   ├── catalina.properties\n│   ├── context.xml\n│   ├── logging.properties\n│   ├── server.xml\n│   ├── tomcat-users.xml\n│   └── web.xml\n├── lib\n├── LICENSE\n├── logs\n│   ├── catalina.2016-09-18.log\n│   ├── catalina.out\n│   ├── host-manager.2016-09-18.log\n│   ├── localhost.2016-09-18.log\n│   └── manager.2016-09-18.log\n├── NOTICE\n├── RELEASE-NOTES\n├── RUNNING.txt\n├── temp\n├── webapps\n│   └── ROOT\n└── work\n```\n","source":"_posts/HowTo-Install-a-Tomcat-Server-7.md","raw":"---\ntitle: HowTo Install a Tomcat Server 7\ntags: 'Tomcat'\ncategories: 'Tomcat'\npermalink: install-a-tomcat-server-7\nid: 93\nupdated: '2017-04-21 13:22:05'\ndate: 2016-09-19 10:25:53\n---\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文件是采用的模板是CentOS 6，同样适用于CentOS 系列其他发行版本。\n\n#### 1. 测试环境\n* VMware Fushion 8 Pro # windows Use [VirtualBox](https://www.virtualbox.org/wiki/Downloads)\n* [CentOS-6.8-x86_64-minimal.iso](http://mirrors.aliyun.com/centos/6.8/isos/x86_64/CentOS-6.8-x86_64-minimal.iso)\n* [JDK 7](http://www.oracle.com/technetwork/java/javase/downloads/index.html)\n* [Tomcat 7](http://ftp.riken.jp/net/apache/tomcat/tomcat-7/)\n\n#### 2. Install Java SE Development Kit 7 (JDK7)\n\n```\n[root@ultraera ~]# curl -LO -H \"Cookie: oraclelicense=accept-securebackup-cookie\" \\\n\"http://download.oracle.com/otn-pub/java/jdk/7u75-b13/jdk-7u75-linux-x64.rpm\"\n[root@ultraera ~]# rpm -Uvh jdk-7u75-linux-x64.rpm\nPreparing...                ########################################### [100%]\n   1:jdk                    ########################################### [100%]\nUnpacking JAR files...\n        rt.jar...\n        jsse.jar...\n        charsets.jar...\n        tools.jar...\n        localedata.jar...\n        jfxrt.jar...\n```\n#### 3. Build Java Environment.\n```\n[root@ultraera ~]# vi /etc/profile\n# add follows to the end\nexport JAVA_HOME=/usr/java/default\nexport PATH=$PATH:$JAVA_HOME/bin\nexport CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar\n[root@ultraera ~]# source /etc/profile\n[root@ultraera ~]# java -version\njava version \"1.7.0_75\"\nJava(TM) SE Runtime Environment (build 1.7.0_75-b13)\nJava HotSpot(TM) 64-Bit Server VM (build 24.75-b04, mixed mode)\n```\n#### 4. Download Tomcat7\nMake sure the latest one and download it from the site below.\n=》 http://ftp.riken.jp/net/apache/tomcat/tomcat-7/\n\n```\n[root@ultraera ~]# wget http://ftp.riken.jp/net/apache/tomcat/tomcat-7/v7.0.70/bin/apache-tomcat-7.0.70.tar.gz\n[root@ultraera ~]# tar zxvf apache-tomcat-7.0.70.tar.gz\n[root@ultraera ~]# mv apache-tomcat-7.0.70 /usr/tomcat7\n[root@ultraera ~]# useradd -M -d /usr/tomcat7 tomcat7\n[root@ultraera ~]# chown -R tomcat7. /usr/tomcat7\n```\n#### 5. create a script , use service manage tomcat7\n```\n[root@ultraera ~]# cat /etc/rc.d/init.d/tomcat7\n #!/bin/bash\n\n# Tomcat7: Start/Stop Tomcat 7\n#\n# chkconfig: - 90 10\n# description: Tomcat is a Java application Server.\n\n. /etc/init.d/functions\n. /etc/sysconfig/network\n\nCATALINA_HOME=/usr/tomcat7\nTOMCAT_USER=tomcat7\n\nLOCKFILE=/var/lock/subsys/tomcat7\n\nRETVAL=0\nstart(){\n    echo \"Starting Tomcat7: \"\n    su - $TOMCAT_USER -c \"$CATALINA_HOME/bin/startup.sh\"\n    RETVAL=$?\n    echo\n    [ $RETVAL -eq 0 ] && touch $LOCKFILE\n    return $RETVAL\n}\n\nstop(){\n    echo \"Shutting down Tomcat7: \"\n    $CATALINA_HOME/bin/shutdown.sh\n    RETVAL=$?\n    echo\n    [ $RETVAL -eq 0 ] && rm -f $LOCKFILE\n    return $RETVAL\n}\n\ncase \"$1\" in\n    start)\n        start\n        ;;\n    stop)\n        stop\n        ;;\n    restart)\n        stop\n        start\n        ;;\n    *)\n        echo $\"Usage: $0 {start|stop|restart}\"\n        exit 1\n        ;;\nesac\nexit $?\n```\n#### 6. Add tomcat7 to system service\n\n```shell\n[root@ultraera ~]# chmod 755 /etc/rc.d/init.d/tomcat7\n[root@ultraera ~]# /etc/rc.d/init.d/tomcat7 start\nStarting Tomcat7:\nUsing CATALINA_BASE:   /usr/tomcat7\nUsing CATALINA_HOME:   /usr/tomcat7\nUsing CATALINA_TMPDIR: /usr/tomcat7/temp\nUsing JRE_HOME:        /usr/java/default\nUsing CLASSPATH:       /usr/tomcat7/bin/bootstrap.jar:/usr/tomcat7/bin/tomcat-juli.jar\nTomcat started.\n[root@ultraera ~]# netstat -ntlp | grep java\ntcp        0      0 ::ffff:127.0.0.1:8005       :::*                        LISTEN      6326/java\ntcp        0      0 :::8009                     :::*                        LISTEN      6326/java\ntcp        0      0 :::8080                    :::*                        LISTEN      6326/java\n[root@ultraera ~]# ps axu | grep java\ntomcat7       6326  8.3 85.6 5229768 2910176 ?     Sl   Aug22 3216:38 /usr/bin/java -Djava.util.logging.config.file=/usr/tomcat7/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -server -Djava.endorsed.dirs=/usr/tomcat7/endorsed -classpath /usr/tomcat7/bin/bootstrap.jar:/usr/tomcat7/bin/tomcat-juli.jar -Dcatalina.base=/usr/tomcat7 -Dcatalina.home=/usr/tomcat7 -Djava.io.tmpdir=/usr/tomcat7/temp org.apache.catalina.startup.Bootstrap start\n[root@ultraera ~]# chkconfig --add tomcat7\n[root@ultraera ~]# chkconfig tomcat7 on\n```\n#### 7. 打开浏览器测试Tomcat Server搭建完成，默认页面如下\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/09/tomcat7.jpg)\n\n#### 8. 使用curl 测试\n```\n[root@ultraera ~]# curl -I http://localhost:8080\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nContent-Type: text/html;charset=ISO-8859-1\nTransfer-Encoding: chunked\nDate: Sun, 18 Sep 2016 11:14:06 GMT\n```\n\n#### 9. Tomcat 文件树\n\n```\n[root@ultraera /usr/tomcat7]# tree\n.\n├── bin\n│   ├── bootstrap.jar\n│   ├── catalina.bat\n│   ├── catalina.sh\n│   ├── catalina-tasks.xml\n│   ├── commons-daemon.jar\n│   ├── commons-daemon-native.tar.gz\n│   ├── configtest.bat\n│   ├── configtest.sh\n│   ├── daemon.sh\n│   ├── digest.bat\n│   ├── digest.sh\n│   ├── setclasspath.bat\n│   ├── setclasspath.sh\n│   ├── shutdown.bat\n│   ├── shutdown.sh\n│   ├── startup.bat\n│   ├── startup.sh\n│   ├── tomcat-juli.jar\n│   ├── tomcat-native.tar.gz\n│   ├── tool-wrapper.bat\n│   ├── tool-wrapper.sh\n│   ├── version.bat\n│   └── version.sh\n├── conf\n│   ├── catalina.policy\n│   ├── catalina.properties\n│   ├── context.xml\n│   ├── logging.properties\n│   ├── server.xml\n│   ├── tomcat-users.xml\n│   └── web.xml\n├── lib\n├── LICENSE\n├── logs\n│   ├── catalina.2016-09-18.log\n│   ├── catalina.out\n│   ├── host-manager.2016-09-18.log\n│   ├── localhost.2016-09-18.log\n│   └── manager.2016-09-18.log\n├── NOTICE\n├── RELEASE-NOTES\n├── RUNNING.txt\n├── temp\n├── webapps\n│   └── ROOT\n└── work\n```\n","slug":"install-a-tomcat-server-7","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq8l002m41tpjidzd0x4","content":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文件是采用的模板是CentOS 6，同样适用于CentOS 系列其他发行版本。</p>\n<h4 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h4><ul>\n<li>VMware Fushion 8 Pro # windows Use <a href=\"https://www.virtualbox.org/wiki/Downloads\" target=\"_blank\" rel=\"external\">VirtualBox</a></li>\n<li><a href=\"http://mirrors.aliyun.com/centos/6.8/isos/x86_64/CentOS-6.8-x86_64-minimal.iso\" target=\"_blank\" rel=\"external\">CentOS-6.8-x86_64-minimal.iso</a></li>\n<li><a href=\"http://www.oracle.com/technetwork/java/javase/downloads/index.html\" target=\"_blank\" rel=\"external\">JDK 7</a></li>\n<li><a href=\"http://ftp.riken.jp/net/apache/tomcat/tomcat-7/\" target=\"_blank\" rel=\"external\">Tomcat 7</a></li>\n</ul>\n<h4 id=\"2-Install-Java-SE-Development-Kit-7-JDK7\"><a href=\"#2-Install-Java-SE-Development-Kit-7-JDK7\" class=\"headerlink\" title=\"2. Install Java SE Development Kit 7 (JDK7)\"></a>2. Install Java SE Development Kit 7 (JDK7)</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# curl -LO -H &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; \\</div><div class=\"line\">&quot;http://download.oracle.com/otn-pub/java/jdk/7u75-b13/jdk-7u75-linux-x64.rpm&quot;</div><div class=\"line\">[root@ultraera ~]# rpm -Uvh jdk-7u75-linux-x64.rpm</div><div class=\"line\">Preparing...                ########################################### [100%]</div><div class=\"line\">   1:jdk                    ########################################### [100%]</div><div class=\"line\">Unpacking JAR files...</div><div class=\"line\">        rt.jar...</div><div class=\"line\">        jsse.jar...</div><div class=\"line\">        charsets.jar...</div><div class=\"line\">        tools.jar...</div><div class=\"line\">        localedata.jar...</div><div class=\"line\">        jfxrt.jar...</div></pre></td></tr></table></figure>\n<h4 id=\"3-Build-Java-Environment\"><a href=\"#3-Build-Java-Environment\" class=\"headerlink\" title=\"3. Build Java Environment.\"></a>3. Build Java Environment.</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vi /etc/profile</div><div class=\"line\"># add follows to the end</div><div class=\"line\">export JAVA_HOME=/usr/java/default</div><div class=\"line\">export PATH=$PATH:$JAVA_HOME/bin</div><div class=\"line\">export CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar</div><div class=\"line\">[root@ultraera ~]# source /etc/profile</div><div class=\"line\">[root@ultraera ~]# java -version</div><div class=\"line\">java version &quot;1.7.0_75&quot;</div><div class=\"line\">Java(TM) SE Runtime Environment (build 1.7.0_75-b13)</div><div class=\"line\">Java HotSpot(TM) 64-Bit Server VM (build 24.75-b04, mixed mode)</div></pre></td></tr></table></figure>\n<h4 id=\"4-Download-Tomcat7\"><a href=\"#4-Download-Tomcat7\" class=\"headerlink\" title=\"4. Download Tomcat7\"></a>4. Download Tomcat7</h4><p>Make sure the latest one and download it from the site below.<br>=》 <a href=\"http://ftp.riken.jp/net/apache/tomcat/tomcat-7/\" target=\"_blank\" rel=\"external\">http://ftp.riken.jp/net/apache/tomcat/tomcat-7/</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# wget http://ftp.riken.jp/net/apache/tomcat/tomcat-7/v7.0.70/bin/apache-tomcat-7.0.70.tar.gz</div><div class=\"line\">[root@ultraera ~]# tar zxvf apache-tomcat-7.0.70.tar.gz</div><div class=\"line\">[root@ultraera ~]# mv apache-tomcat-7.0.70 /usr/tomcat7</div><div class=\"line\">[root@ultraera ~]# useradd -M -d /usr/tomcat7 tomcat7</div><div class=\"line\">[root@ultraera ~]# chown -R tomcat7. /usr/tomcat7</div></pre></td></tr></table></figure>\n<h4 id=\"5-create-a-script-use-service-manage-tomcat7\"><a href=\"#5-create-a-script-use-service-manage-tomcat7\" class=\"headerlink\" title=\"5. create a script , use service manage tomcat7\"></a>5. create a script , use service manage tomcat7</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# cat /etc/rc.d/init.d/tomcat7</div><div class=\"line\"> #!/bin/bash</div><div class=\"line\"></div><div class=\"line\"># Tomcat7: Start/Stop Tomcat 7</div><div class=\"line\">#</div><div class=\"line\"># chkconfig: - 90 10</div><div class=\"line\"># description: Tomcat is a Java application Server.</div><div class=\"line\"></div><div class=\"line\">. /etc/init.d/functions</div><div class=\"line\">. /etc/sysconfig/network</div><div class=\"line\"></div><div class=\"line\">CATALINA_HOME=/usr/tomcat7</div><div class=\"line\">TOMCAT_USER=tomcat7</div><div class=\"line\"></div><div class=\"line\">LOCKFILE=/var/lock/subsys/tomcat7</div><div class=\"line\"></div><div class=\"line\">RETVAL=0</div><div class=\"line\">start()&#123;</div><div class=\"line\">    echo &quot;Starting Tomcat7: &quot;</div><div class=\"line\">    su - $TOMCAT_USER -c &quot;$CATALINA_HOME/bin/startup.sh&quot;</div><div class=\"line\">    RETVAL=$?</div><div class=\"line\">    echo</div><div class=\"line\">    [ $RETVAL -eq 0 ] &amp;&amp; touch $LOCKFILE</div><div class=\"line\">    return $RETVAL</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">stop()&#123;</div><div class=\"line\">    echo &quot;Shutting down Tomcat7: &quot;</div><div class=\"line\">    $CATALINA_HOME/bin/shutdown.sh</div><div class=\"line\">    RETVAL=$?</div><div class=\"line\">    echo</div><div class=\"line\">    [ $RETVAL -eq 0 ] &amp;&amp; rm -f $LOCKFILE</div><div class=\"line\">    return $RETVAL</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">case &quot;$1&quot; in</div><div class=\"line\">    start)</div><div class=\"line\">        start</div><div class=\"line\">        ;;</div><div class=\"line\">    stop)</div><div class=\"line\">        stop</div><div class=\"line\">        ;;</div><div class=\"line\">    restart)</div><div class=\"line\">        stop</div><div class=\"line\">        start</div><div class=\"line\">        ;;</div><div class=\"line\">    *)</div><div class=\"line\">        echo $&quot;Usage: $0 &#123;start|stop|restart&#125;&quot;</div><div class=\"line\">        exit 1</div><div class=\"line\">        ;;</div><div class=\"line\">esac</div><div class=\"line\">exit $?</div></pre></td></tr></table></figure>\n<h4 id=\"6-Add-tomcat7-to-system-service\"><a href=\"#6-Add-tomcat7-to-system-service\" class=\"headerlink\" title=\"6. Add tomcat7 to system service\"></a>6. Add tomcat7 to system service</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# chmod 755 /etc/rc.d/init.d/tomcat7</div><div class=\"line\">[root@ultraera ~]# /etc/rc.d/init.d/tomcat7 start</div><div class=\"line\">Starting Tomcat7:</div><div class=\"line\">Using CATALINA_BASE:   /usr/tomcat7</div><div class=\"line\">Using CATALINA_HOME:   /usr/tomcat7</div><div class=\"line\">Using CATALINA_TMPDIR: /usr/tomcat7/temp</div><div class=\"line\">Using JRE_HOME:        /usr/java/default</div><div class=\"line\">Using CLASSPATH:       /usr/tomcat7/bin/bootstrap.jar:/usr/tomcat7/bin/tomcat-juli.jar</div><div class=\"line\">Tomcat started.</div><div class=\"line\">[root@ultraera ~]# netstat -ntlp | grep java</div><div class=\"line\">tcp        0      0 ::ffff:127.0.0.1:8005       :::*                        LISTEN      6326/java</div><div class=\"line\">tcp        0      0 :::8009                     :::*                        LISTEN      6326/java</div><div class=\"line\">tcp        0      0 :::8080                    :::*                        LISTEN      6326/java</div><div class=\"line\">[root@ultraera ~]# ps axu | grep java</div><div class=\"line\">tomcat7       6326  8.3 85.6 5229768 2910176 ?     Sl   Aug22 3216:38 /usr/bin/java -Djava.util.logging.config.file=/usr/tomcat7/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -server -Djava.endorsed.dirs=/usr/tomcat7/endorsed -classpath /usr/tomcat7/bin/bootstrap.jar:/usr/tomcat7/bin/tomcat-juli.jar -Dcatalina.base=/usr/tomcat7 -Dcatalina.home=/usr/tomcat7 -Djava.io.tmpdir=/usr/tomcat7/temp org.apache.catalina.startup.Bootstrap start</div><div class=\"line\">[root@ultraera ~]# chkconfig --add tomcat7</div><div class=\"line\">[root@ultraera ~]# chkconfig tomcat7 on</div></pre></td></tr></table></figure>\n<h4 id=\"7-打开浏览器测试Tomcat-Server搭建完成，默认页面如下\"><a href=\"#7-打开浏览器测试Tomcat-Server搭建完成，默认页面如下\" class=\"headerlink\" title=\"7. 打开浏览器测试Tomcat Server搭建完成，默认页面如下\"></a>7. 打开浏览器测试Tomcat Server搭建完成，默认页面如下</h4><p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/09/tomcat7.jpg\" alt=\"\"></p>\n<h4 id=\"8-使用curl-测试\"><a href=\"#8-使用curl-测试\" class=\"headerlink\" title=\"8. 使用curl 测试\"></a>8. 使用curl 测试</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# curl -I http://localhost:8080</div><div class=\"line\">HTTP/1.1 200 OK</div><div class=\"line\">Server: Apache-Coyote/1.1</div><div class=\"line\">Content-Type: text/html;charset=ISO-8859-1</div><div class=\"line\">Transfer-Encoding: chunked</div><div class=\"line\">Date: Sun, 18 Sep 2016 11:14:06 GMT</div></pre></td></tr></table></figure>\n<h4 id=\"9-Tomcat-文件树\"><a href=\"#9-Tomcat-文件树\" class=\"headerlink\" title=\"9. Tomcat 文件树\"></a>9. Tomcat 文件树</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera /usr/tomcat7]# tree</div><div class=\"line\">.</div><div class=\"line\">├── bin</div><div class=\"line\">│   ├── bootstrap.jar</div><div class=\"line\">│   ├── catalina.bat</div><div class=\"line\">│   ├── catalina.sh</div><div class=\"line\">│   ├── catalina-tasks.xml</div><div class=\"line\">│   ├── commons-daemon.jar</div><div class=\"line\">│   ├── commons-daemon-native.tar.gz</div><div class=\"line\">│   ├── configtest.bat</div><div class=\"line\">│   ├── configtest.sh</div><div class=\"line\">│   ├── daemon.sh</div><div class=\"line\">│   ├── digest.bat</div><div class=\"line\">│   ├── digest.sh</div><div class=\"line\">│   ├── setclasspath.bat</div><div class=\"line\">│   ├── setclasspath.sh</div><div class=\"line\">│   ├── shutdown.bat</div><div class=\"line\">│   ├── shutdown.sh</div><div class=\"line\">│   ├── startup.bat</div><div class=\"line\">│   ├── startup.sh</div><div class=\"line\">│   ├── tomcat-juli.jar</div><div class=\"line\">│   ├── tomcat-native.tar.gz</div><div class=\"line\">│   ├── tool-wrapper.bat</div><div class=\"line\">│   ├── tool-wrapper.sh</div><div class=\"line\">│   ├── version.bat</div><div class=\"line\">│   └── version.sh</div><div class=\"line\">├── conf</div><div class=\"line\">│   ├── catalina.policy</div><div class=\"line\">│   ├── catalina.properties</div><div class=\"line\">│   ├── context.xml</div><div class=\"line\">│   ├── logging.properties</div><div class=\"line\">│   ├── server.xml</div><div class=\"line\">│   ├── tomcat-users.xml</div><div class=\"line\">│   └── web.xml</div><div class=\"line\">├── lib</div><div class=\"line\">├── LICENSE</div><div class=\"line\">├── logs</div><div class=\"line\">│   ├── catalina.2016-09-18.log</div><div class=\"line\">│   ├── catalina.out</div><div class=\"line\">│   ├── host-manager.2016-09-18.log</div><div class=\"line\">│   ├── localhost.2016-09-18.log</div><div class=\"line\">│   └── manager.2016-09-18.log</div><div class=\"line\">├── NOTICE</div><div class=\"line\">├── RELEASE-NOTES</div><div class=\"line\">├── RUNNING.txt</div><div class=\"line\">├── temp</div><div class=\"line\">├── webapps</div><div class=\"line\">│   └── ROOT</div><div class=\"line\">└── work</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文件是采用的模板是CentOS 6，同样适用于CentOS 系列其他发行版本。</p>\n<h4 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h4><ul>\n<li>VMware Fushion 8 Pro # windows Use <a href=\"https://www.virtualbox.org/wiki/Downloads\">VirtualBox</a></li>\n<li><a href=\"http://mirrors.aliyun.com/centos/6.8/isos/x86_64/CentOS-6.8-x86_64-minimal.iso\">CentOS-6.8-x86_64-minimal.iso</a></li>\n<li><a href=\"http://www.oracle.com/technetwork/java/javase/downloads/index.html\">JDK 7</a></li>\n<li><a href=\"http://ftp.riken.jp/net/apache/tomcat/tomcat-7/\">Tomcat 7</a></li>\n</ul>\n<h4 id=\"2-Install-Java-SE-Development-Kit-7-JDK7\"><a href=\"#2-Install-Java-SE-Development-Kit-7-JDK7\" class=\"headerlink\" title=\"2. Install Java SE Development Kit 7 (JDK7)\"></a>2. Install Java SE Development Kit 7 (JDK7)</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# curl -LO -H &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; \\</div><div class=\"line\">&quot;http://download.oracle.com/otn-pub/java/jdk/7u75-b13/jdk-7u75-linux-x64.rpm&quot;</div><div class=\"line\">[root@ultraera ~]# rpm -Uvh jdk-7u75-linux-x64.rpm</div><div class=\"line\">Preparing...                ########################################### [100%]</div><div class=\"line\">   1:jdk                    ########################################### [100%]</div><div class=\"line\">Unpacking JAR files...</div><div class=\"line\">        rt.jar...</div><div class=\"line\">        jsse.jar...</div><div class=\"line\">        charsets.jar...</div><div class=\"line\">        tools.jar...</div><div class=\"line\">        localedata.jar...</div><div class=\"line\">        jfxrt.jar...</div></pre></td></tr></table></figure>\n<h4 id=\"3-Build-Java-Environment\"><a href=\"#3-Build-Java-Environment\" class=\"headerlink\" title=\"3. Build Java Environment.\"></a>3. Build Java Environment.</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vi /etc/profile</div><div class=\"line\"># add follows to the end</div><div class=\"line\">export JAVA_HOME=/usr/java/default</div><div class=\"line\">export PATH=$PATH:$JAVA_HOME/bin</div><div class=\"line\">export CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar</div><div class=\"line\">[root@ultraera ~]# source /etc/profile</div><div class=\"line\">[root@ultraera ~]# java -version</div><div class=\"line\">java version &quot;1.7.0_75&quot;</div><div class=\"line\">Java(TM) SE Runtime Environment (build 1.7.0_75-b13)</div><div class=\"line\">Java HotSpot(TM) 64-Bit Server VM (build 24.75-b04, mixed mode)</div></pre></td></tr></table></figure>\n<h4 id=\"4-Download-Tomcat7\"><a href=\"#4-Download-Tomcat7\" class=\"headerlink\" title=\"4. Download Tomcat7\"></a>4. Download Tomcat7</h4><p>Make sure the latest one and download it from the site below.<br>=》 <a href=\"http://ftp.riken.jp/net/apache/tomcat/tomcat-7/\">http://ftp.riken.jp/net/apache/tomcat/tomcat-7/</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# wget http://ftp.riken.jp/net/apache/tomcat/tomcat-7/v7.0.70/bin/apache-tomcat-7.0.70.tar.gz</div><div class=\"line\">[root@ultraera ~]# tar zxvf apache-tomcat-7.0.70.tar.gz</div><div class=\"line\">[root@ultraera ~]# mv apache-tomcat-7.0.70 /usr/tomcat7</div><div class=\"line\">[root@ultraera ~]# useradd -M -d /usr/tomcat7 tomcat7</div><div class=\"line\">[root@ultraera ~]# chown -R tomcat7. /usr/tomcat7</div></pre></td></tr></table></figure>\n<h4 id=\"5-create-a-script-use-service-manage-tomcat7\"><a href=\"#5-create-a-script-use-service-manage-tomcat7\" class=\"headerlink\" title=\"5. create a script , use service manage tomcat7\"></a>5. create a script , use service manage tomcat7</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# cat /etc/rc.d/init.d/tomcat7</div><div class=\"line\"> #!/bin/bash</div><div class=\"line\"></div><div class=\"line\"># Tomcat7: Start/Stop Tomcat 7</div><div class=\"line\">#</div><div class=\"line\"># chkconfig: - 90 10</div><div class=\"line\"># description: Tomcat is a Java application Server.</div><div class=\"line\"></div><div class=\"line\">. /etc/init.d/functions</div><div class=\"line\">. /etc/sysconfig/network</div><div class=\"line\"></div><div class=\"line\">CATALINA_HOME=/usr/tomcat7</div><div class=\"line\">TOMCAT_USER=tomcat7</div><div class=\"line\"></div><div class=\"line\">LOCKFILE=/var/lock/subsys/tomcat7</div><div class=\"line\"></div><div class=\"line\">RETVAL=0</div><div class=\"line\">start()&#123;</div><div class=\"line\">    echo &quot;Starting Tomcat7: &quot;</div><div class=\"line\">    su - $TOMCAT_USER -c &quot;$CATALINA_HOME/bin/startup.sh&quot;</div><div class=\"line\">    RETVAL=$?</div><div class=\"line\">    echo</div><div class=\"line\">    [ $RETVAL -eq 0 ] &amp;&amp; touch $LOCKFILE</div><div class=\"line\">    return $RETVAL</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">stop()&#123;</div><div class=\"line\">    echo &quot;Shutting down Tomcat7: &quot;</div><div class=\"line\">    $CATALINA_HOME/bin/shutdown.sh</div><div class=\"line\">    RETVAL=$?</div><div class=\"line\">    echo</div><div class=\"line\">    [ $RETVAL -eq 0 ] &amp;&amp; rm -f $LOCKFILE</div><div class=\"line\">    return $RETVAL</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">case &quot;$1&quot; in</div><div class=\"line\">    start)</div><div class=\"line\">        start</div><div class=\"line\">        ;;</div><div class=\"line\">    stop)</div><div class=\"line\">        stop</div><div class=\"line\">        ;;</div><div class=\"line\">    restart)</div><div class=\"line\">        stop</div><div class=\"line\">        start</div><div class=\"line\">        ;;</div><div class=\"line\">    *)</div><div class=\"line\">        echo $&quot;Usage: $0 &#123;start|stop|restart&#125;&quot;</div><div class=\"line\">        exit 1</div><div class=\"line\">        ;;</div><div class=\"line\">esac</div><div class=\"line\">exit $?</div></pre></td></tr></table></figure>\n<h4 id=\"6-Add-tomcat7-to-system-service\"><a href=\"#6-Add-tomcat7-to-system-service\" class=\"headerlink\" title=\"6. Add tomcat7 to system service\"></a>6. Add tomcat7 to system service</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# chmod 755 /etc/rc.d/init.d/tomcat7</div><div class=\"line\">[root@ultraera ~]# /etc/rc.d/init.d/tomcat7 start</div><div class=\"line\">Starting Tomcat7:</div><div class=\"line\">Using CATALINA_BASE:   /usr/tomcat7</div><div class=\"line\">Using CATALINA_HOME:   /usr/tomcat7</div><div class=\"line\">Using CATALINA_TMPDIR: /usr/tomcat7/temp</div><div class=\"line\">Using JRE_HOME:        /usr/java/default</div><div class=\"line\">Using CLASSPATH:       /usr/tomcat7/bin/bootstrap.jar:/usr/tomcat7/bin/tomcat-juli.jar</div><div class=\"line\">Tomcat started.</div><div class=\"line\">[root@ultraera ~]# netstat -ntlp | grep java</div><div class=\"line\">tcp        0      0 ::ffff:127.0.0.1:8005       :::*                        LISTEN      6326/java</div><div class=\"line\">tcp        0      0 :::8009                     :::*                        LISTEN      6326/java</div><div class=\"line\">tcp        0      0 :::8080                    :::*                        LISTEN      6326/java</div><div class=\"line\">[root@ultraera ~]# ps axu | grep java</div><div class=\"line\">tomcat7       6326  8.3 85.6 5229768 2910176 ?     Sl   Aug22 3216:38 /usr/bin/java -Djava.util.logging.config.file=/usr/tomcat7/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -server -Djava.endorsed.dirs=/usr/tomcat7/endorsed -classpath /usr/tomcat7/bin/bootstrap.jar:/usr/tomcat7/bin/tomcat-juli.jar -Dcatalina.base=/usr/tomcat7 -Dcatalina.home=/usr/tomcat7 -Djava.io.tmpdir=/usr/tomcat7/temp org.apache.catalina.startup.Bootstrap start</div><div class=\"line\">[root@ultraera ~]# chkconfig --add tomcat7</div><div class=\"line\">[root@ultraera ~]# chkconfig tomcat7 on</div></pre></td></tr></table></figure>\n<h4 id=\"7-打开浏览器测试Tomcat-Server搭建完成，默认页面如下\"><a href=\"#7-打开浏览器测试Tomcat-Server搭建完成，默认页面如下\" class=\"headerlink\" title=\"7. 打开浏览器测试Tomcat Server搭建完成，默认页面如下\"></a>7. 打开浏览器测试Tomcat Server搭建完成，默认页面如下</h4><p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/09/tomcat7.jpg\" alt=\"\"></p>\n<h4 id=\"8-使用curl-测试\"><a href=\"#8-使用curl-测试\" class=\"headerlink\" title=\"8. 使用curl 测试\"></a>8. 使用curl 测试</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# curl -I http://localhost:8080</div><div class=\"line\">HTTP/1.1 200 OK</div><div class=\"line\">Server: Apache-Coyote/1.1</div><div class=\"line\">Content-Type: text/html;charset=ISO-8859-1</div><div class=\"line\">Transfer-Encoding: chunked</div><div class=\"line\">Date: Sun, 18 Sep 2016 11:14:06 GMT</div></pre></td></tr></table></figure>\n<h4 id=\"9-Tomcat-文件树\"><a href=\"#9-Tomcat-文件树\" class=\"headerlink\" title=\"9. Tomcat 文件树\"></a>9. Tomcat 文件树</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera /usr/tomcat7]# tree</div><div class=\"line\">.</div><div class=\"line\">├── bin</div><div class=\"line\">│   ├── bootstrap.jar</div><div class=\"line\">│   ├── catalina.bat</div><div class=\"line\">│   ├── catalina.sh</div><div class=\"line\">│   ├── catalina-tasks.xml</div><div class=\"line\">│   ├── commons-daemon.jar</div><div class=\"line\">│   ├── commons-daemon-native.tar.gz</div><div class=\"line\">│   ├── configtest.bat</div><div class=\"line\">│   ├── configtest.sh</div><div class=\"line\">│   ├── daemon.sh</div><div class=\"line\">│   ├── digest.bat</div><div class=\"line\">│   ├── digest.sh</div><div class=\"line\">│   ├── setclasspath.bat</div><div class=\"line\">│   ├── setclasspath.sh</div><div class=\"line\">│   ├── shutdown.bat</div><div class=\"line\">│   ├── shutdown.sh</div><div class=\"line\">│   ├── startup.bat</div><div class=\"line\">│   ├── startup.sh</div><div class=\"line\">│   ├── tomcat-juli.jar</div><div class=\"line\">│   ├── tomcat-native.tar.gz</div><div class=\"line\">│   ├── tool-wrapper.bat</div><div class=\"line\">│   ├── tool-wrapper.sh</div><div class=\"line\">│   ├── version.bat</div><div class=\"line\">│   └── version.sh</div><div class=\"line\">├── conf</div><div class=\"line\">│   ├── catalina.policy</div><div class=\"line\">│   ├── catalina.properties</div><div class=\"line\">│   ├── context.xml</div><div class=\"line\">│   ├── logging.properties</div><div class=\"line\">│   ├── server.xml</div><div class=\"line\">│   ├── tomcat-users.xml</div><div class=\"line\">│   └── web.xml</div><div class=\"line\">├── lib</div><div class=\"line\">├── LICENSE</div><div class=\"line\">├── logs</div><div class=\"line\">│   ├── catalina.2016-09-18.log</div><div class=\"line\">│   ├── catalina.out</div><div class=\"line\">│   ├── host-manager.2016-09-18.log</div><div class=\"line\">│   ├── localhost.2016-09-18.log</div><div class=\"line\">│   └── manager.2016-09-18.log</div><div class=\"line\">├── NOTICE</div><div class=\"line\">├── RELEASE-NOTES</div><div class=\"line\">├── RUNNING.txt</div><div class=\"line\">├── temp</div><div class=\"line\">├── webapps</div><div class=\"line\">│   └── ROOT</div><div class=\"line\">└── work</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Install piwik with nginx on centos 6.x","id":"36","updated":"2017-04-21T05:36:21.000Z","date":"2016-04-27T08:00:44.000Z","_content":"\n\n### This is my nginx config.\n```\nserver {\n\tlisten blog.ultraera.org:80;\n\tserver_name blog.ultraera.org;\n\n\tlocation / {\n\t\tproxy_set_header\tX-Real-IP $remote_addr;\n\t\tproxy_set_header\tHost\t$http_host;\n\t\tproxy_pass\t\t\thttp://127.0.0.1:2368;\n\t}\n}\n\nserver {\n\tlisten piwik.ultraera.org:80;\n\tserver_name piwik.ultraera.org;\n\n\tlocation / {\n\t\tproxy_set_header\tX-Real-IP $remote_addr;\n\t\tproxy_set_header\tHost\t$http_host;\n\t\tproxy_pass\t\t\thttp://127.0.0.1:2080;\n\t}\n}\n\n```\n","source":"_posts/HowTo-Install-piwik-with-nginx-on-centos-6-x.md","raw":"---\ntitle: HowTo Install piwik with nginx on centos 6.x\ntags: 'Piwik'\ncategories: 'Ghost'\npermalink: how-to-install-piwik-with-nginx-on-centos-6-x\nid: 36\nupdated: '2017-04-21 13:36:21'\ndate: 2016-04-27 16:00:44\n---\n\n\n### This is my nginx config.\n```\nserver {\n\tlisten blog.ultraera.org:80;\n\tserver_name blog.ultraera.org;\n\n\tlocation / {\n\t\tproxy_set_header\tX-Real-IP $remote_addr;\n\t\tproxy_set_header\tHost\t$http_host;\n\t\tproxy_pass\t\t\thttp://127.0.0.1:2368;\n\t}\n}\n\nserver {\n\tlisten piwik.ultraera.org:80;\n\tserver_name piwik.ultraera.org;\n\n\tlocation / {\n\t\tproxy_set_header\tX-Real-IP $remote_addr;\n\t\tproxy_set_header\tHost\t$http_host;\n\t\tproxy_pass\t\t\thttp://127.0.0.1:2080;\n\t}\n}\n\n```\n","slug":"how-to-install-piwik-with-nginx-on-centos-6-x","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq8s002q41tp8f2e4zvn","content":"<h3 id=\"This-is-my-nginx-config\"><a href=\"#This-is-my-nginx-config\" class=\"headerlink\" title=\"This is my nginx config.\"></a>This is my nginx config.</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">server &#123;</div><div class=\"line\">\tlisten blog.ultraera.org:80;</div><div class=\"line\">\tserver_name blog.ultraera.org;</div><div class=\"line\"></div><div class=\"line\">\tlocation / &#123;</div><div class=\"line\">\t\tproxy_set_header\tX-Real-IP $remote_addr;</div><div class=\"line\">\t\tproxy_set_header\tHost\t$http_host;</div><div class=\"line\">\t\tproxy_pass\t\t\thttp://127.0.0.1:2368;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">server &#123;</div><div class=\"line\">\tlisten piwik.ultraera.org:80;</div><div class=\"line\">\tserver_name piwik.ultraera.org;</div><div class=\"line\"></div><div class=\"line\">\tlocation / &#123;</div><div class=\"line\">\t\tproxy_set_header\tX-Real-IP $remote_addr;</div><div class=\"line\">\t\tproxy_set_header\tHost\t$http_host;</div><div class=\"line\">\t\tproxy_pass\t\t\thttp://127.0.0.1:2080;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"This-is-my-nginx-config\"><a href=\"#This-is-my-nginx-config\" class=\"headerlink\" title=\"This is my nginx config.\"></a>This is my nginx config.</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">server &#123;</div><div class=\"line\">\tlisten blog.ultraera.org:80;</div><div class=\"line\">\tserver_name blog.ultraera.org;</div><div class=\"line\"></div><div class=\"line\">\tlocation / &#123;</div><div class=\"line\">\t\tproxy_set_header\tX-Real-IP $remote_addr;</div><div class=\"line\">\t\tproxy_set_header\tHost\t$http_host;</div><div class=\"line\">\t\tproxy_pass\t\t\thttp://127.0.0.1:2368;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">server &#123;</div><div class=\"line\">\tlisten piwik.ultraera.org:80;</div><div class=\"line\">\tserver_name piwik.ultraera.org;</div><div class=\"line\"></div><div class=\"line\">\tlocation / &#123;</div><div class=\"line\">\t\tproxy_set_header\tX-Real-IP $remote_addr;</div><div class=\"line\">\t\tproxy_set_header\tHost\t$http_host;</div><div class=\"line\">\t\tproxy_pass\t\t\thttp://127.0.0.1:2080;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Monitor Tomcat Head-Memory for Zabbix","id":"121","updated":"2017-04-21T05:17:46.000Z","date":"2017-01-18T15:28:44.000Z","_content":"\n最近项目上由于BUG问题导致Tomcat程序在运行过程中经常内存泄漏,而本身监控系统之中没有更好的检测到Tomcat堆空间(Head Memory)的使用情况导致报警频发，这篇文章主要讲述，如何在Zabbix之中调用jmx监控服务器上Tomcat堆空间的使用情况并增加对应报警功能。\n\n> 测试环境: <br>\n> CentOS 6.8 <br>\n> Zabbix 2.4 <br>\n> Tomcat 7.0 <br>\n\n实验前提默认是各位已经安装Zabbix Server服务器，并且至少有一台Zabbix agent服务器正常监控。关于如何搭建Zabbix监控集群，会有专门文章描述。\n\n####   zabbix-java-gateway的工作机制\n* 首先我们需要配置我们的Tomcat服务启用监控服务，这个是默认不启用的\n* 之后需要在Zabbix的管理页面添加对应Tomcat服务器的jmx监控接口\n* 最后zabbix端会自动获取zabbix-java-gateway的数据并根据相应模板进行展\n示\n* 工作流: [Zabbix-Server]-->(port:10053 on zabbix server)--> [zabbix-java-gateway] --(port:12345 on tomcatserver)--> [JMX enabled]\n\n#### 1. Install zabbix-java-gateway on Zabbix Server\n因为我的zabbix是使用zabbix 2.4官方源安装，所以只需要用yum在安装即可:\n```\n[root@6 ~]# sudo  yum install -y zabbix-java-gateway\n```\n如果你没有官方源可能先安装该源，注意我的服务器zabbix版本是2.4 如果你是不同的版本，请到[[这里](http://repo.zabbix.com/zabbix/)]查找对应版本。\n```\n# 查看zabbix server版本\n[root@6 ~]# zabbix_server --version\nZabbix server v2.4.8 (revision 59539) (20 April 2016)\nCompilation time: May  4 2016 01:32:12\n```\n\n在使用yum安装zabbix-java-gateway源时,会自动关联安装openjdk，尽管这段程序没多大影响，如果你想保证系统JAVA环境不受到改变的话，可以在/etc/profile文件最后，增加如下内容:\n```\n# add follows to the end\nexport JAVA_HOME=/usr/java/default\nexport PATH=$PATH:$JAVA_HOME/bin\nexport CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar\n```\n\n#### 2. Confiure Tomcat host with enable jmx\n首先在$tomcatdir/bin/catalina.sh文件开头处增加如下：\n```\n#!/bin/sh\n\nCATALINA_OPTS=\"-Dcom.sun.management.jmxremote \\\n-Dcom.sun.management.jmxremote.authenticate=false \\\n-Dcom.sun.management.jmxremote.ssl=false \\\n-Dcom.sun.management.jmxremote.port=12345\"\n```\n然后,启动Tomcat，你会发现多了一个12345端口，这就是jmx的监听端口，请保证zabbix-java-gateway可以访问到这台服务器。\n```\n[root@6 ~]# /tomcat7/bin/startup.sh\nStarting Tomcat7:\nUsing CATALINA_BASE:   /tomcat7\nUsing CATALINA_HOME:   /tomcat7\nUsing CATALINA_TMPDIR: /tomcat7/temp\nUsing JRE_HOME:        /usr\nUsing CLASSPATH:       /tomcat7/bin/bootstrap.jar:/tomcat7/bin/tomcat-juli.jar\nTomcat started.\n\n[root@6 ~]# netstat -ntlp | grep 12345\ntcp  0      0 :::12345   :::*     LISTEN      8793/java\n[root@6 ~]#\n```\n<hr>\n#### ==*fix 1* == : zabbix agent与server存在复杂网络环境\n\n这里疏忽了1个问题，如果您的zabbix server与agent端之间有防火墙规则，而按照我上面的所述只是增加了12345这个端口，那么很可能，您在/var/log/zabbix/zabbix_java_gateway.log 中会看到“No route to host”的报错，这是因为JMX不光开启了12345端口，还开启了另外两个随机端口，而在获取监控数据时会使用到其中一个，这就导致了无法通过固定的防火墙规则来开放该端口。其实有另外一个替代方式来使该监听端口固定下来——使用Tomcat提供的额外组件 catalina-jmx-remote.jar，这个组件是需要另外下载的：\n\n```\n# 查看当前Tomcat版本.\n[root@6 bin]# ./catalina.sh version\nUsing CATALINA_BASE:   /tomcat7\nUsing CATALINA_HOME:   /tomcat7\nUsing CATALINA_TMPDIR: /tomcat7/temp\nUsing JRE_HOME:        /usr\nUsing CLASSPATH:       /tomcat7/bin/bootstrap.jar:/tomcat7/bin/tomcat-juli.jar\nServer version: Apache Tomcat/7.0.64\nServer built:   Aug 19 2015 17:18:06 UTC\nServer number:  7.0.64.0\nOS Name:        Linux\nOS Version:     2.6.32-642.11.1.el6.x86_64\nArchitecture:   amd64\nJVM Version:    1.8.0_111-b15\nJVM Vendor:     Oracle Corporation\n\n# 下载 catalina-jmx-remote.jar # 请注意下载版本不要高于当前tomcat版本.\nwget http://mirror.bit.edu.cn/apache/tomcat/tomcat-7/v7.0.57/bin/extras/catalina-jmx-remote.jar -O lib/catalina-jmx-remote.jar\n```\n\n增加如下内容，在conf/server.xml中：\n```\n<Listener className=\"org.apache.catalina.mbeans.JmxRemoteLifecycleListener\"\n          rmiRegistryPortPlatform=\"12345\" rmiServerPortPlatform=\"12346\" />\n```\n\n因为我们已经在conf/server.xml定义了rmiRegistryPortPlatform，所以要将bin/catalina.sh中CATALINA_OPTS的com.sun.management.jmxremote.port去掉，否则会因为jmxremote.port配置有优先级更高而导致配置失效。\n```\nCATALINA_OPTS=\"-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false\"\n```\n\n完成之后，重启tomcat这时会发现jmx默认端口已经固定为12345何12346，而server依然可以正常获取监控数据.\n\n<hr>\n#### 3. Configure Zabbix Server\n首先需要修改zabbix_server.conf启用zabbix-java-gateway，让zabbix可以检测到服务,修改如下:\n```\n### Option: JavaGateway\n #       IP address (or hostname) of Zabbix Java gateway.\n #       Only required if Java pollers are started.\n #\n # Mandatory: no\n # Default:\nJavaGateway=10.211.55.4 # 设置为你的zabbixsever IP\n\n ### Option: JavaGatewayPort\n #       Port that Zabbix Java gateway listens on.\n #\n # Mandatory: no\n # Range: 1024-32767\n # Default:\n JavaGatewayPort=10053 # 设置服务端监听接口\n\n ### Option: StartJavaPollers\n #       Number of pre-forked instances of Java pollers.\n #\n # Mandatory: no\n # Range: 0-1000\n # Default:\n StartJavaPollers=5 # 设置多线程启动\n```\n然后修改zabbix\\_java\\_gateway.conf 配置如下:\n```\n ### Option: zabbix.listenIP\n #       IP address to listen on.\n #\n # Mandatory: no\n # Default:\n LISTEN_IP=\"10.211.55.4\" # 配置监听IP\n\n ### Option: zabbix.listenPort\n #       Port to listen on.\n #\n # Mandatory: no\n # Range: 1024-32767\n # Default:\n LISTEN_PORT=10053 # 配置监听端口\n\n ### Option: zabbix.pidFile\n #       Name of PID file.\n #       If omitted, Zabbix Java Gateway is started as a console application.\n #\n # Mandatory: no\n # Default:\n # PID_FILE=\n\n PID_FILE=\"/var/run/zabbix/zabbix_java.pid\"\n\n ### Option: zabbix.startPollers\n #       Number of worker threads to start.\n #\n # Mandatory: no\n # Range: 1-1000\n # Default:\n# 不能大于zabbix_server.conf的值，否则可能导致当连接Java gateway时没有多余的线程进行处理\n START_POLLERS=5\n```\n\n最后启动启动zabbix-java-gateway，并重启zabbix-server\n```\n[root@6 ~]# service zabbix-java-gateway start\nStarting zabbix java gateway:              [  OK  ]\n[root@6 ~]# service zabbix-server restart\nStopping zabbix server:              [  OK  ]\nStarting zabbix server:              [  OK  ]\n```\n\n我在尝试重启发现一问题，zabbix-java-gateway通过service命令管理stop不能删除pid文件导致服务无法启动，如果你也碰到，解决办法如下:\n```\n[root@6 zabbix]# vim /etc/rc.d/init.d/zabbix-java-gateway\n# line 97, 注释修改为如下：\n#       kill `cat $PID_FILE` && rm $PID_FILE\n        rm -f $PID_FILE\n```\n\n\n#### 4. Adding jmx host on Zabbix Web consloe\n首先，上传Template Tomcat Head Memory模板，这个我做了一个简单的模板，只针对了堆内存空间的监控，并针对使用率超过60%以及80%，不同的警报。需要的同学可以直接从我这里下载，然后在Configuration-Templates导入到zabbix模板库内。<br>\n下载请点击:[Template App Tomcat Head Memory](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zbx_template_app_tomcat_head_memory.xml)\n\n然后，增加服务器的jmx监控<br>\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-jmx-settings.png)\n<br>\n关联模板<br>\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-host-select-template.png)\n\n\n#### 5. View the Head Memory Monitoring.\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-view-monitor.png)\n\n\n\n\n\n\n","source":"_posts/HowTo-Monitor-Tomcat-Head-Memory-for-Zabbix.md","raw":"---\ntitle: HowTo Monitor Tomcat Head-Memory for Zabbix\ntags: 'Zabbix'\ncategories: 'Zabbix'\npermalink: zabbix01-monitor-tomcat-head-memory-jmx\nid: 121\nupdated: '2017-04-21 13:17:46'\ndate: 2017-01-18 23:28:44\n---\n\n最近项目上由于BUG问题导致Tomcat程序在运行过程中经常内存泄漏,而本身监控系统之中没有更好的检测到Tomcat堆空间(Head Memory)的使用情况导致报警频发，这篇文章主要讲述，如何在Zabbix之中调用jmx监控服务器上Tomcat堆空间的使用情况并增加对应报警功能。\n\n> 测试环境: <br>\n> CentOS 6.8 <br>\n> Zabbix 2.4 <br>\n> Tomcat 7.0 <br>\n\n实验前提默认是各位已经安装Zabbix Server服务器，并且至少有一台Zabbix agent服务器正常监控。关于如何搭建Zabbix监控集群，会有专门文章描述。\n\n####   zabbix-java-gateway的工作机制\n* 首先我们需要配置我们的Tomcat服务启用监控服务，这个是默认不启用的\n* 之后需要在Zabbix的管理页面添加对应Tomcat服务器的jmx监控接口\n* 最后zabbix端会自动获取zabbix-java-gateway的数据并根据相应模板进行展\n示\n* 工作流: [Zabbix-Server]-->(port:10053 on zabbix server)--> [zabbix-java-gateway] --(port:12345 on tomcatserver)--> [JMX enabled]\n\n#### 1. Install zabbix-java-gateway on Zabbix Server\n因为我的zabbix是使用zabbix 2.4官方源安装，所以只需要用yum在安装即可:\n```\n[root@6 ~]# sudo  yum install -y zabbix-java-gateway\n```\n如果你没有官方源可能先安装该源，注意我的服务器zabbix版本是2.4 如果你是不同的版本，请到[[这里](http://repo.zabbix.com/zabbix/)]查找对应版本。\n```\n# 查看zabbix server版本\n[root@6 ~]# zabbix_server --version\nZabbix server v2.4.8 (revision 59539) (20 April 2016)\nCompilation time: May  4 2016 01:32:12\n```\n\n在使用yum安装zabbix-java-gateway源时,会自动关联安装openjdk，尽管这段程序没多大影响，如果你想保证系统JAVA环境不受到改变的话，可以在/etc/profile文件最后，增加如下内容:\n```\n# add follows to the end\nexport JAVA_HOME=/usr/java/default\nexport PATH=$PATH:$JAVA_HOME/bin\nexport CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar\n```\n\n#### 2. Confiure Tomcat host with enable jmx\n首先在$tomcatdir/bin/catalina.sh文件开头处增加如下：\n```\n#!/bin/sh\n\nCATALINA_OPTS=\"-Dcom.sun.management.jmxremote \\\n-Dcom.sun.management.jmxremote.authenticate=false \\\n-Dcom.sun.management.jmxremote.ssl=false \\\n-Dcom.sun.management.jmxremote.port=12345\"\n```\n然后,启动Tomcat，你会发现多了一个12345端口，这就是jmx的监听端口，请保证zabbix-java-gateway可以访问到这台服务器。\n```\n[root@6 ~]# /tomcat7/bin/startup.sh\nStarting Tomcat7:\nUsing CATALINA_BASE:   /tomcat7\nUsing CATALINA_HOME:   /tomcat7\nUsing CATALINA_TMPDIR: /tomcat7/temp\nUsing JRE_HOME:        /usr\nUsing CLASSPATH:       /tomcat7/bin/bootstrap.jar:/tomcat7/bin/tomcat-juli.jar\nTomcat started.\n\n[root@6 ~]# netstat -ntlp | grep 12345\ntcp  0      0 :::12345   :::*     LISTEN      8793/java\n[root@6 ~]#\n```\n<hr>\n#### ==*fix 1* == : zabbix agent与server存在复杂网络环境\n\n这里疏忽了1个问题，如果您的zabbix server与agent端之间有防火墙规则，而按照我上面的所述只是增加了12345这个端口，那么很可能，您在/var/log/zabbix/zabbix_java_gateway.log 中会看到“No route to host”的报错，这是因为JMX不光开启了12345端口，还开启了另外两个随机端口，而在获取监控数据时会使用到其中一个，这就导致了无法通过固定的防火墙规则来开放该端口。其实有另外一个替代方式来使该监听端口固定下来——使用Tomcat提供的额外组件 catalina-jmx-remote.jar，这个组件是需要另外下载的：\n\n```\n# 查看当前Tomcat版本.\n[root@6 bin]# ./catalina.sh version\nUsing CATALINA_BASE:   /tomcat7\nUsing CATALINA_HOME:   /tomcat7\nUsing CATALINA_TMPDIR: /tomcat7/temp\nUsing JRE_HOME:        /usr\nUsing CLASSPATH:       /tomcat7/bin/bootstrap.jar:/tomcat7/bin/tomcat-juli.jar\nServer version: Apache Tomcat/7.0.64\nServer built:   Aug 19 2015 17:18:06 UTC\nServer number:  7.0.64.0\nOS Name:        Linux\nOS Version:     2.6.32-642.11.1.el6.x86_64\nArchitecture:   amd64\nJVM Version:    1.8.0_111-b15\nJVM Vendor:     Oracle Corporation\n\n# 下载 catalina-jmx-remote.jar # 请注意下载版本不要高于当前tomcat版本.\nwget http://mirror.bit.edu.cn/apache/tomcat/tomcat-7/v7.0.57/bin/extras/catalina-jmx-remote.jar -O lib/catalina-jmx-remote.jar\n```\n\n增加如下内容，在conf/server.xml中：\n```\n<Listener className=\"org.apache.catalina.mbeans.JmxRemoteLifecycleListener\"\n          rmiRegistryPortPlatform=\"12345\" rmiServerPortPlatform=\"12346\" />\n```\n\n因为我们已经在conf/server.xml定义了rmiRegistryPortPlatform，所以要将bin/catalina.sh中CATALINA_OPTS的com.sun.management.jmxremote.port去掉，否则会因为jmxremote.port配置有优先级更高而导致配置失效。\n```\nCATALINA_OPTS=\"-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false\"\n```\n\n完成之后，重启tomcat这时会发现jmx默认端口已经固定为12345何12346，而server依然可以正常获取监控数据.\n\n<hr>\n#### 3. Configure Zabbix Server\n首先需要修改zabbix_server.conf启用zabbix-java-gateway，让zabbix可以检测到服务,修改如下:\n```\n### Option: JavaGateway\n #       IP address (or hostname) of Zabbix Java gateway.\n #       Only required if Java pollers are started.\n #\n # Mandatory: no\n # Default:\nJavaGateway=10.211.55.4 # 设置为你的zabbixsever IP\n\n ### Option: JavaGatewayPort\n #       Port that Zabbix Java gateway listens on.\n #\n # Mandatory: no\n # Range: 1024-32767\n # Default:\n JavaGatewayPort=10053 # 设置服务端监听接口\n\n ### Option: StartJavaPollers\n #       Number of pre-forked instances of Java pollers.\n #\n # Mandatory: no\n # Range: 0-1000\n # Default:\n StartJavaPollers=5 # 设置多线程启动\n```\n然后修改zabbix\\_java\\_gateway.conf 配置如下:\n```\n ### Option: zabbix.listenIP\n #       IP address to listen on.\n #\n # Mandatory: no\n # Default:\n LISTEN_IP=\"10.211.55.4\" # 配置监听IP\n\n ### Option: zabbix.listenPort\n #       Port to listen on.\n #\n # Mandatory: no\n # Range: 1024-32767\n # Default:\n LISTEN_PORT=10053 # 配置监听端口\n\n ### Option: zabbix.pidFile\n #       Name of PID file.\n #       If omitted, Zabbix Java Gateway is started as a console application.\n #\n # Mandatory: no\n # Default:\n # PID_FILE=\n\n PID_FILE=\"/var/run/zabbix/zabbix_java.pid\"\n\n ### Option: zabbix.startPollers\n #       Number of worker threads to start.\n #\n # Mandatory: no\n # Range: 1-1000\n # Default:\n# 不能大于zabbix_server.conf的值，否则可能导致当连接Java gateway时没有多余的线程进行处理\n START_POLLERS=5\n```\n\n最后启动启动zabbix-java-gateway，并重启zabbix-server\n```\n[root@6 ~]# service zabbix-java-gateway start\nStarting zabbix java gateway:              [  OK  ]\n[root@6 ~]# service zabbix-server restart\nStopping zabbix server:              [  OK  ]\nStarting zabbix server:              [  OK  ]\n```\n\n我在尝试重启发现一问题，zabbix-java-gateway通过service命令管理stop不能删除pid文件导致服务无法启动，如果你也碰到，解决办法如下:\n```\n[root@6 zabbix]# vim /etc/rc.d/init.d/zabbix-java-gateway\n# line 97, 注释修改为如下：\n#       kill `cat $PID_FILE` && rm $PID_FILE\n        rm -f $PID_FILE\n```\n\n\n#### 4. Adding jmx host on Zabbix Web consloe\n首先，上传Template Tomcat Head Memory模板，这个我做了一个简单的模板，只针对了堆内存空间的监控，并针对使用率超过60%以及80%，不同的警报。需要的同学可以直接从我这里下载，然后在Configuration-Templates导入到zabbix模板库内。<br>\n下载请点击:[Template App Tomcat Head Memory](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zbx_template_app_tomcat_head_memory.xml)\n\n然后，增加服务器的jmx监控<br>\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-jmx-settings.png)\n<br>\n关联模板<br>\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-host-select-template.png)\n\n\n#### 5. View the Head Memory Monitoring.\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-view-monitor.png)\n\n\n\n\n\n\n","slug":"zabbix01-monitor-tomcat-head-memory-jmx","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq90002t41tpw0ceisfs","content":"<p>最近项目上由于BUG问题导致Tomcat程序在运行过程中经常内存泄漏,而本身监控系统之中没有更好的检测到Tomcat堆空间(Head Memory)的使用情况导致报警频发，这篇文章主要讲述，如何在Zabbix之中调用jmx监控服务器上Tomcat堆空间的使用情况并增加对应报警功能。</p>\n<blockquote>\n<p>测试环境: <br><br>CentOS 6.8 <br><br>Zabbix 2.4 <br><br>Tomcat 7.0 <br></p>\n</blockquote>\n<p>实验前提默认是各位已经安装Zabbix Server服务器，并且至少有一台Zabbix agent服务器正常监控。关于如何搭建Zabbix监控集群，会有专门文章描述。</p>\n<h4 id=\"zabbix-java-gateway的工作机制\"><a href=\"#zabbix-java-gateway的工作机制\" class=\"headerlink\" title=\"zabbix-java-gateway的工作机制\"></a>zabbix-java-gateway的工作机制</h4><ul>\n<li>首先我们需要配置我们的Tomcat服务启用监控服务，这个是默认不启用的</li>\n<li>之后需要在Zabbix的管理页面添加对应Tomcat服务器的jmx监控接口</li>\n<li>最后zabbix端会自动获取zabbix-java-gateway的数据并根据相应模板进行展<br>示</li>\n<li>工作流: [Zabbix-Server]–&gt;(port:10053 on zabbix server)–&gt; [zabbix-java-gateway] –(port:12345 on tomcatserver)–&gt; [JMX enabled]</li>\n</ul>\n<h4 id=\"1-Install-zabbix-java-gateway-on-Zabbix-Server\"><a href=\"#1-Install-zabbix-java-gateway-on-Zabbix-Server\" class=\"headerlink\" title=\"1. Install zabbix-java-gateway on Zabbix Server\"></a>1. Install zabbix-java-gateway on Zabbix Server</h4><p>因为我的zabbix是使用zabbix 2.4官方源安装，所以只需要用yum在安装即可:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# sudo  yum install -y zabbix-java-gateway</div></pre></td></tr></table></figure></p>\n<p>如果你没有官方源可能先安装该源，注意我的服务器zabbix版本是2.4 如果你是不同的版本，请到[<a href=\"http://repo.zabbix.com/zabbix/\" target=\"_blank\" rel=\"external\">这里</a>]查找对应版本。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 查看zabbix server版本</div><div class=\"line\">[root@6 ~]# zabbix_server --version</div><div class=\"line\">Zabbix server v2.4.8 (revision 59539) (20 April 2016)</div><div class=\"line\">Compilation time: May  4 2016 01:32:12</div></pre></td></tr></table></figure></p>\n<p>在使用yum安装zabbix-java-gateway源时,会自动关联安装openjdk，尽管这段程序没多大影响，如果你想保证系统JAVA环境不受到改变的话，可以在/etc/profile文件最后，增加如下内容:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># add follows to the end</div><div class=\"line\">export JAVA_HOME=/usr/java/default</div><div class=\"line\">export PATH=$PATH:$JAVA_HOME/bin</div><div class=\"line\">export CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar</div></pre></td></tr></table></figure></p>\n<h4 id=\"2-Confiure-Tomcat-host-with-enable-jmx\"><a href=\"#2-Confiure-Tomcat-host-with-enable-jmx\" class=\"headerlink\" title=\"2. Confiure Tomcat host with enable jmx\"></a>2. Confiure Tomcat host with enable jmx</h4><p>首先在$tomcatdir/bin/catalina.sh文件开头处增加如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/sh</div><div class=\"line\"></div><div class=\"line\">CATALINA_OPTS=&quot;-Dcom.sun.management.jmxremote \\</div><div class=\"line\">-Dcom.sun.management.jmxremote.authenticate=false \\</div><div class=\"line\">-Dcom.sun.management.jmxremote.ssl=false \\</div><div class=\"line\">-Dcom.sun.management.jmxremote.port=12345&quot;</div></pre></td></tr></table></figure></p>\n<p>然后,启动Tomcat，你会发现多了一个12345端口，这就是jmx的监听端口，请保证zabbix-java-gateway可以访问到这台服务器。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# /tomcat7/bin/startup.sh</div><div class=\"line\">Starting Tomcat7:</div><div class=\"line\">Using CATALINA_BASE:   /tomcat7</div><div class=\"line\">Using CATALINA_HOME:   /tomcat7</div><div class=\"line\">Using CATALINA_TMPDIR: /tomcat7/temp</div><div class=\"line\">Using JRE_HOME:        /usr</div><div class=\"line\">Using CLASSPATH:       /tomcat7/bin/bootstrap.jar:/tomcat7/bin/tomcat-juli.jar</div><div class=\"line\">Tomcat started.</div><div class=\"line\"></div><div class=\"line\">[root@6 ~]# netstat -ntlp | grep 12345</div><div class=\"line\">tcp  0      0 :::12345   :::*     LISTEN      8793/java</div><div class=\"line\">[root@6 ~]#</div></pre></td></tr></table></figure></p>\n<p><hr></p>\n<h4 id=\"fix-1-zabbix-agent与server存在复杂网络环境\"><a href=\"#fix-1-zabbix-agent与server存在复杂网络环境\" class=\"headerlink\" title=\"==fix 1 == : zabbix agent与server存在复杂网络环境\"></a>==<em>fix 1</em> == : zabbix agent与server存在复杂网络环境</h4><p>这里疏忽了1个问题，如果您的zabbix server与agent端之间有防火墙规则，而按照我上面的所述只是增加了12345这个端口，那么很可能，您在/var/log/zabbix/zabbix_java_gateway.log 中会看到“No route to host”的报错，这是因为JMX不光开启了12345端口，还开启了另外两个随机端口，而在获取监控数据时会使用到其中一个，这就导致了无法通过固定的防火墙规则来开放该端口。其实有另外一个替代方式来使该监听端口固定下来——使用Tomcat提供的额外组件 catalina-jmx-remote.jar，这个组件是需要另外下载的：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 查看当前Tomcat版本.</div><div class=\"line\">[root@6 bin]# ./catalina.sh version</div><div class=\"line\">Using CATALINA_BASE:   /tomcat7</div><div class=\"line\">Using CATALINA_HOME:   /tomcat7</div><div class=\"line\">Using CATALINA_TMPDIR: /tomcat7/temp</div><div class=\"line\">Using JRE_HOME:        /usr</div><div class=\"line\">Using CLASSPATH:       /tomcat7/bin/bootstrap.jar:/tomcat7/bin/tomcat-juli.jar</div><div class=\"line\">Server version: Apache Tomcat/7.0.64</div><div class=\"line\">Server built:   Aug 19 2015 17:18:06 UTC</div><div class=\"line\">Server number:  7.0.64.0</div><div class=\"line\">OS Name:        Linux</div><div class=\"line\">OS Version:     2.6.32-642.11.1.el6.x86_64</div><div class=\"line\">Architecture:   amd64</div><div class=\"line\">JVM Version:    1.8.0_111-b15</div><div class=\"line\">JVM Vendor:     Oracle Corporation</div><div class=\"line\"></div><div class=\"line\"># 下载 catalina-jmx-remote.jar # 请注意下载版本不要高于当前tomcat版本.</div><div class=\"line\">wget http://mirror.bit.edu.cn/apache/tomcat/tomcat-7/v7.0.57/bin/extras/catalina-jmx-remote.jar -O lib/catalina-jmx-remote.jar</div></pre></td></tr></table></figure>\n<p>增加如下内容，在conf/server.xml中：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;Listener className=&quot;org.apache.catalina.mbeans.JmxRemoteLifecycleListener&quot;</div><div class=\"line\">          rmiRegistryPortPlatform=&quot;12345&quot; rmiServerPortPlatform=&quot;12346&quot; /&gt;</div></pre></td></tr></table></figure></p>\n<p>因为我们已经在conf/server.xml定义了rmiRegistryPortPlatform，所以要将bin/catalina.sh中CATALINA_OPTS的com.sun.management.jmxremote.port去掉，否则会因为jmxremote.port配置有优先级更高而导致配置失效。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">CATALINA_OPTS=&quot;-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false&quot;</div></pre></td></tr></table></figure></p>\n<p>完成之后，重启tomcat这时会发现jmx默认端口已经固定为12345何12346，而server依然可以正常获取监控数据.</p>\n<p><hr></p>\n<h4 id=\"3-Configure-Zabbix-Server\"><a href=\"#3-Configure-Zabbix-Server\" class=\"headerlink\" title=\"3. Configure Zabbix Server\"></a>3. Configure Zabbix Server</h4><p>首先需要修改zabbix_server.conf启用zabbix-java-gateway，让zabbix可以检测到服务,修改如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">### Option: JavaGateway</div><div class=\"line\"> #       IP address (or hostname) of Zabbix Java gateway.</div><div class=\"line\"> #       Only required if Java pollers are started.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Default:</div><div class=\"line\">JavaGateway=10.211.55.4 # 设置为你的zabbixsever IP</div><div class=\"line\"></div><div class=\"line\"> ### Option: JavaGatewayPort</div><div class=\"line\"> #       Port that Zabbix Java gateway listens on.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Range: 1024-32767</div><div class=\"line\"> # Default:</div><div class=\"line\"> JavaGatewayPort=10053 # 设置服务端监听接口</div><div class=\"line\"></div><div class=\"line\"> ### Option: StartJavaPollers</div><div class=\"line\"> #       Number of pre-forked instances of Java pollers.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Range: 0-1000</div><div class=\"line\"> # Default:</div><div class=\"line\"> StartJavaPollers=5 # 设置多线程启动</div></pre></td></tr></table></figure></p>\n<p>然后修改zabbix_java_gateway.conf 配置如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\"> ### Option: zabbix.listenIP</div><div class=\"line\"> #       IP address to listen on.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Default:</div><div class=\"line\"> LISTEN_IP=&quot;10.211.55.4&quot; # 配置监听IP</div><div class=\"line\"></div><div class=\"line\"> ### Option: zabbix.listenPort</div><div class=\"line\"> #       Port to listen on.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Range: 1024-32767</div><div class=\"line\"> # Default:</div><div class=\"line\"> LISTEN_PORT=10053 # 配置监听端口</div><div class=\"line\"></div><div class=\"line\"> ### Option: zabbix.pidFile</div><div class=\"line\"> #       Name of PID file.</div><div class=\"line\"> #       If omitted, Zabbix Java Gateway is started as a console application.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Default:</div><div class=\"line\"> # PID_FILE=</div><div class=\"line\"></div><div class=\"line\"> PID_FILE=&quot;/var/run/zabbix/zabbix_java.pid&quot;</div><div class=\"line\"></div><div class=\"line\"> ### Option: zabbix.startPollers</div><div class=\"line\"> #       Number of worker threads to start.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Range: 1-1000</div><div class=\"line\"> # Default:</div><div class=\"line\"># 不能大于zabbix_server.conf的值，否则可能导致当连接Java gateway时没有多余的线程进行处理</div><div class=\"line\"> START_POLLERS=5</div></pre></td></tr></table></figure></p>\n<p>最后启动启动zabbix-java-gateway，并重启zabbix-server<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# service zabbix-java-gateway start</div><div class=\"line\">Starting zabbix java gateway:              [  OK  ]</div><div class=\"line\">[root@6 ~]# service zabbix-server restart</div><div class=\"line\">Stopping zabbix server:              [  OK  ]</div><div class=\"line\">Starting zabbix server:              [  OK  ]</div></pre></td></tr></table></figure></p>\n<p>我在尝试重启发现一问题，zabbix-java-gateway通过service命令管理stop不能删除pid文件导致服务无法启动，如果你也碰到，解决办法如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 zabbix]# vim /etc/rc.d/init.d/zabbix-java-gateway</div><div class=\"line\"># line 97, 注释修改为如下：</div><div class=\"line\">#       kill `cat $PID_FILE` &amp;&amp; rm $PID_FILE</div><div class=\"line\">        rm -f $PID_FILE</div></pre></td></tr></table></figure></p>\n<h4 id=\"4-Adding-jmx-host-on-Zabbix-Web-consloe\"><a href=\"#4-Adding-jmx-host-on-Zabbix-Web-consloe\" class=\"headerlink\" title=\"4. Adding jmx host on Zabbix Web consloe\"></a>4. Adding jmx host on Zabbix Web consloe</h4><p>首先，上传Template Tomcat Head Memory模板，这个我做了一个简单的模板，只针对了堆内存空间的监控，并针对使用率超过60%以及80%，不同的警报。需要的同学可以直接从我这里下载，然后在Configuration-Templates导入到zabbix模板库内。<br><br>下载请点击:<a href=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zbx_template_app_tomcat_head_memory.xml\" target=\"_blank\" rel=\"external\">Template App Tomcat Head Memory</a></p>\n<p>然后，增加服务器的jmx监控<br><br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-jmx-settings.png\" alt=\"\"><br><br><br>关联模板<br><br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-host-select-template.png\" alt=\"\"></p>\n<h4 id=\"5-View-the-Head-Memory-Monitoring\"><a href=\"#5-View-the-Head-Memory-Monitoring\" class=\"headerlink\" title=\"5. View the Head Memory Monitoring.\"></a>5. View the Head Memory Monitoring.</h4><p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-view-monitor.png\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>最近项目上由于BUG问题导致Tomcat程序在运行过程中经常内存泄漏,而本身监控系统之中没有更好的检测到Tomcat堆空间(Head Memory)的使用情况导致报警频发，这篇文章主要讲述，如何在Zabbix之中调用jmx监控服务器上Tomcat堆空间的使用情况并增加对应报警功能。</p>\n<blockquote>\n<p>测试环境: <br><br>CentOS 6.8 <br><br>Zabbix 2.4 <br><br>Tomcat 7.0 <br></p>\n</blockquote>\n<p>实验前提默认是各位已经安装Zabbix Server服务器，并且至少有一台Zabbix agent服务器正常监控。关于如何搭建Zabbix监控集群，会有专门文章描述。</p>\n<h4 id=\"zabbix-java-gateway的工作机制\"><a href=\"#zabbix-java-gateway的工作机制\" class=\"headerlink\" title=\"zabbix-java-gateway的工作机制\"></a>zabbix-java-gateway的工作机制</h4><ul>\n<li>首先我们需要配置我们的Tomcat服务启用监控服务，这个是默认不启用的</li>\n<li>之后需要在Zabbix的管理页面添加对应Tomcat服务器的jmx监控接口</li>\n<li>最后zabbix端会自动获取zabbix-java-gateway的数据并根据相应模板进行展<br>示</li>\n<li>工作流: [Zabbix-Server]–&gt;(port:10053 on zabbix server)–&gt; [zabbix-java-gateway] –(port:12345 on tomcatserver)–&gt; [JMX enabled]</li>\n</ul>\n<h4 id=\"1-Install-zabbix-java-gateway-on-Zabbix-Server\"><a href=\"#1-Install-zabbix-java-gateway-on-Zabbix-Server\" class=\"headerlink\" title=\"1. Install zabbix-java-gateway on Zabbix Server\"></a>1. Install zabbix-java-gateway on Zabbix Server</h4><p>因为我的zabbix是使用zabbix 2.4官方源安装，所以只需要用yum在安装即可:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# sudo  yum install -y zabbix-java-gateway</div></pre></td></tr></table></figure></p>\n<p>如果你没有官方源可能先安装该源，注意我的服务器zabbix版本是2.4 如果你是不同的版本，请到[<a href=\"http://repo.zabbix.com/zabbix/\">这里</a>]查找对应版本。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 查看zabbix server版本</div><div class=\"line\">[root@6 ~]# zabbix_server --version</div><div class=\"line\">Zabbix server v2.4.8 (revision 59539) (20 April 2016)</div><div class=\"line\">Compilation time: May  4 2016 01:32:12</div></pre></td></tr></table></figure></p>\n<p>在使用yum安装zabbix-java-gateway源时,会自动关联安装openjdk，尽管这段程序没多大影响，如果你想保证系统JAVA环境不受到改变的话，可以在/etc/profile文件最后，增加如下内容:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># add follows to the end</div><div class=\"line\">export JAVA_HOME=/usr/java/default</div><div class=\"line\">export PATH=$PATH:$JAVA_HOME/bin</div><div class=\"line\">export CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar</div></pre></td></tr></table></figure></p>\n<h4 id=\"2-Confiure-Tomcat-host-with-enable-jmx\"><a href=\"#2-Confiure-Tomcat-host-with-enable-jmx\" class=\"headerlink\" title=\"2. Confiure Tomcat host with enable jmx\"></a>2. Confiure Tomcat host with enable jmx</h4><p>首先在$tomcatdir/bin/catalina.sh文件开头处增加如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/sh</div><div class=\"line\"></div><div class=\"line\">CATALINA_OPTS=&quot;-Dcom.sun.management.jmxremote \\</div><div class=\"line\">-Dcom.sun.management.jmxremote.authenticate=false \\</div><div class=\"line\">-Dcom.sun.management.jmxremote.ssl=false \\</div><div class=\"line\">-Dcom.sun.management.jmxremote.port=12345&quot;</div></pre></td></tr></table></figure></p>\n<p>然后,启动Tomcat，你会发现多了一个12345端口，这就是jmx的监听端口，请保证zabbix-java-gateway可以访问到这台服务器。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# /tomcat7/bin/startup.sh</div><div class=\"line\">Starting Tomcat7:</div><div class=\"line\">Using CATALINA_BASE:   /tomcat7</div><div class=\"line\">Using CATALINA_HOME:   /tomcat7</div><div class=\"line\">Using CATALINA_TMPDIR: /tomcat7/temp</div><div class=\"line\">Using JRE_HOME:        /usr</div><div class=\"line\">Using CLASSPATH:       /tomcat7/bin/bootstrap.jar:/tomcat7/bin/tomcat-juli.jar</div><div class=\"line\">Tomcat started.</div><div class=\"line\"></div><div class=\"line\">[root@6 ~]# netstat -ntlp | grep 12345</div><div class=\"line\">tcp  0      0 :::12345   :::*     LISTEN      8793/java</div><div class=\"line\">[root@6 ~]#</div></pre></td></tr></table></figure></p>\n<p><hr></p>\n<h4 id=\"fix-1-zabbix-agent与server存在复杂网络环境\"><a href=\"#fix-1-zabbix-agent与server存在复杂网络环境\" class=\"headerlink\" title=\"==fix 1 == : zabbix agent与server存在复杂网络环境\"></a>==<em>fix 1</em> == : zabbix agent与server存在复杂网络环境</h4><p>这里疏忽了1个问题，如果您的zabbix server与agent端之间有防火墙规则，而按照我上面的所述只是增加了12345这个端口，那么很可能，您在/var/log/zabbix/zabbix_java_gateway.log 中会看到“No route to host”的报错，这是因为JMX不光开启了12345端口，还开启了另外两个随机端口，而在获取监控数据时会使用到其中一个，这就导致了无法通过固定的防火墙规则来开放该端口。其实有另外一个替代方式来使该监听端口固定下来——使用Tomcat提供的额外组件 catalina-jmx-remote.jar，这个组件是需要另外下载的：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 查看当前Tomcat版本.</div><div class=\"line\">[root@6 bin]# ./catalina.sh version</div><div class=\"line\">Using CATALINA_BASE:   /tomcat7</div><div class=\"line\">Using CATALINA_HOME:   /tomcat7</div><div class=\"line\">Using CATALINA_TMPDIR: /tomcat7/temp</div><div class=\"line\">Using JRE_HOME:        /usr</div><div class=\"line\">Using CLASSPATH:       /tomcat7/bin/bootstrap.jar:/tomcat7/bin/tomcat-juli.jar</div><div class=\"line\">Server version: Apache Tomcat/7.0.64</div><div class=\"line\">Server built:   Aug 19 2015 17:18:06 UTC</div><div class=\"line\">Server number:  7.0.64.0</div><div class=\"line\">OS Name:        Linux</div><div class=\"line\">OS Version:     2.6.32-642.11.1.el6.x86_64</div><div class=\"line\">Architecture:   amd64</div><div class=\"line\">JVM Version:    1.8.0_111-b15</div><div class=\"line\">JVM Vendor:     Oracle Corporation</div><div class=\"line\"></div><div class=\"line\"># 下载 catalina-jmx-remote.jar # 请注意下载版本不要高于当前tomcat版本.</div><div class=\"line\">wget http://mirror.bit.edu.cn/apache/tomcat/tomcat-7/v7.0.57/bin/extras/catalina-jmx-remote.jar -O lib/catalina-jmx-remote.jar</div></pre></td></tr></table></figure>\n<p>增加如下内容，在conf/server.xml中：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;Listener className=&quot;org.apache.catalina.mbeans.JmxRemoteLifecycleListener&quot;</div><div class=\"line\">          rmiRegistryPortPlatform=&quot;12345&quot; rmiServerPortPlatform=&quot;12346&quot; /&gt;</div></pre></td></tr></table></figure></p>\n<p>因为我们已经在conf/server.xml定义了rmiRegistryPortPlatform，所以要将bin/catalina.sh中CATALINA_OPTS的com.sun.management.jmxremote.port去掉，否则会因为jmxremote.port配置有优先级更高而导致配置失效。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">CATALINA_OPTS=&quot;-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false&quot;</div></pre></td></tr></table></figure></p>\n<p>完成之后，重启tomcat这时会发现jmx默认端口已经固定为12345何12346，而server依然可以正常获取监控数据.</p>\n<p><hr></p>\n<h4 id=\"3-Configure-Zabbix-Server\"><a href=\"#3-Configure-Zabbix-Server\" class=\"headerlink\" title=\"3. Configure Zabbix Server\"></a>3. Configure Zabbix Server</h4><p>首先需要修改zabbix_server.conf启用zabbix-java-gateway，让zabbix可以检测到服务,修改如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">### Option: JavaGateway</div><div class=\"line\"> #       IP address (or hostname) of Zabbix Java gateway.</div><div class=\"line\"> #       Only required if Java pollers are started.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Default:</div><div class=\"line\">JavaGateway=10.211.55.4 # 设置为你的zabbixsever IP</div><div class=\"line\"></div><div class=\"line\"> ### Option: JavaGatewayPort</div><div class=\"line\"> #       Port that Zabbix Java gateway listens on.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Range: 1024-32767</div><div class=\"line\"> # Default:</div><div class=\"line\"> JavaGatewayPort=10053 # 设置服务端监听接口</div><div class=\"line\"></div><div class=\"line\"> ### Option: StartJavaPollers</div><div class=\"line\"> #       Number of pre-forked instances of Java pollers.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Range: 0-1000</div><div class=\"line\"> # Default:</div><div class=\"line\"> StartJavaPollers=5 # 设置多线程启动</div></pre></td></tr></table></figure></p>\n<p>然后修改zabbix_java_gateway.conf 配置如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\"> ### Option: zabbix.listenIP</div><div class=\"line\"> #       IP address to listen on.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Default:</div><div class=\"line\"> LISTEN_IP=&quot;10.211.55.4&quot; # 配置监听IP</div><div class=\"line\"></div><div class=\"line\"> ### Option: zabbix.listenPort</div><div class=\"line\"> #       Port to listen on.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Range: 1024-32767</div><div class=\"line\"> # Default:</div><div class=\"line\"> LISTEN_PORT=10053 # 配置监听端口</div><div class=\"line\"></div><div class=\"line\"> ### Option: zabbix.pidFile</div><div class=\"line\"> #       Name of PID file.</div><div class=\"line\"> #       If omitted, Zabbix Java Gateway is started as a console application.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Default:</div><div class=\"line\"> # PID_FILE=</div><div class=\"line\"></div><div class=\"line\"> PID_FILE=&quot;/var/run/zabbix/zabbix_java.pid&quot;</div><div class=\"line\"></div><div class=\"line\"> ### Option: zabbix.startPollers</div><div class=\"line\"> #       Number of worker threads to start.</div><div class=\"line\"> #</div><div class=\"line\"> # Mandatory: no</div><div class=\"line\"> # Range: 1-1000</div><div class=\"line\"> # Default:</div><div class=\"line\"># 不能大于zabbix_server.conf的值，否则可能导致当连接Java gateway时没有多余的线程进行处理</div><div class=\"line\"> START_POLLERS=5</div></pre></td></tr></table></figure></p>\n<p>最后启动启动zabbix-java-gateway，并重启zabbix-server<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# service zabbix-java-gateway start</div><div class=\"line\">Starting zabbix java gateway:              [  OK  ]</div><div class=\"line\">[root@6 ~]# service zabbix-server restart</div><div class=\"line\">Stopping zabbix server:              [  OK  ]</div><div class=\"line\">Starting zabbix server:              [  OK  ]</div></pre></td></tr></table></figure></p>\n<p>我在尝试重启发现一问题，zabbix-java-gateway通过service命令管理stop不能删除pid文件导致服务无法启动，如果你也碰到，解决办法如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 zabbix]# vim /etc/rc.d/init.d/zabbix-java-gateway</div><div class=\"line\"># line 97, 注释修改为如下：</div><div class=\"line\">#       kill `cat $PID_FILE` &amp;&amp; rm $PID_FILE</div><div class=\"line\">        rm -f $PID_FILE</div></pre></td></tr></table></figure></p>\n<h4 id=\"4-Adding-jmx-host-on-Zabbix-Web-consloe\"><a href=\"#4-Adding-jmx-host-on-Zabbix-Web-consloe\" class=\"headerlink\" title=\"4. Adding jmx host on Zabbix Web consloe\"></a>4. Adding jmx host on Zabbix Web consloe</h4><p>首先，上传Template Tomcat Head Memory模板，这个我做了一个简单的模板，只针对了堆内存空间的监控，并针对使用率超过60%以及80%，不同的警报。需要的同学可以直接从我这里下载，然后在Configuration-Templates导入到zabbix模板库内。<br><br>下载请点击:<a href=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zbx_template_app_tomcat_head_memory.xml\">Template App Tomcat Head Memory</a></p>\n<p>然后，增加服务器的jmx监控<br><br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-jmx-settings.png\" alt=\"\"><br><br><br>关联模板<br><br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-host-select-template.png\" alt=\"\"></p>\n<h4 id=\"5-View-the-Head-Memory-Monitoring\"><a href=\"#5-View-the-Head-Memory-Monitoring\" class=\"headerlink\" title=\"5. View the Head Memory Monitoring.\"></a>5. View the Head Memory Monitoring.</h4><p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/12/zabbix-view-monitor.png\" alt=\"\"></p>\n"},{"title":"HowTo Monitoring MySQL server for Zabbix","id":"54","updated":"2017-04-21T05:32:36.000Z","date":"2016-05-19T23:24:58.000Z","_content":"\n## 安装插件包\n```\nyum install http://www.percona.com/downloads/percona-release/redhat/0.1-3/percona-release-0.1-3.noarch.rpm -y\nyum install percona-zabbix-templates.noarch -y\nyum install php* -y\n```\n\n## 导入模板\n\n把/var/lib/zabbix/percona/templates/zabbix_agent_template_percona_mysql_server_ht_2.0.9-sver1.1.6.xml 文件拷贝出来，通过Zabbix的监控页面导入:\nConfigurationTemplatesImport(在右上角)\n选择导出的模板文件，点击Import完成导入\n\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/zabbix-mysql01.png)\n\n## 安装Agent\n```\nrpm -ivh http://repo.zabbix.com/zabbix/2.4/rhel/6/x86_64/zabbix-release-2.4-1.el6.noarch.rpm\nyum install zabbix-agent\nvim /etc/zabbix/zabbix-agentd.conf\n#配置监控服务器地址\nServer=192.168.1.15\n#导入配置文件\ncp /var/lib/zabbix/percona/templates/userparameter_percona_mysql.conf /etc/zabbix/zabbix_agentd.d/\n#重启agent\nservice zabbix-agent restart\n\n```\n\n## Mysql新建用户\n\n登陆Mysql数据库，新建一个本地的只有查询权限的mysql用户\ngrant select on *.* to 'percona'@'localhost' identified by 'percona';\nflush tables;\n\n\n## 配置Percona插件\n修改插件使用的mysql用户名密码\nsed -i s/cactiuser/percona/g /var/lib/zabbix/percona/scripts/ss_get_mysql_stats.php\n\n\n## 测试\n测试是否可以获取到值\ncd /var/lib/zabbix/percona/scripts/\n./get_mysql_stats_wrapper.sh gg\n如果获取到值，则说明配置成功\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/zabbix-mysql02.png)\n\n注意：执行完脚本后，请手动删除/tmp/文件夹下生成的*-mysql_cacti_stats.txt文件，然后让程序自己调用创建新文件。\n","source":"_posts/HowTo-Monitoring-MySQL-server-for-Zabbix.md","raw":"---\ntitle: HowTo Monitoring MySQL server for Zabbix\ntags: 'MySQL'\ncategories: 'Zabbix'\npermalink: how-to-use-zabbix-monitoring-mysql-server-on-centos-6-x\nid: 54\nupdated: '2017-04-21 13:32:36'\ndate: 2016-05-20 07:24:58\n---\n\n## 安装插件包\n```\nyum install http://www.percona.com/downloads/percona-release/redhat/0.1-3/percona-release-0.1-3.noarch.rpm -y\nyum install percona-zabbix-templates.noarch -y\nyum install php* -y\n```\n\n## 导入模板\n\n把/var/lib/zabbix/percona/templates/zabbix_agent_template_percona_mysql_server_ht_2.0.9-sver1.1.6.xml 文件拷贝出来，通过Zabbix的监控页面导入:\nConfigurationTemplatesImport(在右上角)\n选择导出的模板文件，点击Import完成导入\n\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/zabbix-mysql01.png)\n\n## 安装Agent\n```\nrpm -ivh http://repo.zabbix.com/zabbix/2.4/rhel/6/x86_64/zabbix-release-2.4-1.el6.noarch.rpm\nyum install zabbix-agent\nvim /etc/zabbix/zabbix-agentd.conf\n#配置监控服务器地址\nServer=192.168.1.15\n#导入配置文件\ncp /var/lib/zabbix/percona/templates/userparameter_percona_mysql.conf /etc/zabbix/zabbix_agentd.d/\n#重启agent\nservice zabbix-agent restart\n\n```\n\n## Mysql新建用户\n\n登陆Mysql数据库，新建一个本地的只有查询权限的mysql用户\ngrant select on *.* to 'percona'@'localhost' identified by 'percona';\nflush tables;\n\n\n## 配置Percona插件\n修改插件使用的mysql用户名密码\nsed -i s/cactiuser/percona/g /var/lib/zabbix/percona/scripts/ss_get_mysql_stats.php\n\n\n## 测试\n测试是否可以获取到值\ncd /var/lib/zabbix/percona/scripts/\n./get_mysql_stats_wrapper.sh gg\n如果获取到值，则说明配置成功\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/zabbix-mysql02.png)\n\n注意：执行完脚本后，请手动删除/tmp/文件夹下生成的*-mysql_cacti_stats.txt文件，然后让程序自己调用创建新文件。\n","slug":"how-to-use-zabbix-monitoring-mysql-server-on-centos-6-x","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq98002x41tp8b41zf9b","content":"<h2 id=\"安装插件包\"><a href=\"#安装插件包\" class=\"headerlink\" title=\"安装插件包\"></a>安装插件包</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install http://www.percona.com/downloads/percona-release/redhat/0.1-3/percona-release-0.1-3.noarch.rpm -y</div><div class=\"line\">yum install percona-zabbix-templates.noarch -y</div><div class=\"line\">yum install php* -y</div></pre></td></tr></table></figure>\n<h2 id=\"导入模板\"><a href=\"#导入模板\" class=\"headerlink\" title=\"导入模板\"></a>导入模板</h2><p>把/var/lib/zabbix/percona/templates/zabbix_agent_template_percona_mysql_server_ht_2.0.9-sver1.1.6.xml 文件拷贝出来，通过Zabbix的监控页面导入:<br>ConfigurationTemplatesImport(在右上角)<br>选择导出的模板文件，点击Import完成导入</p>\n<p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/zabbix-mysql01.png\" alt=\"\"></p>\n<h2 id=\"安装Agent\"><a href=\"#安装Agent\" class=\"headerlink\" title=\"安装Agent\"></a>安装Agent</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -ivh http://repo.zabbix.com/zabbix/2.4/rhel/6/x86_64/zabbix-release-2.4-1.el6.noarch.rpm</div><div class=\"line\">yum install zabbix-agent</div><div class=\"line\">vim /etc/zabbix/zabbix-agentd.conf</div><div class=\"line\">#配置监控服务器地址</div><div class=\"line\">Server=192.168.1.15</div><div class=\"line\">#导入配置文件</div><div class=\"line\">cp /var/lib/zabbix/percona/templates/userparameter_percona_mysql.conf /etc/zabbix/zabbix_agentd.d/</div><div class=\"line\">#重启agent</div><div class=\"line\">service zabbix-agent restart</div></pre></td></tr></table></figure>\n<h2 id=\"Mysql新建用户\"><a href=\"#Mysql新建用户\" class=\"headerlink\" title=\"Mysql新建用户\"></a>Mysql新建用户</h2><p>登陆Mysql数据库，新建一个本地的只有查询权限的mysql用户<br>grant select on <em>.</em> to ‘percona’@’localhost’ identified by ‘percona’;<br>flush tables;</p>\n<h2 id=\"配置Percona插件\"><a href=\"#配置Percona插件\" class=\"headerlink\" title=\"配置Percona插件\"></a>配置Percona插件</h2><p>修改插件使用的mysql用户名密码<br>sed -i s/cactiuser/percona/g /var/lib/zabbix/percona/scripts/ss_get_mysql_stats.php</p>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p>测试是否可以获取到值<br>cd /var/lib/zabbix/percona/scripts/<br>./get_mysql_stats_wrapper.sh gg<br>如果获取到值，则说明配置成功<br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/zabbix-mysql02.png\" alt=\"\"></p>\n<p>注意：执行完脚本后，请手动删除/tmp/文件夹下生成的*-mysql_cacti_stats.txt文件，然后让程序自己调用创建新文件。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"安装插件包\"><a href=\"#安装插件包\" class=\"headerlink\" title=\"安装插件包\"></a>安装插件包</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install http://www.percona.com/downloads/percona-release/redhat/0.1-3/percona-release-0.1-3.noarch.rpm -y</div><div class=\"line\">yum install percona-zabbix-templates.noarch -y</div><div class=\"line\">yum install php* -y</div></pre></td></tr></table></figure>\n<h2 id=\"导入模板\"><a href=\"#导入模板\" class=\"headerlink\" title=\"导入模板\"></a>导入模板</h2><p>把/var/lib/zabbix/percona/templates/zabbix_agent_template_percona_mysql_server_ht_2.0.9-sver1.1.6.xml 文件拷贝出来，通过Zabbix的监控页面导入:<br>ConfigurationTemplatesImport(在右上角)<br>选择导出的模板文件，点击Import完成导入</p>\n<p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/zabbix-mysql01.png\" alt=\"\"></p>\n<h2 id=\"安装Agent\"><a href=\"#安装Agent\" class=\"headerlink\" title=\"安装Agent\"></a>安装Agent</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -ivh http://repo.zabbix.com/zabbix/2.4/rhel/6/x86_64/zabbix-release-2.4-1.el6.noarch.rpm</div><div class=\"line\">yum install zabbix-agent</div><div class=\"line\">vim /etc/zabbix/zabbix-agentd.conf</div><div class=\"line\">#配置监控服务器地址</div><div class=\"line\">Server=192.168.1.15</div><div class=\"line\">#导入配置文件</div><div class=\"line\">cp /var/lib/zabbix/percona/templates/userparameter_percona_mysql.conf /etc/zabbix/zabbix_agentd.d/</div><div class=\"line\">#重启agent</div><div class=\"line\">service zabbix-agent restart</div></pre></td></tr></table></figure>\n<h2 id=\"Mysql新建用户\"><a href=\"#Mysql新建用户\" class=\"headerlink\" title=\"Mysql新建用户\"></a>Mysql新建用户</h2><p>登陆Mysql数据库，新建一个本地的只有查询权限的mysql用户<br>grant select on <em>.</em> to ‘percona’@’localhost’ identified by ‘percona’;<br>flush tables;</p>\n<h2 id=\"配置Percona插件\"><a href=\"#配置Percona插件\" class=\"headerlink\" title=\"配置Percona插件\"></a>配置Percona插件</h2><p>修改插件使用的mysql用户名密码<br>sed -i s/cactiuser/percona/g /var/lib/zabbix/percona/scripts/ss_get_mysql_stats.php</p>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p>测试是否可以获取到值<br>cd /var/lib/zabbix/percona/scripts/<br>./get_mysql_stats_wrapper.sh gg<br>如果获取到值，则说明配置成功<br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/05/zabbix-mysql02.png\" alt=\"\"></p>\n<p>注意：执行完脚本后，请手动删除/tmp/文件夹下生成的*-mysql_cacti_stats.txt文件，然后让程序自己调用创建新文件。</p>\n"},{"title":"HowTo Mount OSS Bucket On ECS","id":"108","updated":"2017-04-21T05:20:50.000Z","date":"2016-12-19T22:17:08.000Z","_content":"\n> From [阿里云官方Github](https://github.com/aliyun/ossfs)\n\n> Demo: CentOS 6.8 on ECS\n\nossfs 是通过磁盘挂载的形式，将oss存储挂载到linux、类unix等操作系统，而且不仅仅可以挂载阿里云内的ECS上，理论上所有网络能到达oss的都可以挂载，但还是要以实际问题为准。\n\n##### 1.Download & Install\n[官方版本发布页面](https://github.com/aliyun/ossfs/releases)，请根据你的系统类型进行选择，我这演示的环境是CentOS 6.8；ossfs目前最新的版本是v1.79.9，您可以根据自己当时版本进行选择，建议选择最新版本。\n```\n# 请先将包上传到服务器上\n sudo yum localinstall ossfs_1.79.9_centos6.5_x86_64.rpm\n```\n>注意使用localinstall，因为在安装过程，yum 可以很好的解决依赖关系，会节省我们很多时间\n\n\n##### 2. OSS & Bucket\n\n 需要获取以下信息，在后面我们都会用到的：<br>\n1. Bucket 名称\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-0.jpg)\n<br>\n2. Access Key ID\n3. Access Key Secret\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0256A9CB-A0FA-43BC-82AF-4DE17D4852B6.png)\n\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-2.jpg)\n<br>\n4. Location，这需要注意点，不要加上Bucket的名字，区域对应表如下，注意你的Bucket所在区域:\n\n<div style=\"overflow: auto;\"><table>\n<thead>\n<tr>\n<th style=\"color:green\">Region中文名称</th>\n<th style=\"text-align:left;color: green;\">Region英文表示</th>\n<th style=\"text-align:left;color: green;\">外网Endpoint</th>\n<th style=\"text-align:left;color: green;\">ECS访问的内网Endpoint</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>华东 1</td>\n<td style=\"text-align:left\">oss-cn-hangzhou</td>\n<td style=\"text-align:left\">oss-cn-hangzhou.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-hangzhou-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>华东 2</td>\n<td style=\"text-align:left\">oss-cn-shanghai</td>\n<td style=\"text-align:left\">oss-cn-shanghai.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-shanghai-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>华北 1</td>\n<td style=\"text-align:left\">oss-cn-qingdao</td>\n<td style=\"text-align:left\">oss-cn-qingdao.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-qingdao-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>华北 2</td>\n<td style=\"text-align:left\">oss-cn-beijing</td>\n<td style=\"text-align:left\">oss-cn-beijing.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-beijing-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>华南 1</td>\n<td style=\"text-align:left\">oss-cn-shenzhen</td>\n<td style=\"text-align:left\">oss-cn-shenzhen.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-shenzhen-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>香港数据中心</td>\n<td style=\"text-align:left\">oss-cn-hongkong</td>\n<td style=\"text-align:left\">oss-cn-hongkong.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-hongkong-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>美国硅谷数据中心</td>\n<td style=\"text-align:left\">oss-us-west-1</td>\n<td style=\"text-align:left\">oss-us-west-1.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-us-west-1-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>美国弗吉尼亚数据中心</td>\n<td style=\"text-align:left\">oss-us-east-1</td>\n<td style=\"text-align:left\">oss-us-east-1.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-us-east-1-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>亚太（新加坡）数据中心</td>\n<td style=\"text-align:left\">oss-ap-southeast-1</td>\n<td style=\"text-align:left\">oss-ap-southeast-1.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-ap-southeast-1-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>亚太东北 1（日本）数据中心</td>\n<td style=\"text-align:left\">oss-ap-northeast-1</td>\n<td style=\"text-align:left\">oss-ap-northeast-1.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-ap-northeast-1-internal.aliyuncs.com</td>\n</tr>\n</tbody>\n</table></div>\n\n```\n# 设置bucket/access key/id的信息，将其存放在/etc/passwd-ossfs 文件中\n# 注意这个文件的权限必须正确设置，建议设为640\nsudo echo my-bucket:my-access-key-id:my-access-key-secret > /etc/passwd-ossfs\nsudo chmod 640 /etc/passwd-ossfs\n```\n<br>\n##### 3. Mount & Uasge\n将oss bucket mount到指定目录:\n```\n# 我碰到安装后找不到ossfs命令，查看下因为ossfs没有x权限，目录路径为/usr/local/bin，如果您也碰到这个问题，可以增加x权限后再测试\nsudo ossfs my-bucket /mnt/ossdir -ourl=http://oss-location.aliyuncs.com\n\n# 如果使用ossfs的机器是阿里云ECS，可以使用内网域名来避免流量收费和 提高速度：\nsudo ossfs my-bucket /tmp/ossfs -ourl=http://oss-location-internal.aliyuncs.com\n```\n磁盘空间达到上百T：\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0B78E099-5488-4839-AE48-09A074E7415D.png)\n<br>\n\n umount：\n```\n# 注意用户身份\numount /tmp/ossfs # root user\nsudo fusermount -u /tmp/ossfs # non-root user\n```\n<br>\n##### 4. Debug & FAQ\n当遇到错误的时候，可以试着打开Debug日志信息，然后分析问题原因：\n```\n# 使用 -o dbglevel=debug -f -d参数打印日志信息\nsudo ossfs my-bucket /tmp/ossfs -ourl=http://oss-location-internal.aliyuncs.com -o dbglevel=debug -f -d > /mnt/ossfs.log 2>&1\n```\n\n更多的问题，请移步查看[官方的FAQ文档](https://github.com/aliyun/ossfs/wiki/FAQ)。\n\n<br>\n##### 5. About\nossfs提供的功能和性能和本地文件系统相比，具有一些局限性。具体包括：\n\n* 随机或者追加写文件会导致整个文件的重写。\n* 元数据操作，例如list directory，性能较差，因为需要远程访问oss  服务器。\n* 文件/文件夹的rename操作不是原子的。\n* 多个客户端挂载同一个oss bucket时，依赖用户自行协调各个客户端的行为。例如避免多个客户端写同一个文件等等。\n* 不支持hard link。\n* 不适合用在高并发读/写的场景，这样会让系统的load升高\n\n> 另外，ossfs的稳定性很大一部分依赖于网络环境，建议的使用场景更多是作为临时数据迁移或定期备份，虽然ossfs挂载到系统中会有着几百TB的空间，但是稳定性并不高。\n","source":"_posts/HowTo-Mount-OSS-Bucket-On-ECS.md","raw":"---\ntitle: HowTo Mount OSS Bucket On ECS\ntags: 'AliCloud'\ncategories: 'AliCloud'\npermalink: alicloud-oss-ecs-mount\nid: 108\nupdated: '2017-04-21 13:20:50'\ndate: 2016-12-20 06:17:08\n---\n\n> From [阿里云官方Github](https://github.com/aliyun/ossfs)\n\n> Demo: CentOS 6.8 on ECS\n\nossfs 是通过磁盘挂载的形式，将oss存储挂载到linux、类unix等操作系统，而且不仅仅可以挂载阿里云内的ECS上，理论上所有网络能到达oss的都可以挂载，但还是要以实际问题为准。\n\n##### 1.Download & Install\n[官方版本发布页面](https://github.com/aliyun/ossfs/releases)，请根据你的系统类型进行选择，我这演示的环境是CentOS 6.8；ossfs目前最新的版本是v1.79.9，您可以根据自己当时版本进行选择，建议选择最新版本。\n```\n# 请先将包上传到服务器上\n sudo yum localinstall ossfs_1.79.9_centos6.5_x86_64.rpm\n```\n>注意使用localinstall，因为在安装过程，yum 可以很好的解决依赖关系，会节省我们很多时间\n\n\n##### 2. OSS & Bucket\n\n 需要获取以下信息，在后面我们都会用到的：<br>\n1. Bucket 名称\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-0.jpg)\n<br>\n2. Access Key ID\n3. Access Key Secret\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0256A9CB-A0FA-43BC-82AF-4DE17D4852B6.png)\n\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-2.jpg)\n<br>\n4. Location，这需要注意点，不要加上Bucket的名字，区域对应表如下，注意你的Bucket所在区域:\n\n<div style=\"overflow: auto;\"><table>\n<thead>\n<tr>\n<th style=\"color:green\">Region中文名称</th>\n<th style=\"text-align:left;color: green;\">Region英文表示</th>\n<th style=\"text-align:left;color: green;\">外网Endpoint</th>\n<th style=\"text-align:left;color: green;\">ECS访问的内网Endpoint</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>华东 1</td>\n<td style=\"text-align:left\">oss-cn-hangzhou</td>\n<td style=\"text-align:left\">oss-cn-hangzhou.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-hangzhou-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>华东 2</td>\n<td style=\"text-align:left\">oss-cn-shanghai</td>\n<td style=\"text-align:left\">oss-cn-shanghai.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-shanghai-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>华北 1</td>\n<td style=\"text-align:left\">oss-cn-qingdao</td>\n<td style=\"text-align:left\">oss-cn-qingdao.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-qingdao-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>华北 2</td>\n<td style=\"text-align:left\">oss-cn-beijing</td>\n<td style=\"text-align:left\">oss-cn-beijing.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-beijing-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>华南 1</td>\n<td style=\"text-align:left\">oss-cn-shenzhen</td>\n<td style=\"text-align:left\">oss-cn-shenzhen.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-shenzhen-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>香港数据中心</td>\n<td style=\"text-align:left\">oss-cn-hongkong</td>\n<td style=\"text-align:left\">oss-cn-hongkong.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-cn-hongkong-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>美国硅谷数据中心</td>\n<td style=\"text-align:left\">oss-us-west-1</td>\n<td style=\"text-align:left\">oss-us-west-1.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-us-west-1-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>美国弗吉尼亚数据中心</td>\n<td style=\"text-align:left\">oss-us-east-1</td>\n<td style=\"text-align:left\">oss-us-east-1.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-us-east-1-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>亚太（新加坡）数据中心</td>\n<td style=\"text-align:left\">oss-ap-southeast-1</td>\n<td style=\"text-align:left\">oss-ap-southeast-1.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-ap-southeast-1-internal.aliyuncs.com</td>\n</tr>\n<tr>\n<td>亚太东北 1（日本）数据中心</td>\n<td style=\"text-align:left\">oss-ap-northeast-1</td>\n<td style=\"text-align:left\">oss-ap-northeast-1.aliyuncs.com</td>\n<td style=\"text-align:left\">oss-ap-northeast-1-internal.aliyuncs.com</td>\n</tr>\n</tbody>\n</table></div>\n\n```\n# 设置bucket/access key/id的信息，将其存放在/etc/passwd-ossfs 文件中\n# 注意这个文件的权限必须正确设置，建议设为640\nsudo echo my-bucket:my-access-key-id:my-access-key-secret > /etc/passwd-ossfs\nsudo chmod 640 /etc/passwd-ossfs\n```\n<br>\n##### 3. Mount & Uasge\n将oss bucket mount到指定目录:\n```\n# 我碰到安装后找不到ossfs命令，查看下因为ossfs没有x权限，目录路径为/usr/local/bin，如果您也碰到这个问题，可以增加x权限后再测试\nsudo ossfs my-bucket /mnt/ossdir -ourl=http://oss-location.aliyuncs.com\n\n# 如果使用ossfs的机器是阿里云ECS，可以使用内网域名来避免流量收费和 提高速度：\nsudo ossfs my-bucket /tmp/ossfs -ourl=http://oss-location-internal.aliyuncs.com\n```\n磁盘空间达到上百T：\n![](https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0B78E099-5488-4839-AE48-09A074E7415D.png)\n<br>\n\n umount：\n```\n# 注意用户身份\numount /tmp/ossfs # root user\nsudo fusermount -u /tmp/ossfs # non-root user\n```\n<br>\n##### 4. Debug & FAQ\n当遇到错误的时候，可以试着打开Debug日志信息，然后分析问题原因：\n```\n# 使用 -o dbglevel=debug -f -d参数打印日志信息\nsudo ossfs my-bucket /tmp/ossfs -ourl=http://oss-location-internal.aliyuncs.com -o dbglevel=debug -f -d > /mnt/ossfs.log 2>&1\n```\n\n更多的问题，请移步查看[官方的FAQ文档](https://github.com/aliyun/ossfs/wiki/FAQ)。\n\n<br>\n##### 5. About\nossfs提供的功能和性能和本地文件系统相比，具有一些局限性。具体包括：\n\n* 随机或者追加写文件会导致整个文件的重写。\n* 元数据操作，例如list directory，性能较差，因为需要远程访问oss  服务器。\n* 文件/文件夹的rename操作不是原子的。\n* 多个客户端挂载同一个oss bucket时，依赖用户自行协调各个客户端的行为。例如避免多个客户端写同一个文件等等。\n* 不支持hard link。\n* 不适合用在高并发读/写的场景，这样会让系统的load升高\n\n> 另外，ossfs的稳定性很大一部分依赖于网络环境，建议的使用场景更多是作为临时数据迁移或定期备份，虽然ossfs挂载到系统中会有着几百TB的空间，但是稳定性并不高。\n","slug":"alicloud-oss-ecs-mount","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq9b003141tp4sn1jt1f","content":"<blockquote>\n<p>From <a href=\"https://github.com/aliyun/ossfs\" target=\"_blank\" rel=\"external\">阿里云官方Github</a></p>\n<p>Demo: CentOS 6.8 on ECS</p>\n</blockquote>\n<p>ossfs 是通过磁盘挂载的形式，将oss存储挂载到linux、类unix等操作系统，而且不仅仅可以挂载阿里云内的ECS上，理论上所有网络能到达oss的都可以挂载，但还是要以实际问题为准。</p>\n<h5 id=\"1-Download-amp-Install\"><a href=\"#1-Download-amp-Install\" class=\"headerlink\" title=\"1.Download &amp; Install\"></a>1.Download &amp; Install</h5><p><a href=\"https://github.com/aliyun/ossfs/releases\" target=\"_blank\" rel=\"external\">官方版本发布页面</a>，请根据你的系统类型进行选择，我这演示的环境是CentOS 6.8；ossfs目前最新的版本是v1.79.9，您可以根据自己当时版本进行选择，建议选择最新版本。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 请先将包上传到服务器上</div><div class=\"line\"> sudo yum localinstall ossfs_1.79.9_centos6.5_x86_64.rpm</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>注意使用localinstall，因为在安装过程，yum 可以很好的解决依赖关系，会节省我们很多时间</p>\n</blockquote>\n<h5 id=\"2-OSS-amp-Bucket\"><a href=\"#2-OSS-amp-Bucket\" class=\"headerlink\" title=\"2. OSS &amp; Bucket\"></a>2. OSS &amp; Bucket</h5><p> 需要获取以下信息，在后面我们都会用到的：<br></p>\n<ol>\n<li>Bucket 名称<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-0.jpg\" alt=\"\"><br><br></li>\n<li>Access Key ID</li>\n<li>Access Key Secret<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0256A9CB-A0FA-43BC-82AF-4DE17D4852B6.png\" alt=\"\"></li>\n</ol>\n<p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-2.jpg\" alt=\"\"><br><br></p>\n<ol>\n<li>Location，这需要注意点，不要加上Bucket的名字，区域对应表如下，注意你的Bucket所在区域:</li>\n</ol>\n<div style=\"overflow: auto;\"><table><br><thead><br><tr><br><th style=\"color:green\">Region中文名称</th><br><th style=\"text-align:left;color: green;\">Region英文表示</th><br><th style=\"text-align:left;color: green;\">外网Endpoint</th><br><th style=\"text-align:left;color: green;\">ECS访问的内网Endpoint</th><br></tr><br></thead><br><tbody><br><tr><br><td>华东 1</td><br><td style=\"text-align:left\">oss-cn-hangzhou</td><br><td style=\"text-align:left\">oss-cn-hangzhou.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-hangzhou-internal.aliyuncs.com</td><br></tr><br><tr><br><td>华东 2</td><br><td style=\"text-align:left\">oss-cn-shanghai</td><br><td style=\"text-align:left\">oss-cn-shanghai.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-shanghai-internal.aliyuncs.com</td><br></tr><br><tr><br><td>华北 1</td><br><td style=\"text-align:left\">oss-cn-qingdao</td><br><td style=\"text-align:left\">oss-cn-qingdao.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-qingdao-internal.aliyuncs.com</td><br></tr><br><tr><br><td>华北 2</td><br><td style=\"text-align:left\">oss-cn-beijing</td><br><td style=\"text-align:left\">oss-cn-beijing.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-beijing-internal.aliyuncs.com</td><br></tr><br><tr><br><td>华南 1</td><br><td style=\"text-align:left\">oss-cn-shenzhen</td><br><td style=\"text-align:left\">oss-cn-shenzhen.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-shenzhen-internal.aliyuncs.com</td><br></tr><br><tr><br><td>香港数据中心</td><br><td style=\"text-align:left\">oss-cn-hongkong</td><br><td style=\"text-align:left\">oss-cn-hongkong.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-hongkong-internal.aliyuncs.com</td><br></tr><br><tr><br><td>美国硅谷数据中心</td><br><td style=\"text-align:left\">oss-us-west-1</td><br><td style=\"text-align:left\">oss-us-west-1.aliyuncs.com</td><br><td style=\"text-align:left\">oss-us-west-1-internal.aliyuncs.com</td><br></tr><br><tr><br><td>美国弗吉尼亚数据中心</td><br><td style=\"text-align:left\">oss-us-east-1</td><br><td style=\"text-align:left\">oss-us-east-1.aliyuncs.com</td><br><td style=\"text-align:left\">oss-us-east-1-internal.aliyuncs.com</td><br></tr><br><tr><br><td>亚太（新加坡）数据中心</td><br><td style=\"text-align:left\">oss-ap-southeast-1</td><br><td style=\"text-align:left\">oss-ap-southeast-1.aliyuncs.com</td><br><td style=\"text-align:left\">oss-ap-southeast-1-internal.aliyuncs.com</td><br></tr><br><tr><br><td>亚太东北 1（日本）数据中心</td><br><td style=\"text-align:left\">oss-ap-northeast-1</td><br><td style=\"text-align:left\">oss-ap-northeast-1.aliyuncs.com</td><br><td style=\"text-align:left\">oss-ap-northeast-1-internal.aliyuncs.com</td><br></tr><br></tbody><br></table></div>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 设置bucket/access key/id的信息，将其存放在/etc/passwd-ossfs 文件中</div><div class=\"line\"># 注意这个文件的权限必须正确设置，建议设为640</div><div class=\"line\">sudo echo my-bucket:my-access-key-id:my-access-key-secret &gt; /etc/passwd-ossfs</div><div class=\"line\">sudo chmod 640 /etc/passwd-ossfs</div></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"3-Mount-amp-Uasge\"><a href=\"#3-Mount-amp-Uasge\" class=\"headerlink\" title=\"3. Mount &amp; Uasge\"></a>3. Mount &amp; Uasge</h5><p>将oss bucket mount到指定目录:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 我碰到安装后找不到ossfs命令，查看下因为ossfs没有x权限，目录路径为/usr/local/bin，如果您也碰到这个问题，可以增加x权限后再测试</div><div class=\"line\">sudo ossfs my-bucket /mnt/ossdir -ourl=http://oss-location.aliyuncs.com</div><div class=\"line\"></div><div class=\"line\"># 如果使用ossfs的机器是阿里云ECS，可以使用内网域名来避免流量收费和 提高速度：</div><div class=\"line\">sudo ossfs my-bucket /tmp/ossfs -ourl=http://oss-location-internal.aliyuncs.com</div></pre></td></tr></table></figure></p>\n<p>磁盘空间达到上百T：<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0B78E099-5488-4839-AE48-09A074E7415D.png\" alt=\"\"><br><br></p>\n<p> umount：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 注意用户身份</div><div class=\"line\">umount /tmp/ossfs # root user</div><div class=\"line\">sudo fusermount -u /tmp/ossfs # non-root user</div></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"4-Debug-amp-FAQ\"><a href=\"#4-Debug-amp-FAQ\" class=\"headerlink\" title=\"4. Debug &amp; FAQ\"></a>4. Debug &amp; FAQ</h5><p>当遇到错误的时候，可以试着打开Debug日志信息，然后分析问题原因：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 使用 -o dbglevel=debug -f -d参数打印日志信息</div><div class=\"line\">sudo ossfs my-bucket /tmp/ossfs -ourl=http://oss-location-internal.aliyuncs.com -o dbglevel=debug -f -d &gt; /mnt/ossfs.log 2&gt;&amp;1</div></pre></td></tr></table></figure></p>\n<p>更多的问题，请移步查看<a href=\"https://github.com/aliyun/ossfs/wiki/FAQ\" target=\"_blank\" rel=\"external\">官方的FAQ文档</a>。</p>\n<p><br></p>\n<h5 id=\"5-About\"><a href=\"#5-About\" class=\"headerlink\" title=\"5. About\"></a>5. About</h5><p>ossfs提供的功能和性能和本地文件系统相比，具有一些局限性。具体包括：</p>\n<ul>\n<li>随机或者追加写文件会导致整个文件的重写。</li>\n<li>元数据操作，例如list directory，性能较差，因为需要远程访问oss  服务器。</li>\n<li>文件/文件夹的rename操作不是原子的。</li>\n<li>多个客户端挂载同一个oss bucket时，依赖用户自行协调各个客户端的行为。例如避免多个客户端写同一个文件等等。</li>\n<li>不支持hard link。</li>\n<li>不适合用在高并发读/写的场景，这样会让系统的load升高</li>\n</ul>\n<blockquote>\n<p>另外，ossfs的稳定性很大一部分依赖于网络环境，建议的使用场景更多是作为临时数据迁移或定期备份，虽然ossfs挂载到系统中会有着几百TB的空间，但是稳定性并不高。</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>From <a href=\"https://github.com/aliyun/ossfs\">阿里云官方Github</a></p>\n<p>Demo: CentOS 6.8 on ECS</p>\n</blockquote>\n<p>ossfs 是通过磁盘挂载的形式，将oss存储挂载到linux、类unix等操作系统，而且不仅仅可以挂载阿里云内的ECS上，理论上所有网络能到达oss的都可以挂载，但还是要以实际问题为准。</p>\n<h5 id=\"1-Download-amp-Install\"><a href=\"#1-Download-amp-Install\" class=\"headerlink\" title=\"1.Download &amp; Install\"></a>1.Download &amp; Install</h5><p><a href=\"https://github.com/aliyun/ossfs/releases\">官方版本发布页面</a>，请根据你的系统类型进行选择，我这演示的环境是CentOS 6.8；ossfs目前最新的版本是v1.79.9，您可以根据自己当时版本进行选择，建议选择最新版本。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 请先将包上传到服务器上</div><div class=\"line\"> sudo yum localinstall ossfs_1.79.9_centos6.5_x86_64.rpm</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>注意使用localinstall，因为在安装过程，yum 可以很好的解决依赖关系，会节省我们很多时间</p>\n</blockquote>\n<h5 id=\"2-OSS-amp-Bucket\"><a href=\"#2-OSS-amp-Bucket\" class=\"headerlink\" title=\"2. OSS &amp; Bucket\"></a>2. OSS &amp; Bucket</h5><p> 需要获取以下信息，在后面我们都会用到的：<br></p>\n<ol>\n<li>Bucket 名称<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-0.jpg\" alt=\"\"><br><br></li>\n<li>Access Key ID</li>\n<li>Access Key Secret<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0256A9CB-A0FA-43BC-82AF-4DE17D4852B6.png\" alt=\"\"></li>\n</ol>\n<p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-2.jpg\" alt=\"\"><br><br></p>\n<ol>\n<li>Location，这需要注意点，不要加上Bucket的名字，区域对应表如下，注意你的Bucket所在区域:</li>\n</ol>\n<div style=\"overflow: auto;\"><table><br><thead><br><tr><br><th style=\"color:green\">Region中文名称</th><br><th style=\"text-align:left;color: green;\">Region英文表示</th><br><th style=\"text-align:left;color: green;\">外网Endpoint</th><br><th style=\"text-align:left;color: green;\">ECS访问的内网Endpoint</th><br></tr><br></thead><br><tbody><br><tr><br><td>华东 1</td><br><td style=\"text-align:left\">oss-cn-hangzhou</td><br><td style=\"text-align:left\">oss-cn-hangzhou.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-hangzhou-internal.aliyuncs.com</td><br></tr><br><tr><br><td>华东 2</td><br><td style=\"text-align:left\">oss-cn-shanghai</td><br><td style=\"text-align:left\">oss-cn-shanghai.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-shanghai-internal.aliyuncs.com</td><br></tr><br><tr><br><td>华北 1</td><br><td style=\"text-align:left\">oss-cn-qingdao</td><br><td style=\"text-align:left\">oss-cn-qingdao.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-qingdao-internal.aliyuncs.com</td><br></tr><br><tr><br><td>华北 2</td><br><td style=\"text-align:left\">oss-cn-beijing</td><br><td style=\"text-align:left\">oss-cn-beijing.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-beijing-internal.aliyuncs.com</td><br></tr><br><tr><br><td>华南 1</td><br><td style=\"text-align:left\">oss-cn-shenzhen</td><br><td style=\"text-align:left\">oss-cn-shenzhen.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-shenzhen-internal.aliyuncs.com</td><br></tr><br><tr><br><td>香港数据中心</td><br><td style=\"text-align:left\">oss-cn-hongkong</td><br><td style=\"text-align:left\">oss-cn-hongkong.aliyuncs.com</td><br><td style=\"text-align:left\">oss-cn-hongkong-internal.aliyuncs.com</td><br></tr><br><tr><br><td>美国硅谷数据中心</td><br><td style=\"text-align:left\">oss-us-west-1</td><br><td style=\"text-align:left\">oss-us-west-1.aliyuncs.com</td><br><td style=\"text-align:left\">oss-us-west-1-internal.aliyuncs.com</td><br></tr><br><tr><br><td>美国弗吉尼亚数据中心</td><br><td style=\"text-align:left\">oss-us-east-1</td><br><td style=\"text-align:left\">oss-us-east-1.aliyuncs.com</td><br><td style=\"text-align:left\">oss-us-east-1-internal.aliyuncs.com</td><br></tr><br><tr><br><td>亚太（新加坡）数据中心</td><br><td style=\"text-align:left\">oss-ap-southeast-1</td><br><td style=\"text-align:left\">oss-ap-southeast-1.aliyuncs.com</td><br><td style=\"text-align:left\">oss-ap-southeast-1-internal.aliyuncs.com</td><br></tr><br><tr><br><td>亚太东北 1（日本）数据中心</td><br><td style=\"text-align:left\">oss-ap-northeast-1</td><br><td style=\"text-align:left\">oss-ap-northeast-1.aliyuncs.com</td><br><td style=\"text-align:left\">oss-ap-northeast-1-internal.aliyuncs.com</td><br></tr><br></tbody><br></table></div>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 设置bucket/access key/id的信息，将其存放在/etc/passwd-ossfs 文件中</div><div class=\"line\"># 注意这个文件的权限必须正确设置，建议设为640</div><div class=\"line\">sudo echo my-bucket:my-access-key-id:my-access-key-secret &gt; /etc/passwd-ossfs</div><div class=\"line\">sudo chmod 640 /etc/passwd-ossfs</div></pre></td></tr></table></figure>\n<p><br></p>\n<h5 id=\"3-Mount-amp-Uasge\"><a href=\"#3-Mount-amp-Uasge\" class=\"headerlink\" title=\"3. Mount &amp; Uasge\"></a>3. Mount &amp; Uasge</h5><p>将oss bucket mount到指定目录:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 我碰到安装后找不到ossfs命令，查看下因为ossfs没有x权限，目录路径为/usr/local/bin，如果您也碰到这个问题，可以增加x权限后再测试</div><div class=\"line\">sudo ossfs my-bucket /mnt/ossdir -ourl=http://oss-location.aliyuncs.com</div><div class=\"line\"></div><div class=\"line\"># 如果使用ossfs的机器是阿里云ECS，可以使用内网域名来避免流量收费和 提高速度：</div><div class=\"line\">sudo ossfs my-bucket /tmp/ossfs -ourl=http://oss-location-internal.aliyuncs.com</div></pre></td></tr></table></figure></p>\n<p>磁盘空间达到上百T：<br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0B78E099-5488-4839-AE48-09A074E7415D.png\" alt=\"\"><br><br></p>\n<p> umount：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 注意用户身份</div><div class=\"line\">umount /tmp/ossfs # root user</div><div class=\"line\">sudo fusermount -u /tmp/ossfs # non-root user</div></pre></td></tr></table></figure></p>\n<p><br></p>\n<h5 id=\"4-Debug-amp-FAQ\"><a href=\"#4-Debug-amp-FAQ\" class=\"headerlink\" title=\"4. Debug &amp; FAQ\"></a>4. Debug &amp; FAQ</h5><p>当遇到错误的时候，可以试着打开Debug日志信息，然后分析问题原因：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 使用 -o dbglevel=debug -f -d参数打印日志信息</div><div class=\"line\">sudo ossfs my-bucket /tmp/ossfs -ourl=http://oss-location-internal.aliyuncs.com -o dbglevel=debug -f -d &gt; /mnt/ossfs.log 2&gt;&amp;1</div></pre></td></tr></table></figure></p>\n<p>更多的问题，请移步查看<a href=\"https://github.com/aliyun/ossfs/wiki/FAQ\">官方的FAQ文档</a>。</p>\n<p><br></p>\n<h5 id=\"5-About\"><a href=\"#5-About\" class=\"headerlink\" title=\"5. About\"></a>5. About</h5><p>ossfs提供的功能和性能和本地文件系统相比，具有一些局限性。具体包括：</p>\n<ul>\n<li>随机或者追加写文件会导致整个文件的重写。</li>\n<li>元数据操作，例如list directory，性能较差，因为需要远程访问oss  服务器。</li>\n<li>文件/文件夹的rename操作不是原子的。</li>\n<li>多个客户端挂载同一个oss bucket时，依赖用户自行协调各个客户端的行为。例如避免多个客户端写同一个文件等等。</li>\n<li>不支持hard link。</li>\n<li>不适合用在高并发读/写的场景，这样会让系统的load升高</li>\n</ul>\n<blockquote>\n<p>另外，ossfs的稳定性很大一部分依赖于网络环境，建议的使用场景更多是作为临时数据迁移或定期备份，虽然ossfs挂载到系统中会有着几百TB的空间，但是稳定性并不高。</p>\n</blockquote>\n"},{"title":"HowTo Play Pokemon GO in China","id":"67","updated":"2017-04-21T05:26:19.000Z","date":"2016-07-24T13:42:01.000Z","_content":"\n### Installtions\n* [TuTuAPP](http://www.tutuapp.cn)\n* [VPN](https://shadowsocks.biz/?ref=518)\n* [Google Account ID](https://accounts.google.com)\n\n<p>&emsp;&emsp;最近看到身边朋友都在玩Pokemon GO, 心痒难耐，于是跟同事请教琢磨了，终于在自己的手机上玩起来了，由于我的手机是iPhone 5s，身边朋友也都是iPhone，所以不确定是Android是否可以玩耍，想来应该是没有问题话，Android平台做破解等操作一直以来比iPhone更加方便。\n</p>\n<div align=\"center\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo1.jpg>\n</div>\n&emsp;&emsp;1. 点击上面的TuTuAPP，可以打开兔兔助手的网站，用手机扫描首页的二维码(可以用微信等，带有二维码扫描的都可以)，注意如果你的iPhone已经越狱，请切换标签页到越狱版本。\n\n&emsp;&emsp;2. 安装时注意按照提示添加信任，等待兔兔助手安装完成之后，打开软件，在Search栏输入“精灵宝可梦GO”，请下载美区版，有两个版本：懒人版与移动版；懒人版有移动按钮，可以不需要走动躺在床上玩耍，移动版是需要人走动才能玩耍，我下载的移动版，你根据自己的喜欢选择，选择完成后，按提示按钮安装即可。\n\n&emsp;&emsp;3. 安装完成Pokemon GO之后也需要设定信任，请按照提示操作；好了， 到这一步，Pokemon GO已经安装在你的手机上了，下一步就是怎么登录玩耍。\n\n&emsp;&emsp;4. 到这里及一下的步骤能继续下去的前提是，你有一个美国的VPN节点。打开你手机App Store，搜索VPN，列表中会有很多的免费应用，因为我一直用的是付费VPN，所以对这些不是很清楚，朋友推荐**ArkVPN**，如果你没有付费VPN，可以试试这个，注意VPN节点要选择US，如果你也要使付费VPN的，我推荐Shadowsocks＋Potatso( App)\n\n&emsp;&emsp;5. 注册Google Account ID，[点击](https://account.google.com)\n<div align=\"center\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo2.jpg width=\"360\" height=\"640\">\n</div>\n&emsp;&emsp;6. 进入游戏，登录Google ID，然后授权，进入游戏。\n<div align=\"center\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo3.png width=\"360\" height=\"640\">\n</div>\n&emsp;&emsp;7. 开始捕捉你的小精灵吧，手动微笑。\n\n> Tips：这款游戏会大量耗电发热，因为打开摄像头捕捉小精灵；另外很容易入迷，在室外玩耍时一定要注意安全。\n\n&emsp;&emsp;8. 注意：如果看到了GPS signal not found，说明是GPS信息丢失，这是根据GPS定位的游戏，所以这很重要，记得选择美国的VPN代理。\n<div align=\"center\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo4.png\nwidth=\"360\" height=\"640\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo5.png\nwidth=\"360\" height=\"640\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo6.png\nwidth=\"360\" height=\"640\">\n</div>\n","source":"_posts/HowTo-Play-Pokemon-GO-in-China.md","raw":"---\ntitle: HowTo Play Pokemon GO in China\npermalink: pokemongo\nid: 67\nupdated: '2017-04-21 13:26:19'\ndate: 2016-07-24 21:42:01\n---\n\n### Installtions\n* [TuTuAPP](http://www.tutuapp.cn)\n* [VPN](https://shadowsocks.biz/?ref=518)\n* [Google Account ID](https://accounts.google.com)\n\n<p>&emsp;&emsp;最近看到身边朋友都在玩Pokemon GO, 心痒难耐，于是跟同事请教琢磨了，终于在自己的手机上玩起来了，由于我的手机是iPhone 5s，身边朋友也都是iPhone，所以不确定是Android是否可以玩耍，想来应该是没有问题话，Android平台做破解等操作一直以来比iPhone更加方便。\n</p>\n<div align=\"center\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo1.jpg>\n</div>\n&emsp;&emsp;1. 点击上面的TuTuAPP，可以打开兔兔助手的网站，用手机扫描首页的二维码(可以用微信等，带有二维码扫描的都可以)，注意如果你的iPhone已经越狱，请切换标签页到越狱版本。\n\n&emsp;&emsp;2. 安装时注意按照提示添加信任，等待兔兔助手安装完成之后，打开软件，在Search栏输入“精灵宝可梦GO”，请下载美区版，有两个版本：懒人版与移动版；懒人版有移动按钮，可以不需要走动躺在床上玩耍，移动版是需要人走动才能玩耍，我下载的移动版，你根据自己的喜欢选择，选择完成后，按提示按钮安装即可。\n\n&emsp;&emsp;3. 安装完成Pokemon GO之后也需要设定信任，请按照提示操作；好了， 到这一步，Pokemon GO已经安装在你的手机上了，下一步就是怎么登录玩耍。\n\n&emsp;&emsp;4. 到这里及一下的步骤能继续下去的前提是，你有一个美国的VPN节点。打开你手机App Store，搜索VPN，列表中会有很多的免费应用，因为我一直用的是付费VPN，所以对这些不是很清楚，朋友推荐**ArkVPN**，如果你没有付费VPN，可以试试这个，注意VPN节点要选择US，如果你也要使付费VPN的，我推荐Shadowsocks＋Potatso( App)\n\n&emsp;&emsp;5. 注册Google Account ID，[点击](https://account.google.com)\n<div align=\"center\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo2.jpg width=\"360\" height=\"640\">\n</div>\n&emsp;&emsp;6. 进入游戏，登录Google ID，然后授权，进入游戏。\n<div align=\"center\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo3.png width=\"360\" height=\"640\">\n</div>\n&emsp;&emsp;7. 开始捕捉你的小精灵吧，手动微笑。\n\n> Tips：这款游戏会大量耗电发热，因为打开摄像头捕捉小精灵；另外很容易入迷，在室外玩耍时一定要注意安全。\n\n&emsp;&emsp;8. 注意：如果看到了GPS signal not found，说明是GPS信息丢失，这是根据GPS定位的游戏，所以这很重要，记得选择美国的VPN代理。\n<div align=\"center\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo4.png\nwidth=\"360\" height=\"640\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo5.png\nwidth=\"360\" height=\"640\">\n<img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo6.png\nwidth=\"360\" height=\"640\">\n</div>\n","slug":"pokemongo","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq9f003541tpbnxe9bwh","content":"<h3 id=\"Installtions\"><a href=\"#Installtions\" class=\"headerlink\" title=\"Installtions\"></a>Installtions</h3><ul>\n<li><a href=\"http://www.tutuapp.cn\" target=\"_blank\" rel=\"external\">TuTuAPP</a></li>\n<li><a href=\"https://shadowsocks.biz/?ref=518\" target=\"_blank\" rel=\"external\">VPN</a></li>\n<li><a href=\"https://accounts.google.com\" target=\"_blank\" rel=\"external\">Google Account ID</a></li>\n</ul>\n<p></p><p>&emsp;&emsp;最近看到身边朋友都在玩Pokemon GO, 心痒难耐，于是跟同事请教琢磨了，终于在自己的手机上玩起来了，由于我的手机是iPhone 5s，身边朋友也都是iPhone，所以不确定是Android是否可以玩耍，想来应该是没有问题话，Android平台做破解等操作一直以来比iPhone更加方便。<br></p><p></p>\n<div align=\"center\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo1.jpg\"><br></div><br>&emsp;&emsp;1. 点击上面的TuTuAPP，可以打开兔兔助手的网站，用手机扫描首页的二维码(可以用微信等，带有二维码扫描的都可以)，注意如果你的iPhone已经越狱，请切换标签页到越狱版本。<br><br>&emsp;&emsp;2. 安装时注意按照提示添加信任，等待兔兔助手安装完成之后，打开软件，在Search栏输入“精灵宝可梦GO”，请下载美区版，有两个版本：懒人版与移动版；懒人版有移动按钮，可以不需要走动躺在床上玩耍，移动版是需要人走动才能玩耍，我下载的移动版，你根据自己的喜欢选择，选择完成后，按提示按钮安装即可。<br><br>&emsp;&emsp;3. 安装完成Pokemon GO之后也需要设定信任，请按照提示操作；好了， 到这一步，Pokemon GO已经安装在你的手机上了，下一步就是怎么登录玩耍。<br><br>&emsp;&emsp;4. 到这里及一下的步骤能继续下去的前提是，你有一个美国的VPN节点。打开你手机App Store，搜索VPN，列表中会有很多的免费应用，因为我一直用的是付费VPN，所以对这些不是很清楚，朋友推荐<strong>ArkVPN</strong>，如果你没有付费VPN，可以试试这个，注意VPN节点要选择US，如果你也要使付费VPN的，我推荐Shadowsocks＋Potatso( App)<br><br>&emsp;&emsp;5. 注册Google Account ID，<a href=\"https://account.google.com\" target=\"_blank\" rel=\"external\">点击</a><br><div align=\"center\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo2.jpg\" width=\"360\" height=\"640\"><br></div><br>&emsp;&emsp;6. 进入游戏，登录Google ID，然后授权，进入游戏。<br><div align=\"center\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo3.png\" width=\"360\" height=\"640\"><br></div><br>&emsp;&emsp;7. 开始捕捉你的小精灵吧，手动微笑。<br><br>&gt; Tips：这款游戏会大量耗电发热，因为打开摄像头捕捉小精灵；另外很容易入迷，在室外玩耍时一定要注意安全。<br><br>&emsp;&emsp;8. 注意：如果看到了GPS signal not found，说明是GPS信息丢失，这是根据GPS定位的游戏，所以这很重要，记得选择美国的VPN代理。<br><div align=\"center\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo4.png\" width=\"360\" height=\"640\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo5.png\" width=\"360\" height=\"640\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo6.png\" width=\"360\" height=\"640\"><br></div>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Installtions\"><a href=\"#Installtions\" class=\"headerlink\" title=\"Installtions\"></a>Installtions</h3><ul>\n<li><a href=\"http://www.tutuapp.cn\">TuTuAPP</a></li>\n<li><a href=\"https://shadowsocks.biz/?ref=518\">VPN</a></li>\n<li><a href=\"https://accounts.google.com\">Google Account ID</a></li>\n</ul>\n<p><p>&emsp;&emsp;最近看到身边朋友都在玩Pokemon GO, 心痒难耐，于是跟同事请教琢磨了，终于在自己的手机上玩起来了，由于我的手机是iPhone 5s，身边朋友也都是iPhone，所以不确定是Android是否可以玩耍，想来应该是没有问题话，Android平台做破解等操作一直以来比iPhone更加方便。<br></p></p>\n<div align=\"center\"><br><img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo1.jpg><br></div><br>&emsp;&emsp;1. 点击上面的TuTuAPP，可以打开兔兔助手的网站，用手机扫描首页的二维码(可以用微信等，带有二维码扫描的都可以)，注意如果你的iPhone已经越狱，请切换标签页到越狱版本。<br><br>&emsp;&emsp;2. 安装时注意按照提示添加信任，等待兔兔助手安装完成之后，打开软件，在Search栏输入“精灵宝可梦GO”，请下载美区版，有两个版本：懒人版与移动版；懒人版有移动按钮，可以不需要走动躺在床上玩耍，移动版是需要人走动才能玩耍，我下载的移动版，你根据自己的喜欢选择，选择完成后，按提示按钮安装即可。<br><br>&emsp;&emsp;3. 安装完成Pokemon GO之后也需要设定信任，请按照提示操作；好了， 到这一步，Pokemon GO已经安装在你的手机上了，下一步就是怎么登录玩耍。<br><br>&emsp;&emsp;4. 到这里及一下的步骤能继续下去的前提是，你有一个美国的VPN节点。打开你手机App Store，搜索VPN，列表中会有很多的免费应用，因为我一直用的是付费VPN，所以对这些不是很清楚，朋友推荐<strong>ArkVPN</strong>，如果你没有付费VPN，可以试试这个，注意VPN节点要选择US，如果你也要使付费VPN的，我推荐Shadowsocks＋Potatso( App)<br><br>&emsp;&emsp;5. 注册Google Account ID，<a href=\"https://account.google.com\">点击</a><br><div align=\"center\"><br><img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo2.jpg width=\"360\" height=\"640\"><br></div><br>&emsp;&emsp;6. 进入游戏，登录Google ID，然后授权，进入游戏。<br><div align=\"center\"><br><img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo3.png width=\"360\" height=\"640\"><br></div><br>&emsp;&emsp;7. 开始捕捉你的小精灵吧，手动微笑。<br><br>&gt; Tips：这款游戏会大量耗电发热，因为打开摄像头捕捉小精灵；另外很容易入迷，在室外玩耍时一定要注意安全。<br><br>&emsp;&emsp;8. 注意：如果看到了GPS signal not found，说明是GPS信息丢失，这是根据GPS定位的游戏，所以这很重要，记得选择美国的VPN代理。<br><div align=\"center\"><br><img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo4.png\nwidth=\"360\" height=\"640\"><br><img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo5.png\nwidth=\"360\" height=\"640\"><br><img src=http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/pokemongo6.png\nwidth=\"360\" height=\"640\"><br></div>\n"},{"title":"HowTo Reset Azure VM Linux Password","id":"66","updated":"2017-04-21T05:26:31.000Z","date":"2016-07-10T03:21:47.000Z","_content":"\n\n>   **Setup1:** 这种方法仅适用于已存在的用户，也就是说$Username是之前创建过的用户，否则不适用\n\n### **1. 指定虚拟机**\n```\n$vm = Get-AzureVM -ServiceName '云服务名称' -Name '虚拟机名称'\n$vm.GetInstance().ProvisionGuestAgent = $true\n```\n### **2. 输入您当前的用户名和新密码**\n```\n$UserName = \"指定用户名\"\n$Password = \"指定密码\"\n\n$PrivateConfig = '{\"username\":\"'+ $UserName + '\", \"password\":\"' +  $Password + '\"}'\n```\n### **3. 开始执行**\n```\n$ExtensionName = 'VMAccessForLinux'\n$Publisher = 'Microsoft.OSTCExtensions'\n$Version =  '1.0'\n\nSet-AzureVMExtension -ExtensionName $ExtensionName -VM  $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM\n\n```\n\n> **Setup2:** 如果是由于错误修改了SSH的配置文件导致无法登录，例如在登录时报错：This service allows sftp connections only.Connection to vm closed.这是因为错误配置了sftp导致的，那碰到这种问题需要做的是重置ssh服务。\n\n### **1. 指定虚拟机**\n```\n$vm = Get-AzureVM -ServiceName 'MyServiceName' -Name 'MyVMName'\n$PrivateConfig = '{\"reset_ssh\":\"True\"}''\n```\n### **2. 开始执行**\n```\n$ExtensionName = 'VMAccessForLinux'\n$Publisher = 'Microsoft.OSTCExtensions'\n$Version =  '1.0'\n\nSet-AzureVMExtension -ExtensionName $ExtensionName -VM  $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM\n```\n","source":"_posts/HowTo-Reset-Azure-VM-Linux-Password.md","raw":"---\ntitle: HowTo Reset Azure VM Linux Password\ntags: 'Azure'\ncategories: 'Azure'\npermalink: reset-azure-vm-linux-password\nid: 66\nupdated: '2017-04-21 13:26:31'\ndate: 2016-07-10 11:21:47\n---\n\n\n>   **Setup1:** 这种方法仅适用于已存在的用户，也就是说$Username是之前创建过的用户，否则不适用\n\n### **1. 指定虚拟机**\n```\n$vm = Get-AzureVM -ServiceName '云服务名称' -Name '虚拟机名称'\n$vm.GetInstance().ProvisionGuestAgent = $true\n```\n### **2. 输入您当前的用户名和新密码**\n```\n$UserName = \"指定用户名\"\n$Password = \"指定密码\"\n\n$PrivateConfig = '{\"username\":\"'+ $UserName + '\", \"password\":\"' +  $Password + '\"}'\n```\n### **3. 开始执行**\n```\n$ExtensionName = 'VMAccessForLinux'\n$Publisher = 'Microsoft.OSTCExtensions'\n$Version =  '1.0'\n\nSet-AzureVMExtension -ExtensionName $ExtensionName -VM  $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM\n\n```\n\n> **Setup2:** 如果是由于错误修改了SSH的配置文件导致无法登录，例如在登录时报错：This service allows sftp connections only.Connection to vm closed.这是因为错误配置了sftp导致的，那碰到这种问题需要做的是重置ssh服务。\n\n### **1. 指定虚拟机**\n```\n$vm = Get-AzureVM -ServiceName 'MyServiceName' -Name 'MyVMName'\n$PrivateConfig = '{\"reset_ssh\":\"True\"}''\n```\n### **2. 开始执行**\n```\n$ExtensionName = 'VMAccessForLinux'\n$Publisher = 'Microsoft.OSTCExtensions'\n$Version =  '1.0'\n\nSet-AzureVMExtension -ExtensionName $ExtensionName -VM  $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM\n```\n","slug":"reset-azure-vm-linux-password","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq9j003741tpfdv5rb94","content":"<blockquote>\n<p>  <strong>Setup1:</strong> 这种方法仅适用于已存在的用户，也就是说$Username是之前创建过的用户，否则不适用</p>\n</blockquote>\n<h3 id=\"1-指定虚拟机\"><a href=\"#1-指定虚拟机\" class=\"headerlink\" title=\"1. 指定虚拟机\"></a><strong>1. 指定虚拟机</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">$vm = Get-AzureVM -ServiceName &apos;云服务名称&apos; -Name &apos;虚拟机名称&apos;</div><div class=\"line\">$vm.GetInstance().ProvisionGuestAgent = $true</div></pre></td></tr></table></figure>\n<h3 id=\"2-输入您当前的用户名和新密码\"><a href=\"#2-输入您当前的用户名和新密码\" class=\"headerlink\" title=\"2. 输入您当前的用户名和新密码\"></a><strong>2. 输入您当前的用户名和新密码</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">$UserName = &quot;指定用户名&quot;</div><div class=\"line\">$Password = &quot;指定密码&quot;</div><div class=\"line\"></div><div class=\"line\">$PrivateConfig = &apos;&#123;&quot;username&quot;:&quot;&apos;+ $UserName + &apos;&quot;, &quot;password&quot;:&quot;&apos; +  $Password + &apos;&quot;&#125;&apos;</div></pre></td></tr></table></figure>\n<h3 id=\"3-开始执行\"><a href=\"#3-开始执行\" class=\"headerlink\" title=\"3. 开始执行\"></a><strong>3. 开始执行</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ExtensionName = &apos;VMAccessForLinux&apos;</div><div class=\"line\">$Publisher = &apos;Microsoft.OSTCExtensions&apos;</div><div class=\"line\">$Version =  &apos;1.0&apos;</div><div class=\"line\"></div><div class=\"line\">Set-AzureVMExtension -ExtensionName $ExtensionName -VM  $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM</div></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>Setup2:</strong> 如果是由于错误修改了SSH的配置文件导致无法登录，例如在登录时报错：This service allows sftp connections only.Connection to vm closed.这是因为错误配置了sftp导致的，那碰到这种问题需要做的是重置ssh服务。</p>\n</blockquote>\n<h3 id=\"1-指定虚拟机-1\"><a href=\"#1-指定虚拟机-1\" class=\"headerlink\" title=\"1. 指定虚拟机\"></a><strong>1. 指定虚拟机</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">$vm = Get-AzureVM -ServiceName &apos;MyServiceName&apos; -Name &apos;MyVMName&apos;</div><div class=\"line\">$PrivateConfig = &apos;&#123;&quot;reset_ssh&quot;:&quot;True&quot;&#125;&apos;&apos;</div></pre></td></tr></table></figure>\n<h3 id=\"2-开始执行\"><a href=\"#2-开始执行\" class=\"headerlink\" title=\"2. 开始执行\"></a><strong>2. 开始执行</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ExtensionName = &apos;VMAccessForLinux&apos;</div><div class=\"line\">$Publisher = &apos;Microsoft.OSTCExtensions&apos;</div><div class=\"line\">$Version =  &apos;1.0&apos;</div><div class=\"line\"></div><div class=\"line\">Set-AzureVMExtension -ExtensionName $ExtensionName -VM  $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>  <strong>Setup1:</strong> 这种方法仅适用于已存在的用户，也就是说$Username是之前创建过的用户，否则不适用</p>\n</blockquote>\n<h3 id=\"1-指定虚拟机\"><a href=\"#1-指定虚拟机\" class=\"headerlink\" title=\"1. 指定虚拟机\"></a><strong>1. 指定虚拟机</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">$vm = Get-AzureVM -ServiceName &apos;云服务名称&apos; -Name &apos;虚拟机名称&apos;</div><div class=\"line\">$vm.GetInstance().ProvisionGuestAgent = $true</div></pre></td></tr></table></figure>\n<h3 id=\"2-输入您当前的用户名和新密码\"><a href=\"#2-输入您当前的用户名和新密码\" class=\"headerlink\" title=\"2. 输入您当前的用户名和新密码\"></a><strong>2. 输入您当前的用户名和新密码</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">$UserName = &quot;指定用户名&quot;</div><div class=\"line\">$Password = &quot;指定密码&quot;</div><div class=\"line\"></div><div class=\"line\">$PrivateConfig = &apos;&#123;&quot;username&quot;:&quot;&apos;+ $UserName + &apos;&quot;, &quot;password&quot;:&quot;&apos; +  $Password + &apos;&quot;&#125;&apos;</div></pre></td></tr></table></figure>\n<h3 id=\"3-开始执行\"><a href=\"#3-开始执行\" class=\"headerlink\" title=\"3. 开始执行\"></a><strong>3. 开始执行</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ExtensionName = &apos;VMAccessForLinux&apos;</div><div class=\"line\">$Publisher = &apos;Microsoft.OSTCExtensions&apos;</div><div class=\"line\">$Version =  &apos;1.0&apos;</div><div class=\"line\"></div><div class=\"line\">Set-AzureVMExtension -ExtensionName $ExtensionName -VM  $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM</div></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>Setup2:</strong> 如果是由于错误修改了SSH的配置文件导致无法登录，例如在登录时报错：This service allows sftp connections only.Connection to vm closed.这是因为错误配置了sftp导致的，那碰到这种问题需要做的是重置ssh服务。</p>\n</blockquote>\n<h3 id=\"1-指定虚拟机-1\"><a href=\"#1-指定虚拟机-1\" class=\"headerlink\" title=\"1. 指定虚拟机\"></a><strong>1. 指定虚拟机</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">$vm = Get-AzureVM -ServiceName &apos;MyServiceName&apos; -Name &apos;MyVMName&apos;</div><div class=\"line\">$PrivateConfig = &apos;&#123;&quot;reset_ssh&quot;:&quot;True&quot;&#125;&apos;&apos;</div></pre></td></tr></table></figure>\n<h3 id=\"2-开始执行\"><a href=\"#2-开始执行\" class=\"headerlink\" title=\"2. 开始执行\"></a><strong>2. 开始执行</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ExtensionName = &apos;VMAccessForLinux&apos;</div><div class=\"line\">$Publisher = &apos;Microsoft.OSTCExtensions&apos;</div><div class=\"line\">$Version =  &apos;1.0&apos;</div><div class=\"line\"></div><div class=\"line\">Set-AzureVMExtension -ExtensionName $ExtensionName -VM  $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Reset MySQL Root Password","id":"116","updated":"2017-04-21T05:19:53.000Z","date":"2016-12-04T01:57:23.000Z","_content":"\n#### 1. 处理的状态\n 首先确认服务器出于安全的状态，也就是没有人能够任意地连接MySQL数据库。\n因为在重新设置MySQL的root密码的期间，MySQL数据库完全出于没有密码保护的\n状态下，其他的用户也可以任意地登录和修改MySQL的信息。可以采用将MySQL对\n外的端口封闭，并且停止Apache以及所有的用户进程的方法实现服务器的准安全\n状态。最安全的状态是到服务器的Console上面操作，并且拔掉网线。\n\n#### 2. 重置密码\n\n1. 修改mysql配置文件，增加skip-grant-tables\n```\n[root@demo ~]# vim /etc/my.cnf\n[mysqld]\nskip-grant-tables\n```\n\n2. 重启mysqld\n```\n[root@demo ~]# service mysqld restart\nStopping mysqld:                                           [  OK  ]\nStarting mysqld:                                           [  OK  ]\n```\n\n3. 登录mysql，并修改root密码.\n```\n[root@demo ~]# mysql -u root\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 3\nServer version: 5.5.53 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> use mysql\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql> update user set password=password('new-pass') where user='root';\nQuery OK, 5 rows affected (0.00 sec)\nRows matched: 5  Changed: 5  Warnings: 0\n```\n\n4. 配置文件去除skip-grant-tables，并重启服务器.\n```\n[root@demo ~]# vim /etc/my.cnf\n[root@demo ~]# service mysqld restart\n```\n\n5. 使用新密码登录到mysql\n```\n[root@demo ~]# mysql -h localhost -u root -p\n```\n","source":"_posts/HowTo-Reset-MySQL-Root-Password.md","raw":"---\ntitle: HowTo Reset MySQL Root Password\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: wrbpvpam\nid: 116\nupdated: '2017-04-21 13:19:53'\ndate: 2016-12-04 09:57:23\n---\n\n#### 1. 处理的状态\n 首先确认服务器出于安全的状态，也就是没有人能够任意地连接MySQL数据库。\n因为在重新设置MySQL的root密码的期间，MySQL数据库完全出于没有密码保护的\n状态下，其他的用户也可以任意地登录和修改MySQL的信息。可以采用将MySQL对\n外的端口封闭，并且停止Apache以及所有的用户进程的方法实现服务器的准安全\n状态。最安全的状态是到服务器的Console上面操作，并且拔掉网线。\n\n#### 2. 重置密码\n\n1. 修改mysql配置文件，增加skip-grant-tables\n```\n[root@demo ~]# vim /etc/my.cnf\n[mysqld]\nskip-grant-tables\n```\n\n2. 重启mysqld\n```\n[root@demo ~]# service mysqld restart\nStopping mysqld:                                           [  OK  ]\nStarting mysqld:                                           [  OK  ]\n```\n\n3. 登录mysql，并修改root密码.\n```\n[root@demo ~]# mysql -u root\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 3\nServer version: 5.5.53 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> use mysql\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql> update user set password=password('new-pass') where user='root';\nQuery OK, 5 rows affected (0.00 sec)\nRows matched: 5  Changed: 5  Warnings: 0\n```\n\n4. 配置文件去除skip-grant-tables，并重启服务器.\n```\n[root@demo ~]# vim /etc/my.cnf\n[root@demo ~]# service mysqld restart\n```\n\n5. 使用新密码登录到mysql\n```\n[root@demo ~]# mysql -h localhost -u root -p\n```\n","slug":"wrbpvpam","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq9l003a41tplki8berm","content":"<h4 id=\"1-处理的状态\"><a href=\"#1-处理的状态\" class=\"headerlink\" title=\"1. 处理的状态\"></a>1. 处理的状态</h4><p> 首先确认服务器出于安全的状态，也就是没有人能够任意地连接MySQL数据库。<br>因为在重新设置MySQL的root密码的期间，MySQL数据库完全出于没有密码保护的<br>状态下，其他的用户也可以任意地登录和修改MySQL的信息。可以采用将MySQL对<br>外的端口封闭，并且停止Apache以及所有的用户进程的方法实现服务器的准安全<br>状态。最安全的状态是到服务器的Console上面操作，并且拔掉网线。</p>\n<h4 id=\"2-重置密码\"><a href=\"#2-重置密码\" class=\"headerlink\" title=\"2. 重置密码\"></a>2. 重置密码</h4><ol>\n<li><p>修改mysql配置文件，增加skip-grant-tables</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# vim /etc/my.cnf</div><div class=\"line\">[mysqld]</div><div class=\"line\">skip-grant-tables</div></pre></td></tr></table></figure>\n</li>\n<li><p>重启mysqld</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# service mysqld restart</div><div class=\"line\">Stopping mysqld:                                           [  OK  ]</div><div class=\"line\">Starting mysqld:                                           [  OK  ]</div></pre></td></tr></table></figure>\n</li>\n<li><p>登录mysql，并修改root密码.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# mysql -u root</div><div class=\"line\">Welcome to the MySQL monitor.  Commands end with ; or \\g.</div><div class=\"line\">Your MySQL connection id is 3</div><div class=\"line\">Server version: 5.5.53 MySQL Community Server (GPL)</div><div class=\"line\"></div><div class=\"line\">Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.</div><div class=\"line\"></div><div class=\"line\">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class=\"line\">affiliates. Other names may be trademarks of their respective</div><div class=\"line\">owners.</div><div class=\"line\"></div><div class=\"line\">Type &apos;help;&apos; or &apos;\\h&apos; for help. Type &apos;\\c&apos; to clear the current input statement.</div><div class=\"line\"></div><div class=\"line\">mysql&gt; use mysql</div><div class=\"line\">Reading table information for completion of table and column names</div><div class=\"line\">You can turn off this feature to get a quicker startup with -A</div><div class=\"line\"></div><div class=\"line\">Database changed</div><div class=\"line\">mysql&gt; update user set password=password(&apos;new-pass&apos;) where user=&apos;root&apos;;</div><div class=\"line\">Query OK, 5 rows affected (0.00 sec)</div><div class=\"line\">Rows matched: 5  Changed: 5  Warnings: 0</div></pre></td></tr></table></figure>\n</li>\n<li><p>配置文件去除skip-grant-tables，并重启服务器.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# vim /etc/my.cnf</div><div class=\"line\">[root@demo ~]# service mysqld restart</div></pre></td></tr></table></figure>\n</li>\n<li><p>使用新密码登录到mysql</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# mysql -h localhost -u root -p</div></pre></td></tr></table></figure>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"1-处理的状态\"><a href=\"#1-处理的状态\" class=\"headerlink\" title=\"1. 处理的状态\"></a>1. 处理的状态</h4><p> 首先确认服务器出于安全的状态，也就是没有人能够任意地连接MySQL数据库。<br>因为在重新设置MySQL的root密码的期间，MySQL数据库完全出于没有密码保护的<br>状态下，其他的用户也可以任意地登录和修改MySQL的信息。可以采用将MySQL对<br>外的端口封闭，并且停止Apache以及所有的用户进程的方法实现服务器的准安全<br>状态。最安全的状态是到服务器的Console上面操作，并且拔掉网线。</p>\n<h4 id=\"2-重置密码\"><a href=\"#2-重置密码\" class=\"headerlink\" title=\"2. 重置密码\"></a>2. 重置密码</h4><ol>\n<li><p>修改mysql配置文件，增加skip-grant-tables</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# vim /etc/my.cnf</div><div class=\"line\">[mysqld]</div><div class=\"line\">skip-grant-tables</div></pre></td></tr></table></figure>\n</li>\n<li><p>重启mysqld</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# service mysqld restart</div><div class=\"line\">Stopping mysqld:                                           [  OK  ]</div><div class=\"line\">Starting mysqld:                                           [  OK  ]</div></pre></td></tr></table></figure>\n</li>\n<li><p>登录mysql，并修改root密码.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# mysql -u root</div><div class=\"line\">Welcome to the MySQL monitor.  Commands end with ; or \\g.</div><div class=\"line\">Your MySQL connection id is 3</div><div class=\"line\">Server version: 5.5.53 MySQL Community Server (GPL)</div><div class=\"line\"></div><div class=\"line\">Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.</div><div class=\"line\"></div><div class=\"line\">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class=\"line\">affiliates. Other names may be trademarks of their respective</div><div class=\"line\">owners.</div><div class=\"line\"></div><div class=\"line\">Type &apos;help;&apos; or &apos;\\h&apos; for help. Type &apos;\\c&apos; to clear the current input statement.</div><div class=\"line\"></div><div class=\"line\">mysql&gt; use mysql</div><div class=\"line\">Reading table information for completion of table and column names</div><div class=\"line\">You can turn off this feature to get a quicker startup with -A</div><div class=\"line\"></div><div class=\"line\">Database changed</div><div class=\"line\">mysql&gt; update user set password=password(&apos;new-pass&apos;) where user=&apos;root&apos;;</div><div class=\"line\">Query OK, 5 rows affected (0.00 sec)</div><div class=\"line\">Rows matched: 5  Changed: 5  Warnings: 0</div></pre></td></tr></table></figure>\n</li>\n<li><p>配置文件去除skip-grant-tables，并重启服务器.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# vim /etc/my.cnf</div><div class=\"line\">[root@demo ~]# service mysqld restart</div></pre></td></tr></table></figure>\n</li>\n<li><p>使用新密码登录到mysql</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@demo ~]# mysql -h localhost -u root -p</div></pre></td></tr></table></figure>\n</li>\n</ol>\n"},{"title":"HowTo Setup MariaDB Galera Cluster 10 On CentOS 6.x","id":"86","updated":"2017-04-21T05:22:54.000Z","date":"2016-08-04T05:14:15.000Z","_content":"\n####  介绍\n<p>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MariaDB Galera Cluster 是一套在MySQL InnoDB存储引擎上面实现multi-master及数据实时同步的系统架构，业务层面无需做读写分离工作，数据库读写压力都能按照既定的规则分发到 各个节点上去。在数据方面完全兼容 MariaDB 和 MySQL。使用MariaDB Galera的解决方案，可以方便快速的搭建出高可用的数据库Cluster，不是主备模式，而是双活模式，也就是说，没有主节点和备份节点，每个节点都可以看做是主节点，都可以进行读写，由Galera来实现底层的数据同步。\n</p>\n\n* 真正的多主架构，任何节点都可以进行读写\n* 同步复制，各节点间无延迟且节点宕机不会导致数据丢失\n* 紧密耦合，所有节点均保持相同状态\n* 自动节点配置，无需手工备份当前数据库并拷贝至新节点\n\n####  实验环境\n\n* Cluster node4 IP address 172.16.102.168\n* Cluster node5 IP address 172.16.102.165\n* Cluster node6 IP address 172.16.102.164\n* setenforce 0；sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config\n* /etc/init.d/iptables stop;chkconfig iptables off\n\n> 使用vmware 测试需注意:克隆机器需要删除 <code>/etc/udev/rules.d/70-persistent-net.rules</code> 以及<code>/etc/sysconfig/network-scripts/ifcfg-eth0</code>中的网卡mac地址选项，不然网卡起不来\n\n####  环境检测\n* 检查iptables状态：/etc/init.d/iptables status;chkconfig --list | grep iptables\n* 检查selinux状态：getenforce\n* 检查openssh-client包是否安装：系统中是否有ssh命令\n* 检查是否系统中含有mysql相关的包：rpm -qa | grep mysql，有的话都需要卸载掉\n* 检查网络是否通畅：ping www.baidu.com\n\n#### 安装\n##### 1. 在所有节点编辑/etc/hosts\n```\n[root@node4 ~]# vi /etc/hosts\n\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n\n# add follows\n172.16.102.164 node6\n172.16.102.165 node5\n172.16.102.168 node4\n\n[root@node4 ~]#\n\n# 依次在node5和node6上编辑/etc/hosts\n```\n\n##### 2. 在所有node上安装 MariaDB Galera\n```\n[root@node4 ~]# vi /etc/yum.repos.d/mariadb.repo\n # MariaDB 10.0 CentOS repository list\n# http://mariadb.org/mariadb/repositories/\n[mariadb]\nname = MariaDB\nbaseurl = http://yum.mariadb.org/10.0/centos6-amd64\ngpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB\ngpgcheck=1\nenabled=0\n\n[root@node4 ~]# yum --enablerepo=mariadb -y install MariaDB-Galera-server\n\n# 依次在node5和node6上安装 MariaDB-Galera-server\n```\n\n> <i>注意安装完成之后，不要启动mysql</i>\n\n##### 3. 在其中一个节点上编辑/etc/my.cnf.d/server.cnf配置文件\n```\n[root@node4 ~]# vi /etc/my.cnf.d/server.cnf\n# 19 行，取消下面的注释，并修改为需求\n[galera]\nwsrep_provider=/usr/lib64/galera/libgalera_smm.so\n# 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。\nwsrep_cluster_address=\"gcomm://node4,node5,node6\"\nbinlog_format=row\ndefault_storage_engine=InnoDB\ninnodb_autoinc_lock_mode=2\nbind-address=0.0.0.0\n\n# add follows\n# cluster name\nwsrep_cluster_name=\"Visionet_MariaDB_Cluster\"\n# replication provider\nwsrep_sst_method=rsync\n# own IP address\nwsrep_node_address=\"172.16.102.168\"\nwsrep_node_name=\"node4\"\n\n# 启动数据库\n[root@node4 ~]# /etc/rc.d/init.d/mysql bootstrap\nStarting MySQL. SUCCESS!\n\n# 初始化你的数据库\n[root@node4 ~]# mysql_secure_installation\n```\n\n##### 4. 在其它节点上编辑/etc/my.cnf.d/server.cnf配置文件\n\n##### node5\n```\n[root@node5 ~]# vi /etc/my.cnf.d/server.cnf\n# 19 行，取消下面的注释，并修改为需求\n[galera]\nwsrep_provider=/usr/lib64/galera/libgalera_smm.so\n# 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。\nwsrep_cluster_address=\"gcomm://node4,node5,node6\"\nbinlog_format=row\ndefault_storage_engine=InnoDB\ninnodb_autoinc_lock_mode=2\nbind-address=0.0.0.0\n\n# add follows\n# cluster name\nwsrep_cluster_name=\"Visionet_MariaDB_Cluster\"\n# replication provider\nwsrep_sst_method=rsync\n\n# 以下内容注意，注意应设置为当前服务器信息\nwsrep_node_address=\"172.16.102.165\"\nwsrep_node_name=\"node5\"\n\n# 启动数据库\n[root@node5 ~]# /etc/rc.d/init.d/mysql start\nStarting MySQL...SST in progress, setting sleep higher. SUCCESS!\n```\n\n##### node6\n```\n[root@node6 ~]# vi /etc/my.cnf.d/server.cnf\n# 19 行，取消下面的注释，并修改为需求\n[galera]\nwsrep_provider=/usr/lib64/galera/libgalera_smm.so\n# 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。\nwsrep_cluster_address=\"gcomm://node4,node5,node6\"\nbinlog_format=row\ndefault_storage_engine=InnoDB\ninnodb_autoinc_lock_mode=2\nbind-address=0.0.0.0\n\n# add follows\n# cluster name\nwsrep_cluster_name=\"Visionet_MariaDB_Cluster\"\n# replication provider\nwsrep_sst_method=rsync\n\n# 以下内容注意，注意应设置为当前服务器信息\nwsrep_node_address=\"172.16.102.164\"\nwsrep_node_name=\"node6\"\n\n# 启动数据库\n[root@node6 ~]# /etc/rc.d/init.d/mysql start\nStarting MySQL...SST in progress, setting sleep higher. SUCCESS!\n```\n\n> 注意：只需要初始化第一个节点服务器的数据库，其他数据的配置文件会自动同步，所以你给node4设置的root可以在node5和node6直接使用，当然这是安装正确的前提。\n\n#### 登陆各个节点数据库检查配置是否成功\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server.cnf的配置如果没有问题，那么wsrep\\_local\\_state_comment的状态应该是Synced。\n```\n[root@node4 ~]# mysql -u root -p\nEnter password:\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 15\nServer version: 10.0.26-MariaDB-wsrep MariaDB Server, wsrep_25.13.raf7f02e\n\nCopyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> show status like 'wsrep_local_state_comment';\n+---------------------------+--------+\n| Variable_name             | Value  |\n+---------------------------+--------+\n| wsrep_local_state_comment | Synced |\n+---------------------------+--------+\n1 row in set (0.01 sec)\n\nMariaDB [(none)]>\n```\n\n####  结论\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MariaDB Galera没有主节点和备份节点，配置成功之后，可以在任何一个node节点上操作会自动同步到其他节点，任何一个节点宕机不会影响其他节点的数据和稳定性，配置HAProxy设置VIP的方式来实现负载均衡，提高服务的高可用性，另外，当宕机节点上线之后，事务会自动同步不丢失。\n\n\n\n\n\n\n\n","source":"_posts/HowTo-Setup-MariaDB-Galera-Cluster-10-On-CentOS-6-x.md","raw":"---\ntitle: HowTo Setup MariaDB Galera Cluster 10 On CentOS 6.x\ntags: 'MariaDB'\ncategories: 'MySQL'\npermalink: how-to-setup-mariadb-galera-cluster-10-on-centos-6\nid: 86\nupdated: '2017-04-21 13:22:54'\ndate: 2016-08-04 13:14:15\n---\n\n####  介绍\n<p>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MariaDB Galera Cluster 是一套在MySQL InnoDB存储引擎上面实现multi-master及数据实时同步的系统架构，业务层面无需做读写分离工作，数据库读写压力都能按照既定的规则分发到 各个节点上去。在数据方面完全兼容 MariaDB 和 MySQL。使用MariaDB Galera的解决方案，可以方便快速的搭建出高可用的数据库Cluster，不是主备模式，而是双活模式，也就是说，没有主节点和备份节点，每个节点都可以看做是主节点，都可以进行读写，由Galera来实现底层的数据同步。\n</p>\n\n* 真正的多主架构，任何节点都可以进行读写\n* 同步复制，各节点间无延迟且节点宕机不会导致数据丢失\n* 紧密耦合，所有节点均保持相同状态\n* 自动节点配置，无需手工备份当前数据库并拷贝至新节点\n\n####  实验环境\n\n* Cluster node4 IP address 172.16.102.168\n* Cluster node5 IP address 172.16.102.165\n* Cluster node6 IP address 172.16.102.164\n* setenforce 0；sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config\n* /etc/init.d/iptables stop;chkconfig iptables off\n\n> 使用vmware 测试需注意:克隆机器需要删除 <code>/etc/udev/rules.d/70-persistent-net.rules</code> 以及<code>/etc/sysconfig/network-scripts/ifcfg-eth0</code>中的网卡mac地址选项，不然网卡起不来\n\n####  环境检测\n* 检查iptables状态：/etc/init.d/iptables status;chkconfig --list | grep iptables\n* 检查selinux状态：getenforce\n* 检查openssh-client包是否安装：系统中是否有ssh命令\n* 检查是否系统中含有mysql相关的包：rpm -qa | grep mysql，有的话都需要卸载掉\n* 检查网络是否通畅：ping www.baidu.com\n\n#### 安装\n##### 1. 在所有节点编辑/etc/hosts\n```\n[root@node4 ~]# vi /etc/hosts\n\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n\n# add follows\n172.16.102.164 node6\n172.16.102.165 node5\n172.16.102.168 node4\n\n[root@node4 ~]#\n\n# 依次在node5和node6上编辑/etc/hosts\n```\n\n##### 2. 在所有node上安装 MariaDB Galera\n```\n[root@node4 ~]# vi /etc/yum.repos.d/mariadb.repo\n # MariaDB 10.0 CentOS repository list\n# http://mariadb.org/mariadb/repositories/\n[mariadb]\nname = MariaDB\nbaseurl = http://yum.mariadb.org/10.0/centos6-amd64\ngpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB\ngpgcheck=1\nenabled=0\n\n[root@node4 ~]# yum --enablerepo=mariadb -y install MariaDB-Galera-server\n\n# 依次在node5和node6上安装 MariaDB-Galera-server\n```\n\n> <i>注意安装完成之后，不要启动mysql</i>\n\n##### 3. 在其中一个节点上编辑/etc/my.cnf.d/server.cnf配置文件\n```\n[root@node4 ~]# vi /etc/my.cnf.d/server.cnf\n# 19 行，取消下面的注释，并修改为需求\n[galera]\nwsrep_provider=/usr/lib64/galera/libgalera_smm.so\n# 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。\nwsrep_cluster_address=\"gcomm://node4,node5,node6\"\nbinlog_format=row\ndefault_storage_engine=InnoDB\ninnodb_autoinc_lock_mode=2\nbind-address=0.0.0.0\n\n# add follows\n# cluster name\nwsrep_cluster_name=\"Visionet_MariaDB_Cluster\"\n# replication provider\nwsrep_sst_method=rsync\n# own IP address\nwsrep_node_address=\"172.16.102.168\"\nwsrep_node_name=\"node4\"\n\n# 启动数据库\n[root@node4 ~]# /etc/rc.d/init.d/mysql bootstrap\nStarting MySQL. SUCCESS!\n\n# 初始化你的数据库\n[root@node4 ~]# mysql_secure_installation\n```\n\n##### 4. 在其它节点上编辑/etc/my.cnf.d/server.cnf配置文件\n\n##### node5\n```\n[root@node5 ~]# vi /etc/my.cnf.d/server.cnf\n# 19 行，取消下面的注释，并修改为需求\n[galera]\nwsrep_provider=/usr/lib64/galera/libgalera_smm.so\n# 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。\nwsrep_cluster_address=\"gcomm://node4,node5,node6\"\nbinlog_format=row\ndefault_storage_engine=InnoDB\ninnodb_autoinc_lock_mode=2\nbind-address=0.0.0.0\n\n# add follows\n# cluster name\nwsrep_cluster_name=\"Visionet_MariaDB_Cluster\"\n# replication provider\nwsrep_sst_method=rsync\n\n# 以下内容注意，注意应设置为当前服务器信息\nwsrep_node_address=\"172.16.102.165\"\nwsrep_node_name=\"node5\"\n\n# 启动数据库\n[root@node5 ~]# /etc/rc.d/init.d/mysql start\nStarting MySQL...SST in progress, setting sleep higher. SUCCESS!\n```\n\n##### node6\n```\n[root@node6 ~]# vi /etc/my.cnf.d/server.cnf\n# 19 行，取消下面的注释，并修改为需求\n[galera]\nwsrep_provider=/usr/lib64/galera/libgalera_smm.so\n# 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。\nwsrep_cluster_address=\"gcomm://node4,node5,node6\"\nbinlog_format=row\ndefault_storage_engine=InnoDB\ninnodb_autoinc_lock_mode=2\nbind-address=0.0.0.0\n\n# add follows\n# cluster name\nwsrep_cluster_name=\"Visionet_MariaDB_Cluster\"\n# replication provider\nwsrep_sst_method=rsync\n\n# 以下内容注意，注意应设置为当前服务器信息\nwsrep_node_address=\"172.16.102.164\"\nwsrep_node_name=\"node6\"\n\n# 启动数据库\n[root@node6 ~]# /etc/rc.d/init.d/mysql start\nStarting MySQL...SST in progress, setting sleep higher. SUCCESS!\n```\n\n> 注意：只需要初始化第一个节点服务器的数据库，其他数据的配置文件会自动同步，所以你给node4设置的root可以在node5和node6直接使用，当然这是安装正确的前提。\n\n#### 登陆各个节点数据库检查配置是否成功\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server.cnf的配置如果没有问题，那么wsrep\\_local\\_state_comment的状态应该是Synced。\n```\n[root@node4 ~]# mysql -u root -p\nEnter password:\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 15\nServer version: 10.0.26-MariaDB-wsrep MariaDB Server, wsrep_25.13.raf7f02e\n\nCopyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> show status like 'wsrep_local_state_comment';\n+---------------------------+--------+\n| Variable_name             | Value  |\n+---------------------------+--------+\n| wsrep_local_state_comment | Synced |\n+---------------------------+--------+\n1 row in set (0.01 sec)\n\nMariaDB [(none)]>\n```\n\n####  结论\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MariaDB Galera没有主节点和备份节点，配置成功之后，可以在任何一个node节点上操作会自动同步到其他节点，任何一个节点宕机不会影响其他节点的数据和稳定性，配置HAProxy设置VIP的方式来实现负载均衡，提高服务的高可用性，另外，当宕机节点上线之后，事务会自动同步不丢失。\n\n\n\n\n\n\n\n","slug":"how-to-setup-mariadb-galera-cluster-10-on-centos-6","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq9p003e41tpzonnx3wv","content":"<h4 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h4><p><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MariaDB Galera Cluster 是一套在MySQL InnoDB存储引擎上面实现multi-master及数据实时同步的系统架构，业务层面无需做读写分离工作，数据库读写压力都能按照既定的规则分发到 各个节点上去。在数据方面完全兼容 MariaDB 和 MySQL。使用MariaDB Galera的解决方案，可以方便快速的搭建出高可用的数据库Cluster，不是主备模式，而是双活模式，也就是说，没有主节点和备份节点，每个节点都可以看做是主节点，都可以进行读写，由Galera来实现底层的数据同步。<br></p>\n\n<ul>\n<li>真正的多主架构，任何节点都可以进行读写</li>\n<li>同步复制，各节点间无延迟且节点宕机不会导致数据丢失</li>\n<li>紧密耦合，所有节点均保持相同状态</li>\n<li>自动节点配置，无需手工备份当前数据库并拷贝至新节点</li>\n</ul>\n<h4 id=\"实验环境\"><a href=\"#实验环境\" class=\"headerlink\" title=\"实验环境\"></a>实验环境</h4><ul>\n<li>Cluster node4 IP address 172.16.102.168</li>\n<li>Cluster node5 IP address 172.16.102.165</li>\n<li>Cluster node6 IP address 172.16.102.164</li>\n<li>setenforce 0；sed -i ‘s/SELINUX=enforcing/SELINUX=disabled/‘ /etc/selinux/config</li>\n<li>/etc/init.d/iptables stop;chkconfig iptables off</li>\n</ul>\n<blockquote>\n<p>使用vmware 测试需注意:克隆机器需要删除 <code>/etc/udev/rules.d/70-persistent-net.rules</code> 以及<code>/etc/sysconfig/network-scripts/ifcfg-eth0</code>中的网卡mac地址选项，不然网卡起不来</p>\n</blockquote>\n<h4 id=\"环境检测\"><a href=\"#环境检测\" class=\"headerlink\" title=\"环境检测\"></a>环境检测</h4><ul>\n<li>检查iptables状态：/etc/init.d/iptables status;chkconfig –list | grep iptables</li>\n<li>检查selinux状态：getenforce</li>\n<li>检查openssh-client包是否安装：系统中是否有ssh命令</li>\n<li>检查是否系统中含有mysql相关的包：rpm -qa | grep mysql，有的话都需要卸载掉</li>\n<li>检查网络是否通畅：ping www.baidu.com</li>\n</ul>\n<h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><h5 id=\"1-在所有节点编辑-etc-hosts\"><a href=\"#1-在所有节点编辑-etc-hosts\" class=\"headerlink\" title=\"1. 在所有节点编辑/etc/hosts\"></a>1. 在所有节点编辑/etc/hosts</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node4 ~]# vi /etc/hosts</div><div class=\"line\"></div><div class=\"line\">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</div><div class=\"line\">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</div><div class=\"line\"></div><div class=\"line\"># add follows</div><div class=\"line\">172.16.102.164 node6</div><div class=\"line\">172.16.102.165 node5</div><div class=\"line\">172.16.102.168 node4</div><div class=\"line\"></div><div class=\"line\">[root@node4 ~]#</div><div class=\"line\"></div><div class=\"line\"># 依次在node5和node6上编辑/etc/hosts</div></pre></td></tr></table></figure>\n<h5 id=\"2-在所有node上安装-MariaDB-Galera\"><a href=\"#2-在所有node上安装-MariaDB-Galera\" class=\"headerlink\" title=\"2. 在所有node上安装 MariaDB Galera\"></a>2. 在所有node上安装 MariaDB Galera</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node4 ~]# vi /etc/yum.repos.d/mariadb.repo</div><div class=\"line\"> # MariaDB 10.0 CentOS repository list</div><div class=\"line\"># http://mariadb.org/mariadb/repositories/</div><div class=\"line\">[mariadb]</div><div class=\"line\">name = MariaDB</div><div class=\"line\">baseurl = http://yum.mariadb.org/10.0/centos6-amd64</div><div class=\"line\">gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">enabled=0</div><div class=\"line\"></div><div class=\"line\">[root@node4 ~]# yum --enablerepo=mariadb -y install MariaDB-Galera-server</div><div class=\"line\"></div><div class=\"line\"># 依次在node5和node6上安装 MariaDB-Galera-server</div></pre></td></tr></table></figure>\n<blockquote>\n<p><i>注意安装完成之后，不要启动mysql</i></p>\n</blockquote>\n<h5 id=\"3-在其中一个节点上编辑-etc-my-cnf-d-server-cnf配置文件\"><a href=\"#3-在其中一个节点上编辑-etc-my-cnf-d-server-cnf配置文件\" class=\"headerlink\" title=\"3. 在其中一个节点上编辑/etc/my.cnf.d/server.cnf配置文件\"></a>3. 在其中一个节点上编辑/etc/my.cnf.d/server.cnf配置文件</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node4 ~]# vi /etc/my.cnf.d/server.cnf</div><div class=\"line\"># 19 行，取消下面的注释，并修改为需求</div><div class=\"line\">[galera]</div><div class=\"line\">wsrep_provider=/usr/lib64/galera/libgalera_smm.so</div><div class=\"line\"># 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。</div><div class=\"line\">wsrep_cluster_address=&quot;gcomm://node4,node5,node6&quot;</div><div class=\"line\">binlog_format=row</div><div class=\"line\">default_storage_engine=InnoDB</div><div class=\"line\">innodb_autoinc_lock_mode=2</div><div class=\"line\">bind-address=0.0.0.0</div><div class=\"line\"></div><div class=\"line\"># add follows</div><div class=\"line\"># cluster name</div><div class=\"line\">wsrep_cluster_name=&quot;Visionet_MariaDB_Cluster&quot;</div><div class=\"line\"># replication provider</div><div class=\"line\">wsrep_sst_method=rsync</div><div class=\"line\"># own IP address</div><div class=\"line\">wsrep_node_address=&quot;172.16.102.168&quot;</div><div class=\"line\">wsrep_node_name=&quot;node4&quot;</div><div class=\"line\"></div><div class=\"line\"># 启动数据库</div><div class=\"line\">[root@node4 ~]# /etc/rc.d/init.d/mysql bootstrap</div><div class=\"line\">Starting MySQL. SUCCESS!</div><div class=\"line\"></div><div class=\"line\"># 初始化你的数据库</div><div class=\"line\">[root@node4 ~]# mysql_secure_installation</div></pre></td></tr></table></figure>\n<h5 id=\"4-在其它节点上编辑-etc-my-cnf-d-server-cnf配置文件\"><a href=\"#4-在其它节点上编辑-etc-my-cnf-d-server-cnf配置文件\" class=\"headerlink\" title=\"4. 在其它节点上编辑/etc/my.cnf.d/server.cnf配置文件\"></a>4. 在其它节点上编辑/etc/my.cnf.d/server.cnf配置文件</h5><h5 id=\"node5\"><a href=\"#node5\" class=\"headerlink\" title=\"node5\"></a>node5</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node5 ~]# vi /etc/my.cnf.d/server.cnf</div><div class=\"line\"># 19 行，取消下面的注释，并修改为需求</div><div class=\"line\">[galera]</div><div class=\"line\">wsrep_provider=/usr/lib64/galera/libgalera_smm.so</div><div class=\"line\"># 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。</div><div class=\"line\">wsrep_cluster_address=&quot;gcomm://node4,node5,node6&quot;</div><div class=\"line\">binlog_format=row</div><div class=\"line\">default_storage_engine=InnoDB</div><div class=\"line\">innodb_autoinc_lock_mode=2</div><div class=\"line\">bind-address=0.0.0.0</div><div class=\"line\"></div><div class=\"line\"># add follows</div><div class=\"line\"># cluster name</div><div class=\"line\">wsrep_cluster_name=&quot;Visionet_MariaDB_Cluster&quot;</div><div class=\"line\"># replication provider</div><div class=\"line\">wsrep_sst_method=rsync</div><div class=\"line\"></div><div class=\"line\"># 以下内容注意，注意应设置为当前服务器信息</div><div class=\"line\">wsrep_node_address=&quot;172.16.102.165&quot;</div><div class=\"line\">wsrep_node_name=&quot;node5&quot;</div><div class=\"line\"></div><div class=\"line\"># 启动数据库</div><div class=\"line\">[root@node5 ~]# /etc/rc.d/init.d/mysql start</div><div class=\"line\">Starting MySQL...SST in progress, setting sleep higher. SUCCESS!</div></pre></td></tr></table></figure>\n<h5 id=\"node6\"><a href=\"#node6\" class=\"headerlink\" title=\"node6\"></a>node6</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node6 ~]# vi /etc/my.cnf.d/server.cnf</div><div class=\"line\"># 19 行，取消下面的注释，并修改为需求</div><div class=\"line\">[galera]</div><div class=\"line\">wsrep_provider=/usr/lib64/galera/libgalera_smm.so</div><div class=\"line\"># 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。</div><div class=\"line\">wsrep_cluster_address=&quot;gcomm://node4,node5,node6&quot;</div><div class=\"line\">binlog_format=row</div><div class=\"line\">default_storage_engine=InnoDB</div><div class=\"line\">innodb_autoinc_lock_mode=2</div><div class=\"line\">bind-address=0.0.0.0</div><div class=\"line\"></div><div class=\"line\"># add follows</div><div class=\"line\"># cluster name</div><div class=\"line\">wsrep_cluster_name=&quot;Visionet_MariaDB_Cluster&quot;</div><div class=\"line\"># replication provider</div><div class=\"line\">wsrep_sst_method=rsync</div><div class=\"line\"></div><div class=\"line\"># 以下内容注意，注意应设置为当前服务器信息</div><div class=\"line\">wsrep_node_address=&quot;172.16.102.164&quot;</div><div class=\"line\">wsrep_node_name=&quot;node6&quot;</div><div class=\"line\"></div><div class=\"line\"># 启动数据库</div><div class=\"line\">[root@node6 ~]# /etc/rc.d/init.d/mysql start</div><div class=\"line\">Starting MySQL...SST in progress, setting sleep higher. SUCCESS!</div></pre></td></tr></table></figure>\n<blockquote>\n<p>注意：只需要初始化第一个节点服务器的数据库，其他数据的配置文件会自动同步，所以你给node4设置的root可以在node5和node6直接使用，当然这是安装正确的前提。</p>\n</blockquote>\n<h4 id=\"登陆各个节点数据库检查配置是否成功\"><a href=\"#登陆各个节点数据库检查配置是否成功\" class=\"headerlink\" title=\"登陆各个节点数据库检查配置是否成功\"></a>登陆各个节点数据库检查配置是否成功</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server.cnf的配置如果没有问题，那么wsrep_local_state_comment的状态应该是Synced。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node4 ~]# mysql -u root -p</div><div class=\"line\">Enter password:</div><div class=\"line\">Welcome to the MariaDB monitor.  Commands end with ; or \\g.</div><div class=\"line\">Your MariaDB connection id is 15</div><div class=\"line\">Server version: 10.0.26-MariaDB-wsrep MariaDB Server, wsrep_25.13.raf7f02e</div><div class=\"line\"></div><div class=\"line\">Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.</div><div class=\"line\"></div><div class=\"line\">Type &apos;help;&apos; or &apos;\\h&apos; for help. Type &apos;\\c&apos; to clear the current input statement.</div><div class=\"line\"></div><div class=\"line\">MariaDB [(none)]&gt; show status like &apos;wsrep_local_state_comment&apos;;</div><div class=\"line\">+---------------------------+--------+</div><div class=\"line\">| Variable_name             | Value  |</div><div class=\"line\">+---------------------------+--------+</div><div class=\"line\">| wsrep_local_state_comment | Synced |</div><div class=\"line\">+---------------------------+--------+</div><div class=\"line\">1 row in set (0.01 sec)</div><div class=\"line\"></div><div class=\"line\">MariaDB [(none)]&gt;</div></pre></td></tr></table></figure></p>\n<h4 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MariaDB Galera没有主节点和备份节点，配置成功之后，可以在任何一个node节点上操作会自动同步到其他节点，任何一个节点宕机不会影响其他节点的数据和稳定性，配置HAProxy设置VIP的方式来实现负载均衡，提高服务的高可用性，另外，当宕机节点上线之后，事务会自动同步不丢失。</p>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h4><p><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MariaDB Galera Cluster 是一套在MySQL InnoDB存储引擎上面实现multi-master及数据实时同步的系统架构，业务层面无需做读写分离工作，数据库读写压力都能按照既定的规则分发到 各个节点上去。在数据方面完全兼容 MariaDB 和 MySQL。使用MariaDB Galera的解决方案，可以方便快速的搭建出高可用的数据库Cluster，不是主备模式，而是双活模式，也就是说，没有主节点和备份节点，每个节点都可以看做是主节点，都可以进行读写，由Galera来实现底层的数据同步。<br></p>\n\n<ul>\n<li>真正的多主架构，任何节点都可以进行读写</li>\n<li>同步复制，各节点间无延迟且节点宕机不会导致数据丢失</li>\n<li>紧密耦合，所有节点均保持相同状态</li>\n<li>自动节点配置，无需手工备份当前数据库并拷贝至新节点</li>\n</ul>\n<h4 id=\"实验环境\"><a href=\"#实验环境\" class=\"headerlink\" title=\"实验环境\"></a>实验环境</h4><ul>\n<li>Cluster node4 IP address 172.16.102.168</li>\n<li>Cluster node5 IP address 172.16.102.165</li>\n<li>Cluster node6 IP address 172.16.102.164</li>\n<li>setenforce 0；sed -i ‘s/SELINUX=enforcing/SELINUX=disabled/‘ /etc/selinux/config</li>\n<li>/etc/init.d/iptables stop;chkconfig iptables off</li>\n</ul>\n<blockquote>\n<p>使用vmware 测试需注意:克隆机器需要删除 <code>/etc/udev/rules.d/70-persistent-net.rules</code> 以及<code>/etc/sysconfig/network-scripts/ifcfg-eth0</code>中的网卡mac地址选项，不然网卡起不来</p>\n</blockquote>\n<h4 id=\"环境检测\"><a href=\"#环境检测\" class=\"headerlink\" title=\"环境检测\"></a>环境检测</h4><ul>\n<li>检查iptables状态：/etc/init.d/iptables status;chkconfig –list | grep iptables</li>\n<li>检查selinux状态：getenforce</li>\n<li>检查openssh-client包是否安装：系统中是否有ssh命令</li>\n<li>检查是否系统中含有mysql相关的包：rpm -qa | grep mysql，有的话都需要卸载掉</li>\n<li>检查网络是否通畅：ping www.baidu.com</li>\n</ul>\n<h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><h5 id=\"1-在所有节点编辑-etc-hosts\"><a href=\"#1-在所有节点编辑-etc-hosts\" class=\"headerlink\" title=\"1. 在所有节点编辑/etc/hosts\"></a>1. 在所有节点编辑/etc/hosts</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node4 ~]# vi /etc/hosts</div><div class=\"line\"></div><div class=\"line\">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</div><div class=\"line\">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</div><div class=\"line\"></div><div class=\"line\"># add follows</div><div class=\"line\">172.16.102.164 node6</div><div class=\"line\">172.16.102.165 node5</div><div class=\"line\">172.16.102.168 node4</div><div class=\"line\"></div><div class=\"line\">[root@node4 ~]#</div><div class=\"line\"></div><div class=\"line\"># 依次在node5和node6上编辑/etc/hosts</div></pre></td></tr></table></figure>\n<h5 id=\"2-在所有node上安装-MariaDB-Galera\"><a href=\"#2-在所有node上安装-MariaDB-Galera\" class=\"headerlink\" title=\"2. 在所有node上安装 MariaDB Galera\"></a>2. 在所有node上安装 MariaDB Galera</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node4 ~]# vi /etc/yum.repos.d/mariadb.repo</div><div class=\"line\"> # MariaDB 10.0 CentOS repository list</div><div class=\"line\"># http://mariadb.org/mariadb/repositories/</div><div class=\"line\">[mariadb]</div><div class=\"line\">name = MariaDB</div><div class=\"line\">baseurl = http://yum.mariadb.org/10.0/centos6-amd64</div><div class=\"line\">gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">enabled=0</div><div class=\"line\"></div><div class=\"line\">[root@node4 ~]# yum --enablerepo=mariadb -y install MariaDB-Galera-server</div><div class=\"line\"></div><div class=\"line\"># 依次在node5和node6上安装 MariaDB-Galera-server</div></pre></td></tr></table></figure>\n<blockquote>\n<p><i>注意安装完成之后，不要启动mysql</i></p>\n</blockquote>\n<h5 id=\"3-在其中一个节点上编辑-etc-my-cnf-d-server-cnf配置文件\"><a href=\"#3-在其中一个节点上编辑-etc-my-cnf-d-server-cnf配置文件\" class=\"headerlink\" title=\"3. 在其中一个节点上编辑/etc/my.cnf.d/server.cnf配置文件\"></a>3. 在其中一个节点上编辑/etc/my.cnf.d/server.cnf配置文件</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node4 ~]# vi /etc/my.cnf.d/server.cnf</div><div class=\"line\"># 19 行，取消下面的注释，并修改为需求</div><div class=\"line\">[galera]</div><div class=\"line\">wsrep_provider=/usr/lib64/galera/libgalera_smm.so</div><div class=\"line\"># 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。</div><div class=\"line\">wsrep_cluster_address=&quot;gcomm://node4,node5,node6&quot;</div><div class=\"line\">binlog_format=row</div><div class=\"line\">default_storage_engine=InnoDB</div><div class=\"line\">innodb_autoinc_lock_mode=2</div><div class=\"line\">bind-address=0.0.0.0</div><div class=\"line\"></div><div class=\"line\"># add follows</div><div class=\"line\"># cluster name</div><div class=\"line\">wsrep_cluster_name=&quot;Visionet_MariaDB_Cluster&quot;</div><div class=\"line\"># replication provider</div><div class=\"line\">wsrep_sst_method=rsync</div><div class=\"line\"># own IP address</div><div class=\"line\">wsrep_node_address=&quot;172.16.102.168&quot;</div><div class=\"line\">wsrep_node_name=&quot;node4&quot;</div><div class=\"line\"></div><div class=\"line\"># 启动数据库</div><div class=\"line\">[root@node4 ~]# /etc/rc.d/init.d/mysql bootstrap</div><div class=\"line\">Starting MySQL. SUCCESS!</div><div class=\"line\"></div><div class=\"line\"># 初始化你的数据库</div><div class=\"line\">[root@node4 ~]# mysql_secure_installation</div></pre></td></tr></table></figure>\n<h5 id=\"4-在其它节点上编辑-etc-my-cnf-d-server-cnf配置文件\"><a href=\"#4-在其它节点上编辑-etc-my-cnf-d-server-cnf配置文件\" class=\"headerlink\" title=\"4. 在其它节点上编辑/etc/my.cnf.d/server.cnf配置文件\"></a>4. 在其它节点上编辑/etc/my.cnf.d/server.cnf配置文件</h5><h5 id=\"node5\"><a href=\"#node5\" class=\"headerlink\" title=\"node5\"></a>node5</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node5 ~]# vi /etc/my.cnf.d/server.cnf</div><div class=\"line\"># 19 行，取消下面的注释，并修改为需求</div><div class=\"line\">[galera]</div><div class=\"line\">wsrep_provider=/usr/lib64/galera/libgalera_smm.so</div><div class=\"line\"># 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。</div><div class=\"line\">wsrep_cluster_address=&quot;gcomm://node4,node5,node6&quot;</div><div class=\"line\">binlog_format=row</div><div class=\"line\">default_storage_engine=InnoDB</div><div class=\"line\">innodb_autoinc_lock_mode=2</div><div class=\"line\">bind-address=0.0.0.0</div><div class=\"line\"></div><div class=\"line\"># add follows</div><div class=\"line\"># cluster name</div><div class=\"line\">wsrep_cluster_name=&quot;Visionet_MariaDB_Cluster&quot;</div><div class=\"line\"># replication provider</div><div class=\"line\">wsrep_sst_method=rsync</div><div class=\"line\"></div><div class=\"line\"># 以下内容注意，注意应设置为当前服务器信息</div><div class=\"line\">wsrep_node_address=&quot;172.16.102.165&quot;</div><div class=\"line\">wsrep_node_name=&quot;node5&quot;</div><div class=\"line\"></div><div class=\"line\"># 启动数据库</div><div class=\"line\">[root@node5 ~]# /etc/rc.d/init.d/mysql start</div><div class=\"line\">Starting MySQL...SST in progress, setting sleep higher. SUCCESS!</div></pre></td></tr></table></figure>\n<h5 id=\"node6\"><a href=\"#node6\" class=\"headerlink\" title=\"node6\"></a>node6</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node6 ~]# vi /etc/my.cnf.d/server.cnf</div><div class=\"line\"># 19 行，取消下面的注释，并修改为需求</div><div class=\"line\">[galera]</div><div class=\"line\">wsrep_provider=/usr/lib64/galera/libgalera_smm.so</div><div class=\"line\"># 指定节点地址，这里也可以使用ip,如果没做安装1，可以直接把cluster的ip写在这里。</div><div class=\"line\">wsrep_cluster_address=&quot;gcomm://node4,node5,node6&quot;</div><div class=\"line\">binlog_format=row</div><div class=\"line\">default_storage_engine=InnoDB</div><div class=\"line\">innodb_autoinc_lock_mode=2</div><div class=\"line\">bind-address=0.0.0.0</div><div class=\"line\"></div><div class=\"line\"># add follows</div><div class=\"line\"># cluster name</div><div class=\"line\">wsrep_cluster_name=&quot;Visionet_MariaDB_Cluster&quot;</div><div class=\"line\"># replication provider</div><div class=\"line\">wsrep_sst_method=rsync</div><div class=\"line\"></div><div class=\"line\"># 以下内容注意，注意应设置为当前服务器信息</div><div class=\"line\">wsrep_node_address=&quot;172.16.102.164&quot;</div><div class=\"line\">wsrep_node_name=&quot;node6&quot;</div><div class=\"line\"></div><div class=\"line\"># 启动数据库</div><div class=\"line\">[root@node6 ~]# /etc/rc.d/init.d/mysql start</div><div class=\"line\">Starting MySQL...SST in progress, setting sleep higher. SUCCESS!</div></pre></td></tr></table></figure>\n<blockquote>\n<p>注意：只需要初始化第一个节点服务器的数据库，其他数据的配置文件会自动同步，所以你给node4设置的root可以在node5和node6直接使用，当然这是安装正确的前提。</p>\n</blockquote>\n<h4 id=\"登陆各个节点数据库检查配置是否成功\"><a href=\"#登陆各个节点数据库检查配置是否成功\" class=\"headerlink\" title=\"登陆各个节点数据库检查配置是否成功\"></a>登陆各个节点数据库检查配置是否成功</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server.cnf的配置如果没有问题，那么wsrep_local_state_comment的状态应该是Synced。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@node4 ~]# mysql -u root -p</div><div class=\"line\">Enter password:</div><div class=\"line\">Welcome to the MariaDB monitor.  Commands end with ; or \\g.</div><div class=\"line\">Your MariaDB connection id is 15</div><div class=\"line\">Server version: 10.0.26-MariaDB-wsrep MariaDB Server, wsrep_25.13.raf7f02e</div><div class=\"line\"></div><div class=\"line\">Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.</div><div class=\"line\"></div><div class=\"line\">Type &apos;help;&apos; or &apos;\\h&apos; for help. Type &apos;\\c&apos; to clear the current input statement.</div><div class=\"line\"></div><div class=\"line\">MariaDB [(none)]&gt; show status like &apos;wsrep_local_state_comment&apos;;</div><div class=\"line\">+---------------------------+--------+</div><div class=\"line\">| Variable_name             | Value  |</div><div class=\"line\">+---------------------------+--------+</div><div class=\"line\">| wsrep_local_state_comment | Synced |</div><div class=\"line\">+---------------------------+--------+</div><div class=\"line\">1 row in set (0.01 sec)</div><div class=\"line\"></div><div class=\"line\">MariaDB [(none)]&gt;</div></pre></td></tr></table></figure></p>\n<h4 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MariaDB Galera没有主节点和备份节点，配置成功之后，可以在任何一个node节点上操作会自动同步到其他节点，任何一个节点宕机不会影响其他节点的数据和稳定性，配置HAProxy设置VIP的方式来实现负载均衡，提高服务的高可用性，另外，当宕机节点上线之后，事务会自动同步不丢失。</p>\n"},{"title":"HowTo Trun Off IPv6 in CentOS 6.x","id":"77","updated":"2017-04-21T05:24:06.000Z","date":"2016-07-28T23:26:19.000Z","_content":"\n## 1. CentOS 6.x\n\nCentOS 6 上是默认打开了IPv6，但其实在我们实际使用中很难用到它，所以本篇的内容就是如何关闭IPv6。\n\n＃ 可以看到 inet6 ，说明还没关闭。\n```\n[root@ultraera ~]# ifconfig eth0\neth0      Link encap:Ethernet  HWaddr 00:0C:29:3A:F9:6F\n          inet addr:172.16.102.161  Bcast:172.16.102.255  Mask:255.255.255.0\n          inet6 addr: fe80::20c:29ff:fe3a:f96f/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:199 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:122 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:20124 (19.6 KiB)  TX bytes:17182 (16.7 KiB)\n```\n\n＃ 修改/etc/modprobe.d/dist.conf\n```\n[root@ultraera ~]# vi /etc/modprobe.d/dist.conf\n# 添加下面两行内容\nalias net-pf-10 off\nalias ipv6 off\n# 保存退出，并且重新启动系统\n\n# 开机不启动\n[root@ultraera ~]# chkconfig ip6tables off\n```\n\n＃ 系统重启完成后，检查是否加载IPv6\n```\n[root@ultraera ~]# lsmod | grep v6\n```\n\n＃ 补充\n\n* 修改/etc/sysconfig/network，追加\n```\nNETWORKING_IPV6=no\n```\n\n* 修改/etc/hosts文件，把ipv6的那句本地主机名解析的也注释掉\n```\n#::1   localhost localhost6 localhost6.localdomain6\n```\n\n<br>\n\n## 2. CentOS 7.x\n\n#### Setup 1. 修改grub文件，在启动引导时不加载ipv6\n```\n[root@ultraera ~]# vim /etc/default/grub\n\n# 在GRUB_CMDLINE_LINUX=\" \" ,中增加\nipv6.disable＝1\n\n# 重新生产启动引导文件，注意，这里重启系统是没用的，需要手动重建引导文件\n[root@ultraera ~]# grub2-mkconfig -o /boot/grub2/grub.cfg\n[root@ultraera ~]# reboot\n```\n\n＃ 验证是否关闭\n```\n[root@ultraera ~]# lsmod | grep ipv6\n```\n\n#### Setup 2. 第二种方式\n```\n# 修改/etc/sysctl.conf,增加以下：\nnet.ipv6.conf.all.disable_ipv6 = 1\n\nreboot\n```\n> IPv6是默认支持的，所以当你要重新开起IPv6支持时，将以上添加的指令注释掉即可。\n\n> <font color=red><b>之前碰到过安装某些服务时，不能启动，后来检查原因是因为关闭ipv6的问题，因为在这些服务的conf文件，指定了类似监听ipv6,因为关闭了ipv6导致服务无法启动，将其关闭即可。<b></font>\n\n","source":"_posts/HowTo-Trun-Off-IPv6-in-CentOS-6-x.md","raw":"---\ntitle: HowTo Trun Off IPv6 in CentOS 6.x\ntags: 'CentOS'\ncategories: 'CentOS'\npermalink: trun-off-ipv6\nid: 77\nupdated: '2017-04-21 13:24:06'\ndate: 2016-07-29 07:26:19\n---\n\n## 1. CentOS 6.x\n\nCentOS 6 上是默认打开了IPv6，但其实在我们实际使用中很难用到它，所以本篇的内容就是如何关闭IPv6。\n\n＃ 可以看到 inet6 ，说明还没关闭。\n```\n[root@ultraera ~]# ifconfig eth0\neth0      Link encap:Ethernet  HWaddr 00:0C:29:3A:F9:6F\n          inet addr:172.16.102.161  Bcast:172.16.102.255  Mask:255.255.255.0\n          inet6 addr: fe80::20c:29ff:fe3a:f96f/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:199 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:122 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:20124 (19.6 KiB)  TX bytes:17182 (16.7 KiB)\n```\n\n＃ 修改/etc/modprobe.d/dist.conf\n```\n[root@ultraera ~]# vi /etc/modprobe.d/dist.conf\n# 添加下面两行内容\nalias net-pf-10 off\nalias ipv6 off\n# 保存退出，并且重新启动系统\n\n# 开机不启动\n[root@ultraera ~]# chkconfig ip6tables off\n```\n\n＃ 系统重启完成后，检查是否加载IPv6\n```\n[root@ultraera ~]# lsmod | grep v6\n```\n\n＃ 补充\n\n* 修改/etc/sysconfig/network，追加\n```\nNETWORKING_IPV6=no\n```\n\n* 修改/etc/hosts文件，把ipv6的那句本地主机名解析的也注释掉\n```\n#::1   localhost localhost6 localhost6.localdomain6\n```\n\n<br>\n\n## 2. CentOS 7.x\n\n#### Setup 1. 修改grub文件，在启动引导时不加载ipv6\n```\n[root@ultraera ~]# vim /etc/default/grub\n\n# 在GRUB_CMDLINE_LINUX=\" \" ,中增加\nipv6.disable＝1\n\n# 重新生产启动引导文件，注意，这里重启系统是没用的，需要手动重建引导文件\n[root@ultraera ~]# grub2-mkconfig -o /boot/grub2/grub.cfg\n[root@ultraera ~]# reboot\n```\n\n＃ 验证是否关闭\n```\n[root@ultraera ~]# lsmod | grep ipv6\n```\n\n#### Setup 2. 第二种方式\n```\n# 修改/etc/sysctl.conf,增加以下：\nnet.ipv6.conf.all.disable_ipv6 = 1\n\nreboot\n```\n> IPv6是默认支持的，所以当你要重新开起IPv6支持时，将以上添加的指令注释掉即可。\n\n> <font color=red><b>之前碰到过安装某些服务时，不能启动，后来检查原因是因为关闭ipv6的问题，因为在这些服务的conf文件，指定了类似监听ipv6,因为关闭了ipv6导致服务无法启动，将其关闭即可。<b></font>\n\n","slug":"trun-off-ipv6","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq9r003h41tp4jfhc9he","content":"<h2 id=\"1-CentOS-6-x\"><a href=\"#1-CentOS-6-x\" class=\"headerlink\" title=\"1. CentOS 6.x\"></a>1. CentOS 6.x</h2><p>CentOS 6 上是默认打开了IPv6，但其实在我们实际使用中很难用到它，所以本篇的内容就是如何关闭IPv6。</p>\n<p>＃ 可以看到 inet6 ，说明还没关闭。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# ifconfig eth0</div><div class=\"line\">eth0      Link encap:Ethernet  HWaddr 00:0C:29:3A:F9:6F</div><div class=\"line\">          inet addr:172.16.102.161  Bcast:172.16.102.255  Mask:255.255.255.0</div><div class=\"line\">          inet6 addr: fe80::20c:29ff:fe3a:f96f/64 Scope:Link</div><div class=\"line\">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</div><div class=\"line\">          RX packets:199 errors:0 dropped:0 overruns:0 frame:0</div><div class=\"line\">          TX packets:122 errors:0 dropped:0 overruns:0 carrier:0</div><div class=\"line\">          collisions:0 txqueuelen:1000</div><div class=\"line\">          RX bytes:20124 (19.6 KiB)  TX bytes:17182 (16.7 KiB)</div></pre></td></tr></table></figure></p>\n<p>＃ 修改/etc/modprobe.d/dist.conf<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vi /etc/modprobe.d/dist.conf</div><div class=\"line\"># 添加下面两行内容</div><div class=\"line\">alias net-pf-10 off</div><div class=\"line\">alias ipv6 off</div><div class=\"line\"># 保存退出，并且重新启动系统</div><div class=\"line\"></div><div class=\"line\"># 开机不启动</div><div class=\"line\">[root@ultraera ~]# chkconfig ip6tables off</div></pre></td></tr></table></figure></p>\n<p>＃ 系统重启完成后，检查是否加载IPv6<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# lsmod | grep v6</div></pre></td></tr></table></figure></p>\n<p>＃ 补充</p>\n<ul>\n<li><p>修改/etc/sysconfig/network，追加</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">NETWORKING_IPV6=no</div></pre></td></tr></table></figure>\n</li>\n<li><p>修改/etc/hosts文件，把ipv6的那句本地主机名解析的也注释掉</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">#::1   localhost localhost6 localhost6.localdomain6</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br></p>\n<h2 id=\"2-CentOS-7-x\"><a href=\"#2-CentOS-7-x\" class=\"headerlink\" title=\"2. CentOS 7.x\"></a>2. CentOS 7.x</h2><h4 id=\"Setup-1-修改grub文件，在启动引导时不加载ipv6\"><a href=\"#Setup-1-修改grub文件，在启动引导时不加载ipv6\" class=\"headerlink\" title=\"Setup 1. 修改grub文件，在启动引导时不加载ipv6\"></a>Setup 1. 修改grub文件，在启动引导时不加载ipv6</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vim /etc/default/grub</div><div class=\"line\"></div><div class=\"line\"># 在GRUB_CMDLINE_LINUX=&quot; &quot; ,中增加</div><div class=\"line\">ipv6.disable＝1</div><div class=\"line\"></div><div class=\"line\"># 重新生产启动引导文件，注意，这里重启系统是没用的，需要手动重建引导文件</div><div class=\"line\">[root@ultraera ~]# grub2-mkconfig -o /boot/grub2/grub.cfg</div><div class=\"line\">[root@ultraera ~]# reboot</div></pre></td></tr></table></figure>\n<p>＃ 验证是否关闭<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# lsmod | grep ipv6</div></pre></td></tr></table></figure></p>\n<h4 id=\"Setup-2-第二种方式\"><a href=\"#Setup-2-第二种方式\" class=\"headerlink\" title=\"Setup 2. 第二种方式\"></a>Setup 2. 第二种方式</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改/etc/sysctl.conf,增加以下：</div><div class=\"line\">net.ipv6.conf.all.disable_ipv6 = 1</div><div class=\"line\"></div><div class=\"line\">reboot</div></pre></td></tr></table></figure>\n<blockquote>\n<p>IPv6是默认支持的，所以当你要重新开起IPv6支持时，将以上添加的指令注释掉即可。</p>\n<font color=\"red\"><b>之前碰到过安装某些服务时，不能启动，后来检查原因是因为关闭ipv6的问题，因为在这些服务的conf文件，指定了类似监听ipv6,因为关闭了ipv6导致服务无法启动，将其关闭即可。<b></b></b></font>\n\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"1-CentOS-6-x\"><a href=\"#1-CentOS-6-x\" class=\"headerlink\" title=\"1. CentOS 6.x\"></a>1. CentOS 6.x</h2><p>CentOS 6 上是默认打开了IPv6，但其实在我们实际使用中很难用到它，所以本篇的内容就是如何关闭IPv6。</p>\n<p>＃ 可以看到 inet6 ，说明还没关闭。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# ifconfig eth0</div><div class=\"line\">eth0      Link encap:Ethernet  HWaddr 00:0C:29:3A:F9:6F</div><div class=\"line\">          inet addr:172.16.102.161  Bcast:172.16.102.255  Mask:255.255.255.0</div><div class=\"line\">          inet6 addr: fe80::20c:29ff:fe3a:f96f/64 Scope:Link</div><div class=\"line\">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</div><div class=\"line\">          RX packets:199 errors:0 dropped:0 overruns:0 frame:0</div><div class=\"line\">          TX packets:122 errors:0 dropped:0 overruns:0 carrier:0</div><div class=\"line\">          collisions:0 txqueuelen:1000</div><div class=\"line\">          RX bytes:20124 (19.6 KiB)  TX bytes:17182 (16.7 KiB)</div></pre></td></tr></table></figure></p>\n<p>＃ 修改/etc/modprobe.d/dist.conf<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vi /etc/modprobe.d/dist.conf</div><div class=\"line\"># 添加下面两行内容</div><div class=\"line\">alias net-pf-10 off</div><div class=\"line\">alias ipv6 off</div><div class=\"line\"># 保存退出，并且重新启动系统</div><div class=\"line\"></div><div class=\"line\"># 开机不启动</div><div class=\"line\">[root@ultraera ~]# chkconfig ip6tables off</div></pre></td></tr></table></figure></p>\n<p>＃ 系统重启完成后，检查是否加载IPv6<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# lsmod | grep v6</div></pre></td></tr></table></figure></p>\n<p>＃ 补充</p>\n<ul>\n<li><p>修改/etc/sysconfig/network，追加</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">NETWORKING_IPV6=no</div></pre></td></tr></table></figure>\n</li>\n<li><p>修改/etc/hosts文件，把ipv6的那句本地主机名解析的也注释掉</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">#::1   localhost localhost6 localhost6.localdomain6</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><br></p>\n<h2 id=\"2-CentOS-7-x\"><a href=\"#2-CentOS-7-x\" class=\"headerlink\" title=\"2. CentOS 7.x\"></a>2. CentOS 7.x</h2><h4 id=\"Setup-1-修改grub文件，在启动引导时不加载ipv6\"><a href=\"#Setup-1-修改grub文件，在启动引导时不加载ipv6\" class=\"headerlink\" title=\"Setup 1. 修改grub文件，在启动引导时不加载ipv6\"></a>Setup 1. 修改grub文件，在启动引导时不加载ipv6</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# vim /etc/default/grub</div><div class=\"line\"></div><div class=\"line\"># 在GRUB_CMDLINE_LINUX=&quot; &quot; ,中增加</div><div class=\"line\">ipv6.disable＝1</div><div class=\"line\"></div><div class=\"line\"># 重新生产启动引导文件，注意，这里重启系统是没用的，需要手动重建引导文件</div><div class=\"line\">[root@ultraera ~]# grub2-mkconfig -o /boot/grub2/grub.cfg</div><div class=\"line\">[root@ultraera ~]# reboot</div></pre></td></tr></table></figure>\n<p>＃ 验证是否关闭<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera ~]# lsmod | grep ipv6</div></pre></td></tr></table></figure></p>\n<h4 id=\"Setup-2-第二种方式\"><a href=\"#Setup-2-第二种方式\" class=\"headerlink\" title=\"Setup 2. 第二种方式\"></a>Setup 2. 第二种方式</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改/etc/sysctl.conf,增加以下：</div><div class=\"line\">net.ipv6.conf.all.disable_ipv6 = 1</div><div class=\"line\"></div><div class=\"line\">reboot</div></pre></td></tr></table></figure>\n<blockquote>\n<p>IPv6是默认支持的，所以当你要重新开起IPv6支持时，将以上添加的指令注释掉即可。</p>\n<font color=red><b>之前碰到过安装某些服务时，不能启动，后来检查原因是因为关闭ipv6的问题，因为在这些服务的conf文件，指定了类似监听ipv6,因为关闭了ipv6导致服务无法启动，将其关闭即可。<b></font>\n\n</blockquote>\n"},{"title":"HowTo Upgrade Your Ghost Version","id":"138","updated":"2017-04-21T05:15:55.000Z","date":"2017-02-20T06:39:15.000Z","_content":"\n<br>\n#### 1. 下载最新版的Ghost\n\n```\ncurl -LOk https://ghost.org/zip/ghost-latest.zip\n```\n\n\n\n#### 2. 创建临时目录，并解压ghost-latest.zip到此\n\n```\nmkdir /usr/ghost-tmp\nunzip ghost-latest.zip -d /usr/ghost-tmp\n```\n\n#### 3. 进入到原ghost目录，删除core\n\n```\ncd  /usr/ghost\nrm -rf core\n```\n\n#### 4.进入到新版本的ghost临时目录\n\n```\ncd /usr/ghost-tmp\n```\n\n#### 5. 拷贝所需文件到ghost升级目录\n\n```\ncp -R core /usr/ghost\ncp index.js *.json /usr/ghost\n```\n\n#### 6. (可选)升级casper，ghost默认主题\n\n```\ncp -R content/themes/casper /usr/ghost/content/themes/\n```\n\n#### 7. 切换回到ghost安装目录\n\n```\ncd /usr/ghost\n```\n\n#### 8. 修改文件目录所有者和所属组为ghost\n\n```\nchown -R ghost:ghost ./*\n```\n\n#### 9. 重新安装环境\n\n```\nnpm install --production\n```\n\n#### 10. 重启Ghost\n\n```\npm2 restart ghost\n```\n\n","source":"_posts/HowTo-Upgrade-Your-Ghost-Version.md","raw":"---\ntitle: HowTo Upgrade Your Ghost Version\ntags: 'Ghost'\ncategories: 'Ghost'\npermalink: howto-upgrade-your-ghost-version\nid: 138\nupdated: '2017-04-21 13:15:55'\ndate: 2017-02-20 14:39:15\n---\n\n<br>\n#### 1. 下载最新版的Ghost\n\n```\ncurl -LOk https://ghost.org/zip/ghost-latest.zip\n```\n\n\n\n#### 2. 创建临时目录，并解压ghost-latest.zip到此\n\n```\nmkdir /usr/ghost-tmp\nunzip ghost-latest.zip -d /usr/ghost-tmp\n```\n\n#### 3. 进入到原ghost目录，删除core\n\n```\ncd  /usr/ghost\nrm -rf core\n```\n\n#### 4.进入到新版本的ghost临时目录\n\n```\ncd /usr/ghost-tmp\n```\n\n#### 5. 拷贝所需文件到ghost升级目录\n\n```\ncp -R core /usr/ghost\ncp index.js *.json /usr/ghost\n```\n\n#### 6. (可选)升级casper，ghost默认主题\n\n```\ncp -R content/themes/casper /usr/ghost/content/themes/\n```\n\n#### 7. 切换回到ghost安装目录\n\n```\ncd /usr/ghost\n```\n\n#### 8. 修改文件目录所有者和所属组为ghost\n\n```\nchown -R ghost:ghost ./*\n```\n\n#### 9. 重新安装环境\n\n```\nnpm install --production\n```\n\n#### 10. 重启Ghost\n\n```\npm2 restart ghost\n```\n\n","slug":"howto-upgrade-your-ghost-version","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq9t003k41tpjv4j888t","content":"<p><br></p>\n<h4 id=\"1-下载最新版的Ghost\"><a href=\"#1-下载最新版的Ghost\" class=\"headerlink\" title=\"1. 下载最新版的Ghost\"></a>1. 下载最新版的Ghost</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl -LOk https://ghost.org/zip/ghost-latest.zip</div></pre></td></tr></table></figure>\n<h4 id=\"2-创建临时目录，并解压ghost-latest-zip到此\"><a href=\"#2-创建临时目录，并解压ghost-latest-zip到此\" class=\"headerlink\" title=\"2. 创建临时目录，并解压ghost-latest.zip到此\"></a>2. 创建临时目录，并解压ghost-latest.zip到此</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /usr/ghost-tmp</div><div class=\"line\">unzip ghost-latest.zip -d /usr/ghost-tmp</div></pre></td></tr></table></figure>\n<h4 id=\"3-进入到原ghost目录，删除core\"><a href=\"#3-进入到原ghost目录，删除core\" class=\"headerlink\" title=\"3. 进入到原ghost目录，删除core\"></a>3. 进入到原ghost目录，删除core</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd  /usr/ghost</div><div class=\"line\">rm -rf core</div></pre></td></tr></table></figure>\n<h4 id=\"4-进入到新版本的ghost临时目录\"><a href=\"#4-进入到新版本的ghost临时目录\" class=\"headerlink\" title=\"4.进入到新版本的ghost临时目录\"></a>4.进入到新版本的ghost临时目录</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /usr/ghost-tmp</div></pre></td></tr></table></figure>\n<h4 id=\"5-拷贝所需文件到ghost升级目录\"><a href=\"#5-拷贝所需文件到ghost升级目录\" class=\"headerlink\" title=\"5. 拷贝所需文件到ghost升级目录\"></a>5. 拷贝所需文件到ghost升级目录</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp -R core /usr/ghost</div><div class=\"line\">cp index.js *.json /usr/ghost</div></pre></td></tr></table></figure>\n<h4 id=\"6-可选-升级casper，ghost默认主题\"><a href=\"#6-可选-升级casper，ghost默认主题\" class=\"headerlink\" title=\"6. (可选)升级casper，ghost默认主题\"></a>6. (可选)升级casper，ghost默认主题</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp -R content/themes/casper /usr/ghost/content/themes/</div></pre></td></tr></table></figure>\n<h4 id=\"7-切换回到ghost安装目录\"><a href=\"#7-切换回到ghost安装目录\" class=\"headerlink\" title=\"7. 切换回到ghost安装目录\"></a>7. 切换回到ghost安装目录</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /usr/ghost</div></pre></td></tr></table></figure>\n<h4 id=\"8-修改文件目录所有者和所属组为ghost\"><a href=\"#8-修改文件目录所有者和所属组为ghost\" class=\"headerlink\" title=\"8. 修改文件目录所有者和所属组为ghost\"></a>8. 修改文件目录所有者和所属组为ghost</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">chown -R ghost:ghost ./*</div></pre></td></tr></table></figure>\n<h4 id=\"9-重新安装环境\"><a href=\"#9-重新安装环境\" class=\"headerlink\" title=\"9. 重新安装环境\"></a>9. 重新安装环境</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install --production</div></pre></td></tr></table></figure>\n<h4 id=\"10-重启Ghost\"><a href=\"#10-重启Ghost\" class=\"headerlink\" title=\"10. 重启Ghost\"></a>10. 重启Ghost</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pm2 restart ghost</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><br></p>\n<h4 id=\"1-下载最新版的Ghost\"><a href=\"#1-下载最新版的Ghost\" class=\"headerlink\" title=\"1. 下载最新版的Ghost\"></a>1. 下载最新版的Ghost</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl -LOk https://ghost.org/zip/ghost-latest.zip</div></pre></td></tr></table></figure>\n<h4 id=\"2-创建临时目录，并解压ghost-latest-zip到此\"><a href=\"#2-创建临时目录，并解压ghost-latest-zip到此\" class=\"headerlink\" title=\"2. 创建临时目录，并解压ghost-latest.zip到此\"></a>2. 创建临时目录，并解压ghost-latest.zip到此</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /usr/ghost-tmp</div><div class=\"line\">unzip ghost-latest.zip -d /usr/ghost-tmp</div></pre></td></tr></table></figure>\n<h4 id=\"3-进入到原ghost目录，删除core\"><a href=\"#3-进入到原ghost目录，删除core\" class=\"headerlink\" title=\"3. 进入到原ghost目录，删除core\"></a>3. 进入到原ghost目录，删除core</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd  /usr/ghost</div><div class=\"line\">rm -rf core</div></pre></td></tr></table></figure>\n<h4 id=\"4-进入到新版本的ghost临时目录\"><a href=\"#4-进入到新版本的ghost临时目录\" class=\"headerlink\" title=\"4.进入到新版本的ghost临时目录\"></a>4.进入到新版本的ghost临时目录</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /usr/ghost-tmp</div></pre></td></tr></table></figure>\n<h4 id=\"5-拷贝所需文件到ghost升级目录\"><a href=\"#5-拷贝所需文件到ghost升级目录\" class=\"headerlink\" title=\"5. 拷贝所需文件到ghost升级目录\"></a>5. 拷贝所需文件到ghost升级目录</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp -R core /usr/ghost</div><div class=\"line\">cp index.js *.json /usr/ghost</div></pre></td></tr></table></figure>\n<h4 id=\"6-可选-升级casper，ghost默认主题\"><a href=\"#6-可选-升级casper，ghost默认主题\" class=\"headerlink\" title=\"6. (可选)升级casper，ghost默认主题\"></a>6. (可选)升级casper，ghost默认主题</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp -R content/themes/casper /usr/ghost/content/themes/</div></pre></td></tr></table></figure>\n<h4 id=\"7-切换回到ghost安装目录\"><a href=\"#7-切换回到ghost安装目录\" class=\"headerlink\" title=\"7. 切换回到ghost安装目录\"></a>7. 切换回到ghost安装目录</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /usr/ghost</div></pre></td></tr></table></figure>\n<h4 id=\"8-修改文件目录所有者和所属组为ghost\"><a href=\"#8-修改文件目录所有者和所属组为ghost\" class=\"headerlink\" title=\"8. 修改文件目录所有者和所属组为ghost\"></a>8. 修改文件目录所有者和所属组为ghost</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">chown -R ghost:ghost ./*</div></pre></td></tr></table></figure>\n<h4 id=\"9-重新安装环境\"><a href=\"#9-重新安装环境\" class=\"headerlink\" title=\"9. 重新安装环境\"></a>9. 重新安装环境</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install --production</div></pre></td></tr></table></figure>\n<h4 id=\"10-重启Ghost\"><a href=\"#10-重启Ghost\" class=\"headerlink\" title=\"10. 重启Ghost\"></a>10. 重启Ghost</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pm2 restart ghost</div></pre></td></tr></table></figure>\n"},{"title":"HowTo Use Docker create a Tomcat Project","id":"82","updated":"2017-04-21T05:23:28.000Z","date":"2016-08-02T07:44:20.000Z","_content":"\n#### **1. 安装CentOS 7.x**\n    略。\n#### **2. 安装docker**\n详见： [How to Install Docker on CentOS 6.x](http://blog.ultraera.org/how-to-install-docker-on-centos-6-x-2/)\n#### **3. 基础docker命令**\n```\n＃ 获取centos6 docker镜像\n[root@docker ~]# docker pull centos6\nUsing default tag: latest\nlatest: Pulling from library/centos:centos6\n\n43db9dbdcb30: Downloading 41.14 MB/49.33 MB\n43db9dbdcb30: Pull complete\n2dc64e8f8d4f: Pull complete\n670a583e1b50: Pull complete\n183b0bfcd10e: Pull complete\nDigest: sha256:c6674c44c6439673bf56536c1a15916639c47ea04c3d6296c5df938add67b54b\nStatus: Downloaded newer image for centso:centos6\n\n＃ 查看当前服务器上的docker镜像\n[root@docker ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\ncentos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB\ncentos              centos6             a3c09d36ab4a        2 days ago          194.6 MB\nregistry            latest              c6c14b3960bd        3 days ago          33.28 MB\n＃ 查找docker镜像\n[root@docker ~]# docker search centos:centos6\nNAME                                     DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED\nimagine10255/centos6-lnmp-php56          centos6-lnmp-php56                              10                   [OK]\nlemonbar/centos6-ssh                     Installed openssh-server on centos6, defau...   7                    [OK]\nsergeyzh/centos6-nginx                                                                   2                    [OK]\nguyton/centos6                           From official centos6 container with full ...   2                    [OK]\npaijp/centos6-apache-php-sqlite2         php5.3.3 with sqlite2 and apache on CentOS...   1                    [OK]\nedrans/centos6                                                                           1                    [OK]\nmohri1219/centos6.7-ruby2.2.2-mysql5.6   centos6.7-ruby2.2.2-mysql5.6                    1                    [OK]\n...\n...\n\n＃ 删除 centos6 docker镜像\n[root@docker ~]# docker rmi IMAGES_NAME\n[root@docker ~]# docker rmi centos:centos6\n# 报错无法删除\nError response from daemon: conflict: unable to remove repository reference \"centos\" (must force) - container 705a30cbc002 is using its referenced image 42118e3df429\n# 这是因为之间的运行的进程没有清楚导致该images正在使用中，使用一下命令查看占有的进程\n[root@docker ~]# docker ps -a ＃ 查看所有的docker进程\nCONTAINER ID        IMAGE               COMMAND               CREATED             STATUS                     PORTS               NAMES\n705a30cbc002        centos:centos6              \"/bin/bash\"           6 minutes ago       Exited (0) 6 minutes ago                       centos6\n[root@docker ~]# docker rm 705a30cbc002\n705a30cbc002\n[root@docker ~]# docker rmi centos:centos6\nUntagged: centos:centos6\nDeleted: sha256:42118e3df429f09ca581a9deb3df274601930e428e452f7e4e9f1833c56a100a\nDeleted: sha256:d72d0199021776e77ac14a764a3decd156e9f6f18b37e25b867b0f1ca42fb3d9\nDeleted: sha256:fb178c6cea1453d089ce033b96eba0efdb42274138e042517ea2d5ea7bb51665\nDeleted: sha256:8945af30572845a904adce2aeaf73402c842d86e99e8f10688b25cb27834110b\nDeleted: sha256:ea9f151abb7e06353e73172dad421235611d4f6d0560ec95db26e0dc240642c1\n```\n\n#### **4. 运行一个docker镜像**\n#### 进入交互式程序\n```\n[root@docker ~]# docker run  -it centos:centos6 /bin/bash\n[root@c1d190f95562 /]# cat /etc/redhat-release\nCentOS release 6.8 (Final)\n# Install openssh-server and httpd\nroot@d8c122dbe09d:/# yum install -y openssh-sever httpd\nroot@d8c122dbe09d:/# exit\n\n# 注意当你执行exit，从容器之中退出时，容器也会随着关闭，这时如果还继续执行上条命令\n# 你会发现之前所有的操作都被还原，因为相对于docker，又是新开了一个进程\n# 在exit退出之后，使用一下命令查看上次提交，然后commit修改，便可保存之前的修改\n\n[root@docker ~]# docker ps -l\n[root@docker ~]# docker commit c1d190f95562 centos:centos6-httpd\nsha256:77eb12e36c7bbe9ef874555b1873019022b5258740aa731627e2cd6fa749c325\n[root@docker ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\ncentos              centos6-httpd       77eb12e36c7b        3 seconds ago       290.3 MB\ncentos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB\ncentos              centos6             a3c09d36ab4a        2 days ago          194.6 MB\nregistry            latest              c6c14b3960bd        3 days ago          33.28 MB\n```\n\n#### **5. 编辑Dockerfile**\n```\n# dockfile的第一行一定是FROM，指定了父镜像\nFROM centos:centos6\n\n# RUN 指的是运行的命令\nRUN yum install -y epel-release\nRUN yum install -y bash-completion\nRUN yum install -y openssh-server openssh-client sudo\nRUN sed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\nRUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n\n# 增加一个用户，并赋予sudo权限\nRUN useradd visionet\nRUN echo \"visionet:visionet\" | chpasswd\nRUN echo \"visionet   ALL=(ALL)       ALL\" >> /etc/sudoers\n\n＃ 注意，如果没有执行一下两个命令，sshd是无法远程登陆的\nRUN ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key\nRUN ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key\n\n＃ EXPOSE 22， 将22端口暴露出来，方便ssh远程连接\nRUN mkdir /var/run/sshd\nEXPOSE 22\n＃ CMD 为系统内部执行命令\nCMD [\"/usr/sbin/sshd\", \"-D\"]\n```\n\n#### **6. 生成自定义docker镜像**\n```\n# build 编译镜像\n[root@docker ~]# docker build -f dockerfile3 -t centos:centos6-ssh .\nSending build context to Docker daemon 44.54 kB\nStep 1 : FROM centos:centos6\n ---> a3c09d36ab4a\nStep 2 : RUN yum install -y epel-release\n ---> Using cache\n ---> 04d81f280a63\nStep 3 : RUN yum install -y bash-completion\n ---> Using cache\n ---> 5ca26894dc9d\nStep 4 : RUN yum install -y openssh-server openssh-client sudo\n ---> Using cache\n ---> 42278450311e\nStep 5 : RUN sed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\n ---> Using cache\n ---> db35bef562a2\nStep 6 : RUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n ---> Using cache\n ---> dc9f2b82e198\nStep 7 : RUN useradd visionet\n ---> Using cache\n ---> 06c574a51755\nStep 8 : RUN echo \"visionet:visionet\" | chpasswd\n ---> Using cache\n ---> 03412f053d04\nStep 9 : RUN echo \"visionet   ALL=(ALL)       ALL\" >> /etc/sudoers\n ---> Using cache\n ---> bf8476812a62\nStep 10 : RUN ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key\n ---> Using cache\n ---> 2314cce75171\nStep 11 : RUN ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key\n ---> Using cache\n ---> 99304cd9ac15\nStep 12 : RUN mkdir /var/run/sshd\n ---> Using cache\n ---> f87283751553\nStep 13 : EXPOSE 22\n ---> Using cache\n ---> 56c41202dcb9\nStep 14 : CMD /usr/sbin/sshd -D\n ---> Using cache\n ---> d6dccb483fa6\nSuccessfully built d6dccb483fa6\n[root@docker ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\ncentos              centos6-ssh         d6dccb483fa6        2 minutes ago         363 MB\ncentos              centos6-httpd       77eb12e36c7b        6 minutes ago       290.3 MB\ncentos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB\ncentos              centos6             a3c09d36ab4a        2 days ago          194.6 MB\nregistry            latest              c6c14b3960bd        3 days ago          33.28 MB\n\n# 后台运行docker容器，并指定nat端口转发\n[root@docker ~]# docker run -d -p 2222:22 -P --name=sshd centos:centos6-ssh\nb4211f7a304d9e34b72b510230be2c7a76b276886b488f08f3e12896a4d3c172\n\n```\n\n#### **7. ssh登陆到docker容器内，部署项目环境**\n```\n# inspect 查看docker 容器IP地址\n[root@docker ~]# docker inspect sshd | grep IPAddress\n[root@docker ~]# ssh visionet@172.17.0.2\nvisionet@172.17.0.2's password:\n[visionet@b4211f7a304d ~]$\n\n# Install mysql\n# Install tomcat server\n\n[visionet@b4211f7a304d ~]$ exit\n[root@docker ~]# docker stop sshd\nsshd\n[root@docker ~]# docker ps -l\nCONTAINER ID        IMAGE                COMMAND               CREATED             STATUS                       PORTS               NAMES\nb4211f7a304d        centos:centos6-ssh   \"/usr/sbin/sshd -D\"   6 minutes ago       Exited (255) 3 seconds ago                       sshd\n[root@docker ~]# docker commit b4211f7a304d centos:centos6-tomcat\nsha256:b4f114d5484822d9a3ddf1100b76b460985ba5e5d31e936570e8d7dbd8df282c\n[root@docker ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\ncentos              centos6-tomcat      b4f114d54848        4 seconds ago       363.1 MB\ncentos              centos6-httpd       77eb12e36c7b        15 minutes ago      290.3 MB\ncentos6-visionet    latest              aeed37612ecb        7 hours ago         1.916 GB\ncentos              centos6-ssh         d6dccb483fa6        9 hours ago         363 MB\ncentos              centos6             a3c09d36ab4a        2 days ago          194.6 MB\nregistry            latest              c6c14b3960bd        3 days ago          33.28 MB\n\n```\n\n#### **8. 推送centos:centos6-tomcat到私有docker仓库**\n","source":"_posts/HowTo-Use-Docker-create-a-Tomcat-Project.md","raw":"---\ntitle: HowTo Use Docker create a Tomcat Project\ntags: 'Docker'\ncategories: 'Docker'\npermalink: docker01\nid: 82\nupdated: '2017-04-21 13:23:28'\ndate: 2016-08-02 15:44:20\n---\n\n#### **1. 安装CentOS 7.x**\n    略。\n#### **2. 安装docker**\n详见： [How to Install Docker on CentOS 6.x](http://blog.ultraera.org/how-to-install-docker-on-centos-6-x-2/)\n#### **3. 基础docker命令**\n```\n＃ 获取centos6 docker镜像\n[root@docker ~]# docker pull centos6\nUsing default tag: latest\nlatest: Pulling from library/centos:centos6\n\n43db9dbdcb30: Downloading 41.14 MB/49.33 MB\n43db9dbdcb30: Pull complete\n2dc64e8f8d4f: Pull complete\n670a583e1b50: Pull complete\n183b0bfcd10e: Pull complete\nDigest: sha256:c6674c44c6439673bf56536c1a15916639c47ea04c3d6296c5df938add67b54b\nStatus: Downloaded newer image for centso:centos6\n\n＃ 查看当前服务器上的docker镜像\n[root@docker ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\ncentos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB\ncentos              centos6             a3c09d36ab4a        2 days ago          194.6 MB\nregistry            latest              c6c14b3960bd        3 days ago          33.28 MB\n＃ 查找docker镜像\n[root@docker ~]# docker search centos:centos6\nNAME                                     DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED\nimagine10255/centos6-lnmp-php56          centos6-lnmp-php56                              10                   [OK]\nlemonbar/centos6-ssh                     Installed openssh-server on centos6, defau...   7                    [OK]\nsergeyzh/centos6-nginx                                                                   2                    [OK]\nguyton/centos6                           From official centos6 container with full ...   2                    [OK]\npaijp/centos6-apache-php-sqlite2         php5.3.3 with sqlite2 and apache on CentOS...   1                    [OK]\nedrans/centos6                                                                           1                    [OK]\nmohri1219/centos6.7-ruby2.2.2-mysql5.6   centos6.7-ruby2.2.2-mysql5.6                    1                    [OK]\n...\n...\n\n＃ 删除 centos6 docker镜像\n[root@docker ~]# docker rmi IMAGES_NAME\n[root@docker ~]# docker rmi centos:centos6\n# 报错无法删除\nError response from daemon: conflict: unable to remove repository reference \"centos\" (must force) - container 705a30cbc002 is using its referenced image 42118e3df429\n# 这是因为之间的运行的进程没有清楚导致该images正在使用中，使用一下命令查看占有的进程\n[root@docker ~]# docker ps -a ＃ 查看所有的docker进程\nCONTAINER ID        IMAGE               COMMAND               CREATED             STATUS                     PORTS               NAMES\n705a30cbc002        centos:centos6              \"/bin/bash\"           6 minutes ago       Exited (0) 6 minutes ago                       centos6\n[root@docker ~]# docker rm 705a30cbc002\n705a30cbc002\n[root@docker ~]# docker rmi centos:centos6\nUntagged: centos:centos6\nDeleted: sha256:42118e3df429f09ca581a9deb3df274601930e428e452f7e4e9f1833c56a100a\nDeleted: sha256:d72d0199021776e77ac14a764a3decd156e9f6f18b37e25b867b0f1ca42fb3d9\nDeleted: sha256:fb178c6cea1453d089ce033b96eba0efdb42274138e042517ea2d5ea7bb51665\nDeleted: sha256:8945af30572845a904adce2aeaf73402c842d86e99e8f10688b25cb27834110b\nDeleted: sha256:ea9f151abb7e06353e73172dad421235611d4f6d0560ec95db26e0dc240642c1\n```\n\n#### **4. 运行一个docker镜像**\n#### 进入交互式程序\n```\n[root@docker ~]# docker run  -it centos:centos6 /bin/bash\n[root@c1d190f95562 /]# cat /etc/redhat-release\nCentOS release 6.8 (Final)\n# Install openssh-server and httpd\nroot@d8c122dbe09d:/# yum install -y openssh-sever httpd\nroot@d8c122dbe09d:/# exit\n\n# 注意当你执行exit，从容器之中退出时，容器也会随着关闭，这时如果还继续执行上条命令\n# 你会发现之前所有的操作都被还原，因为相对于docker，又是新开了一个进程\n# 在exit退出之后，使用一下命令查看上次提交，然后commit修改，便可保存之前的修改\n\n[root@docker ~]# docker ps -l\n[root@docker ~]# docker commit c1d190f95562 centos:centos6-httpd\nsha256:77eb12e36c7bbe9ef874555b1873019022b5258740aa731627e2cd6fa749c325\n[root@docker ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\ncentos              centos6-httpd       77eb12e36c7b        3 seconds ago       290.3 MB\ncentos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB\ncentos              centos6             a3c09d36ab4a        2 days ago          194.6 MB\nregistry            latest              c6c14b3960bd        3 days ago          33.28 MB\n```\n\n#### **5. 编辑Dockerfile**\n```\n# dockfile的第一行一定是FROM，指定了父镜像\nFROM centos:centos6\n\n# RUN 指的是运行的命令\nRUN yum install -y epel-release\nRUN yum install -y bash-completion\nRUN yum install -y openssh-server openssh-client sudo\nRUN sed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\nRUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n\n# 增加一个用户，并赋予sudo权限\nRUN useradd visionet\nRUN echo \"visionet:visionet\" | chpasswd\nRUN echo \"visionet   ALL=(ALL)       ALL\" >> /etc/sudoers\n\n＃ 注意，如果没有执行一下两个命令，sshd是无法远程登陆的\nRUN ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key\nRUN ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key\n\n＃ EXPOSE 22， 将22端口暴露出来，方便ssh远程连接\nRUN mkdir /var/run/sshd\nEXPOSE 22\n＃ CMD 为系统内部执行命令\nCMD [\"/usr/sbin/sshd\", \"-D\"]\n```\n\n#### **6. 生成自定义docker镜像**\n```\n# build 编译镜像\n[root@docker ~]# docker build -f dockerfile3 -t centos:centos6-ssh .\nSending build context to Docker daemon 44.54 kB\nStep 1 : FROM centos:centos6\n ---> a3c09d36ab4a\nStep 2 : RUN yum install -y epel-release\n ---> Using cache\n ---> 04d81f280a63\nStep 3 : RUN yum install -y bash-completion\n ---> Using cache\n ---> 5ca26894dc9d\nStep 4 : RUN yum install -y openssh-server openssh-client sudo\n ---> Using cache\n ---> 42278450311e\nStep 5 : RUN sed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\n ---> Using cache\n ---> db35bef562a2\nStep 6 : RUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n ---> Using cache\n ---> dc9f2b82e198\nStep 7 : RUN useradd visionet\n ---> Using cache\n ---> 06c574a51755\nStep 8 : RUN echo \"visionet:visionet\" | chpasswd\n ---> Using cache\n ---> 03412f053d04\nStep 9 : RUN echo \"visionet   ALL=(ALL)       ALL\" >> /etc/sudoers\n ---> Using cache\n ---> bf8476812a62\nStep 10 : RUN ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key\n ---> Using cache\n ---> 2314cce75171\nStep 11 : RUN ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key\n ---> Using cache\n ---> 99304cd9ac15\nStep 12 : RUN mkdir /var/run/sshd\n ---> Using cache\n ---> f87283751553\nStep 13 : EXPOSE 22\n ---> Using cache\n ---> 56c41202dcb9\nStep 14 : CMD /usr/sbin/sshd -D\n ---> Using cache\n ---> d6dccb483fa6\nSuccessfully built d6dccb483fa6\n[root@docker ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\ncentos              centos6-ssh         d6dccb483fa6        2 minutes ago         363 MB\ncentos              centos6-httpd       77eb12e36c7b        6 minutes ago       290.3 MB\ncentos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB\ncentos              centos6             a3c09d36ab4a        2 days ago          194.6 MB\nregistry            latest              c6c14b3960bd        3 days ago          33.28 MB\n\n# 后台运行docker容器，并指定nat端口转发\n[root@docker ~]# docker run -d -p 2222:22 -P --name=sshd centos:centos6-ssh\nb4211f7a304d9e34b72b510230be2c7a76b276886b488f08f3e12896a4d3c172\n\n```\n\n#### **7. ssh登陆到docker容器内，部署项目环境**\n```\n# inspect 查看docker 容器IP地址\n[root@docker ~]# docker inspect sshd | grep IPAddress\n[root@docker ~]# ssh visionet@172.17.0.2\nvisionet@172.17.0.2's password:\n[visionet@b4211f7a304d ~]$\n\n# Install mysql\n# Install tomcat server\n\n[visionet@b4211f7a304d ~]$ exit\n[root@docker ~]# docker stop sshd\nsshd\n[root@docker ~]# docker ps -l\nCONTAINER ID        IMAGE                COMMAND               CREATED             STATUS                       PORTS               NAMES\nb4211f7a304d        centos:centos6-ssh   \"/usr/sbin/sshd -D\"   6 minutes ago       Exited (255) 3 seconds ago                       sshd\n[root@docker ~]# docker commit b4211f7a304d centos:centos6-tomcat\nsha256:b4f114d5484822d9a3ddf1100b76b460985ba5e5d31e936570e8d7dbd8df282c\n[root@docker ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\ncentos              centos6-tomcat      b4f114d54848        4 seconds ago       363.1 MB\ncentos              centos6-httpd       77eb12e36c7b        15 minutes ago      290.3 MB\ncentos6-visionet    latest              aeed37612ecb        7 hours ago         1.916 GB\ncentos              centos6-ssh         d6dccb483fa6        9 hours ago         363 MB\ncentos              centos6             a3c09d36ab4a        2 days ago          194.6 MB\nregistry            latest              c6c14b3960bd        3 days ago          33.28 MB\n\n```\n\n#### **8. 推送centos:centos6-tomcat到私有docker仓库**\n","slug":"docker01","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytq9y003o41tpszfd9zs3","content":"<h4 id=\"1-安装CentOS-7-x\"><a href=\"#1-安装CentOS-7-x\" class=\"headerlink\" title=\"1. 安装CentOS 7.x\"></a><strong>1. 安装CentOS 7.x</strong></h4><pre><code>略。\n</code></pre><h4 id=\"2-安装docker\"><a href=\"#2-安装docker\" class=\"headerlink\" title=\"2. 安装docker\"></a><strong>2. 安装docker</strong></h4><p>详见： <a href=\"http://blog.ultraera.org/how-to-install-docker-on-centos-6-x-2/\" target=\"_blank\" rel=\"external\">How to Install Docker on CentOS 6.x</a></p>\n<h4 id=\"3-基础docker命令\"><a href=\"#3-基础docker命令\" class=\"headerlink\" title=\"3. 基础docker命令\"></a><strong>3. 基础docker命令</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div></pre></td><td class=\"code\"><pre><div class=\"line\">＃ 获取centos6 docker镜像</div><div class=\"line\">[root@docker ~]# docker pull centos6</div><div class=\"line\">Using default tag: latest</div><div class=\"line\">latest: Pulling from library/centos:centos6</div><div class=\"line\"></div><div class=\"line\">43db9dbdcb30: Downloading 41.14 MB/49.33 MB</div><div class=\"line\">43db9dbdcb30: Pull complete</div><div class=\"line\">2dc64e8f8d4f: Pull complete</div><div class=\"line\">670a583e1b50: Pull complete</div><div class=\"line\">183b0bfcd10e: Pull complete</div><div class=\"line\">Digest: sha256:c6674c44c6439673bf56536c1a15916639c47ea04c3d6296c5df938add67b54b</div><div class=\"line\">Status: Downloaded newer image for centso:centos6</div><div class=\"line\"></div><div class=\"line\">＃ 查看当前服务器上的docker镜像</div><div class=\"line\">[root@docker ~]# docker images</div><div class=\"line\">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</div><div class=\"line\">centos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB</div><div class=\"line\">centos              centos6             a3c09d36ab4a        2 days ago          194.6 MB</div><div class=\"line\">registry            latest              c6c14b3960bd        3 days ago          33.28 MB</div><div class=\"line\">＃ 查找docker镜像</div><div class=\"line\">[root@docker ~]# docker search centos:centos6</div><div class=\"line\">NAME                                     DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</div><div class=\"line\">imagine10255/centos6-lnmp-php56          centos6-lnmp-php56                              10                   [OK]</div><div class=\"line\">lemonbar/centos6-ssh                     Installed openssh-server on centos6, defau...   7                    [OK]</div><div class=\"line\">sergeyzh/centos6-nginx                                                                   2                    [OK]</div><div class=\"line\">guyton/centos6                           From official centos6 container with full ...   2                    [OK]</div><div class=\"line\">paijp/centos6-apache-php-sqlite2         php5.3.3 with sqlite2 and apache on CentOS...   1                    [OK]</div><div class=\"line\">edrans/centos6                                                                           1                    [OK]</div><div class=\"line\">mohri1219/centos6.7-ruby2.2.2-mysql5.6   centos6.7-ruby2.2.2-mysql5.6                    1                    [OK]</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\"></div><div class=\"line\">＃ 删除 centos6 docker镜像</div><div class=\"line\">[root@docker ~]# docker rmi IMAGES_NAME</div><div class=\"line\">[root@docker ~]# docker rmi centos:centos6</div><div class=\"line\"># 报错无法删除</div><div class=\"line\">Error response from daemon: conflict: unable to remove repository reference &quot;centos&quot; (must force) - container 705a30cbc002 is using its referenced image 42118e3df429</div><div class=\"line\"># 这是因为之间的运行的进程没有清楚导致该images正在使用中，使用一下命令查看占有的进程</div><div class=\"line\">[root@docker ~]# docker ps -a ＃ 查看所有的docker进程</div><div class=\"line\">CONTAINER ID        IMAGE               COMMAND               CREATED             STATUS                     PORTS               NAMES</div><div class=\"line\">705a30cbc002        centos:centos6              &quot;/bin/bash&quot;           6 minutes ago       Exited (0) 6 minutes ago                       centos6</div><div class=\"line\">[root@docker ~]# docker rm 705a30cbc002</div><div class=\"line\">705a30cbc002</div><div class=\"line\">[root@docker ~]# docker rmi centos:centos6</div><div class=\"line\">Untagged: centos:centos6</div><div class=\"line\">Deleted: sha256:42118e3df429f09ca581a9deb3df274601930e428e452f7e4e9f1833c56a100a</div><div class=\"line\">Deleted: sha256:d72d0199021776e77ac14a764a3decd156e9f6f18b37e25b867b0f1ca42fb3d9</div><div class=\"line\">Deleted: sha256:fb178c6cea1453d089ce033b96eba0efdb42274138e042517ea2d5ea7bb51665</div><div class=\"line\">Deleted: sha256:8945af30572845a904adce2aeaf73402c842d86e99e8f10688b25cb27834110b</div><div class=\"line\">Deleted: sha256:ea9f151abb7e06353e73172dad421235611d4f6d0560ec95db26e0dc240642c1</div></pre></td></tr></table></figure>\n<h4 id=\"4-运行一个docker镜像\"><a href=\"#4-运行一个docker镜像\" class=\"headerlink\" title=\"4. 运行一个docker镜像\"></a><strong>4. 运行一个docker镜像</strong></h4><h4 id=\"进入交互式程序\"><a href=\"#进入交互式程序\" class=\"headerlink\" title=\"进入交互式程序\"></a>进入交互式程序</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@docker ~]# docker run  -it centos:centos6 /bin/bash</div><div class=\"line\">[root@c1d190f95562 /]# cat /etc/redhat-release</div><div class=\"line\">CentOS release 6.8 (Final)</div><div class=\"line\"># Install openssh-server and httpd</div><div class=\"line\">root@d8c122dbe09d:/# yum install -y openssh-sever httpd</div><div class=\"line\">root@d8c122dbe09d:/# exit</div><div class=\"line\"></div><div class=\"line\"># 注意当你执行exit，从容器之中退出时，容器也会随着关闭，这时如果还继续执行上条命令</div><div class=\"line\"># 你会发现之前所有的操作都被还原，因为相对于docker，又是新开了一个进程</div><div class=\"line\"># 在exit退出之后，使用一下命令查看上次提交，然后commit修改，便可保存之前的修改</div><div class=\"line\"></div><div class=\"line\">[root@docker ~]# docker ps -l</div><div class=\"line\">[root@docker ~]# docker commit c1d190f95562 centos:centos6-httpd</div><div class=\"line\">sha256:77eb12e36c7bbe9ef874555b1873019022b5258740aa731627e2cd6fa749c325</div><div class=\"line\">[root@docker ~]# docker images</div><div class=\"line\">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</div><div class=\"line\">centos              centos6-httpd       77eb12e36c7b        3 seconds ago       290.3 MB</div><div class=\"line\">centos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB</div><div class=\"line\">centos              centos6             a3c09d36ab4a        2 days ago          194.6 MB</div><div class=\"line\">registry            latest              c6c14b3960bd        3 days ago          33.28 MB</div></pre></td></tr></table></figure>\n<h4 id=\"5-编辑Dockerfile\"><a href=\"#5-编辑Dockerfile\" class=\"headerlink\" title=\"5. 编辑Dockerfile\"></a><strong>5. 编辑Dockerfile</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"># dockfile的第一行一定是FROM，指定了父镜像</div><div class=\"line\">FROM centos:centos6</div><div class=\"line\"></div><div class=\"line\"># RUN 指的是运行的命令</div><div class=\"line\">RUN yum install -y epel-release</div><div class=\"line\">RUN yum install -y bash-completion</div><div class=\"line\">RUN yum install -y openssh-server openssh-client sudo</div><div class=\"line\">RUN sed -i &apos;s/UsePAM yes/UsePAM no/g&apos; /etc/ssh/sshd_config</div><div class=\"line\">RUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</div><div class=\"line\"></div><div class=\"line\"># 增加一个用户，并赋予sudo权限</div><div class=\"line\">RUN useradd visionet</div><div class=\"line\">RUN echo &quot;visionet:visionet&quot; | chpasswd</div><div class=\"line\">RUN echo &quot;visionet   ALL=(ALL)       ALL&quot; &gt;&gt; /etc/sudoers</div><div class=\"line\"></div><div class=\"line\">＃ 注意，如果没有执行一下两个命令，sshd是无法远程登陆的</div><div class=\"line\">RUN ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key</div><div class=\"line\">RUN ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key</div><div class=\"line\"></div><div class=\"line\">＃ EXPOSE 22， 将22端口暴露出来，方便ssh远程连接</div><div class=\"line\">RUN mkdir /var/run/sshd</div><div class=\"line\">EXPOSE 22</div><div class=\"line\">＃ CMD 为系统内部执行命令</div><div class=\"line\">CMD [&quot;/usr/sbin/sshd&quot;, &quot;-D&quot;]</div></pre></td></tr></table></figure>\n<h4 id=\"6-生成自定义docker镜像\"><a href=\"#6-生成自定义docker镜像\" class=\"headerlink\" title=\"6. 生成自定义docker镜像\"></a><strong>6. 生成自定义docker镜像</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div></pre></td><td class=\"code\"><pre><div class=\"line\"># build 编译镜像</div><div class=\"line\">[root@docker ~]# docker build -f dockerfile3 -t centos:centos6-ssh .</div><div class=\"line\">Sending build context to Docker daemon 44.54 kB</div><div class=\"line\">Step 1 : FROM centos:centos6</div><div class=\"line\"> ---&gt; a3c09d36ab4a</div><div class=\"line\">Step 2 : RUN yum install -y epel-release</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 04d81f280a63</div><div class=\"line\">Step 3 : RUN yum install -y bash-completion</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 5ca26894dc9d</div><div class=\"line\">Step 4 : RUN yum install -y openssh-server openssh-client sudo</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 42278450311e</div><div class=\"line\">Step 5 : RUN sed -i &apos;s/UsePAM yes/UsePAM no/g&apos; /etc/ssh/sshd_config</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; db35bef562a2</div><div class=\"line\">Step 6 : RUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; dc9f2b82e198</div><div class=\"line\">Step 7 : RUN useradd visionet</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 06c574a51755</div><div class=\"line\">Step 8 : RUN echo &quot;visionet:visionet&quot; | chpasswd</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 03412f053d04</div><div class=\"line\">Step 9 : RUN echo &quot;visionet   ALL=(ALL)       ALL&quot; &gt;&gt; /etc/sudoers</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; bf8476812a62</div><div class=\"line\">Step 10 : RUN ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 2314cce75171</div><div class=\"line\">Step 11 : RUN ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 99304cd9ac15</div><div class=\"line\">Step 12 : RUN mkdir /var/run/sshd</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; f87283751553</div><div class=\"line\">Step 13 : EXPOSE 22</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 56c41202dcb9</div><div class=\"line\">Step 14 : CMD /usr/sbin/sshd -D</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; d6dccb483fa6</div><div class=\"line\">Successfully built d6dccb483fa6</div><div class=\"line\">[root@docker ~]# docker images</div><div class=\"line\">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</div><div class=\"line\">centos              centos6-ssh         d6dccb483fa6        2 minutes ago         363 MB</div><div class=\"line\">centos              centos6-httpd       77eb12e36c7b        6 minutes ago       290.3 MB</div><div class=\"line\">centos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB</div><div class=\"line\">centos              centos6             a3c09d36ab4a        2 days ago          194.6 MB</div><div class=\"line\">registry            latest              c6c14b3960bd        3 days ago          33.28 MB</div><div class=\"line\"></div><div class=\"line\"># 后台运行docker容器，并指定nat端口转发</div><div class=\"line\">[root@docker ~]# docker run -d -p 2222:22 -P --name=sshd centos:centos6-ssh</div><div class=\"line\">b4211f7a304d9e34b72b510230be2c7a76b276886b488f08f3e12896a4d3c172</div></pre></td></tr></table></figure>\n<h4 id=\"7-ssh登陆到docker容器内，部署项目环境\"><a href=\"#7-ssh登陆到docker容器内，部署项目环境\" class=\"headerlink\" title=\"7. ssh登陆到docker容器内，部署项目环境\"></a><strong>7. ssh登陆到docker容器内，部署项目环境</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"># inspect 查看docker 容器IP地址</div><div class=\"line\">[root@docker ~]# docker inspect sshd | grep IPAddress</div><div class=\"line\">[root@docker ~]# ssh visionet@172.17.0.2</div><div class=\"line\">visionet@172.17.0.2&apos;s password:</div><div class=\"line\">[visionet@b4211f7a304d ~]$</div><div class=\"line\"></div><div class=\"line\"># Install mysql</div><div class=\"line\"># Install tomcat server</div><div class=\"line\"></div><div class=\"line\">[visionet@b4211f7a304d ~]$ exit</div><div class=\"line\">[root@docker ~]# docker stop sshd</div><div class=\"line\">sshd</div><div class=\"line\">[root@docker ~]# docker ps -l</div><div class=\"line\">CONTAINER ID        IMAGE                COMMAND               CREATED             STATUS                       PORTS               NAMES</div><div class=\"line\">b4211f7a304d        centos:centos6-ssh   &quot;/usr/sbin/sshd -D&quot;   6 minutes ago       Exited (255) 3 seconds ago                       sshd</div><div class=\"line\">[root@docker ~]# docker commit b4211f7a304d centos:centos6-tomcat</div><div class=\"line\">sha256:b4f114d5484822d9a3ddf1100b76b460985ba5e5d31e936570e8d7dbd8df282c</div><div class=\"line\">[root@docker ~]# docker images</div><div class=\"line\">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</div><div class=\"line\">centos              centos6-tomcat      b4f114d54848        4 seconds ago       363.1 MB</div><div class=\"line\">centos              centos6-httpd       77eb12e36c7b        15 minutes ago      290.3 MB</div><div class=\"line\">centos6-visionet    latest              aeed37612ecb        7 hours ago         1.916 GB</div><div class=\"line\">centos              centos6-ssh         d6dccb483fa6        9 hours ago         363 MB</div><div class=\"line\">centos              centos6             a3c09d36ab4a        2 days ago          194.6 MB</div><div class=\"line\">registry            latest              c6c14b3960bd        3 days ago          33.28 MB</div></pre></td></tr></table></figure>\n<h4 id=\"8-推送centos-centos6-tomcat到私有docker仓库\"><a href=\"#8-推送centos-centos6-tomcat到私有docker仓库\" class=\"headerlink\" title=\"8. 推送centos:centos6-tomcat到私有docker仓库\"></a><strong>8. 推送centos:centos6-tomcat到私有docker仓库</strong></h4>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"1-安装CentOS-7-x\"><a href=\"#1-安装CentOS-7-x\" class=\"headerlink\" title=\"1. 安装CentOS 7.x\"></a><strong>1. 安装CentOS 7.x</strong></h4><pre><code>略。\n</code></pre><h4 id=\"2-安装docker\"><a href=\"#2-安装docker\" class=\"headerlink\" title=\"2. 安装docker\"></a><strong>2. 安装docker</strong></h4><p>详见： <a href=\"http://blog.ultraera.org/how-to-install-docker-on-centos-6-x-2/\">How to Install Docker on CentOS 6.x</a></p>\n<h4 id=\"3-基础docker命令\"><a href=\"#3-基础docker命令\" class=\"headerlink\" title=\"3. 基础docker命令\"></a><strong>3. 基础docker命令</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div></pre></td><td class=\"code\"><pre><div class=\"line\">＃ 获取centos6 docker镜像</div><div class=\"line\">[root@docker ~]# docker pull centos6</div><div class=\"line\">Using default tag: latest</div><div class=\"line\">latest: Pulling from library/centos:centos6</div><div class=\"line\"></div><div class=\"line\">43db9dbdcb30: Downloading 41.14 MB/49.33 MB</div><div class=\"line\">43db9dbdcb30: Pull complete</div><div class=\"line\">2dc64e8f8d4f: Pull complete</div><div class=\"line\">670a583e1b50: Pull complete</div><div class=\"line\">183b0bfcd10e: Pull complete</div><div class=\"line\">Digest: sha256:c6674c44c6439673bf56536c1a15916639c47ea04c3d6296c5df938add67b54b</div><div class=\"line\">Status: Downloaded newer image for centso:centos6</div><div class=\"line\"></div><div class=\"line\">＃ 查看当前服务器上的docker镜像</div><div class=\"line\">[root@docker ~]# docker images</div><div class=\"line\">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</div><div class=\"line\">centos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB</div><div class=\"line\">centos              centos6             a3c09d36ab4a        2 days ago          194.6 MB</div><div class=\"line\">registry            latest              c6c14b3960bd        3 days ago          33.28 MB</div><div class=\"line\">＃ 查找docker镜像</div><div class=\"line\">[root@docker ~]# docker search centos:centos6</div><div class=\"line\">NAME                                     DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</div><div class=\"line\">imagine10255/centos6-lnmp-php56          centos6-lnmp-php56                              10                   [OK]</div><div class=\"line\">lemonbar/centos6-ssh                     Installed openssh-server on centos6, defau...   7                    [OK]</div><div class=\"line\">sergeyzh/centos6-nginx                                                                   2                    [OK]</div><div class=\"line\">guyton/centos6                           From official centos6 container with full ...   2                    [OK]</div><div class=\"line\">paijp/centos6-apache-php-sqlite2         php5.3.3 with sqlite2 and apache on CentOS...   1                    [OK]</div><div class=\"line\">edrans/centos6                                                                           1                    [OK]</div><div class=\"line\">mohri1219/centos6.7-ruby2.2.2-mysql5.6   centos6.7-ruby2.2.2-mysql5.6                    1                    [OK]</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\"></div><div class=\"line\">＃ 删除 centos6 docker镜像</div><div class=\"line\">[root@docker ~]# docker rmi IMAGES_NAME</div><div class=\"line\">[root@docker ~]# docker rmi centos:centos6</div><div class=\"line\"># 报错无法删除</div><div class=\"line\">Error response from daemon: conflict: unable to remove repository reference &quot;centos&quot; (must force) - container 705a30cbc002 is using its referenced image 42118e3df429</div><div class=\"line\"># 这是因为之间的运行的进程没有清楚导致该images正在使用中，使用一下命令查看占有的进程</div><div class=\"line\">[root@docker ~]# docker ps -a ＃ 查看所有的docker进程</div><div class=\"line\">CONTAINER ID        IMAGE               COMMAND               CREATED             STATUS                     PORTS               NAMES</div><div class=\"line\">705a30cbc002        centos:centos6              &quot;/bin/bash&quot;           6 minutes ago       Exited (0) 6 minutes ago                       centos6</div><div class=\"line\">[root@docker ~]# docker rm 705a30cbc002</div><div class=\"line\">705a30cbc002</div><div class=\"line\">[root@docker ~]# docker rmi centos:centos6</div><div class=\"line\">Untagged: centos:centos6</div><div class=\"line\">Deleted: sha256:42118e3df429f09ca581a9deb3df274601930e428e452f7e4e9f1833c56a100a</div><div class=\"line\">Deleted: sha256:d72d0199021776e77ac14a764a3decd156e9f6f18b37e25b867b0f1ca42fb3d9</div><div class=\"line\">Deleted: sha256:fb178c6cea1453d089ce033b96eba0efdb42274138e042517ea2d5ea7bb51665</div><div class=\"line\">Deleted: sha256:8945af30572845a904adce2aeaf73402c842d86e99e8f10688b25cb27834110b</div><div class=\"line\">Deleted: sha256:ea9f151abb7e06353e73172dad421235611d4f6d0560ec95db26e0dc240642c1</div></pre></td></tr></table></figure>\n<h4 id=\"4-运行一个docker镜像\"><a href=\"#4-运行一个docker镜像\" class=\"headerlink\" title=\"4. 运行一个docker镜像\"></a><strong>4. 运行一个docker镜像</strong></h4><h4 id=\"进入交互式程序\"><a href=\"#进入交互式程序\" class=\"headerlink\" title=\"进入交互式程序\"></a>进入交互式程序</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@docker ~]# docker run  -it centos:centos6 /bin/bash</div><div class=\"line\">[root@c1d190f95562 /]# cat /etc/redhat-release</div><div class=\"line\">CentOS release 6.8 (Final)</div><div class=\"line\"># Install openssh-server and httpd</div><div class=\"line\">root@d8c122dbe09d:/# yum install -y openssh-sever httpd</div><div class=\"line\">root@d8c122dbe09d:/# exit</div><div class=\"line\"></div><div class=\"line\"># 注意当你执行exit，从容器之中退出时，容器也会随着关闭，这时如果还继续执行上条命令</div><div class=\"line\"># 你会发现之前所有的操作都被还原，因为相对于docker，又是新开了一个进程</div><div class=\"line\"># 在exit退出之后，使用一下命令查看上次提交，然后commit修改，便可保存之前的修改</div><div class=\"line\"></div><div class=\"line\">[root@docker ~]# docker ps -l</div><div class=\"line\">[root@docker ~]# docker commit c1d190f95562 centos:centos6-httpd</div><div class=\"line\">sha256:77eb12e36c7bbe9ef874555b1873019022b5258740aa731627e2cd6fa749c325</div><div class=\"line\">[root@docker ~]# docker images</div><div class=\"line\">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</div><div class=\"line\">centos              centos6-httpd       77eb12e36c7b        3 seconds ago       290.3 MB</div><div class=\"line\">centos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB</div><div class=\"line\">centos              centos6             a3c09d36ab4a        2 days ago          194.6 MB</div><div class=\"line\">registry            latest              c6c14b3960bd        3 days ago          33.28 MB</div></pre></td></tr></table></figure>\n<h4 id=\"5-编辑Dockerfile\"><a href=\"#5-编辑Dockerfile\" class=\"headerlink\" title=\"5. 编辑Dockerfile\"></a><strong>5. 编辑Dockerfile</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"># dockfile的第一行一定是FROM，指定了父镜像</div><div class=\"line\">FROM centos:centos6</div><div class=\"line\"></div><div class=\"line\"># RUN 指的是运行的命令</div><div class=\"line\">RUN yum install -y epel-release</div><div class=\"line\">RUN yum install -y bash-completion</div><div class=\"line\">RUN yum install -y openssh-server openssh-client sudo</div><div class=\"line\">RUN sed -i &apos;s/UsePAM yes/UsePAM no/g&apos; /etc/ssh/sshd_config</div><div class=\"line\">RUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</div><div class=\"line\"></div><div class=\"line\"># 增加一个用户，并赋予sudo权限</div><div class=\"line\">RUN useradd visionet</div><div class=\"line\">RUN echo &quot;visionet:visionet&quot; | chpasswd</div><div class=\"line\">RUN echo &quot;visionet   ALL=(ALL)       ALL&quot; &gt;&gt; /etc/sudoers</div><div class=\"line\"></div><div class=\"line\">＃ 注意，如果没有执行一下两个命令，sshd是无法远程登陆的</div><div class=\"line\">RUN ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key</div><div class=\"line\">RUN ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key</div><div class=\"line\"></div><div class=\"line\">＃ EXPOSE 22， 将22端口暴露出来，方便ssh远程连接</div><div class=\"line\">RUN mkdir /var/run/sshd</div><div class=\"line\">EXPOSE 22</div><div class=\"line\">＃ CMD 为系统内部执行命令</div><div class=\"line\">CMD [&quot;/usr/sbin/sshd&quot;, &quot;-D&quot;]</div></pre></td></tr></table></figure>\n<h4 id=\"6-生成自定义docker镜像\"><a href=\"#6-生成自定义docker镜像\" class=\"headerlink\" title=\"6. 生成自定义docker镜像\"></a><strong>6. 生成自定义docker镜像</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div></pre></td><td class=\"code\"><pre><div class=\"line\"># build 编译镜像</div><div class=\"line\">[root@docker ~]# docker build -f dockerfile3 -t centos:centos6-ssh .</div><div class=\"line\">Sending build context to Docker daemon 44.54 kB</div><div class=\"line\">Step 1 : FROM centos:centos6</div><div class=\"line\"> ---&gt; a3c09d36ab4a</div><div class=\"line\">Step 2 : RUN yum install -y epel-release</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 04d81f280a63</div><div class=\"line\">Step 3 : RUN yum install -y bash-completion</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 5ca26894dc9d</div><div class=\"line\">Step 4 : RUN yum install -y openssh-server openssh-client sudo</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 42278450311e</div><div class=\"line\">Step 5 : RUN sed -i &apos;s/UsePAM yes/UsePAM no/g&apos; /etc/ssh/sshd_config</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; db35bef562a2</div><div class=\"line\">Step 6 : RUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; dc9f2b82e198</div><div class=\"line\">Step 7 : RUN useradd visionet</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 06c574a51755</div><div class=\"line\">Step 8 : RUN echo &quot;visionet:visionet&quot; | chpasswd</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 03412f053d04</div><div class=\"line\">Step 9 : RUN echo &quot;visionet   ALL=(ALL)       ALL&quot; &gt;&gt; /etc/sudoers</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; bf8476812a62</div><div class=\"line\">Step 10 : RUN ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 2314cce75171</div><div class=\"line\">Step 11 : RUN ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 99304cd9ac15</div><div class=\"line\">Step 12 : RUN mkdir /var/run/sshd</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; f87283751553</div><div class=\"line\">Step 13 : EXPOSE 22</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; 56c41202dcb9</div><div class=\"line\">Step 14 : CMD /usr/sbin/sshd -D</div><div class=\"line\"> ---&gt; Using cache</div><div class=\"line\"> ---&gt; d6dccb483fa6</div><div class=\"line\">Successfully built d6dccb483fa6</div><div class=\"line\">[root@docker ~]# docker images</div><div class=\"line\">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</div><div class=\"line\">centos              centos6-ssh         d6dccb483fa6        2 minutes ago         363 MB</div><div class=\"line\">centos              centos6-httpd       77eb12e36c7b        6 minutes ago       290.3 MB</div><div class=\"line\">centos6-visionet    latest              aeed37612ecb        6 hours ago         1.916 GB</div><div class=\"line\">centos              centos6             a3c09d36ab4a        2 days ago          194.6 MB</div><div class=\"line\">registry            latest              c6c14b3960bd        3 days ago          33.28 MB</div><div class=\"line\"></div><div class=\"line\"># 后台运行docker容器，并指定nat端口转发</div><div class=\"line\">[root@docker ~]# docker run -d -p 2222:22 -P --name=sshd centos:centos6-ssh</div><div class=\"line\">b4211f7a304d9e34b72b510230be2c7a76b276886b488f08f3e12896a4d3c172</div></pre></td></tr></table></figure>\n<h4 id=\"7-ssh登陆到docker容器内，部署项目环境\"><a href=\"#7-ssh登陆到docker容器内，部署项目环境\" class=\"headerlink\" title=\"7. ssh登陆到docker容器内，部署项目环境\"></a><strong>7. ssh登陆到docker容器内，部署项目环境</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"># inspect 查看docker 容器IP地址</div><div class=\"line\">[root@docker ~]# docker inspect sshd | grep IPAddress</div><div class=\"line\">[root@docker ~]# ssh visionet@172.17.0.2</div><div class=\"line\">visionet@172.17.0.2&apos;s password:</div><div class=\"line\">[visionet@b4211f7a304d ~]$</div><div class=\"line\"></div><div class=\"line\"># Install mysql</div><div class=\"line\"># Install tomcat server</div><div class=\"line\"></div><div class=\"line\">[visionet@b4211f7a304d ~]$ exit</div><div class=\"line\">[root@docker ~]# docker stop sshd</div><div class=\"line\">sshd</div><div class=\"line\">[root@docker ~]# docker ps -l</div><div class=\"line\">CONTAINER ID        IMAGE                COMMAND               CREATED             STATUS                       PORTS               NAMES</div><div class=\"line\">b4211f7a304d        centos:centos6-ssh   &quot;/usr/sbin/sshd -D&quot;   6 minutes ago       Exited (255) 3 seconds ago                       sshd</div><div class=\"line\">[root@docker ~]# docker commit b4211f7a304d centos:centos6-tomcat</div><div class=\"line\">sha256:b4f114d5484822d9a3ddf1100b76b460985ba5e5d31e936570e8d7dbd8df282c</div><div class=\"line\">[root@docker ~]# docker images</div><div class=\"line\">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</div><div class=\"line\">centos              centos6-tomcat      b4f114d54848        4 seconds ago       363.1 MB</div><div class=\"line\">centos              centos6-httpd       77eb12e36c7b        15 minutes ago      290.3 MB</div><div class=\"line\">centos6-visionet    latest              aeed37612ecb        7 hours ago         1.916 GB</div><div class=\"line\">centos              centos6-ssh         d6dccb483fa6        9 hours ago         363 MB</div><div class=\"line\">centos              centos6             a3c09d36ab4a        2 days ago          194.6 MB</div><div class=\"line\">registry            latest              c6c14b3960bd        3 days ago          33.28 MB</div></pre></td></tr></table></figure>\n<h4 id=\"8-推送centos-centos6-tomcat到私有docker仓库\"><a href=\"#8-推送centos-centos6-tomcat到私有docker仓库\" class=\"headerlink\" title=\"8. 推送centos:centos6-tomcat到私有docker仓库\"></a><strong>8. 推送centos:centos6-tomcat到私有docker仓库</strong></h4>"},{"title":"HowTo Use Fuse-sshfs to Mount Remote Filesystems","id":"62","updated":"2017-04-21T05:27:54.000Z","date":"2016-07-04T17:58:03.000Z","_content":"\n传统我们服务器之间文件共享的方式有采用NFS、Samba等等，但是在我看来配置都有一定的复杂性，当然复杂也有它们的优势，这里推荐一个依赖于SSH的文件共享工具，Fuse-sshfs。<br>\nSSH 是一个强大且安全的工具，我们除了可以用它来远程管理主机外，还可以通过它建立 SSH tunnel 作 Proxy 用，远程传输文件等等。而这里我想要介绍另外一个功能，那就是结合 sshfs 这个工具可以把远程主机的文件系统映射到本地主机上，透过 SSH 把远程文件系统挂载到本机上，这样我们可以不必使用 scp 工具就可以做到直接复制及删除远程主机的文件了，就像操作本地磁盘一样方便。\n<br>sshfs 是基于 FUSE 构建的 SSH 文件系统客户端程序，通过它远程主机的配置无需作任何改变，就可以透过 SSH 协议来挂载远程文件系统了，非常方便及安全。\n<br>\n\n### Install fuse-sshfs\n```\n[cent@localhost ~]$ sudo yum install -y epel-relese\n[cent@localhost ~]$ sudo yum --enablerepo=epel install -y fuse-sshfs\n```\n### 挂载远程 ssh文件系统\n```\n[cent@localhost ~]$ mkdir ./mnt\n[cent@localhost ~]$ sshfs root@192.168.16.230:/home/ ./mnt\nroot@192.168.16.230's password:\n[cent@localhost ~]$ mount\nroot@192.168.16.230:/home/ on /home/cent/mnt type fuse.sshfs (rw,nosuid,nodev,user=cent)\n```\n### 卸载远程 ssh文件系统\n```\n[cent@localhost ~]$ fusermount -u ./mnt\n```\n### 常用参数\n```\n-C 压缩，或者-o compression=yes\n-o reconnect 自动重连\n-o transform_symlinks 表示转换绝对链接符号为相对链接符号\n-o follow_symlinks 沿用服务器上的链接符号\n-o cache=yes\n-o allow_other 这个参数最重要，必须写，否则任何文件都是Permission Deny\n```\n\n\n\n\n###  缺点\n当然sshfs也不尽是优点，例如远程主机失去响应后本地挂载点卡死并影响本地系统使用，需要手工找出 sshfs进程并杀死，因网速问题造成操作响应缓慢等等，不过一般在稳定快速的网络中不太会遇上，对比其强大的功能，还是可以接受的，正所谓暇不掩瑜。\n\n1. 所以sshfs适合内部网络比较稳定的地方\n2. 配合ssh免密登录使用会更好哦\n3. 可以看到的是sshfs默认挂载是rw的权限，但是通过sshfs --help 可以看到有非常详尽的参数配置可以选择，大家可以仔细研究下。\n\n\n### 附1.\n[Link](http://igikorn.com/sshfs-windows-8/) 在windows下可以使用sshfs.\n","source":"_posts/HowTo-Use-Fuse-sshfs-to-Mount-Remote-Filesystems.md","raw":"---\ntitle: HowTo Use Fuse-sshfs to Mount Remote Filesystems\ntags: 'SSH'\ncategories: 'CentOS'\npermalink: use-fuse-sshfs-to-mount-remote-filesystems\nid: 62\nupdated: '2017-04-21 13:27:54'\ndate: 2016-07-05 01:58:03\n---\n\n传统我们服务器之间文件共享的方式有采用NFS、Samba等等，但是在我看来配置都有一定的复杂性，当然复杂也有它们的优势，这里推荐一个依赖于SSH的文件共享工具，Fuse-sshfs。<br>\nSSH 是一个强大且安全的工具，我们除了可以用它来远程管理主机外，还可以通过它建立 SSH tunnel 作 Proxy 用，远程传输文件等等。而这里我想要介绍另外一个功能，那就是结合 sshfs 这个工具可以把远程主机的文件系统映射到本地主机上，透过 SSH 把远程文件系统挂载到本机上，这样我们可以不必使用 scp 工具就可以做到直接复制及删除远程主机的文件了，就像操作本地磁盘一样方便。\n<br>sshfs 是基于 FUSE 构建的 SSH 文件系统客户端程序，通过它远程主机的配置无需作任何改变，就可以透过 SSH 协议来挂载远程文件系统了，非常方便及安全。\n<br>\n\n### Install fuse-sshfs\n```\n[cent@localhost ~]$ sudo yum install -y epel-relese\n[cent@localhost ~]$ sudo yum --enablerepo=epel install -y fuse-sshfs\n```\n### 挂载远程 ssh文件系统\n```\n[cent@localhost ~]$ mkdir ./mnt\n[cent@localhost ~]$ sshfs root@192.168.16.230:/home/ ./mnt\nroot@192.168.16.230's password:\n[cent@localhost ~]$ mount\nroot@192.168.16.230:/home/ on /home/cent/mnt type fuse.sshfs (rw,nosuid,nodev,user=cent)\n```\n### 卸载远程 ssh文件系统\n```\n[cent@localhost ~]$ fusermount -u ./mnt\n```\n### 常用参数\n```\n-C 压缩，或者-o compression=yes\n-o reconnect 自动重连\n-o transform_symlinks 表示转换绝对链接符号为相对链接符号\n-o follow_symlinks 沿用服务器上的链接符号\n-o cache=yes\n-o allow_other 这个参数最重要，必须写，否则任何文件都是Permission Deny\n```\n\n\n\n\n###  缺点\n当然sshfs也不尽是优点，例如远程主机失去响应后本地挂载点卡死并影响本地系统使用，需要手工找出 sshfs进程并杀死，因网速问题造成操作响应缓慢等等，不过一般在稳定快速的网络中不太会遇上，对比其强大的功能，还是可以接受的，正所谓暇不掩瑜。\n\n1. 所以sshfs适合内部网络比较稳定的地方\n2. 配合ssh免密登录使用会更好哦\n3. 可以看到的是sshfs默认挂载是rw的权限，但是通过sshfs --help 可以看到有非常详尽的参数配置可以选择，大家可以仔细研究下。\n\n\n### 附1.\n[Link](http://igikorn.com/sshfs-windows-8/) 在windows下可以使用sshfs.\n","slug":"use-fuse-sshfs-to-mount-remote-filesystems","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqa1003s41tp1vuactuw","content":"<p>传统我们服务器之间文件共享的方式有采用NFS、Samba等等，但是在我看来配置都有一定的复杂性，当然复杂也有它们的优势，这里推荐一个依赖于SSH的文件共享工具，Fuse-sshfs。<br><br>SSH 是一个强大且安全的工具，我们除了可以用它来远程管理主机外，还可以通过它建立 SSH tunnel 作 Proxy 用，远程传输文件等等。而这里我想要介绍另外一个功能，那就是结合 sshfs 这个工具可以把远程主机的文件系统映射到本地主机上，透过 SSH 把远程文件系统挂载到本机上，这样我们可以不必使用 scp 工具就可以做到直接复制及删除远程主机的文件了，就像操作本地磁盘一样方便。<br><br>sshfs 是基于 FUSE 构建的 SSH 文件系统客户端程序，通过它远程主机的配置无需作任何改变，就可以透过 SSH 协议来挂载远程文件系统了，非常方便及安全。<br><br></p>\n<h3 id=\"Install-fuse-sshfs\"><a href=\"#Install-fuse-sshfs\" class=\"headerlink\" title=\"Install fuse-sshfs\"></a>Install fuse-sshfs</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@localhost ~]$ sudo yum install -y epel-relese</div><div class=\"line\">[cent@localhost ~]$ sudo yum --enablerepo=epel install -y fuse-sshfs</div></pre></td></tr></table></figure>\n<h3 id=\"挂载远程-ssh文件系统\"><a href=\"#挂载远程-ssh文件系统\" class=\"headerlink\" title=\"挂载远程 ssh文件系统\"></a>挂载远程 ssh文件系统</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@localhost ~]$ mkdir ./mnt</div><div class=\"line\">[cent@localhost ~]$ sshfs root@192.168.16.230:/home/ ./mnt</div><div class=\"line\">root@192.168.16.230&apos;s password:</div><div class=\"line\">[cent@localhost ~]$ mount</div><div class=\"line\">root@192.168.16.230:/home/ on /home/cent/mnt type fuse.sshfs (rw,nosuid,nodev,user=cent)</div></pre></td></tr></table></figure>\n<h3 id=\"卸载远程-ssh文件系统\"><a href=\"#卸载远程-ssh文件系统\" class=\"headerlink\" title=\"卸载远程 ssh文件系统\"></a>卸载远程 ssh文件系统</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@localhost ~]$ fusermount -u ./mnt</div></pre></td></tr></table></figure>\n<h3 id=\"常用参数\"><a href=\"#常用参数\" class=\"headerlink\" title=\"常用参数\"></a>常用参数</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">-C 压缩，或者-o compression=yes</div><div class=\"line\">-o reconnect 自动重连</div><div class=\"line\">-o transform_symlinks 表示转换绝对链接符号为相对链接符号</div><div class=\"line\">-o follow_symlinks 沿用服务器上的链接符号</div><div class=\"line\">-o cache=yes</div><div class=\"line\">-o allow_other 这个参数最重要，必须写，否则任何文件都是Permission Deny</div></pre></td></tr></table></figure>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><p>当然sshfs也不尽是优点，例如远程主机失去响应后本地挂载点卡死并影响本地系统使用，需要手工找出 sshfs进程并杀死，因网速问题造成操作响应缓慢等等，不过一般在稳定快速的网络中不太会遇上，对比其强大的功能，还是可以接受的，正所谓暇不掩瑜。</p>\n<ol>\n<li>所以sshfs适合内部网络比较稳定的地方</li>\n<li>配合ssh免密登录使用会更好哦</li>\n<li>可以看到的是sshfs默认挂载是rw的权限，但是通过sshfs –help 可以看到有非常详尽的参数配置可以选择，大家可以仔细研究下。</li>\n</ol>\n<h3 id=\"附1\"><a href=\"#附1\" class=\"headerlink\" title=\"附1.\"></a>附1.</h3><p><a href=\"http://igikorn.com/sshfs-windows-8/\" target=\"_blank\" rel=\"external\">Link</a> 在windows下可以使用sshfs.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>传统我们服务器之间文件共享的方式有采用NFS、Samba等等，但是在我看来配置都有一定的复杂性，当然复杂也有它们的优势，这里推荐一个依赖于SSH的文件共享工具，Fuse-sshfs。<br><br>SSH 是一个强大且安全的工具，我们除了可以用它来远程管理主机外，还可以通过它建立 SSH tunnel 作 Proxy 用，远程传输文件等等。而这里我想要介绍另外一个功能，那就是结合 sshfs 这个工具可以把远程主机的文件系统映射到本地主机上，透过 SSH 把远程文件系统挂载到本机上，这样我们可以不必使用 scp 工具就可以做到直接复制及删除远程主机的文件了，就像操作本地磁盘一样方便。<br><br>sshfs 是基于 FUSE 构建的 SSH 文件系统客户端程序，通过它远程主机的配置无需作任何改变，就可以透过 SSH 协议来挂载远程文件系统了，非常方便及安全。<br><br></p>\n<h3 id=\"Install-fuse-sshfs\"><a href=\"#Install-fuse-sshfs\" class=\"headerlink\" title=\"Install fuse-sshfs\"></a>Install fuse-sshfs</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@localhost ~]$ sudo yum install -y epel-relese</div><div class=\"line\">[cent@localhost ~]$ sudo yum --enablerepo=epel install -y fuse-sshfs</div></pre></td></tr></table></figure>\n<h3 id=\"挂载远程-ssh文件系统\"><a href=\"#挂载远程-ssh文件系统\" class=\"headerlink\" title=\"挂载远程 ssh文件系统\"></a>挂载远程 ssh文件系统</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@localhost ~]$ mkdir ./mnt</div><div class=\"line\">[cent@localhost ~]$ sshfs root@192.168.16.230:/home/ ./mnt</div><div class=\"line\">root@192.168.16.230&apos;s password:</div><div class=\"line\">[cent@localhost ~]$ mount</div><div class=\"line\">root@192.168.16.230:/home/ on /home/cent/mnt type fuse.sshfs (rw,nosuid,nodev,user=cent)</div></pre></td></tr></table></figure>\n<h3 id=\"卸载远程-ssh文件系统\"><a href=\"#卸载远程-ssh文件系统\" class=\"headerlink\" title=\"卸载远程 ssh文件系统\"></a>卸载远程 ssh文件系统</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[cent@localhost ~]$ fusermount -u ./mnt</div></pre></td></tr></table></figure>\n<h3 id=\"常用参数\"><a href=\"#常用参数\" class=\"headerlink\" title=\"常用参数\"></a>常用参数</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">-C 压缩，或者-o compression=yes</div><div class=\"line\">-o reconnect 自动重连</div><div class=\"line\">-o transform_symlinks 表示转换绝对链接符号为相对链接符号</div><div class=\"line\">-o follow_symlinks 沿用服务器上的链接符号</div><div class=\"line\">-o cache=yes</div><div class=\"line\">-o allow_other 这个参数最重要，必须写，否则任何文件都是Permission Deny</div></pre></td></tr></table></figure>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><p>当然sshfs也不尽是优点，例如远程主机失去响应后本地挂载点卡死并影响本地系统使用，需要手工找出 sshfs进程并杀死，因网速问题造成操作响应缓慢等等，不过一般在稳定快速的网络中不太会遇上，对比其强大的功能，还是可以接受的，正所谓暇不掩瑜。</p>\n<ol>\n<li>所以sshfs适合内部网络比较稳定的地方</li>\n<li>配合ssh免密登录使用会更好哦</li>\n<li>可以看到的是sshfs默认挂载是rw的权限，但是通过sshfs –help 可以看到有非常详尽的参数配置可以选择，大家可以仔细研究下。</li>\n</ol>\n<h3 id=\"附1\"><a href=\"#附1\" class=\"headerlink\" title=\"附1.\"></a>附1.</h3><p><a href=\"http://igikorn.com/sshfs-windows-8/\">Link</a> 在windows下可以使用sshfs.</p>\n"},{"title":"HowTo Use Remi Install Redis","id":"63","updated":"2017-04-21T05:27:29.000Z","date":"2016-07-06T19:49:02.000Z","_content":"\n## **Setup 1. Install**\n\nFrist, To install remi Repo and epel Repo.\n\n#### **Remi EL6 for CentOS/RHEL 6.x**\n```\nrpm -Uvh https://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\nrpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n```\n#### **Remi EL5 for CentOS/RHEL 5.x**\n```\nrpm -Uvh https://dl.fedoraproject.org/pub/epel/5/x86_64/epel-release-5-4.noarch.rpm\nrpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-5.rpm\n```\n\n\n#### 有时间我们会碰到remi.repo无法使用报错，就像这样：\n```\nhttp://remi.schlundtech.de/enterprise/latest/remi/x86_64/repodata/repomd.xml: [Errno 14] PYCURL ERROR 22 - \"The requested URL returned error: 404 Not Found\"\n```\n\n#### 这时我们需要修改/etc/yum.repos.d/remi.repo，像这样：\n```\nbaseurl=http://rpms.famillecollet.com/enterprise/5/remi/$basearch/\n#mirrorlist=http://rpms.famillecollet.com/enterprise/5/remi/mirror/$basearch/\n```\n\n#### 如果发现安装后yum makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。\n```\n[repoName]\nname=repoName repo\nbaseurl=http://repoPath\ngpgcheck=0                # 是否启用gpgkey检查\nenabled=0                 # 是否启用该源\n```\n\n#### **Install Redis**\n```\nyum install -y redis\n\n[root@zabbix yum.repos.d]# rpm -qi redis\nName        : redis\nVersion     : 3.2.1\nRelease     : 2.el5.remi\nArchitecture: x86_64\nInstall Date: Thu 28 Jul 2016 12:00:41 PM CST\nGroup       : Applications/Databases\nSize        : 2113279\nLicense     : BSD\nSignature   : DSA/SHA1, Fri 24 Jun 2016 01:30:12 PM CST, Key ID 004e6f4700f97f56\nSource RPM  : redis-3.2.1-2.el5.remi.src.rpm\nBuild Date  : Fri 24 Jun 2016 01:28:27 PM CST\nBuild Host  : builder.remirepo.net\nRelocations : (not relocatable)\nPackager    : http://blog.remirepo.net/\nVendor      : Remi Collet\nURL         : http://redis.io\nSummary     : A persistent key-value database\n```\n\n## **Setup 2. 基本配置项**\n\n#### Redis 配置默认文件/etc/redis.conf\n ＃ 设置Redis的运行模式，yes表示后台运行，no表示不开启后台运行。\n```\ndaemonize yes\n```\n\n ＃ 指定 redis 监听端口，默认为 6379\n```\nport 6379\n```\n\n＃ 设置bind_ip，默认监听接口，默认是监听本地，如果未配置的情况下，只有本地可以访问redis，如果取消，则默认监听所有接口\n```\n# bind 127.0.0.1\n```\n\n＃ 指定日志记录级别\n```\n# debug  记录很多信息，用于开发和测试\n# varbose 很多精简的有用信息，不像 debug 会记录那么多\n# notice 普通的 verbose，常用于生产环境\n# warning 只有非常重要或者严重的信息会记录到日志\n\nloglevel verbose\n```\n\n＃ 配置 log 文件名称和全路径地址，默认为stdout，即标准输出，输出到/dev/null，可以手动指定redis日志文件地址，建议级别不要太高，否则会产生大量日志，注意避免磁盘因此撑满。\n```\nlogfile stdout\n```\n\n＃ 可用数据库数，默认值为 16，默认数据库存储在 DB 0 号 ID 库中，无特殊需求，建议仅设置一个数据库<br>\n＃ 查询数据库使用  SELECT 'dbid'，dbid 介于 0 到 'databases'-1 之间。\n```\ndatabase 16\n```\n\n\n＃ 安全限定，要求客户端在处理任何命令时都要验证身份和设置密码。<br>\n＃ 默认不启用，若要启用，需要将下行取消注释，并将foobared设置自定一的密码接即可。<br>\n＃ **因为redis加密是通过配置文件进行，所以目前各大云厂家的redis PAAS 服务，都不支持redis加密，在程序开发时需要注意。**\n```\n# requirepass foobared\n\n# 如果开启了安全验证，这时通过redis-cli登录时需要首先执行auth，否则不能正常使用。\nredis-cli> auth foobared\n```\n\n＃ 向redis内插入一条数据\n```\nredis-cli>  set [key] [values]\n```\n\n＃ 获取key的值\n```\nredis-cli> get key\n```\n\n＃ 查看redis的db信息\n```\nredis-cli> info\n```\n\n## **Setup 3. Others**\n\n* redis-dump\n* master/slave\n* slow log\n\n### <font color=blackm,sis size=45 >Wait ... </font>\n\n\n\n\n\n","source":"_posts/HowTo-Use-Remi-Install-Redis.md","raw":"---\ntitle: HowTo Use Remi Install Redis\ntags: 'Yum'\ncategories: 'Redis'\npermalink: redis01\nid: 63\nupdated: '2017-04-21 13:27:29'\ndate: 2016-07-07 03:49:02\n---\n\n## **Setup 1. Install**\n\nFrist, To install remi Repo and epel Repo.\n\n#### **Remi EL6 for CentOS/RHEL 6.x**\n```\nrpm -Uvh https://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\nrpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n```\n#### **Remi EL5 for CentOS/RHEL 5.x**\n```\nrpm -Uvh https://dl.fedoraproject.org/pub/epel/5/x86_64/epel-release-5-4.noarch.rpm\nrpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-5.rpm\n```\n\n\n#### 有时间我们会碰到remi.repo无法使用报错，就像这样：\n```\nhttp://remi.schlundtech.de/enterprise/latest/remi/x86_64/repodata/repomd.xml: [Errno 14] PYCURL ERROR 22 - \"The requested URL returned error: 404 Not Found\"\n```\n\n#### 这时我们需要修改/etc/yum.repos.d/remi.repo，像这样：\n```\nbaseurl=http://rpms.famillecollet.com/enterprise/5/remi/$basearch/\n#mirrorlist=http://rpms.famillecollet.com/enterprise/5/remi/mirror/$basearch/\n```\n\n#### 如果发现安装后yum makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。\n```\n[repoName]\nname=repoName repo\nbaseurl=http://repoPath\ngpgcheck=0                # 是否启用gpgkey检查\nenabled=0                 # 是否启用该源\n```\n\n#### **Install Redis**\n```\nyum install -y redis\n\n[root@zabbix yum.repos.d]# rpm -qi redis\nName        : redis\nVersion     : 3.2.1\nRelease     : 2.el5.remi\nArchitecture: x86_64\nInstall Date: Thu 28 Jul 2016 12:00:41 PM CST\nGroup       : Applications/Databases\nSize        : 2113279\nLicense     : BSD\nSignature   : DSA/SHA1, Fri 24 Jun 2016 01:30:12 PM CST, Key ID 004e6f4700f97f56\nSource RPM  : redis-3.2.1-2.el5.remi.src.rpm\nBuild Date  : Fri 24 Jun 2016 01:28:27 PM CST\nBuild Host  : builder.remirepo.net\nRelocations : (not relocatable)\nPackager    : http://blog.remirepo.net/\nVendor      : Remi Collet\nURL         : http://redis.io\nSummary     : A persistent key-value database\n```\n\n## **Setup 2. 基本配置项**\n\n#### Redis 配置默认文件/etc/redis.conf\n ＃ 设置Redis的运行模式，yes表示后台运行，no表示不开启后台运行。\n```\ndaemonize yes\n```\n\n ＃ 指定 redis 监听端口，默认为 6379\n```\nport 6379\n```\n\n＃ 设置bind_ip，默认监听接口，默认是监听本地，如果未配置的情况下，只有本地可以访问redis，如果取消，则默认监听所有接口\n```\n# bind 127.0.0.1\n```\n\n＃ 指定日志记录级别\n```\n# debug  记录很多信息，用于开发和测试\n# varbose 很多精简的有用信息，不像 debug 会记录那么多\n# notice 普通的 verbose，常用于生产环境\n# warning 只有非常重要或者严重的信息会记录到日志\n\nloglevel verbose\n```\n\n＃ 配置 log 文件名称和全路径地址，默认为stdout，即标准输出，输出到/dev/null，可以手动指定redis日志文件地址，建议级别不要太高，否则会产生大量日志，注意避免磁盘因此撑满。\n```\nlogfile stdout\n```\n\n＃ 可用数据库数，默认值为 16，默认数据库存储在 DB 0 号 ID 库中，无特殊需求，建议仅设置一个数据库<br>\n＃ 查询数据库使用  SELECT 'dbid'，dbid 介于 0 到 'databases'-1 之间。\n```\ndatabase 16\n```\n\n\n＃ 安全限定，要求客户端在处理任何命令时都要验证身份和设置密码。<br>\n＃ 默认不启用，若要启用，需要将下行取消注释，并将foobared设置自定一的密码接即可。<br>\n＃ **因为redis加密是通过配置文件进行，所以目前各大云厂家的redis PAAS 服务，都不支持redis加密，在程序开发时需要注意。**\n```\n# requirepass foobared\n\n# 如果开启了安全验证，这时通过redis-cli登录时需要首先执行auth，否则不能正常使用。\nredis-cli> auth foobared\n```\n\n＃ 向redis内插入一条数据\n```\nredis-cli>  set [key] [values]\n```\n\n＃ 获取key的值\n```\nredis-cli> get key\n```\n\n＃ 查看redis的db信息\n```\nredis-cli> info\n```\n\n## **Setup 3. Others**\n\n* redis-dump\n* master/slave\n* slow log\n\n### <font color=blackm,sis size=45 >Wait ... </font>\n\n\n\n\n\n","slug":"redis01","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqa6003w41tp2mulh1k5","content":"<h2 id=\"Setup-1-Install\"><a href=\"#Setup-1-Install\" class=\"headerlink\" title=\"Setup 1. Install\"></a><strong>Setup 1. Install</strong></h2><p>Frist, To install remi Repo and epel Repo.</p>\n<h4 id=\"Remi-EL6-for-CentOS-RHEL-6-x\"><a href=\"#Remi-EL6-for-CentOS-RHEL-6-x\" class=\"headerlink\" title=\"Remi EL6 for CentOS/RHEL 6.x\"></a><strong>Remi EL6 for CentOS/RHEL 6.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -Uvh https://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</div><div class=\"line\">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"Remi-EL5-for-CentOS-RHEL-5-x\"><a href=\"#Remi-EL5-for-CentOS-RHEL-5-x\" class=\"headerlink\" title=\"Remi EL5 for CentOS/RHEL 5.x\"></a><strong>Remi EL5 for CentOS/RHEL 5.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -Uvh https://dl.fedoraproject.org/pub/epel/5/x86_64/epel-release-5-4.noarch.rpm</div><div class=\"line\">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-5.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"有时间我们会碰到remi-repo无法使用报错，就像这样：\"><a href=\"#有时间我们会碰到remi-repo无法使用报错，就像这样：\" class=\"headerlink\" title=\"有时间我们会碰到remi.repo无法使用报错，就像这样：\"></a>有时间我们会碰到remi.repo无法使用报错，就像这样：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">http://remi.schlundtech.de/enterprise/latest/remi/x86_64/repodata/repomd.xml: [Errno 14] PYCURL ERROR 22 - &quot;The requested URL returned error: 404 Not Found&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"这时我们需要修改-etc-yum-repos-d-remi-repo，像这样：\"><a href=\"#这时我们需要修改-etc-yum-repos-d-remi-repo，像这样：\" class=\"headerlink\" title=\"这时我们需要修改/etc/yum.repos.d/remi.repo，像这样：\"></a>这时我们需要修改/etc/yum.repos.d/remi.repo，像这样：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">baseurl=http://rpms.famillecollet.com/enterprise/5/remi/$basearch/</div><div class=\"line\">#mirrorlist=http://rpms.famillecollet.com/enterprise/5/remi/mirror/$basearch/</div></pre></td></tr></table></figure>\n<h4 id=\"如果发现安装后yum-makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。\"><a href=\"#如果发现安装后yum-makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。\" class=\"headerlink\" title=\"如果发现安装后yum makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。\"></a>如果发现安装后yum makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[repoName]</div><div class=\"line\">name=repoName repo</div><div class=\"line\">baseurl=http://repoPath</div><div class=\"line\">gpgcheck=0                # 是否启用gpgkey检查</div><div class=\"line\">enabled=0                 # 是否启用该源</div></pre></td></tr></table></figure>\n<h4 id=\"Install-Redis\"><a href=\"#Install-Redis\" class=\"headerlink\" title=\"Install Redis\"></a><strong>Install Redis</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y redis</div><div class=\"line\"></div><div class=\"line\">[root@zabbix yum.repos.d]# rpm -qi redis</div><div class=\"line\">Name        : redis</div><div class=\"line\">Version     : 3.2.1</div><div class=\"line\">Release     : 2.el5.remi</div><div class=\"line\">Architecture: x86_64</div><div class=\"line\">Install Date: Thu 28 Jul 2016 12:00:41 PM CST</div><div class=\"line\">Group       : Applications/Databases</div><div class=\"line\">Size        : 2113279</div><div class=\"line\">License     : BSD</div><div class=\"line\">Signature   : DSA/SHA1, Fri 24 Jun 2016 01:30:12 PM CST, Key ID 004e6f4700f97f56</div><div class=\"line\">Source RPM  : redis-3.2.1-2.el5.remi.src.rpm</div><div class=\"line\">Build Date  : Fri 24 Jun 2016 01:28:27 PM CST</div><div class=\"line\">Build Host  : builder.remirepo.net</div><div class=\"line\">Relocations : (not relocatable)</div><div class=\"line\">Packager    : http://blog.remirepo.net/</div><div class=\"line\">Vendor      : Remi Collet</div><div class=\"line\">URL         : http://redis.io</div><div class=\"line\">Summary     : A persistent key-value database</div></pre></td></tr></table></figure>\n<h2 id=\"Setup-2-基本配置项\"><a href=\"#Setup-2-基本配置项\" class=\"headerlink\" title=\"Setup 2. 基本配置项\"></a><strong>Setup 2. 基本配置项</strong></h2><h4 id=\"Redis-配置默认文件-etc-redis-conf\"><a href=\"#Redis-配置默认文件-etc-redis-conf\" class=\"headerlink\" title=\"Redis 配置默认文件/etc/redis.conf\"></a>Redis 配置默认文件/etc/redis.conf</h4><p> ＃ 设置Redis的运行模式，yes表示后台运行，no表示不开启后台运行。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">daemonize yes</div></pre></td></tr></table></figure></p>\n<p> ＃ 指定 redis 监听端口，默认为 6379<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">port 6379</div></pre></td></tr></table></figure></p>\n<p>＃ 设置bind_ip，默认监听接口，默认是监听本地，如果未配置的情况下，只有本地可以访问redis，如果取消，则默认监听所有接口<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"># bind 127.0.0.1</div></pre></td></tr></table></figure></p>\n<p>＃ 指定日志记录级别<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"># debug  记录很多信息，用于开发和测试</div><div class=\"line\"># varbose 很多精简的有用信息，不像 debug 会记录那么多</div><div class=\"line\"># notice 普通的 verbose，常用于生产环境</div><div class=\"line\"># warning 只有非常重要或者严重的信息会记录到日志</div><div class=\"line\"></div><div class=\"line\">loglevel verbose</div></pre></td></tr></table></figure></p>\n<p>＃ 配置 log 文件名称和全路径地址，默认为stdout，即标准输出，输出到/dev/null，可以手动指定redis日志文件地址，建议级别不要太高，否则会产生大量日志，注意避免磁盘因此撑满。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">logfile stdout</div></pre></td></tr></table></figure></p>\n<p>＃ 可用数据库数，默认值为 16，默认数据库存储在 DB 0 号 ID 库中，无特殊需求，建议仅设置一个数据库<br><br>＃ 查询数据库使用  SELECT ‘dbid’，dbid 介于 0 到 ‘databases’-1 之间。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">database 16</div></pre></td></tr></table></figure></p>\n<p>＃ 安全限定，要求客户端在处理任何命令时都要验证身份和设置密码。<br><br>＃ 默认不启用，若要启用，需要将下行取消注释，并将foobared设置自定一的密码接即可。<br><br>＃ <strong>因为redis加密是通过配置文件进行，所以目前各大云厂家的redis PAAS 服务，都不支持redis加密，在程序开发时需要注意。</strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># requirepass foobared</div><div class=\"line\"></div><div class=\"line\"># 如果开启了安全验证，这时通过redis-cli登录时需要首先执行auth，否则不能正常使用。</div><div class=\"line\">redis-cli&gt; auth foobared</div></pre></td></tr></table></figure></p>\n<p>＃ 向redis内插入一条数据<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">redis-cli&gt;  set [key] [values]</div></pre></td></tr></table></figure></p>\n<p>＃ 获取key的值<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">redis-cli&gt; get key</div></pre></td></tr></table></figure></p>\n<p>＃ 查看redis的db信息<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">redis-cli&gt; info</div></pre></td></tr></table></figure></p>\n<h2 id=\"Setup-3-Others\"><a href=\"#Setup-3-Others\" class=\"headerlink\" title=\"Setup 3. Others\"></a><strong>Setup 3. Others</strong></h2><ul>\n<li>redis-dump</li>\n<li>master/slave</li>\n<li>slow log</li>\n</ul>\n<h3 id=\"Wait-…\"><a href=\"#Wait-…\" class=\"headerlink\" title=\"Wait … \"></a><font color=\"blackm,sis\" size=\"45\">Wait … </font></h3>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Setup-1-Install\"><a href=\"#Setup-1-Install\" class=\"headerlink\" title=\"Setup 1. Install\"></a><strong>Setup 1. Install</strong></h2><p>Frist, To install remi Repo and epel Repo.</p>\n<h4 id=\"Remi-EL6-for-CentOS-RHEL-6-x\"><a href=\"#Remi-EL6-for-CentOS-RHEL-6-x\" class=\"headerlink\" title=\"Remi EL6 for CentOS/RHEL 6.x\"></a><strong>Remi EL6 for CentOS/RHEL 6.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -Uvh https://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</div><div class=\"line\">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"Remi-EL5-for-CentOS-RHEL-5-x\"><a href=\"#Remi-EL5-for-CentOS-RHEL-5-x\" class=\"headerlink\" title=\"Remi EL5 for CentOS/RHEL 5.x\"></a><strong>Remi EL5 for CentOS/RHEL 5.x</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -Uvh https://dl.fedoraproject.org/pub/epel/5/x86_64/epel-release-5-4.noarch.rpm</div><div class=\"line\">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-5.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"有时间我们会碰到remi-repo无法使用报错，就像这样：\"><a href=\"#有时间我们会碰到remi-repo无法使用报错，就像这样：\" class=\"headerlink\" title=\"有时间我们会碰到remi.repo无法使用报错，就像这样：\"></a>有时间我们会碰到remi.repo无法使用报错，就像这样：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">http://remi.schlundtech.de/enterprise/latest/remi/x86_64/repodata/repomd.xml: [Errno 14] PYCURL ERROR 22 - &quot;The requested URL returned error: 404 Not Found&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"这时我们需要修改-etc-yum-repos-d-remi-repo，像这样：\"><a href=\"#这时我们需要修改-etc-yum-repos-d-remi-repo，像这样：\" class=\"headerlink\" title=\"这时我们需要修改/etc/yum.repos.d/remi.repo，像这样：\"></a>这时我们需要修改/etc/yum.repos.d/remi.repo，像这样：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">baseurl=http://rpms.famillecollet.com/enterprise/5/remi/$basearch/</div><div class=\"line\">#mirrorlist=http://rpms.famillecollet.com/enterprise/5/remi/mirror/$basearch/</div></pre></td></tr></table></figure>\n<h4 id=\"如果发现安装后yum-makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。\"><a href=\"#如果发现安装后yum-makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。\" class=\"headerlink\" title=\"如果发现安装后yum makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。\"></a>如果发现安装后yum makecache没看到相应的源站点，请检查repo文件的enable参数是否为1，1为开启，0为关闭状态。</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[repoName]</div><div class=\"line\">name=repoName repo</div><div class=\"line\">baseurl=http://repoPath</div><div class=\"line\">gpgcheck=0                # 是否启用gpgkey检查</div><div class=\"line\">enabled=0                 # 是否启用该源</div></pre></td></tr></table></figure>\n<h4 id=\"Install-Redis\"><a href=\"#Install-Redis\" class=\"headerlink\" title=\"Install Redis\"></a><strong>Install Redis</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y redis</div><div class=\"line\"></div><div class=\"line\">[root@zabbix yum.repos.d]# rpm -qi redis</div><div class=\"line\">Name        : redis</div><div class=\"line\">Version     : 3.2.1</div><div class=\"line\">Release     : 2.el5.remi</div><div class=\"line\">Architecture: x86_64</div><div class=\"line\">Install Date: Thu 28 Jul 2016 12:00:41 PM CST</div><div class=\"line\">Group       : Applications/Databases</div><div class=\"line\">Size        : 2113279</div><div class=\"line\">License     : BSD</div><div class=\"line\">Signature   : DSA/SHA1, Fri 24 Jun 2016 01:30:12 PM CST, Key ID 004e6f4700f97f56</div><div class=\"line\">Source RPM  : redis-3.2.1-2.el5.remi.src.rpm</div><div class=\"line\">Build Date  : Fri 24 Jun 2016 01:28:27 PM CST</div><div class=\"line\">Build Host  : builder.remirepo.net</div><div class=\"line\">Relocations : (not relocatable)</div><div class=\"line\">Packager    : http://blog.remirepo.net/</div><div class=\"line\">Vendor      : Remi Collet</div><div class=\"line\">URL         : http://redis.io</div><div class=\"line\">Summary     : A persistent key-value database</div></pre></td></tr></table></figure>\n<h2 id=\"Setup-2-基本配置项\"><a href=\"#Setup-2-基本配置项\" class=\"headerlink\" title=\"Setup 2. 基本配置项\"></a><strong>Setup 2. 基本配置项</strong></h2><h4 id=\"Redis-配置默认文件-etc-redis-conf\"><a href=\"#Redis-配置默认文件-etc-redis-conf\" class=\"headerlink\" title=\"Redis 配置默认文件/etc/redis.conf\"></a>Redis 配置默认文件/etc/redis.conf</h4><p> ＃ 设置Redis的运行模式，yes表示后台运行，no表示不开启后台运行。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">daemonize yes</div></pre></td></tr></table></figure></p>\n<p> ＃ 指定 redis 监听端口，默认为 6379<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">port 6379</div></pre></td></tr></table></figure></p>\n<p>＃ 设置bind_ip，默认监听接口，默认是监听本地，如果未配置的情况下，只有本地可以访问redis，如果取消，则默认监听所有接口<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"># bind 127.0.0.1</div></pre></td></tr></table></figure></p>\n<p>＃ 指定日志记录级别<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"># debug  记录很多信息，用于开发和测试</div><div class=\"line\"># varbose 很多精简的有用信息，不像 debug 会记录那么多</div><div class=\"line\"># notice 普通的 verbose，常用于生产环境</div><div class=\"line\"># warning 只有非常重要或者严重的信息会记录到日志</div><div class=\"line\"></div><div class=\"line\">loglevel verbose</div></pre></td></tr></table></figure></p>\n<p>＃ 配置 log 文件名称和全路径地址，默认为stdout，即标准输出，输出到/dev/null，可以手动指定redis日志文件地址，建议级别不要太高，否则会产生大量日志，注意避免磁盘因此撑满。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">logfile stdout</div></pre></td></tr></table></figure></p>\n<p>＃ 可用数据库数，默认值为 16，默认数据库存储在 DB 0 号 ID 库中，无特殊需求，建议仅设置一个数据库<br><br>＃ 查询数据库使用  SELECT ‘dbid’，dbid 介于 0 到 ‘databases’-1 之间。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">database 16</div></pre></td></tr></table></figure></p>\n<p>＃ 安全限定，要求客户端在处理任何命令时都要验证身份和设置密码。<br><br>＃ 默认不启用，若要启用，需要将下行取消注释，并将foobared设置自定一的密码接即可。<br><br>＃ <strong>因为redis加密是通过配置文件进行，所以目前各大云厂家的redis PAAS 服务，都不支持redis加密，在程序开发时需要注意。</strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># requirepass foobared</div><div class=\"line\"></div><div class=\"line\"># 如果开启了安全验证，这时通过redis-cli登录时需要首先执行auth，否则不能正常使用。</div><div class=\"line\">redis-cli&gt; auth foobared</div></pre></td></tr></table></figure></p>\n<p>＃ 向redis内插入一条数据<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">redis-cli&gt;  set [key] [values]</div></pre></td></tr></table></figure></p>\n<p>＃ 获取key的值<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">redis-cli&gt; get key</div></pre></td></tr></table></figure></p>\n<p>＃ 查看redis的db信息<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">redis-cli&gt; info</div></pre></td></tr></table></figure></p>\n<h2 id=\"Setup-3-Others\"><a href=\"#Setup-3-Others\" class=\"headerlink\" title=\"Setup 3. Others\"></a><strong>Setup 3. Others</strong></h2><ul>\n<li>redis-dump</li>\n<li>master/slave</li>\n<li>slow log</li>\n</ul>\n<h3 id=\"Wait-…\"><a href=\"#Wait-…\" class=\"headerlink\" title=\"Wait … \"></a><font color=blackm,sis size=45 >Wait … </font></h3>"},{"title":"HowTo Use pt-query-digest","id":"94","updated":"2017-04-21T05:28:57.000Z","date":"2016-09-22T07:20:12.000Z","_content":"\n\n\n\n\n### 1. 简介\n索引可以我们更快速的执行查询，但是肯定存在不合理的索引，如果想找到那些索引不是很合适的查询，并在它们成为问题前进行优化，则可以使用pt-query-digest的查询审查“review”功能，分析其EXPLAIN出来的执行计划。\n\npt-query-digest是用于分析mysql慢查询的一个工具，它可以分析binlog、General log、slowlog，也可以通过SHOWPROCESSLIST或者通过tcpdump抓取的MySQL协议数据来进行分析。可以把分析结果输出到文件中，分析过程是先对查询语句的条件进行参数化，然后对参数化以后的查询进行分组统计，统计出各查询的执行时间、次数、占比等，可以借助分析结果找出问题进行优化。\n\n### 2. Install Percona Toolkit & pt-query-digest\npercona-toolkit是一组高级命令行工具的集合，用来执行各种通过手工执行非常复杂和麻烦的mysql和系统任务。这些任务包括：\n\n* 检查master和slave数据的一致性\n* 有效地对记录进行归档\n* 查找重复的索引\n* 对服务器信息进行汇总\n* 分析来自日志和tcpdump的查询\n* 当系统出问题的时候收集重要的系统信息\n\n```\n[root@ultrera ~]# wget percona.com/get/percona-toolkit.tar.gz\n--2016-09-22 09:17:00--  http://percona.com/get/percona-toolkit.tar.gz\nResolving percona.com... 74.121.199.234, 74.121.199.234\nConnecting to percona.com|74.121.199.234|:80... connected.\nHTTP request sent, awaiting response... 301 Moved Permanently\nLocation: https://www.percona.com/get/percona-toolkit.tar.gz [following]\n--2016-09-22 09:17:02--  https://www.percona.com/get/percona-toolkit.tar.gz\nResolving www.percona.com... 74.121.199.234, 74.121.199.234\nConnecting to www.percona.com|74.121.199.234|:443... connected.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://www.percona.com/downloads/percona-toolkit/2.2.19/tarball/percona-toolkit-2.2.19.tar.gz [following]\n--2016-09-22 09:17:03--  https://www.percona.com/downloads/percona-toolkit/2.2.19/tarball/percona-toolkit-2.2.19.tar.gz\nReusing existing connection to www.percona.com:443.\nHTTP request sent, awaiting response... 200 OK\nLength: 1425623 (1.4M) [application/x-gzip]\nSaving to: “percona-toolkit.tar.gz”\n\n100%[=======================>] 1,425,623    766K/s   in 1.8s\n\n2016-09-22 09:17:05 (766 KB/s) - “percona-toolkit.tar.gz” saved [1425623/1425623]\n\n[root@ultrera ~]# tar xf percona-toolkit.tar.gz\n[root@ultrera ~]# ls\npercona-toolkit-2.2.19  percona-toolkit.tar.gz\n[root@ultrera ~]# cd percona-toolkit-2.2.19\n[root@ultrera percona-toolkit-2.2.19]# perl Makefile.PL\nWarning: prerequisite DBD::mysql 3 not found.\nWriting Makefile for percona-toolkit\n[root@ultrera percona-toolkit-2.2.19]# make\ncp bin/pt-mysql-summary blib/script/pt-mysql-summary\n....\nManifying blib/man1/pt-index-usage.1p\nManifying blib/man1/pt-duplicate-key-checker.1p\nManifying blib/man1/pt-config-diff.1p\nManifying blib/man1/pt-stalk.1p\n[root@ultrera percona-toolkit-2.2.19]# make install\nInstalling /usr/local/share/man/man1/pt-query-digest.1p\n...\nInstalling /usr/local/bin/pt-query-digest\n...\nAppending installation info to /usr/lib64/perl5/perllocal.pod\n```\n> 运行工具可能会遇到下面的错误: Can't locate Time/HiRes.pm in @INC\n\n```\n# 解决办法：\n[root@ultrera ~]# yum install -y perl-Time-HiRes\n[root@ultrera ~]# pt-query-digest --version\npt-query-digest 2.2.19\n```\n\n### 3. 开启 mysql慢日志\n##### a. 查看当前‘slow_query_log’ 状态：\n```\nmysql> show variables like '%query%';\n+------------------------------+---------------------------------+\n| Variable_name                | Value                           |\n+------------------------------+---------------------------------+\n| binlog_rows_query_log_events | OFF                             |\n| ft_query_expansion_limit     | 20                              |\n| have_query_cache             | YES                             |\n| long_query_time              | 10.000000                       |\n| query_alloc_block_size       | 8192                            |\n| query_cache_limit            | 1048576                         |\n| query_cache_min_res_unit     | 4096                            |\n| query_cache_size             | 1048576                         |\n| query_cache_type             | OFF                             |\n| query_cache_wlock_invalidate | OFF                             |\n| query_prealloc_size          | 8192                            |\n| slow_query_log               | OFF                             |\n| slow_query_log_file          | /var/lib/mysql/ultrera-slow.log |\n+------------------------------+---------------------------------+\n13 rows in set (0.00 sec)\n\nmysql> show variables like 'log_queries_not_using_indexes';\n+-------------------------------+-------+\n| Variable_name                 | Value |\n+-------------------------------+-------+\n| log_queries_not_using_indexes | OFF   |\n+-------------------------------+-------+\n1 row in set (0.00 sec)\n```\n##### b. 启动slow_log, 配置\n```\n# 设定记录大于2s的sql\nmysql> set global long_query_time=2;\nQuery OK, 0 rows affected (0.00 sec)\n\n# 设定log存放路径\nmysql> set global slow_query_log_file='/tmp/ultraera-slow.log';\nQuery OK, 0 rows affected (0.00 sec)\n\n# 启用慢日志\nmysql> set global slow_query_log=ON;\nQuery OK, 0 rows affected (0.00 sec)\n\n# 同时记录没有使用索引的sql\nmysql> set global log_queries_not_using_indexes=on;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n> 等待一段时间，slow.log 增大的非常快，实际生产中，注意不要被slow.log将磁盘撑满，影响到正常生产使用。\n\n### 4. 分析\npt-query-digest可以从普通MySQL日志，慢查询日志以及二进制日志中分析查询，甚至可以从SHOW PROCESSLIST和MySQL协议的tcpdump中进行分析，如果没有指定文件，它从标准输入流（STDIN）中读取数据。\n##### a. 简单使用方法：\n```\npt-query-digest slow.logs\n```\n输出信息如下：\n\n<div align=\"left\">\n![](http://images.cnitblog.com/blog/288950/201312/14135450-6f7a732598054f7aa311e95cbd4df3b1.png)\n</div>\n\n<ul>\n1. Overall这个部分是一个大致的概要信息(类似loadrunner给出的概要信息)，通过它可以对当前MySQL的查询性能做一个初步的评估，比如各个指标的最大值(max)，平均值(min)，95%分布值，中位数(median)，标准偏差(stddev)\n<li>查询的执行时间（Exec time）</li>\n<li>锁占用的时间（Lock time）</li>\n<li>MySQL执行器需要检查的行数（Rows examine）</li>\n<li>最后返回给客户端的行数（Rows sent）</li>\n<li>查询的大小。</li>\n</ul>\n<ul>\n2. Profile\n<li>Rank ： 整个分析中该“语句”的排名，一般也就是性能最慢的</li>\n<li>Query ID ：每个查询都有一个</li>\n<li>Response time ： “语句”的响应时间以及整体占比情况。</li>\n<li>Calls ：“语句”的执行次数</li>\n<li>R/Call ：每次执行的平均响应时间。 </li>\n<li>V/M</li>\n</ul>\n##### 详细信息\n<p>列出上面Profile中每个Query ID的详细信息</p>\n\n##### b. 从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：\n```\npt-query-digest --type tcpdump mysql.tcp.txt\n```\n\n\n##### c. pt-query-digest 还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析\n> 更多的帮助文档，请查看官方文档：http://www.percona.com/doc/percona-toolkit/2.2/pt-query-digest.html\n\n### 5. 使用Anemometer将pt-query-digest的MySQL慢查询可视化\n\n* 需要安装php 5.3 and over\n* 需要预先配置mysql数据库\n* 需要预先安装好pt-query-digest\n\n##### 5.1 安装\n```\n[root@ultrera ~]# git clone https://github.com/box/Anemometer.git anemometer\n\n[root@ultrera ~]# mv anemometer /var/www/html\n[root@ultrera ~]# cd /var/www/html/anemometer/\n[root@ultrera anemometer]# mysql -h localhost -u root -p < mysql56-install.sql\n[root@ultrera anemometer]# mysql -h localhost -u root -p -e \"grant all privileges on slow_query_log.* to 'anemometer'@'%' identified by 'anemometer';\"\n```\n##### 5.2 配置\n```\n[root@ultrera anemometer]# cp conf/sample.config.inc.php conf/config.inc.php\n[root@ultrera anemometer]# vim conf/config.inc.php\n\n# line 48,49 and line 284,285\n设置数据库的用户名和密码;\n\n[root@ultrera anemometer]# vim conf/config.inc.php\n# line 7,8\n设置数据库的用户名和密码;\n```\n##### 5.3 导入\n将pt-query-digest 的分析结果到anemometer；\n\n> pt-query-digest version < 2.2\n\n```\n$ pt-query-digest --user=anemometer --password=superSecurePass \\\n                  --review h=db.example.com,D=slow_query_log,t=global_query_review \\\n                  --review-history h=db.example.com,D=slow_query_log,t=global_query_review_history \\\n                  --no-report --limit=0% \\\n                  --filter=\" \\$event->{Bytes} = length(\\$event->{arg}) and \\$event->{hostname}=\\\"$HOSTNAME\\\"\" \\\n                  /var/lib/mysql/db.example.com-slow.log\n```\n\n> pt-query-digest version >= 2.2\n\n```\npt-query-digest --user=anemometer --password=superSecurePass \\\n                  --review h=db.example.com,D=slow_query_log,t=global_query_review \\\n                  --history h=db.example.com,D=slow_query_log,t=global_query_review_history \\\n                  --no-report --limit=0% \\\n                  --filter=\" \\$event->{Bytes} = length(\\$event->{arg}) and \\$event->{hostname}=\\\"$HOSTNAME\\\"\" \\\n                  /var/lib/mysql/db.example.com-slow.log\n\n\nPipeline process 11 (aggregate fingerprint) caused an error: Argument \"57A\" isn't numeric in numeric gt (>) at (eval 40) line 6, <> line 27.\nPipeline process 11 (aggregate fingerprint) caused an error: Argument \"57B\" isn't numeric in numeric gt (>) at (eval 40) line 6, <> line 28.\nPipeline process 11 (aggregate fingerprint) caused an error: Argument \"57C\" isn't numeric in numeric gt (>) at (eval 40) line 6, <> line 29.\n```\n\n","source":"_posts/HowTo-Use-pt-query-digest.md","raw":"---\ntitle: HowTo Use pt-query-digest\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: how-to-use-pt-query-digest\nid: 94\nupdated: '2017-04-21 13:28:57'\ndate: 2016-09-22 15:20:12\n---\n\n\n\n\n\n### 1. 简介\n索引可以我们更快速的执行查询，但是肯定存在不合理的索引，如果想找到那些索引不是很合适的查询，并在它们成为问题前进行优化，则可以使用pt-query-digest的查询审查“review”功能，分析其EXPLAIN出来的执行计划。\n\npt-query-digest是用于分析mysql慢查询的一个工具，它可以分析binlog、General log、slowlog，也可以通过SHOWPROCESSLIST或者通过tcpdump抓取的MySQL协议数据来进行分析。可以把分析结果输出到文件中，分析过程是先对查询语句的条件进行参数化，然后对参数化以后的查询进行分组统计，统计出各查询的执行时间、次数、占比等，可以借助分析结果找出问题进行优化。\n\n### 2. Install Percona Toolkit & pt-query-digest\npercona-toolkit是一组高级命令行工具的集合，用来执行各种通过手工执行非常复杂和麻烦的mysql和系统任务。这些任务包括：\n\n* 检查master和slave数据的一致性\n* 有效地对记录进行归档\n* 查找重复的索引\n* 对服务器信息进行汇总\n* 分析来自日志和tcpdump的查询\n* 当系统出问题的时候收集重要的系统信息\n\n```\n[root@ultrera ~]# wget percona.com/get/percona-toolkit.tar.gz\n--2016-09-22 09:17:00--  http://percona.com/get/percona-toolkit.tar.gz\nResolving percona.com... 74.121.199.234, 74.121.199.234\nConnecting to percona.com|74.121.199.234|:80... connected.\nHTTP request sent, awaiting response... 301 Moved Permanently\nLocation: https://www.percona.com/get/percona-toolkit.tar.gz [following]\n--2016-09-22 09:17:02--  https://www.percona.com/get/percona-toolkit.tar.gz\nResolving www.percona.com... 74.121.199.234, 74.121.199.234\nConnecting to www.percona.com|74.121.199.234|:443... connected.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://www.percona.com/downloads/percona-toolkit/2.2.19/tarball/percona-toolkit-2.2.19.tar.gz [following]\n--2016-09-22 09:17:03--  https://www.percona.com/downloads/percona-toolkit/2.2.19/tarball/percona-toolkit-2.2.19.tar.gz\nReusing existing connection to www.percona.com:443.\nHTTP request sent, awaiting response... 200 OK\nLength: 1425623 (1.4M) [application/x-gzip]\nSaving to: “percona-toolkit.tar.gz”\n\n100%[=======================>] 1,425,623    766K/s   in 1.8s\n\n2016-09-22 09:17:05 (766 KB/s) - “percona-toolkit.tar.gz” saved [1425623/1425623]\n\n[root@ultrera ~]# tar xf percona-toolkit.tar.gz\n[root@ultrera ~]# ls\npercona-toolkit-2.2.19  percona-toolkit.tar.gz\n[root@ultrera ~]# cd percona-toolkit-2.2.19\n[root@ultrera percona-toolkit-2.2.19]# perl Makefile.PL\nWarning: prerequisite DBD::mysql 3 not found.\nWriting Makefile for percona-toolkit\n[root@ultrera percona-toolkit-2.2.19]# make\ncp bin/pt-mysql-summary blib/script/pt-mysql-summary\n....\nManifying blib/man1/pt-index-usage.1p\nManifying blib/man1/pt-duplicate-key-checker.1p\nManifying blib/man1/pt-config-diff.1p\nManifying blib/man1/pt-stalk.1p\n[root@ultrera percona-toolkit-2.2.19]# make install\nInstalling /usr/local/share/man/man1/pt-query-digest.1p\n...\nInstalling /usr/local/bin/pt-query-digest\n...\nAppending installation info to /usr/lib64/perl5/perllocal.pod\n```\n> 运行工具可能会遇到下面的错误: Can't locate Time/HiRes.pm in @INC\n\n```\n# 解决办法：\n[root@ultrera ~]# yum install -y perl-Time-HiRes\n[root@ultrera ~]# pt-query-digest --version\npt-query-digest 2.2.19\n```\n\n### 3. 开启 mysql慢日志\n##### a. 查看当前‘slow_query_log’ 状态：\n```\nmysql> show variables like '%query%';\n+------------------------------+---------------------------------+\n| Variable_name                | Value                           |\n+------------------------------+---------------------------------+\n| binlog_rows_query_log_events | OFF                             |\n| ft_query_expansion_limit     | 20                              |\n| have_query_cache             | YES                             |\n| long_query_time              | 10.000000                       |\n| query_alloc_block_size       | 8192                            |\n| query_cache_limit            | 1048576                         |\n| query_cache_min_res_unit     | 4096                            |\n| query_cache_size             | 1048576                         |\n| query_cache_type             | OFF                             |\n| query_cache_wlock_invalidate | OFF                             |\n| query_prealloc_size          | 8192                            |\n| slow_query_log               | OFF                             |\n| slow_query_log_file          | /var/lib/mysql/ultrera-slow.log |\n+------------------------------+---------------------------------+\n13 rows in set (0.00 sec)\n\nmysql> show variables like 'log_queries_not_using_indexes';\n+-------------------------------+-------+\n| Variable_name                 | Value |\n+-------------------------------+-------+\n| log_queries_not_using_indexes | OFF   |\n+-------------------------------+-------+\n1 row in set (0.00 sec)\n```\n##### b. 启动slow_log, 配置\n```\n# 设定记录大于2s的sql\nmysql> set global long_query_time=2;\nQuery OK, 0 rows affected (0.00 sec)\n\n# 设定log存放路径\nmysql> set global slow_query_log_file='/tmp/ultraera-slow.log';\nQuery OK, 0 rows affected (0.00 sec)\n\n# 启用慢日志\nmysql> set global slow_query_log=ON;\nQuery OK, 0 rows affected (0.00 sec)\n\n# 同时记录没有使用索引的sql\nmysql> set global log_queries_not_using_indexes=on;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n> 等待一段时间，slow.log 增大的非常快，实际生产中，注意不要被slow.log将磁盘撑满，影响到正常生产使用。\n\n### 4. 分析\npt-query-digest可以从普通MySQL日志，慢查询日志以及二进制日志中分析查询，甚至可以从SHOW PROCESSLIST和MySQL协议的tcpdump中进行分析，如果没有指定文件，它从标准输入流（STDIN）中读取数据。\n##### a. 简单使用方法：\n```\npt-query-digest slow.logs\n```\n输出信息如下：\n\n<div align=\"left\">\n![](http://images.cnitblog.com/blog/288950/201312/14135450-6f7a732598054f7aa311e95cbd4df3b1.png)\n</div>\n\n<ul>\n1. Overall这个部分是一个大致的概要信息(类似loadrunner给出的概要信息)，通过它可以对当前MySQL的查询性能做一个初步的评估，比如各个指标的最大值(max)，平均值(min)，95%分布值，中位数(median)，标准偏差(stddev)\n<li>查询的执行时间（Exec time）</li>\n<li>锁占用的时间（Lock time）</li>\n<li>MySQL执行器需要检查的行数（Rows examine）</li>\n<li>最后返回给客户端的行数（Rows sent）</li>\n<li>查询的大小。</li>\n</ul>\n<ul>\n2. Profile\n<li>Rank ： 整个分析中该“语句”的排名，一般也就是性能最慢的</li>\n<li>Query ID ：每个查询都有一个</li>\n<li>Response time ： “语句”的响应时间以及整体占比情况。</li>\n<li>Calls ：“语句”的执行次数</li>\n<li>R/Call ：每次执行的平均响应时间。 </li>\n<li>V/M</li>\n</ul>\n##### 详细信息\n<p>列出上面Profile中每个Query ID的详细信息</p>\n\n##### b. 从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：\n```\npt-query-digest --type tcpdump mysql.tcp.txt\n```\n\n\n##### c. pt-query-digest 还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析\n> 更多的帮助文档，请查看官方文档：http://www.percona.com/doc/percona-toolkit/2.2/pt-query-digest.html\n\n### 5. 使用Anemometer将pt-query-digest的MySQL慢查询可视化\n\n* 需要安装php 5.3 and over\n* 需要预先配置mysql数据库\n* 需要预先安装好pt-query-digest\n\n##### 5.1 安装\n```\n[root@ultrera ~]# git clone https://github.com/box/Anemometer.git anemometer\n\n[root@ultrera ~]# mv anemometer /var/www/html\n[root@ultrera ~]# cd /var/www/html/anemometer/\n[root@ultrera anemometer]# mysql -h localhost -u root -p < mysql56-install.sql\n[root@ultrera anemometer]# mysql -h localhost -u root -p -e \"grant all privileges on slow_query_log.* to 'anemometer'@'%' identified by 'anemometer';\"\n```\n##### 5.2 配置\n```\n[root@ultrera anemometer]# cp conf/sample.config.inc.php conf/config.inc.php\n[root@ultrera anemometer]# vim conf/config.inc.php\n\n# line 48,49 and line 284,285\n设置数据库的用户名和密码;\n\n[root@ultrera anemometer]# vim conf/config.inc.php\n# line 7,8\n设置数据库的用户名和密码;\n```\n##### 5.3 导入\n将pt-query-digest 的分析结果到anemometer；\n\n> pt-query-digest version < 2.2\n\n```\n$ pt-query-digest --user=anemometer --password=superSecurePass \\\n                  --review h=db.example.com,D=slow_query_log,t=global_query_review \\\n                  --review-history h=db.example.com,D=slow_query_log,t=global_query_review_history \\\n                  --no-report --limit=0% \\\n                  --filter=\" \\$event->{Bytes} = length(\\$event->{arg}) and \\$event->{hostname}=\\\"$HOSTNAME\\\"\" \\\n                  /var/lib/mysql/db.example.com-slow.log\n```\n\n> pt-query-digest version >= 2.2\n\n```\npt-query-digest --user=anemometer --password=superSecurePass \\\n                  --review h=db.example.com,D=slow_query_log,t=global_query_review \\\n                  --history h=db.example.com,D=slow_query_log,t=global_query_review_history \\\n                  --no-report --limit=0% \\\n                  --filter=\" \\$event->{Bytes} = length(\\$event->{arg}) and \\$event->{hostname}=\\\"$HOSTNAME\\\"\" \\\n                  /var/lib/mysql/db.example.com-slow.log\n\n\nPipeline process 11 (aggregate fingerprint) caused an error: Argument \"57A\" isn't numeric in numeric gt (>) at (eval 40) line 6, <> line 27.\nPipeline process 11 (aggregate fingerprint) caused an error: Argument \"57B\" isn't numeric in numeric gt (>) at (eval 40) line 6, <> line 28.\nPipeline process 11 (aggregate fingerprint) caused an error: Argument \"57C\" isn't numeric in numeric gt (>) at (eval 40) line 6, <> line 29.\n```\n\n","slug":"how-to-use-pt-query-digest","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqab004041tpt7i02c17","content":"<h3 id=\"1-简介\"><a href=\"#1-简介\" class=\"headerlink\" title=\"1. 简介\"></a>1. 简介</h3><p>索引可以我们更快速的执行查询，但是肯定存在不合理的索引，如果想找到那些索引不是很合适的查询，并在它们成为问题前进行优化，则可以使用pt-query-digest的查询审查“review”功能，分析其EXPLAIN出来的执行计划。</p>\n<p>pt-query-digest是用于分析mysql慢查询的一个工具，它可以分析binlog、General log、slowlog，也可以通过SHOWPROCESSLIST或者通过tcpdump抓取的MySQL协议数据来进行分析。可以把分析结果输出到文件中，分析过程是先对查询语句的条件进行参数化，然后对参数化以后的查询进行分组统计，统计出各查询的执行时间、次数、占比等，可以借助分析结果找出问题进行优化。</p>\n<h3 id=\"2-Install-Percona-Toolkit-amp-pt-query-digest\"><a href=\"#2-Install-Percona-Toolkit-amp-pt-query-digest\" class=\"headerlink\" title=\"2. Install Percona Toolkit &amp; pt-query-digest\"></a>2. Install Percona Toolkit &amp; pt-query-digest</h3><p>percona-toolkit是一组高级命令行工具的集合，用来执行各种通过手工执行非常复杂和麻烦的mysql和系统任务。这些任务包括：</p>\n<ul>\n<li>检查master和slave数据的一致性</li>\n<li>有效地对记录进行归档</li>\n<li>查找重复的索引</li>\n<li>对服务器信息进行汇总</li>\n<li>分析来自日志和tcpdump的查询</li>\n<li>当系统出问题的时候收集重要的系统信息</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultrera ~]# wget percona.com/get/percona-toolkit.tar.gz</div><div class=\"line\">--2016-09-22 09:17:00--  http://percona.com/get/percona-toolkit.tar.gz</div><div class=\"line\">Resolving percona.com... 74.121.199.234, 74.121.199.234</div><div class=\"line\">Connecting to percona.com|74.121.199.234|:80... connected.</div><div class=\"line\">HTTP request sent, awaiting response... 301 Moved Permanently</div><div class=\"line\">Location: https://www.percona.com/get/percona-toolkit.tar.gz [following]</div><div class=\"line\">--2016-09-22 09:17:02--  https://www.percona.com/get/percona-toolkit.tar.gz</div><div class=\"line\">Resolving www.percona.com... 74.121.199.234, 74.121.199.234</div><div class=\"line\">Connecting to www.percona.com|74.121.199.234|:443... connected.</div><div class=\"line\">HTTP request sent, awaiting response... 302 Found</div><div class=\"line\">Location: https://www.percona.com/downloads/percona-toolkit/2.2.19/tarball/percona-toolkit-2.2.19.tar.gz [following]</div><div class=\"line\">--2016-09-22 09:17:03--  https://www.percona.com/downloads/percona-toolkit/2.2.19/tarball/percona-toolkit-2.2.19.tar.gz</div><div class=\"line\">Reusing existing connection to www.percona.com:443.</div><div class=\"line\">HTTP request sent, awaiting response... 200 OK</div><div class=\"line\">Length: 1425623 (1.4M) [application/x-gzip]</div><div class=\"line\">Saving to: “percona-toolkit.tar.gz”</div><div class=\"line\"></div><div class=\"line\">100%[=======================&gt;] 1,425,623    766K/s   in 1.8s</div><div class=\"line\"></div><div class=\"line\">2016-09-22 09:17:05 (766 KB/s) - “percona-toolkit.tar.gz” saved [1425623/1425623]</div><div class=\"line\"></div><div class=\"line\">[root@ultrera ~]# tar xf percona-toolkit.tar.gz</div><div class=\"line\">[root@ultrera ~]# ls</div><div class=\"line\">percona-toolkit-2.2.19  percona-toolkit.tar.gz</div><div class=\"line\">[root@ultrera ~]# cd percona-toolkit-2.2.19</div><div class=\"line\">[root@ultrera percona-toolkit-2.2.19]# perl Makefile.PL</div><div class=\"line\">Warning: prerequisite DBD::mysql 3 not found.</div><div class=\"line\">Writing Makefile for percona-toolkit</div><div class=\"line\">[root@ultrera percona-toolkit-2.2.19]# make</div><div class=\"line\">cp bin/pt-mysql-summary blib/script/pt-mysql-summary</div><div class=\"line\">....</div><div class=\"line\">Manifying blib/man1/pt-index-usage.1p</div><div class=\"line\">Manifying blib/man1/pt-duplicate-key-checker.1p</div><div class=\"line\">Manifying blib/man1/pt-config-diff.1p</div><div class=\"line\">Manifying blib/man1/pt-stalk.1p</div><div class=\"line\">[root@ultrera percona-toolkit-2.2.19]# make install</div><div class=\"line\">Installing /usr/local/share/man/man1/pt-query-digest.1p</div><div class=\"line\">...</div><div class=\"line\">Installing /usr/local/bin/pt-query-digest</div><div class=\"line\">...</div><div class=\"line\">Appending installation info to /usr/lib64/perl5/perllocal.pod</div></pre></td></tr></table></figure>\n<blockquote>\n<p>运行工具可能会遇到下面的错误: Can’t locate Time/HiRes.pm in @INC</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 解决办法：</div><div class=\"line\">[root@ultrera ~]# yum install -y perl-Time-HiRes</div><div class=\"line\">[root@ultrera ~]# pt-query-digest --version</div><div class=\"line\">pt-query-digest 2.2.19</div></pre></td></tr></table></figure>\n<h3 id=\"3-开启-mysql慢日志\"><a href=\"#3-开启-mysql慢日志\" class=\"headerlink\" title=\"3. 开启 mysql慢日志\"></a>3. 开启 mysql慢日志</h3><h5 id=\"a-查看当前‘slow-query-log’-状态：\"><a href=\"#a-查看当前‘slow-query-log’-状态：\" class=\"headerlink\" title=\"a. 查看当前‘slow_query_log’ 状态：\"></a>a. 查看当前‘slow_query_log’ 状态：</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like &apos;%query%&apos;;</div><div class=\"line\">+------------------------------+---------------------------------+</div><div class=\"line\">| Variable_name                | Value                           |</div><div class=\"line\">+------------------------------+---------------------------------+</div><div class=\"line\">| binlog_rows_query_log_events | OFF                             |</div><div class=\"line\">| ft_query_expansion_limit     | 20                              |</div><div class=\"line\">| have_query_cache             | YES                             |</div><div class=\"line\">| long_query_time              | 10.000000                       |</div><div class=\"line\">| query_alloc_block_size       | 8192                            |</div><div class=\"line\">| query_cache_limit            | 1048576                         |</div><div class=\"line\">| query_cache_min_res_unit     | 4096                            |</div><div class=\"line\">| query_cache_size             | 1048576                         |</div><div class=\"line\">| query_cache_type             | OFF                             |</div><div class=\"line\">| query_cache_wlock_invalidate | OFF                             |</div><div class=\"line\">| query_prealloc_size          | 8192                            |</div><div class=\"line\">| slow_query_log               | OFF                             |</div><div class=\"line\">| slow_query_log_file          | /var/lib/mysql/ultrera-slow.log |</div><div class=\"line\">+------------------------------+---------------------------------+</div><div class=\"line\">13 rows in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt; show variables like &apos;log_queries_not_using_indexes&apos;;</div><div class=\"line\">+-------------------------------+-------+</div><div class=\"line\">| Variable_name                 | Value |</div><div class=\"line\">+-------------------------------+-------+</div><div class=\"line\">| log_queries_not_using_indexes | OFF   |</div><div class=\"line\">+-------------------------------+-------+</div><div class=\"line\">1 row in set (0.00 sec)</div></pre></td></tr></table></figure>\n<h5 id=\"b-启动slow-log-配置\"><a href=\"#b-启动slow-log-配置\" class=\"headerlink\" title=\"b. 启动slow_log, 配置\"></a>b. 启动slow_log, 配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 设定记录大于2s的sql</div><div class=\"line\">mysql&gt; set global long_query_time=2;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div><div class=\"line\"></div><div class=\"line\"># 设定log存放路径</div><div class=\"line\">mysql&gt; set global slow_query_log_file=&apos;/tmp/ultraera-slow.log&apos;;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div><div class=\"line\"></div><div class=\"line\"># 启用慢日志</div><div class=\"line\">mysql&gt; set global slow_query_log=ON;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div><div class=\"line\"></div><div class=\"line\"># 同时记录没有使用索引的sql</div><div class=\"line\">mysql&gt; set global log_queries_not_using_indexes=on;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure>\n<blockquote>\n<p>等待一段时间，slow.log 增大的非常快，实际生产中，注意不要被slow.log将磁盘撑满，影响到正常生产使用。</p>\n</blockquote>\n<h3 id=\"4-分析\"><a href=\"#4-分析\" class=\"headerlink\" title=\"4. 分析\"></a>4. 分析</h3><p>pt-query-digest可以从普通MySQL日志，慢查询日志以及二进制日志中分析查询，甚至可以从SHOW PROCESSLIST和MySQL协议的tcpdump中进行分析，如果没有指定文件，它从标准输入流（STDIN）中读取数据。</p>\n<h5 id=\"a-简单使用方法：\"><a href=\"#a-简单使用方法：\" class=\"headerlink\" title=\"a. 简单使用方法：\"></a>a. 简单使用方法：</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pt-query-digest slow.logs</div></pre></td></tr></table></figure>\n<p>输出信息如下：</p>\n<div align=\"left\"><br><img src=\"http://images.cnitblog.com/blog/288950/201312/14135450-6f7a732598054f7aa311e95cbd4df3b1.png\" alt=\"\"><br></div>\n\n<p><ul></ul></p>\n<ol>\n<li>Overall这个部分是一个大致的概要信息(类似loadrunner给出的概要信息)，通过它可以对当前MySQL的查询性能做一个初步的评估，比如各个指标的最大值(max)，平均值(min)，95%分布值，中位数(median)，标准偏差(stddev)<br></li><li>查询的执行时间（Exec time）</li><br><li>锁占用的时间（Lock time）</li><br><li>MySQL执行器需要检查的行数（Rows examine）</li><br><li>最后返回给客户端的行数（Rows sent）</li><br><li>查询的大小。</li><br><ul>\n<li>Profile<br></li><li>Rank ： 整个分析中该“语句”的排名，一般也就是性能最慢的</li><br><li>Query ID ：每个查询都有一个</li><br><li>Response time ： “语句”的响应时间以及整体占比情况。</li><br><li>Calls ：“语句”的执行次数</li><br><li>R/Call ：每次执行的平均响应时间。 </li><br><li>V/M</li><br></ul><h5 id=\"详细信息\"><a href=\"#详细信息\" class=\"headerlink\" title=\"详细信息\"></a>详细信息</h5><p>列出上面Profile中每个Query ID的详细信息</p>\n\n\n</ol>\n<h5 id=\"b-从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：\"><a href=\"#b-从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：\" class=\"headerlink\" title=\"b. 从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：\"></a>b. 从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pt-query-digest --type tcpdump mysql.tcp.txt</div></pre></td></tr></table></figure>\n<h5 id=\"c-pt-query-digest-还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析\"><a href=\"#c-pt-query-digest-还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析\" class=\"headerlink\" title=\"c. pt-query-digest 还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析\"></a>c. pt-query-digest 还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析</h5><blockquote>\n<p>更多的帮助文档，请查看官方文档：<a href=\"http://www.percona.com/doc/percona-toolkit/2.2/pt-query-digest.html\" target=\"_blank\" rel=\"external\">http://www.percona.com/doc/percona-toolkit/2.2/pt-query-digest.html</a></p>\n</blockquote>\n<h3 id=\"5-使用Anemometer将pt-query-digest的MySQL慢查询可视化\"><a href=\"#5-使用Anemometer将pt-query-digest的MySQL慢查询可视化\" class=\"headerlink\" title=\"5. 使用Anemometer将pt-query-digest的MySQL慢查询可视化\"></a>5. 使用Anemometer将pt-query-digest的MySQL慢查询可视化</h3><ul>\n<li>需要安装php 5.3 and over</li>\n<li>需要预先配置mysql数据库</li>\n<li>需要预先安装好pt-query-digest</li>\n</ul>\n<h5 id=\"5-1-安装\"><a href=\"#5-1-安装\" class=\"headerlink\" title=\"5.1 安装\"></a>5.1 安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultrera ~]# git clone https://github.com/box/Anemometer.git anemometer</div><div class=\"line\"></div><div class=\"line\">[root@ultrera ~]# mv anemometer /var/www/html</div><div class=\"line\">[root@ultrera ~]# cd /var/www/html/anemometer/</div><div class=\"line\">[root@ultrera anemometer]# mysql -h localhost -u root -p &lt; mysql56-install.sql</div><div class=\"line\">[root@ultrera anemometer]# mysql -h localhost -u root -p -e &quot;grant all privileges on slow_query_log.* to &apos;anemometer&apos;@&apos;%&apos; identified by &apos;anemometer&apos;;&quot;</div></pre></td></tr></table></figure>\n<h5 id=\"5-2-配置\"><a href=\"#5-2-配置\" class=\"headerlink\" title=\"5.2 配置\"></a>5.2 配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultrera anemometer]# cp conf/sample.config.inc.php conf/config.inc.php</div><div class=\"line\">[root@ultrera anemometer]# vim conf/config.inc.php</div><div class=\"line\"></div><div class=\"line\"># line 48,49 and line 284,285</div><div class=\"line\">设置数据库的用户名和密码;</div><div class=\"line\"></div><div class=\"line\">[root@ultrera anemometer]# vim conf/config.inc.php</div><div class=\"line\"># line 7,8</div><div class=\"line\">设置数据库的用户名和密码;</div></pre></td></tr></table></figure>\n<h5 id=\"5-3-导入\"><a href=\"#5-3-导入\" class=\"headerlink\" title=\"5.3 导入\"></a>5.3 导入</h5><p>将pt-query-digest 的分析结果到anemometer；</p>\n<blockquote>\n<p>pt-query-digest version &lt; 2.2</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ pt-query-digest --user=anemometer --password=superSecurePass \\</div><div class=\"line\">                  --review h=db.example.com,D=slow_query_log,t=global_query_review \\</div><div class=\"line\">                  --review-history h=db.example.com,D=slow_query_log,t=global_query_review_history \\</div><div class=\"line\">                  --no-report --limit=0% \\</div><div class=\"line\">                  --filter=&quot; \\$event-&gt;&#123;Bytes&#125; = length(\\$event-&gt;&#123;arg&#125;) and \\$event-&gt;&#123;hostname&#125;=\\&quot;$HOSTNAME\\&quot;&quot; \\</div><div class=\"line\">                  /var/lib/mysql/db.example.com-slow.log</div></pre></td></tr></table></figure>\n<blockquote>\n<p>pt-query-digest version &gt;= 2.2</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">pt-query-digest --user=anemometer --password=superSecurePass \\</div><div class=\"line\">                  --review h=db.example.com,D=slow_query_log,t=global_query_review \\</div><div class=\"line\">                  --history h=db.example.com,D=slow_query_log,t=global_query_review_history \\</div><div class=\"line\">                  --no-report --limit=0% \\</div><div class=\"line\">                  --filter=&quot; \\$event-&gt;&#123;Bytes&#125; = length(\\$event-&gt;&#123;arg&#125;) and \\$event-&gt;&#123;hostname&#125;=\\&quot;$HOSTNAME\\&quot;&quot; \\</div><div class=\"line\">                  /var/lib/mysql/db.example.com-slow.log</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Pipeline process 11 (aggregate fingerprint) caused an error: Argument &quot;57A&quot; isn&apos;t numeric in numeric gt (&gt;) at (eval 40) line 6, &lt;&gt; line 27.</div><div class=\"line\">Pipeline process 11 (aggregate fingerprint) caused an error: Argument &quot;57B&quot; isn&apos;t numeric in numeric gt (&gt;) at (eval 40) line 6, &lt;&gt; line 28.</div><div class=\"line\">Pipeline process 11 (aggregate fingerprint) caused an error: Argument &quot;57C&quot; isn&apos;t numeric in numeric gt (&gt;) at (eval 40) line 6, &lt;&gt; line 29.</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"1-简介\"><a href=\"#1-简介\" class=\"headerlink\" title=\"1. 简介\"></a>1. 简介</h3><p>索引可以我们更快速的执行查询，但是肯定存在不合理的索引，如果想找到那些索引不是很合适的查询，并在它们成为问题前进行优化，则可以使用pt-query-digest的查询审查“review”功能，分析其EXPLAIN出来的执行计划。</p>\n<p>pt-query-digest是用于分析mysql慢查询的一个工具，它可以分析binlog、General log、slowlog，也可以通过SHOWPROCESSLIST或者通过tcpdump抓取的MySQL协议数据来进行分析。可以把分析结果输出到文件中，分析过程是先对查询语句的条件进行参数化，然后对参数化以后的查询进行分组统计，统计出各查询的执行时间、次数、占比等，可以借助分析结果找出问题进行优化。</p>\n<h3 id=\"2-Install-Percona-Toolkit-amp-pt-query-digest\"><a href=\"#2-Install-Percona-Toolkit-amp-pt-query-digest\" class=\"headerlink\" title=\"2. Install Percona Toolkit &amp; pt-query-digest\"></a>2. Install Percona Toolkit &amp; pt-query-digest</h3><p>percona-toolkit是一组高级命令行工具的集合，用来执行各种通过手工执行非常复杂和麻烦的mysql和系统任务。这些任务包括：</p>\n<ul>\n<li>检查master和slave数据的一致性</li>\n<li>有效地对记录进行归档</li>\n<li>查找重复的索引</li>\n<li>对服务器信息进行汇总</li>\n<li>分析来自日志和tcpdump的查询</li>\n<li>当系统出问题的时候收集重要的系统信息</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultrera ~]# wget percona.com/get/percona-toolkit.tar.gz</div><div class=\"line\">--2016-09-22 09:17:00--  http://percona.com/get/percona-toolkit.tar.gz</div><div class=\"line\">Resolving percona.com... 74.121.199.234, 74.121.199.234</div><div class=\"line\">Connecting to percona.com|74.121.199.234|:80... connected.</div><div class=\"line\">HTTP request sent, awaiting response... 301 Moved Permanently</div><div class=\"line\">Location: https://www.percona.com/get/percona-toolkit.tar.gz [following]</div><div class=\"line\">--2016-09-22 09:17:02--  https://www.percona.com/get/percona-toolkit.tar.gz</div><div class=\"line\">Resolving www.percona.com... 74.121.199.234, 74.121.199.234</div><div class=\"line\">Connecting to www.percona.com|74.121.199.234|:443... connected.</div><div class=\"line\">HTTP request sent, awaiting response... 302 Found</div><div class=\"line\">Location: https://www.percona.com/downloads/percona-toolkit/2.2.19/tarball/percona-toolkit-2.2.19.tar.gz [following]</div><div class=\"line\">--2016-09-22 09:17:03--  https://www.percona.com/downloads/percona-toolkit/2.2.19/tarball/percona-toolkit-2.2.19.tar.gz</div><div class=\"line\">Reusing existing connection to www.percona.com:443.</div><div class=\"line\">HTTP request sent, awaiting response... 200 OK</div><div class=\"line\">Length: 1425623 (1.4M) [application/x-gzip]</div><div class=\"line\">Saving to: “percona-toolkit.tar.gz”</div><div class=\"line\"></div><div class=\"line\">100%[=======================&gt;] 1,425,623    766K/s   in 1.8s</div><div class=\"line\"></div><div class=\"line\">2016-09-22 09:17:05 (766 KB/s) - “percona-toolkit.tar.gz” saved [1425623/1425623]</div><div class=\"line\"></div><div class=\"line\">[root@ultrera ~]# tar xf percona-toolkit.tar.gz</div><div class=\"line\">[root@ultrera ~]# ls</div><div class=\"line\">percona-toolkit-2.2.19  percona-toolkit.tar.gz</div><div class=\"line\">[root@ultrera ~]# cd percona-toolkit-2.2.19</div><div class=\"line\">[root@ultrera percona-toolkit-2.2.19]# perl Makefile.PL</div><div class=\"line\">Warning: prerequisite DBD::mysql 3 not found.</div><div class=\"line\">Writing Makefile for percona-toolkit</div><div class=\"line\">[root@ultrera percona-toolkit-2.2.19]# make</div><div class=\"line\">cp bin/pt-mysql-summary blib/script/pt-mysql-summary</div><div class=\"line\">....</div><div class=\"line\">Manifying blib/man1/pt-index-usage.1p</div><div class=\"line\">Manifying blib/man1/pt-duplicate-key-checker.1p</div><div class=\"line\">Manifying blib/man1/pt-config-diff.1p</div><div class=\"line\">Manifying blib/man1/pt-stalk.1p</div><div class=\"line\">[root@ultrera percona-toolkit-2.2.19]# make install</div><div class=\"line\">Installing /usr/local/share/man/man1/pt-query-digest.1p</div><div class=\"line\">...</div><div class=\"line\">Installing /usr/local/bin/pt-query-digest</div><div class=\"line\">...</div><div class=\"line\">Appending installation info to /usr/lib64/perl5/perllocal.pod</div></pre></td></tr></table></figure>\n<blockquote>\n<p>运行工具可能会遇到下面的错误: Can’t locate Time/HiRes.pm in @INC</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 解决办法：</div><div class=\"line\">[root@ultrera ~]# yum install -y perl-Time-HiRes</div><div class=\"line\">[root@ultrera ~]# pt-query-digest --version</div><div class=\"line\">pt-query-digest 2.2.19</div></pre></td></tr></table></figure>\n<h3 id=\"3-开启-mysql慢日志\"><a href=\"#3-开启-mysql慢日志\" class=\"headerlink\" title=\"3. 开启 mysql慢日志\"></a>3. 开启 mysql慢日志</h3><h5 id=\"a-查看当前‘slow-query-log’-状态：\"><a href=\"#a-查看当前‘slow-query-log’-状态：\" class=\"headerlink\" title=\"a. 查看当前‘slow_query_log’ 状态：\"></a>a. 查看当前‘slow_query_log’ 状态：</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like &apos;%query%&apos;;</div><div class=\"line\">+------------------------------+---------------------------------+</div><div class=\"line\">| Variable_name                | Value                           |</div><div class=\"line\">+------------------------------+---------------------------------+</div><div class=\"line\">| binlog_rows_query_log_events | OFF                             |</div><div class=\"line\">| ft_query_expansion_limit     | 20                              |</div><div class=\"line\">| have_query_cache             | YES                             |</div><div class=\"line\">| long_query_time              | 10.000000                       |</div><div class=\"line\">| query_alloc_block_size       | 8192                            |</div><div class=\"line\">| query_cache_limit            | 1048576                         |</div><div class=\"line\">| query_cache_min_res_unit     | 4096                            |</div><div class=\"line\">| query_cache_size             | 1048576                         |</div><div class=\"line\">| query_cache_type             | OFF                             |</div><div class=\"line\">| query_cache_wlock_invalidate | OFF                             |</div><div class=\"line\">| query_prealloc_size          | 8192                            |</div><div class=\"line\">| slow_query_log               | OFF                             |</div><div class=\"line\">| slow_query_log_file          | /var/lib/mysql/ultrera-slow.log |</div><div class=\"line\">+------------------------------+---------------------------------+</div><div class=\"line\">13 rows in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt; show variables like &apos;log_queries_not_using_indexes&apos;;</div><div class=\"line\">+-------------------------------+-------+</div><div class=\"line\">| Variable_name                 | Value |</div><div class=\"line\">+-------------------------------+-------+</div><div class=\"line\">| log_queries_not_using_indexes | OFF   |</div><div class=\"line\">+-------------------------------+-------+</div><div class=\"line\">1 row in set (0.00 sec)</div></pre></td></tr></table></figure>\n<h5 id=\"b-启动slow-log-配置\"><a href=\"#b-启动slow-log-配置\" class=\"headerlink\" title=\"b. 启动slow_log, 配置\"></a>b. 启动slow_log, 配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 设定记录大于2s的sql</div><div class=\"line\">mysql&gt; set global long_query_time=2;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div><div class=\"line\"></div><div class=\"line\"># 设定log存放路径</div><div class=\"line\">mysql&gt; set global slow_query_log_file=&apos;/tmp/ultraera-slow.log&apos;;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div><div class=\"line\"></div><div class=\"line\"># 启用慢日志</div><div class=\"line\">mysql&gt; set global slow_query_log=ON;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div><div class=\"line\"></div><div class=\"line\"># 同时记录没有使用索引的sql</div><div class=\"line\">mysql&gt; set global log_queries_not_using_indexes=on;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure>\n<blockquote>\n<p>等待一段时间，slow.log 增大的非常快，实际生产中，注意不要被slow.log将磁盘撑满，影响到正常生产使用。</p>\n</blockquote>\n<h3 id=\"4-分析\"><a href=\"#4-分析\" class=\"headerlink\" title=\"4. 分析\"></a>4. 分析</h3><p>pt-query-digest可以从普通MySQL日志，慢查询日志以及二进制日志中分析查询，甚至可以从SHOW PROCESSLIST和MySQL协议的tcpdump中进行分析，如果没有指定文件，它从标准输入流（STDIN）中读取数据。</p>\n<h5 id=\"a-简单使用方法：\"><a href=\"#a-简单使用方法：\" class=\"headerlink\" title=\"a. 简单使用方法：\"></a>a. 简单使用方法：</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pt-query-digest slow.logs</div></pre></td></tr></table></figure>\n<p>输出信息如下：</p>\n<div align=\"left\"><br><img src=\"http://images.cnitblog.com/blog/288950/201312/14135450-6f7a732598054f7aa311e95cbd4df3b1.png\" alt=\"\"><br></div>\n\n<p><ul></p>\n<ol>\n<li>Overall这个部分是一个大致的概要信息(类似loadrunner给出的概要信息)，通过它可以对当前MySQL的查询性能做一个初步的评估，比如各个指标的最大值(max)，平均值(min)，95%分布值，中位数(median)，标准偏差(stddev)<br><li>查询的执行时间（Exec time）</li><br><li>锁占用的时间（Lock time）</li><br><li>MySQL执行器需要检查的行数（Rows examine）</li><br><li>最后返回给客户端的行数（Rows sent）</li><br><li>查询的大小。</li><br></ul><ul></li>\n<li>Profile<br><li>Rank ： 整个分析中该“语句”的排名，一般也就是性能最慢的</li><br><li>Query ID ：每个查询都有一个</li><br><li>Response time ： “语句”的响应时间以及整体占比情况。</li><br><li>Calls ：“语句”的执行次数</li><br><li>R/Call ：每次执行的平均响应时间。 </li><br><li>V/M</li><br></ul><h5 id=\"详细信息\"><a href=\"#详细信息\" class=\"headerlink\" title=\"详细信息\"></a>详细信息</h5><p>列出上面Profile中每个Query ID的详细信息</p>\n\n</li>\n</ol>\n<h5 id=\"b-从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：\"><a href=\"#b-从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：\" class=\"headerlink\" title=\"b. 从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：\"></a>b. 从tcpdump包中分析：通过tcpdump命令抓取一定时间网络数据包，然后进行分析：</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pt-query-digest --type tcpdump mysql.tcp.txt</div></pre></td></tr></table></figure>\n<h5 id=\"c-pt-query-digest-还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析\"><a href=\"#c-pt-query-digest-还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析\" class=\"headerlink\" title=\"c. pt-query-digest 还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析\"></a>c. pt-query-digest 还支持很对其他的数据包分析形势，但是我们主要使用的还是针对慢日志进行分析</h5><blockquote>\n<p>更多的帮助文档，请查看官方文档：<a href=\"http://www.percona.com/doc/percona-toolkit/2.2/pt-query-digest.html\">http://www.percona.com/doc/percona-toolkit/2.2/pt-query-digest.html</a></p>\n</blockquote>\n<h3 id=\"5-使用Anemometer将pt-query-digest的MySQL慢查询可视化\"><a href=\"#5-使用Anemometer将pt-query-digest的MySQL慢查询可视化\" class=\"headerlink\" title=\"5. 使用Anemometer将pt-query-digest的MySQL慢查询可视化\"></a>5. 使用Anemometer将pt-query-digest的MySQL慢查询可视化</h3><ul>\n<li>需要安装php 5.3 and over</li>\n<li>需要预先配置mysql数据库</li>\n<li>需要预先安装好pt-query-digest</li>\n</ul>\n<h5 id=\"5-1-安装\"><a href=\"#5-1-安装\" class=\"headerlink\" title=\"5.1 安装\"></a>5.1 安装</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultrera ~]# git clone https://github.com/box/Anemometer.git anemometer</div><div class=\"line\"></div><div class=\"line\">[root@ultrera ~]# mv anemometer /var/www/html</div><div class=\"line\">[root@ultrera ~]# cd /var/www/html/anemometer/</div><div class=\"line\">[root@ultrera anemometer]# mysql -h localhost -u root -p &lt; mysql56-install.sql</div><div class=\"line\">[root@ultrera anemometer]# mysql -h localhost -u root -p -e &quot;grant all privileges on slow_query_log.* to &apos;anemometer&apos;@&apos;%&apos; identified by &apos;anemometer&apos;;&quot;</div></pre></td></tr></table></figure>\n<h5 id=\"5-2-配置\"><a href=\"#5-2-配置\" class=\"headerlink\" title=\"5.2 配置\"></a>5.2 配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultrera anemometer]# cp conf/sample.config.inc.php conf/config.inc.php</div><div class=\"line\">[root@ultrera anemometer]# vim conf/config.inc.php</div><div class=\"line\"></div><div class=\"line\"># line 48,49 and line 284,285</div><div class=\"line\">设置数据库的用户名和密码;</div><div class=\"line\"></div><div class=\"line\">[root@ultrera anemometer]# vim conf/config.inc.php</div><div class=\"line\"># line 7,8</div><div class=\"line\">设置数据库的用户名和密码;</div></pre></td></tr></table></figure>\n<h5 id=\"5-3-导入\"><a href=\"#5-3-导入\" class=\"headerlink\" title=\"5.3 导入\"></a>5.3 导入</h5><p>将pt-query-digest 的分析结果到anemometer；</p>\n<blockquote>\n<p>pt-query-digest version &lt; 2.2</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ pt-query-digest --user=anemometer --password=superSecurePass \\</div><div class=\"line\">                  --review h=db.example.com,D=slow_query_log,t=global_query_review \\</div><div class=\"line\">                  --review-history h=db.example.com,D=slow_query_log,t=global_query_review_history \\</div><div class=\"line\">                  --no-report --limit=0% \\</div><div class=\"line\">                  --filter=&quot; \\$event-&gt;&#123;Bytes&#125; = length(\\$event-&gt;&#123;arg&#125;) and \\$event-&gt;&#123;hostname&#125;=\\&quot;$HOSTNAME\\&quot;&quot; \\</div><div class=\"line\">                  /var/lib/mysql/db.example.com-slow.log</div></pre></td></tr></table></figure>\n<blockquote>\n<p>pt-query-digest version &gt;= 2.2</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">pt-query-digest --user=anemometer --password=superSecurePass \\</div><div class=\"line\">                  --review h=db.example.com,D=slow_query_log,t=global_query_review \\</div><div class=\"line\">                  --history h=db.example.com,D=slow_query_log,t=global_query_review_history \\</div><div class=\"line\">                  --no-report --limit=0% \\</div><div class=\"line\">                  --filter=&quot; \\$event-&gt;&#123;Bytes&#125; = length(\\$event-&gt;&#123;arg&#125;) and \\$event-&gt;&#123;hostname&#125;=\\&quot;$HOSTNAME\\&quot;&quot; \\</div><div class=\"line\">                  /var/lib/mysql/db.example.com-slow.log</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Pipeline process 11 (aggregate fingerprint) caused an error: Argument &quot;57A&quot; isn&apos;t numeric in numeric gt (&gt;) at (eval 40) line 6, &lt;&gt; line 27.</div><div class=\"line\">Pipeline process 11 (aggregate fingerprint) caused an error: Argument &quot;57B&quot; isn&apos;t numeric in numeric gt (&gt;) at (eval 40) line 6, &lt;&gt; line 28.</div><div class=\"line\">Pipeline process 11 (aggregate fingerprint) caused an error: Argument &quot;57C&quot; isn&apos;t numeric in numeric gt (&gt;) at (eval 40) line 6, &lt;&gt; line 29.</div></pre></td></tr></table></figure>\n"},{"title":"HowTo install Zoomdata","id":"144","updated":"2017-04-21T05:13:41.000Z","date":"2017-03-06T01:44:47.000Z","_content":"\nZoomdata是一个大数据可视化展示的工具，由ZoomData企业创建，是为数不多的同时支持移动端的数据分析公司，Zoomdata的可视化可将大数据流转化为触屏友好的，艺术感十足的三维形态，Zoomdata的定位是非ETL(传统的提取、转换和加载的数据处理过程)工具，Zoomdata支持多种数据源，包括社交媒体等，其中应用最主流是大数据平台的展示工具，并且Zoomdata对Cloudera Impala做了很好的支持，所以我们做了Zoomdata+Cloudera技术实施。[^1]\n\n#### **系统要求**\nZoomdata最新版是v2.4，支持常见主流的操作系统，并且有非常友好的安装帮助，但是Zoomdata不支持安装在32位的操作系统之上\n<br>\n|biaoti|biaoti|baiiti|\n|------|------|------|\n|list|file|china|\n|letian|zhong|hongkong|\n\n<br>\n[^1]: 这是一个示意的文档\n","source":"_posts/HowTo-install-Zoomdata.md","raw":"---\ntitle: HowTo install Zoomdata\ntags: 'Zoomdata'\ncategories: 'CentOS'\npermalink: howto-install-zoomdata\nid: 144\nupdated: '2017-04-21 13:13:41'\ndate: 2017-03-06 09:44:47\n---\n\nZoomdata是一个大数据可视化展示的工具，由ZoomData企业创建，是为数不多的同时支持移动端的数据分析公司，Zoomdata的可视化可将大数据流转化为触屏友好的，艺术感十足的三维形态，Zoomdata的定位是非ETL(传统的提取、转换和加载的数据处理过程)工具，Zoomdata支持多种数据源，包括社交媒体等，其中应用最主流是大数据平台的展示工具，并且Zoomdata对Cloudera Impala做了很好的支持，所以我们做了Zoomdata+Cloudera技术实施。[^1]\n\n#### **系统要求**\nZoomdata最新版是v2.4，支持常见主流的操作系统，并且有非常友好的安装帮助，但是Zoomdata不支持安装在32位的操作系统之上\n<br>\n|biaoti|biaoti|baiiti|\n|------|------|------|\n|list|file|china|\n|letian|zhong|hongkong|\n\n<br>\n[^1]: 这是一个示意的文档\n","slug":"howto-install-zoomdata","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqae004441tpd20sjy9i","content":"<p>Zoomdata是一个大数据可视化展示的工具，由ZoomData企业创建，是为数不多的同时支持移动端的数据分析公司，Zoomdata的可视化可将大数据流转化为触屏友好的，艺术感十足的三维形态，Zoomdata的定位是非ETL(传统的提取、转换和加载的数据处理过程)工具，Zoomdata支持多种数据源，包括社交媒体等，其中应用最主流是大数据平台的展示工具，并且Zoomdata对Cloudera Impala做了很好的支持，所以我们做了Zoomdata+Cloudera技术实施。<a href=\"这是一个示意的文档\">^1</a></p>\n<h4 id=\"系统要求\"><a href=\"#系统要求\" class=\"headerlink\" title=\"系统要求\"></a><strong>系统要求</strong></h4><p>Zoomdata最新版是v2.4，支持常见主流的操作系统，并且有非常友好的安装帮助，但是Zoomdata不支持安装在32位的操作系统之上<br><br><br>|biaoti|biaoti|baiiti|<br>|——|——|——|<br>|list|file|china|<br>|letian|zhong|hongkong|</p>\n<p><br></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Zoomdata是一个大数据可视化展示的工具，由ZoomData企业创建，是为数不多的同时支持移动端的数据分析公司，Zoomdata的可视化可将大数据流转化为触屏友好的，艺术感十足的三维形态，Zoomdata的定位是非ETL(传统的提取、转换和加载的数据处理过程)工具，Zoomdata支持多种数据源，包括社交媒体等，其中应用最主流是大数据平台的展示工具，并且Zoomdata对Cloudera Impala做了很好的支持，所以我们做了Zoomdata+Cloudera技术实施。<a href=\"这是一个示意的文档\">^1</a></p>\n<h4 id=\"系统要求\"><a href=\"#系统要求\" class=\"headerlink\" title=\"系统要求\"></a><strong>系统要求</strong></h4><p>Zoomdata最新版是v2.4，支持常见主流的操作系统，并且有非常友好的安装帮助，但是Zoomdata不支持安装在32位的操作系统之上<br><br><br>|biaoti|biaoti|baiiti|<br>|——|——|——|<br>|list|file|china|<br>|letian|zhong|hongkong|</p>\n<p><br></p>\n"},{"title":"HowTo set Tomcat 7 automatic startup with CentOS 7","id":"145","updated":"2017-04-21T05:13:21.000Z","date":"2017-04-05T07:21:03.000Z","_content":"\n因CentOS7与6在系统上，变化较大，所以在之前的文章中讲到的使用Tomcat7开机自启动的方式在CentOS7是是无法使用的，所以这篇文章的目的是如何在CentOS7上将Tomcat7设置为开机自启动。\n\n#### 1. 安装JAVA环境\n```\n\n[root@7 ~]# curl -LO -H \"Cookie: oraclelicense=accept-securebackup-cookie\" \\\n\"http://download.oracle.com/otn-pub/java/jdk/7u75-b13/jdk-7u75-linux-x64.rpm\"\n\n[root@7 ~]# rpm -Uvh jdk-7u75-linux-x64.rpm\nPreparing...                ########################################### [100%]\n   1:jdk                    ########################################### [100%]\nUnpacking JAR files...\n        rt.jar...\n        jsse.jar...\n        charsets.jar...\n        tools.jar...\n        localedata.jar...\n        jfxrt.jar...\n\n[root@7 ~]# vi /etc/profile\n# add follows to the end\nexport JAVA_HOME=/usr/java/default\nexport PATH=$PATH:$JAVA_HOME/bin\nexport CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar\n[root@7 ~]# source /etc/profile\n```\n\n#### 2. 安装Tomcat7\n```\n\n[root@7 ~]# wget http://ftp.riken.jp/net/apache/tomcat/tomcat-7/v7.0.77/bin/apache-tomcat-7.0.77.tar.gz\n[root@7 ~]# tar zxvf apache-tomcat-7.0.77.tar.gz\n[root@7 ~]# mv apache-tomcat-7.0.77 /usr/tomcat7\n[root@7 ~]# useradd -M -d /usr/tomcat7 tomcat7\n[root@7 ~]# chown -R tomcat7. /usr/tomcat7\n```\n\n#### 3. 创建开机自启动脚本\n```\n[root@7 ~]# cat /usr/lib/systemd/system/tomcat7.service\n# create new\n [Unit]\nDescription=Apache Tomcat 7\nAfter=network.target\n\n[Service]\nType=oneshot\nExecStart=/usr/tomcat7/bin/startup.sh\nExecStop=/usr/tomcat7/bin/shutdown.sh\nRemainAfterExit=yes\nUser=tomcat7\nGroup=tomcat7\n\n[Install]\nWantedBy=multi-user.target\n```\n\n#### 4. 启动Tomcat7\n```\n[root@7 ~]# systemctl start tomcat7.service\n[root@7 ~]# systemctl enable tomcat7.service\n```\n","source":"_posts/HowTo-set-Tomcat-7-automatic-startup-with-CentOS-7.md","raw":"---\ntitle: HowTo set Tomcat 7 automatic startup with CentOS 7\ntags: 'Tomcat'\ncategories: 'Tomcat'\npermalink: howto-set-tomcat-7-automatic-startup-with-centos-7\nid: 145\nupdated: '2017-04-21 13:13:21'\ndate: 2017-04-05 15:21:03\n---\n\n因CentOS7与6在系统上，变化较大，所以在之前的文章中讲到的使用Tomcat7开机自启动的方式在CentOS7是是无法使用的，所以这篇文章的目的是如何在CentOS7上将Tomcat7设置为开机自启动。\n\n#### 1. 安装JAVA环境\n```\n\n[root@7 ~]# curl -LO -H \"Cookie: oraclelicense=accept-securebackup-cookie\" \\\n\"http://download.oracle.com/otn-pub/java/jdk/7u75-b13/jdk-7u75-linux-x64.rpm\"\n\n[root@7 ~]# rpm -Uvh jdk-7u75-linux-x64.rpm\nPreparing...                ########################################### [100%]\n   1:jdk                    ########################################### [100%]\nUnpacking JAR files...\n        rt.jar...\n        jsse.jar...\n        charsets.jar...\n        tools.jar...\n        localedata.jar...\n        jfxrt.jar...\n\n[root@7 ~]# vi /etc/profile\n# add follows to the end\nexport JAVA_HOME=/usr/java/default\nexport PATH=$PATH:$JAVA_HOME/bin\nexport CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar\n[root@7 ~]# source /etc/profile\n```\n\n#### 2. 安装Tomcat7\n```\n\n[root@7 ~]# wget http://ftp.riken.jp/net/apache/tomcat/tomcat-7/v7.0.77/bin/apache-tomcat-7.0.77.tar.gz\n[root@7 ~]# tar zxvf apache-tomcat-7.0.77.tar.gz\n[root@7 ~]# mv apache-tomcat-7.0.77 /usr/tomcat7\n[root@7 ~]# useradd -M -d /usr/tomcat7 tomcat7\n[root@7 ~]# chown -R tomcat7. /usr/tomcat7\n```\n\n#### 3. 创建开机自启动脚本\n```\n[root@7 ~]# cat /usr/lib/systemd/system/tomcat7.service\n# create new\n [Unit]\nDescription=Apache Tomcat 7\nAfter=network.target\n\n[Service]\nType=oneshot\nExecStart=/usr/tomcat7/bin/startup.sh\nExecStop=/usr/tomcat7/bin/shutdown.sh\nRemainAfterExit=yes\nUser=tomcat7\nGroup=tomcat7\n\n[Install]\nWantedBy=multi-user.target\n```\n\n#### 4. 启动Tomcat7\n```\n[root@7 ~]# systemctl start tomcat7.service\n[root@7 ~]# systemctl enable tomcat7.service\n```\n","slug":"howto-set-tomcat-7-automatic-startup-with-centos-7","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqaj004841tpu6cf03g5","content":"<p>因CentOS7与6在系统上，变化较大，所以在之前的文章中讲到的使用Tomcat7开机自启动的方式在CentOS7是是无法使用的，所以这篇文章的目的是如何在CentOS7上将Tomcat7设置为开机自启动。</p>\n<h4 id=\"1-安装JAVA环境\"><a href=\"#1-安装JAVA环境\" class=\"headerlink\" title=\"1. 安装JAVA环境\"></a>1. 安装JAVA环境</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">[root@7 ~]# curl -LO -H &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; \\</div><div class=\"line\">&quot;http://download.oracle.com/otn-pub/java/jdk/7u75-b13/jdk-7u75-linux-x64.rpm&quot;</div><div class=\"line\"></div><div class=\"line\">[root@7 ~]# rpm -Uvh jdk-7u75-linux-x64.rpm</div><div class=\"line\">Preparing...                ########################################### [100%]</div><div class=\"line\">   1:jdk                    ########################################### [100%]</div><div class=\"line\">Unpacking JAR files...</div><div class=\"line\">        rt.jar...</div><div class=\"line\">        jsse.jar...</div><div class=\"line\">        charsets.jar...</div><div class=\"line\">        tools.jar...</div><div class=\"line\">        localedata.jar...</div><div class=\"line\">        jfxrt.jar...</div><div class=\"line\"></div><div class=\"line\">[root@7 ~]# vi /etc/profile</div><div class=\"line\"># add follows to the end</div><div class=\"line\">export JAVA_HOME=/usr/java/default</div><div class=\"line\">export PATH=$PATH:$JAVA_HOME/bin</div><div class=\"line\">export CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar</div><div class=\"line\">[root@7 ~]# source /etc/profile</div></pre></td></tr></table></figure>\n<h4 id=\"2-安装Tomcat7\"><a href=\"#2-安装Tomcat7\" class=\"headerlink\" title=\"2. 安装Tomcat7\"></a>2. 安装Tomcat7</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">[root@7 ~]# wget http://ftp.riken.jp/net/apache/tomcat/tomcat-7/v7.0.77/bin/apache-tomcat-7.0.77.tar.gz</div><div class=\"line\">[root@7 ~]# tar zxvf apache-tomcat-7.0.77.tar.gz</div><div class=\"line\">[root@7 ~]# mv apache-tomcat-7.0.77 /usr/tomcat7</div><div class=\"line\">[root@7 ~]# useradd -M -d /usr/tomcat7 tomcat7</div><div class=\"line\">[root@7 ~]# chown -R tomcat7. /usr/tomcat7</div></pre></td></tr></table></figure>\n<h4 id=\"3-创建开机自启动脚本\"><a href=\"#3-创建开机自启动脚本\" class=\"headerlink\" title=\"3. 创建开机自启动脚本\"></a>3. 创建开机自启动脚本</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@7 ~]# cat /usr/lib/systemd/system/tomcat7.service</div><div class=\"line\"># create new</div><div class=\"line\"> [Unit]</div><div class=\"line\">Description=Apache Tomcat 7</div><div class=\"line\">After=network.target</div><div class=\"line\"></div><div class=\"line\">[Service]</div><div class=\"line\">Type=oneshot</div><div class=\"line\">ExecStart=/usr/tomcat7/bin/startup.sh</div><div class=\"line\">ExecStop=/usr/tomcat7/bin/shutdown.sh</div><div class=\"line\">RemainAfterExit=yes</div><div class=\"line\">User=tomcat7</div><div class=\"line\">Group=tomcat7</div><div class=\"line\"></div><div class=\"line\">[Install]</div><div class=\"line\">WantedBy=multi-user.target</div></pre></td></tr></table></figure>\n<h4 id=\"4-启动Tomcat7\"><a href=\"#4-启动Tomcat7\" class=\"headerlink\" title=\"4. 启动Tomcat7\"></a>4. 启动Tomcat7</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@7 ~]# systemctl start tomcat7.service</div><div class=\"line\">[root@7 ~]# systemctl enable tomcat7.service</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>因CentOS7与6在系统上，变化较大，所以在之前的文章中讲到的使用Tomcat7开机自启动的方式在CentOS7是是无法使用的，所以这篇文章的目的是如何在CentOS7上将Tomcat7设置为开机自启动。</p>\n<h4 id=\"1-安装JAVA环境\"><a href=\"#1-安装JAVA环境\" class=\"headerlink\" title=\"1. 安装JAVA环境\"></a>1. 安装JAVA环境</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">[root@7 ~]# curl -LO -H &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; \\</div><div class=\"line\">&quot;http://download.oracle.com/otn-pub/java/jdk/7u75-b13/jdk-7u75-linux-x64.rpm&quot;</div><div class=\"line\"></div><div class=\"line\">[root@7 ~]# rpm -Uvh jdk-7u75-linux-x64.rpm</div><div class=\"line\">Preparing...                ########################################### [100%]</div><div class=\"line\">   1:jdk                    ########################################### [100%]</div><div class=\"line\">Unpacking JAR files...</div><div class=\"line\">        rt.jar...</div><div class=\"line\">        jsse.jar...</div><div class=\"line\">        charsets.jar...</div><div class=\"line\">        tools.jar...</div><div class=\"line\">        localedata.jar...</div><div class=\"line\">        jfxrt.jar...</div><div class=\"line\"></div><div class=\"line\">[root@7 ~]# vi /etc/profile</div><div class=\"line\"># add follows to the end</div><div class=\"line\">export JAVA_HOME=/usr/java/default</div><div class=\"line\">export PATH=$PATH:$JAVA_HOME/bin</div><div class=\"line\">export CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar</div><div class=\"line\">[root@7 ~]# source /etc/profile</div></pre></td></tr></table></figure>\n<h4 id=\"2-安装Tomcat7\"><a href=\"#2-安装Tomcat7\" class=\"headerlink\" title=\"2. 安装Tomcat7\"></a>2. 安装Tomcat7</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">[root@7 ~]# wget http://ftp.riken.jp/net/apache/tomcat/tomcat-7/v7.0.77/bin/apache-tomcat-7.0.77.tar.gz</div><div class=\"line\">[root@7 ~]# tar zxvf apache-tomcat-7.0.77.tar.gz</div><div class=\"line\">[root@7 ~]# mv apache-tomcat-7.0.77 /usr/tomcat7</div><div class=\"line\">[root@7 ~]# useradd -M -d /usr/tomcat7 tomcat7</div><div class=\"line\">[root@7 ~]# chown -R tomcat7. /usr/tomcat7</div></pre></td></tr></table></figure>\n<h4 id=\"3-创建开机自启动脚本\"><a href=\"#3-创建开机自启动脚本\" class=\"headerlink\" title=\"3. 创建开机自启动脚本\"></a>3. 创建开机自启动脚本</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@7 ~]# cat /usr/lib/systemd/system/tomcat7.service</div><div class=\"line\"># create new</div><div class=\"line\"> [Unit]</div><div class=\"line\">Description=Apache Tomcat 7</div><div class=\"line\">After=network.target</div><div class=\"line\"></div><div class=\"line\">[Service]</div><div class=\"line\">Type=oneshot</div><div class=\"line\">ExecStart=/usr/tomcat7/bin/startup.sh</div><div class=\"line\">ExecStop=/usr/tomcat7/bin/shutdown.sh</div><div class=\"line\">RemainAfterExit=yes</div><div class=\"line\">User=tomcat7</div><div class=\"line\">Group=tomcat7</div><div class=\"line\"></div><div class=\"line\">[Install]</div><div class=\"line\">WantedBy=multi-user.target</div></pre></td></tr></table></figure>\n<h4 id=\"4-启动Tomcat7\"><a href=\"#4-启动Tomcat7\" class=\"headerlink\" title=\"4. 启动Tomcat7\"></a>4. 启动Tomcat7</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@7 ~]# systemctl start tomcat7.service</div><div class=\"line\">[root@7 ~]# systemctl enable tomcat7.service</div></pre></td></tr></table></figure>\n"},{"title":"Linux 中的三个特殊权限","id":"16","updated":"2017-04-21T05:38:12.000Z","date":"2016-03-28T23:50:36.000Z","_content":"\n\n\n```\nLinux中除了普通权限之外，还有三个特殊权限。\nSUID:：以文件的所属用户执行，而非执行文件的用户，多用于可执行文件，设置suid后，在权限位中，所属用户的  最后一个权\n限为变为s，添加SUID权限可用“+s”表示。\n例如：passwd\n[adam@ultraera  ~]$  which  passwd\n/usr/bin/passwd\n[adam@ultraera  ~]$  ls  -l  /usr/bin/passwd\n-rwsr-xr-x.  1  root  root  25980  Feb  22  2012  /usr/bin/passwd\n[adam@ultraera  ~]$\nSGID：主要针对文件夹，在设置了SGID的文件夹中创建任何新文件都继承该文件的所属组，设置sgid后，在权限位中，所属\n组的最后一个权限位变为s，添加SGID权限可用“+s”表示。\n例如：\n[adam@ultraera  ~]$  mkdir  ultraera\n[adam@ultraera  ~]$  ls  -l\ntotal  4\ndrwxrwxr-x  2  adam  adam  4096  Nov  27  21:09  ultraera\n[adam@ultraera  ~]$  chmod  g+s  ultraera/\n[adam@ultraera  ~]$  ls  -l\ntotal  4\ndrwxrwsr-x  2  adam  adam  4096  Nov  27  21:09  ultraera\n[adam@ultraera  ~]$  su\nPassword:\n[root@ultraera  adam]#  mkdir  -p  ultraera/test\n[root@ultraera  adam]#  ls  -l  ultraera/\ntotal  4\ndrwxr-sr-x  2  root  adam  4096  Nov  27  21:09  test\n[root@ultraera  adam]#\nsticky：针对文件夹，对目录拥有写权限的用户，仅可以删除其所拥有的文件，无法删除其他用户所拥有的文件，设置了sticky\n之后，在权限位，other的最后一个权限位变为t,添加SGID权限可用“+t”表示。\n例如：\n[root@ultraera  tmp]#  mkdir  ultraera\n[root@ultraera  tmp]#  chmod  a=rwx,o+t  ultraera/\n[root@ultraera  tmp]#  ls  -ld  ultraera/\ndrwxrwxrwt  2  root  root  4096  Nov  27  21:29  ultraera/\n[root@ultraera  tmp]#  useradd  user1\n[root@ultraera  tmp]#  useradd  user2\n[root@ultraera  tmp]#  su  user1\n[user1@ultraera  tmp]$  touch  ./ultraera/test\n[user1@ultraera  tmp]$  ls  -l  ultraera/\ntotal  0\n-rw-rw-r--  1  user1  user1  0  Nov  27  21:31  test\n[user1@ultraera  tmp]$  exit\nexit\n[root@ultraera  tmp]#  su  user2\n[user2@ultraera  tmp]$  rm  -f  ./ultraera/test\nrm:  cannot  remove  `./ultraera/test':  Operation  not  permitted\n[user2@ultraera  tmp]$\n\n\n同样使用chmod来设定特殊权限，与普通权限一样，特殊权限也可以用数字表示：\nsuid  ：  4\nsgid  ：  2\nsticky ：  1\nchmod  4644  filename\t#设置文件suid权限\nchmod  2755  flodername\t#设置文件夹sgid权限\nchmod  1755  flodername\t#设置文件夹sticky权限\n\n```\n","source":"_posts/Linux-中的三个特殊权限.md","raw":"---\ntitle: Linux 中的三个特殊权限\ntags: 'Linux'\ncategories: 'Linux'\npermalink: linux-de-san-ge-te-shu-quan-xian\nid: 16\nupdated: '2017-04-21 13:38:12'\ndate: 2016-03-29 07:50:36\n---\n\n\n\n```\nLinux中除了普通权限之外，还有三个特殊权限。\nSUID:：以文件的所属用户执行，而非执行文件的用户，多用于可执行文件，设置suid后，在权限位中，所属用户的  最后一个权\n限为变为s，添加SUID权限可用“+s”表示。\n例如：passwd\n[adam@ultraera  ~]$  which  passwd\n/usr/bin/passwd\n[adam@ultraera  ~]$  ls  -l  /usr/bin/passwd\n-rwsr-xr-x.  1  root  root  25980  Feb  22  2012  /usr/bin/passwd\n[adam@ultraera  ~]$\nSGID：主要针对文件夹，在设置了SGID的文件夹中创建任何新文件都继承该文件的所属组，设置sgid后，在权限位中，所属\n组的最后一个权限位变为s，添加SGID权限可用“+s”表示。\n例如：\n[adam@ultraera  ~]$  mkdir  ultraera\n[adam@ultraera  ~]$  ls  -l\ntotal  4\ndrwxrwxr-x  2  adam  adam  4096  Nov  27  21:09  ultraera\n[adam@ultraera  ~]$  chmod  g+s  ultraera/\n[adam@ultraera  ~]$  ls  -l\ntotal  4\ndrwxrwsr-x  2  adam  adam  4096  Nov  27  21:09  ultraera\n[adam@ultraera  ~]$  su\nPassword:\n[root@ultraera  adam]#  mkdir  -p  ultraera/test\n[root@ultraera  adam]#  ls  -l  ultraera/\ntotal  4\ndrwxr-sr-x  2  root  adam  4096  Nov  27  21:09  test\n[root@ultraera  adam]#\nsticky：针对文件夹，对目录拥有写权限的用户，仅可以删除其所拥有的文件，无法删除其他用户所拥有的文件，设置了sticky\n之后，在权限位，other的最后一个权限位变为t,添加SGID权限可用“+t”表示。\n例如：\n[root@ultraera  tmp]#  mkdir  ultraera\n[root@ultraera  tmp]#  chmod  a=rwx,o+t  ultraera/\n[root@ultraera  tmp]#  ls  -ld  ultraera/\ndrwxrwxrwt  2  root  root  4096  Nov  27  21:29  ultraera/\n[root@ultraera  tmp]#  useradd  user1\n[root@ultraera  tmp]#  useradd  user2\n[root@ultraera  tmp]#  su  user1\n[user1@ultraera  tmp]$  touch  ./ultraera/test\n[user1@ultraera  tmp]$  ls  -l  ultraera/\ntotal  0\n-rw-rw-r--  1  user1  user1  0  Nov  27  21:31  test\n[user1@ultraera  tmp]$  exit\nexit\n[root@ultraera  tmp]#  su  user2\n[user2@ultraera  tmp]$  rm  -f  ./ultraera/test\nrm:  cannot  remove  `./ultraera/test':  Operation  not  permitted\n[user2@ultraera  tmp]$\n\n\n同样使用chmod来设定特殊权限，与普通权限一样，特殊权限也可以用数字表示：\nsuid  ：  4\nsgid  ：  2\nsticky ：  1\nchmod  4644  filename\t#设置文件suid权限\nchmod  2755  flodername\t#设置文件夹sgid权限\nchmod  1755  flodername\t#设置文件夹sticky权限\n\n```\n","slug":"linux-de-san-ge-te-shu-quan-xian","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqal004c41tp6f8ldkpg","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div></pre></td><td class=\"code\"><pre><div class=\"line\">Linux中除了普通权限之外，还有三个特殊权限。</div><div class=\"line\">SUID:：以文件的所属用户执行，而非执行文件的用户，多用于可执行文件，设置suid后，在权限位中，所属用户的  最后一个权</div><div class=\"line\">限为变为s，添加SUID权限可用“+s”表示。</div><div class=\"line\">例如：passwd</div><div class=\"line\">[adam@ultraera  ~]$  which  passwd</div><div class=\"line\">/usr/bin/passwd</div><div class=\"line\">[adam@ultraera  ~]$  ls  -l  /usr/bin/passwd</div><div class=\"line\">-rwsr-xr-x.  1  root  root  25980  Feb  22  2012  /usr/bin/passwd</div><div class=\"line\">[adam@ultraera  ~]$</div><div class=\"line\">SGID：主要针对文件夹，在设置了SGID的文件夹中创建任何新文件都继承该文件的所属组，设置sgid后，在权限位中，所属</div><div class=\"line\">组的最后一个权限位变为s，添加SGID权限可用“+s”表示。</div><div class=\"line\">例如：</div><div class=\"line\">[adam@ultraera  ~]$  mkdir  ultraera</div><div class=\"line\">[adam@ultraera  ~]$  ls  -l</div><div class=\"line\">total  4</div><div class=\"line\">drwxrwxr-x  2  adam  adam  4096  Nov  27  21:09  ultraera</div><div class=\"line\">[adam@ultraera  ~]$  chmod  g+s  ultraera/</div><div class=\"line\">[adam@ultraera  ~]$  ls  -l</div><div class=\"line\">total  4</div><div class=\"line\">drwxrwsr-x  2  adam  adam  4096  Nov  27  21:09  ultraera</div><div class=\"line\">[adam@ultraera  ~]$  su</div><div class=\"line\">Password:</div><div class=\"line\">[root@ultraera  adam]#  mkdir  -p  ultraera/test</div><div class=\"line\">[root@ultraera  adam]#  ls  -l  ultraera/</div><div class=\"line\">total  4</div><div class=\"line\">drwxr-sr-x  2  root  adam  4096  Nov  27  21:09  test</div><div class=\"line\">[root@ultraera  adam]#</div><div class=\"line\">sticky：针对文件夹，对目录拥有写权限的用户，仅可以删除其所拥有的文件，无法删除其他用户所拥有的文件，设置了sticky</div><div class=\"line\">之后，在权限位，other的最后一个权限位变为t,添加SGID权限可用“+t”表示。</div><div class=\"line\">例如：</div><div class=\"line\">[root@ultraera  tmp]#  mkdir  ultraera</div><div class=\"line\">[root@ultraera  tmp]#  chmod  a=rwx,o+t  ultraera/</div><div class=\"line\">[root@ultraera  tmp]#  ls  -ld  ultraera/</div><div class=\"line\">drwxrwxrwt  2  root  root  4096  Nov  27  21:29  ultraera/</div><div class=\"line\">[root@ultraera  tmp]#  useradd  user1</div><div class=\"line\">[root@ultraera  tmp]#  useradd  user2</div><div class=\"line\">[root@ultraera  tmp]#  su  user1</div><div class=\"line\">[user1@ultraera  tmp]$  touch  ./ultraera/test</div><div class=\"line\">[user1@ultraera  tmp]$  ls  -l  ultraera/</div><div class=\"line\">total  0</div><div class=\"line\">-rw-rw-r--  1  user1  user1  0  Nov  27  21:31  test</div><div class=\"line\">[user1@ultraera  tmp]$  exit</div><div class=\"line\">exit</div><div class=\"line\">[root@ultraera  tmp]#  su  user2</div><div class=\"line\">[user2@ultraera  tmp]$  rm  -f  ./ultraera/test</div><div class=\"line\">rm:  cannot  remove  `./ultraera/test&apos;:  Operation  not  permitted</div><div class=\"line\">[user2@ultraera  tmp]$</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">同样使用chmod来设定特殊权限，与普通权限一样，特殊权限也可以用数字表示：</div><div class=\"line\">suid  ：  4</div><div class=\"line\">sgid  ：  2</div><div class=\"line\">sticky ：  1</div><div class=\"line\">chmod  4644  filename\t#设置文件suid权限</div><div class=\"line\">chmod  2755  flodername\t#设置文件夹sgid权限</div><div class=\"line\">chmod  1755  flodername\t#设置文件夹sticky权限</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div></pre></td><td class=\"code\"><pre><div class=\"line\">Linux中除了普通权限之外，还有三个特殊权限。</div><div class=\"line\">SUID:：以文件的所属用户执行，而非执行文件的用户，多用于可执行文件，设置suid后，在权限位中，所属用户的  最后一个权</div><div class=\"line\">限为变为s，添加SUID权限可用“+s”表示。</div><div class=\"line\">例如：passwd</div><div class=\"line\">[adam@ultraera  ~]$  which  passwd</div><div class=\"line\">/usr/bin/passwd</div><div class=\"line\">[adam@ultraera  ~]$  ls  -l  /usr/bin/passwd</div><div class=\"line\">-rwsr-xr-x.  1  root  root  25980  Feb  22  2012  /usr/bin/passwd</div><div class=\"line\">[adam@ultraera  ~]$</div><div class=\"line\">SGID：主要针对文件夹，在设置了SGID的文件夹中创建任何新文件都继承该文件的所属组，设置sgid后，在权限位中，所属</div><div class=\"line\">组的最后一个权限位变为s，添加SGID权限可用“+s”表示。</div><div class=\"line\">例如：</div><div class=\"line\">[adam@ultraera  ~]$  mkdir  ultraera</div><div class=\"line\">[adam@ultraera  ~]$  ls  -l</div><div class=\"line\">total  4</div><div class=\"line\">drwxrwxr-x  2  adam  adam  4096  Nov  27  21:09  ultraera</div><div class=\"line\">[adam@ultraera  ~]$  chmod  g+s  ultraera/</div><div class=\"line\">[adam@ultraera  ~]$  ls  -l</div><div class=\"line\">total  4</div><div class=\"line\">drwxrwsr-x  2  adam  adam  4096  Nov  27  21:09  ultraera</div><div class=\"line\">[adam@ultraera  ~]$  su</div><div class=\"line\">Password:</div><div class=\"line\">[root@ultraera  adam]#  mkdir  -p  ultraera/test</div><div class=\"line\">[root@ultraera  adam]#  ls  -l  ultraera/</div><div class=\"line\">total  4</div><div class=\"line\">drwxr-sr-x  2  root  adam  4096  Nov  27  21:09  test</div><div class=\"line\">[root@ultraera  adam]#</div><div class=\"line\">sticky：针对文件夹，对目录拥有写权限的用户，仅可以删除其所拥有的文件，无法删除其他用户所拥有的文件，设置了sticky</div><div class=\"line\">之后，在权限位，other的最后一个权限位变为t,添加SGID权限可用“+t”表示。</div><div class=\"line\">例如：</div><div class=\"line\">[root@ultraera  tmp]#  mkdir  ultraera</div><div class=\"line\">[root@ultraera  tmp]#  chmod  a=rwx,o+t  ultraera/</div><div class=\"line\">[root@ultraera  tmp]#  ls  -ld  ultraera/</div><div class=\"line\">drwxrwxrwt  2  root  root  4096  Nov  27  21:29  ultraera/</div><div class=\"line\">[root@ultraera  tmp]#  useradd  user1</div><div class=\"line\">[root@ultraera  tmp]#  useradd  user2</div><div class=\"line\">[root@ultraera  tmp]#  su  user1</div><div class=\"line\">[user1@ultraera  tmp]$  touch  ./ultraera/test</div><div class=\"line\">[user1@ultraera  tmp]$  ls  -l  ultraera/</div><div class=\"line\">total  0</div><div class=\"line\">-rw-rw-r--  1  user1  user1  0  Nov  27  21:31  test</div><div class=\"line\">[user1@ultraera  tmp]$  exit</div><div class=\"line\">exit</div><div class=\"line\">[root@ultraera  tmp]#  su  user2</div><div class=\"line\">[user2@ultraera  tmp]$  rm  -f  ./ultraera/test</div><div class=\"line\">rm:  cannot  remove  `./ultraera/test&apos;:  Operation  not  permitted</div><div class=\"line\">[user2@ultraera  tmp]$</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">同样使用chmod来设定特殊权限，与普通权限一样，特殊权限也可以用数字表示：</div><div class=\"line\">suid  ：  4</div><div class=\"line\">sgid  ：  2</div><div class=\"line\">sticky ：  1</div><div class=\"line\">chmod  4644  filename\t#设置文件suid权限</div><div class=\"line\">chmod  2755  flodername\t#设置文件夹sgid权限</div><div class=\"line\">chmod  1755  flodername\t#设置文件夹sticky权限</div></pre></td></tr></table></figure>\n"},{"title":"Linux 笔试试题","id":"7","updated":"2017-04-21T05:39:52.000Z","date":"2016-03-23T04:05:16.000Z","_content":"\n\n```\n一. 选择题 （1题1分）\n1. 当登录Linux时，一个具有唯一进程ID号的shell将被调用，这个ID是什么(   )\nA. NID　　B. PID　　C. UID　　D. CID\n答案:B\n2. 用vi打开一个文件，如何用字母\"new\"来代替字母\"old\" (   )\nA. :s/old/new/g　　　B. :s/old/new　　C. :1,$s/old/new/g　　　D. :r/old/new\n答案:A\n3. 请选择对标准的变量PS2正确的描述(   )\nA. 是一个主shell提示符变量　　　　B. 是一个一般的shell提示符变量\nC. 是第二主shell提示符变量　　   D. 是一个连续提示符变量\n答案:B\n4. 哪一个命令能用来查找文件TESTFILE中只包含四个字符的行?(   )\nA. grep '^????$' TESTFILE　　　　B. grep '????' TESTFILE\nC. grep '^....$' TESTFILE　　　　　D. grep '....' TESTFILE\n答案:C\n5. 一个bash shell脚本的第一行是什么(   )\nA. #!/bin/bash　　B. #/bin/bash　　C. #/bin/csh　　　D. /bin/bash\n答案:A\n6. 用标准的输出重定向(>)像\"> file01\"能使文件file01的数据（   ）\nA. 被移动　　B. 被复制　　C. 被打印　　　D. 被覆盖\n答案:D\n7. 下面哪个命令是用来定义shell的全局变量(    )\nA. exportfs　　B. alias　　C. exports　　D. export\n答案:D\n8. 如果想加载一个/dev/sdb1的windows95分区到/mnt/win95目录，需要运行哪个命令(   )\nA. mount -t hpfs /dev/sdb1 /mnt/win95\nB. mount -t hpfs /mnt/win95 /dev/sdb1\nC. mount -t vfat /dev/sdb1 /mnt/win95\nD. mount -t vfat /mnt/win95 /dev/sdb1\n答案:C\n9. 哪个文件存放用户密码信息(   )\nA. /boot/passwd　　　B. /etc/shadow　　　C. /var/passwd　　D. /dev/passwd\n答案:B\n10. 假定kernel支持vfat分区，下面哪一个操作是将/dev/sda1，一个window98分区加载到/win目录(   )\nA. mount -s win /dev'sda1 /win\nB. mount -fs=msdos /dev/sda1 /win\nC. mount -t vfat /dev/sda1 /win\nD. mount -t windows /win /dev/sda1\n答案:C\n11. 默认情况下管理员创建了一个用户，就会在(   )目录下创建一个用户主目录。\nA. /usr　　B. /home　　　C. /root　　D. /etc\n答案:B\n12. 如果要列出一个目录下的所有文件需要使用命令行(    )。\nA. ls –l　　B. ls　　　C. ls –a　　　D. ls -d\n答案:C\n13. 利用哪个工具可以设置用户在文件系统中的空间大小(   )。\nA. turboservice　　B. turbofscfg　　C. turbonetcfg　　　D. turboxcfg\n答案:B\n14. 哪个命令可以将普通用户转换成超级用户(   )\nA. super　　B. passwd　　C. tar　　　D. su\n答案:D\n15. 哪个命令用来显示/home及其子目录下文件名(   )\nA. ls -R /home　　B. ls -d /home　　C. ls -a /home　　　　D. ls -l /home\n答案:A\n16. 在vi模式下，哪个命令用来删除光标处的字符(    )\nA. xd　　　B. x　　　C. dd　　　D. d\n答案:B　　dd删除一行,x删除当前字符\n17. 在一行内运行多个命令需要用什么字符隔开(   )\nA. @　　B. $　　　C. ;　　D. *\n答案:C\n18. 确定myfile的文件类型的命令是(   )\nA. whatis myfile\nB. file myfile\nC. type myfile\nD. type -q myfile\n答案:B\n19. 哪些命令组合起来能统计多少用户登录系统(    )\nA. who | wc –w　　　B. who | wc –l　　　C. who | wc –c　　　D. who | wc\n答案:BD\n20. 用 \"rm -i\",系统会提示什么来让你确认(   )\nA. 命令行的每个选项　　B. 是否真的删除　　C. 是否有写的权限　　　D. 文件的位置\n答案:B\n21. Linux启动的第一个进程init启动的第一个脚本程序是(   )。\nA. /etc/rc.d/init.d　　　B. /etc/rc.d/rc.sysinit　　C. /etc/rc.d/rc5.d　　D. /etc/rc.d/rc3.d\n答案:B\n22. 按下(   )键能终止当前运行的命令\nA. Ctrl-C　　　B. Ctrl-F　　　C. Ctrl-B　　　D. Ctrl-D\n答案:a\n23. 用来分离目录名和文件名的字符是(   )\nA. dash (-)　　B. slash (/)　　C. period (.)　　　D. asterisk（*）\n答案:B\n24. 系统的配置文件在(  )目录下\nA. /home　　　B. /dev　　C. /etc　　　D. /usr\n答案:C\n25. 显示用户的主目录的命令是什么?(   )\nA. echo $HOME　　B. echo $USERDIR　　　C. echo $ENV　　D. echo $ECHO\n答案:A\n26. 在vi编辑器里，哪个命令能将光标移到第200行(    )\nA. g200　　B. G200　　C. :200　　　D. 200g\n答案:C\n:200可以，200G也可以\n27. 用\"useradd jerry\"命令添加一个用户，这个用户的主目录是什么?(   )\nA. /etc/jerry　　　B. /var/jerry　　C. /home/jerry　　　D. /bin/jerry\n答案:C\n28. 哪一个命令能用来删除当前目录及其子目录下名为'core'的文件(   )\nA. find . -name core -exec rm {} \\ ;\nB. find . -name core -exec rm ;\nC. find . -name core -exec rm {} ;\nD. find . -name core -exec rm {} -;\n答案:A\n29. 以下哪条命令在创建一个xp用户的时候将用户加入到root组中(  )\nA. useradd -g xp root　　B. useradd -r root xp　　C. useradd -g root xp　　　D. useradd root xp\n答案:C\n30. 不改变运行级别而重新读入inittab文件的命令是(    )。\nA. init s　　B. init q　　C. init S　　　D. init Q\n答案:B\n31. 以下哪个命令可以终止一个用户的所有进程(   )\nA. skillall　　　B. skill　　C. kill　　　D. killall\n答案:D\n32. 通过修改哪个文件可以在创建用户的时候改变用　户主目录的路径(   )\nA. /etc/default/passwd　　　B. /etc/default/useradd　　C. /etc/profile　　D. /etc/fstab\n答案:B\n33. 以只读方式打开一个文件并进入vi编辑器的命令是(   )\nA. view -r filename　　　B. view filename　　　C. vi filename　　　D. vi -r filename\n答案:B\n34. 以下哪个命令是将缓存中的内容粘贴到光标之前(   )\nA. a　　　B. i　　　C. P　　　D. p\n答案:C\n35. 以下哪条vi命令能将文档5-20行间出现的abc替换成为cba (   )\nA. :1,$s/abc/cba/g　　　B. :5,20/abc/cba/g　　C. :5-20s/abc/cba/g　　　D. :5,20s/abc/cba/g\n答案:D\n. 在vi中通过哪条命令可以将ps命令执行的结果插入到文档中(   )\nA. :r!ps　　　B. :!ps　　　C. :!rps　　　　D. :w!ps\n答案:A\n36. 以下哪个vi命令可以在当前位置插入/etc/passwd文本文件(   )\nA. :r /etc/passwd　　　B. :i /etc/passwd　　C. :w /etc/passwd　　　D. :s /etc/passwd\n答案:A\n37. vi中复制整行的命令是(   )\nA. y1　　　B. yy　　　C. ss　　　D. dd\n答案:B\n38. 以下哪个vi命令可以给文档的每行加上一个编号(    )\nA. :e number　　　B. :set number　　C. :r!date 　　　　D. :200g\n答案:B\n38. 以下哪些文件只有根用户才能读写(   )\nA. /etc/bashrc　　　B. /etc/profile　　　C. /etc/shadow　　　　D. /etc/passwd\n答案:BC\n39. 使用groupdel删除一个组的时候，命令执行失败，原因可能是(   )\nA. 该组是系统组　　　B. 该组是空的　　　C. 该组中成员非空　　　D. 该组不存在\n答案:CD\n40. Linux中文件名构成的规则比较灵活表现在(   )\nA. 文件名长度多达256个字符　　　　　B. 可以使用除了/符号外的所有ASCII字符\nC. 不区分大小写　　　　　　　　　　　　D. 无扩展名限制\n答案:ABD\n41. 对用户的口令进行加解锁的命令是passwd,参数选项是(   )\nA. –l　　B. –L　　C. –u　　　D. -U\n答案:AC\n42. 如果你对文件和目录的权限不确定，则不能用(   )命令来检测权限\nA. ps　　　B. ck　　　　C. ls –l　　　D. chown\n答案:ABD\n43. 选择对/proc文件系统不正确的描述(    )\nA. 通常情况下，不提供中断、IO端口、CPU等信息　　　B. /proc文件系统可以提供系统核心的许多参数\nC. /proc是一个虚拟的文件系统　　　　　　　　　　　　D. 可以得到系统中运行的进程的一些信息\n答案:A\n44. 以下哪些符号可以用来连接多条命令(   )\nA. ||　　　　B. &&　　　C. ;　　　D. |\n答案:ABCD\n45. 在shell中，下面哪些字符串当作普通字符串时候需要使用\"\\\"来转义(   )\nA. 分号(;)　　　B. 双引号(\")　　C. 单引号(')　　　D. 反斜杆(\\)\n答案:BCD\n46. Linux中提供了几个重要的工具用来改变服务和进程的运行状态和运行级别以及初始化进程，它们是(   )。\nA. chkconfig　　B. service　　C. turboservice　　　D. ksysv\n答案:ABCD\n47. 在/etc/rc.d/init.d目录下的所有脚本至少支持两个运行参数,它们是(    )。\nA. start　　　B. restart　　　　C. stop　　　D. reload\n答案:AC\n48. Linux一般被称为是稳定的服务器系统，它的安全性表现在(   )\nA. 网络防火墙　　B. 用户管理策略　C. 系统、目录、文件的权限控制　D. 封闭源码便于及时修正漏洞等\n答案:ABC\n49. 在vi中下列哪些命令不能用来在光标前插入文本(   )\nA. p [text]　　B. i [text]　　C. o [text]　　　D. a [text]\n答案:ACD\n50. 在本地的文件系统中下列哪些linux路径结构是无效的(   )\nA. \\usr/zhang/memo　　　B. /usr/zhang/memo　　　C. //usr\\zhang/memo　　　D. \\usr\\zhang\\memo\n答案:ACD\n\n二、简答题 （1题3分）\n\n1.常见的Linux发行版本都有什么？你最擅长哪一个？它的官网网站是什么？说明你擅长哪一块？\n\n2.Linux开机启动流程详细步骤是什么？系统安装完，忘记密码如何破解？\n\n4.某一天突然发现Linux系统文件只读，该怎么办呢？完整操作步骤。\n\n5.安装一台系统使用DVD光盘安装，如何安装50台Linux系统如何安装呢？思考一下。\n\n6.用虚拟机安装了一台Linux系统，突然想克隆一台服务器，克隆后发现无法上网，如何解决？\n\n7.Linux网卡配置文件路径是什么？要使服务器上外网，必须满足的条件有哪些？需要配置什么？\n\n8.一般可以使用什么软件远程linux服务器？通过什么上传文件和下载文件？\n\n9./mnt目录主要用于什么？/root目录跟root用户有什么关系？/根目录与/boot目录有什么联系？\n\n10.某一天误操作，执行了rm  -rf  * ，会有哪些情况发生？请举例。\n\n\n\n三、 公有云题目 （1题5分）\n1. 请解释上云的好处是什么？传统业务类型与公有云也为类型有什么区别？请举例说明。\n\n2. 列出你用过的阿里云\\AWS\\Azure服务？并讲述他们的作用？\n\n3. 请列出你觉得阿里云\\AWS\\Azure目前的特色和不成熟的地方是那些？你觉得应该如何改正。\n\n4. 请用阿里云\\AWS\\Azure设计一个视频网站的架构图并进行解释说明。\n\n```\n","source":"_posts/Linux-笔试试题.md","raw":"---\ntitle: Linux 笔试试题\ntags: 'Linux'\ncategories: 'Linux'\npermalink: linux-bi-shi-shi-ti\nid: 7\nupdated: '2017-04-21 13:39:52'\ndate: 2016-03-23 12:05:16\n---\n\n\n```\n一. 选择题 （1题1分）\n1. 当登录Linux时，一个具有唯一进程ID号的shell将被调用，这个ID是什么(   )\nA. NID　　B. PID　　C. UID　　D. CID\n答案:B\n2. 用vi打开一个文件，如何用字母\"new\"来代替字母\"old\" (   )\nA. :s/old/new/g　　　B. :s/old/new　　C. :1,$s/old/new/g　　　D. :r/old/new\n答案:A\n3. 请选择对标准的变量PS2正确的描述(   )\nA. 是一个主shell提示符变量　　　　B. 是一个一般的shell提示符变量\nC. 是第二主shell提示符变量　　   D. 是一个连续提示符变量\n答案:B\n4. 哪一个命令能用来查找文件TESTFILE中只包含四个字符的行?(   )\nA. grep '^????$' TESTFILE　　　　B. grep '????' TESTFILE\nC. grep '^....$' TESTFILE　　　　　D. grep '....' TESTFILE\n答案:C\n5. 一个bash shell脚本的第一行是什么(   )\nA. #!/bin/bash　　B. #/bin/bash　　C. #/bin/csh　　　D. /bin/bash\n答案:A\n6. 用标准的输出重定向(>)像\"> file01\"能使文件file01的数据（   ）\nA. 被移动　　B. 被复制　　C. 被打印　　　D. 被覆盖\n答案:D\n7. 下面哪个命令是用来定义shell的全局变量(    )\nA. exportfs　　B. alias　　C. exports　　D. export\n答案:D\n8. 如果想加载一个/dev/sdb1的windows95分区到/mnt/win95目录，需要运行哪个命令(   )\nA. mount -t hpfs /dev/sdb1 /mnt/win95\nB. mount -t hpfs /mnt/win95 /dev/sdb1\nC. mount -t vfat /dev/sdb1 /mnt/win95\nD. mount -t vfat /mnt/win95 /dev/sdb1\n答案:C\n9. 哪个文件存放用户密码信息(   )\nA. /boot/passwd　　　B. /etc/shadow　　　C. /var/passwd　　D. /dev/passwd\n答案:B\n10. 假定kernel支持vfat分区，下面哪一个操作是将/dev/sda1，一个window98分区加载到/win目录(   )\nA. mount -s win /dev'sda1 /win\nB. mount -fs=msdos /dev/sda1 /win\nC. mount -t vfat /dev/sda1 /win\nD. mount -t windows /win /dev/sda1\n答案:C\n11. 默认情况下管理员创建了一个用户，就会在(   )目录下创建一个用户主目录。\nA. /usr　　B. /home　　　C. /root　　D. /etc\n答案:B\n12. 如果要列出一个目录下的所有文件需要使用命令行(    )。\nA. ls –l　　B. ls　　　C. ls –a　　　D. ls -d\n答案:C\n13. 利用哪个工具可以设置用户在文件系统中的空间大小(   )。\nA. turboservice　　B. turbofscfg　　C. turbonetcfg　　　D. turboxcfg\n答案:B\n14. 哪个命令可以将普通用户转换成超级用户(   )\nA. super　　B. passwd　　C. tar　　　D. su\n答案:D\n15. 哪个命令用来显示/home及其子目录下文件名(   )\nA. ls -R /home　　B. ls -d /home　　C. ls -a /home　　　　D. ls -l /home\n答案:A\n16. 在vi模式下，哪个命令用来删除光标处的字符(    )\nA. xd　　　B. x　　　C. dd　　　D. d\n答案:B　　dd删除一行,x删除当前字符\n17. 在一行内运行多个命令需要用什么字符隔开(   )\nA. @　　B. $　　　C. ;　　D. *\n答案:C\n18. 确定myfile的文件类型的命令是(   )\nA. whatis myfile\nB. file myfile\nC. type myfile\nD. type -q myfile\n答案:B\n19. 哪些命令组合起来能统计多少用户登录系统(    )\nA. who | wc –w　　　B. who | wc –l　　　C. who | wc –c　　　D. who | wc\n答案:BD\n20. 用 \"rm -i\",系统会提示什么来让你确认(   )\nA. 命令行的每个选项　　B. 是否真的删除　　C. 是否有写的权限　　　D. 文件的位置\n答案:B\n21. Linux启动的第一个进程init启动的第一个脚本程序是(   )。\nA. /etc/rc.d/init.d　　　B. /etc/rc.d/rc.sysinit　　C. /etc/rc.d/rc5.d　　D. /etc/rc.d/rc3.d\n答案:B\n22. 按下(   )键能终止当前运行的命令\nA. Ctrl-C　　　B. Ctrl-F　　　C. Ctrl-B　　　D. Ctrl-D\n答案:a\n23. 用来分离目录名和文件名的字符是(   )\nA. dash (-)　　B. slash (/)　　C. period (.)　　　D. asterisk（*）\n答案:B\n24. 系统的配置文件在(  )目录下\nA. /home　　　B. /dev　　C. /etc　　　D. /usr\n答案:C\n25. 显示用户的主目录的命令是什么?(   )\nA. echo $HOME　　B. echo $USERDIR　　　C. echo $ENV　　D. echo $ECHO\n答案:A\n26. 在vi编辑器里，哪个命令能将光标移到第200行(    )\nA. g200　　B. G200　　C. :200　　　D. 200g\n答案:C\n:200可以，200G也可以\n27. 用\"useradd jerry\"命令添加一个用户，这个用户的主目录是什么?(   )\nA. /etc/jerry　　　B. /var/jerry　　C. /home/jerry　　　D. /bin/jerry\n答案:C\n28. 哪一个命令能用来删除当前目录及其子目录下名为'core'的文件(   )\nA. find . -name core -exec rm {} \\ ;\nB. find . -name core -exec rm ;\nC. find . -name core -exec rm {} ;\nD. find . -name core -exec rm {} -;\n答案:A\n29. 以下哪条命令在创建一个xp用户的时候将用户加入到root组中(  )\nA. useradd -g xp root　　B. useradd -r root xp　　C. useradd -g root xp　　　D. useradd root xp\n答案:C\n30. 不改变运行级别而重新读入inittab文件的命令是(    )。\nA. init s　　B. init q　　C. init S　　　D. init Q\n答案:B\n31. 以下哪个命令可以终止一个用户的所有进程(   )\nA. skillall　　　B. skill　　C. kill　　　D. killall\n答案:D\n32. 通过修改哪个文件可以在创建用户的时候改变用　户主目录的路径(   )\nA. /etc/default/passwd　　　B. /etc/default/useradd　　C. /etc/profile　　D. /etc/fstab\n答案:B\n33. 以只读方式打开一个文件并进入vi编辑器的命令是(   )\nA. view -r filename　　　B. view filename　　　C. vi filename　　　D. vi -r filename\n答案:B\n34. 以下哪个命令是将缓存中的内容粘贴到光标之前(   )\nA. a　　　B. i　　　C. P　　　D. p\n答案:C\n35. 以下哪条vi命令能将文档5-20行间出现的abc替换成为cba (   )\nA. :1,$s/abc/cba/g　　　B. :5,20/abc/cba/g　　C. :5-20s/abc/cba/g　　　D. :5,20s/abc/cba/g\n答案:D\n. 在vi中通过哪条命令可以将ps命令执行的结果插入到文档中(   )\nA. :r!ps　　　B. :!ps　　　C. :!rps　　　　D. :w!ps\n答案:A\n36. 以下哪个vi命令可以在当前位置插入/etc/passwd文本文件(   )\nA. :r /etc/passwd　　　B. :i /etc/passwd　　C. :w /etc/passwd　　　D. :s /etc/passwd\n答案:A\n37. vi中复制整行的命令是(   )\nA. y1　　　B. yy　　　C. ss　　　D. dd\n答案:B\n38. 以下哪个vi命令可以给文档的每行加上一个编号(    )\nA. :e number　　　B. :set number　　C. :r!date 　　　　D. :200g\n答案:B\n38. 以下哪些文件只有根用户才能读写(   )\nA. /etc/bashrc　　　B. /etc/profile　　　C. /etc/shadow　　　　D. /etc/passwd\n答案:BC\n39. 使用groupdel删除一个组的时候，命令执行失败，原因可能是(   )\nA. 该组是系统组　　　B. 该组是空的　　　C. 该组中成员非空　　　D. 该组不存在\n答案:CD\n40. Linux中文件名构成的规则比较灵活表现在(   )\nA. 文件名长度多达256个字符　　　　　B. 可以使用除了/符号外的所有ASCII字符\nC. 不区分大小写　　　　　　　　　　　　D. 无扩展名限制\n答案:ABD\n41. 对用户的口令进行加解锁的命令是passwd,参数选项是(   )\nA. –l　　B. –L　　C. –u　　　D. -U\n答案:AC\n42. 如果你对文件和目录的权限不确定，则不能用(   )命令来检测权限\nA. ps　　　B. ck　　　　C. ls –l　　　D. chown\n答案:ABD\n43. 选择对/proc文件系统不正确的描述(    )\nA. 通常情况下，不提供中断、IO端口、CPU等信息　　　B. /proc文件系统可以提供系统核心的许多参数\nC. /proc是一个虚拟的文件系统　　　　　　　　　　　　D. 可以得到系统中运行的进程的一些信息\n答案:A\n44. 以下哪些符号可以用来连接多条命令(   )\nA. ||　　　　B. &&　　　C. ;　　　D. |\n答案:ABCD\n45. 在shell中，下面哪些字符串当作普通字符串时候需要使用\"\\\"来转义(   )\nA. 分号(;)　　　B. 双引号(\")　　C. 单引号(')　　　D. 反斜杆(\\)\n答案:BCD\n46. Linux中提供了几个重要的工具用来改变服务和进程的运行状态和运行级别以及初始化进程，它们是(   )。\nA. chkconfig　　B. service　　C. turboservice　　　D. ksysv\n答案:ABCD\n47. 在/etc/rc.d/init.d目录下的所有脚本至少支持两个运行参数,它们是(    )。\nA. start　　　B. restart　　　　C. stop　　　D. reload\n答案:AC\n48. Linux一般被称为是稳定的服务器系统，它的安全性表现在(   )\nA. 网络防火墙　　B. 用户管理策略　C. 系统、目录、文件的权限控制　D. 封闭源码便于及时修正漏洞等\n答案:ABC\n49. 在vi中下列哪些命令不能用来在光标前插入文本(   )\nA. p [text]　　B. i [text]　　C. o [text]　　　D. a [text]\n答案:ACD\n50. 在本地的文件系统中下列哪些linux路径结构是无效的(   )\nA. \\usr/zhang/memo　　　B. /usr/zhang/memo　　　C. //usr\\zhang/memo　　　D. \\usr\\zhang\\memo\n答案:ACD\n\n二、简答题 （1题3分）\n\n1.常见的Linux发行版本都有什么？你最擅长哪一个？它的官网网站是什么？说明你擅长哪一块？\n\n2.Linux开机启动流程详细步骤是什么？系统安装完，忘记密码如何破解？\n\n4.某一天突然发现Linux系统文件只读，该怎么办呢？完整操作步骤。\n\n5.安装一台系统使用DVD光盘安装，如何安装50台Linux系统如何安装呢？思考一下。\n\n6.用虚拟机安装了一台Linux系统，突然想克隆一台服务器，克隆后发现无法上网，如何解决？\n\n7.Linux网卡配置文件路径是什么？要使服务器上外网，必须满足的条件有哪些？需要配置什么？\n\n8.一般可以使用什么软件远程linux服务器？通过什么上传文件和下载文件？\n\n9./mnt目录主要用于什么？/root目录跟root用户有什么关系？/根目录与/boot目录有什么联系？\n\n10.某一天误操作，执行了rm  -rf  * ，会有哪些情况发生？请举例。\n\n\n\n三、 公有云题目 （1题5分）\n1. 请解释上云的好处是什么？传统业务类型与公有云也为类型有什么区别？请举例说明。\n\n2. 列出你用过的阿里云\\AWS\\Azure服务？并讲述他们的作用？\n\n3. 请列出你觉得阿里云\\AWS\\Azure目前的特色和不成熟的地方是那些？你觉得应该如何改正。\n\n4. 请用阿里云\\AWS\\Azure设计一个视频网站的架构图并进行解释说明。\n\n```\n","slug":"linux-bi-shi-shi-ti","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqaq004f41tp4e4i4xk4","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div></pre></td><td class=\"code\"><pre><div class=\"line\">一. 选择题 （1题1分）</div><div class=\"line\">1. 当登录Linux时，一个具有唯一进程ID号的shell将被调用，这个ID是什么(   )</div><div class=\"line\">A. NID　　B. PID　　C. UID　　D. CID</div><div class=\"line\">答案:B</div><div class=\"line\">2. 用vi打开一个文件，如何用字母&quot;new&quot;来代替字母&quot;old&quot; (   )</div><div class=\"line\">A. :s/old/new/g　　　B. :s/old/new　　C. :1,$s/old/new/g　　　D. :r/old/new</div><div class=\"line\">答案:A</div><div class=\"line\">3. 请选择对标准的变量PS2正确的描述(   )</div><div class=\"line\">A. 是一个主shell提示符变量　　　　B. 是一个一般的shell提示符变量</div><div class=\"line\">C. 是第二主shell提示符变量　　   D. 是一个连续提示符变量</div><div class=\"line\">答案:B</div><div class=\"line\">4. 哪一个命令能用来查找文件TESTFILE中只包含四个字符的行?(   )</div><div class=\"line\">A. grep &apos;^????$&apos; TESTFILE　　　　B. grep &apos;????&apos; TESTFILE</div><div class=\"line\">C. grep &apos;^....$&apos; TESTFILE　　　　　D. grep &apos;....&apos; TESTFILE</div><div class=\"line\">答案:C</div><div class=\"line\">5. 一个bash shell脚本的第一行是什么(   )</div><div class=\"line\">A. #!/bin/bash　　B. #/bin/bash　　C. #/bin/csh　　　D. /bin/bash</div><div class=\"line\">答案:A</div><div class=\"line\">6. 用标准的输出重定向(&gt;)像&quot;&gt; file01&quot;能使文件file01的数据（   ）</div><div class=\"line\">A. 被移动　　B. 被复制　　C. 被打印　　　D. 被覆盖</div><div class=\"line\">答案:D</div><div class=\"line\">7. 下面哪个命令是用来定义shell的全局变量(    )</div><div class=\"line\">A. exportfs　　B. alias　　C. exports　　D. export</div><div class=\"line\">答案:D</div><div class=\"line\">8. 如果想加载一个/dev/sdb1的windows95分区到/mnt/win95目录，需要运行哪个命令(   )</div><div class=\"line\">A. mount -t hpfs /dev/sdb1 /mnt/win95</div><div class=\"line\">B. mount -t hpfs /mnt/win95 /dev/sdb1</div><div class=\"line\">C. mount -t vfat /dev/sdb1 /mnt/win95</div><div class=\"line\">D. mount -t vfat /mnt/win95 /dev/sdb1</div><div class=\"line\">答案:C</div><div class=\"line\">9. 哪个文件存放用户密码信息(   )</div><div class=\"line\">A. /boot/passwd　　　B. /etc/shadow　　　C. /var/passwd　　D. /dev/passwd</div><div class=\"line\">答案:B</div><div class=\"line\">10. 假定kernel支持vfat分区，下面哪一个操作是将/dev/sda1，一个window98分区加载到/win目录(   )</div><div class=\"line\">A. mount -s win /dev&apos;sda1 /win</div><div class=\"line\">B. mount -fs=msdos /dev/sda1 /win</div><div class=\"line\">C. mount -t vfat /dev/sda1 /win</div><div class=\"line\">D. mount -t windows /win /dev/sda1</div><div class=\"line\">答案:C</div><div class=\"line\">11. 默认情况下管理员创建了一个用户，就会在(   )目录下创建一个用户主目录。</div><div class=\"line\">A. /usr　　B. /home　　　C. /root　　D. /etc</div><div class=\"line\">答案:B</div><div class=\"line\">12. 如果要列出一个目录下的所有文件需要使用命令行(    )。</div><div class=\"line\">A. ls –l　　B. ls　　　C. ls –a　　　D. ls -d</div><div class=\"line\">答案:C</div><div class=\"line\">13. 利用哪个工具可以设置用户在文件系统中的空间大小(   )。</div><div class=\"line\">A. turboservice　　B. turbofscfg　　C. turbonetcfg　　　D. turboxcfg</div><div class=\"line\">答案:B</div><div class=\"line\">14. 哪个命令可以将普通用户转换成超级用户(   )</div><div class=\"line\">A. super　　B. passwd　　C. tar　　　D. su</div><div class=\"line\">答案:D</div><div class=\"line\">15. 哪个命令用来显示/home及其子目录下文件名(   )</div><div class=\"line\">A. ls -R /home　　B. ls -d /home　　C. ls -a /home　　　　D. ls -l /home</div><div class=\"line\">答案:A</div><div class=\"line\">16. 在vi模式下，哪个命令用来删除光标处的字符(    )</div><div class=\"line\">A. xd　　　B. x　　　C. dd　　　D. d</div><div class=\"line\">答案:B　　dd删除一行,x删除当前字符</div><div class=\"line\">17. 在一行内运行多个命令需要用什么字符隔开(   )</div><div class=\"line\">A. @　　B. $　　　C. ;　　D. *</div><div class=\"line\">答案:C</div><div class=\"line\">18. 确定myfile的文件类型的命令是(   )</div><div class=\"line\">A. whatis myfile</div><div class=\"line\">B. file myfile</div><div class=\"line\">C. type myfile</div><div class=\"line\">D. type -q myfile</div><div class=\"line\">答案:B</div><div class=\"line\">19. 哪些命令组合起来能统计多少用户登录系统(    )</div><div class=\"line\">A. who | wc –w　　　B. who | wc –l　　　C. who | wc –c　　　D. who | wc</div><div class=\"line\">答案:BD</div><div class=\"line\">20. 用 &quot;rm -i&quot;,系统会提示什么来让你确认(   )</div><div class=\"line\">A. 命令行的每个选项　　B. 是否真的删除　　C. 是否有写的权限　　　D. 文件的位置</div><div class=\"line\">答案:B</div><div class=\"line\">21. Linux启动的第一个进程init启动的第一个脚本程序是(   )。</div><div class=\"line\">A. /etc/rc.d/init.d　　　B. /etc/rc.d/rc.sysinit　　C. /etc/rc.d/rc5.d　　D. /etc/rc.d/rc3.d</div><div class=\"line\">答案:B</div><div class=\"line\">22. 按下(   )键能终止当前运行的命令</div><div class=\"line\">A. Ctrl-C　　　B. Ctrl-F　　　C. Ctrl-B　　　D. Ctrl-D</div><div class=\"line\">答案:a</div><div class=\"line\">23. 用来分离目录名和文件名的字符是(   )</div><div class=\"line\">A. dash (-)　　B. slash (/)　　C. period (.)　　　D. asterisk（*）</div><div class=\"line\">答案:B</div><div class=\"line\">24. 系统的配置文件在(  )目录下</div><div class=\"line\">A. /home　　　B. /dev　　C. /etc　　　D. /usr</div><div class=\"line\">答案:C</div><div class=\"line\">25. 显示用户的主目录的命令是什么?(   )</div><div class=\"line\">A. echo $HOME　　B. echo $USERDIR　　　C. echo $ENV　　D. echo $ECHO</div><div class=\"line\">答案:A</div><div class=\"line\">26. 在vi编辑器里，哪个命令能将光标移到第200行(    )</div><div class=\"line\">A. g200　　B. G200　　C. :200　　　D. 200g</div><div class=\"line\">答案:C</div><div class=\"line\">:200可以，200G也可以</div><div class=\"line\">27. 用&quot;useradd jerry&quot;命令添加一个用户，这个用户的主目录是什么?(   )</div><div class=\"line\">A. /etc/jerry　　　B. /var/jerry　　C. /home/jerry　　　D. /bin/jerry</div><div class=\"line\">答案:C</div><div class=\"line\">28. 哪一个命令能用来删除当前目录及其子目录下名为&apos;core&apos;的文件(   )</div><div class=\"line\">A. find . -name core -exec rm &#123;&#125; \\ ;</div><div class=\"line\">B. find . -name core -exec rm ;</div><div class=\"line\">C. find . -name core -exec rm &#123;&#125; ;</div><div class=\"line\">D. find . -name core -exec rm &#123;&#125; -;</div><div class=\"line\">答案:A</div><div class=\"line\">29. 以下哪条命令在创建一个xp用户的时候将用户加入到root组中(  )</div><div class=\"line\">A. useradd -g xp root　　B. useradd -r root xp　　C. useradd -g root xp　　　D. useradd root xp</div><div class=\"line\">答案:C</div><div class=\"line\">30. 不改变运行级别而重新读入inittab文件的命令是(    )。</div><div class=\"line\">A. init s　　B. init q　　C. init S　　　D. init Q</div><div class=\"line\">答案:B</div><div class=\"line\">31. 以下哪个命令可以终止一个用户的所有进程(   )</div><div class=\"line\">A. skillall　　　B. skill　　C. kill　　　D. killall</div><div class=\"line\">答案:D</div><div class=\"line\">32. 通过修改哪个文件可以在创建用户的时候改变用　户主目录的路径(   )</div><div class=\"line\">A. /etc/default/passwd　　　B. /etc/default/useradd　　C. /etc/profile　　D. /etc/fstab</div><div class=\"line\">答案:B</div><div class=\"line\">33. 以只读方式打开一个文件并进入vi编辑器的命令是(   )</div><div class=\"line\">A. view -r filename　　　B. view filename　　　C. vi filename　　　D. vi -r filename</div><div class=\"line\">答案:B</div><div class=\"line\">34. 以下哪个命令是将缓存中的内容粘贴到光标之前(   )</div><div class=\"line\">A. a　　　B. i　　　C. P　　　D. p</div><div class=\"line\">答案:C</div><div class=\"line\">35. 以下哪条vi命令能将文档5-20行间出现的abc替换成为cba (   )</div><div class=\"line\">A. :1,$s/abc/cba/g　　　B. :5,20/abc/cba/g　　C. :5-20s/abc/cba/g　　　D. :5,20s/abc/cba/g</div><div class=\"line\">答案:D</div><div class=\"line\">. 在vi中通过哪条命令可以将ps命令执行的结果插入到文档中(   )</div><div class=\"line\">A. :r!ps　　　B. :!ps　　　C. :!rps　　　　D. :w!ps</div><div class=\"line\">答案:A</div><div class=\"line\">36. 以下哪个vi命令可以在当前位置插入/etc/passwd文本文件(   )</div><div class=\"line\">A. :r /etc/passwd　　　B. :i /etc/passwd　　C. :w /etc/passwd　　　D. :s /etc/passwd</div><div class=\"line\">答案:A</div><div class=\"line\">37. vi中复制整行的命令是(   )</div><div class=\"line\">A. y1　　　B. yy　　　C. ss　　　D. dd</div><div class=\"line\">答案:B</div><div class=\"line\">38. 以下哪个vi命令可以给文档的每行加上一个编号(    )</div><div class=\"line\">A. :e number　　　B. :set number　　C. :r!date 　　　　D. :200g</div><div class=\"line\">答案:B</div><div class=\"line\">38. 以下哪些文件只有根用户才能读写(   )</div><div class=\"line\">A. /etc/bashrc　　　B. /etc/profile　　　C. /etc/shadow　　　　D. /etc/passwd</div><div class=\"line\">答案:BC</div><div class=\"line\">39. 使用groupdel删除一个组的时候，命令执行失败，原因可能是(   )</div><div class=\"line\">A. 该组是系统组　　　B. 该组是空的　　　C. 该组中成员非空　　　D. 该组不存在</div><div class=\"line\">答案:CD</div><div class=\"line\">40. Linux中文件名构成的规则比较灵活表现在(   )</div><div class=\"line\">A. 文件名长度多达256个字符　　　　　B. 可以使用除了/符号外的所有ASCII字符</div><div class=\"line\">C. 不区分大小写　　　　　　　　　　　　D. 无扩展名限制</div><div class=\"line\">答案:ABD</div><div class=\"line\">41. 对用户的口令进行加解锁的命令是passwd,参数选项是(   )</div><div class=\"line\">A. –l　　B. –L　　C. –u　　　D. -U</div><div class=\"line\">答案:AC</div><div class=\"line\">42. 如果你对文件和目录的权限不确定，则不能用(   )命令来检测权限</div><div class=\"line\">A. ps　　　B. ck　　　　C. ls –l　　　D. chown</div><div class=\"line\">答案:ABD</div><div class=\"line\">43. 选择对/proc文件系统不正确的描述(    )</div><div class=\"line\">A. 通常情况下，不提供中断、IO端口、CPU等信息　　　B. /proc文件系统可以提供系统核心的许多参数</div><div class=\"line\">C. /proc是一个虚拟的文件系统　　　　　　　　　　　　D. 可以得到系统中运行的进程的一些信息</div><div class=\"line\">答案:A</div><div class=\"line\">44. 以下哪些符号可以用来连接多条命令(   )</div><div class=\"line\">A. ||　　　　B. &amp;&amp;　　　C. ;　　　D. |</div><div class=\"line\">答案:ABCD</div><div class=\"line\">45. 在shell中，下面哪些字符串当作普通字符串时候需要使用&quot;\\&quot;来转义(   )</div><div class=\"line\">A. 分号(;)　　　B. 双引号(&quot;)　　C. 单引号(&apos;)　　　D. 反斜杆(\\)</div><div class=\"line\">答案:BCD</div><div class=\"line\">46. Linux中提供了几个重要的工具用来改变服务和进程的运行状态和运行级别以及初始化进程，它们是(   )。</div><div class=\"line\">A. chkconfig　　B. service　　C. turboservice　　　D. ksysv</div><div class=\"line\">答案:ABCD</div><div class=\"line\">47. 在/etc/rc.d/init.d目录下的所有脚本至少支持两个运行参数,它们是(    )。</div><div class=\"line\">A. start　　　B. restart　　　　C. stop　　　D. reload</div><div class=\"line\">答案:AC</div><div class=\"line\">48. Linux一般被称为是稳定的服务器系统，它的安全性表现在(   )</div><div class=\"line\">A. 网络防火墙　　B. 用户管理策略　C. 系统、目录、文件的权限控制　D. 封闭源码便于及时修正漏洞等</div><div class=\"line\">答案:ABC</div><div class=\"line\">49. 在vi中下列哪些命令不能用来在光标前插入文本(   )</div><div class=\"line\">A. p [text]　　B. i [text]　　C. o [text]　　　D. a [text]</div><div class=\"line\">答案:ACD</div><div class=\"line\">50. 在本地的文件系统中下列哪些linux路径结构是无效的(   )</div><div class=\"line\">A. \\usr/zhang/memo　　　B. /usr/zhang/memo　　　C. //usr\\zhang/memo　　　D. \\usr\\zhang\\memo</div><div class=\"line\">答案:ACD</div><div class=\"line\"></div><div class=\"line\">二、简答题 （1题3分）</div><div class=\"line\"></div><div class=\"line\">1.常见的Linux发行版本都有什么？你最擅长哪一个？它的官网网站是什么？说明你擅长哪一块？</div><div class=\"line\"></div><div class=\"line\">2.Linux开机启动流程详细步骤是什么？系统安装完，忘记密码如何破解？</div><div class=\"line\"></div><div class=\"line\">4.某一天突然发现Linux系统文件只读，该怎么办呢？完整操作步骤。</div><div class=\"line\"></div><div class=\"line\">5.安装一台系统使用DVD光盘安装，如何安装50台Linux系统如何安装呢？思考一下。</div><div class=\"line\"></div><div class=\"line\">6.用虚拟机安装了一台Linux系统，突然想克隆一台服务器，克隆后发现无法上网，如何解决？</div><div class=\"line\"></div><div class=\"line\">7.Linux网卡配置文件路径是什么？要使服务器上外网，必须满足的条件有哪些？需要配置什么？</div><div class=\"line\"></div><div class=\"line\">8.一般可以使用什么软件远程linux服务器？通过什么上传文件和下载文件？</div><div class=\"line\"></div><div class=\"line\">9./mnt目录主要用于什么？/root目录跟root用户有什么关系？/根目录与/boot目录有什么联系？</div><div class=\"line\"></div><div class=\"line\">10.某一天误操作，执行了rm  -rf  * ，会有哪些情况发生？请举例。</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">三、 公有云题目 （1题5分）</div><div class=\"line\">1. 请解释上云的好处是什么？传统业务类型与公有云也为类型有什么区别？请举例说明。</div><div class=\"line\"></div><div class=\"line\">2. 列出你用过的阿里云\\AWS\\Azure服务？并讲述他们的作用？</div><div class=\"line\"></div><div class=\"line\">3. 请列出你觉得阿里云\\AWS\\Azure目前的特色和不成熟的地方是那些？你觉得应该如何改正。</div><div class=\"line\"></div><div class=\"line\">4. 请用阿里云\\AWS\\Azure设计一个视频网站的架构图并进行解释说明。</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div></pre></td><td class=\"code\"><pre><div class=\"line\">一. 选择题 （1题1分）</div><div class=\"line\">1. 当登录Linux时，一个具有唯一进程ID号的shell将被调用，这个ID是什么(   )</div><div class=\"line\">A. NID　　B. PID　　C. UID　　D. CID</div><div class=\"line\">答案:B</div><div class=\"line\">2. 用vi打开一个文件，如何用字母&quot;new&quot;来代替字母&quot;old&quot; (   )</div><div class=\"line\">A. :s/old/new/g　　　B. :s/old/new　　C. :1,$s/old/new/g　　　D. :r/old/new</div><div class=\"line\">答案:A</div><div class=\"line\">3. 请选择对标准的变量PS2正确的描述(   )</div><div class=\"line\">A. 是一个主shell提示符变量　　　　B. 是一个一般的shell提示符变量</div><div class=\"line\">C. 是第二主shell提示符变量　　   D. 是一个连续提示符变量</div><div class=\"line\">答案:B</div><div class=\"line\">4. 哪一个命令能用来查找文件TESTFILE中只包含四个字符的行?(   )</div><div class=\"line\">A. grep &apos;^????$&apos; TESTFILE　　　　B. grep &apos;????&apos; TESTFILE</div><div class=\"line\">C. grep &apos;^....$&apos; TESTFILE　　　　　D. grep &apos;....&apos; TESTFILE</div><div class=\"line\">答案:C</div><div class=\"line\">5. 一个bash shell脚本的第一行是什么(   )</div><div class=\"line\">A. #!/bin/bash　　B. #/bin/bash　　C. #/bin/csh　　　D. /bin/bash</div><div class=\"line\">答案:A</div><div class=\"line\">6. 用标准的输出重定向(&gt;)像&quot;&gt; file01&quot;能使文件file01的数据（   ）</div><div class=\"line\">A. 被移动　　B. 被复制　　C. 被打印　　　D. 被覆盖</div><div class=\"line\">答案:D</div><div class=\"line\">7. 下面哪个命令是用来定义shell的全局变量(    )</div><div class=\"line\">A. exportfs　　B. alias　　C. exports　　D. export</div><div class=\"line\">答案:D</div><div class=\"line\">8. 如果想加载一个/dev/sdb1的windows95分区到/mnt/win95目录，需要运行哪个命令(   )</div><div class=\"line\">A. mount -t hpfs /dev/sdb1 /mnt/win95</div><div class=\"line\">B. mount -t hpfs /mnt/win95 /dev/sdb1</div><div class=\"line\">C. mount -t vfat /dev/sdb1 /mnt/win95</div><div class=\"line\">D. mount -t vfat /mnt/win95 /dev/sdb1</div><div class=\"line\">答案:C</div><div class=\"line\">9. 哪个文件存放用户密码信息(   )</div><div class=\"line\">A. /boot/passwd　　　B. /etc/shadow　　　C. /var/passwd　　D. /dev/passwd</div><div class=\"line\">答案:B</div><div class=\"line\">10. 假定kernel支持vfat分区，下面哪一个操作是将/dev/sda1，一个window98分区加载到/win目录(   )</div><div class=\"line\">A. mount -s win /dev&apos;sda1 /win</div><div class=\"line\">B. mount -fs=msdos /dev/sda1 /win</div><div class=\"line\">C. mount -t vfat /dev/sda1 /win</div><div class=\"line\">D. mount -t windows /win /dev/sda1</div><div class=\"line\">答案:C</div><div class=\"line\">11. 默认情况下管理员创建了一个用户，就会在(   )目录下创建一个用户主目录。</div><div class=\"line\">A. /usr　　B. /home　　　C. /root　　D. /etc</div><div class=\"line\">答案:B</div><div class=\"line\">12. 如果要列出一个目录下的所有文件需要使用命令行(    )。</div><div class=\"line\">A. ls –l　　B. ls　　　C. ls –a　　　D. ls -d</div><div class=\"line\">答案:C</div><div class=\"line\">13. 利用哪个工具可以设置用户在文件系统中的空间大小(   )。</div><div class=\"line\">A. turboservice　　B. turbofscfg　　C. turbonetcfg　　　D. turboxcfg</div><div class=\"line\">答案:B</div><div class=\"line\">14. 哪个命令可以将普通用户转换成超级用户(   )</div><div class=\"line\">A. super　　B. passwd　　C. tar　　　D. su</div><div class=\"line\">答案:D</div><div class=\"line\">15. 哪个命令用来显示/home及其子目录下文件名(   )</div><div class=\"line\">A. ls -R /home　　B. ls -d /home　　C. ls -a /home　　　　D. ls -l /home</div><div class=\"line\">答案:A</div><div class=\"line\">16. 在vi模式下，哪个命令用来删除光标处的字符(    )</div><div class=\"line\">A. xd　　　B. x　　　C. dd　　　D. d</div><div class=\"line\">答案:B　　dd删除一行,x删除当前字符</div><div class=\"line\">17. 在一行内运行多个命令需要用什么字符隔开(   )</div><div class=\"line\">A. @　　B. $　　　C. ;　　D. *</div><div class=\"line\">答案:C</div><div class=\"line\">18. 确定myfile的文件类型的命令是(   )</div><div class=\"line\">A. whatis myfile</div><div class=\"line\">B. file myfile</div><div class=\"line\">C. type myfile</div><div class=\"line\">D. type -q myfile</div><div class=\"line\">答案:B</div><div class=\"line\">19. 哪些命令组合起来能统计多少用户登录系统(    )</div><div class=\"line\">A. who | wc –w　　　B. who | wc –l　　　C. who | wc –c　　　D. who | wc</div><div class=\"line\">答案:BD</div><div class=\"line\">20. 用 &quot;rm -i&quot;,系统会提示什么来让你确认(   )</div><div class=\"line\">A. 命令行的每个选项　　B. 是否真的删除　　C. 是否有写的权限　　　D. 文件的位置</div><div class=\"line\">答案:B</div><div class=\"line\">21. Linux启动的第一个进程init启动的第一个脚本程序是(   )。</div><div class=\"line\">A. /etc/rc.d/init.d　　　B. /etc/rc.d/rc.sysinit　　C. /etc/rc.d/rc5.d　　D. /etc/rc.d/rc3.d</div><div class=\"line\">答案:B</div><div class=\"line\">22. 按下(   )键能终止当前运行的命令</div><div class=\"line\">A. Ctrl-C　　　B. Ctrl-F　　　C. Ctrl-B　　　D. Ctrl-D</div><div class=\"line\">答案:a</div><div class=\"line\">23. 用来分离目录名和文件名的字符是(   )</div><div class=\"line\">A. dash (-)　　B. slash (/)　　C. period (.)　　　D. asterisk（*）</div><div class=\"line\">答案:B</div><div class=\"line\">24. 系统的配置文件在(  )目录下</div><div class=\"line\">A. /home　　　B. /dev　　C. /etc　　　D. /usr</div><div class=\"line\">答案:C</div><div class=\"line\">25. 显示用户的主目录的命令是什么?(   )</div><div class=\"line\">A. echo $HOME　　B. echo $USERDIR　　　C. echo $ENV　　D. echo $ECHO</div><div class=\"line\">答案:A</div><div class=\"line\">26. 在vi编辑器里，哪个命令能将光标移到第200行(    )</div><div class=\"line\">A. g200　　B. G200　　C. :200　　　D. 200g</div><div class=\"line\">答案:C</div><div class=\"line\">:200可以，200G也可以</div><div class=\"line\">27. 用&quot;useradd jerry&quot;命令添加一个用户，这个用户的主目录是什么?(   )</div><div class=\"line\">A. /etc/jerry　　　B. /var/jerry　　C. /home/jerry　　　D. /bin/jerry</div><div class=\"line\">答案:C</div><div class=\"line\">28. 哪一个命令能用来删除当前目录及其子目录下名为&apos;core&apos;的文件(   )</div><div class=\"line\">A. find . -name core -exec rm &#123;&#125; \\ ;</div><div class=\"line\">B. find . -name core -exec rm ;</div><div class=\"line\">C. find . -name core -exec rm &#123;&#125; ;</div><div class=\"line\">D. find . -name core -exec rm &#123;&#125; -;</div><div class=\"line\">答案:A</div><div class=\"line\">29. 以下哪条命令在创建一个xp用户的时候将用户加入到root组中(  )</div><div class=\"line\">A. useradd -g xp root　　B. useradd -r root xp　　C. useradd -g root xp　　　D. useradd root xp</div><div class=\"line\">答案:C</div><div class=\"line\">30. 不改变运行级别而重新读入inittab文件的命令是(    )。</div><div class=\"line\">A. init s　　B. init q　　C. init S　　　D. init Q</div><div class=\"line\">答案:B</div><div class=\"line\">31. 以下哪个命令可以终止一个用户的所有进程(   )</div><div class=\"line\">A. skillall　　　B. skill　　C. kill　　　D. killall</div><div class=\"line\">答案:D</div><div class=\"line\">32. 通过修改哪个文件可以在创建用户的时候改变用　户主目录的路径(   )</div><div class=\"line\">A. /etc/default/passwd　　　B. /etc/default/useradd　　C. /etc/profile　　D. /etc/fstab</div><div class=\"line\">答案:B</div><div class=\"line\">33. 以只读方式打开一个文件并进入vi编辑器的命令是(   )</div><div class=\"line\">A. view -r filename　　　B. view filename　　　C. vi filename　　　D. vi -r filename</div><div class=\"line\">答案:B</div><div class=\"line\">34. 以下哪个命令是将缓存中的内容粘贴到光标之前(   )</div><div class=\"line\">A. a　　　B. i　　　C. P　　　D. p</div><div class=\"line\">答案:C</div><div class=\"line\">35. 以下哪条vi命令能将文档5-20行间出现的abc替换成为cba (   )</div><div class=\"line\">A. :1,$s/abc/cba/g　　　B. :5,20/abc/cba/g　　C. :5-20s/abc/cba/g　　　D. :5,20s/abc/cba/g</div><div class=\"line\">答案:D</div><div class=\"line\">. 在vi中通过哪条命令可以将ps命令执行的结果插入到文档中(   )</div><div class=\"line\">A. :r!ps　　　B. :!ps　　　C. :!rps　　　　D. :w!ps</div><div class=\"line\">答案:A</div><div class=\"line\">36. 以下哪个vi命令可以在当前位置插入/etc/passwd文本文件(   )</div><div class=\"line\">A. :r /etc/passwd　　　B. :i /etc/passwd　　C. :w /etc/passwd　　　D. :s /etc/passwd</div><div class=\"line\">答案:A</div><div class=\"line\">37. vi中复制整行的命令是(   )</div><div class=\"line\">A. y1　　　B. yy　　　C. ss　　　D. dd</div><div class=\"line\">答案:B</div><div class=\"line\">38. 以下哪个vi命令可以给文档的每行加上一个编号(    )</div><div class=\"line\">A. :e number　　　B. :set number　　C. :r!date 　　　　D. :200g</div><div class=\"line\">答案:B</div><div class=\"line\">38. 以下哪些文件只有根用户才能读写(   )</div><div class=\"line\">A. /etc/bashrc　　　B. /etc/profile　　　C. /etc/shadow　　　　D. /etc/passwd</div><div class=\"line\">答案:BC</div><div class=\"line\">39. 使用groupdel删除一个组的时候，命令执行失败，原因可能是(   )</div><div class=\"line\">A. 该组是系统组　　　B. 该组是空的　　　C. 该组中成员非空　　　D. 该组不存在</div><div class=\"line\">答案:CD</div><div class=\"line\">40. Linux中文件名构成的规则比较灵活表现在(   )</div><div class=\"line\">A. 文件名长度多达256个字符　　　　　B. 可以使用除了/符号外的所有ASCII字符</div><div class=\"line\">C. 不区分大小写　　　　　　　　　　　　D. 无扩展名限制</div><div class=\"line\">答案:ABD</div><div class=\"line\">41. 对用户的口令进行加解锁的命令是passwd,参数选项是(   )</div><div class=\"line\">A. –l　　B. –L　　C. –u　　　D. -U</div><div class=\"line\">答案:AC</div><div class=\"line\">42. 如果你对文件和目录的权限不确定，则不能用(   )命令来检测权限</div><div class=\"line\">A. ps　　　B. ck　　　　C. ls –l　　　D. chown</div><div class=\"line\">答案:ABD</div><div class=\"line\">43. 选择对/proc文件系统不正确的描述(    )</div><div class=\"line\">A. 通常情况下，不提供中断、IO端口、CPU等信息　　　B. /proc文件系统可以提供系统核心的许多参数</div><div class=\"line\">C. /proc是一个虚拟的文件系统　　　　　　　　　　　　D. 可以得到系统中运行的进程的一些信息</div><div class=\"line\">答案:A</div><div class=\"line\">44. 以下哪些符号可以用来连接多条命令(   )</div><div class=\"line\">A. ||　　　　B. &amp;&amp;　　　C. ;　　　D. |</div><div class=\"line\">答案:ABCD</div><div class=\"line\">45. 在shell中，下面哪些字符串当作普通字符串时候需要使用&quot;\\&quot;来转义(   )</div><div class=\"line\">A. 分号(;)　　　B. 双引号(&quot;)　　C. 单引号(&apos;)　　　D. 反斜杆(\\)</div><div class=\"line\">答案:BCD</div><div class=\"line\">46. Linux中提供了几个重要的工具用来改变服务和进程的运行状态和运行级别以及初始化进程，它们是(   )。</div><div class=\"line\">A. chkconfig　　B. service　　C. turboservice　　　D. ksysv</div><div class=\"line\">答案:ABCD</div><div class=\"line\">47. 在/etc/rc.d/init.d目录下的所有脚本至少支持两个运行参数,它们是(    )。</div><div class=\"line\">A. start　　　B. restart　　　　C. stop　　　D. reload</div><div class=\"line\">答案:AC</div><div class=\"line\">48. Linux一般被称为是稳定的服务器系统，它的安全性表现在(   )</div><div class=\"line\">A. 网络防火墙　　B. 用户管理策略　C. 系统、目录、文件的权限控制　D. 封闭源码便于及时修正漏洞等</div><div class=\"line\">答案:ABC</div><div class=\"line\">49. 在vi中下列哪些命令不能用来在光标前插入文本(   )</div><div class=\"line\">A. p [text]　　B. i [text]　　C. o [text]　　　D. a [text]</div><div class=\"line\">答案:ACD</div><div class=\"line\">50. 在本地的文件系统中下列哪些linux路径结构是无效的(   )</div><div class=\"line\">A. \\usr/zhang/memo　　　B. /usr/zhang/memo　　　C. //usr\\zhang/memo　　　D. \\usr\\zhang\\memo</div><div class=\"line\">答案:ACD</div><div class=\"line\"></div><div class=\"line\">二、简答题 （1题3分）</div><div class=\"line\"></div><div class=\"line\">1.常见的Linux发行版本都有什么？你最擅长哪一个？它的官网网站是什么？说明你擅长哪一块？</div><div class=\"line\"></div><div class=\"line\">2.Linux开机启动流程详细步骤是什么？系统安装完，忘记密码如何破解？</div><div class=\"line\"></div><div class=\"line\">4.某一天突然发现Linux系统文件只读，该怎么办呢？完整操作步骤。</div><div class=\"line\"></div><div class=\"line\">5.安装一台系统使用DVD光盘安装，如何安装50台Linux系统如何安装呢？思考一下。</div><div class=\"line\"></div><div class=\"line\">6.用虚拟机安装了一台Linux系统，突然想克隆一台服务器，克隆后发现无法上网，如何解决？</div><div class=\"line\"></div><div class=\"line\">7.Linux网卡配置文件路径是什么？要使服务器上外网，必须满足的条件有哪些？需要配置什么？</div><div class=\"line\"></div><div class=\"line\">8.一般可以使用什么软件远程linux服务器？通过什么上传文件和下载文件？</div><div class=\"line\"></div><div class=\"line\">9./mnt目录主要用于什么？/root目录跟root用户有什么关系？/根目录与/boot目录有什么联系？</div><div class=\"line\"></div><div class=\"line\">10.某一天误操作，执行了rm  -rf  * ，会有哪些情况发生？请举例。</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">三、 公有云题目 （1题5分）</div><div class=\"line\">1. 请解释上云的好处是什么？传统业务类型与公有云也为类型有什么区别？请举例说明。</div><div class=\"line\"></div><div class=\"line\">2. 列出你用过的阿里云\\AWS\\Azure服务？并讲述他们的作用？</div><div class=\"line\"></div><div class=\"line\">3. 请列出你觉得阿里云\\AWS\\Azure目前的特色和不成熟的地方是那些？你觉得应该如何改正。</div><div class=\"line\"></div><div class=\"line\">4. 请用阿里云\\AWS\\Azure设计一个视频网站的架构图并进行解释说明。</div></pre></td></tr></table></figure>\n"},{"title":"Mac(1) 调整Launchpad图标大小","id":"27","updated":"2017-04-21T05:36:59.000Z","date":"2016-04-08T21:46:04.000Z","_content":"\n很多人觉得默认Launchpad的应用程序图标很大，空间比较拥挤，不过这个其实是可以通过调整Launchpad每一行和每一列图标的数量，来调整Launchpad图标大小。\n\n默认如下图：\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-1.jpg)\n\n代码块：\n\n```\n# 调整每一行显示数量为8个。\n➜ defaults write com.apple.dock springboard-columns -int 10\n\n＃ 重启Launchpad\n➜ defaults write com.apple.dock ResetLaunchPad -bool TRUE;killall Dock\n```\n\n修改后如下：\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-2.jpg)\n","source":"_posts/Mac-1-调整Launchpad图标大小.md","raw":"---\ntitle: Mac(1) 调整Launchpad图标大小\ntags: 'Mac'\ncategories: 'Mac'\npermalink: macxi-tong-diao-zheng-launchpadtu-biao-da-xiao\nid: 27\nupdated: '2017-04-21 13:36:59'\ndate: 2016-04-09 05:46:04\n---\n\n很多人觉得默认Launchpad的应用程序图标很大，空间比较拥挤，不过这个其实是可以通过调整Launchpad每一行和每一列图标的数量，来调整Launchpad图标大小。\n\n默认如下图：\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-1.jpg)\n\n代码块：\n\n```\n# 调整每一行显示数量为8个。\n➜ defaults write com.apple.dock springboard-columns -int 10\n\n＃ 重启Launchpad\n➜ defaults write com.apple.dock ResetLaunchPad -bool TRUE;killall Dock\n```\n\n修改后如下：\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-2.jpg)\n","slug":"macxi-tong-diao-zheng-launchpadtu-biao-da-xiao","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqat004i41tp8qivpnns","content":"<p>很多人觉得默认Launchpad的应用程序图标很大，空间比较拥挤，不过这个其实是可以通过调整Launchpad每一行和每一列图标的数量，来调整Launchpad图标大小。</p>\n<p>默认如下图：<br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-1.jpg\" alt=\"\"></p>\n<p>代码块：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 调整每一行显示数量为8个。</div><div class=\"line\">➜ defaults write com.apple.dock springboard-columns -int 10</div><div class=\"line\"></div><div class=\"line\">＃ 重启Launchpad</div><div class=\"line\">➜ defaults write com.apple.dock ResetLaunchPad -bool TRUE;killall Dock</div></pre></td></tr></table></figure>\n<p>修改后如下：<br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-2.jpg\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>很多人觉得默认Launchpad的应用程序图标很大，空间比较拥挤，不过这个其实是可以通过调整Launchpad每一行和每一列图标的数量，来调整Launchpad图标大小。</p>\n<p>默认如下图：<br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-1.jpg\" alt=\"\"></p>\n<p>代码块：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 调整每一行显示数量为8个。</div><div class=\"line\">➜ defaults write com.apple.dock springboard-columns -int 10</div><div class=\"line\"></div><div class=\"line\">＃ 重启Launchpad</div><div class=\"line\">➜ defaults write com.apple.dock ResetLaunchPad -bool TRUE;killall Dock</div></pre></td></tr></table></figure>\n<p>修改后如下：<br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-2.jpg\" alt=\"\"></p>\n"},{"title":"Mac(2) 解决oh-my-zsh在终端下打开缓慢","id":"26","updated":"2017-04-21T05:37:19.000Z","date":"2016-04-08T08:12:30.000Z","_content":"\n升级Mac OS X 10.11 之后，使用CleanMyMac 3清理9GB的垃圾文件，之后导致打开iTerm时加载主机名特别的慢，Mac的命令行工具我使用的是iTerm＋ohmyzsh，这个问题困扰了我快两个月，工作比较忙，所以一直用Zoc 代替，也没有认真的研究，最近有需求用到它，实在不行，研究一下，发现，是因为我清理系统的时候把终端日志的索引文件清理掉了，所以每次打开的时候都要先加载索引导致了首次开启非常慢，解决办法是，只要把终端缓存的日志文件删除即可：\n\n代码块：\n\n```\n# 日志文件路径\n# /private/var/log/asl/*.asl\n\n➜  ~ sudo du -sh /private/var/log/asl/\nPassword:\n2.7G\t/private/var/log/asl/\n\n➜  ~ sudo rm -rf /private/var/log/asl/*.asl\n➜  ~ sudo du -sh /private/var/log/asl/\n208M\t/private/var/log/asl/\n\n```\n\n关闭终端，再次打开，问题解决。\n","source":"_posts/Mac-2-解决oh-my-zsh在终端下打开缓慢.md","raw":"---\ntitle: Mac(2) 解决oh-my-zsh在终端下打开缓慢\ntags: 'Mac'\ncategories: 'Mac'\npermalink: zsh-bug01\nid: 26\nupdated: '2017-04-21 13:37:19'\ndate: 2016-04-08 16:12:30\n---\n\n升级Mac OS X 10.11 之后，使用CleanMyMac 3清理9GB的垃圾文件，之后导致打开iTerm时加载主机名特别的慢，Mac的命令行工具我使用的是iTerm＋ohmyzsh，这个问题困扰了我快两个月，工作比较忙，所以一直用Zoc 代替，也没有认真的研究，最近有需求用到它，实在不行，研究一下，发现，是因为我清理系统的时候把终端日志的索引文件清理掉了，所以每次打开的时候都要先加载索引导致了首次开启非常慢，解决办法是，只要把终端缓存的日志文件删除即可：\n\n代码块：\n\n```\n# 日志文件路径\n# /private/var/log/asl/*.asl\n\n➜  ~ sudo du -sh /private/var/log/asl/\nPassword:\n2.7G\t/private/var/log/asl/\n\n➜  ~ sudo rm -rf /private/var/log/asl/*.asl\n➜  ~ sudo du -sh /private/var/log/asl/\n208M\t/private/var/log/asl/\n\n```\n\n关闭终端，再次打开，问题解决。\n","slug":"zsh-bug01","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqax004m41tpuxcydbe5","content":"<p>升级Mac OS X 10.11 之后，使用CleanMyMac 3清理9GB的垃圾文件，之后导致打开iTerm时加载主机名特别的慢，Mac的命令行工具我使用的是iTerm＋ohmyzsh，这个问题困扰了我快两个月，工作比较忙，所以一直用Zoc 代替，也没有认真的研究，最近有需求用到它，实在不行，研究一下，发现，是因为我清理系统的时候把终端日志的索引文件清理掉了，所以每次打开的时候都要先加载索引导致了首次开启非常慢，解决办法是，只要把终端缓存的日志文件删除即可：</p>\n<p>代码块：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 日志文件路径</div><div class=\"line\"># /private/var/log/asl/*.asl</div><div class=\"line\"></div><div class=\"line\">➜  ~ sudo du -sh /private/var/log/asl/</div><div class=\"line\">Password:</div><div class=\"line\">2.7G\t/private/var/log/asl/</div><div class=\"line\"></div><div class=\"line\">➜  ~ sudo rm -rf /private/var/log/asl/*.asl</div><div class=\"line\">➜  ~ sudo du -sh /private/var/log/asl/</div><div class=\"line\">208M\t/private/var/log/asl/</div></pre></td></tr></table></figure>\n<p>关闭终端，再次打开，问题解决。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>升级Mac OS X 10.11 之后，使用CleanMyMac 3清理9GB的垃圾文件，之后导致打开iTerm时加载主机名特别的慢，Mac的命令行工具我使用的是iTerm＋ohmyzsh，这个问题困扰了我快两个月，工作比较忙，所以一直用Zoc 代替，也没有认真的研究，最近有需求用到它，实在不行，研究一下，发现，是因为我清理系统的时候把终端日志的索引文件清理掉了，所以每次打开的时候都要先加载索引导致了首次开启非常慢，解决办法是，只要把终端缓存的日志文件删除即可：</p>\n<p>代码块：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 日志文件路径</div><div class=\"line\"># /private/var/log/asl/*.asl</div><div class=\"line\"></div><div class=\"line\">➜  ~ sudo du -sh /private/var/log/asl/</div><div class=\"line\">Password:</div><div class=\"line\">2.7G\t/private/var/log/asl/</div><div class=\"line\"></div><div class=\"line\">➜  ~ sudo rm -rf /private/var/log/asl/*.asl</div><div class=\"line\">➜  ~ sudo du -sh /private/var/log/asl/</div><div class=\"line\">208M\t/private/var/log/asl/</div></pre></td></tr></table></figure>\n<p>关闭终端，再次打开，问题解决。</p>\n"},{"title":"MacTips：使用命令关闭和启动AirPort","id":"141","updated":"2017-04-21T05:15:00.000Z","date":"2017-02-27T15:40:29.000Z","_content":"\n今天在给妹妹调试新的MacBookAir 13’时遇到一个问题，无法检测到她家的WiFi，一开始怀疑是不是无线路由器长时间未重启导致，所以重启了路由器，但是问题依然没有解决，于是我们将问题转向排查设备，因我们基本正好有iPad，iPhone，MacBook这些设备，发现唯独他的这个Macbook无法识别WiFi，后来在Google的帮助下，发现多个版本的Mac OS X都出现了类似的问题，可以通过重启AirPort解决问题，但是AirPort在System Preferences找不到选项，所以需要使用命令行来重启。\n\n##### **查看网络接口**\n```\nifconfig\nen0: flags=8863<UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST> mtu 1500\n\tether 60:f8:1d:ad:85:76\n\tinet6 fe80::18a9:fa23:b02f:5d8a%en0 prefixlen 64 secured scopeid 0x4\n\tinet 192.168.199.200 netmask 0xffffff00 broadcast 192.168.199.255\n\tnd6 options=201<PERFORMNUD,DAD>\n\tmedia: autoselect\n\tstatus: active\n```\n##### **关闭AirPort**\n有时候设备的名称是en0、en1这样，所以，可以用过设备名称来重启airport，例如en0\n```\nnetworksetup -setairportpower en0 off\n```\n\n##### **查看状态**\n```\nnetworksetup -getairportpower en0\n```\n\n##### **关闭AirPort**\n```\nnetworksetup -setairportpower en0 on\n```\n","source":"_posts/MacTips：使用命令关闭和启动AirPort.md","raw":"---\ntitle: MacTips：使用命令关闭和启动AirPort\ntags: 'Mac'\ncategories: 'Mac'\npermalink: command-disable-airport\nid: 141\nupdated: '2017-04-21 13:15:00'\ndate: 2017-02-27 23:40:29\n---\n\n今天在给妹妹调试新的MacBookAir 13’时遇到一个问题，无法检测到她家的WiFi，一开始怀疑是不是无线路由器长时间未重启导致，所以重启了路由器，但是问题依然没有解决，于是我们将问题转向排查设备，因我们基本正好有iPad，iPhone，MacBook这些设备，发现唯独他的这个Macbook无法识别WiFi，后来在Google的帮助下，发现多个版本的Mac OS X都出现了类似的问题，可以通过重启AirPort解决问题，但是AirPort在System Preferences找不到选项，所以需要使用命令行来重启。\n\n##### **查看网络接口**\n```\nifconfig\nen0: flags=8863<UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST> mtu 1500\n\tether 60:f8:1d:ad:85:76\n\tinet6 fe80::18a9:fa23:b02f:5d8a%en0 prefixlen 64 secured scopeid 0x4\n\tinet 192.168.199.200 netmask 0xffffff00 broadcast 192.168.199.255\n\tnd6 options=201<PERFORMNUD,DAD>\n\tmedia: autoselect\n\tstatus: active\n```\n##### **关闭AirPort**\n有时候设备的名称是en0、en1这样，所以，可以用过设备名称来重启airport，例如en0\n```\nnetworksetup -setairportpower en0 off\n```\n\n##### **查看状态**\n```\nnetworksetup -getairportpower en0\n```\n\n##### **关闭AirPort**\n```\nnetworksetup -setairportpower en0 on\n```\n","slug":"command-disable-airport","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqb0004p41tpo7pq8qat","content":"<p>今天在给妹妹调试新的MacBookAir 13’时遇到一个问题，无法检测到她家的WiFi，一开始怀疑是不是无线路由器长时间未重启导致，所以重启了路由器，但是问题依然没有解决，于是我们将问题转向排查设备，因我们基本正好有iPad，iPhone，MacBook这些设备，发现唯独他的这个Macbook无法识别WiFi，后来在Google的帮助下，发现多个版本的Mac OS X都出现了类似的问题，可以通过重启AirPort解决问题，但是AirPort在System Preferences找不到选项，所以需要使用命令行来重启。</p>\n<h5 id=\"查看网络接口\"><a href=\"#查看网络接口\" class=\"headerlink\" title=\"查看网络接口\"></a><strong>查看网络接口</strong></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">ifconfig</div><div class=\"line\">en0: flags=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500</div><div class=\"line\">\tether 60:f8:1d:ad:85:76</div><div class=\"line\">\tinet6 fe80::18a9:fa23:b02f:5d8a%en0 prefixlen 64 secured scopeid 0x4</div><div class=\"line\">\tinet 192.168.199.200 netmask 0xffffff00 broadcast 192.168.199.255</div><div class=\"line\">\tnd6 options=201&lt;PERFORMNUD,DAD&gt;</div><div class=\"line\">\tmedia: autoselect</div><div class=\"line\">\tstatus: active</div></pre></td></tr></table></figure>\n<h5 id=\"关闭AirPort\"><a href=\"#关闭AirPort\" class=\"headerlink\" title=\"关闭AirPort\"></a><strong>关闭AirPort</strong></h5><p>有时候设备的名称是en0、en1这样，所以，可以用过设备名称来重启airport，例如en0<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">networksetup -setairportpower en0 off</div></pre></td></tr></table></figure></p>\n<h5 id=\"查看状态\"><a href=\"#查看状态\" class=\"headerlink\" title=\"查看状态\"></a><strong>查看状态</strong></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">networksetup -getairportpower en0</div></pre></td></tr></table></figure>\n<h5 id=\"关闭AirPort-1\"><a href=\"#关闭AirPort-1\" class=\"headerlink\" title=\"关闭AirPort\"></a><strong>关闭AirPort</strong></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">networksetup -setairportpower en0 on</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>今天在给妹妹调试新的MacBookAir 13’时遇到一个问题，无法检测到她家的WiFi，一开始怀疑是不是无线路由器长时间未重启导致，所以重启了路由器，但是问题依然没有解决，于是我们将问题转向排查设备，因我们基本正好有iPad，iPhone，MacBook这些设备，发现唯独他的这个Macbook无法识别WiFi，后来在Google的帮助下，发现多个版本的Mac OS X都出现了类似的问题，可以通过重启AirPort解决问题，但是AirPort在System Preferences找不到选项，所以需要使用命令行来重启。</p>\n<h5 id=\"查看网络接口\"><a href=\"#查看网络接口\" class=\"headerlink\" title=\"查看网络接口\"></a><strong>查看网络接口</strong></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">ifconfig</div><div class=\"line\">en0: flags=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500</div><div class=\"line\">\tether 60:f8:1d:ad:85:76</div><div class=\"line\">\tinet6 fe80::18a9:fa23:b02f:5d8a%en0 prefixlen 64 secured scopeid 0x4</div><div class=\"line\">\tinet 192.168.199.200 netmask 0xffffff00 broadcast 192.168.199.255</div><div class=\"line\">\tnd6 options=201&lt;PERFORMNUD,DAD&gt;</div><div class=\"line\">\tmedia: autoselect</div><div class=\"line\">\tstatus: active</div></pre></td></tr></table></figure>\n<h5 id=\"关闭AirPort\"><a href=\"#关闭AirPort\" class=\"headerlink\" title=\"关闭AirPort\"></a><strong>关闭AirPort</strong></h5><p>有时候设备的名称是en0、en1这样，所以，可以用过设备名称来重启airport，例如en0<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">networksetup -setairportpower en0 off</div></pre></td></tr></table></figure></p>\n<h5 id=\"查看状态\"><a href=\"#查看状态\" class=\"headerlink\" title=\"查看状态\"></a><strong>查看状态</strong></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">networksetup -getairportpower en0</div></pre></td></tr></table></figure>\n<h5 id=\"关闭AirPort-1\"><a href=\"#关闭AirPort-1\" class=\"headerlink\" title=\"关闭AirPort\"></a><strong>关闭AirPort</strong></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">networksetup -setairportpower en0 on</div></pre></td></tr></table></figure>\n"},{"title":"Manage Tomcat Service Use Shell Script","id":"72","updated":"2017-04-21T05:25:16.000Z","date":"2016-07-26T18:18:24.000Z","_content":"\n#### Tomcat 项目管理交互式脚本.\n\n* Install pssh\n* Use Key Login Server Hosts\n* ~/.ssh/config 配置使用host名登录服务\n*  指定 Server Group Files 存放位置\n\n```\n\n#!/bin/bash\n\n# Author Alex LU\n# Date 2016-07-20\n# Version 1.0\n\n# HostFile\nHostDIR=~/.ssh/host/\n\n# war包上传到该目录\n# /warfolder\n\n:'\njobs_select (){\n    STRING=``cat $vmname | grep group\n    if [ -z \"$STRING\" ]\n    then\n        job_tomcat\n    else\n        job2_tomcat\n    fi\n}\n'\n\nfunction HOST()\n{\n    echo \"\"\n    echo \"############ Host List ###############\"\n    echo \"ckgroup:ck01,ck02,ck03,ck04\"\n    echo \"sjgroup:sj01,sj02,sj03,sj04\"\n    echo \"ddgroup:dd01,dd02,dd03,dd04\"\n    echo \"htgroup:ht01,ht02\"\n    echo \"othergroup:report,tg\"\n    echo \"######################################\"\n    echo \"\"\n    echo \" Tips: 如果要选择ck01，则输入ck01即可，如果输入ck组，输入ckgroup即可,如果要退出当前脚本输入exit\"\n    echo \" Tips: 退回上一步请输入back\"\n    read -p \"请输入你的选择:\" vmname\n\n    case \"$vmname\" in\n        ck01|ck02|ck03|ck04|sj01|sj02|sj03|sj04|dd01|dd02|dd03|dd04|report|tg|ht01|ht02)\n            job_tomcat $vmname\n            ;;\n        ckgroup|sjgroup|htgroup|ddgroup|othergroup)\n            job2_tomcat $vmname\n            ;;\n        exit)\n            exit 0;\n            ;;\n        back)\n            clear\n            echo \"\"\n            echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n            main\n            ;;\n        *)\n            echo \"请输入的选择!\"\n            HOST\n            ;;\n    esac\n}\n\nfunction job_tomcat ()\n{\n    echo \"\"\n    echo \"############ 动作 ###############\"\n    echo \"  1. 查看当前tomcat7状态\"\n    echo \"  2. 关闭tomcat7\"\n    echo \"  3. 启动tomcat7\"\n    echo \"  4. 重启tomcat7\"\n    echo \"  5. 获取最近200行日志\"\n    echo \"  6. 重新选择主机\"\n    echo \"  7. 回到顶层目录\"\n    echo \"\"\n    echo \"#################################\"\n\n    read -p \"请输入你的选择:\" service_tomcat\n\n    case $service_tomcat in\n        1)\n        pssh -H $vmname -i \"ps aux | grep tomcat\"\n        job_tomcat\n        ;;\n        2)\n        pssh -H $vmname -i \"service tomcat7 stop\"\n        # tips： 下面grep的字符串要和你的tomcat项目名称契合\n        pssh -H $vmname -i \"ps aux | grep tomcat7 | awk '{print $2}' | xargs kill -9 \"\n        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量\n        pssh -H $vmname -i \"rm -rf /tomcat7/work/*\"\n        pssh -H $vmname -i \"rm -rf /tomcat7/logs/*\"\n        pssh -H $vmname -i \"rm -rf /tomcat7/temp/*\"\n        job_tomcat\n        ;;\n        3)\n        pssh -H $vmname -i \"service tomcat7 start\"\n        job_tomcat\n        ;;\n        4)\n        pssh -H $vmname -i \"service tomcat7 stop\"\n        # tips： 下面grep的字符串要和你的tomcat项目名称契合\n        pssh -H $vmname -i \"ps aux | grep tomcat7 | awk '{print $2}' | xargs kill -9 \"\n        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量\n        pssh -H $vmname -i \"rm -rf /tomcat7/work/*\"\n        pssh -H $vmname -i \"rm -rf /tomcat7/logs/*\"\n        pssh -H $vmname -i \"rm -rf /tomcat7/temp/*\"\n        sleep 1\n        pssh -H $vmname -i \"service tomcat7 start\"\n        job_tomcat\n        ;;\n        5)\n        pssh -H $vmname -i \"tail -n 200 /tomcat7/logs/catalina.out\"\n        job_tomcat\n        ;;\n        6)\n        echo \"\"\n        HOST\n        ;;\n        7)\n        clear\n        echo \"\"\n        echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n        main\n        ;;\n        *)\n        echo \"请输入正确的选项！\"\n        job_tomcat\n        ;;\n    esac\n}\n\nfunction job2_tomcat ()\n{\n    echo \"\"\n    echo \"############ 动作 ###############\"\n    echo \"  1. 查看当前tomcat7状态\"\n    echo \"  2. 关闭tomcat7\"\n    echo \"  3. 启动tomcat7\"\n    echo \"  4. 重启tomcat7\"\n    echo \"  5. 获取最近200行日志\"\n    echo \"  6. 重新选择主机\"\n    echo \"  7. 回到顶层目录\"\n    echo \"\"\n    echo \"################################\"\n\n    read -p \"请输入你的选择:\" service_tomcat\n\n    case $service_tomcat in\n        1)\n        pssh -h $HostDIR/$vmname -i \"ps aux | grep tomcat\"\n        job2_tomcat\n        ;;\n        2)\n        pssh -h $HostDIR/$vmname -i \"service tomcat7 stop\"\n        # tips： 下面grep的字符串要和你的tomcat项目名称契合\n        pssh -h $HostDIR/$vmname -i \"ps aux | grep tomcat7 | awk '{print $2}' | xargs kill -9 \"\n        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/work/*\"\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/logs/*\"\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/temp/*\"\n        job2_tomcat\n        ;;\n        3)\n        pssh -h $HostDIR/$vmname -i \"service tomcat7 start\"\n        job2_tomcat\n        ;;\n        4)\n        pssh -h $HostDIR/$vmname -i \"service tomcat7 stop\"\n        # tips： 下面grep的字符串要和你的tomcat项目名称契合\n        pssh -h $HostDIR/$vmname -i \"ps aux | grep tomcat7 | awk '{print $2}' | xargs kill -9 \"\n        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/work/*\"\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/logs/*\"\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/temp/*\"\n        sleep 1\n        pssh -h $HostDIR/$vmname -i \"service tomcat7 start\"\n        job2_tomcat\n        ;;\n        5)\n        pssh -h $HostDIR/$vmname -i \"tail -n 200 /tomcat7/logs/catalina.out\"\n        job2_tomcat\n        ;;\n        6)\n        echo \"\"\n        HOST\n        ;;\n        7)\n        clear\n        echo \"\"\n        echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n        main\n        ;;\n        *)\n        echo \"请输入正确的选项！\"\n        job_tomcat\n        ;;\n    esac\n}\n\nfunction HOST2()\n{\n    echo \"\"\n    echo \"############ Host List ###############\"\n    echo \"ckgroup:ck01,ck02,ck03,ck04\"\n    echo \"sjgroup:sj01,sj02,sj03,sj04\"\n    echo \"ddgroup:dd01,dd02,dd03,dd04\"\n    echo \"htgroup:ht01,ht02\"\n    echo \"othergroup:report,tg\"\n    echo \"######################################\"\n    echo \"\"\n# 确认是否所有项目包发布后立即启动\n    echo -e \"\\033[7m 更新订单服务器的war包时，会自动启动tomcat程序，为了释放war包，修改order.no，请设置war包内order.no＝0 ,其它服务器tomcat不会自启动，请使用命令操作 \\033[0m\"\n    echo \" Tips: 如果要选择ck01，则输入ck01即可，如果输入ck组，输入ckgroup即可,如果要退出当前脚本输入exit\"\n    echo \" Tips: 退回上一步请输入back\"\n    read -p \"请输入你的选择:\" vmname\n    case \"$vmname\" in\n        ck01|ck02|ck03|ck04|sj01|sj02|sj03|sj04|dd01|dd02|dd03|dd04|report|tg|ht01|ht02)\n            read -p \"请输入war包的名称,例如:dzcx_ck.war :\" warname\n            pscp_tomcat $vmname $warname\n            ;;\n        ckgroup|sjgroup|htgroup|othergroup)\n            read -p \"请输入war包的名称,例如:dzcx_ck.war :\" warname\n            pscp2_tomcat $vmname $warname\n            ;;\n        ddgroup)\n            read -p \"请输入war包的名称,例如:dzcx_ck.war :\" warname\n            pscp3_tomcat $vmname $warname\n            ;;\n        exit)\n            exit 0;\n            ;;\n        back)\n            clear\n            echo \"\"\n            echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n            main\n            ;;\n        *)\n            echo \"请输入的选择!\"\n            HOST\n            ;;\n    esac\n}\n\nfunction pscp_tomcat ()\n{\n    # single host\n    pscp.pssh -H $vmname /warfolder/\"$warname\" /tomcat7/webapps/\n    HOST2\n}\n\nfunction pscp2_tomcat ()\n{\n    # group\n    pscp.pssh -h $HostDIR/$vmname /warfolder/\"$warname\" /tomcat7/webapps/\n    HOST2\n}\n\nfunction pscp3_tomcat ()\n{\n    # group dd 因为订单需要修改服务器编号\n    pscp.pssh -h $HostDIR/$vmname /warfolder/\"$warname\" /tomcat7/webapps/\n    pssh -h $vmname -i \"service tomcat7 start\"\n    sleep 10\n    pssh -H dd02 \"sed -i 's/order.no=0/order.no=1/g' /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties\"\n    pssh -H dd03 \"sed -i 's/order.no=0/order.no=2/g' /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties\"\n    pssh -H dd04 \"sed -i 's/order.no=0/order.no=3/g' /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties\"\n    HOST2\n}\n\nfunction main ()\n{\necho \"\"\necho \"######################################\"\necho \"\"\necho \"#  1. 更新war包\"\necho \"#  2. 管理tomcat7\"\necho \"#  3. 管理mysql\"\necho \"#  4. 管理redis\"\necho \"#  5. 同步服务器时间\"\necho \"#  6. 清理当前屏幕\"\necho \"#  7. 退出\"\necho \"\"\necho \"######################################\"\n\nread -p \"请输入你的选择:\" num\n\ncase \"$num\" in\n    1)\n        HOST2\n        ;;\n    2)\n        HOST\n        ;;\n    3)\n        echo \"该功能暂未开放\"\n        ;;\n    4)\n        echo \"该功能暂未开放\"\n        ;;\n    5)\n        pssh -h $HostDIR/allhost -i \"service ntpd restart\"\n        ;;\n    6)\n        clear\n        echo \"\"\n        echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n        main\n        ;;\n    7)\n        exit 0\n        ;;\n    *)\n        echo \"请输入正确的数值！\"\n        main\n    ;;\nesac\n\n}\n\n# --------------------------------- main -------------------------------------------------\n\nclear\n\necho \"\"\necho \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\ncommand -v pssh > /dev/null 2>&1\n\nif [ $? -eq 0 ]\nthen\n    main\nelse\n    echo -e \"\\033[07m\"\n    echo -e \"系统检测到您还没安装pssh，请预先安装pssh\"\n    echo \"yum install -y epel-release\"\n    echo \"yum install -y pssh\"\n    echo \"安装成功请重新运行此脚本\"\n    echo -e \"\\033[0m\"\n\nfi\n\n\n```\n","source":"_posts/Manage-Tomcat-Service-Use-Shell-Script.md","raw":"---\ntitle: Manage Tomcat Service Use Shell Script\ntags: 'Shell-Scripts'\ncategories: 'Shell'\npermalink: manage-tomcat-service-use-bash-shell-script\nid: 72\nupdated: '2017-04-21 13:25:16'\ndate: 2016-07-27 02:18:24\n---\n\n#### Tomcat 项目管理交互式脚本.\n\n* Install pssh\n* Use Key Login Server Hosts\n* ~/.ssh/config 配置使用host名登录服务\n*  指定 Server Group Files 存放位置\n\n```\n\n#!/bin/bash\n\n# Author Alex LU\n# Date 2016-07-20\n# Version 1.0\n\n# HostFile\nHostDIR=~/.ssh/host/\n\n# war包上传到该目录\n# /warfolder\n\n:'\njobs_select (){\n    STRING=``cat $vmname | grep group\n    if [ -z \"$STRING\" ]\n    then\n        job_tomcat\n    else\n        job2_tomcat\n    fi\n}\n'\n\nfunction HOST()\n{\n    echo \"\"\n    echo \"############ Host List ###############\"\n    echo \"ckgroup:ck01,ck02,ck03,ck04\"\n    echo \"sjgroup:sj01,sj02,sj03,sj04\"\n    echo \"ddgroup:dd01,dd02,dd03,dd04\"\n    echo \"htgroup:ht01,ht02\"\n    echo \"othergroup:report,tg\"\n    echo \"######################################\"\n    echo \"\"\n    echo \" Tips: 如果要选择ck01，则输入ck01即可，如果输入ck组，输入ckgroup即可,如果要退出当前脚本输入exit\"\n    echo \" Tips: 退回上一步请输入back\"\n    read -p \"请输入你的选择:\" vmname\n\n    case \"$vmname\" in\n        ck01|ck02|ck03|ck04|sj01|sj02|sj03|sj04|dd01|dd02|dd03|dd04|report|tg|ht01|ht02)\n            job_tomcat $vmname\n            ;;\n        ckgroup|sjgroup|htgroup|ddgroup|othergroup)\n            job2_tomcat $vmname\n            ;;\n        exit)\n            exit 0;\n            ;;\n        back)\n            clear\n            echo \"\"\n            echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n            main\n            ;;\n        *)\n            echo \"请输入的选择!\"\n            HOST\n            ;;\n    esac\n}\n\nfunction job_tomcat ()\n{\n    echo \"\"\n    echo \"############ 动作 ###############\"\n    echo \"  1. 查看当前tomcat7状态\"\n    echo \"  2. 关闭tomcat7\"\n    echo \"  3. 启动tomcat7\"\n    echo \"  4. 重启tomcat7\"\n    echo \"  5. 获取最近200行日志\"\n    echo \"  6. 重新选择主机\"\n    echo \"  7. 回到顶层目录\"\n    echo \"\"\n    echo \"#################################\"\n\n    read -p \"请输入你的选择:\" service_tomcat\n\n    case $service_tomcat in\n        1)\n        pssh -H $vmname -i \"ps aux | grep tomcat\"\n        job_tomcat\n        ;;\n        2)\n        pssh -H $vmname -i \"service tomcat7 stop\"\n        # tips： 下面grep的字符串要和你的tomcat项目名称契合\n        pssh -H $vmname -i \"ps aux | grep tomcat7 | awk '{print $2}' | xargs kill -9 \"\n        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量\n        pssh -H $vmname -i \"rm -rf /tomcat7/work/*\"\n        pssh -H $vmname -i \"rm -rf /tomcat7/logs/*\"\n        pssh -H $vmname -i \"rm -rf /tomcat7/temp/*\"\n        job_tomcat\n        ;;\n        3)\n        pssh -H $vmname -i \"service tomcat7 start\"\n        job_tomcat\n        ;;\n        4)\n        pssh -H $vmname -i \"service tomcat7 stop\"\n        # tips： 下面grep的字符串要和你的tomcat项目名称契合\n        pssh -H $vmname -i \"ps aux | grep tomcat7 | awk '{print $2}' | xargs kill -9 \"\n        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量\n        pssh -H $vmname -i \"rm -rf /tomcat7/work/*\"\n        pssh -H $vmname -i \"rm -rf /tomcat7/logs/*\"\n        pssh -H $vmname -i \"rm -rf /tomcat7/temp/*\"\n        sleep 1\n        pssh -H $vmname -i \"service tomcat7 start\"\n        job_tomcat\n        ;;\n        5)\n        pssh -H $vmname -i \"tail -n 200 /tomcat7/logs/catalina.out\"\n        job_tomcat\n        ;;\n        6)\n        echo \"\"\n        HOST\n        ;;\n        7)\n        clear\n        echo \"\"\n        echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n        main\n        ;;\n        *)\n        echo \"请输入正确的选项！\"\n        job_tomcat\n        ;;\n    esac\n}\n\nfunction job2_tomcat ()\n{\n    echo \"\"\n    echo \"############ 动作 ###############\"\n    echo \"  1. 查看当前tomcat7状态\"\n    echo \"  2. 关闭tomcat7\"\n    echo \"  3. 启动tomcat7\"\n    echo \"  4. 重启tomcat7\"\n    echo \"  5. 获取最近200行日志\"\n    echo \"  6. 重新选择主机\"\n    echo \"  7. 回到顶层目录\"\n    echo \"\"\n    echo \"################################\"\n\n    read -p \"请输入你的选择:\" service_tomcat\n\n    case $service_tomcat in\n        1)\n        pssh -h $HostDIR/$vmname -i \"ps aux | grep tomcat\"\n        job2_tomcat\n        ;;\n        2)\n        pssh -h $HostDIR/$vmname -i \"service tomcat7 stop\"\n        # tips： 下面grep的字符串要和你的tomcat项目名称契合\n        pssh -h $HostDIR/$vmname -i \"ps aux | grep tomcat7 | awk '{print $2}' | xargs kill -9 \"\n        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/work/*\"\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/logs/*\"\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/temp/*\"\n        job2_tomcat\n        ;;\n        3)\n        pssh -h $HostDIR/$vmname -i \"service tomcat7 start\"\n        job2_tomcat\n        ;;\n        4)\n        pssh -h $HostDIR/$vmname -i \"service tomcat7 stop\"\n        # tips： 下面grep的字符串要和你的tomcat项目名称契合\n        pssh -h $HostDIR/$vmname -i \"ps aux | grep tomcat7 | awk '{print $2}' | xargs kill -9 \"\n        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/work/*\"\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/logs/*\"\n        pssh -h $HostDIR/$vmname -i \"rm -rf /tomcat7/temp/*\"\n        sleep 1\n        pssh -h $HostDIR/$vmname -i \"service tomcat7 start\"\n        job2_tomcat\n        ;;\n        5)\n        pssh -h $HostDIR/$vmname -i \"tail -n 200 /tomcat7/logs/catalina.out\"\n        job2_tomcat\n        ;;\n        6)\n        echo \"\"\n        HOST\n        ;;\n        7)\n        clear\n        echo \"\"\n        echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n        main\n        ;;\n        *)\n        echo \"请输入正确的选项！\"\n        job_tomcat\n        ;;\n    esac\n}\n\nfunction HOST2()\n{\n    echo \"\"\n    echo \"############ Host List ###############\"\n    echo \"ckgroup:ck01,ck02,ck03,ck04\"\n    echo \"sjgroup:sj01,sj02,sj03,sj04\"\n    echo \"ddgroup:dd01,dd02,dd03,dd04\"\n    echo \"htgroup:ht01,ht02\"\n    echo \"othergroup:report,tg\"\n    echo \"######################################\"\n    echo \"\"\n# 确认是否所有项目包发布后立即启动\n    echo -e \"\\033[7m 更新订单服务器的war包时，会自动启动tomcat程序，为了释放war包，修改order.no，请设置war包内order.no＝0 ,其它服务器tomcat不会自启动，请使用命令操作 \\033[0m\"\n    echo \" Tips: 如果要选择ck01，则输入ck01即可，如果输入ck组，输入ckgroup即可,如果要退出当前脚本输入exit\"\n    echo \" Tips: 退回上一步请输入back\"\n    read -p \"请输入你的选择:\" vmname\n    case \"$vmname\" in\n        ck01|ck02|ck03|ck04|sj01|sj02|sj03|sj04|dd01|dd02|dd03|dd04|report|tg|ht01|ht02)\n            read -p \"请输入war包的名称,例如:dzcx_ck.war :\" warname\n            pscp_tomcat $vmname $warname\n            ;;\n        ckgroup|sjgroup|htgroup|othergroup)\n            read -p \"请输入war包的名称,例如:dzcx_ck.war :\" warname\n            pscp2_tomcat $vmname $warname\n            ;;\n        ddgroup)\n            read -p \"请输入war包的名称,例如:dzcx_ck.war :\" warname\n            pscp3_tomcat $vmname $warname\n            ;;\n        exit)\n            exit 0;\n            ;;\n        back)\n            clear\n            echo \"\"\n            echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n            main\n            ;;\n        *)\n            echo \"请输入的选择!\"\n            HOST\n            ;;\n    esac\n}\n\nfunction pscp_tomcat ()\n{\n    # single host\n    pscp.pssh -H $vmname /warfolder/\"$warname\" /tomcat7/webapps/\n    HOST2\n}\n\nfunction pscp2_tomcat ()\n{\n    # group\n    pscp.pssh -h $HostDIR/$vmname /warfolder/\"$warname\" /tomcat7/webapps/\n    HOST2\n}\n\nfunction pscp3_tomcat ()\n{\n    # group dd 因为订单需要修改服务器编号\n    pscp.pssh -h $HostDIR/$vmname /warfolder/\"$warname\" /tomcat7/webapps/\n    pssh -h $vmname -i \"service tomcat7 start\"\n    sleep 10\n    pssh -H dd02 \"sed -i 's/order.no=0/order.no=1/g' /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties\"\n    pssh -H dd03 \"sed -i 's/order.no=0/order.no=2/g' /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties\"\n    pssh -H dd04 \"sed -i 's/order.no=0/order.no=3/g' /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties\"\n    HOST2\n}\n\nfunction main ()\n{\necho \"\"\necho \"######################################\"\necho \"\"\necho \"#  1. 更新war包\"\necho \"#  2. 管理tomcat7\"\necho \"#  3. 管理mysql\"\necho \"#  4. 管理redis\"\necho \"#  5. 同步服务器时间\"\necho \"#  6. 清理当前屏幕\"\necho \"#  7. 退出\"\necho \"\"\necho \"######################################\"\n\nread -p \"请输入你的选择:\" num\n\ncase \"$num\" in\n    1)\n        HOST2\n        ;;\n    2)\n        HOST\n        ;;\n    3)\n        echo \"该功能暂未开放\"\n        ;;\n    4)\n        echo \"该功能暂未开放\"\n        ;;\n    5)\n        pssh -h $HostDIR/allhost -i \"service ntpd restart\"\n        ;;\n    6)\n        clear\n        echo \"\"\n        echo \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\n        main\n        ;;\n    7)\n        exit 0\n        ;;\n    *)\n        echo \"请输入正确的数值！\"\n        main\n    ;;\nesac\n\n}\n\n# --------------------------------- main -------------------------------------------------\n\nclear\n\necho \"\"\necho \"Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器\"\ncommand -v pssh > /dev/null 2>&1\n\nif [ $? -eq 0 ]\nthen\n    main\nelse\n    echo -e \"\\033[07m\"\n    echo -e \"系统检测到您还没安装pssh，请预先安装pssh\"\n    echo \"yum install -y epel-release\"\n    echo \"yum install -y pssh\"\n    echo \"安装成功请重新运行此脚本\"\n    echo -e \"\\033[0m\"\n\nfi\n\n\n```\n","slug":"manage-tomcat-service-use-bash-shell-script","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqb2004s41tpkak5nn71","content":"<h4 id=\"Tomcat-项目管理交互式脚本\"><a href=\"#Tomcat-项目管理交互式脚本\" class=\"headerlink\" title=\"Tomcat 项目管理交互式脚本.\"></a>Tomcat 项目管理交互式脚本.</h4><ul>\n<li>Install pssh</li>\n<li>Use Key Login Server Hosts</li>\n<li>~/.ssh/config 配置使用host名登录服务</li>\n<li>指定 Server Group Files 存放位置</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div><div class=\"line\">321</div><div class=\"line\">322</div><div class=\"line\">323</div><div class=\"line\">324</div><div class=\"line\">325</div><div class=\"line\">326</div><div class=\"line\">327</div><div class=\"line\">328</div><div class=\"line\">329</div><div class=\"line\">330</div><div class=\"line\">331</div><div class=\"line\">332</div><div class=\"line\">333</div><div class=\"line\">334</div><div class=\"line\">335</div><div class=\"line\">336</div><div class=\"line\">337</div><div class=\"line\">338</div><div class=\"line\">339</div><div class=\"line\">340</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\"># Author Alex LU</div><div class=\"line\"># Date 2016-07-20</div><div class=\"line\"># Version 1.0</div><div class=\"line\"></div><div class=\"line\"># HostFile</div><div class=\"line\">HostDIR=~/.ssh/host/</div><div class=\"line\"></div><div class=\"line\"># war包上传到该目录</div><div class=\"line\"># /warfolder</div><div class=\"line\"></div><div class=\"line\">:&apos;</div><div class=\"line\">jobs_select ()&#123;</div><div class=\"line\">    STRING=``cat $vmname | grep group</div><div class=\"line\">    if [ -z &quot;$STRING&quot; ]</div><div class=\"line\">    then</div><div class=\"line\">        job_tomcat</div><div class=\"line\">    else</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">    fi</div><div class=\"line\">&#125;</div><div class=\"line\">&apos;</div><div class=\"line\"></div><div class=\"line\">function HOST()</div><div class=\"line\">&#123;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;############ Host List ###############&quot;</div><div class=\"line\">    echo &quot;ckgroup:ck01,ck02,ck03,ck04&quot;</div><div class=\"line\">    echo &quot;sjgroup:sj01,sj02,sj03,sj04&quot;</div><div class=\"line\">    echo &quot;ddgroup:dd01,dd02,dd03,dd04&quot;</div><div class=\"line\">    echo &quot;htgroup:ht01,ht02&quot;</div><div class=\"line\">    echo &quot;othergroup:report,tg&quot;</div><div class=\"line\">    echo &quot;######################################&quot;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot; Tips: 如果要选择ck01，则输入ck01即可，如果输入ck组，输入ckgroup即可,如果要退出当前脚本输入exit&quot;</div><div class=\"line\">    echo &quot; Tips: 退回上一步请输入back&quot;</div><div class=\"line\">    read -p &quot;请输入你的选择:&quot; vmname</div><div class=\"line\"></div><div class=\"line\">    case &quot;$vmname&quot; in</div><div class=\"line\">        ck01|ck02|ck03|ck04|sj01|sj02|sj03|sj04|dd01|dd02|dd03|dd04|report|tg|ht01|ht02)</div><div class=\"line\">            job_tomcat $vmname</div><div class=\"line\">            ;;</div><div class=\"line\">        ckgroup|sjgroup|htgroup|ddgroup|othergroup)</div><div class=\"line\">            job2_tomcat $vmname</div><div class=\"line\">            ;;</div><div class=\"line\">        exit)</div><div class=\"line\">            exit 0;</div><div class=\"line\">            ;;</div><div class=\"line\">        back)</div><div class=\"line\">            clear</div><div class=\"line\">            echo &quot;&quot;</div><div class=\"line\">            echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">            main</div><div class=\"line\">            ;;</div><div class=\"line\">        *)</div><div class=\"line\">            echo &quot;请输入的选择!&quot;</div><div class=\"line\">            HOST</div><div class=\"line\">            ;;</div><div class=\"line\">    esac</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function job_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;############ 动作 ###############&quot;</div><div class=\"line\">    echo &quot;  1. 查看当前tomcat7状态&quot;</div><div class=\"line\">    echo &quot;  2. 关闭tomcat7&quot;</div><div class=\"line\">    echo &quot;  3. 启动tomcat7&quot;</div><div class=\"line\">    echo &quot;  4. 重启tomcat7&quot;</div><div class=\"line\">    echo &quot;  5. 获取最近200行日志&quot;</div><div class=\"line\">    echo &quot;  6. 重新选择主机&quot;</div><div class=\"line\">    echo &quot;  7. 回到顶层目录&quot;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;#################################&quot;</div><div class=\"line\"></div><div class=\"line\">    read -p &quot;请输入你的选择:&quot; service_tomcat</div><div class=\"line\"></div><div class=\"line\">    case $service_tomcat in</div><div class=\"line\">        1)</div><div class=\"line\">        pssh -H $vmname -i &quot;ps aux | grep tomcat&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        2)</div><div class=\"line\">        pssh -H $vmname -i &quot;service tomcat7 stop&quot;</div><div class=\"line\">        # tips： 下面grep的字符串要和你的tomcat项目名称契合</div><div class=\"line\">        pssh -H $vmname -i &quot;ps aux | grep tomcat7 | awk &apos;&#123;print $2&#125;&apos; | xargs kill -9 &quot;</div><div class=\"line\">        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/work/*&quot;</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/logs/*&quot;</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/temp/*&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        3)</div><div class=\"line\">        pssh -H $vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        4)</div><div class=\"line\">        pssh -H $vmname -i &quot;service tomcat7 stop&quot;</div><div class=\"line\">        # tips： 下面grep的字符串要和你的tomcat项目名称契合</div><div class=\"line\">        pssh -H $vmname -i &quot;ps aux | grep tomcat7 | awk &apos;&#123;print $2&#125;&apos; | xargs kill -9 &quot;</div><div class=\"line\">        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/work/*&quot;</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/logs/*&quot;</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/temp/*&quot;</div><div class=\"line\">        sleep 1</div><div class=\"line\">        pssh -H $vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        5)</div><div class=\"line\">        pssh -H $vmname -i &quot;tail -n 200 /tomcat7/logs/catalina.out&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        6)</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        HOST</div><div class=\"line\">        ;;</div><div class=\"line\">        7)</div><div class=\"line\">        clear</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">        main</div><div class=\"line\">        ;;</div><div class=\"line\">        *)</div><div class=\"line\">        echo &quot;请输入正确的选项！&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">    esac</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function job2_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;############ 动作 ###############&quot;</div><div class=\"line\">    echo &quot;  1. 查看当前tomcat7状态&quot;</div><div class=\"line\">    echo &quot;  2. 关闭tomcat7&quot;</div><div class=\"line\">    echo &quot;  3. 启动tomcat7&quot;</div><div class=\"line\">    echo &quot;  4. 重启tomcat7&quot;</div><div class=\"line\">    echo &quot;  5. 获取最近200行日志&quot;</div><div class=\"line\">    echo &quot;  6. 重新选择主机&quot;</div><div class=\"line\">    echo &quot;  7. 回到顶层目录&quot;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;################################&quot;</div><div class=\"line\"></div><div class=\"line\">    read -p &quot;请输入你的选择:&quot; service_tomcat</div><div class=\"line\"></div><div class=\"line\">    case $service_tomcat in</div><div class=\"line\">        1)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;ps aux | grep tomcat&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        2)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;service tomcat7 stop&quot;</div><div class=\"line\">        # tips： 下面grep的字符串要和你的tomcat项目名称契合</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;ps aux | grep tomcat7 | awk &apos;&#123;print $2&#125;&apos; | xargs kill -9 &quot;</div><div class=\"line\">        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/work/*&quot;</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/logs/*&quot;</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/temp/*&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        3)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        4)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;service tomcat7 stop&quot;</div><div class=\"line\">        # tips： 下面grep的字符串要和你的tomcat项目名称契合</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;ps aux | grep tomcat7 | awk &apos;&#123;print $2&#125;&apos; | xargs kill -9 &quot;</div><div class=\"line\">        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/work/*&quot;</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/logs/*&quot;</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/temp/*&quot;</div><div class=\"line\">        sleep 1</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        5)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;tail -n 200 /tomcat7/logs/catalina.out&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        6)</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        HOST</div><div class=\"line\">        ;;</div><div class=\"line\">        7)</div><div class=\"line\">        clear</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">        main</div><div class=\"line\">        ;;</div><div class=\"line\">        *)</div><div class=\"line\">        echo &quot;请输入正确的选项！&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">    esac</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function HOST2()</div><div class=\"line\">&#123;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;############ Host List ###############&quot;</div><div class=\"line\">    echo &quot;ckgroup:ck01,ck02,ck03,ck04&quot;</div><div class=\"line\">    echo &quot;sjgroup:sj01,sj02,sj03,sj04&quot;</div><div class=\"line\">    echo &quot;ddgroup:dd01,dd02,dd03,dd04&quot;</div><div class=\"line\">    echo &quot;htgroup:ht01,ht02&quot;</div><div class=\"line\">    echo &quot;othergroup:report,tg&quot;</div><div class=\"line\">    echo &quot;######################################&quot;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\"># 确认是否所有项目包发布后立即启动</div><div class=\"line\">    echo -e &quot;\\033[7m 更新订单服务器的war包时，会自动启动tomcat程序，为了释放war包，修改order.no，请设置war包内order.no＝0 ,其它服务器tomcat不会自启动，请使用命令操作 \\033[0m&quot;</div><div class=\"line\">    echo &quot; Tips: 如果要选择ck01，则输入ck01即可，如果输入ck组，输入ckgroup即可,如果要退出当前脚本输入exit&quot;</div><div class=\"line\">    echo &quot; Tips: 退回上一步请输入back&quot;</div><div class=\"line\">    read -p &quot;请输入你的选择:&quot; vmname</div><div class=\"line\">    case &quot;$vmname&quot; in</div><div class=\"line\">        ck01|ck02|ck03|ck04|sj01|sj02|sj03|sj04|dd01|dd02|dd03|dd04|report|tg|ht01|ht02)</div><div class=\"line\">            read -p &quot;请输入war包的名称,例如:dzcx_ck.war :&quot; warname</div><div class=\"line\">            pscp_tomcat $vmname $warname</div><div class=\"line\">            ;;</div><div class=\"line\">        ckgroup|sjgroup|htgroup|othergroup)</div><div class=\"line\">            read -p &quot;请输入war包的名称,例如:dzcx_ck.war :&quot; warname</div><div class=\"line\">            pscp2_tomcat $vmname $warname</div><div class=\"line\">            ;;</div><div class=\"line\">        ddgroup)</div><div class=\"line\">            read -p &quot;请输入war包的名称,例如:dzcx_ck.war :&quot; warname</div><div class=\"line\">            pscp3_tomcat $vmname $warname</div><div class=\"line\">            ;;</div><div class=\"line\">        exit)</div><div class=\"line\">            exit 0;</div><div class=\"line\">            ;;</div><div class=\"line\">        back)</div><div class=\"line\">            clear</div><div class=\"line\">            echo &quot;&quot;</div><div class=\"line\">            echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">            main</div><div class=\"line\">            ;;</div><div class=\"line\">        *)</div><div class=\"line\">            echo &quot;请输入的选择!&quot;</div><div class=\"line\">            HOST</div><div class=\"line\">            ;;</div><div class=\"line\">    esac</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function pscp_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    # single host</div><div class=\"line\">    pscp.pssh -H $vmname /warfolder/&quot;$warname&quot; /tomcat7/webapps/</div><div class=\"line\">    HOST2</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function pscp2_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    # group</div><div class=\"line\">    pscp.pssh -h $HostDIR/$vmname /warfolder/&quot;$warname&quot; /tomcat7/webapps/</div><div class=\"line\">    HOST2</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function pscp3_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    # group dd 因为订单需要修改服务器编号</div><div class=\"line\">    pscp.pssh -h $HostDIR/$vmname /warfolder/&quot;$warname&quot; /tomcat7/webapps/</div><div class=\"line\">    pssh -h $vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">    sleep 10</div><div class=\"line\">    pssh -H dd02 &quot;sed -i &apos;s/order.no=0/order.no=1/g&apos; /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties&quot;</div><div class=\"line\">    pssh -H dd03 &quot;sed -i &apos;s/order.no=0/order.no=2/g&apos; /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties&quot;</div><div class=\"line\">    pssh -H dd04 &quot;sed -i &apos;s/order.no=0/order.no=3/g&apos; /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties&quot;</div><div class=\"line\">    HOST2</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function main ()</div><div class=\"line\">&#123;</div><div class=\"line\">echo &quot;&quot;</div><div class=\"line\">echo &quot;######################################&quot;</div><div class=\"line\">echo &quot;&quot;</div><div class=\"line\">echo &quot;#  1. 更新war包&quot;</div><div class=\"line\">echo &quot;#  2. 管理tomcat7&quot;</div><div class=\"line\">echo &quot;#  3. 管理mysql&quot;</div><div class=\"line\">echo &quot;#  4. 管理redis&quot;</div><div class=\"line\">echo &quot;#  5. 同步服务器时间&quot;</div><div class=\"line\">echo &quot;#  6. 清理当前屏幕&quot;</div><div class=\"line\">echo &quot;#  7. 退出&quot;</div><div class=\"line\">echo &quot;&quot;</div><div class=\"line\">echo &quot;######################################&quot;</div><div class=\"line\"></div><div class=\"line\">read -p &quot;请输入你的选择:&quot; num</div><div class=\"line\"></div><div class=\"line\">case &quot;$num&quot; in</div><div class=\"line\">    1)</div><div class=\"line\">        HOST2</div><div class=\"line\">        ;;</div><div class=\"line\">    2)</div><div class=\"line\">        HOST</div><div class=\"line\">        ;;</div><div class=\"line\">    3)</div><div class=\"line\">        echo &quot;该功能暂未开放&quot;</div><div class=\"line\">        ;;</div><div class=\"line\">    4)</div><div class=\"line\">        echo &quot;该功能暂未开放&quot;</div><div class=\"line\">        ;;</div><div class=\"line\">    5)</div><div class=\"line\">        pssh -h $HostDIR/allhost -i &quot;service ntpd restart&quot;</div><div class=\"line\">        ;;</div><div class=\"line\">    6)</div><div class=\"line\">        clear</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">        main</div><div class=\"line\">        ;;</div><div class=\"line\">    7)</div><div class=\"line\">        exit 0</div><div class=\"line\">        ;;</div><div class=\"line\">    *)</div><div class=\"line\">        echo &quot;请输入正确的数值！&quot;</div><div class=\"line\">        main</div><div class=\"line\">    ;;</div><div class=\"line\">esac</div><div class=\"line\"></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"># --------------------------------- main -------------------------------------------------</div><div class=\"line\"></div><div class=\"line\">clear</div><div class=\"line\"></div><div class=\"line\">echo &quot;&quot;</div><div class=\"line\">echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">command -v pssh &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\"></div><div class=\"line\">if [ $? -eq 0 ]</div><div class=\"line\">then</div><div class=\"line\">    main</div><div class=\"line\">else</div><div class=\"line\">    echo -e &quot;\\033[07m&quot;</div><div class=\"line\">    echo -e &quot;系统检测到您还没安装pssh，请预先安装pssh&quot;</div><div class=\"line\">    echo &quot;yum install -y epel-release&quot;</div><div class=\"line\">    echo &quot;yum install -y pssh&quot;</div><div class=\"line\">    echo &quot;安装成功请重新运行此脚本&quot;</div><div class=\"line\">    echo -e &quot;\\033[0m&quot;</div><div class=\"line\"></div><div class=\"line\">fi</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"Tomcat-项目管理交互式脚本\"><a href=\"#Tomcat-项目管理交互式脚本\" class=\"headerlink\" title=\"Tomcat 项目管理交互式脚本.\"></a>Tomcat 项目管理交互式脚本.</h4><ul>\n<li>Install pssh</li>\n<li>Use Key Login Server Hosts</li>\n<li>~/.ssh/config 配置使用host名登录服务</li>\n<li>指定 Server Group Files 存放位置</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div><div class=\"line\">321</div><div class=\"line\">322</div><div class=\"line\">323</div><div class=\"line\">324</div><div class=\"line\">325</div><div class=\"line\">326</div><div class=\"line\">327</div><div class=\"line\">328</div><div class=\"line\">329</div><div class=\"line\">330</div><div class=\"line\">331</div><div class=\"line\">332</div><div class=\"line\">333</div><div class=\"line\">334</div><div class=\"line\">335</div><div class=\"line\">336</div><div class=\"line\">337</div><div class=\"line\">338</div><div class=\"line\">339</div><div class=\"line\">340</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\"># Author Alex LU</div><div class=\"line\"># Date 2016-07-20</div><div class=\"line\"># Version 1.0</div><div class=\"line\"></div><div class=\"line\"># HostFile</div><div class=\"line\">HostDIR=~/.ssh/host/</div><div class=\"line\"></div><div class=\"line\"># war包上传到该目录</div><div class=\"line\"># /warfolder</div><div class=\"line\"></div><div class=\"line\">:&apos;</div><div class=\"line\">jobs_select ()&#123;</div><div class=\"line\">    STRING=``cat $vmname | grep group</div><div class=\"line\">    if [ -z &quot;$STRING&quot; ]</div><div class=\"line\">    then</div><div class=\"line\">        job_tomcat</div><div class=\"line\">    else</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">    fi</div><div class=\"line\">&#125;</div><div class=\"line\">&apos;</div><div class=\"line\"></div><div class=\"line\">function HOST()</div><div class=\"line\">&#123;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;############ Host List ###############&quot;</div><div class=\"line\">    echo &quot;ckgroup:ck01,ck02,ck03,ck04&quot;</div><div class=\"line\">    echo &quot;sjgroup:sj01,sj02,sj03,sj04&quot;</div><div class=\"line\">    echo &quot;ddgroup:dd01,dd02,dd03,dd04&quot;</div><div class=\"line\">    echo &quot;htgroup:ht01,ht02&quot;</div><div class=\"line\">    echo &quot;othergroup:report,tg&quot;</div><div class=\"line\">    echo &quot;######################################&quot;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot; Tips: 如果要选择ck01，则输入ck01即可，如果输入ck组，输入ckgroup即可,如果要退出当前脚本输入exit&quot;</div><div class=\"line\">    echo &quot; Tips: 退回上一步请输入back&quot;</div><div class=\"line\">    read -p &quot;请输入你的选择:&quot; vmname</div><div class=\"line\"></div><div class=\"line\">    case &quot;$vmname&quot; in</div><div class=\"line\">        ck01|ck02|ck03|ck04|sj01|sj02|sj03|sj04|dd01|dd02|dd03|dd04|report|tg|ht01|ht02)</div><div class=\"line\">            job_tomcat $vmname</div><div class=\"line\">            ;;</div><div class=\"line\">        ckgroup|sjgroup|htgroup|ddgroup|othergroup)</div><div class=\"line\">            job2_tomcat $vmname</div><div class=\"line\">            ;;</div><div class=\"line\">        exit)</div><div class=\"line\">            exit 0;</div><div class=\"line\">            ;;</div><div class=\"line\">        back)</div><div class=\"line\">            clear</div><div class=\"line\">            echo &quot;&quot;</div><div class=\"line\">            echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">            main</div><div class=\"line\">            ;;</div><div class=\"line\">        *)</div><div class=\"line\">            echo &quot;请输入的选择!&quot;</div><div class=\"line\">            HOST</div><div class=\"line\">            ;;</div><div class=\"line\">    esac</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function job_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;############ 动作 ###############&quot;</div><div class=\"line\">    echo &quot;  1. 查看当前tomcat7状态&quot;</div><div class=\"line\">    echo &quot;  2. 关闭tomcat7&quot;</div><div class=\"line\">    echo &quot;  3. 启动tomcat7&quot;</div><div class=\"line\">    echo &quot;  4. 重启tomcat7&quot;</div><div class=\"line\">    echo &quot;  5. 获取最近200行日志&quot;</div><div class=\"line\">    echo &quot;  6. 重新选择主机&quot;</div><div class=\"line\">    echo &quot;  7. 回到顶层目录&quot;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;#################################&quot;</div><div class=\"line\"></div><div class=\"line\">    read -p &quot;请输入你的选择:&quot; service_tomcat</div><div class=\"line\"></div><div class=\"line\">    case $service_tomcat in</div><div class=\"line\">        1)</div><div class=\"line\">        pssh -H $vmname -i &quot;ps aux | grep tomcat&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        2)</div><div class=\"line\">        pssh -H $vmname -i &quot;service tomcat7 stop&quot;</div><div class=\"line\">        # tips： 下面grep的字符串要和你的tomcat项目名称契合</div><div class=\"line\">        pssh -H $vmname -i &quot;ps aux | grep tomcat7 | awk &apos;&#123;print $2&#125;&apos; | xargs kill -9 &quot;</div><div class=\"line\">        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/work/*&quot;</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/logs/*&quot;</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/temp/*&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        3)</div><div class=\"line\">        pssh -H $vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        4)</div><div class=\"line\">        pssh -H $vmname -i &quot;service tomcat7 stop&quot;</div><div class=\"line\">        # tips： 下面grep的字符串要和你的tomcat项目名称契合</div><div class=\"line\">        pssh -H $vmname -i &quot;ps aux | grep tomcat7 | awk &apos;&#123;print $2&#125;&apos; | xargs kill -9 &quot;</div><div class=\"line\">        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/work/*&quot;</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/logs/*&quot;</div><div class=\"line\">        pssh -H $vmname -i &quot;rm -rf /tomcat7/temp/*&quot;</div><div class=\"line\">        sleep 1</div><div class=\"line\">        pssh -H $vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        5)</div><div class=\"line\">        pssh -H $vmname -i &quot;tail -n 200 /tomcat7/logs/catalina.out&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        6)</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        HOST</div><div class=\"line\">        ;;</div><div class=\"line\">        7)</div><div class=\"line\">        clear</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">        main</div><div class=\"line\">        ;;</div><div class=\"line\">        *)</div><div class=\"line\">        echo &quot;请输入正确的选项！&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">    esac</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function job2_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;############ 动作 ###############&quot;</div><div class=\"line\">    echo &quot;  1. 查看当前tomcat7状态&quot;</div><div class=\"line\">    echo &quot;  2. 关闭tomcat7&quot;</div><div class=\"line\">    echo &quot;  3. 启动tomcat7&quot;</div><div class=\"line\">    echo &quot;  4. 重启tomcat7&quot;</div><div class=\"line\">    echo &quot;  5. 获取最近200行日志&quot;</div><div class=\"line\">    echo &quot;  6. 重新选择主机&quot;</div><div class=\"line\">    echo &quot;  7. 回到顶层目录&quot;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;################################&quot;</div><div class=\"line\"></div><div class=\"line\">    read -p &quot;请输入你的选择:&quot; service_tomcat</div><div class=\"line\"></div><div class=\"line\">    case $service_tomcat in</div><div class=\"line\">        1)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;ps aux | grep tomcat&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        2)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;service tomcat7 stop&quot;</div><div class=\"line\">        # tips： 下面grep的字符串要和你的tomcat项目名称契合</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;ps aux | grep tomcat7 | awk &apos;&#123;print $2&#125;&apos; | xargs kill -9 &quot;</div><div class=\"line\">        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/work/*&quot;</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/logs/*&quot;</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/temp/*&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        3)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        4)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;service tomcat7 stop&quot;</div><div class=\"line\">        # tips： 下面grep的字符串要和你的tomcat项目名称契合</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;ps aux | grep tomcat7 | awk &apos;&#123;print $2&#125;&apos; | xargs kill -9 &quot;</div><div class=\"line\">        # tips: 下面用到的路径为绝对路径，请更改为自己tomcat的目录，也可以在前面增加自定义变量</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/work/*&quot;</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/logs/*&quot;</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;rm -rf /tomcat7/temp/*&quot;</div><div class=\"line\">        sleep 1</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        5)</div><div class=\"line\">        pssh -h $HostDIR/$vmname -i &quot;tail -n 200 /tomcat7/logs/catalina.out&quot;</div><div class=\"line\">        job2_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">        6)</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        HOST</div><div class=\"line\">        ;;</div><div class=\"line\">        7)</div><div class=\"line\">        clear</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">        main</div><div class=\"line\">        ;;</div><div class=\"line\">        *)</div><div class=\"line\">        echo &quot;请输入正确的选项！&quot;</div><div class=\"line\">        job_tomcat</div><div class=\"line\">        ;;</div><div class=\"line\">    esac</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function HOST2()</div><div class=\"line\">&#123;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\">    echo &quot;############ Host List ###############&quot;</div><div class=\"line\">    echo &quot;ckgroup:ck01,ck02,ck03,ck04&quot;</div><div class=\"line\">    echo &quot;sjgroup:sj01,sj02,sj03,sj04&quot;</div><div class=\"line\">    echo &quot;ddgroup:dd01,dd02,dd03,dd04&quot;</div><div class=\"line\">    echo &quot;htgroup:ht01,ht02&quot;</div><div class=\"line\">    echo &quot;othergroup:report,tg&quot;</div><div class=\"line\">    echo &quot;######################################&quot;</div><div class=\"line\">    echo &quot;&quot;</div><div class=\"line\"># 确认是否所有项目包发布后立即启动</div><div class=\"line\">    echo -e &quot;\\033[7m 更新订单服务器的war包时，会自动启动tomcat程序，为了释放war包，修改order.no，请设置war包内order.no＝0 ,其它服务器tomcat不会自启动，请使用命令操作 \\033[0m&quot;</div><div class=\"line\">    echo &quot; Tips: 如果要选择ck01，则输入ck01即可，如果输入ck组，输入ckgroup即可,如果要退出当前脚本输入exit&quot;</div><div class=\"line\">    echo &quot; Tips: 退回上一步请输入back&quot;</div><div class=\"line\">    read -p &quot;请输入你的选择:&quot; vmname</div><div class=\"line\">    case &quot;$vmname&quot; in</div><div class=\"line\">        ck01|ck02|ck03|ck04|sj01|sj02|sj03|sj04|dd01|dd02|dd03|dd04|report|tg|ht01|ht02)</div><div class=\"line\">            read -p &quot;请输入war包的名称,例如:dzcx_ck.war :&quot; warname</div><div class=\"line\">            pscp_tomcat $vmname $warname</div><div class=\"line\">            ;;</div><div class=\"line\">        ckgroup|sjgroup|htgroup|othergroup)</div><div class=\"line\">            read -p &quot;请输入war包的名称,例如:dzcx_ck.war :&quot; warname</div><div class=\"line\">            pscp2_tomcat $vmname $warname</div><div class=\"line\">            ;;</div><div class=\"line\">        ddgroup)</div><div class=\"line\">            read -p &quot;请输入war包的名称,例如:dzcx_ck.war :&quot; warname</div><div class=\"line\">            pscp3_tomcat $vmname $warname</div><div class=\"line\">            ;;</div><div class=\"line\">        exit)</div><div class=\"line\">            exit 0;</div><div class=\"line\">            ;;</div><div class=\"line\">        back)</div><div class=\"line\">            clear</div><div class=\"line\">            echo &quot;&quot;</div><div class=\"line\">            echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">            main</div><div class=\"line\">            ;;</div><div class=\"line\">        *)</div><div class=\"line\">            echo &quot;请输入的选择!&quot;</div><div class=\"line\">            HOST</div><div class=\"line\">            ;;</div><div class=\"line\">    esac</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function pscp_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    # single host</div><div class=\"line\">    pscp.pssh -H $vmname /warfolder/&quot;$warname&quot; /tomcat7/webapps/</div><div class=\"line\">    HOST2</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function pscp2_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    # group</div><div class=\"line\">    pscp.pssh -h $HostDIR/$vmname /warfolder/&quot;$warname&quot; /tomcat7/webapps/</div><div class=\"line\">    HOST2</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function pscp3_tomcat ()</div><div class=\"line\">&#123;</div><div class=\"line\">    # group dd 因为订单需要修改服务器编号</div><div class=\"line\">    pscp.pssh -h $HostDIR/$vmname /warfolder/&quot;$warname&quot; /tomcat7/webapps/</div><div class=\"line\">    pssh -h $vmname -i &quot;service tomcat7 start&quot;</div><div class=\"line\">    sleep 10</div><div class=\"line\">    pssh -H dd02 &quot;sed -i &apos;s/order.no=0/order.no=1/g&apos; /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties&quot;</div><div class=\"line\">    pssh -H dd03 &quot;sed -i &apos;s/order.no=0/order.no=2/g&apos; /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties&quot;</div><div class=\"line\">    pssh -H dd04 &quot;sed -i &apos;s/order.no=0/order.no=3/g&apos; /tomcat7/webapps/dzcx_socket/WEB-INF/classes/base.properties&quot;</div><div class=\"line\">    HOST2</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function main ()</div><div class=\"line\">&#123;</div><div class=\"line\">echo &quot;&quot;</div><div class=\"line\">echo &quot;######################################&quot;</div><div class=\"line\">echo &quot;&quot;</div><div class=\"line\">echo &quot;#  1. 更新war包&quot;</div><div class=\"line\">echo &quot;#  2. 管理tomcat7&quot;</div><div class=\"line\">echo &quot;#  3. 管理mysql&quot;</div><div class=\"line\">echo &quot;#  4. 管理redis&quot;</div><div class=\"line\">echo &quot;#  5. 同步服务器时间&quot;</div><div class=\"line\">echo &quot;#  6. 清理当前屏幕&quot;</div><div class=\"line\">echo &quot;#  7. 退出&quot;</div><div class=\"line\">echo &quot;&quot;</div><div class=\"line\">echo &quot;######################################&quot;</div><div class=\"line\"></div><div class=\"line\">read -p &quot;请输入你的选择:&quot; num</div><div class=\"line\"></div><div class=\"line\">case &quot;$num&quot; in</div><div class=\"line\">    1)</div><div class=\"line\">        HOST2</div><div class=\"line\">        ;;</div><div class=\"line\">    2)</div><div class=\"line\">        HOST</div><div class=\"line\">        ;;</div><div class=\"line\">    3)</div><div class=\"line\">        echo &quot;该功能暂未开放&quot;</div><div class=\"line\">        ;;</div><div class=\"line\">    4)</div><div class=\"line\">        echo &quot;该功能暂未开放&quot;</div><div class=\"line\">        ;;</div><div class=\"line\">    5)</div><div class=\"line\">        pssh -h $HostDIR/allhost -i &quot;service ntpd restart&quot;</div><div class=\"line\">        ;;</div><div class=\"line\">    6)</div><div class=\"line\">        clear</div><div class=\"line\">        echo &quot;&quot;</div><div class=\"line\">        echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">        main</div><div class=\"line\">        ;;</div><div class=\"line\">    7)</div><div class=\"line\">        exit 0</div><div class=\"line\">        ;;</div><div class=\"line\">    *)</div><div class=\"line\">        echo &quot;请输入正确的数值！&quot;</div><div class=\"line\">        main</div><div class=\"line\">    ;;</div><div class=\"line\">esac</div><div class=\"line\"></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"># --------------------------------- main -------------------------------------------------</div><div class=\"line\"></div><div class=\"line\">clear</div><div class=\"line\"></div><div class=\"line\">echo &quot;&quot;</div><div class=\"line\">echo &quot;Tips: 欢迎使用Tomcat项目服务管理工具,您需要预先安装pssh工具，以及配置好ssh免密登录到服务器&quot;</div><div class=\"line\">command -v pssh &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\"></div><div class=\"line\">if [ $? -eq 0 ]</div><div class=\"line\">then</div><div class=\"line\">    main</div><div class=\"line\">else</div><div class=\"line\">    echo -e &quot;\\033[07m&quot;</div><div class=\"line\">    echo -e &quot;系统检测到您还没安装pssh，请预先安装pssh&quot;</div><div class=\"line\">    echo &quot;yum install -y epel-release&quot;</div><div class=\"line\">    echo &quot;yum install -y pssh&quot;</div><div class=\"line\">    echo &quot;安装成功请重新运行此脚本&quot;</div><div class=\"line\">    echo -e &quot;\\033[0m&quot;</div><div class=\"line\"></div><div class=\"line\">fi</div></pre></td></tr></table></figure>\n"},{"title":"MySQL(1) 常用优化","id":"59","updated":"2017-04-21T05:28:07.000Z","date":"2016-06-15T18:29:00.000Z","_content":"\n\n> **环境：MySQL 5.5 & MySQL 5.6 & RHEL/CentOS 5/6/7**\n\n### 1. MySQL 系统配置优化\n\n网络配置方面：修改/etc/sysctl.conf\n```\n          # 增加tcp支持的队列数\n               net.ipv4.tcp_max_syn_backlog = 65535\n          # 减少断开时\n```\n 打开文件限制 修改/etc/security/limits.conf\n```\n          # 增加：\n               * sort nofile 65535\n               * hard nofile 65535\n```\n\n\n### 2.  MySQL 配置文件优化\n\n* 配置文件位置：/etc/my.cnf /etc/mysql/my.cnf\n\n* 如果/etc下没有my.cnf，需要拷贝一份\n```\ncp /usr/share/mysql/my-medium.cnf /etc/my.cnf\n```\n\n* 配置文件查找顺序：mysql -verbose --help | grep -A 1 'Default options'\n\n* 常用配置说明:\n```\n innodb_buffer_pool_size\n```\n设置mysql数据库innodb存储缓冲池的大小，如果是独立的mysql服务，建议设置为物理内存的75％左右，如果和apahce等服务一起运行时，则根据实际需求设定，尽可能大。\n\n```\n innodb_buffer_pool_instances\n```\n这是mysql5.5中新增的一个参数，用于控制缓冲池的个数，默认情况下只有1个缓冲池，设置多个缓冲池可以增加并发性，提事物运算效率。\n\n```\n innodb_log_buffer_size\n```\n设定日志缓冲区的大小，由于体制最长每秒就会刷新，不需要太大。\n\n```\n innodb_flush_log_at_trx_commit\n```\n关键参数，对于innodb的IO效率影响很大，默认值为1，可以取值0：不自动同步log到磁盘，由mysql每秒自动执行，1：将所有事物直接写到磁盘，可以用在保证数据绝对安全的地方，会影响效率，2：先将事物纪录保存在内存中，有mysql每秒统一写入磁盘，建议设定为2\n\n```\n innodb_read_io_threads;\n innodb_write_io_threadsm;\n```\nmysql5.5 新增的两个参数，决定了Innodb读写的io进程数量，默认为4，可以根据CPU的实际性能设定。\n\n```\n innodb_file_per_table\n```\n关键参数，控制Innodb每一个表实用独立的表空间，默认为off，也就是所有的表都会建立在共享空间，不利于资源回收\n\n```\n innodb_stats_on_metadata\n```\n决定了mysql在什么情况下会刷新innodb表的统计信息，可以关闭，管理员选取时间手动刷新。存在的目的保证优化器正确找到索引.\n\n\n mysql最大连接数限制\n```\nmax_connections=5000\n```\n\n 不区分表名称大小写\n```\nlower_case_table_names=1\n```\n\n 修改默认字符编码\n```\n# mysql 5.1\ndefault-character-set=utf8\n\n# mysql 5.5 & mysql 5.6\ncharacter-set-server=utf8\n```\n\n 最大错误操作次数 : 默认是10，尽量调大，否则容易导致mysql对来访主机锁定\n```\nmax_connect_errors = 10000\n```\n\n 设置mysql时区：默认mysql使用的系统时区，其实我们也可以在mysql内设定时区\n```\ndefault-time_zone = '+8:00'\n```\n\n 以上配置，如何在mysql内，检测是否生效\n```\nshow variables like '%max_connections%'\nshow variables like '%time_zone%'\nshow variables like '%max_connect_errors%'\nshow variables like '%character-set-server%'\nshow variables like '%lower_case_table_names%'\n```\n 修改/etc/my.cnf这是需要重启mysql才能生效，但是很多时候，我们不方便重启mysql，这时我们需要在mysql临时修改配置，注意并不是所有选项都可以在运行中修改，以修改时区为例：\n```\n# 修改全局设置\nset global time_zone='+8:00'\n\n# 修改当前会话\nset time_zone='+8:00'\n```\n\n### 3.  第三方工具对mysql配置进行优化\n\n* http://toolspercona.com <br>\n先回答问题，然后根据问题你给出的答案，网站会给你一个参考配置。\n","source":"_posts/MySQL-1-常用优化.md","raw":"---\ntitle: MySQL(1) 常用优化\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: mysql03\nid: 59\nupdated: '2017-04-21 13:28:07'\ndate: 2016-06-16 02:29:00\n---\n\n\n> **环境：MySQL 5.5 & MySQL 5.6 & RHEL/CentOS 5/6/7**\n\n### 1. MySQL 系统配置优化\n\n网络配置方面：修改/etc/sysctl.conf\n```\n          # 增加tcp支持的队列数\n               net.ipv4.tcp_max_syn_backlog = 65535\n          # 减少断开时\n```\n 打开文件限制 修改/etc/security/limits.conf\n```\n          # 增加：\n               * sort nofile 65535\n               * hard nofile 65535\n```\n\n\n### 2.  MySQL 配置文件优化\n\n* 配置文件位置：/etc/my.cnf /etc/mysql/my.cnf\n\n* 如果/etc下没有my.cnf，需要拷贝一份\n```\ncp /usr/share/mysql/my-medium.cnf /etc/my.cnf\n```\n\n* 配置文件查找顺序：mysql -verbose --help | grep -A 1 'Default options'\n\n* 常用配置说明:\n```\n innodb_buffer_pool_size\n```\n设置mysql数据库innodb存储缓冲池的大小，如果是独立的mysql服务，建议设置为物理内存的75％左右，如果和apahce等服务一起运行时，则根据实际需求设定，尽可能大。\n\n```\n innodb_buffer_pool_instances\n```\n这是mysql5.5中新增的一个参数，用于控制缓冲池的个数，默认情况下只有1个缓冲池，设置多个缓冲池可以增加并发性，提事物运算效率。\n\n```\n innodb_log_buffer_size\n```\n设定日志缓冲区的大小，由于体制最长每秒就会刷新，不需要太大。\n\n```\n innodb_flush_log_at_trx_commit\n```\n关键参数，对于innodb的IO效率影响很大，默认值为1，可以取值0：不自动同步log到磁盘，由mysql每秒自动执行，1：将所有事物直接写到磁盘，可以用在保证数据绝对安全的地方，会影响效率，2：先将事物纪录保存在内存中，有mysql每秒统一写入磁盘，建议设定为2\n\n```\n innodb_read_io_threads;\n innodb_write_io_threadsm;\n```\nmysql5.5 新增的两个参数，决定了Innodb读写的io进程数量，默认为4，可以根据CPU的实际性能设定。\n\n```\n innodb_file_per_table\n```\n关键参数，控制Innodb每一个表实用独立的表空间，默认为off，也就是所有的表都会建立在共享空间，不利于资源回收\n\n```\n innodb_stats_on_metadata\n```\n决定了mysql在什么情况下会刷新innodb表的统计信息，可以关闭，管理员选取时间手动刷新。存在的目的保证优化器正确找到索引.\n\n\n mysql最大连接数限制\n```\nmax_connections=5000\n```\n\n 不区分表名称大小写\n```\nlower_case_table_names=1\n```\n\n 修改默认字符编码\n```\n# mysql 5.1\ndefault-character-set=utf8\n\n# mysql 5.5 & mysql 5.6\ncharacter-set-server=utf8\n```\n\n 最大错误操作次数 : 默认是10，尽量调大，否则容易导致mysql对来访主机锁定\n```\nmax_connect_errors = 10000\n```\n\n 设置mysql时区：默认mysql使用的系统时区，其实我们也可以在mysql内设定时区\n```\ndefault-time_zone = '+8:00'\n```\n\n 以上配置，如何在mysql内，检测是否生效\n```\nshow variables like '%max_connections%'\nshow variables like '%time_zone%'\nshow variables like '%max_connect_errors%'\nshow variables like '%character-set-server%'\nshow variables like '%lower_case_table_names%'\n```\n 修改/etc/my.cnf这是需要重启mysql才能生效，但是很多时候，我们不方便重启mysql，这时我们需要在mysql临时修改配置，注意并不是所有选项都可以在运行中修改，以修改时区为例：\n```\n# 修改全局设置\nset global time_zone='+8:00'\n\n# 修改当前会话\nset time_zone='+8:00'\n```\n\n### 3.  第三方工具对mysql配置进行优化\n\n* http://toolspercona.com <br>\n先回答问题，然后根据问题你给出的答案，网站会给你一个参考配置。\n","slug":"mysql03","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqb4004w41tpt595zb4x","content":"<blockquote>\n<p><strong>环境：MySQL 5.5 &amp; MySQL 5.6 &amp; RHEL/CentOS 5/6/7</strong></p>\n</blockquote>\n<h3 id=\"1-MySQL-系统配置优化\"><a href=\"#1-MySQL-系统配置优化\" class=\"headerlink\" title=\"1. MySQL 系统配置优化\"></a>1. MySQL 系统配置优化</h3><p>网络配置方面：修改/etc/sysctl.conf<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 增加tcp支持的队列数</div><div class=\"line\">     net.ipv4.tcp_max_syn_backlog = 65535</div><div class=\"line\"># 减少断开时</div></pre></td></tr></table></figure></p>\n<p> 打开文件限制 修改/etc/security/limits.conf<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 增加：</div><div class=\"line\">     * sort nofile 65535</div><div class=\"line\">     * hard nofile 65535</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-MySQL-配置文件优化\"><a href=\"#2-MySQL-配置文件优化\" class=\"headerlink\" title=\"2.  MySQL 配置文件优化\"></a>2.  MySQL 配置文件优化</h3><ul>\n<li><p>配置文件位置：/etc/my.cnf /etc/mysql/my.cnf</p>\n</li>\n<li><p>如果/etc下没有my.cnf，需要拷贝一份</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp /usr/share/mysql/my-medium.cnf /etc/my.cnf</div></pre></td></tr></table></figure>\n</li>\n<li><p>配置文件查找顺序：mysql -verbose –help | grep -A 1 ‘Default options’</p>\n</li>\n<li><p>常用配置说明:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_buffer_pool_size</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>设置mysql数据库innodb存储缓冲池的大小，如果是独立的mysql服务，建议设置为物理内存的75％左右，如果和apahce等服务一起运行时，则根据实际需求设定，尽可能大。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_buffer_pool_instances</div></pre></td></tr></table></figure>\n<p>这是mysql5.5中新增的一个参数，用于控制缓冲池的个数，默认情况下只有1个缓冲池，设置多个缓冲池可以增加并发性，提事物运算效率。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_log_buffer_size</div></pre></td></tr></table></figure>\n<p>设定日志缓冲区的大小，由于体制最长每秒就会刷新，不需要太大。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_flush_log_at_trx_commit</div></pre></td></tr></table></figure>\n<p>关键参数，对于innodb的IO效率影响很大，默认值为1，可以取值0：不自动同步log到磁盘，由mysql每秒自动执行，1：将所有事物直接写到磁盘，可以用在保证数据绝对安全的地方，会影响效率，2：先将事物纪录保存在内存中，有mysql每秒统一写入磁盘，建议设定为2</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_read_io_threads;</div><div class=\"line\">innodb_write_io_threadsm;</div></pre></td></tr></table></figure>\n<p>mysql5.5 新增的两个参数，决定了Innodb读写的io进程数量，默认为4，可以根据CPU的实际性能设定。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_file_per_table</div></pre></td></tr></table></figure>\n<p>关键参数，控制Innodb每一个表实用独立的表空间，默认为off，也就是所有的表都会建立在共享空间，不利于资源回收</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_stats_on_metadata</div></pre></td></tr></table></figure>\n<p>决定了mysql在什么情况下会刷新innodb表的统计信息，可以关闭，管理员选取时间手动刷新。存在的目的保证优化器正确找到索引.</p>\n<p> mysql最大连接数限制<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">max_connections=5000</div></pre></td></tr></table></figure></p>\n<p> 不区分表名称大小写<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">lower_case_table_names=1</div></pre></td></tr></table></figure></p>\n<p> 修改默认字符编码<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># mysql 5.1</div><div class=\"line\">default-character-set=utf8</div><div class=\"line\"></div><div class=\"line\"># mysql 5.5 &amp; mysql 5.6</div><div class=\"line\">character-set-server=utf8</div></pre></td></tr></table></figure></p>\n<p> 最大错误操作次数 : 默认是10，尽量调大，否则容易导致mysql对来访主机锁定<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">max_connect_errors = 10000</div></pre></td></tr></table></figure></p>\n<p> 设置mysql时区：默认mysql使用的系统时区，其实我们也可以在mysql内设定时区<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">default-time_zone = &apos;+8:00&apos;</div></pre></td></tr></table></figure></p>\n<p> 以上配置，如何在mysql内，检测是否生效<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">show variables like &apos;%max_connections%&apos;</div><div class=\"line\">show variables like &apos;%time_zone%&apos;</div><div class=\"line\">show variables like &apos;%max_connect_errors%&apos;</div><div class=\"line\">show variables like &apos;%character-set-server%&apos;</div><div class=\"line\">show variables like &apos;%lower_case_table_names%&apos;</div></pre></td></tr></table></figure></p>\n<p> 修改/etc/my.cnf这是需要重启mysql才能生效，但是很多时候，我们不方便重启mysql，这时我们需要在mysql临时修改配置，注意并不是所有选项都可以在运行中修改，以修改时区为例：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改全局设置</div><div class=\"line\">set global time_zone=&apos;+8:00&apos;</div><div class=\"line\"></div><div class=\"line\"># 修改当前会话</div><div class=\"line\">set time_zone=&apos;+8:00&apos;</div></pre></td></tr></table></figure></p>\n<h3 id=\"3-第三方工具对mysql配置进行优化\"><a href=\"#3-第三方工具对mysql配置进行优化\" class=\"headerlink\" title=\"3.  第三方工具对mysql配置进行优化\"></a>3.  第三方工具对mysql配置进行优化</h3><ul>\n<li><a href=\"http://toolspercona.com\" target=\"_blank\" rel=\"external\">http://toolspercona.com</a> <br><br>先回答问题，然后根据问题你给出的答案，网站会给你一个参考配置。</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p><strong>环境：MySQL 5.5 &amp; MySQL 5.6 &amp; RHEL/CentOS 5/6/7</strong></p>\n</blockquote>\n<h3 id=\"1-MySQL-系统配置优化\"><a href=\"#1-MySQL-系统配置优化\" class=\"headerlink\" title=\"1. MySQL 系统配置优化\"></a>1. MySQL 系统配置优化</h3><p>网络配置方面：修改/etc/sysctl.conf<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 增加tcp支持的队列数</div><div class=\"line\">     net.ipv4.tcp_max_syn_backlog = 65535</div><div class=\"line\"># 减少断开时</div></pre></td></tr></table></figure></p>\n<p> 打开文件限制 修改/etc/security/limits.conf<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 增加：</div><div class=\"line\">     * sort nofile 65535</div><div class=\"line\">     * hard nofile 65535</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-MySQL-配置文件优化\"><a href=\"#2-MySQL-配置文件优化\" class=\"headerlink\" title=\"2.  MySQL 配置文件优化\"></a>2.  MySQL 配置文件优化</h3><ul>\n<li><p>配置文件位置：/etc/my.cnf /etc/mysql/my.cnf</p>\n</li>\n<li><p>如果/etc下没有my.cnf，需要拷贝一份</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp /usr/share/mysql/my-medium.cnf /etc/my.cnf</div></pre></td></tr></table></figure>\n</li>\n<li><p>配置文件查找顺序：mysql -verbose –help | grep -A 1 ‘Default options’</p>\n</li>\n<li><p>常用配置说明:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_buffer_pool_size</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>设置mysql数据库innodb存储缓冲池的大小，如果是独立的mysql服务，建议设置为物理内存的75％左右，如果和apahce等服务一起运行时，则根据实际需求设定，尽可能大。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_buffer_pool_instances</div></pre></td></tr></table></figure>\n<p>这是mysql5.5中新增的一个参数，用于控制缓冲池的个数，默认情况下只有1个缓冲池，设置多个缓冲池可以增加并发性，提事物运算效率。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_log_buffer_size</div></pre></td></tr></table></figure>\n<p>设定日志缓冲区的大小，由于体制最长每秒就会刷新，不需要太大。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_flush_log_at_trx_commit</div></pre></td></tr></table></figure>\n<p>关键参数，对于innodb的IO效率影响很大，默认值为1，可以取值0：不自动同步log到磁盘，由mysql每秒自动执行，1：将所有事物直接写到磁盘，可以用在保证数据绝对安全的地方，会影响效率，2：先将事物纪录保存在内存中，有mysql每秒统一写入磁盘，建议设定为2</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_read_io_threads;</div><div class=\"line\">innodb_write_io_threadsm;</div></pre></td></tr></table></figure>\n<p>mysql5.5 新增的两个参数，决定了Innodb读写的io进程数量，默认为4，可以根据CPU的实际性能设定。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_file_per_table</div></pre></td></tr></table></figure>\n<p>关键参数，控制Innodb每一个表实用独立的表空间，默认为off，也就是所有的表都会建立在共享空间，不利于资源回收</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">innodb_stats_on_metadata</div></pre></td></tr></table></figure>\n<p>决定了mysql在什么情况下会刷新innodb表的统计信息，可以关闭，管理员选取时间手动刷新。存在的目的保证优化器正确找到索引.</p>\n<p> mysql最大连接数限制<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">max_connections=5000</div></pre></td></tr></table></figure></p>\n<p> 不区分表名称大小写<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">lower_case_table_names=1</div></pre></td></tr></table></figure></p>\n<p> 修改默认字符编码<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># mysql 5.1</div><div class=\"line\">default-character-set=utf8</div><div class=\"line\"></div><div class=\"line\"># mysql 5.5 &amp; mysql 5.6</div><div class=\"line\">character-set-server=utf8</div></pre></td></tr></table></figure></p>\n<p> 最大错误操作次数 : 默认是10，尽量调大，否则容易导致mysql对来访主机锁定<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">max_connect_errors = 10000</div></pre></td></tr></table></figure></p>\n<p> 设置mysql时区：默认mysql使用的系统时区，其实我们也可以在mysql内设定时区<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">default-time_zone = &apos;+8:00&apos;</div></pre></td></tr></table></figure></p>\n<p> 以上配置，如何在mysql内，检测是否生效<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">show variables like &apos;%max_connections%&apos;</div><div class=\"line\">show variables like &apos;%time_zone%&apos;</div><div class=\"line\">show variables like &apos;%max_connect_errors%&apos;</div><div class=\"line\">show variables like &apos;%character-set-server%&apos;</div><div class=\"line\">show variables like &apos;%lower_case_table_names%&apos;</div></pre></td></tr></table></figure></p>\n<p> 修改/etc/my.cnf这是需要重启mysql才能生效，但是很多时候，我们不方便重启mysql，这时我们需要在mysql临时修改配置，注意并不是所有选项都可以在运行中修改，以修改时区为例：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改全局设置</div><div class=\"line\">set global time_zone=&apos;+8:00&apos;</div><div class=\"line\"></div><div class=\"line\"># 修改当前会话</div><div class=\"line\">set time_zone=&apos;+8:00&apos;</div></pre></td></tr></table></figure></p>\n<h3 id=\"3-第三方工具对mysql配置进行优化\"><a href=\"#3-第三方工具对mysql配置进行优化\" class=\"headerlink\" title=\"3.  第三方工具对mysql配置进行优化\"></a>3.  第三方工具对mysql配置进行优化</h3><ul>\n<li><a href=\"http://toolspercona.com\">http://toolspercona.com</a> <br><br>先回答问题，然后根据问题你给出的答案，网站会给你一个参考配置。</li>\n</ul>\n"},{"title":"MySQL(2) 开启慢日志优化","id":"6","updated":"2017-04-21T05:40:06.000Z","date":"2016-03-22T07:16:26.000Z","_content":"\n# 工欲善其事，必先利其器 -- mysql开启慢日志优化\n\n\n### 慢查询日志\n顾名思义就是记录查询比较慢得日志。\n\n\n### 测试环境\n\n* mysql-server 5.6\n* CentOS 6.5\n* VMware Fushion 8 pro\n\n\n首先，第一部查看是否已经开启慢查询日志：\n\n```\nmysql> show variables like '%slow%';\n+---------------------+---------------------------------+\n| Variable_name       | Value                           |\n+---------------------+---------------------------------+\n| log_slow_queries    | OFF                             |\n| slow_launch_time    | 2                               |\n| slow_query_log      | OFF                             |\n| slow_query_log_file | /var/run/mysqld/mysqld-slow.log |\n+---------------------+---------------------------------+\n4 rows in set (0.00 sec)\n\nmysql>\n```\n\n打开慢查询日志。修改MySQL的配置文件my.cnf一般是在/etc目录下面，加上下面三行配置后重启MySQL。\n\n```\nslow_query_log = ON\nslow_launch_time = 2\nslow_query_log_file = /usr/local/mysql/data/slow_query.log\n\n```\nslow_launch_time只能精确到秒，如果需要更精确可以使用一些第三方的工具比如后面介绍的pt-query-digest\n\n```\nmysql> show variables like '%slow%';\n+---------------------------+--------------------------------------+\n| Variable_name             | Value                                |\n+---------------------------+--------------------------------------+\n| log_slow_admin_statements | OFF                                  |\n| log_slow_slave_statements | OFF                                  |\n| slow_launch_time          | 2                                    |\n| slow_query_log            | ON                                   |\n| slow_query_log_file       | /usr/local/mysql/data/slow_query.log |\n+---------------------------+--------------------------------------+\n5 rows in set (0.00 sec)\n\nmysql>\n```\n> Tips: 我这里用的MySQL版本是5.6，不同版本的MySQL开启慢查询的配置是不同的，比如5.6之前的某些版本是long_query_time, long_query_time和log-slow-queries。可以先在终端执行show variables like '%slow%';查看下当前版本具体配置是什么。\n\n也可以在终端中通过设置全局变量来打开慢查询日志：\n\n```\nset @@global.slow_query_log = ON;\n```\n\n### 保持慢查询日志到表中\nMySQL支持将慢查询日志保存到mysql.slow_log这张表中。通过@@global.log_output可以设置默认为TABLE，FILE和TABLE只能同时使用一个。\n\n```\nmysql> select @@global.log_output;\n+---------------------+\n| @@global.log_output |\n+---------------------+\n| FILE                |\n+---------------------+\n1 row in set (0.00 sec)\n\nmysql>\n```\n\n```\nset @@global.log_output='TABLE';\n```\n\n```\nmysql> show create table mysql.slow_log;\n+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n| Table    | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\n+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n| slow_log | CREATE TABLE `slow_log` (\n  `start_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  `user_host` mediumtext NOT NULL,\n  `query_time` time NOT NULL,\n  `lock_time` time NOT NULL,\n  `rows_sent` int(11) NOT NULL,\n  `rows_examined` int(11) NOT NULL,\n  `db` varchar(512) NOT NULL,\n  `last_insert_id` int(11) NOT NULL,\n  `insert_id` int(11) NOT NULL,\n  `server_id` int(10) unsigned NOT NULL,\n  `sql_text` mediumtext NOT NULL,\n  `thread_id` bigint(21) unsigned NOT NULL\n) ENGINE=CSV DEFAULT CHARSET=utf8 COMMENT='Slow log' |\n+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n1 row in set (0.00 sec)\n\nmysql>\n```\n\n我们可以用下列语句用来模仿慢查询；\n\n```\nselect sleep(10);\n```\n\n```\nmysql> select * from mysql.slow_Log\n    -> ;\nERROR 1146 (42S02): Table 'mysql.slow_Log' doesn't exist\nmysql> select *  from mysql.slow_log;\n+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+\n| start_time          | user_host                 | query_time | lock_time | rows_sent | rows_examined | db | last_insert_id | insert_id | server_id | sql_text         | thread_id |\n+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+\n| 2016-03-21 23:07:15 | root[root] @ localhost [] | 00:00:10   | 00:00:00  |         1 |             0 |    |              0 |         0 |         0 | select sleep(10) |         2 |\n+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+\n1 row in set (0.01 sec)\n\nmysql>\n```\n\n\n### 慢查询日志分析\n1. 可以使用MySQL自带的mysqldumpslow工具。使用很简单，可以跟-help来查看具体的用法。\n\n```\n# -s：排序方式。c , t , l , r 表示记录次数、时间、查询时间的多少、返回的记录数排序；\n# ac , at , al , ar 表示相应的倒叙； # -t：返回前面多少条的数据；\n# -g：包含什么，大小写不敏感的； mysqldumpslow -s r -t 10 /slowquery.log\n#slow记录最多的10个语句 mysqldumpslow -s t -t 10 -g \"left join\" /slowquery.log\n#按照时间排序前10中含有\"left join\"的\n```\n\n2. 可以导到mysql.slow_query表中，然后通过sql语句进行分析。\n3. 使用第三方工具，下面会有介绍。\n\n\n### pt-query-digest\npt-query-digest可以从普通MySQL日志，慢查询日志以及二进制日志中分析查询，甚至可以从SHOW PROCESSLIST和MySQL协议的tcpdump中进行分析，如果没有指定文件，它从标准输入流（STDIN）中读取数据。\n最简单地用法如下：\n\n```\npt-query-digest slow.logs\n```\n\n输出信息大致如下:\n\n```\n\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/MySQL-2-开启慢日志优化.md","raw":"---\ntitle: MySQL(2) 开启慢日志优化\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: mysql-slow-query\nid: 6\nupdated: '2017-04-21 13:40:06'\ndate: 2016-03-22 15:16:26\n---\n\n# 工欲善其事，必先利其器 -- mysql开启慢日志优化\n\n\n### 慢查询日志\n顾名思义就是记录查询比较慢得日志。\n\n\n### 测试环境\n\n* mysql-server 5.6\n* CentOS 6.5\n* VMware Fushion 8 pro\n\n\n首先，第一部查看是否已经开启慢查询日志：\n\n```\nmysql> show variables like '%slow%';\n+---------------------+---------------------------------+\n| Variable_name       | Value                           |\n+---------------------+---------------------------------+\n| log_slow_queries    | OFF                             |\n| slow_launch_time    | 2                               |\n| slow_query_log      | OFF                             |\n| slow_query_log_file | /var/run/mysqld/mysqld-slow.log |\n+---------------------+---------------------------------+\n4 rows in set (0.00 sec)\n\nmysql>\n```\n\n打开慢查询日志。修改MySQL的配置文件my.cnf一般是在/etc目录下面，加上下面三行配置后重启MySQL。\n\n```\nslow_query_log = ON\nslow_launch_time = 2\nslow_query_log_file = /usr/local/mysql/data/slow_query.log\n\n```\nslow_launch_time只能精确到秒，如果需要更精确可以使用一些第三方的工具比如后面介绍的pt-query-digest\n\n```\nmysql> show variables like '%slow%';\n+---------------------------+--------------------------------------+\n| Variable_name             | Value                                |\n+---------------------------+--------------------------------------+\n| log_slow_admin_statements | OFF                                  |\n| log_slow_slave_statements | OFF                                  |\n| slow_launch_time          | 2                                    |\n| slow_query_log            | ON                                   |\n| slow_query_log_file       | /usr/local/mysql/data/slow_query.log |\n+---------------------------+--------------------------------------+\n5 rows in set (0.00 sec)\n\nmysql>\n```\n> Tips: 我这里用的MySQL版本是5.6，不同版本的MySQL开启慢查询的配置是不同的，比如5.6之前的某些版本是long_query_time, long_query_time和log-slow-queries。可以先在终端执行show variables like '%slow%';查看下当前版本具体配置是什么。\n\n也可以在终端中通过设置全局变量来打开慢查询日志：\n\n```\nset @@global.slow_query_log = ON;\n```\n\n### 保持慢查询日志到表中\nMySQL支持将慢查询日志保存到mysql.slow_log这张表中。通过@@global.log_output可以设置默认为TABLE，FILE和TABLE只能同时使用一个。\n\n```\nmysql> select @@global.log_output;\n+---------------------+\n| @@global.log_output |\n+---------------------+\n| FILE                |\n+---------------------+\n1 row in set (0.00 sec)\n\nmysql>\n```\n\n```\nset @@global.log_output='TABLE';\n```\n\n```\nmysql> show create table mysql.slow_log;\n+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n| Table    | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\n+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n| slow_log | CREATE TABLE `slow_log` (\n  `start_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  `user_host` mediumtext NOT NULL,\n  `query_time` time NOT NULL,\n  `lock_time` time NOT NULL,\n  `rows_sent` int(11) NOT NULL,\n  `rows_examined` int(11) NOT NULL,\n  `db` varchar(512) NOT NULL,\n  `last_insert_id` int(11) NOT NULL,\n  `insert_id` int(11) NOT NULL,\n  `server_id` int(10) unsigned NOT NULL,\n  `sql_text` mediumtext NOT NULL,\n  `thread_id` bigint(21) unsigned NOT NULL\n) ENGINE=CSV DEFAULT CHARSET=utf8 COMMENT='Slow log' |\n+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n1 row in set (0.00 sec)\n\nmysql>\n```\n\n我们可以用下列语句用来模仿慢查询；\n\n```\nselect sleep(10);\n```\n\n```\nmysql> select * from mysql.slow_Log\n    -> ;\nERROR 1146 (42S02): Table 'mysql.slow_Log' doesn't exist\nmysql> select *  from mysql.slow_log;\n+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+\n| start_time          | user_host                 | query_time | lock_time | rows_sent | rows_examined | db | last_insert_id | insert_id | server_id | sql_text         | thread_id |\n+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+\n| 2016-03-21 23:07:15 | root[root] @ localhost [] | 00:00:10   | 00:00:00  |         1 |             0 |    |              0 |         0 |         0 | select sleep(10) |         2 |\n+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+\n1 row in set (0.01 sec)\n\nmysql>\n```\n\n\n### 慢查询日志分析\n1. 可以使用MySQL自带的mysqldumpslow工具。使用很简单，可以跟-help来查看具体的用法。\n\n```\n# -s：排序方式。c , t , l , r 表示记录次数、时间、查询时间的多少、返回的记录数排序；\n# ac , at , al , ar 表示相应的倒叙； # -t：返回前面多少条的数据；\n# -g：包含什么，大小写不敏感的； mysqldumpslow -s r -t 10 /slowquery.log\n#slow记录最多的10个语句 mysqldumpslow -s t -t 10 -g \"left join\" /slowquery.log\n#按照时间排序前10中含有\"left join\"的\n```\n\n2. 可以导到mysql.slow_query表中，然后通过sql语句进行分析。\n3. 使用第三方工具，下面会有介绍。\n\n\n### pt-query-digest\npt-query-digest可以从普通MySQL日志，慢查询日志以及二进制日志中分析查询，甚至可以从SHOW PROCESSLIST和MySQL协议的tcpdump中进行分析，如果没有指定文件，它从标准输入流（STDIN）中读取数据。\n最简单地用法如下：\n\n```\npt-query-digest slow.logs\n```\n\n输出信息大致如下:\n\n```\n\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"mysql-slow-query","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqb7004y41tptgm60y8o","content":"<h1 id=\"工欲善其事，必先利其器-–-mysql开启慢日志优化\"><a href=\"#工欲善其事，必先利其器-–-mysql开启慢日志优化\" class=\"headerlink\" title=\"工欲善其事，必先利其器 – mysql开启慢日志优化\"></a>工欲善其事，必先利其器 – mysql开启慢日志优化</h1><h3 id=\"慢查询日志\"><a href=\"#慢查询日志\" class=\"headerlink\" title=\"慢查询日志\"></a>慢查询日志</h3><p>顾名思义就是记录查询比较慢得日志。</p>\n<h3 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h3><ul>\n<li>mysql-server 5.6</li>\n<li>CentOS 6.5</li>\n<li>VMware Fushion 8 pro</li>\n</ul>\n<p>首先，第一部查看是否已经开启慢查询日志：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like &apos;%slow%&apos;;</div><div class=\"line\">+---------------------+---------------------------------+</div><div class=\"line\">| Variable_name       | Value                           |</div><div class=\"line\">+---------------------+---------------------------------+</div><div class=\"line\">| log_slow_queries    | OFF                             |</div><div class=\"line\">| slow_launch_time    | 2                               |</div><div class=\"line\">| slow_query_log      | OFF                             |</div><div class=\"line\">| slow_query_log_file | /var/run/mysqld/mysqld-slow.log |</div><div class=\"line\">+---------------------+---------------------------------+</div><div class=\"line\">4 rows in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<p>打开慢查询日志。修改MySQL的配置文件my.cnf一般是在/etc目录下面，加上下面三行配置后重启MySQL。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">slow_query_log = ON</div><div class=\"line\">slow_launch_time = 2</div><div class=\"line\">slow_query_log_file = /usr/local/mysql/data/slow_query.log</div></pre></td></tr></table></figure>\n<p>slow_launch_time只能精确到秒，如果需要更精确可以使用一些第三方的工具比如后面介绍的pt-query-digest</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like &apos;%slow%&apos;;</div><div class=\"line\">+---------------------------+--------------------------------------+</div><div class=\"line\">| Variable_name             | Value                                |</div><div class=\"line\">+---------------------------+--------------------------------------+</div><div class=\"line\">| log_slow_admin_statements | OFF                                  |</div><div class=\"line\">| log_slow_slave_statements | OFF                                  |</div><div class=\"line\">| slow_launch_time          | 2                                    |</div><div class=\"line\">| slow_query_log            | ON                                   |</div><div class=\"line\">| slow_query_log_file       | /usr/local/mysql/data/slow_query.log |</div><div class=\"line\">+---------------------------+--------------------------------------+</div><div class=\"line\">5 rows in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>Tips: 我这里用的MySQL版本是5.6，不同版本的MySQL开启慢查询的配置是不同的，比如5.6之前的某些版本是long_query_time, long_query_time和log-slow-queries。可以先在终端执行show variables like ‘%slow%’;查看下当前版本具体配置是什么。</p>\n</blockquote>\n<p>也可以在终端中通过设置全局变量来打开慢查询日志：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">set @@global.slow_query_log = ON;</div></pre></td></tr></table></figure>\n<h3 id=\"保持慢查询日志到表中\"><a href=\"#保持慢查询日志到表中\" class=\"headerlink\" title=\"保持慢查询日志到表中\"></a>保持慢查询日志到表中</h3><p>MySQL支持将慢查询日志保存到mysql.slow_log这张表中。通过@@global.log_output可以设置默认为TABLE，FILE和TABLE只能同时使用一个。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select @@global.log_output;</div><div class=\"line\">+---------------------+</div><div class=\"line\">| @@global.log_output |</div><div class=\"line\">+---------------------+</div><div class=\"line\">| FILE                |</div><div class=\"line\">+---------------------+</div><div class=\"line\">1 row in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">set @@global.log_output=&apos;TABLE&apos;;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show create table mysql.slow_log;</div><div class=\"line\">+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</div><div class=\"line\">| Table    | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |</div><div class=\"line\">+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</div><div class=\"line\">| slow_log | CREATE TABLE `slow_log` (</div><div class=\"line\">  `start_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</div><div class=\"line\">  `user_host` mediumtext NOT NULL,</div><div class=\"line\">  `query_time` time NOT NULL,</div><div class=\"line\">  `lock_time` time NOT NULL,</div><div class=\"line\">  `rows_sent` int(11) NOT NULL,</div><div class=\"line\">  `rows_examined` int(11) NOT NULL,</div><div class=\"line\">  `db` varchar(512) NOT NULL,</div><div class=\"line\">  `last_insert_id` int(11) NOT NULL,</div><div class=\"line\">  `insert_id` int(11) NOT NULL,</div><div class=\"line\">  `server_id` int(10) unsigned NOT NULL,</div><div class=\"line\">  `sql_text` mediumtext NOT NULL,</div><div class=\"line\">  `thread_id` bigint(21) unsigned NOT NULL</div><div class=\"line\">) ENGINE=CSV DEFAULT CHARSET=utf8 COMMENT=&apos;Slow log&apos; |</div><div class=\"line\">+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</div><div class=\"line\">1 row in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<p>我们可以用下列语句用来模仿慢查询；</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">select sleep(10);</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from mysql.slow_Log</div><div class=\"line\">    -&gt; ;</div><div class=\"line\">ERROR 1146 (42S02): Table &apos;mysql.slow_Log&apos; doesn&apos;t exist</div><div class=\"line\">mysql&gt; select *  from mysql.slow_log;</div><div class=\"line\">+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+</div><div class=\"line\">| start_time          | user_host                 | query_time | lock_time | rows_sent | rows_examined | db | last_insert_id | insert_id | server_id | sql_text         | thread_id |</div><div class=\"line\">+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+</div><div class=\"line\">| 2016-03-21 23:07:15 | root[root] @ localhost [] | 00:00:10   | 00:00:00  |         1 |             0 |    |              0 |         0 |         0 | select sleep(10) |         2 |</div><div class=\"line\">+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+</div><div class=\"line\">1 row in set (0.01 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"慢查询日志分析\"><a href=\"#慢查询日志分析\" class=\"headerlink\" title=\"慢查询日志分析\"></a>慢查询日志分析</h3><ol>\n<li>可以使用MySQL自带的mysqldumpslow工具。使用很简单，可以跟-help来查看具体的用法。</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># -s：排序方式。c , t , l , r 表示记录次数、时间、查询时间的多少、返回的记录数排序；</div><div class=\"line\"># ac , at , al , ar 表示相应的倒叙； # -t：返回前面多少条的数据；</div><div class=\"line\"># -g：包含什么，大小写不敏感的； mysqldumpslow -s r -t 10 /slowquery.log</div><div class=\"line\">#slow记录最多的10个语句 mysqldumpslow -s t -t 10 -g &quot;left join&quot; /slowquery.log</div><div class=\"line\">#按照时间排序前10中含有&quot;left join&quot;的</div></pre></td></tr></table></figure>\n<ol>\n<li>可以导到mysql.slow_query表中，然后通过sql语句进行分析。</li>\n<li>使用第三方工具，下面会有介绍。</li>\n</ol>\n<h3 id=\"pt-query-digest\"><a href=\"#pt-query-digest\" class=\"headerlink\" title=\"pt-query-digest\"></a>pt-query-digest</h3><p>pt-query-digest可以从普通MySQL日志，慢查询日志以及二进制日志中分析查询，甚至可以从SHOW PROCESSLIST和MySQL协议的tcpdump中进行分析，如果没有指定文件，它从标准输入流（STDIN）中读取数据。<br>最简单地用法如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pt-query-digest slow.logs</div></pre></td></tr></table></figure>\n<p>输出信息大致如下:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"工欲善其事，必先利其器-–-mysql开启慢日志优化\"><a href=\"#工欲善其事，必先利其器-–-mysql开启慢日志优化\" class=\"headerlink\" title=\"工欲善其事，必先利其器 – mysql开启慢日志优化\"></a>工欲善其事，必先利其器 – mysql开启慢日志优化</h1><h3 id=\"慢查询日志\"><a href=\"#慢查询日志\" class=\"headerlink\" title=\"慢查询日志\"></a>慢查询日志</h3><p>顾名思义就是记录查询比较慢得日志。</p>\n<h3 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h3><ul>\n<li>mysql-server 5.6</li>\n<li>CentOS 6.5</li>\n<li>VMware Fushion 8 pro</li>\n</ul>\n<p>首先，第一部查看是否已经开启慢查询日志：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like &apos;%slow%&apos;;</div><div class=\"line\">+---------------------+---------------------------------+</div><div class=\"line\">| Variable_name       | Value                           |</div><div class=\"line\">+---------------------+---------------------------------+</div><div class=\"line\">| log_slow_queries    | OFF                             |</div><div class=\"line\">| slow_launch_time    | 2                               |</div><div class=\"line\">| slow_query_log      | OFF                             |</div><div class=\"line\">| slow_query_log_file | /var/run/mysqld/mysqld-slow.log |</div><div class=\"line\">+---------------------+---------------------------------+</div><div class=\"line\">4 rows in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<p>打开慢查询日志。修改MySQL的配置文件my.cnf一般是在/etc目录下面，加上下面三行配置后重启MySQL。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">slow_query_log = ON</div><div class=\"line\">slow_launch_time = 2</div><div class=\"line\">slow_query_log_file = /usr/local/mysql/data/slow_query.log</div></pre></td></tr></table></figure>\n<p>slow_launch_time只能精确到秒，如果需要更精确可以使用一些第三方的工具比如后面介绍的pt-query-digest</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like &apos;%slow%&apos;;</div><div class=\"line\">+---------------------------+--------------------------------------+</div><div class=\"line\">| Variable_name             | Value                                |</div><div class=\"line\">+---------------------------+--------------------------------------+</div><div class=\"line\">| log_slow_admin_statements | OFF                                  |</div><div class=\"line\">| log_slow_slave_statements | OFF                                  |</div><div class=\"line\">| slow_launch_time          | 2                                    |</div><div class=\"line\">| slow_query_log            | ON                                   |</div><div class=\"line\">| slow_query_log_file       | /usr/local/mysql/data/slow_query.log |</div><div class=\"line\">+---------------------------+--------------------------------------+</div><div class=\"line\">5 rows in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>Tips: 我这里用的MySQL版本是5.6，不同版本的MySQL开启慢查询的配置是不同的，比如5.6之前的某些版本是long_query_time, long_query_time和log-slow-queries。可以先在终端执行show variables like ‘%slow%’;查看下当前版本具体配置是什么。</p>\n</blockquote>\n<p>也可以在终端中通过设置全局变量来打开慢查询日志：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">set @@global.slow_query_log = ON;</div></pre></td></tr></table></figure>\n<h3 id=\"保持慢查询日志到表中\"><a href=\"#保持慢查询日志到表中\" class=\"headerlink\" title=\"保持慢查询日志到表中\"></a>保持慢查询日志到表中</h3><p>MySQL支持将慢查询日志保存到mysql.slow_log这张表中。通过@@global.log_output可以设置默认为TABLE，FILE和TABLE只能同时使用一个。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select @@global.log_output;</div><div class=\"line\">+---------------------+</div><div class=\"line\">| @@global.log_output |</div><div class=\"line\">+---------------------+</div><div class=\"line\">| FILE                |</div><div class=\"line\">+---------------------+</div><div class=\"line\">1 row in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">set @@global.log_output=&apos;TABLE&apos;;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show create table mysql.slow_log;</div><div class=\"line\">+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</div><div class=\"line\">| Table    | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |</div><div class=\"line\">+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</div><div class=\"line\">| slow_log | CREATE TABLE `slow_log` (</div><div class=\"line\">  `start_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</div><div class=\"line\">  `user_host` mediumtext NOT NULL,</div><div class=\"line\">  `query_time` time NOT NULL,</div><div class=\"line\">  `lock_time` time NOT NULL,</div><div class=\"line\">  `rows_sent` int(11) NOT NULL,</div><div class=\"line\">  `rows_examined` int(11) NOT NULL,</div><div class=\"line\">  `db` varchar(512) NOT NULL,</div><div class=\"line\">  `last_insert_id` int(11) NOT NULL,</div><div class=\"line\">  `insert_id` int(11) NOT NULL,</div><div class=\"line\">  `server_id` int(10) unsigned NOT NULL,</div><div class=\"line\">  `sql_text` mediumtext NOT NULL,</div><div class=\"line\">  `thread_id` bigint(21) unsigned NOT NULL</div><div class=\"line\">) ENGINE=CSV DEFAULT CHARSET=utf8 COMMENT=&apos;Slow log&apos; |</div><div class=\"line\">+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</div><div class=\"line\">1 row in set (0.00 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<p>我们可以用下列语句用来模仿慢查询；</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">select sleep(10);</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from mysql.slow_Log</div><div class=\"line\">    -&gt; ;</div><div class=\"line\">ERROR 1146 (42S02): Table &apos;mysql.slow_Log&apos; doesn&apos;t exist</div><div class=\"line\">mysql&gt; select *  from mysql.slow_log;</div><div class=\"line\">+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+</div><div class=\"line\">| start_time          | user_host                 | query_time | lock_time | rows_sent | rows_examined | db | last_insert_id | insert_id | server_id | sql_text         | thread_id |</div><div class=\"line\">+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+</div><div class=\"line\">| 2016-03-21 23:07:15 | root[root] @ localhost [] | 00:00:10   | 00:00:00  |         1 |             0 |    |              0 |         0 |         0 | select sleep(10) |         2 |</div><div class=\"line\">+---------------------+---------------------------+------------+-----------+-----------+---------------+----+----------------+-----------+-----------+------------------+-----------+</div><div class=\"line\">1 row in set (0.01 sec)</div><div class=\"line\"></div><div class=\"line\">mysql&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"慢查询日志分析\"><a href=\"#慢查询日志分析\" class=\"headerlink\" title=\"慢查询日志分析\"></a>慢查询日志分析</h3><ol>\n<li>可以使用MySQL自带的mysqldumpslow工具。使用很简单，可以跟-help来查看具体的用法。</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># -s：排序方式。c , t , l , r 表示记录次数、时间、查询时间的多少、返回的记录数排序；</div><div class=\"line\"># ac , at , al , ar 表示相应的倒叙； # -t：返回前面多少条的数据；</div><div class=\"line\"># -g：包含什么，大小写不敏感的； mysqldumpslow -s r -t 10 /slowquery.log</div><div class=\"line\">#slow记录最多的10个语句 mysqldumpslow -s t -t 10 -g &quot;left join&quot; /slowquery.log</div><div class=\"line\">#按照时间排序前10中含有&quot;left join&quot;的</div></pre></td></tr></table></figure>\n<ol>\n<li>可以导到mysql.slow_query表中，然后通过sql语句进行分析。</li>\n<li>使用第三方工具，下面会有介绍。</li>\n</ol>\n<h3 id=\"pt-query-digest\"><a href=\"#pt-query-digest\" class=\"headerlink\" title=\"pt-query-digest\"></a>pt-query-digest</h3><p>pt-query-digest可以从普通MySQL日志，慢查询日志以及二进制日志中分析查询，甚至可以从SHOW PROCESSLIST和MySQL协议的tcpdump中进行分析，如果没有指定文件，它从标准输入流（STDIN）中读取数据。<br>最简单地用法如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pt-query-digest slow.logs</div></pre></td></tr></table></figure>\n<p>输出信息大致如下:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div></pre></td></tr></table></figure>\n"},{"title":"MySQL(3) mysqldump常用参数","id":"41","updated":"2017-04-21T05:35:33.000Z","date":"2016-05-04T20:30:11.000Z","_content":"\n常用的mysqldump命令组合。\n\n## 备份数据库\n```\nmysqldump db_name > bak_name.sql\nmysqldump -A -u [dbuser] -p db_name > bak_name.sql\nmysqldump -d -A --add-drop-table -uroot -p >xxx.sql\n```\n\n## 备份所有库到一个单独的文件\n```shell\nmysql -e 'show databases' | sed -n '2,$p' | xargs -I DB 'mysqldump DB > DB.sql'\n```\n\n### 1. 导出结构不导出数据\n```\nmysqldump　--opt　-d　db_name　-u　root　-p　>　xxx.sql\n```\n\n### 2. 导出数据不导出结构\n```\nmysqldump　-t　db_name　-uroot　-p　>　xxx.sql\n```\n\n### 3. 导出数据和表结构\n```\nmysqldump　db_name　-uroot　-p　>　xxx.sql\n```\n\n### 4. 导出特定表的结构\n```\nmysqldump　-uroot　-p　-B　db_name　--table　tb_name　>　xxx.sql\n```\n\n## 导入数据\n 因为mysqldump导出的是完整的SQL语句，所以用mysql客户程序很容易就能把数据导入了：\n```\nmysql -u db_user -p db_name  < xxx.sql\nmysql> source /path/xxx.sql\n```\n\n## mysqldump参数详解：\n<code>–all-databases , -A </code>\n导出全部数据库<br>\nmysqldump -uroot -p –all-databases\n\n<code>–all-tablespaces , -Y</code>\n导出全部表空间<br>\nmysqldump -uroot -p –all-databases –all-tablespaces\n\n<code>–no-tablespaces , -y</code>\n不导出任何表空间信息<br>\nmysqldump -uroot -p –all-databases –no-tablespaces\n\n<code>–add-drop-database</code>\n每个数据库创建之前添加drop数据库语句<br>\nmysqldump -uroot -p –all-databases –add-drop-database\n\n<code>–add-drop-table</code>\n每个数据表创建之前添加drop数据表语句。(默认为打开状态，使用–skip-add-drop-table取消选项)<br>\nmysqldump -uroot -p –all-databases (默认添加drop语句)\nmysqldump -uroot -p –all-databases –skip-add-drop-table (取消drop语句)\n\n<code>–add-locks</code>\n在每个表导出之前增加LOCK TABLES并且之后UNLOCK TABLE。(默认为打开状态，使用–skip-add-locks取消选项)<br>\nmysqldump -uroot -p –all-databases(默认添加LOCK语句)\nmysqldump -uroot -p –all-databases –skip-add-locks (取消LOCK语句)\n\n<code>–comments</code>\n附加注释信息。<br>\n默认为打开，可以用–skip-comments取消mysqldump -uroot -p –all-databases (默认记录注释)mysqldump -uroot -p –all-databases \"code\"\nskip-comments (取消注释)\n\n<code>–compact</code>\n导出更少的输出信息(用于调试),去掉注释和头尾等结构,可以使用选项：–skip-add-drop-table –skip-add-locks –skip-comments –skip-disable-keys<br>\nmysqldump -uroot -p –all-databases –compact\n\n<code>–complete-insert, -c</code>\n使用完整的insert语句(包含列名称)。这么做能提高插入效率，但是可能会受到max_allowed_packet参数的影响而导致插入失败。<br>\nmysqldump -uroot -p –all-databases –complete-insert\n\n<code>–compress, -C</code>\n在客户端和服务器之间启用压缩传递所有信息<br>\nmysqldump -uroot -p –all-databases –compress\n\n<code>–databases, -B</code>\n导出几个数据库。参数后面所有名字参量都被看作数据库名。<br>\nmysqldump -uroot -p –databases test mysql\n\n<code>–debug</code>\n输出debug信息，用于调试。<br>\n默认值为：d:t:o,/tmp/mysqldump.trace<br>\nmysqldump -uroot -p –all-databases –debug<br>\nmysqldump -uroot -p –all-databases –debug=\"d:t:o,/tmp/debug.trace\"\n\n<code>–debug-info</code>\n输出调试信息并退出<br>\nmysqldump -uroot -p –all-databases –debug-info\n\n<code>–default-character-set</code>\n设置默认字符集，默认值为utf8<br>\nmysqldump -uroot -p –all-databases –default-character-set=latin1\n\n<code>–delayed-insert</code>\n采用延时插入方式（INSERT DELAYED）导出数据<br>\nmysqldump -uroot -p –all-databases –delayed-insert\n\n<code>–events, -E</code>\n导出事件<br>\nmysqldump -uroot -p –all-databases –events\n\n<code>–flush-logs</code>\n开始导出之前刷新日志<br>\n请注意：假如一次导出多个数据库(使用选项–databases或者–all-databases)，将会逐个数据库刷新日志。除使用–lock-all-tables或者–master-data外。在这种情况下，日志将会被刷新一次，相应的所以表同时被锁定。因此，如果打算同时导出和刷新日志应该使用–lock-all-tables 或者–master-data 和–flush-logs.<br>\nmysqldump -uroot -p –all-databases –flush-logs\n\n<code>–flush-privileges</code>\n在导出mysql数据库之后，发出一条FLUSH PRIVILEGES 语句。为了正确恢复，该选项应该用于导出mysql数据库和依赖mysql数据库数据的任何时候。<br>\nmysqldump -uroot -p –all-databases –flush-privileges\n\n\n<code>–force</code>\n在导出过程中忽略出现的SQL错误<br>\nmysqldump -uroot -p –all-databases –force\n\n<code>–host, -h</code>\n需要导出的主机信息<br>\nmysqldump -uroot -p –host=localhost –all-databases\n\n<code>–ignore-table</code>\n\n不导出指定表。\n指定忽略多个表时，需要重复多次，每次一个表。每个表必须同时指定数据库和表名.\n例如：<br>–ignore-table=database.table1 –ignore-table=database.table2 ……<br>\nmysqldump -uroot -p –host=localhost –all-databases –ignore-table=mysql.user\n\n\n<code>–lock-all-tables, -x</code>\n提交请求锁定所有数据库中的所有表，以保证数据的一致性。\n这是一个全局读锁，并且自动关闭–single-transaction 和–lock-tables 选项。<br>\nmysqldump -uroot -p –host=localhost –all-databases –lock-all-tables\n\n<code>–lock-tables, -l</code>\n开始导出前，锁定所有表。<br>\n用READ LOCAL锁定表以允许MyISAM表并行插入。对于支持事务的表例如InnoDB和BDB，–single-transaction是一个更好的选择，因为它根本不需要锁定表.<br />\n请注意当导出多个数据库时，–lock-tables分别为每个数据库锁定表。因此，该选项不能保证导出文件中的表在数据库之间的逻辑一致性。不同数据库表的导出状态可以完全不同。<br>\nmysqldump -uroot -p –host=localhost –all-databases –lock-tables\n\n<code>–no-create-db, -n </code>\n只导出数据，而不添加CREATE DATABASE 语句。<br>\nmysqldump -uroot -p –host=localhost –all-databases –no-create-db\n\n<code>–no-create-info,-t</code>\n只导出数据，而不添加CREATE TABLE 语句<br>\nmysqldump -uroot -p –host=localhost –all-databases –no-create-info\n\n<code> –no-data, -d </code>\n不导出任何数据，只导出数据库表结构<br>\nmysqldump -uroot -p –host=localhost –all-databases –no-data\n\n<code> –password, -p </code>\n连接数据库密码\n\n<code> –port, -P </code>\n连接数据库端口号\n\n<code> –user, -u </code>\n指定连接的用户名。\n","source":"_posts/MySQL-3-mysqldump常用参数.md","raw":"---\ntitle: MySQL(3) mysqldump常用参数\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: mysqldumpchang-yong-can-shu\nid: 41\nupdated: '2017-04-21 13:35:33'\ndate: 2016-05-05 04:30:11\n---\n\n常用的mysqldump命令组合。\n\n## 备份数据库\n```\nmysqldump db_name > bak_name.sql\nmysqldump -A -u [dbuser] -p db_name > bak_name.sql\nmysqldump -d -A --add-drop-table -uroot -p >xxx.sql\n```\n\n## 备份所有库到一个单独的文件\n```shell\nmysql -e 'show databases' | sed -n '2,$p' | xargs -I DB 'mysqldump DB > DB.sql'\n```\n\n### 1. 导出结构不导出数据\n```\nmysqldump　--opt　-d　db_name　-u　root　-p　>　xxx.sql\n```\n\n### 2. 导出数据不导出结构\n```\nmysqldump　-t　db_name　-uroot　-p　>　xxx.sql\n```\n\n### 3. 导出数据和表结构\n```\nmysqldump　db_name　-uroot　-p　>　xxx.sql\n```\n\n### 4. 导出特定表的结构\n```\nmysqldump　-uroot　-p　-B　db_name　--table　tb_name　>　xxx.sql\n```\n\n## 导入数据\n 因为mysqldump导出的是完整的SQL语句，所以用mysql客户程序很容易就能把数据导入了：\n```\nmysql -u db_user -p db_name  < xxx.sql\nmysql> source /path/xxx.sql\n```\n\n## mysqldump参数详解：\n<code>–all-databases , -A </code>\n导出全部数据库<br>\nmysqldump -uroot -p –all-databases\n\n<code>–all-tablespaces , -Y</code>\n导出全部表空间<br>\nmysqldump -uroot -p –all-databases –all-tablespaces\n\n<code>–no-tablespaces , -y</code>\n不导出任何表空间信息<br>\nmysqldump -uroot -p –all-databases –no-tablespaces\n\n<code>–add-drop-database</code>\n每个数据库创建之前添加drop数据库语句<br>\nmysqldump -uroot -p –all-databases –add-drop-database\n\n<code>–add-drop-table</code>\n每个数据表创建之前添加drop数据表语句。(默认为打开状态，使用–skip-add-drop-table取消选项)<br>\nmysqldump -uroot -p –all-databases (默认添加drop语句)\nmysqldump -uroot -p –all-databases –skip-add-drop-table (取消drop语句)\n\n<code>–add-locks</code>\n在每个表导出之前增加LOCK TABLES并且之后UNLOCK TABLE。(默认为打开状态，使用–skip-add-locks取消选项)<br>\nmysqldump -uroot -p –all-databases(默认添加LOCK语句)\nmysqldump -uroot -p –all-databases –skip-add-locks (取消LOCK语句)\n\n<code>–comments</code>\n附加注释信息。<br>\n默认为打开，可以用–skip-comments取消mysqldump -uroot -p –all-databases (默认记录注释)mysqldump -uroot -p –all-databases \"code\"\nskip-comments (取消注释)\n\n<code>–compact</code>\n导出更少的输出信息(用于调试),去掉注释和头尾等结构,可以使用选项：–skip-add-drop-table –skip-add-locks –skip-comments –skip-disable-keys<br>\nmysqldump -uroot -p –all-databases –compact\n\n<code>–complete-insert, -c</code>\n使用完整的insert语句(包含列名称)。这么做能提高插入效率，但是可能会受到max_allowed_packet参数的影响而导致插入失败。<br>\nmysqldump -uroot -p –all-databases –complete-insert\n\n<code>–compress, -C</code>\n在客户端和服务器之间启用压缩传递所有信息<br>\nmysqldump -uroot -p –all-databases –compress\n\n<code>–databases, -B</code>\n导出几个数据库。参数后面所有名字参量都被看作数据库名。<br>\nmysqldump -uroot -p –databases test mysql\n\n<code>–debug</code>\n输出debug信息，用于调试。<br>\n默认值为：d:t:o,/tmp/mysqldump.trace<br>\nmysqldump -uroot -p –all-databases –debug<br>\nmysqldump -uroot -p –all-databases –debug=\"d:t:o,/tmp/debug.trace\"\n\n<code>–debug-info</code>\n输出调试信息并退出<br>\nmysqldump -uroot -p –all-databases –debug-info\n\n<code>–default-character-set</code>\n设置默认字符集，默认值为utf8<br>\nmysqldump -uroot -p –all-databases –default-character-set=latin1\n\n<code>–delayed-insert</code>\n采用延时插入方式（INSERT DELAYED）导出数据<br>\nmysqldump -uroot -p –all-databases –delayed-insert\n\n<code>–events, -E</code>\n导出事件<br>\nmysqldump -uroot -p –all-databases –events\n\n<code>–flush-logs</code>\n开始导出之前刷新日志<br>\n请注意：假如一次导出多个数据库(使用选项–databases或者–all-databases)，将会逐个数据库刷新日志。除使用–lock-all-tables或者–master-data外。在这种情况下，日志将会被刷新一次，相应的所以表同时被锁定。因此，如果打算同时导出和刷新日志应该使用–lock-all-tables 或者–master-data 和–flush-logs.<br>\nmysqldump -uroot -p –all-databases –flush-logs\n\n<code>–flush-privileges</code>\n在导出mysql数据库之后，发出一条FLUSH PRIVILEGES 语句。为了正确恢复，该选项应该用于导出mysql数据库和依赖mysql数据库数据的任何时候。<br>\nmysqldump -uroot -p –all-databases –flush-privileges\n\n\n<code>–force</code>\n在导出过程中忽略出现的SQL错误<br>\nmysqldump -uroot -p –all-databases –force\n\n<code>–host, -h</code>\n需要导出的主机信息<br>\nmysqldump -uroot -p –host=localhost –all-databases\n\n<code>–ignore-table</code>\n\n不导出指定表。\n指定忽略多个表时，需要重复多次，每次一个表。每个表必须同时指定数据库和表名.\n例如：<br>–ignore-table=database.table1 –ignore-table=database.table2 ……<br>\nmysqldump -uroot -p –host=localhost –all-databases –ignore-table=mysql.user\n\n\n<code>–lock-all-tables, -x</code>\n提交请求锁定所有数据库中的所有表，以保证数据的一致性。\n这是一个全局读锁，并且自动关闭–single-transaction 和–lock-tables 选项。<br>\nmysqldump -uroot -p –host=localhost –all-databases –lock-all-tables\n\n<code>–lock-tables, -l</code>\n开始导出前，锁定所有表。<br>\n用READ LOCAL锁定表以允许MyISAM表并行插入。对于支持事务的表例如InnoDB和BDB，–single-transaction是一个更好的选择，因为它根本不需要锁定表.<br />\n请注意当导出多个数据库时，–lock-tables分别为每个数据库锁定表。因此，该选项不能保证导出文件中的表在数据库之间的逻辑一致性。不同数据库表的导出状态可以完全不同。<br>\nmysqldump -uroot -p –host=localhost –all-databases –lock-tables\n\n<code>–no-create-db, -n </code>\n只导出数据，而不添加CREATE DATABASE 语句。<br>\nmysqldump -uroot -p –host=localhost –all-databases –no-create-db\n\n<code>–no-create-info,-t</code>\n只导出数据，而不添加CREATE TABLE 语句<br>\nmysqldump -uroot -p –host=localhost –all-databases –no-create-info\n\n<code> –no-data, -d </code>\n不导出任何数据，只导出数据库表结构<br>\nmysqldump -uroot -p –host=localhost –all-databases –no-data\n\n<code> –password, -p </code>\n连接数据库密码\n\n<code> –port, -P </code>\n连接数据库端口号\n\n<code> –user, -u </code>\n指定连接的用户名。\n","slug":"mysqldumpchang-yong-can-shu","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqb9005241tpa1zk9l8l","content":"<p>常用的mysqldump命令组合。</p>\n<h2 id=\"备份数据库\"><a href=\"#备份数据库\" class=\"headerlink\" title=\"备份数据库\"></a>备份数据库</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump db_name &gt; bak_name.sql</div><div class=\"line\">mysqldump -A -u [dbuser] -p db_name &gt; bak_name.sql</div><div class=\"line\">mysqldump -d -A --add-drop-table -uroot -p &gt;xxx.sql</div></pre></td></tr></table></figure>\n<h2 id=\"备份所有库到一个单独的文件\"><a href=\"#备份所有库到一个单独的文件\" class=\"headerlink\" title=\"备份所有库到一个单独的文件\"></a>备份所有库到一个单独的文件</h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -e 'show databases' | sed -n '2,$p' | xargs -I DB 'mysqldump DB &gt; DB.sql'</div></pre></td></tr></table></figure>\n<h3 id=\"1-导出结构不导出数据\"><a href=\"#1-导出结构不导出数据\" class=\"headerlink\" title=\"1. 导出结构不导出数据\"></a>1. 导出结构不导出数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump　--opt　-d　db_name　-u　root　-p　&gt;　xxx.sql</div></pre></td></tr></table></figure>\n<h3 id=\"2-导出数据不导出结构\"><a href=\"#2-导出数据不导出结构\" class=\"headerlink\" title=\"2. 导出数据不导出结构\"></a>2. 导出数据不导出结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump　-t　db_name　-uroot　-p　&gt;　xxx.sql</div></pre></td></tr></table></figure>\n<h3 id=\"3-导出数据和表结构\"><a href=\"#3-导出数据和表结构\" class=\"headerlink\" title=\"3. 导出数据和表结构\"></a>3. 导出数据和表结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump　db_name　-uroot　-p　&gt;　xxx.sql</div></pre></td></tr></table></figure>\n<h3 id=\"4-导出特定表的结构\"><a href=\"#4-导出特定表的结构\" class=\"headerlink\" title=\"4. 导出特定表的结构\"></a>4. 导出特定表的结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump　-uroot　-p　-B　db_name　--table　tb_name　&gt;　xxx.sql</div></pre></td></tr></table></figure>\n<h2 id=\"导入数据\"><a href=\"#导入数据\" class=\"headerlink\" title=\"导入数据\"></a>导入数据</h2><p> 因为mysqldump导出的是完整的SQL语句，所以用mysql客户程序很容易就能把数据导入了：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -u db_user -p db_name  &lt; xxx.sql</div><div class=\"line\">mysql&gt; source /path/xxx.sql</div></pre></td></tr></table></figure></p>\n<h2 id=\"mysqldump参数详解：\"><a href=\"#mysqldump参数详解：\" class=\"headerlink\" title=\"mysqldump参数详解：\"></a>mysqldump参数详解：</h2><p><code>–all-databases , -A </code><br>导出全部数据库<br><br>mysqldump -uroot -p –all-databases</p>\n<p><code>–all-tablespaces , -Y</code><br>导出全部表空间<br><br>mysqldump -uroot -p –all-databases –all-tablespaces</p>\n<p><code>–no-tablespaces , -y</code><br>不导出任何表空间信息<br><br>mysqldump -uroot -p –all-databases –no-tablespaces</p>\n<p><code>–add-drop-database</code><br>每个数据库创建之前添加drop数据库语句<br><br>mysqldump -uroot -p –all-databases –add-drop-database</p>\n<p><code>–add-drop-table</code><br>每个数据表创建之前添加drop数据表语句。(默认为打开状态，使用–skip-add-drop-table取消选项)<br><br>mysqldump -uroot -p –all-databases (默认添加drop语句)<br>mysqldump -uroot -p –all-databases –skip-add-drop-table (取消drop语句)</p>\n<p><code>–add-locks</code><br>在每个表导出之前增加LOCK TABLES并且之后UNLOCK TABLE。(默认为打开状态，使用–skip-add-locks取消选项)<br><br>mysqldump -uroot -p –all-databases(默认添加LOCK语句)<br>mysqldump -uroot -p –all-databases –skip-add-locks (取消LOCK语句)</p>\n<p><code>–comments</code><br>附加注释信息。<br><br>默认为打开，可以用–skip-comments取消mysqldump -uroot -p –all-databases (默认记录注释)mysqldump -uroot -p –all-databases “code”<br>skip-comments (取消注释)</p>\n<p><code>–compact</code><br>导出更少的输出信息(用于调试),去掉注释和头尾等结构,可以使用选项：–skip-add-drop-table –skip-add-locks –skip-comments –skip-disable-keys<br><br>mysqldump -uroot -p –all-databases –compact</p>\n<p><code>–complete-insert, -c</code><br>使用完整的insert语句(包含列名称)。这么做能提高插入效率，但是可能会受到max_allowed_packet参数的影响而导致插入失败。<br><br>mysqldump -uroot -p –all-databases –complete-insert</p>\n<p><code>–compress, -C</code><br>在客户端和服务器之间启用压缩传递所有信息<br><br>mysqldump -uroot -p –all-databases –compress</p>\n<p><code>–databases, -B</code><br>导出几个数据库。参数后面所有名字参量都被看作数据库名。<br><br>mysqldump -uroot -p –databases test mysql</p>\n<p><code>–debug</code><br>输出debug信息，用于调试。<br><br>默认值为：d:t:o,/tmp/mysqldump.trace<br><br>mysqldump -uroot -p –all-databases –debug<br><br>mysqldump -uroot -p –all-databases –debug=”d:t:o,/tmp/debug.trace”</p>\n<p><code>–debug-info</code><br>输出调试信息并退出<br><br>mysqldump -uroot -p –all-databases –debug-info</p>\n<p><code>–default-character-set</code><br>设置默认字符集，默认值为utf8<br><br>mysqldump -uroot -p –all-databases –default-character-set=latin1</p>\n<p><code>–delayed-insert</code><br>采用延时插入方式（INSERT DELAYED）导出数据<br><br>mysqldump -uroot -p –all-databases –delayed-insert</p>\n<p><code>–events, -E</code><br>导出事件<br><br>mysqldump -uroot -p –all-databases –events</p>\n<p><code>–flush-logs</code><br>开始导出之前刷新日志<br><br>请注意：假如一次导出多个数据库(使用选项–databases或者–all-databases)，将会逐个数据库刷新日志。除使用–lock-all-tables或者–master-data外。在这种情况下，日志将会被刷新一次，相应的所以表同时被锁定。因此，如果打算同时导出和刷新日志应该使用–lock-all-tables 或者–master-data 和–flush-logs.<br><br>mysqldump -uroot -p –all-databases –flush-logs</p>\n<p><code>–flush-privileges</code><br>在导出mysql数据库之后，发出一条FLUSH PRIVILEGES 语句。为了正确恢复，该选项应该用于导出mysql数据库和依赖mysql数据库数据的任何时候。<br><br>mysqldump -uroot -p –all-databases –flush-privileges</p>\n<p><code>–force</code><br>在导出过程中忽略出现的SQL错误<br><br>mysqldump -uroot -p –all-databases –force</p>\n<p><code>–host, -h</code><br>需要导出的主机信息<br><br>mysqldump -uroot -p –host=localhost –all-databases</p>\n<p><code>–ignore-table</code></p>\n<p>不导出指定表。<br>指定忽略多个表时，需要重复多次，每次一个表。每个表必须同时指定数据库和表名.<br>例如：<br>–ignore-table=database.table1 –ignore-table=database.table2 ……<br><br>mysqldump -uroot -p –host=localhost –all-databases –ignore-table=mysql.user</p>\n<p><code>–lock-all-tables, -x</code><br>提交请求锁定所有数据库中的所有表，以保证数据的一致性。<br>这是一个全局读锁，并且自动关闭–single-transaction 和–lock-tables 选项。<br><br>mysqldump -uroot -p –host=localhost –all-databases –lock-all-tables</p>\n<p><code>–lock-tables, -l</code><br>开始导出前，锁定所有表。<br><br>用READ LOCAL锁定表以允许MyISAM表并行插入。对于支持事务的表例如InnoDB和BDB，–single-transaction是一个更好的选择，因为它根本不需要锁定表.<br><br>请注意当导出多个数据库时，–lock-tables分别为每个数据库锁定表。因此，该选项不能保证导出文件中的表在数据库之间的逻辑一致性。不同数据库表的导出状态可以完全不同。<br><br>mysqldump -uroot -p –host=localhost –all-databases –lock-tables</p>\n<p><code>–no-create-db, -n </code><br>只导出数据，而不添加CREATE DATABASE 语句。<br><br>mysqldump -uroot -p –host=localhost –all-databases –no-create-db</p>\n<p><code>–no-create-info,-t</code><br>只导出数据，而不添加CREATE TABLE 语句<br><br>mysqldump -uroot -p –host=localhost –all-databases –no-create-info</p>\n<p><code> –no-data, -d </code><br>不导出任何数据，只导出数据库表结构<br><br>mysqldump -uroot -p –host=localhost –all-databases –no-data</p>\n<p><code> –password, -p </code><br>连接数据库密码</p>\n<p><code> –port, -P </code><br>连接数据库端口号</p>\n<p><code> –user, -u </code><br>指定连接的用户名。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>常用的mysqldump命令组合。</p>\n<h2 id=\"备份数据库\"><a href=\"#备份数据库\" class=\"headerlink\" title=\"备份数据库\"></a>备份数据库</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump db_name &gt; bak_name.sql</div><div class=\"line\">mysqldump -A -u [dbuser] -p db_name &gt; bak_name.sql</div><div class=\"line\">mysqldump -d -A --add-drop-table -uroot -p &gt;xxx.sql</div></pre></td></tr></table></figure>\n<h2 id=\"备份所有库到一个单独的文件\"><a href=\"#备份所有库到一个单独的文件\" class=\"headerlink\" title=\"备份所有库到一个单独的文件\"></a>备份所有库到一个单独的文件</h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -e 'show databases' | sed -n '2,$p' | xargs -I DB 'mysqldump DB &gt; DB.sql'</div></pre></td></tr></table></figure>\n<h3 id=\"1-导出结构不导出数据\"><a href=\"#1-导出结构不导出数据\" class=\"headerlink\" title=\"1. 导出结构不导出数据\"></a>1. 导出结构不导出数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump　--opt　-d　db_name　-u　root　-p　&gt;　xxx.sql</div></pre></td></tr></table></figure>\n<h3 id=\"2-导出数据不导出结构\"><a href=\"#2-导出数据不导出结构\" class=\"headerlink\" title=\"2. 导出数据不导出结构\"></a>2. 导出数据不导出结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump　-t　db_name　-uroot　-p　&gt;　xxx.sql</div></pre></td></tr></table></figure>\n<h3 id=\"3-导出数据和表结构\"><a href=\"#3-导出数据和表结构\" class=\"headerlink\" title=\"3. 导出数据和表结构\"></a>3. 导出数据和表结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump　db_name　-uroot　-p　&gt;　xxx.sql</div></pre></td></tr></table></figure>\n<h3 id=\"4-导出特定表的结构\"><a href=\"#4-导出特定表的结构\" class=\"headerlink\" title=\"4. 导出特定表的结构\"></a>4. 导出特定表的结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump　-uroot　-p　-B　db_name　--table　tb_name　&gt;　xxx.sql</div></pre></td></tr></table></figure>\n<h2 id=\"导入数据\"><a href=\"#导入数据\" class=\"headerlink\" title=\"导入数据\"></a>导入数据</h2><p> 因为mysqldump导出的是完整的SQL语句，所以用mysql客户程序很容易就能把数据导入了：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -u db_user -p db_name  &lt; xxx.sql</div><div class=\"line\">mysql&gt; source /path/xxx.sql</div></pre></td></tr></table></figure></p>\n<h2 id=\"mysqldump参数详解：\"><a href=\"#mysqldump参数详解：\" class=\"headerlink\" title=\"mysqldump参数详解：\"></a>mysqldump参数详解：</h2><p><code>–all-databases , -A </code><br>导出全部数据库<br><br>mysqldump -uroot -p –all-databases</p>\n<p><code>–all-tablespaces , -Y</code><br>导出全部表空间<br><br>mysqldump -uroot -p –all-databases –all-tablespaces</p>\n<p><code>–no-tablespaces , -y</code><br>不导出任何表空间信息<br><br>mysqldump -uroot -p –all-databases –no-tablespaces</p>\n<p><code>–add-drop-database</code><br>每个数据库创建之前添加drop数据库语句<br><br>mysqldump -uroot -p –all-databases –add-drop-database</p>\n<p><code>–add-drop-table</code><br>每个数据表创建之前添加drop数据表语句。(默认为打开状态，使用–skip-add-drop-table取消选项)<br><br>mysqldump -uroot -p –all-databases (默认添加drop语句)<br>mysqldump -uroot -p –all-databases –skip-add-drop-table (取消drop语句)</p>\n<p><code>–add-locks</code><br>在每个表导出之前增加LOCK TABLES并且之后UNLOCK TABLE。(默认为打开状态，使用–skip-add-locks取消选项)<br><br>mysqldump -uroot -p –all-databases(默认添加LOCK语句)<br>mysqldump -uroot -p –all-databases –skip-add-locks (取消LOCK语句)</p>\n<p><code>–comments</code><br>附加注释信息。<br><br>默认为打开，可以用–skip-comments取消mysqldump -uroot -p –all-databases (默认记录注释)mysqldump -uroot -p –all-databases “code”<br>skip-comments (取消注释)</p>\n<p><code>–compact</code><br>导出更少的输出信息(用于调试),去掉注释和头尾等结构,可以使用选项：–skip-add-drop-table –skip-add-locks –skip-comments –skip-disable-keys<br><br>mysqldump -uroot -p –all-databases –compact</p>\n<p><code>–complete-insert, -c</code><br>使用完整的insert语句(包含列名称)。这么做能提高插入效率，但是可能会受到max_allowed_packet参数的影响而导致插入失败。<br><br>mysqldump -uroot -p –all-databases –complete-insert</p>\n<p><code>–compress, -C</code><br>在客户端和服务器之间启用压缩传递所有信息<br><br>mysqldump -uroot -p –all-databases –compress</p>\n<p><code>–databases, -B</code><br>导出几个数据库。参数后面所有名字参量都被看作数据库名。<br><br>mysqldump -uroot -p –databases test mysql</p>\n<p><code>–debug</code><br>输出debug信息，用于调试。<br><br>默认值为：d:t:o,/tmp/mysqldump.trace<br><br>mysqldump -uroot -p –all-databases –debug<br><br>mysqldump -uroot -p –all-databases –debug=”d:t:o,/tmp/debug.trace”</p>\n<p><code>–debug-info</code><br>输出调试信息并退出<br><br>mysqldump -uroot -p –all-databases –debug-info</p>\n<p><code>–default-character-set</code><br>设置默认字符集，默认值为utf8<br><br>mysqldump -uroot -p –all-databases –default-character-set=latin1</p>\n<p><code>–delayed-insert</code><br>采用延时插入方式（INSERT DELAYED）导出数据<br><br>mysqldump -uroot -p –all-databases –delayed-insert</p>\n<p><code>–events, -E</code><br>导出事件<br><br>mysqldump -uroot -p –all-databases –events</p>\n<p><code>–flush-logs</code><br>开始导出之前刷新日志<br><br>请注意：假如一次导出多个数据库(使用选项–databases或者–all-databases)，将会逐个数据库刷新日志。除使用–lock-all-tables或者–master-data外。在这种情况下，日志将会被刷新一次，相应的所以表同时被锁定。因此，如果打算同时导出和刷新日志应该使用–lock-all-tables 或者–master-data 和–flush-logs.<br><br>mysqldump -uroot -p –all-databases –flush-logs</p>\n<p><code>–flush-privileges</code><br>在导出mysql数据库之后，发出一条FLUSH PRIVILEGES 语句。为了正确恢复，该选项应该用于导出mysql数据库和依赖mysql数据库数据的任何时候。<br><br>mysqldump -uroot -p –all-databases –flush-privileges</p>\n<p><code>–force</code><br>在导出过程中忽略出现的SQL错误<br><br>mysqldump -uroot -p –all-databases –force</p>\n<p><code>–host, -h</code><br>需要导出的主机信息<br><br>mysqldump -uroot -p –host=localhost –all-databases</p>\n<p><code>–ignore-table</code></p>\n<p>不导出指定表。<br>指定忽略多个表时，需要重复多次，每次一个表。每个表必须同时指定数据库和表名.<br>例如：<br>–ignore-table=database.table1 –ignore-table=database.table2 ……<br><br>mysqldump -uroot -p –host=localhost –all-databases –ignore-table=mysql.user</p>\n<p><code>–lock-all-tables, -x</code><br>提交请求锁定所有数据库中的所有表，以保证数据的一致性。<br>这是一个全局读锁，并且自动关闭–single-transaction 和–lock-tables 选项。<br><br>mysqldump -uroot -p –host=localhost –all-databases –lock-all-tables</p>\n<p><code>–lock-tables, -l</code><br>开始导出前，锁定所有表。<br><br>用READ LOCAL锁定表以允许MyISAM表并行插入。对于支持事务的表例如InnoDB和BDB，–single-transaction是一个更好的选择，因为它根本不需要锁定表.<br /><br>请注意当导出多个数据库时，–lock-tables分别为每个数据库锁定表。因此，该选项不能保证导出文件中的表在数据库之间的逻辑一致性。不同数据库表的导出状态可以完全不同。<br><br>mysqldump -uroot -p –host=localhost –all-databases –lock-tables</p>\n<p><code>–no-create-db, -n </code><br>只导出数据，而不添加CREATE DATABASE 语句。<br><br>mysqldump -uroot -p –host=localhost –all-databases –no-create-db</p>\n<p><code>–no-create-info,-t</code><br>只导出数据，而不添加CREATE TABLE 语句<br><br>mysqldump -uroot -p –host=localhost –all-databases –no-create-info</p>\n<p><code> –no-data, -d </code><br>不导出任何数据，只导出数据库表结构<br><br>mysqldump -uroot -p –host=localhost –all-databases –no-data</p>\n<p><code> –password, -p </code><br>连接数据库密码</p>\n<p><code> –port, -P </code><br>连接数据库端口号</p>\n<p><code> –user, -u </code><br>指定连接的用户名。</p>\n"},{"title":"MySQL(4) MySQL数据库基础","id":"17","updated":"2017-04-21T05:37:45.000Z","date":"2016-03-29T00:22:14.000Z","_content":"\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n## 1. 测试环境\n*  MacBook Pro 15‘ i7 16GB\n*  VMware Fushion 8 Pro\n*  MySQL Version 5.1\n*  CentOS Linux 6.x\n\n\n## 2. 实验步骤\n\n### 2.1 安装mysql\n\n```\n[root@ultraera  ~]#  yum  install  mysql  mysql-server  mysql-devel\n\n```\n\n\n### 2.2 启动mysql，并设置开机自启动\n\n```\n[root@ultraera  ~]#  service  mysqld  start\n[root@ultraera  ~]#  chkconfig  mysqld  on\n[root@ultraera  ~]#  chkconfig  --list  |  grep  mysqld\nmysqld\t0:off  1:off  2:on  3:on  4:on  5:on  6:off\n\n```\n\n\n### 2.3 相关配置\n\n```\n/etc/my.cnf         mysql配置文件\n/var/lib/mysql      mysql数据库文件\nport:3306           mysql默认端口\n\n# Tips : MySQL 绝大对数语句都是以分号结尾，注意是英文模式下的分号。字符和字符串用 '' 引起；\n```\n\n\n### 2.4 mysql初始化及登录\n\n```\n\n[root@ultraera ~]# mysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):        # 首次登陆默认为空\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nYou already have a root password set, so you can safely answer 'n'.\n\nSet the root password? [Y/n] y            # 设置root用户密码\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\n\nBy default, a MySQL installation has an anonymous user, allowing anyone\nto log into MySQL without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n] y        # 删除匿名用户\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n] y        # 关闭root远程登陆\n ... Success!\n\nBy default, MySQL comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n] y    # 删除 test 数据库\n - Dropping test database...\nERROR 1008 (HY000) at line 1: Can't drop database 'test'; database doesn't exist\n ... Failed!  Not critical, keep moving...\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n] y    # 保存这些设置\n ... Success!\n\n\nAll done!  If you've completed all of the above steps, your MySQL\ninstallation should now be secure.\n\nThanks for using MySQL!\n\nCleaning up...\n[root@ultraera ~]#\n\n[root@ultraera  ~]# \n[root@ultraera  ~]# mysql  -u  root  -p  '123456'\n[root@ultraera  ~]# mysql  -u  root  -p  -h  localhost “-h” 指定服务器地址\n```\n\n\n### 2.5 创建、查看及删除当前数据库\n\n```\nmysql>  CREATE  DATABASE  ultraera;\nQuery  OK,  1  row  affected  (0.00  sec)\nmysql>  SHOW  DATABASES;\n+--------------------+\n|  Database\t|\n+--------------------+\n|  information_schema  |\n|  mysql\t|\n|  test\t|\n|  ultraera\t|\n+--------------------+\n4  rows  in  set  (0.00  sec)\nmysql>  DROP  DATABASE  ultraera;\nQuery  OK,  0  rows  affected  (0.00  sec)\n\n```\n\n### 2.6 创建、查看及删除当前表格\n\n```\n#创建表格之前要先选择数据库\nmysql>  use  ultraera;\nDatabase  changed\nmysql>  CREATE  TABLE  ultraera(\t#create 创建表格，至少1列\n->  id  int  NOT  NULL,\t#NOT  NULL\t不为空,int 整型\n->  name  char(20)  NOT  NULL,\t#char() 字符型  ,()内定义字符长度\n->  age  int  NOT  NULL\n->  );\nQuery  OK,  0  rows  affected  (0.01  sec)\nmysql>  DESC  ultraera;\n+-------+----------+------+-----+---------+----------------+\n|  Field  |  Type\t|  Null  |  Key  |  Default  |  Extra\t|\n+-------+----------+------+-----+---------+----------------+\n|  id\t|  int(11)  |  NO  |\t|  NULL\t|\t|\n|  name  |  char(20)  |  NO  |\t|  NULL\t|\t|\n|  age\t|  int(11)  |  NO  |\t|  NULL\t|\t|\n+-------+----------+------+-----+---------+----------------+\n3  rows  in  set  (0.00  sec)\nmysql>  DROP  TABLE  ultraera  ;\nQuery  OK,  0  rows  affected  (0.00  sec)\n\n```\n### 2.7 修改表格信息\n\n```\na.重命名表格\nmysql>  alter  table  ultraera  rename  ultraera_org;\nb.新增列\nalter  table  ultraera  add  address  varchar(200);\nc.删除列\nmysql>  alter  table  ultraera  drop  column  address;\nd.修改一个列的数据类型\nmysql>  alter  table  ultraera  modify  name  varchar(200);\ne.重命名一个列\nmysql>  alter  table  ultraera  change  column  NAME  name  varchar(200);\n```\n\n\n\n### 2.8 向表格中插入数据\n\n```\na.  全局插入\nmysql>  insert  into  ultraera  values(1,'name',18);\nb.  根据列插入\nmysql>  insert  into  ultraera(id,name,age)  values(2,'john',19);\n### 2.9 查看表格中的数据：\nmysql>  select  *  from  ultraera;\t#  *匹配所有列，也可以只查询单个列，\nmysql>  select  name  from  ultraera;\n\n```\n\n### 2.10 where运算符：条件判断查询，查询使用方法：where  列  运算符  值；\n\n```\nwhere支持的运算符：=等于；>大于；<小于；<>不等于；>=大于等于；<=小于等于；BETWEEN在某范围之内；\nmysql> select * from ultraera where id>1;\nmysql> select * from ultraera where id=2;\nmysql> select * from ultraera where id>=1;\nmysql> select * from ultraera where id<1;\nmysql> select * from ultraera where id<=1;\nmysql> select * from ultraera where id  between  1  and  4;\n\n```\n\n\n### 2.11 删除表格中的一条记录（同样可以匹配where运算符）\n\n```\nmysql>  delete  from  ultraera  where  id  =  4;\nmysql>  delete  *  from  ultraera ；\t#清空一个表格的数据；\n\n```\n### 2.12 更新表中的一个数据\n\n```\nmysql>  update  ultraera  set  age=30  where  id=3;\n\n```\n\n\n### 2.13 MySQL增加删除一个用户\n\n```\nmysql>  create  user  user1  identified  by  '123456';\t#user1，密码123456，新用户没有权限，无法登录数据库\nmysql>  drop  user  user1;\t#删除用户user1\n\n```\n\n\n### 2.14 给用户添加、删除权限\n\n```\nmysql>  grant  all  privileges  on  *.*  to  'user1'@'localhost'  identified  by  '123456';\nmysql>  revoke  all  privileges  from  user1;\n\n```\n\n### 2.15 使用mysqldump进行数据库备份\n\n数据库重命名：mysql不能直接对数据库重命名，所以如果想要重名数据库的话，要先导出，接着创建一个新的数据库，然后将导出的sql文件再导入到新的数据库中\n\n\n```\n[adam@ultraera  ~]$  mysqldump  -u  root  -p  ultraera  >  ultraera.sql     #备份\n[adam@ultraera  ~]$  mysql  -u  root  -p  new_ultraera  <  ultraera.sql     #恢复到指定数据库\n\n```\n","source":"_posts/MySQL-4-MySQL数据库基础.md","raw":"---\ntitle: MySQL(4) MySQL数据库基础\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: mysqlshu-ju-ku-ji-chu\nid: 17\nupdated: '2017-04-21 13:37:45'\ndate: 2016-03-29 08:22:14\n---\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n## 1. 测试环境\n*  MacBook Pro 15‘ i7 16GB\n*  VMware Fushion 8 Pro\n*  MySQL Version 5.1\n*  CentOS Linux 6.x\n\n\n## 2. 实验步骤\n\n### 2.1 安装mysql\n\n```\n[root@ultraera  ~]#  yum  install  mysql  mysql-server  mysql-devel\n\n```\n\n\n### 2.2 启动mysql，并设置开机自启动\n\n```\n[root@ultraera  ~]#  service  mysqld  start\n[root@ultraera  ~]#  chkconfig  mysqld  on\n[root@ultraera  ~]#  chkconfig  --list  |  grep  mysqld\nmysqld\t0:off  1:off  2:on  3:on  4:on  5:on  6:off\n\n```\n\n\n### 2.3 相关配置\n\n```\n/etc/my.cnf         mysql配置文件\n/var/lib/mysql      mysql数据库文件\nport:3306           mysql默认端口\n\n# Tips : MySQL 绝大对数语句都是以分号结尾，注意是英文模式下的分号。字符和字符串用 '' 引起；\n```\n\n\n### 2.4 mysql初始化及登录\n\n```\n\n[root@ultraera ~]# mysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):        # 首次登陆默认为空\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nYou already have a root password set, so you can safely answer 'n'.\n\nSet the root password? [Y/n] y            # 设置root用户密码\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\n\nBy default, a MySQL installation has an anonymous user, allowing anyone\nto log into MySQL without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n] y        # 删除匿名用户\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n] y        # 关闭root远程登陆\n ... Success!\n\nBy default, MySQL comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n] y    # 删除 test 数据库\n - Dropping test database...\nERROR 1008 (HY000) at line 1: Can't drop database 'test'; database doesn't exist\n ... Failed!  Not critical, keep moving...\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n] y    # 保存这些设置\n ... Success!\n\n\nAll done!  If you've completed all of the above steps, your MySQL\ninstallation should now be secure.\n\nThanks for using MySQL!\n\nCleaning up...\n[root@ultraera ~]#\n\n[root@ultraera  ~]# \n[root@ultraera  ~]# mysql  -u  root  -p  '123456'\n[root@ultraera  ~]# mysql  -u  root  -p  -h  localhost “-h” 指定服务器地址\n```\n\n\n### 2.5 创建、查看及删除当前数据库\n\n```\nmysql>  CREATE  DATABASE  ultraera;\nQuery  OK,  1  row  affected  (0.00  sec)\nmysql>  SHOW  DATABASES;\n+--------------------+\n|  Database\t|\n+--------------------+\n|  information_schema  |\n|  mysql\t|\n|  test\t|\n|  ultraera\t|\n+--------------------+\n4  rows  in  set  (0.00  sec)\nmysql>  DROP  DATABASE  ultraera;\nQuery  OK,  0  rows  affected  (0.00  sec)\n\n```\n\n### 2.6 创建、查看及删除当前表格\n\n```\n#创建表格之前要先选择数据库\nmysql>  use  ultraera;\nDatabase  changed\nmysql>  CREATE  TABLE  ultraera(\t#create 创建表格，至少1列\n->  id  int  NOT  NULL,\t#NOT  NULL\t不为空,int 整型\n->  name  char(20)  NOT  NULL,\t#char() 字符型  ,()内定义字符长度\n->  age  int  NOT  NULL\n->  );\nQuery  OK,  0  rows  affected  (0.01  sec)\nmysql>  DESC  ultraera;\n+-------+----------+------+-----+---------+----------------+\n|  Field  |  Type\t|  Null  |  Key  |  Default  |  Extra\t|\n+-------+----------+------+-----+---------+----------------+\n|  id\t|  int(11)  |  NO  |\t|  NULL\t|\t|\n|  name  |  char(20)  |  NO  |\t|  NULL\t|\t|\n|  age\t|  int(11)  |  NO  |\t|  NULL\t|\t|\n+-------+----------+------+-----+---------+----------------+\n3  rows  in  set  (0.00  sec)\nmysql>  DROP  TABLE  ultraera  ;\nQuery  OK,  0  rows  affected  (0.00  sec)\n\n```\n### 2.7 修改表格信息\n\n```\na.重命名表格\nmysql>  alter  table  ultraera  rename  ultraera_org;\nb.新增列\nalter  table  ultraera  add  address  varchar(200);\nc.删除列\nmysql>  alter  table  ultraera  drop  column  address;\nd.修改一个列的数据类型\nmysql>  alter  table  ultraera  modify  name  varchar(200);\ne.重命名一个列\nmysql>  alter  table  ultraera  change  column  NAME  name  varchar(200);\n```\n\n\n\n### 2.8 向表格中插入数据\n\n```\na.  全局插入\nmysql>  insert  into  ultraera  values(1,'name',18);\nb.  根据列插入\nmysql>  insert  into  ultraera(id,name,age)  values(2,'john',19);\n### 2.9 查看表格中的数据：\nmysql>  select  *  from  ultraera;\t#  *匹配所有列，也可以只查询单个列，\nmysql>  select  name  from  ultraera;\n\n```\n\n### 2.10 where运算符：条件判断查询，查询使用方法：where  列  运算符  值；\n\n```\nwhere支持的运算符：=等于；>大于；<小于；<>不等于；>=大于等于；<=小于等于；BETWEEN在某范围之内；\nmysql> select * from ultraera where id>1;\nmysql> select * from ultraera where id=2;\nmysql> select * from ultraera where id>=1;\nmysql> select * from ultraera where id<1;\nmysql> select * from ultraera where id<=1;\nmysql> select * from ultraera where id  between  1  and  4;\n\n```\n\n\n### 2.11 删除表格中的一条记录（同样可以匹配where运算符）\n\n```\nmysql>  delete  from  ultraera  where  id  =  4;\nmysql>  delete  *  from  ultraera ；\t#清空一个表格的数据；\n\n```\n### 2.12 更新表中的一个数据\n\n```\nmysql>  update  ultraera  set  age=30  where  id=3;\n\n```\n\n\n### 2.13 MySQL增加删除一个用户\n\n```\nmysql>  create  user  user1  identified  by  '123456';\t#user1，密码123456，新用户没有权限，无法登录数据库\nmysql>  drop  user  user1;\t#删除用户user1\n\n```\n\n\n### 2.14 给用户添加、删除权限\n\n```\nmysql>  grant  all  privileges  on  *.*  to  'user1'@'localhost'  identified  by  '123456';\nmysql>  revoke  all  privileges  from  user1;\n\n```\n\n### 2.15 使用mysqldump进行数据库备份\n\n数据库重命名：mysql不能直接对数据库重命名，所以如果想要重名数据库的话，要先导出，接着创建一个新的数据库，然后将导出的sql文件再导入到新的数据库中\n\n\n```\n[adam@ultraera  ~]$  mysqldump  -u  root  -p  ultraera  >  ultraera.sql     #备份\n[adam@ultraera  ~]$  mysql  -u  root  -p  new_ultraera  <  ultraera.sql     #恢复到指定数据库\n\n```\n","slug":"mysqlshu-ju-ku-ji-chu","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqbb005641tpf9wxhcgz","content":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\n<h2 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h2><ul>\n<li>MacBook Pro 15‘ i7 16GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>MySQL Version 5.1</li>\n<li>CentOS Linux 6.x</li>\n</ul>\n<h2 id=\"2-实验步骤\"><a href=\"#2-实验步骤\" class=\"headerlink\" title=\"2. 实验步骤\"></a>2. 实验步骤</h2><h3 id=\"2-1-安装mysql\"><a href=\"#2-1-安装mysql\" class=\"headerlink\" title=\"2.1 安装mysql\"></a>2.1 安装mysql</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera  ~]#  yum  install  mysql  mysql-server  mysql-devel</div></pre></td></tr></table></figure>\n<h3 id=\"2-2-启动mysql，并设置开机自启动\"><a href=\"#2-2-启动mysql，并设置开机自启动\" class=\"headerlink\" title=\"2.2 启动mysql，并设置开机自启动\"></a>2.2 启动mysql，并设置开机自启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera  ~]#  service  mysqld  start</div><div class=\"line\">[root@ultraera  ~]#  chkconfig  mysqld  on</div><div class=\"line\">[root@ultraera  ~]#  chkconfig  --list  |  grep  mysqld</div><div class=\"line\">mysqld\t0:off  1:off  2:on  3:on  4:on  5:on  6:off</div></pre></td></tr></table></figure>\n<h3 id=\"2-3-相关配置\"><a href=\"#2-3-相关配置\" class=\"headerlink\" title=\"2.3 相关配置\"></a>2.3 相关配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">/etc/my.cnf         mysql配置文件</div><div class=\"line\">/var/lib/mysql      mysql数据库文件</div><div class=\"line\">port:3306           mysql默认端口</div><div class=\"line\"></div><div class=\"line\"># Tips : MySQL 绝大对数语句都是以分号结尾，注意是英文模式下的分号。字符和字符串用 &apos;&apos; 引起；</div></pre></td></tr></table></figure>\n<h3 id=\"2-4-mysql初始化及登录\"><a href=\"#2-4-mysql初始化及登录\" class=\"headerlink\" title=\"2.4 mysql初始化及登录\"></a>2.4 mysql初始化及登录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">[root@ultraera ~]# mysql_secure_installation</div><div class=\"line\"></div><div class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</div><div class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</div><div class=\"line\"></div><div class=\"line\">In order to log into MySQL to secure it, we&apos;ll need the current</div><div class=\"line\">password for the root user.  If you&apos;ve just installed MySQL, and</div><div class=\"line\">you haven&apos;t set the root password yet, the password will be blank,</div><div class=\"line\">so you should just press enter here.</div><div class=\"line\"></div><div class=\"line\">Enter current password for root (enter for none):        # 首次登陆默认为空</div><div class=\"line\"></div><div class=\"line\">Setting the root password ensures that nobody can log into the MySQL</div><div class=\"line\">root user without the proper authorisation.</div><div class=\"line\"></div><div class=\"line\">You already have a root password set, so you can safely answer &apos;n&apos;.</div><div class=\"line\"></div><div class=\"line\">Set the root password? [Y/n] y            # 设置root用户密码</div><div class=\"line\">New password:</div><div class=\"line\">Re-enter new password:</div><div class=\"line\">Password updated successfully!</div><div class=\"line\">Reloading privilege tables..</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">By default, a MySQL installation has an anonymous user, allowing anyone</div><div class=\"line\">to log into MySQL without having to have a user account created for</div><div class=\"line\">them.  This is intended only for testing, and to make the installation</div><div class=\"line\">go a bit smoother.  You should remove them before moving into a</div><div class=\"line\">production environment.</div><div class=\"line\"></div><div class=\"line\">Remove anonymous users? [Y/n] y        # 删除匿名用户</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Normally, root should only be allowed to connect from &apos;localhost&apos;.  This</div><div class=\"line\">ensures that someone cannot guess at the root password from the network.</div><div class=\"line\"></div><div class=\"line\">Disallow root login remotely? [Y/n] y        # 关闭root远程登陆</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, MySQL comes with a database named &apos;test&apos; that anyone can</div><div class=\"line\">access.  This is also intended only for testing, and should be removed</div><div class=\"line\">before moving into a production environment.</div><div class=\"line\"></div><div class=\"line\">Remove test database and access to it? [Y/n] y    # 删除 test 数据库</div><div class=\"line\"> - Dropping test database...</div><div class=\"line\">ERROR 1008 (HY000) at line 1: Can&apos;t drop database &apos;test&apos;; database doesn&apos;t exist</div><div class=\"line\"> ... Failed!  Not critical, keep moving...</div><div class=\"line\"> - Removing privileges on test database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Reloading the privilege tables will ensure that all changes made so far</div><div class=\"line\">will take effect immediately.</div><div class=\"line\"></div><div class=\"line\">Reload privilege tables now? [Y/n] y    # 保存这些设置</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">All done!  If you&apos;ve completed all of the above steps, your MySQL</div><div class=\"line\">installation should now be secure.</div><div class=\"line\"></div><div class=\"line\">Thanks for using MySQL!</div><div class=\"line\"></div><div class=\"line\">Cleaning up...</div><div class=\"line\">[root@ultraera ~]#</div><div class=\"line\"></div><div class=\"line\">[root@ultraera  ~]# </div><div class=\"line\">[root@ultraera  ~]# mysql  -u  root  -p  &apos;123456&apos;</div><div class=\"line\">[root@ultraera  ~]# mysql  -u  root  -p  -h  localhost “-h” 指定服务器地址</div></pre></td></tr></table></figure>\n<h3 id=\"2-5-创建、查看及删除当前数据库\"><a href=\"#2-5-创建、查看及删除当前数据库\" class=\"headerlink\" title=\"2.5 创建、查看及删除当前数据库\"></a>2.5 创建、查看及删除当前数据库</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  CREATE  DATABASE  ultraera;</div><div class=\"line\">Query  OK,  1  row  affected  (0.00  sec)</div><div class=\"line\">mysql&gt;  SHOW  DATABASES;</div><div class=\"line\">+--------------------+</div><div class=\"line\">|  Database\t|</div><div class=\"line\">+--------------------+</div><div class=\"line\">|  information_schema  |</div><div class=\"line\">|  mysql\t|</div><div class=\"line\">|  test\t|</div><div class=\"line\">|  ultraera\t|</div><div class=\"line\">+--------------------+</div><div class=\"line\">4  rows  in  set  (0.00  sec)</div><div class=\"line\">mysql&gt;  DROP  DATABASE  ultraera;</div><div class=\"line\">Query  OK,  0  rows  affected  (0.00  sec)</div></pre></td></tr></table></figure>\n<h3 id=\"2-6-创建、查看及删除当前表格\"><a href=\"#2-6-创建、查看及删除当前表格\" class=\"headerlink\" title=\"2.6 创建、查看及删除当前表格\"></a>2.6 创建、查看及删除当前表格</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">#创建表格之前要先选择数据库</div><div class=\"line\">mysql&gt;  use  ultraera;</div><div class=\"line\">Database  changed</div><div class=\"line\">mysql&gt;  CREATE  TABLE  ultraera(\t#create 创建表格，至少1列</div><div class=\"line\">-&gt;  id  int  NOT  NULL,\t#NOT  NULL\t不为空,int 整型</div><div class=\"line\">-&gt;  name  char(20)  NOT  NULL,\t#char() 字符型  ,()内定义字符长度</div><div class=\"line\">-&gt;  age  int  NOT  NULL</div><div class=\"line\">-&gt;  );</div><div class=\"line\">Query  OK,  0  rows  affected  (0.01  sec)</div><div class=\"line\">mysql&gt;  DESC  ultraera;</div><div class=\"line\">+-------+----------+------+-----+---------+----------------+</div><div class=\"line\">|  Field  |  Type\t|  Null  |  Key  |  Default  |  Extra\t|</div><div class=\"line\">+-------+----------+------+-----+---------+----------------+</div><div class=\"line\">|  id\t|  int(11)  |  NO  |\t|  NULL\t|\t|</div><div class=\"line\">|  name  |  char(20)  |  NO  |\t|  NULL\t|\t|</div><div class=\"line\">|  age\t|  int(11)  |  NO  |\t|  NULL\t|\t|</div><div class=\"line\">+-------+----------+------+-----+---------+----------------+</div><div class=\"line\">3  rows  in  set  (0.00  sec)</div><div class=\"line\">mysql&gt;  DROP  TABLE  ultraera  ;</div><div class=\"line\">Query  OK,  0  rows  affected  (0.00  sec)</div></pre></td></tr></table></figure>\n<h3 id=\"2-7-修改表格信息\"><a href=\"#2-7-修改表格信息\" class=\"headerlink\" title=\"2.7 修改表格信息\"></a>2.7 修改表格信息</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">a.重命名表格</div><div class=\"line\">mysql&gt;  alter  table  ultraera  rename  ultraera_org;</div><div class=\"line\">b.新增列</div><div class=\"line\">alter  table  ultraera  add  address  varchar(200);</div><div class=\"line\">c.删除列</div><div class=\"line\">mysql&gt;  alter  table  ultraera  drop  column  address;</div><div class=\"line\">d.修改一个列的数据类型</div><div class=\"line\">mysql&gt;  alter  table  ultraera  modify  name  varchar(200);</div><div class=\"line\">e.重命名一个列</div><div class=\"line\">mysql&gt;  alter  table  ultraera  change  column  NAME  name  varchar(200);</div></pre></td></tr></table></figure>\n<h3 id=\"2-8-向表格中插入数据\"><a href=\"#2-8-向表格中插入数据\" class=\"headerlink\" title=\"2.8 向表格中插入数据\"></a>2.8 向表格中插入数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">a.  全局插入</div><div class=\"line\">mysql&gt;  insert  into  ultraera  values(1,&apos;name&apos;,18);</div><div class=\"line\">b.  根据列插入</div><div class=\"line\">mysql&gt;  insert  into  ultraera(id,name,age)  values(2,&apos;john&apos;,19);</div><div class=\"line\">### 2.9 查看表格中的数据：</div><div class=\"line\">mysql&gt;  select  *  from  ultraera;\t#  *匹配所有列，也可以只查询单个列，</div><div class=\"line\">mysql&gt;  select  name  from  ultraera;</div></pre></td></tr></table></figure>\n<h3 id=\"2-10-where运算符：条件判断查询，查询使用方法：where-列-运算符-值；\"><a href=\"#2-10-where运算符：条件判断查询，查询使用方法：where-列-运算符-值；\" class=\"headerlink\" title=\"2.10 where运算符：条件判断查询，查询使用方法：where  列  运算符  值；\"></a>2.10 where运算符：条件判断查询，查询使用方法：where  列  运算符  值；</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">where支持的运算符：=等于；&gt;大于；&lt;小于；&lt;&gt;不等于；&gt;=大于等于；&lt;=小于等于；BETWEEN在某范围之内；</div><div class=\"line\">mysql&gt; select * from ultraera where id&gt;1;</div><div class=\"line\">mysql&gt; select * from ultraera where id=2;</div><div class=\"line\">mysql&gt; select * from ultraera where id&gt;=1;</div><div class=\"line\">mysql&gt; select * from ultraera where id&lt;1;</div><div class=\"line\">mysql&gt; select * from ultraera where id&lt;=1;</div><div class=\"line\">mysql&gt; select * from ultraera where id  between  1  and  4;</div></pre></td></tr></table></figure>\n<h3 id=\"2-11-删除表格中的一条记录（同样可以匹配where运算符）\"><a href=\"#2-11-删除表格中的一条记录（同样可以匹配where运算符）\" class=\"headerlink\" title=\"2.11 删除表格中的一条记录（同样可以匹配where运算符）\"></a>2.11 删除表格中的一条记录（同样可以匹配where运算符）</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  delete  from  ultraera  where  id  =  4;</div><div class=\"line\">mysql&gt;  delete  *  from  ultraera ；\t#清空一个表格的数据；</div></pre></td></tr></table></figure>\n<h3 id=\"2-12-更新表中的一个数据\"><a href=\"#2-12-更新表中的一个数据\" class=\"headerlink\" title=\"2.12 更新表中的一个数据\"></a>2.12 更新表中的一个数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  update  ultraera  set  age=30  where  id=3;</div></pre></td></tr></table></figure>\n<h3 id=\"2-13-MySQL增加删除一个用户\"><a href=\"#2-13-MySQL增加删除一个用户\" class=\"headerlink\" title=\"2.13 MySQL增加删除一个用户\"></a>2.13 MySQL增加删除一个用户</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  create  user  user1  identified  by  &apos;123456&apos;;\t#user1，密码123456，新用户没有权限，无法登录数据库</div><div class=\"line\">mysql&gt;  drop  user  user1;\t#删除用户user1</div></pre></td></tr></table></figure>\n<h3 id=\"2-14-给用户添加、删除权限\"><a href=\"#2-14-给用户添加、删除权限\" class=\"headerlink\" title=\"2.14 给用户添加、删除权限\"></a>2.14 给用户添加、删除权限</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  grant  all  privileges  on  *.*  to  &apos;user1&apos;@&apos;localhost&apos;  identified  by  &apos;123456&apos;;</div><div class=\"line\">mysql&gt;  revoke  all  privileges  from  user1;</div></pre></td></tr></table></figure>\n<h3 id=\"2-15-使用mysqldump进行数据库备份\"><a href=\"#2-15-使用mysqldump进行数据库备份\" class=\"headerlink\" title=\"2.15 使用mysqldump进行数据库备份\"></a>2.15 使用mysqldump进行数据库备份</h3><p>数据库重命名：mysql不能直接对数据库重命名，所以如果想要重名数据库的话，要先导出，接着创建一个新的数据库，然后将导出的sql文件再导入到新的数据库中</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[adam@ultraera  ~]$  mysqldump  -u  root  -p  ultraera  &gt;  ultraera.sql     #备份</div><div class=\"line\">[adam@ultraera  ~]$  mysql  -u  root  -p  new_ultraera  &lt;  ultraera.sql     #恢复到指定数据库</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\n<h2 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h2><ul>\n<li>MacBook Pro 15‘ i7 16GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>MySQL Version 5.1</li>\n<li>CentOS Linux 6.x</li>\n</ul>\n<h2 id=\"2-实验步骤\"><a href=\"#2-实验步骤\" class=\"headerlink\" title=\"2. 实验步骤\"></a>2. 实验步骤</h2><h3 id=\"2-1-安装mysql\"><a href=\"#2-1-安装mysql\" class=\"headerlink\" title=\"2.1 安装mysql\"></a>2.1 安装mysql</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera  ~]#  yum  install  mysql  mysql-server  mysql-devel</div></pre></td></tr></table></figure>\n<h3 id=\"2-2-启动mysql，并设置开机自启动\"><a href=\"#2-2-启动mysql，并设置开机自启动\" class=\"headerlink\" title=\"2.2 启动mysql，并设置开机自启动\"></a>2.2 启动mysql，并设置开机自启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera  ~]#  service  mysqld  start</div><div class=\"line\">[root@ultraera  ~]#  chkconfig  mysqld  on</div><div class=\"line\">[root@ultraera  ~]#  chkconfig  --list  |  grep  mysqld</div><div class=\"line\">mysqld\t0:off  1:off  2:on  3:on  4:on  5:on  6:off</div></pre></td></tr></table></figure>\n<h3 id=\"2-3-相关配置\"><a href=\"#2-3-相关配置\" class=\"headerlink\" title=\"2.3 相关配置\"></a>2.3 相关配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">/etc/my.cnf         mysql配置文件</div><div class=\"line\">/var/lib/mysql      mysql数据库文件</div><div class=\"line\">port:3306           mysql默认端口</div><div class=\"line\"></div><div class=\"line\"># Tips : MySQL 绝大对数语句都是以分号结尾，注意是英文模式下的分号。字符和字符串用 &apos;&apos; 引起；</div></pre></td></tr></table></figure>\n<h3 id=\"2-4-mysql初始化及登录\"><a href=\"#2-4-mysql初始化及登录\" class=\"headerlink\" title=\"2.4 mysql初始化及登录\"></a>2.4 mysql初始化及登录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">[root@ultraera ~]# mysql_secure_installation</div><div class=\"line\"></div><div class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</div><div class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</div><div class=\"line\"></div><div class=\"line\">In order to log into MySQL to secure it, we&apos;ll need the current</div><div class=\"line\">password for the root user.  If you&apos;ve just installed MySQL, and</div><div class=\"line\">you haven&apos;t set the root password yet, the password will be blank,</div><div class=\"line\">so you should just press enter here.</div><div class=\"line\"></div><div class=\"line\">Enter current password for root (enter for none):        # 首次登陆默认为空</div><div class=\"line\"></div><div class=\"line\">Setting the root password ensures that nobody can log into the MySQL</div><div class=\"line\">root user without the proper authorisation.</div><div class=\"line\"></div><div class=\"line\">You already have a root password set, so you can safely answer &apos;n&apos;.</div><div class=\"line\"></div><div class=\"line\">Set the root password? [Y/n] y            # 设置root用户密码</div><div class=\"line\">New password:</div><div class=\"line\">Re-enter new password:</div><div class=\"line\">Password updated successfully!</div><div class=\"line\">Reloading privilege tables..</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">By default, a MySQL installation has an anonymous user, allowing anyone</div><div class=\"line\">to log into MySQL without having to have a user account created for</div><div class=\"line\">them.  This is intended only for testing, and to make the installation</div><div class=\"line\">go a bit smoother.  You should remove them before moving into a</div><div class=\"line\">production environment.</div><div class=\"line\"></div><div class=\"line\">Remove anonymous users? [Y/n] y        # 删除匿名用户</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Normally, root should only be allowed to connect from &apos;localhost&apos;.  This</div><div class=\"line\">ensures that someone cannot guess at the root password from the network.</div><div class=\"line\"></div><div class=\"line\">Disallow root login remotely? [Y/n] y        # 关闭root远程登陆</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, MySQL comes with a database named &apos;test&apos; that anyone can</div><div class=\"line\">access.  This is also intended only for testing, and should be removed</div><div class=\"line\">before moving into a production environment.</div><div class=\"line\"></div><div class=\"line\">Remove test database and access to it? [Y/n] y    # 删除 test 数据库</div><div class=\"line\"> - Dropping test database...</div><div class=\"line\">ERROR 1008 (HY000) at line 1: Can&apos;t drop database &apos;test&apos;; database doesn&apos;t exist</div><div class=\"line\"> ... Failed!  Not critical, keep moving...</div><div class=\"line\"> - Removing privileges on test database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Reloading the privilege tables will ensure that all changes made so far</div><div class=\"line\">will take effect immediately.</div><div class=\"line\"></div><div class=\"line\">Reload privilege tables now? [Y/n] y    # 保存这些设置</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">All done!  If you&apos;ve completed all of the above steps, your MySQL</div><div class=\"line\">installation should now be secure.</div><div class=\"line\"></div><div class=\"line\">Thanks for using MySQL!</div><div class=\"line\"></div><div class=\"line\">Cleaning up...</div><div class=\"line\">[root@ultraera ~]#</div><div class=\"line\"></div><div class=\"line\">[root@ultraera  ~]# </div><div class=\"line\">[root@ultraera  ~]# mysql  -u  root  -p  &apos;123456&apos;</div><div class=\"line\">[root@ultraera  ~]# mysql  -u  root  -p  -h  localhost “-h” 指定服务器地址</div></pre></td></tr></table></figure>\n<h3 id=\"2-5-创建、查看及删除当前数据库\"><a href=\"#2-5-创建、查看及删除当前数据库\" class=\"headerlink\" title=\"2.5 创建、查看及删除当前数据库\"></a>2.5 创建、查看及删除当前数据库</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  CREATE  DATABASE  ultraera;</div><div class=\"line\">Query  OK,  1  row  affected  (0.00  sec)</div><div class=\"line\">mysql&gt;  SHOW  DATABASES;</div><div class=\"line\">+--------------------+</div><div class=\"line\">|  Database\t|</div><div class=\"line\">+--------------------+</div><div class=\"line\">|  information_schema  |</div><div class=\"line\">|  mysql\t|</div><div class=\"line\">|  test\t|</div><div class=\"line\">|  ultraera\t|</div><div class=\"line\">+--------------------+</div><div class=\"line\">4  rows  in  set  (0.00  sec)</div><div class=\"line\">mysql&gt;  DROP  DATABASE  ultraera;</div><div class=\"line\">Query  OK,  0  rows  affected  (0.00  sec)</div></pre></td></tr></table></figure>\n<h3 id=\"2-6-创建、查看及删除当前表格\"><a href=\"#2-6-创建、查看及删除当前表格\" class=\"headerlink\" title=\"2.6 创建、查看及删除当前表格\"></a>2.6 创建、查看及删除当前表格</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">#创建表格之前要先选择数据库</div><div class=\"line\">mysql&gt;  use  ultraera;</div><div class=\"line\">Database  changed</div><div class=\"line\">mysql&gt;  CREATE  TABLE  ultraera(\t#create 创建表格，至少1列</div><div class=\"line\">-&gt;  id  int  NOT  NULL,\t#NOT  NULL\t不为空,int 整型</div><div class=\"line\">-&gt;  name  char(20)  NOT  NULL,\t#char() 字符型  ,()内定义字符长度</div><div class=\"line\">-&gt;  age  int  NOT  NULL</div><div class=\"line\">-&gt;  );</div><div class=\"line\">Query  OK,  0  rows  affected  (0.01  sec)</div><div class=\"line\">mysql&gt;  DESC  ultraera;</div><div class=\"line\">+-------+----------+------+-----+---------+----------------+</div><div class=\"line\">|  Field  |  Type\t|  Null  |  Key  |  Default  |  Extra\t|</div><div class=\"line\">+-------+----------+------+-----+---------+----------------+</div><div class=\"line\">|  id\t|  int(11)  |  NO  |\t|  NULL\t|\t|</div><div class=\"line\">|  name  |  char(20)  |  NO  |\t|  NULL\t|\t|</div><div class=\"line\">|  age\t|  int(11)  |  NO  |\t|  NULL\t|\t|</div><div class=\"line\">+-------+----------+------+-----+---------+----------------+</div><div class=\"line\">3  rows  in  set  (0.00  sec)</div><div class=\"line\">mysql&gt;  DROP  TABLE  ultraera  ;</div><div class=\"line\">Query  OK,  0  rows  affected  (0.00  sec)</div></pre></td></tr></table></figure>\n<h3 id=\"2-7-修改表格信息\"><a href=\"#2-7-修改表格信息\" class=\"headerlink\" title=\"2.7 修改表格信息\"></a>2.7 修改表格信息</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">a.重命名表格</div><div class=\"line\">mysql&gt;  alter  table  ultraera  rename  ultraera_org;</div><div class=\"line\">b.新增列</div><div class=\"line\">alter  table  ultraera  add  address  varchar(200);</div><div class=\"line\">c.删除列</div><div class=\"line\">mysql&gt;  alter  table  ultraera  drop  column  address;</div><div class=\"line\">d.修改一个列的数据类型</div><div class=\"line\">mysql&gt;  alter  table  ultraera  modify  name  varchar(200);</div><div class=\"line\">e.重命名一个列</div><div class=\"line\">mysql&gt;  alter  table  ultraera  change  column  NAME  name  varchar(200);</div></pre></td></tr></table></figure>\n<h3 id=\"2-8-向表格中插入数据\"><a href=\"#2-8-向表格中插入数据\" class=\"headerlink\" title=\"2.8 向表格中插入数据\"></a>2.8 向表格中插入数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">a.  全局插入</div><div class=\"line\">mysql&gt;  insert  into  ultraera  values(1,&apos;name&apos;,18);</div><div class=\"line\">b.  根据列插入</div><div class=\"line\">mysql&gt;  insert  into  ultraera(id,name,age)  values(2,&apos;john&apos;,19);</div><div class=\"line\">### 2.9 查看表格中的数据：</div><div class=\"line\">mysql&gt;  select  *  from  ultraera;\t#  *匹配所有列，也可以只查询单个列，</div><div class=\"line\">mysql&gt;  select  name  from  ultraera;</div></pre></td></tr></table></figure>\n<h3 id=\"2-10-where运算符：条件判断查询，查询使用方法：where-列-运算符-值；\"><a href=\"#2-10-where运算符：条件判断查询，查询使用方法：where-列-运算符-值；\" class=\"headerlink\" title=\"2.10 where运算符：条件判断查询，查询使用方法：where  列  运算符  值；\"></a>2.10 where运算符：条件判断查询，查询使用方法：where  列  运算符  值；</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">where支持的运算符：=等于；&gt;大于；&lt;小于；&lt;&gt;不等于；&gt;=大于等于；&lt;=小于等于；BETWEEN在某范围之内；</div><div class=\"line\">mysql&gt; select * from ultraera where id&gt;1;</div><div class=\"line\">mysql&gt; select * from ultraera where id=2;</div><div class=\"line\">mysql&gt; select * from ultraera where id&gt;=1;</div><div class=\"line\">mysql&gt; select * from ultraera where id&lt;1;</div><div class=\"line\">mysql&gt; select * from ultraera where id&lt;=1;</div><div class=\"line\">mysql&gt; select * from ultraera where id  between  1  and  4;</div></pre></td></tr></table></figure>\n<h3 id=\"2-11-删除表格中的一条记录（同样可以匹配where运算符）\"><a href=\"#2-11-删除表格中的一条记录（同样可以匹配where运算符）\" class=\"headerlink\" title=\"2.11 删除表格中的一条记录（同样可以匹配where运算符）\"></a>2.11 删除表格中的一条记录（同样可以匹配where运算符）</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  delete  from  ultraera  where  id  =  4;</div><div class=\"line\">mysql&gt;  delete  *  from  ultraera ；\t#清空一个表格的数据；</div></pre></td></tr></table></figure>\n<h3 id=\"2-12-更新表中的一个数据\"><a href=\"#2-12-更新表中的一个数据\" class=\"headerlink\" title=\"2.12 更新表中的一个数据\"></a>2.12 更新表中的一个数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  update  ultraera  set  age=30  where  id=3;</div></pre></td></tr></table></figure>\n<h3 id=\"2-13-MySQL增加删除一个用户\"><a href=\"#2-13-MySQL增加删除一个用户\" class=\"headerlink\" title=\"2.13 MySQL增加删除一个用户\"></a>2.13 MySQL增加删除一个用户</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  create  user  user1  identified  by  &apos;123456&apos;;\t#user1，密码123456，新用户没有权限，无法登录数据库</div><div class=\"line\">mysql&gt;  drop  user  user1;\t#删除用户user1</div></pre></td></tr></table></figure>\n<h3 id=\"2-14-给用户添加、删除权限\"><a href=\"#2-14-给用户添加、删除权限\" class=\"headerlink\" title=\"2.14 给用户添加、删除权限\"></a>2.14 给用户添加、删除权限</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt;  grant  all  privileges  on  *.*  to  &apos;user1&apos;@&apos;localhost&apos;  identified  by  &apos;123456&apos;;</div><div class=\"line\">mysql&gt;  revoke  all  privileges  from  user1;</div></pre></td></tr></table></figure>\n<h3 id=\"2-15-使用mysqldump进行数据库备份\"><a href=\"#2-15-使用mysqldump进行数据库备份\" class=\"headerlink\" title=\"2.15 使用mysqldump进行数据库备份\"></a>2.15 使用mysqldump进行数据库备份</h3><p>数据库重命名：mysql不能直接对数据库重命名，所以如果想要重名数据库的话，要先导出，接着创建一个新的数据库，然后将导出的sql文件再导入到新的数据库中</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[adam@ultraera  ~]$  mysqldump  -u  root  -p  ultraera  &gt;  ultraera.sql     #备份</div><div class=\"line\">[adam@ultraera  ~]$  mysql  -u  root  -p  new_ultraera  &lt;  ultraera.sql     #恢复到指定数据库</div></pre></td></tr></table></figure>\n"},{"title":"MySQL(5) 清空表命令之：truncate与delete区别","id":"104","updated":"2017-04-21T05:21:15.000Z","date":"2016-11-09T18:53:13.000Z","_content":"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在实际工作中，有时我们会想要去清空一张表的所有数据，常用的命令有delete和truncate这两个命令。\n\n### 1. delete\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在很多情况，我们对于delete的应用更多，因为它支持更多的匹配模式，我们可以使用where条件语句，清理一些特定的数据，关于delete的操作，这里不做过多解释，有空就专门写写delete的使用和原理。delete 在清空表时，如果表内有自增ID的设定，那么在delete清空之后，再插入数据时，自增ID不会从1开始，默认会继续增加; 除非我们使用OPTIMIZE TABLE，重置表属性；\n```\nmysql> delete from piwik_tmp;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n### 2. truncate\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truncate 在清空表时，会同时将自增ID重置，再插入新数据时会从1开始，而且truncate在清空表时，不关心表的行数，所以执行效率会高于delete；\n\n```\nmysql> truncate table piwik_tmp;\nQuery OK, 0 rows affected (0.01 sec)\n\n```\n\n### 3. 释放表空间\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;但是在truncate清空表数据时，myisam的表和innodb的表在使用上有一定的区别；myisam表会清空所有数据，并释放表空间，即硬盘空间会得到释放。innodb表也会清空所有数据，但不释放表空间。Innodb数据库对于已经删除的数据只是标记为删除，并不真正释放所占用的磁盘空间，这就导致InnoDB数据库文件不断增长。如果想彻底释放这些已经删除的数据，需要把数据库导出，删除InnoDB数据库文件，然后再导入。\n```\n# 备份数据库：\nmysqldump -u -p --quick --force --all-databases > mysqldump.sql\n\n# 停止数据库\nservice mysqld stop\n\n# 删除这些大文件\nrm /usr/local/mysql/var/ibdata1\nrm /usr/local/mysql/var/ib_logfile*\n\n# 手动删除除Mysql之外所有数据库文件夹，然后启动数据库\nservice mysqld start\n\n# 还原数据\nmysql -uroot -proot < mysqldump.sql\n```\n\n### 4. innodb\\_file\\_per_table\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;还有一种方式是在创建数据库的时候设置innodb\\_file\\_per_table，这样InnoDB会对每个表创建一个数据文件，然后只需要运行OPTIMIZE TABLE 命令就可以释放所有已经删除的磁盘空间。\n\n#### 4.1 修改mysql默认配置文件。\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;编辑my.ini或my.cnf 在innodb段中加入 innodb\\_file\\_per_table=1 # 1为启用，0为禁用\n\n#### 4.2 查看修改结果\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过mysql语句可以查看该变量的值：\n```\nmysql> show variables like '%per_table%';\n```\n","source":"_posts/MySQL-5-清空表命令之：truncate与delete区别.md","raw":"---\ntitle: MySQL(5) 清空表命令之：truncate与delete区别\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: lwuswahg\nid: 104\nupdated: '2017-04-21 13:21:15'\ndate: 2016-11-10 02:53:13\n---\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在实际工作中，有时我们会想要去清空一张表的所有数据，常用的命令有delete和truncate这两个命令。\n\n### 1. delete\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在很多情况，我们对于delete的应用更多，因为它支持更多的匹配模式，我们可以使用where条件语句，清理一些特定的数据，关于delete的操作，这里不做过多解释，有空就专门写写delete的使用和原理。delete 在清空表时，如果表内有自增ID的设定，那么在delete清空之后，再插入数据时，自增ID不会从1开始，默认会继续增加; 除非我们使用OPTIMIZE TABLE，重置表属性；\n```\nmysql> delete from piwik_tmp;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n### 2. truncate\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truncate 在清空表时，会同时将自增ID重置，再插入新数据时会从1开始，而且truncate在清空表时，不关心表的行数，所以执行效率会高于delete；\n\n```\nmysql> truncate table piwik_tmp;\nQuery OK, 0 rows affected (0.01 sec)\n\n```\n\n### 3. 释放表空间\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;但是在truncate清空表数据时，myisam的表和innodb的表在使用上有一定的区别；myisam表会清空所有数据，并释放表空间，即硬盘空间会得到释放。innodb表也会清空所有数据，但不释放表空间。Innodb数据库对于已经删除的数据只是标记为删除，并不真正释放所占用的磁盘空间，这就导致InnoDB数据库文件不断增长。如果想彻底释放这些已经删除的数据，需要把数据库导出，删除InnoDB数据库文件，然后再导入。\n```\n# 备份数据库：\nmysqldump -u -p --quick --force --all-databases > mysqldump.sql\n\n# 停止数据库\nservice mysqld stop\n\n# 删除这些大文件\nrm /usr/local/mysql/var/ibdata1\nrm /usr/local/mysql/var/ib_logfile*\n\n# 手动删除除Mysql之外所有数据库文件夹，然后启动数据库\nservice mysqld start\n\n# 还原数据\nmysql -uroot -proot < mysqldump.sql\n```\n\n### 4. innodb\\_file\\_per_table\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;还有一种方式是在创建数据库的时候设置innodb\\_file\\_per_table，这样InnoDB会对每个表创建一个数据文件，然后只需要运行OPTIMIZE TABLE 命令就可以释放所有已经删除的磁盘空间。\n\n#### 4.1 修改mysql默认配置文件。\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;编辑my.ini或my.cnf 在innodb段中加入 innodb\\_file\\_per_table=1 # 1为启用，0为禁用\n\n#### 4.2 查看修改结果\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过mysql语句可以查看该变量的值：\n```\nmysql> show variables like '%per_table%';\n```\n","slug":"lwuswahg","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqbe005a41tpl4u1tg6w","content":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在实际工作中，有时我们会想要去清空一张表的所有数据，常用的命令有delete和truncate这两个命令。</p>\n<h3 id=\"1-delete\"><a href=\"#1-delete\" class=\"headerlink\" title=\"1. delete\"></a>1. delete</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在很多情况，我们对于delete的应用更多，因为它支持更多的匹配模式，我们可以使用where条件语句，清理一些特定的数据，关于delete的操作，这里不做过多解释，有空就专门写写delete的使用和原理。delete 在清空表时，如果表内有自增ID的设定，那么在delete清空之后，再插入数据时，自增ID不会从1开始，默认会继续增加; 除非我们使用OPTIMIZE TABLE，重置表属性；<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; delete from piwik_tmp;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-truncate\"><a href=\"#2-truncate\" class=\"headerlink\" title=\"2. truncate\"></a>2. truncate</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truncate 在清空表时，会同时将自增ID重置，再插入新数据时会从1开始，而且truncate在清空表时，不关心表的行数，所以执行效率会高于delete；</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; truncate table piwik_tmp;</div><div class=\"line\">Query OK, 0 rows affected (0.01 sec)</div></pre></td></tr></table></figure>\n<h3 id=\"3-释放表空间\"><a href=\"#3-释放表空间\" class=\"headerlink\" title=\"3. 释放表空间\"></a>3. 释放表空间</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;但是在truncate清空表数据时，myisam的表和innodb的表在使用上有一定的区别；myisam表会清空所有数据，并释放表空间，即硬盘空间会得到释放。innodb表也会清空所有数据，但不释放表空间。Innodb数据库对于已经删除的数据只是标记为删除，并不真正释放所占用的磁盘空间，这就导致InnoDB数据库文件不断增长。如果想彻底释放这些已经删除的数据，需要把数据库导出，删除InnoDB数据库文件，然后再导入。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 备份数据库：</div><div class=\"line\">mysqldump -u -p --quick --force --all-databases &gt; mysqldump.sql</div><div class=\"line\"></div><div class=\"line\"># 停止数据库</div><div class=\"line\">service mysqld stop</div><div class=\"line\"></div><div class=\"line\"># 删除这些大文件</div><div class=\"line\">rm /usr/local/mysql/var/ibdata1</div><div class=\"line\">rm /usr/local/mysql/var/ib_logfile*</div><div class=\"line\"></div><div class=\"line\"># 手动删除除Mysql之外所有数据库文件夹，然后启动数据库</div><div class=\"line\">service mysqld start</div><div class=\"line\"></div><div class=\"line\"># 还原数据</div><div class=\"line\">mysql -uroot -proot &lt; mysqldump.sql</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-innodb-file-per-table\"><a href=\"#4-innodb-file-per-table\" class=\"headerlink\" title=\"4. innodb_file_per_table\"></a>4. innodb_file_per_table</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;还有一种方式是在创建数据库的时候设置innodb_file_per_table，这样InnoDB会对每个表创建一个数据文件，然后只需要运行OPTIMIZE TABLE 命令就可以释放所有已经删除的磁盘空间。</p>\n<h4 id=\"4-1-修改mysql默认配置文件。\"><a href=\"#4-1-修改mysql默认配置文件。\" class=\"headerlink\" title=\"4.1 修改mysql默认配置文件。\"></a>4.1 修改mysql默认配置文件。</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;编辑my.ini或my.cnf 在innodb段中加入 innodb_file_per_table=1 # 1为启用，0为禁用</p>\n<h4 id=\"4-2-查看修改结果\"><a href=\"#4-2-查看修改结果\" class=\"headerlink\" title=\"4.2 查看修改结果\"></a>4.2 查看修改结果</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过mysql语句可以查看该变量的值：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like &apos;%per_table%&apos;;</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在实际工作中，有时我们会想要去清空一张表的所有数据，常用的命令有delete和truncate这两个命令。</p>\n<h3 id=\"1-delete\"><a href=\"#1-delete\" class=\"headerlink\" title=\"1. delete\"></a>1. delete</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在很多情况，我们对于delete的应用更多，因为它支持更多的匹配模式，我们可以使用where条件语句，清理一些特定的数据，关于delete的操作，这里不做过多解释，有空就专门写写delete的使用和原理。delete 在清空表时，如果表内有自增ID的设定，那么在delete清空之后，再插入数据时，自增ID不会从1开始，默认会继续增加; 除非我们使用OPTIMIZE TABLE，重置表属性；<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; delete from piwik_tmp;</div><div class=\"line\">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-truncate\"><a href=\"#2-truncate\" class=\"headerlink\" title=\"2. truncate\"></a>2. truncate</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truncate 在清空表时，会同时将自增ID重置，再插入新数据时会从1开始，而且truncate在清空表时，不关心表的行数，所以执行效率会高于delete；</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; truncate table piwik_tmp;</div><div class=\"line\">Query OK, 0 rows affected (0.01 sec)</div></pre></td></tr></table></figure>\n<h3 id=\"3-释放表空间\"><a href=\"#3-释放表空间\" class=\"headerlink\" title=\"3. 释放表空间\"></a>3. 释放表空间</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;但是在truncate清空表数据时，myisam的表和innodb的表在使用上有一定的区别；myisam表会清空所有数据，并释放表空间，即硬盘空间会得到释放。innodb表也会清空所有数据，但不释放表空间。Innodb数据库对于已经删除的数据只是标记为删除，并不真正释放所占用的磁盘空间，这就导致InnoDB数据库文件不断增长。如果想彻底释放这些已经删除的数据，需要把数据库导出，删除InnoDB数据库文件，然后再导入。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 备份数据库：</div><div class=\"line\">mysqldump -u -p --quick --force --all-databases &gt; mysqldump.sql</div><div class=\"line\"></div><div class=\"line\"># 停止数据库</div><div class=\"line\">service mysqld stop</div><div class=\"line\"></div><div class=\"line\"># 删除这些大文件</div><div class=\"line\">rm /usr/local/mysql/var/ibdata1</div><div class=\"line\">rm /usr/local/mysql/var/ib_logfile*</div><div class=\"line\"></div><div class=\"line\"># 手动删除除Mysql之外所有数据库文件夹，然后启动数据库</div><div class=\"line\">service mysqld start</div><div class=\"line\"></div><div class=\"line\"># 还原数据</div><div class=\"line\">mysql -uroot -proot &lt; mysqldump.sql</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-innodb-file-per-table\"><a href=\"#4-innodb-file-per-table\" class=\"headerlink\" title=\"4. innodb_file_per_table\"></a>4. innodb_file_per_table</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;还有一种方式是在创建数据库的时候设置innodb_file_per_table，这样InnoDB会对每个表创建一个数据文件，然后只需要运行OPTIMIZE TABLE 命令就可以释放所有已经删除的磁盘空间。</p>\n<h4 id=\"4-1-修改mysql默认配置文件。\"><a href=\"#4-1-修改mysql默认配置文件。\" class=\"headerlink\" title=\"4.1 修改mysql默认配置文件。\"></a>4.1 修改mysql默认配置文件。</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;编辑my.ini或my.cnf 在innodb段中加入 innodb_file_per_table=1 # 1为启用，0为禁用</p>\n<h4 id=\"4-2-查看修改结果\"><a href=\"#4-2-查看修改结果\" class=\"headerlink\" title=\"4.2 查看修改结果\"></a>4.2 查看修改结果</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过mysql语句可以查看该变量的值：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like &apos;%per_table%&apos;;</div></pre></td></tr></table></figure></p>\n"},{"title":"MySQL(6) 利用Linux计划任务定时同步MySQL","id":"9","updated":"2017-04-21T05:39:13.000Z","date":"2016-03-24T00:03:32.000Z","_content":"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 说下实际项目场景，公司一个应用已部署主从数据库，业务也正式上线；现在客户公司领导希望可以看到每天的业务数据报表，本设定直接到从库拿数据，然后进行数据处理，生成报表，但是Java同事提出需求新增用户和权限表，这样一来，如果直接使用生产库的表会导致后台系统管理人员与领导的账户和权限混淆，经过讨论决定，按照生产库的表结构新增特殊用户表和权限表；这样操作实际是可以在从库上新增表单，且不影响主从库之间的数据同步，但是从安全性的考虑，新增表单设计需要给用户Insert权限，为了保证从库只有利用主库同步写入数据，则只能给其他用户select权限。\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>最终决定，因为报表系统的使用率低，直接在报表系统的服务器安装本地mysql数据库，通过计划任务定时到从库上同步数据。</b>\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n### 1. 测试环境\n*  MacBook Pro 15‘ i7 16GB\n*  VMware Fushion 8 Pro\n*  MySQL Version 5.6\n*  CentOS Linux 6.x\n*  slave Server ：172.16.102.129\n*  local Server ：172.167.102.133\n\n\n### 2. 利用mysqldump导出sql文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;需要注意的是，mysqldump时会锁表，需要给mysqldump传递 <i>“--single-transaction”</i>  参数，可以使得mysqldump时不锁表，如下：\n\n```\n/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave > slave.sql\n```\n\n### 3. 使用mysql恢复sql文件到数据库中\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;需要注意的是，如果该local server的slave库中有数据表，当表名与slave server的表名相同时，数据表内的数据会被覆盖；如果local server的表在slave.sql中不存在，则不受影响，正是利用这个特性解决用户需求。\n\n```\n/usr/bin/mysql -u dbuser -pdbuser report < /home/.mysql/slave.sql\n```\n\n### 4. 编写脚本\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 首先在本地某一位置作为临时sql存储地址：\n```\n[root@report ~]# mkdir /home/.mysql     # 这个目录可以自定义\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  脚本1：\n\n```\n#!/bin/bash\n\nTIME=`date \"+%Y%m%d%H\"`\n\nrm -rf /home/.mysql/*\n\n/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave > /home/.mysql/slave_$TIME.sql\n\n/usr/bin/mysql -u dbuser -pdbuser report < /home/.mysql/slave_$TIME.sql\n\n```\n### 5. 增加邮件通知功能\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 因为前期同事需要得知备份的执行结果，所以希望数据同步成功后获得邮件提醒，这里使用sendmail实现，在CentOS里预装是没有安装sendmail，所以我们需要安装sendmail服务，另外一个安装命令行邮件工具mailx：\n\n```\n[root@report ~]# yum install -y sendmail mailx\n\n......\n\n[root@report ~]# service sendmail start\nStarting sendmail:                                         [  OK  ]\nStarting sm-client:                                        [  OK  ]\n[root@report ~]# chkconfig sendmail on\n\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  完整脚本：report_sync.sh ，如下：\n\n```\n#!/bin/bash\n\nTIME=`date \"+%Y%m%d%H\"`\n\nrm -rf /home/.mysql/*\n\n/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave > /home/.mysql/slave_$TIME.sql\n\n/usr/bin/mysql -u dbuser -pdbuser report < /home/.mysql/slave_$TIME.sql\n\n# send mail to adminuser\nif [ $? -eq 0 ]\nthen\n        echo \"report SQL sync is successfully. At time: `date` \" | mail -s report-sync-successfully  hello@abc.cn\nelse\n        echo \" Error Error report SQL sync is Error. At time: `date` \" | mail -s report-sync-error  hello@abc.cn\nfi\n\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  查看下邮件通知：\n![](http://blog.ultraera.org:80/content/images/2016/03/24/p01.jpg)\n\n\n\n### 6. 计划任务crontab\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;和同事及客户沟通，确认每天1、5、9、13、17、21整时到从库拉去数据，Linux选择使用crontab做计划任务，crontab命令常见于Unix和类Unix的操作系统之中，用于设置周期性被执行的指令。该命令从标准输入设备读取指令，并将其存放于“crontab”文件中。通常，crontab储存的指令被守护进程激活， crond常常在后台运行，每一分钟检查是否有预定的作业需要执行。这类作业一般称为cron jobs。\n\n#### 6.1 安装crontab\n\n```\n[root@report ~]# yum install -y vixie-cron\n[root@report ~]# yum install -y crontabs\n\n说明：\nvixie-cron软件包是cron的主程序；\ncrontabs软件包是用来安装、卸装、或列举用来驱动 crond 守护进程的表格的程序。\n\ncron 是linux的内置服务，但它不自动起来，可以用以下的方法启动、关闭这个服务：\n/sbin/service crond start #启动服务\n/sbin/service crond stop #关闭服务\n/sbin/service crond restart #重启服务\n/sbin/service crond reload #重新载入配置\n\n设置crond开机自启动\n[root@report ~]# chkconfig crond on\n\n```\n### 7. 添加计划任务\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;将脚本report_sync.sh 保存到/usr/bin下：\n\n```\n[root@report ~]# mv report_sync.sh /usr/bin\n```\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加计划任务：\n\n```\n[root@report ~]# crontab -e\n\n# add this word.\n* 1-21/4  * * * /usr/bin/report_sync.sh\n\n# 表示在每天的1-21时间内，每4小时执行一个脚本\n\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/MySQL-6-利用Linux计划任务定时同步MySQL.md","raw":"---\ntitle: MySQL(6) 利用Linux计划任务定时同步MySQL\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: crontab-sync-sendmail\nid: 9\nupdated: '2017-04-21 13:39:13'\ndate: 2016-03-24 08:03:32\n---\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 说下实际项目场景，公司一个应用已部署主从数据库，业务也正式上线；现在客户公司领导希望可以看到每天的业务数据报表，本设定直接到从库拿数据，然后进行数据处理，生成报表，但是Java同事提出需求新增用户和权限表，这样一来，如果直接使用生产库的表会导致后台系统管理人员与领导的账户和权限混淆，经过讨论决定，按照生产库的表结构新增特殊用户表和权限表；这样操作实际是可以在从库上新增表单，且不影响主从库之间的数据同步，但是从安全性的考虑，新增表单设计需要给用户Insert权限，为了保证从库只有利用主库同步写入数据，则只能给其他用户select权限。\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>最终决定，因为报表系统的使用率低，直接在报表系统的服务器安装本地mysql数据库，通过计划任务定时到从库上同步数据。</b>\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n### 1. 测试环境\n*  MacBook Pro 15‘ i7 16GB\n*  VMware Fushion 8 Pro\n*  MySQL Version 5.6\n*  CentOS Linux 6.x\n*  slave Server ：172.16.102.129\n*  local Server ：172.167.102.133\n\n\n### 2. 利用mysqldump导出sql文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;需要注意的是，mysqldump时会锁表，需要给mysqldump传递 <i>“--single-transaction”</i>  参数，可以使得mysqldump时不锁表，如下：\n\n```\n/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave > slave.sql\n```\n\n### 3. 使用mysql恢复sql文件到数据库中\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;需要注意的是，如果该local server的slave库中有数据表，当表名与slave server的表名相同时，数据表内的数据会被覆盖；如果local server的表在slave.sql中不存在，则不受影响，正是利用这个特性解决用户需求。\n\n```\n/usr/bin/mysql -u dbuser -pdbuser report < /home/.mysql/slave.sql\n```\n\n### 4. 编写脚本\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 首先在本地某一位置作为临时sql存储地址：\n```\n[root@report ~]# mkdir /home/.mysql     # 这个目录可以自定义\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  脚本1：\n\n```\n#!/bin/bash\n\nTIME=`date \"+%Y%m%d%H\"`\n\nrm -rf /home/.mysql/*\n\n/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave > /home/.mysql/slave_$TIME.sql\n\n/usr/bin/mysql -u dbuser -pdbuser report < /home/.mysql/slave_$TIME.sql\n\n```\n### 5. 增加邮件通知功能\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 因为前期同事需要得知备份的执行结果，所以希望数据同步成功后获得邮件提醒，这里使用sendmail实现，在CentOS里预装是没有安装sendmail，所以我们需要安装sendmail服务，另外一个安装命令行邮件工具mailx：\n\n```\n[root@report ~]# yum install -y sendmail mailx\n\n......\n\n[root@report ~]# service sendmail start\nStarting sendmail:                                         [  OK  ]\nStarting sm-client:                                        [  OK  ]\n[root@report ~]# chkconfig sendmail on\n\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  完整脚本：report_sync.sh ，如下：\n\n```\n#!/bin/bash\n\nTIME=`date \"+%Y%m%d%H\"`\n\nrm -rf /home/.mysql/*\n\n/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave > /home/.mysql/slave_$TIME.sql\n\n/usr/bin/mysql -u dbuser -pdbuser report < /home/.mysql/slave_$TIME.sql\n\n# send mail to adminuser\nif [ $? -eq 0 ]\nthen\n        echo \"report SQL sync is successfully. At time: `date` \" | mail -s report-sync-successfully  hello@abc.cn\nelse\n        echo \" Error Error report SQL sync is Error. At time: `date` \" | mail -s report-sync-error  hello@abc.cn\nfi\n\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  查看下邮件通知：\n![](http://blog.ultraera.org:80/content/images/2016/03/24/p01.jpg)\n\n\n\n### 6. 计划任务crontab\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;和同事及客户沟通，确认每天1、5、9、13、17、21整时到从库拉去数据，Linux选择使用crontab做计划任务，crontab命令常见于Unix和类Unix的操作系统之中，用于设置周期性被执行的指令。该命令从标准输入设备读取指令，并将其存放于“crontab”文件中。通常，crontab储存的指令被守护进程激活， crond常常在后台运行，每一分钟检查是否有预定的作业需要执行。这类作业一般称为cron jobs。\n\n#### 6.1 安装crontab\n\n```\n[root@report ~]# yum install -y vixie-cron\n[root@report ~]# yum install -y crontabs\n\n说明：\nvixie-cron软件包是cron的主程序；\ncrontabs软件包是用来安装、卸装、或列举用来驱动 crond 守护进程的表格的程序。\n\ncron 是linux的内置服务，但它不自动起来，可以用以下的方法启动、关闭这个服务：\n/sbin/service crond start #启动服务\n/sbin/service crond stop #关闭服务\n/sbin/service crond restart #重启服务\n/sbin/service crond reload #重新载入配置\n\n设置crond开机自启动\n[root@report ~]# chkconfig crond on\n\n```\n### 7. 添加计划任务\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;将脚本report_sync.sh 保存到/usr/bin下：\n\n```\n[root@report ~]# mv report_sync.sh /usr/bin\n```\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加计划任务：\n\n```\n[root@report ~]# crontab -e\n\n# add this word.\n* 1-21/4  * * * /usr/bin/report_sync.sh\n\n# 表示在每天的1-21时间内，每4小时执行一个脚本\n\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"crontab-sync-sendmail","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqbg005d41tprzi7ffn6","content":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 说下实际项目场景，公司一个应用已部署主从数据库，业务也正式上线；现在客户公司领导希望可以看到每天的业务数据报表，本设定直接到从库拿数据，然后进行数据处理，生成报表，但是Java同事提出需求新增用户和权限表，这样一来，如果直接使用生产库的表会导致后台系统管理人员与领导的账户和权限混淆，经过讨论决定，按照生产库的表结构新增特殊用户表和权限表；这样操作实际是可以在从库上新增表单，且不影响主从库之间的数据同步，但是从安全性的考虑，新增表单设计需要给用户Insert权限，为了保证从库只有利用主库同步写入数据，则只能给其他用户select权限。</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>最终决定，因为报表系统的使用率低，直接在报表系统的服务器安装本地mysql数据库，通过计划任务定时到从库上同步数据。</b></p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\n<h3 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h3><ul>\n<li>MacBook Pro 15‘ i7 16GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>MySQL Version 5.6</li>\n<li>CentOS Linux 6.x</li>\n<li>slave Server ：172.16.102.129</li>\n<li>local Server ：172.167.102.133</li>\n</ul>\n<h3 id=\"2-利用mysqldump导出sql文件\"><a href=\"#2-利用mysqldump导出sql文件\" class=\"headerlink\" title=\"2. 利用mysqldump导出sql文件\"></a>2. 利用mysqldump导出sql文件</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;需要注意的是，mysqldump时会锁表，需要给mysqldump传递 <i>“–single-transaction”</i>  参数，可以使得mysqldump时不锁表，如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave &gt; slave.sql</div></pre></td></tr></table></figure>\n<h3 id=\"3-使用mysql恢复sql文件到数据库中\"><a href=\"#3-使用mysql恢复sql文件到数据库中\" class=\"headerlink\" title=\"3. 使用mysql恢复sql文件到数据库中\"></a>3. 使用mysql恢复sql文件到数据库中</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;需要注意的是，如果该local server的slave库中有数据表，当表名与slave server的表名相同时，数据表内的数据会被覆盖；如果local server的表在slave.sql中不存在，则不受影响，正是利用这个特性解决用户需求。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/usr/bin/mysql -u dbuser -pdbuser report &lt; /home/.mysql/slave.sql</div></pre></td></tr></table></figure>\n<h3 id=\"4-编写脚本\"><a href=\"#4-编写脚本\" class=\"headerlink\" title=\"4. 编写脚本\"></a>4. 编写脚本</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 首先在本地某一位置作为临时sql存储地址：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# mkdir /home/.mysql     # 这个目录可以自定义</div></pre></td></tr></table></figure></p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  脚本1：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">TIME=`date &quot;+%Y%m%d%H&quot;`</div><div class=\"line\"></div><div class=\"line\">rm -rf /home/.mysql/*</div><div class=\"line\"></div><div class=\"line\">/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave &gt; /home/.mysql/slave_$TIME.sql</div><div class=\"line\"></div><div class=\"line\">/usr/bin/mysql -u dbuser -pdbuser report &lt; /home/.mysql/slave_$TIME.sql</div></pre></td></tr></table></figure>\n<h3 id=\"5-增加邮件通知功能\"><a href=\"#5-增加邮件通知功能\" class=\"headerlink\" title=\"5. 增加邮件通知功能\"></a>5. 增加邮件通知功能</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 因为前期同事需要得知备份的执行结果，所以希望数据同步成功后获得邮件提醒，这里使用sendmail实现，在CentOS里预装是没有安装sendmail，所以我们需要安装sendmail服务，另外一个安装命令行邮件工具mailx：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# yum install -y sendmail mailx</div><div class=\"line\"></div><div class=\"line\">......</div><div class=\"line\"></div><div class=\"line\">[root@report ~]# service sendmail start</div><div class=\"line\">Starting sendmail:                                         [  OK  ]</div><div class=\"line\">Starting sm-client:                                        [  OK  ]</div><div class=\"line\">[root@report ~]# chkconfig sendmail on</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  完整脚本：report_sync.sh ，如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">TIME=`date &quot;+%Y%m%d%H&quot;`</div><div class=\"line\"></div><div class=\"line\">rm -rf /home/.mysql/*</div><div class=\"line\"></div><div class=\"line\">/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave &gt; /home/.mysql/slave_$TIME.sql</div><div class=\"line\"></div><div class=\"line\">/usr/bin/mysql -u dbuser -pdbuser report &lt; /home/.mysql/slave_$TIME.sql</div><div class=\"line\"></div><div class=\"line\"># send mail to adminuser</div><div class=\"line\">if [ $? -eq 0 ]</div><div class=\"line\">then</div><div class=\"line\">        echo &quot;report SQL sync is successfully. At time: `date` &quot; | mail -s report-sync-successfully  hello@abc.cn</div><div class=\"line\">else</div><div class=\"line\">        echo &quot; Error Error report SQL sync is Error. At time: `date` &quot; | mail -s report-sync-error  hello@abc.cn</div><div class=\"line\">fi</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  查看下邮件通知：<br><img src=\"http://blog.ultraera.org:80/content/images/2016/03/24/p01.jpg\" alt=\"\"></p>\n<h3 id=\"6-计划任务crontab\"><a href=\"#6-计划任务crontab\" class=\"headerlink\" title=\"6. 计划任务crontab\"></a>6. 计划任务crontab</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;和同事及客户沟通，确认每天1、5、9、13、17、21整时到从库拉去数据，Linux选择使用crontab做计划任务，crontab命令常见于Unix和类Unix的操作系统之中，用于设置周期性被执行的指令。该命令从标准输入设备读取指令，并将其存放于“crontab”文件中。通常，crontab储存的指令被守护进程激活， crond常常在后台运行，每一分钟检查是否有预定的作业需要执行。这类作业一般称为cron jobs。</p>\n<h4 id=\"6-1-安装crontab\"><a href=\"#6-1-安装crontab\" class=\"headerlink\" title=\"6.1 安装crontab\"></a>6.1 安装crontab</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# yum install -y vixie-cron</div><div class=\"line\">[root@report ~]# yum install -y crontabs</div><div class=\"line\"></div><div class=\"line\">说明：</div><div class=\"line\">vixie-cron软件包是cron的主程序；</div><div class=\"line\">crontabs软件包是用来安装、卸装、或列举用来驱动 crond 守护进程的表格的程序。</div><div class=\"line\"></div><div class=\"line\">cron 是linux的内置服务，但它不自动起来，可以用以下的方法启动、关闭这个服务：</div><div class=\"line\">/sbin/service crond start #启动服务</div><div class=\"line\">/sbin/service crond stop #关闭服务</div><div class=\"line\">/sbin/service crond restart #重启服务</div><div class=\"line\">/sbin/service crond reload #重新载入配置</div><div class=\"line\"></div><div class=\"line\">设置crond开机自启动</div><div class=\"line\">[root@report ~]# chkconfig crond on</div></pre></td></tr></table></figure>\n<h3 id=\"7-添加计划任务\"><a href=\"#7-添加计划任务\" class=\"headerlink\" title=\"7. 添加计划任务\"></a>7. 添加计划任务</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;将脚本report_sync.sh 保存到/usr/bin下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# mv report_sync.sh /usr/bin</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加计划任务：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# crontab -e</div><div class=\"line\"></div><div class=\"line\"># add this word.</div><div class=\"line\">* 1-21/4  * * * /usr/bin/report_sync.sh</div><div class=\"line\"></div><div class=\"line\"># 表示在每天的1-21时间内，每4小时执行一个脚本</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 说下实际项目场景，公司一个应用已部署主从数据库，业务也正式上线；现在客户公司领导希望可以看到每天的业务数据报表，本设定直接到从库拿数据，然后进行数据处理，生成报表，但是Java同事提出需求新增用户和权限表，这样一来，如果直接使用生产库的表会导致后台系统管理人员与领导的账户和权限混淆，经过讨论决定，按照生产库的表结构新增特殊用户表和权限表；这样操作实际是可以在从库上新增表单，且不影响主从库之间的数据同步，但是从安全性的考虑，新增表单设计需要给用户Insert权限，为了保证从库只有利用主库同步写入数据，则只能给其他用户select权限。</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>最终决定，因为报表系统的使用率低，直接在报表系统的服务器安装本地mysql数据库，通过计划任务定时到从库上同步数据。</b></p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\n<h3 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h3><ul>\n<li>MacBook Pro 15‘ i7 16GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>MySQL Version 5.6</li>\n<li>CentOS Linux 6.x</li>\n<li>slave Server ：172.16.102.129</li>\n<li>local Server ：172.167.102.133</li>\n</ul>\n<h3 id=\"2-利用mysqldump导出sql文件\"><a href=\"#2-利用mysqldump导出sql文件\" class=\"headerlink\" title=\"2. 利用mysqldump导出sql文件\"></a>2. 利用mysqldump导出sql文件</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;需要注意的是，mysqldump时会锁表，需要给mysqldump传递 <i>“–single-transaction”</i>  参数，可以使得mysqldump时不锁表，如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave &gt; slave.sql</div></pre></td></tr></table></figure>\n<h3 id=\"3-使用mysql恢复sql文件到数据库中\"><a href=\"#3-使用mysql恢复sql文件到数据库中\" class=\"headerlink\" title=\"3. 使用mysql恢复sql文件到数据库中\"></a>3. 使用mysql恢复sql文件到数据库中</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;需要注意的是，如果该local server的slave库中有数据表，当表名与slave server的表名相同时，数据表内的数据会被覆盖；如果local server的表在slave.sql中不存在，则不受影响，正是利用这个特性解决用户需求。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/usr/bin/mysql -u dbuser -pdbuser report &lt; /home/.mysql/slave.sql</div></pre></td></tr></table></figure>\n<h3 id=\"4-编写脚本\"><a href=\"#4-编写脚本\" class=\"headerlink\" title=\"4. 编写脚本\"></a>4. 编写脚本</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 首先在本地某一位置作为临时sql存储地址：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# mkdir /home/.mysql     # 这个目录可以自定义</div></pre></td></tr></table></figure></p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  脚本1：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">TIME=`date &quot;+%Y%m%d%H&quot;`</div><div class=\"line\"></div><div class=\"line\">rm -rf /home/.mysql/*</div><div class=\"line\"></div><div class=\"line\">/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave &gt; /home/.mysql/slave_$TIME.sql</div><div class=\"line\"></div><div class=\"line\">/usr/bin/mysql -u dbuser -pdbuser report &lt; /home/.mysql/slave_$TIME.sql</div></pre></td></tr></table></figure>\n<h3 id=\"5-增加邮件通知功能\"><a href=\"#5-增加邮件通知功能\" class=\"headerlink\" title=\"5. 增加邮件通知功能\"></a>5. 增加邮件通知功能</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 因为前期同事需要得知备份的执行结果，所以希望数据同步成功后获得邮件提醒，这里使用sendmail实现，在CentOS里预装是没有安装sendmail，所以我们需要安装sendmail服务，另外一个安装命令行邮件工具mailx：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# yum install -y sendmail mailx</div><div class=\"line\"></div><div class=\"line\">......</div><div class=\"line\"></div><div class=\"line\">[root@report ~]# service sendmail start</div><div class=\"line\">Starting sendmail:                                         [  OK  ]</div><div class=\"line\">Starting sm-client:                                        [  OK  ]</div><div class=\"line\">[root@report ~]# chkconfig sendmail on</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  完整脚本：report_sync.sh ，如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">TIME=`date &quot;+%Y%m%d%H&quot;`</div><div class=\"line\"></div><div class=\"line\">rm -rf /home/.mysql/*</div><div class=\"line\"></div><div class=\"line\">/usr/bin/mysqldump -h 172.168.102.129 -u dbuser -pdbuser --single-transaction slave &gt; /home/.mysql/slave_$TIME.sql</div><div class=\"line\"></div><div class=\"line\">/usr/bin/mysql -u dbuser -pdbuser report &lt; /home/.mysql/slave_$TIME.sql</div><div class=\"line\"></div><div class=\"line\"># send mail to adminuser</div><div class=\"line\">if [ $? -eq 0 ]</div><div class=\"line\">then</div><div class=\"line\">        echo &quot;report SQL sync is successfully. At time: `date` &quot; | mail -s report-sync-successfully  hello@abc.cn</div><div class=\"line\">else</div><div class=\"line\">        echo &quot; Error Error report SQL sync is Error. At time: `date` &quot; | mail -s report-sync-error  hello@abc.cn</div><div class=\"line\">fi</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  查看下邮件通知：<br><img src=\"http://blog.ultraera.org:80/content/images/2016/03/24/p01.jpg\" alt=\"\"></p>\n<h3 id=\"6-计划任务crontab\"><a href=\"#6-计划任务crontab\" class=\"headerlink\" title=\"6. 计划任务crontab\"></a>6. 计划任务crontab</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;和同事及客户沟通，确认每天1、5、9、13、17、21整时到从库拉去数据，Linux选择使用crontab做计划任务，crontab命令常见于Unix和类Unix的操作系统之中，用于设置周期性被执行的指令。该命令从标准输入设备读取指令，并将其存放于“crontab”文件中。通常，crontab储存的指令被守护进程激活， crond常常在后台运行，每一分钟检查是否有预定的作业需要执行。这类作业一般称为cron jobs。</p>\n<h4 id=\"6-1-安装crontab\"><a href=\"#6-1-安装crontab\" class=\"headerlink\" title=\"6.1 安装crontab\"></a>6.1 安装crontab</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# yum install -y vixie-cron</div><div class=\"line\">[root@report ~]# yum install -y crontabs</div><div class=\"line\"></div><div class=\"line\">说明：</div><div class=\"line\">vixie-cron软件包是cron的主程序；</div><div class=\"line\">crontabs软件包是用来安装、卸装、或列举用来驱动 crond 守护进程的表格的程序。</div><div class=\"line\"></div><div class=\"line\">cron 是linux的内置服务，但它不自动起来，可以用以下的方法启动、关闭这个服务：</div><div class=\"line\">/sbin/service crond start #启动服务</div><div class=\"line\">/sbin/service crond stop #关闭服务</div><div class=\"line\">/sbin/service crond restart #重启服务</div><div class=\"line\">/sbin/service crond reload #重新载入配置</div><div class=\"line\"></div><div class=\"line\">设置crond开机自启动</div><div class=\"line\">[root@report ~]# chkconfig crond on</div></pre></td></tr></table></figure>\n<h3 id=\"7-添加计划任务\"><a href=\"#7-添加计划任务\" class=\"headerlink\" title=\"7. 添加计划任务\"></a>7. 添加计划任务</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;将脚本report_sync.sh 保存到/usr/bin下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# mv report_sync.sh /usr/bin</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加计划任务：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@report ~]# crontab -e</div><div class=\"line\"></div><div class=\"line\"># add this word.</div><div class=\"line\">* 1-21/4  * * * /usr/bin/report_sync.sh</div><div class=\"line\"></div><div class=\"line\"># 表示在每天的1-21时间内，每4小时执行一个脚本</div></pre></td></tr></table></figure>\n"},{"title":"MySQL(7) 索引创建、删除和查看","id":"131","updated":"2017-04-21T05:16:51.000Z","date":"2017-02-09T10:29:50.000Z","_content":"\n#### **1. 索引的作用**\n\n   在索引列上，数据库利用各种各样的快速定位技术，能够大大的提高查询效率，特别是当数据量非常大和查询设计到多个表时，索引的利用能够将效率提高成千上万倍，当然要合理的利用索引。\n\n#### **2. 创建索引**\n\n​\t在执行CREATE TABLE时可以创建索引，也可以在之后单独使用CREATE INDEX或ALTER TABLE来为表增加索引。\n\n###### 2.1 ALTER TABLE\n\n​\tALTER TABLE用来创建普通索引、UNIQUE索引或PRIMARY KEY索引。\n\n```\nALTER TABLE tb_name ADD INDEX index_Name (column_list);\nALTER TABLE tb_name ADD UNIQUE (column_list);\nALTER TABLE tb_name ADD PRIMARY KEY (column_list);\n```\n\n​\ttb_name 是要增加索引的表名，column_list 是要增加索引的列，多列用逗号隔开，index_Name 是可选，缺省为第一个索引列赋名称，ALTER TABLE允许在单个语句中更改多个表，因此可以也可以同时创建多个索引。\n\n###### 2.2 CREATE INDEX\n\n​\tCREATE INDEX 可对表增加普通索引或者UNIQUE索引。\n\n```\nCREATE INDEX index_Name ON tb_name(column_list);\nCREATE UNIQUE INDEX index_Name ON tb_name(column_list);\n```\n\n​\ttb_name、index_Name和column_list具有ALTER TABLE语句中相同的含义，索引名称不可自定义，也不能创建PRIMARY KEY。\n\n#### **3. 索引类型**\n\n​\t在创建索引时，可以规定索引能否包含重复的值，如果不包含，则索引应该为PRIMARY KEY或UNIQUE索引，对于单列唯一索引，这能保证单列不包含重复的值，对于多列唯一索引，保证多值的组合不重复。\n\n​\tPRIMAY KEY索引与UNIQUE索引非常类似，实际上PRIMAY KEY索引仅是一个具有名称PRIMAY的UNIQUE索引，这表示一个表只能包含一个PRIMAY KEY索引，因为一个表中不可能具有两个同名的索引。\n\n\n\n#### **4. 删除索引**\n\n​\t可以使用ALTER TABLE或DROP INDEX语句来删除索引：\n\n```\nDROP INDEX index_Name On tb_name;\nALTER TABLE tb_Name DROP TABLE index_Name;\nALTER TABLE tb_Name DROP PRIMAY KEY;\n```\n\n​\t第一条和第二条作用是一样的，删除tb_Name中index_Name索引；第三条仅适用于删除PRIMAY KEY时，因为一个只可能有一个PRIMAY KEY索引。\n\n​\t另外，如果在表中删除了某列，则索引会受到影响，对于多列组合的索引，如果删除其中某列，则该列也会在索引中删除，如果删除所有列，则该索引也会被删除。\n\n\n\n#### **5. 查看索引**\n\n```\nmysql> show index from tb_name;\nmysql> show keys from tb_name;\n```\n\n* Table : 表名\n* Non_unique： 如果索引不能包含重复值为0，如果可以为1\n* Key_name： 索引的名称\n* Seq_in_index：索引中列的序号，从1开始\n* Column_name： 列的名称\n* Collation：列以什么方式存储在索引中，在MySQL中有值‘A’(升序)和NULL(无分类)\n* Cardinality： 索引中唯一值的数量估计值，通过运行ANALYZE TABLE或者 myisamchk -a 可以更新，基数根据被存储的整数的统计数据来计数，所以，即使对于小型表，该值也没有必要是精确的，基数越大，当进行联合时，MySQL使用该索引的机会就越大。\n* Sub_part： 如果列只是被部分编入，则为编入索引的字符数目，如果整列被编入索引，则为NULL\n* Packed：关键字如何被压缩，没有压缩为NULL\n* Null： 如果列含有NULL为YES，如果没有则为NO\n* Index_type： 用过的索引方法，BTREE，FULLTEXT，HASH，RTREE\n* Comment： 备注\n","source":"_posts/MySQL-8-索引创建、删除和查看.md","raw":"---\ntitle: MySQL(7) 索引创建、删除和查看\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: mysql-index\nid: 131\nupdated: '2017-04-21 13:16:51'\ndate: 2017-02-09 18:29:50\n---\n\n#### **1. 索引的作用**\n\n   在索引列上，数据库利用各种各样的快速定位技术，能够大大的提高查询效率，特别是当数据量非常大和查询设计到多个表时，索引的利用能够将效率提高成千上万倍，当然要合理的利用索引。\n\n#### **2. 创建索引**\n\n​\t在执行CREATE TABLE时可以创建索引，也可以在之后单独使用CREATE INDEX或ALTER TABLE来为表增加索引。\n\n###### 2.1 ALTER TABLE\n\n​\tALTER TABLE用来创建普通索引、UNIQUE索引或PRIMARY KEY索引。\n\n```\nALTER TABLE tb_name ADD INDEX index_Name (column_list);\nALTER TABLE tb_name ADD UNIQUE (column_list);\nALTER TABLE tb_name ADD PRIMARY KEY (column_list);\n```\n\n​\ttb_name 是要增加索引的表名，column_list 是要增加索引的列，多列用逗号隔开，index_Name 是可选，缺省为第一个索引列赋名称，ALTER TABLE允许在单个语句中更改多个表，因此可以也可以同时创建多个索引。\n\n###### 2.2 CREATE INDEX\n\n​\tCREATE INDEX 可对表增加普通索引或者UNIQUE索引。\n\n```\nCREATE INDEX index_Name ON tb_name(column_list);\nCREATE UNIQUE INDEX index_Name ON tb_name(column_list);\n```\n\n​\ttb_name、index_Name和column_list具有ALTER TABLE语句中相同的含义，索引名称不可自定义，也不能创建PRIMARY KEY。\n\n#### **3. 索引类型**\n\n​\t在创建索引时，可以规定索引能否包含重复的值，如果不包含，则索引应该为PRIMARY KEY或UNIQUE索引，对于单列唯一索引，这能保证单列不包含重复的值，对于多列唯一索引，保证多值的组合不重复。\n\n​\tPRIMAY KEY索引与UNIQUE索引非常类似，实际上PRIMAY KEY索引仅是一个具有名称PRIMAY的UNIQUE索引，这表示一个表只能包含一个PRIMAY KEY索引，因为一个表中不可能具有两个同名的索引。\n\n\n\n#### **4. 删除索引**\n\n​\t可以使用ALTER TABLE或DROP INDEX语句来删除索引：\n\n```\nDROP INDEX index_Name On tb_name;\nALTER TABLE tb_Name DROP TABLE index_Name;\nALTER TABLE tb_Name DROP PRIMAY KEY;\n```\n\n​\t第一条和第二条作用是一样的，删除tb_Name中index_Name索引；第三条仅适用于删除PRIMAY KEY时，因为一个只可能有一个PRIMAY KEY索引。\n\n​\t另外，如果在表中删除了某列，则索引会受到影响，对于多列组合的索引，如果删除其中某列，则该列也会在索引中删除，如果删除所有列，则该索引也会被删除。\n\n\n\n#### **5. 查看索引**\n\n```\nmysql> show index from tb_name;\nmysql> show keys from tb_name;\n```\n\n* Table : 表名\n* Non_unique： 如果索引不能包含重复值为0，如果可以为1\n* Key_name： 索引的名称\n* Seq_in_index：索引中列的序号，从1开始\n* Column_name： 列的名称\n* Collation：列以什么方式存储在索引中，在MySQL中有值‘A’(升序)和NULL(无分类)\n* Cardinality： 索引中唯一值的数量估计值，通过运行ANALYZE TABLE或者 myisamchk -a 可以更新，基数根据被存储的整数的统计数据来计数，所以，即使对于小型表，该值也没有必要是精确的，基数越大，当进行联合时，MySQL使用该索引的机会就越大。\n* Sub_part： 如果列只是被部分编入，则为编入索引的字符数目，如果整列被编入索引，则为NULL\n* Packed：关键字如何被压缩，没有压缩为NULL\n* Null： 如果列含有NULL为YES，如果没有则为NO\n* Index_type： 用过的索引方法，BTREE，FULLTEXT，HASH，RTREE\n* Comment： 备注\n","slug":"mysql-index","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqbm005i41tp14ebcmne","content":"<h4 id=\"1-索引的作用\"><a href=\"#1-索引的作用\" class=\"headerlink\" title=\"1. 索引的作用\"></a><strong>1. 索引的作用</strong></h4><p>   在索引列上，数据库利用各种各样的快速定位技术，能够大大的提高查询效率，特别是当数据量非常大和查询设计到多个表时，索引的利用能够将效率提高成千上万倍，当然要合理的利用索引。</p>\n<h4 id=\"2-创建索引\"><a href=\"#2-创建索引\" class=\"headerlink\" title=\"2. 创建索引\"></a><strong>2. 创建索引</strong></h4><p>​    在执行CREATE TABLE时可以创建索引，也可以在之后单独使用CREATE INDEX或ALTER TABLE来为表增加索引。</p>\n<h6 id=\"2-1-ALTER-TABLE\"><a href=\"#2-1-ALTER-TABLE\" class=\"headerlink\" title=\"2.1 ALTER TABLE\"></a>2.1 ALTER TABLE</h6><p>​    ALTER TABLE用来创建普通索引、UNIQUE索引或PRIMARY KEY索引。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">ALTER TABLE tb_name ADD INDEX index_Name (column_list);</div><div class=\"line\">ALTER TABLE tb_name ADD UNIQUE (column_list);</div><div class=\"line\">ALTER TABLE tb_name ADD PRIMARY KEY (column_list);</div></pre></td></tr></table></figure>\n<p>​    tb_name 是要增加索引的表名，column_list 是要增加索引的列，多列用逗号隔开，index_Name 是可选，缺省为第一个索引列赋名称，ALTER TABLE允许在单个语句中更改多个表，因此可以也可以同时创建多个索引。</p>\n<h6 id=\"2-2-CREATE-INDEX\"><a href=\"#2-2-CREATE-INDEX\" class=\"headerlink\" title=\"2.2 CREATE INDEX\"></a>2.2 CREATE INDEX</h6><p>​    CREATE INDEX 可对表增加普通索引或者UNIQUE索引。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">CREATE INDEX index_Name ON tb_name(column_list);</div><div class=\"line\">CREATE UNIQUE INDEX index_Name ON tb_name(column_list);</div></pre></td></tr></table></figure>\n<p>​    tb_name、index_Name和column_list具有ALTER TABLE语句中相同的含义，索引名称不可自定义，也不能创建PRIMARY KEY。</p>\n<h4 id=\"3-索引类型\"><a href=\"#3-索引类型\" class=\"headerlink\" title=\"3. 索引类型\"></a><strong>3. 索引类型</strong></h4><p>​    在创建索引时，可以规定索引能否包含重复的值，如果不包含，则索引应该为PRIMARY KEY或UNIQUE索引，对于单列唯一索引，这能保证单列不包含重复的值，对于多列唯一索引，保证多值的组合不重复。</p>\n<p>​    PRIMAY KEY索引与UNIQUE索引非常类似，实际上PRIMAY KEY索引仅是一个具有名称PRIMAY的UNIQUE索引，这表示一个表只能包含一个PRIMAY KEY索引，因为一个表中不可能具有两个同名的索引。</p>\n<h4 id=\"4-删除索引\"><a href=\"#4-删除索引\" class=\"headerlink\" title=\"4. 删除索引\"></a><strong>4. 删除索引</strong></h4><p>​    可以使用ALTER TABLE或DROP INDEX语句来删除索引：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">DROP INDEX index_Name On tb_name;</div><div class=\"line\">ALTER TABLE tb_Name DROP TABLE index_Name;</div><div class=\"line\">ALTER TABLE tb_Name DROP PRIMAY KEY;</div></pre></td></tr></table></figure>\n<p>​    第一条和第二条作用是一样的，删除tb_Name中index_Name索引；第三条仅适用于删除PRIMAY KEY时，因为一个只可能有一个PRIMAY KEY索引。</p>\n<p>​    另外，如果在表中删除了某列，则索引会受到影响，对于多列组合的索引，如果删除其中某列，则该列也会在索引中删除，如果删除所有列，则该索引也会被删除。</p>\n<h4 id=\"5-查看索引\"><a href=\"#5-查看索引\" class=\"headerlink\" title=\"5. 查看索引\"></a><strong>5. 查看索引</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show index from tb_name;</div><div class=\"line\">mysql&gt; show keys from tb_name;</div></pre></td></tr></table></figure>\n<ul>\n<li>Table : 表名</li>\n<li>Non_unique： 如果索引不能包含重复值为0，如果可以为1</li>\n<li>Key_name： 索引的名称</li>\n<li>Seq_in_index：索引中列的序号，从1开始</li>\n<li>Column_name： 列的名称</li>\n<li>Collation：列以什么方式存储在索引中，在MySQL中有值‘A’(升序)和NULL(无分类)</li>\n<li>Cardinality： 索引中唯一值的数量估计值，通过运行ANALYZE TABLE或者 myisamchk -a 可以更新，基数根据被存储的整数的统计数据来计数，所以，即使对于小型表，该值也没有必要是精确的，基数越大，当进行联合时，MySQL使用该索引的机会就越大。</li>\n<li>Sub_part： 如果列只是被部分编入，则为编入索引的字符数目，如果整列被编入索引，则为NULL</li>\n<li>Packed：关键字如何被压缩，没有压缩为NULL</li>\n<li>Null： 如果列含有NULL为YES，如果没有则为NO</li>\n<li>Index_type： 用过的索引方法，BTREE，FULLTEXT，HASH，RTREE</li>\n<li>Comment： 备注</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"1-索引的作用\"><a href=\"#1-索引的作用\" class=\"headerlink\" title=\"1. 索引的作用\"></a><strong>1. 索引的作用</strong></h4><p>   在索引列上，数据库利用各种各样的快速定位技术，能够大大的提高查询效率，特别是当数据量非常大和查询设计到多个表时，索引的利用能够将效率提高成千上万倍，当然要合理的利用索引。</p>\n<h4 id=\"2-创建索引\"><a href=\"#2-创建索引\" class=\"headerlink\" title=\"2. 创建索引\"></a><strong>2. 创建索引</strong></h4><p>​    在执行CREATE TABLE时可以创建索引，也可以在之后单独使用CREATE INDEX或ALTER TABLE来为表增加索引。</p>\n<h6 id=\"2-1-ALTER-TABLE\"><a href=\"#2-1-ALTER-TABLE\" class=\"headerlink\" title=\"2.1 ALTER TABLE\"></a>2.1 ALTER TABLE</h6><p>​    ALTER TABLE用来创建普通索引、UNIQUE索引或PRIMARY KEY索引。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">ALTER TABLE tb_name ADD INDEX index_Name (column_list);</div><div class=\"line\">ALTER TABLE tb_name ADD UNIQUE (column_list);</div><div class=\"line\">ALTER TABLE tb_name ADD PRIMARY KEY (column_list);</div></pre></td></tr></table></figure>\n<p>​    tb_name 是要增加索引的表名，column_list 是要增加索引的列，多列用逗号隔开，index_Name 是可选，缺省为第一个索引列赋名称，ALTER TABLE允许在单个语句中更改多个表，因此可以也可以同时创建多个索引。</p>\n<h6 id=\"2-2-CREATE-INDEX\"><a href=\"#2-2-CREATE-INDEX\" class=\"headerlink\" title=\"2.2 CREATE INDEX\"></a>2.2 CREATE INDEX</h6><p>​    CREATE INDEX 可对表增加普通索引或者UNIQUE索引。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">CREATE INDEX index_Name ON tb_name(column_list);</div><div class=\"line\">CREATE UNIQUE INDEX index_Name ON tb_name(column_list);</div></pre></td></tr></table></figure>\n<p>​    tb_name、index_Name和column_list具有ALTER TABLE语句中相同的含义，索引名称不可自定义，也不能创建PRIMARY KEY。</p>\n<h4 id=\"3-索引类型\"><a href=\"#3-索引类型\" class=\"headerlink\" title=\"3. 索引类型\"></a><strong>3. 索引类型</strong></h4><p>​    在创建索引时，可以规定索引能否包含重复的值，如果不包含，则索引应该为PRIMARY KEY或UNIQUE索引，对于单列唯一索引，这能保证单列不包含重复的值，对于多列唯一索引，保证多值的组合不重复。</p>\n<p>​    PRIMAY KEY索引与UNIQUE索引非常类似，实际上PRIMAY KEY索引仅是一个具有名称PRIMAY的UNIQUE索引，这表示一个表只能包含一个PRIMAY KEY索引，因为一个表中不可能具有两个同名的索引。</p>\n<h4 id=\"4-删除索引\"><a href=\"#4-删除索引\" class=\"headerlink\" title=\"4. 删除索引\"></a><strong>4. 删除索引</strong></h4><p>​    可以使用ALTER TABLE或DROP INDEX语句来删除索引：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">DROP INDEX index_Name On tb_name;</div><div class=\"line\">ALTER TABLE tb_Name DROP TABLE index_Name;</div><div class=\"line\">ALTER TABLE tb_Name DROP PRIMAY KEY;</div></pre></td></tr></table></figure>\n<p>​    第一条和第二条作用是一样的，删除tb_Name中index_Name索引；第三条仅适用于删除PRIMAY KEY时，因为一个只可能有一个PRIMAY KEY索引。</p>\n<p>​    另外，如果在表中删除了某列，则索引会受到影响，对于多列组合的索引，如果删除其中某列，则该列也会在索引中删除，如果删除所有列，则该索引也会被删除。</p>\n<h4 id=\"5-查看索引\"><a href=\"#5-查看索引\" class=\"headerlink\" title=\"5. 查看索引\"></a><strong>5. 查看索引</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show index from tb_name;</div><div class=\"line\">mysql&gt; show keys from tb_name;</div></pre></td></tr></table></figure>\n<ul>\n<li>Table : 表名</li>\n<li>Non_unique： 如果索引不能包含重复值为0，如果可以为1</li>\n<li>Key_name： 索引的名称</li>\n<li>Seq_in_index：索引中列的序号，从1开始</li>\n<li>Column_name： 列的名称</li>\n<li>Collation：列以什么方式存储在索引中，在MySQL中有值‘A’(升序)和NULL(无分类)</li>\n<li>Cardinality： 索引中唯一值的数量估计值，通过运行ANALYZE TABLE或者 myisamchk -a 可以更新，基数根据被存储的整数的统计数据来计数，所以，即使对于小型表，该值也没有必要是精确的，基数越大，当进行联合时，MySQL使用该索引的机会就越大。</li>\n<li>Sub_part： 如果列只是被部分编入，则为编入索引的字符数目，如果整列被编入索引，则为NULL</li>\n<li>Packed：关键字如何被压缩，没有压缩为NULL</li>\n<li>Null： 如果列含有NULL为YES，如果没有则为NO</li>\n<li>Index_type： 用过的索引方法，BTREE，FULLTEXT，HASH，RTREE</li>\n<li>Comment： 备注</li>\n</ul>\n"},{"title":"OpenStak 介绍","id":"50","updated":"2017-04-21T05:33:48.000Z","date":"2016-05-15T04:52:05.000Z","_content":"\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide01.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide02.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide03.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide04.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide05.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide07.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide08.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide09.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide10.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide11.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide12.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide13.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide14.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide15.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide16.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide17.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide18.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide19.jpg)\n","source":"_posts/OpenStak-介绍.md","raw":"---\ntitle: OpenStak 介绍\ntags: ' - OpenStack'\ncategories: 'OpenStack'\npermalink: openstak-jie-shao\nid: 50\nupdated: '2017-04-21 13:33:48'\ndate: 2016-05-15 12:52:05\n---\n\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide01.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide02.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide03.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide04.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide05.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide07.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide08.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide09.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide10.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide11.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide12.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide13.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide14.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide15.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide16.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide17.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide18.jpg)\n![](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide19.jpg)\n","slug":"openstak-jie-shao","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqbp005l41tpvbshcns0","content":"<p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide01.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide02.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide03.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide04.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide05.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide07.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide08.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide09.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide10.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide11.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide12.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide13.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide14.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide15.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide16.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide17.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide18.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide19.jpg\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide01.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide02.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide03.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide04.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide05.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide07.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide08.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide09.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide10.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide11.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide12.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide13.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide14.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide15.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide16.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide17.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide18.jpg\" alt=\"\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F05%2FSlide19.jpg\" alt=\"\"></p>\n"},{"title":"Python(1) 基础","id":"107","updated":"2017-04-21T05:21:03.000Z","date":"2016-11-10T16:32:13.000Z","_content":"\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/><meta name=\"exporter-version\" content=\"Evernote Mac 6.10 (454269)\"/><meta name=\"author\" content=\"Alex LU\"/><meta name=\"created\" content=\"2016-09-29 02:27:16 +0000\"/><meta name=\"source\" content=\"desktop.mac\"/><meta name=\"updated\" content=\"2016-09-29 06:27:40 +0000\"/><title>Python学习笔记(1) --Python基础</title></head><body>\n<ol>\n<li>输出： print\n<ol>\n<li>python2：print 'Hello Python'</li>\n<li>python3: print(‘Hello Python')</li>\n<li>python(‘10+20=‘,10+20)</li>\n</ol>\n</li>\n<li>输入：\n<ol>\n<li>python2：raw_input()</li>\n<li>python3: input()</li>\n</ol>\n</li>\n<li>python的语法比较简单，采用缩进的方式：</li>\n</ol>\n<div style=\"-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\">\n<div>a = 100</div>\n<div>if a &gt;= 0:</div>\n<div>     print(a)</div>\n<div>else:</div>\n<div>     print(-a)</div>\n<div><br/></div>\n<div>&amp; diff &amp;</div>\n<div>a = 100</div>\n<div>if a &gt;=0:</div>\n<div>print(a)</div>\n<div>else:</div>\n<div>print(-a)</div>\n</div>\n<ol start=\"4\">\n<li># 开头为注释；: 结尾，缩进的语句视为代码块；Python大小写是敏感的，约定俗成：4个空格的缩进，可以吧tab设置为4个空格。</li>\n<li>Python 的数据类型\n<ol>\n<li>整数：python可以处理任意大小的整数</li>\n<li>浮点数：也就是小数，之所以称之为浮点数，因为按照科学计数法表示时，一个浮点数的小数点位置是可变的</li>\n<li>字符串：字符串是以’’和”” 包括起来的任意文本，例如’abc’,”xyz”；如果字符内部同时包含’和”，可以使用\\转义字符来标识。\n<ol>\n<li>如果字符串内部有很多换行，用\\n不好阅读，python支持使用’’’…’’' 的格式表示多行‘</li>\n<li>r’…'  python可以使用r’’表示’'以内的字符不转义;多行: r’’’…’''</li>\n</ol>\n</li>\n<li>布尔值：布尔值和布尔代数表示的完全一致，一个布尔值只有True和False，python支持直接使用True和False表示布尔值，注意大小写，另外最好不要生命变量时使用True等，布尔值，经常用于在条件判断之中。\n<ol>\n<li>and : 与运算，所有运算结果都是True，and的结果才是True</li>\n<li>or：或运算，只有1个运算结果为True，or的结果就是True</li>\n<li>not：他是一个单目运算符，取相反的值</li>\n</ol>\n</li>\n<li>空值：python里的一个特殊值，用None表示，注意None不能理解为0，因为0是有意义的，而None是一个特殊的空值</li>\n</ol>\n</li>\n<li>python的变量\n<ol>\n<li>命名规则：必须是大小写英文，数字和_的组合，且不能用数字开头；</li>\n<li>赋值符号：’=’；等于的符号是’==’</li>\n<li>动态语言：变量本身类型不固定的语言称之为动态语言，反之是静态语言，静态语言在定义变量时必须制定变量的数据类型，如果赋值的时候类型不匹配，就会报错；</li>\n<li>变量在计算机内存中的表示：a=1,指的是python在内存中创建了整数1，然后在内存创建了变量a，并把它指向了整数1</li>\n</ol>\n</li>\n<li>python的常量\n<ol>\n<li>定义：常量就是不能改变的变量，在python中，通常使用全部大写的变量名表示常量</li>\n<li>整数的除法是精确的，因为除法计算结果是浮点数，例如 9/3 结果为3.0 ; 另外一种除法是’//‘ 地板除，两个整数的除法任然是整数；余数运算’%’</li>\n</ol>\n</li>\n<li>字符编码：字符串是一种数据类型，但是字符串还涉及到一个编码问题，Python3的字符串是支持多语言的\n<ol>\n<li>ord(‘')函数 获取字符的整数表示；</li>\n<li>chr(‘')函数 把编码转换成对应的字符；</li>\n<li>python的字符串类型是str，在内存中以Unicode表示，一个字符对应若干字节，但是如果要在网络传输或者保存到磁盘，就要把str转化为单位的bytes；\n<ol>\n<li>python对于bytes的数据类型用带b前缀的单引号或双引号表示：</li>\n<li>另外，Unicode表示的str可用encode()函数，指定编码为bytes。 ‘ABC’ .encode(‘utf-8')</li>\n<li>decode() 可以吧bytes转变为str。b'ABC' .decode('ascii')</li>\n<li>要计算str包含了多少个字符使用 len()函数： len(‘hello’) ,结果为5</li>\n</ol>\n</li>\n<li style=\"-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\">#!/usr/bin/env python3<br/>\n# -*- coding: utf-8 -*-</li>\n</ol>\n</li>\n<li>格式化： 如何处理格式化输出字符串，在python中使用的格式化方式和C语言是一致的，用’%’实现：\n<ol>\n<li>%d 表示整数</li>\n<li>%f 表示浮点数</li>\n<li>%s 表示字符串，如果不确定用什么，用%s，它会把任何数据类型转换为字符串</li>\n<li>%x 表示十六进制整数</li>\n<li>%% 表示一个普通的%</li>\n</ol>\n</li>\n<li>数据类型list和tuple\n<ol>\n<li>list是python内置的一种数据类型：列表，list是一个有序的集合，可以随时添加和删除其中元素。\n<ol>\n<li>classmates = [‘Michael’,’Bob’,’Tracy’]， 可以用len()函数获取这个list的元素的个数</li>\n<li>可以用索引来访问list中的每一个位置的元素，记住索引的第一个位置是0：</li>\n<li>当索引超出范围的时候，python会报出IndexError错误，记得最后一个索引是len(classmates) -1</li>\n<li>如果直接取出最后一个索引可用classmates[-1],以此类推</li>\n</ol>\n</li>\n<li>list是一个可变的有序列表，所以可以去追加，插入指定位置，删除，替换等操作，支持不同数据类型，支持嵌套list\n<ol>\n<li>追加: classmates.append(‘Adam')</li>\n<li>插入指定位置: classmates.insert(2,’Jack')</li>\n<li>删除list末尾的元素： classmates.pop()</li>\n<li>删除指定位置的元素: classmates.pop(1)</li>\n<li>替换元素：classmates[1]=‘Sarch’ ， 直接给相应位置的元素重新赋值即可</li>\n<li>list的元素支持不同的数据类型, L = [‘abc’,23,23.4]</li>\n<li>list的元素支持嵌套另外一个list： s = [‘abc',123,[‘XYZ’,2.34]]，注意这个时候len(s)的元素是3个</li>\n<li>list也可以没有元素，就是一个空的list，它的长度为0</li>\n</ol>\n</li>\n<li>tuple：元组，也是一种有序列表，但是tuple一旦初始化就不能修改，他没有append()也没有insert()，这样的方法，其他获取元素的方式和list一样，也不能赋值成为另外的元素：\n<ol>\n<li>classmates = (‘Michael’,’Bob’,’Tracy’) 注意list用的是’[]’，而tuple用的是’()’</li>\n<li>tuple 有个问题，当你定义1个元素的时候，tuple的()和数学公式中的小括号混淆 ，因此python规定，这种情况下面，当定义只有1个tuple时必须增加一个逗号’,’来消除歧义。</li>\n<li>tuple的元素也可以为list或者tuple，tuple的元素不会改变，但是list是一个可以改变的有序数列，所以当tuple中包含list时，这个tuple是’可变的'</li>\n</ol>\n</li>\n<li>取出特定元素： L[[‘Apple’,’Google’,’Microsoft’],[‘Java’,’Python’,’C’]] ; L[1][1] = ‘Python'</li>\n</ol>\n</li>\n<li>条件判断\n<ol>\n<li>if：根据python的缩进规则，如果if语句的判断是True，就会执行下面的语句，否则什么都不做</li>\n<li>else：也可以个if添加else，意思就是，如果if的判断是false，不要执行if的内容，执行else的内容</li>\n<li>elif：如果要嵌套多级判断条件的话，使用elif，elif 是else if的缩写</li>\n<li>if语句执行有个特点，它是自上而下的判断，如果某个判断的结果是True，那么执行该判断对应的语句，就会忽略掉剩下的所有elif和else，if判断条件还可以简写: if x: 只要x是非零数值、非空字符串、非空list等，就判断为True，</li>\n</ol>\n</li>\n<li>iput(): 需要注意的地方，默认input的返回类型是str，由于str不能直接整数比较，所以在碰到明明输入200，但是不能和201对比时，记住先要把str转化为整数，python提供了int()函数, 转化数据类型为int类型，但是如果输入’abc’则会得到1个ValueError的错误</li>\n<li>循环\n<ol>\n<li>for…in ： 依次把list或者tuple的每个元素迭代出来，for x in … ：循环就是把每个元素带入变量x，然后执行缩进的语句：</li>\n<li>range()函数：用来生成一个整数序列，再通过list()函数转换为list，例如range(5)生成：0,1,2,3,4\n<ol>\n<li>list(range(5)) = [0,1,2,3,4]</li>\n<li>计算1+...+100的结果： for x in range(101): sum = sum +x</li>\n</ol>\n</li>\n<li>while 循环： 只要条件满足，就不断循环，条件不足时退出循环：\n<ol>\n<li>计算100以内所有奇数之和： sum = 0,n = 99, while n &gt; 0: sum =sum +n; n = n-2</li>\n</ol>\n</li>\n<li>break: 在循环中，break语句可以提前退出循环，当程序执行满足break条件的时候，就会退出循环</li>\n<li>continue: 在循环过程中，也可以通过continue语句，跳过当前的这次循环。</li>\n<li>注意：循环是让计算机做重复任务的有效方法，break语句可以在循环过程总直接退出循环，continue语句可以提前结束本轮循环，并直接进入下一轮循环，这两个语句通常必须配合if语句使用，但是尽量不要滥用这两个语句，因为当break和continue使用过多会导致代码执行逻辑分支过多，容易出错。</li>\n</ol>\n</li>\n<li>dict和set\n<ol>\n<li>dict： python内置了字典：dict的支持，全称：dictionary，在其他语言中也称之为map，使用键值存储，具有极快的查找速度。</li>\n<li>对比list处理方式：会过滤整个list的元素，这导致list越长，耗时越长；dict实现时，只需要创建key-values对应表，直接根据名字查找，无论这个表有多大，查找速度都不会变慢，但是内存消耗会大，典型用性能(内存空间)换时间。</li>\n<li>dict的初始化: d {‘Michael’:95,’Bob’:75,’Tracy’:85}  # 注意dict使用的是大括号’{}‘</li>\n<li>dict的数据插入： d [‘Adam’] = 67 </li>\n<li>由于dict是根据key检索，所以key是固定的，一个key只能对应1个value,所以当对1个key多次放入value时，后面的值会把前面的值冲掉： （类似变量）</li>\n<li>但是如果查询的key不存在,dict会报错，KeyError，可以用in 判断key是否存在: ‘key’ in d  : True/False</li>\n<li>通过dict的get方法，如果key不存在，可以返回None，或者自己指定的值，d.get(‘Key’) , d.get(‘key’,-1)</li>\n<li>d.pop('key’): 删除1个key，注意当key被删除是，相应的value也会被删除。</li>\n<li>另外注意：dict内部存放的顺序和key放入的顺序是没有关系的：</li>\n<li>dict应在需要高速查找的地方，正确使用dict非常重要，要牢记1点，dict的key必须是不可变的对象，因为dict是根据key来计算value的位置，如果每次计算相同的key得到的结果不一样，那么dict内部就完全混乱了，这个通过key计算位置的算法称之为Hash算法。</li>\n<li>要保证hash的准确性，作为key的对象就不能改变，在python中，字符串·整数等都是不可变的，但是list是可以变的所以不能作为key</li>\n<li>set： set和dict类似，也是一组key的集合，但是不存储value，由于key不能重复，所以，在set中，没有重复的key值。</li>\n<li>要创建一个set，需要提供一个list作为输入集合。 s = set([1,2,3])   : s = {1,2,3}</li>\n<li>注意set也不是有序的，而且重复在set存在的元素会被自动过滤： s = set([1,2,3,1,2,3,1,2,3])  s = {1,2,3}</li>\n<li>通过s.add(key) 可以增加元素到set中，可以重复添加，但是不会有效果</li>\n<li>通过s.remove(key) 可以删除元素</li>\n<li>set 可以看成数学意义上的无序和无重复元素的集合，因此两个set可以做数学意义上的交集、并集能操作：\n<ol>\n<li>s1 = set([1,2,3]), s2 = set([2,3,4]) ,交集： s1 &amp; s2 = {2,3} ; s1 | s2 = {1,2,3,4}</li>\n</ol>\n</li>\n<li>set和dict的区别仅在于有没有存储对应的value，但是set和dict的原理是一样的，所以，同样不可以放置可变对象，因为无法判断两个对象是否相等，也就无法保证set内部的不会重复元素</li>\n<li>不可变对象：str是不变对象，list是可变对象；对于可变对象，例如list，对list进行操作，list的内部会发生变化</li>\n<li>a = ‘abc’ , a.replace(‘a’,’A’) # 这个操作是把所有小写的a替换成大写的A，但是注意a的值并没有发生改变，要牢记a是变量，’abc'才是字符对象。</li>\n</ol>\n</li>\n</ol>\n</body>\n</html>\n","source":"_posts/Python-1-基础.md","raw":"---\ntitle: Python(1) 基础\ntags: 'Python'\ncategories: 'Python'\npermalink: python-lesson-1\nid: 107\nupdated: '2017-04-21 13:21:03'\ndate: 2016-11-11 00:32:13\n---\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/><meta name=\"exporter-version\" content=\"Evernote Mac 6.10 (454269)\"/><meta name=\"author\" content=\"Alex LU\"/><meta name=\"created\" content=\"2016-09-29 02:27:16 +0000\"/><meta name=\"source\" content=\"desktop.mac\"/><meta name=\"updated\" content=\"2016-09-29 06:27:40 +0000\"/><title>Python学习笔记(1) --Python基础</title></head><body>\n<ol>\n<li>输出： print\n<ol>\n<li>python2：print 'Hello Python'</li>\n<li>python3: print(‘Hello Python')</li>\n<li>python(‘10+20=‘,10+20)</li>\n</ol>\n</li>\n<li>输入：\n<ol>\n<li>python2：raw_input()</li>\n<li>python3: input()</li>\n</ol>\n</li>\n<li>python的语法比较简单，采用缩进的方式：</li>\n</ol>\n<div style=\"-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\">\n<div>a = 100</div>\n<div>if a &gt;= 0:</div>\n<div>     print(a)</div>\n<div>else:</div>\n<div>     print(-a)</div>\n<div><br/></div>\n<div>&amp; diff &amp;</div>\n<div>a = 100</div>\n<div>if a &gt;=0:</div>\n<div>print(a)</div>\n<div>else:</div>\n<div>print(-a)</div>\n</div>\n<ol start=\"4\">\n<li># 开头为注释；: 结尾，缩进的语句视为代码块；Python大小写是敏感的，约定俗成：4个空格的缩进，可以吧tab设置为4个空格。</li>\n<li>Python 的数据类型\n<ol>\n<li>整数：python可以处理任意大小的整数</li>\n<li>浮点数：也就是小数，之所以称之为浮点数，因为按照科学计数法表示时，一个浮点数的小数点位置是可变的</li>\n<li>字符串：字符串是以’’和”” 包括起来的任意文本，例如’abc’,”xyz”；如果字符内部同时包含’和”，可以使用\\转义字符来标识。\n<ol>\n<li>如果字符串内部有很多换行，用\\n不好阅读，python支持使用’’’…’’' 的格式表示多行‘</li>\n<li>r’…'  python可以使用r’’表示’'以内的字符不转义;多行: r’’’…’''</li>\n</ol>\n</li>\n<li>布尔值：布尔值和布尔代数表示的完全一致，一个布尔值只有True和False，python支持直接使用True和False表示布尔值，注意大小写，另外最好不要生命变量时使用True等，布尔值，经常用于在条件判断之中。\n<ol>\n<li>and : 与运算，所有运算结果都是True，and的结果才是True</li>\n<li>or：或运算，只有1个运算结果为True，or的结果就是True</li>\n<li>not：他是一个单目运算符，取相反的值</li>\n</ol>\n</li>\n<li>空值：python里的一个特殊值，用None表示，注意None不能理解为0，因为0是有意义的，而None是一个特殊的空值</li>\n</ol>\n</li>\n<li>python的变量\n<ol>\n<li>命名规则：必须是大小写英文，数字和_的组合，且不能用数字开头；</li>\n<li>赋值符号：’=’；等于的符号是’==’</li>\n<li>动态语言：变量本身类型不固定的语言称之为动态语言，反之是静态语言，静态语言在定义变量时必须制定变量的数据类型，如果赋值的时候类型不匹配，就会报错；</li>\n<li>变量在计算机内存中的表示：a=1,指的是python在内存中创建了整数1，然后在内存创建了变量a，并把它指向了整数1</li>\n</ol>\n</li>\n<li>python的常量\n<ol>\n<li>定义：常量就是不能改变的变量，在python中，通常使用全部大写的变量名表示常量</li>\n<li>整数的除法是精确的，因为除法计算结果是浮点数，例如 9/3 结果为3.0 ; 另外一种除法是’//‘ 地板除，两个整数的除法任然是整数；余数运算’%’</li>\n</ol>\n</li>\n<li>字符编码：字符串是一种数据类型，但是字符串还涉及到一个编码问题，Python3的字符串是支持多语言的\n<ol>\n<li>ord(‘')函数 获取字符的整数表示；</li>\n<li>chr(‘')函数 把编码转换成对应的字符；</li>\n<li>python的字符串类型是str，在内存中以Unicode表示，一个字符对应若干字节，但是如果要在网络传输或者保存到磁盘，就要把str转化为单位的bytes；\n<ol>\n<li>python对于bytes的数据类型用带b前缀的单引号或双引号表示：</li>\n<li>另外，Unicode表示的str可用encode()函数，指定编码为bytes。 ‘ABC’ .encode(‘utf-8')</li>\n<li>decode() 可以吧bytes转变为str。b'ABC' .decode('ascii')</li>\n<li>要计算str包含了多少个字符使用 len()函数： len(‘hello’) ,结果为5</li>\n</ol>\n</li>\n<li style=\"-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\">#!/usr/bin/env python3<br/>\n# -*- coding: utf-8 -*-</li>\n</ol>\n</li>\n<li>格式化： 如何处理格式化输出字符串，在python中使用的格式化方式和C语言是一致的，用’%’实现：\n<ol>\n<li>%d 表示整数</li>\n<li>%f 表示浮点数</li>\n<li>%s 表示字符串，如果不确定用什么，用%s，它会把任何数据类型转换为字符串</li>\n<li>%x 表示十六进制整数</li>\n<li>%% 表示一个普通的%</li>\n</ol>\n</li>\n<li>数据类型list和tuple\n<ol>\n<li>list是python内置的一种数据类型：列表，list是一个有序的集合，可以随时添加和删除其中元素。\n<ol>\n<li>classmates = [‘Michael’,’Bob’,’Tracy’]， 可以用len()函数获取这个list的元素的个数</li>\n<li>可以用索引来访问list中的每一个位置的元素，记住索引的第一个位置是0：</li>\n<li>当索引超出范围的时候，python会报出IndexError错误，记得最后一个索引是len(classmates) -1</li>\n<li>如果直接取出最后一个索引可用classmates[-1],以此类推</li>\n</ol>\n</li>\n<li>list是一个可变的有序列表，所以可以去追加，插入指定位置，删除，替换等操作，支持不同数据类型，支持嵌套list\n<ol>\n<li>追加: classmates.append(‘Adam')</li>\n<li>插入指定位置: classmates.insert(2,’Jack')</li>\n<li>删除list末尾的元素： classmates.pop()</li>\n<li>删除指定位置的元素: classmates.pop(1)</li>\n<li>替换元素：classmates[1]=‘Sarch’ ， 直接给相应位置的元素重新赋值即可</li>\n<li>list的元素支持不同的数据类型, L = [‘abc’,23,23.4]</li>\n<li>list的元素支持嵌套另外一个list： s = [‘abc',123,[‘XYZ’,2.34]]，注意这个时候len(s)的元素是3个</li>\n<li>list也可以没有元素，就是一个空的list，它的长度为0</li>\n</ol>\n</li>\n<li>tuple：元组，也是一种有序列表，但是tuple一旦初始化就不能修改，他没有append()也没有insert()，这样的方法，其他获取元素的方式和list一样，也不能赋值成为另外的元素：\n<ol>\n<li>classmates = (‘Michael’,’Bob’,’Tracy’) 注意list用的是’[]’，而tuple用的是’()’</li>\n<li>tuple 有个问题，当你定义1个元素的时候，tuple的()和数学公式中的小括号混淆 ，因此python规定，这种情况下面，当定义只有1个tuple时必须增加一个逗号’,’来消除歧义。</li>\n<li>tuple的元素也可以为list或者tuple，tuple的元素不会改变，但是list是一个可以改变的有序数列，所以当tuple中包含list时，这个tuple是’可变的'</li>\n</ol>\n</li>\n<li>取出特定元素： L[[‘Apple’,’Google’,’Microsoft’],[‘Java’,’Python’,’C’]] ; L[1][1] = ‘Python'</li>\n</ol>\n</li>\n<li>条件判断\n<ol>\n<li>if：根据python的缩进规则，如果if语句的判断是True，就会执行下面的语句，否则什么都不做</li>\n<li>else：也可以个if添加else，意思就是，如果if的判断是false，不要执行if的内容，执行else的内容</li>\n<li>elif：如果要嵌套多级判断条件的话，使用elif，elif 是else if的缩写</li>\n<li>if语句执行有个特点，它是自上而下的判断，如果某个判断的结果是True，那么执行该判断对应的语句，就会忽略掉剩下的所有elif和else，if判断条件还可以简写: if x: 只要x是非零数值、非空字符串、非空list等，就判断为True，</li>\n</ol>\n</li>\n<li>iput(): 需要注意的地方，默认input的返回类型是str，由于str不能直接整数比较，所以在碰到明明输入200，但是不能和201对比时，记住先要把str转化为整数，python提供了int()函数, 转化数据类型为int类型，但是如果输入’abc’则会得到1个ValueError的错误</li>\n<li>循环\n<ol>\n<li>for…in ： 依次把list或者tuple的每个元素迭代出来，for x in … ：循环就是把每个元素带入变量x，然后执行缩进的语句：</li>\n<li>range()函数：用来生成一个整数序列，再通过list()函数转换为list，例如range(5)生成：0,1,2,3,4\n<ol>\n<li>list(range(5)) = [0,1,2,3,4]</li>\n<li>计算1+...+100的结果： for x in range(101): sum = sum +x</li>\n</ol>\n</li>\n<li>while 循环： 只要条件满足，就不断循环，条件不足时退出循环：\n<ol>\n<li>计算100以内所有奇数之和： sum = 0,n = 99, while n &gt; 0: sum =sum +n; n = n-2</li>\n</ol>\n</li>\n<li>break: 在循环中，break语句可以提前退出循环，当程序执行满足break条件的时候，就会退出循环</li>\n<li>continue: 在循环过程中，也可以通过continue语句，跳过当前的这次循环。</li>\n<li>注意：循环是让计算机做重复任务的有效方法，break语句可以在循环过程总直接退出循环，continue语句可以提前结束本轮循环，并直接进入下一轮循环，这两个语句通常必须配合if语句使用，但是尽量不要滥用这两个语句，因为当break和continue使用过多会导致代码执行逻辑分支过多，容易出错。</li>\n</ol>\n</li>\n<li>dict和set\n<ol>\n<li>dict： python内置了字典：dict的支持，全称：dictionary，在其他语言中也称之为map，使用键值存储，具有极快的查找速度。</li>\n<li>对比list处理方式：会过滤整个list的元素，这导致list越长，耗时越长；dict实现时，只需要创建key-values对应表，直接根据名字查找，无论这个表有多大，查找速度都不会变慢，但是内存消耗会大，典型用性能(内存空间)换时间。</li>\n<li>dict的初始化: d {‘Michael’:95,’Bob’:75,’Tracy’:85}  # 注意dict使用的是大括号’{}‘</li>\n<li>dict的数据插入： d [‘Adam’] = 67 </li>\n<li>由于dict是根据key检索，所以key是固定的，一个key只能对应1个value,所以当对1个key多次放入value时，后面的值会把前面的值冲掉： （类似变量）</li>\n<li>但是如果查询的key不存在,dict会报错，KeyError，可以用in 判断key是否存在: ‘key’ in d  : True/False</li>\n<li>通过dict的get方法，如果key不存在，可以返回None，或者自己指定的值，d.get(‘Key’) , d.get(‘key’,-1)</li>\n<li>d.pop('key’): 删除1个key，注意当key被删除是，相应的value也会被删除。</li>\n<li>另外注意：dict内部存放的顺序和key放入的顺序是没有关系的：</li>\n<li>dict应在需要高速查找的地方，正确使用dict非常重要，要牢记1点，dict的key必须是不可变的对象，因为dict是根据key来计算value的位置，如果每次计算相同的key得到的结果不一样，那么dict内部就完全混乱了，这个通过key计算位置的算法称之为Hash算法。</li>\n<li>要保证hash的准确性，作为key的对象就不能改变，在python中，字符串·整数等都是不可变的，但是list是可以变的所以不能作为key</li>\n<li>set： set和dict类似，也是一组key的集合，但是不存储value，由于key不能重复，所以，在set中，没有重复的key值。</li>\n<li>要创建一个set，需要提供一个list作为输入集合。 s = set([1,2,3])   : s = {1,2,3}</li>\n<li>注意set也不是有序的，而且重复在set存在的元素会被自动过滤： s = set([1,2,3,1,2,3,1,2,3])  s = {1,2,3}</li>\n<li>通过s.add(key) 可以增加元素到set中，可以重复添加，但是不会有效果</li>\n<li>通过s.remove(key) 可以删除元素</li>\n<li>set 可以看成数学意义上的无序和无重复元素的集合，因此两个set可以做数学意义上的交集、并集能操作：\n<ol>\n<li>s1 = set([1,2,3]), s2 = set([2,3,4]) ,交集： s1 &amp; s2 = {2,3} ; s1 | s2 = {1,2,3,4}</li>\n</ol>\n</li>\n<li>set和dict的区别仅在于有没有存储对应的value，但是set和dict的原理是一样的，所以，同样不可以放置可变对象，因为无法判断两个对象是否相等，也就无法保证set内部的不会重复元素</li>\n<li>不可变对象：str是不变对象，list是可变对象；对于可变对象，例如list，对list进行操作，list的内部会发生变化</li>\n<li>a = ‘abc’ , a.replace(‘a’,’A’) # 这个操作是把所有小写的a替换成大写的A，但是注意a的值并没有发生改变，要牢记a是变量，’abc'才是字符对象。</li>\n</ol>\n</li>\n</ol>\n</body>\n</html>\n","slug":"python-lesson-1","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqbz005q41tpm0vm4m30","content":"<p>&lt;?xml version=”1.0” encoding=”UTF-8”?&gt;<br>&lt;!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Transitional//EN” “<a href=\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\" target=\"_blank\" rel=\"external\">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</a></p>\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"><meta name=\"exporter-version\" content=\"Evernote Mac 6.10 (454269)\"><meta name=\"author\" content=\"Alex LU\"><meta name=\"created\" content=\"2016-09-29 02:27:16 +0000\"><meta name=\"source\" content=\"desktop.mac\"><meta name=\"updated\" content=\"2016-09-29 06:27:40 +0000\"><title>Python学习笔记(1) –Python基础</title></head><body><br><ol><br><li>输出： print<br><ol><br><li>python2：print ‘Hello Python’</li><br><li>python3: print(‘Hello Python’)</li><br><li>python(‘10+20=‘,10+20)</li><br></ol><br></li><br><li>输入：<br><ol><br><li>python2：raw<em>input()</em></li><br><li>python3: input()</li><br></ol><br></li><br><li>python的语法比较简单，采用缩进的方式：</li><br></ol><br><div style=\"-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><br><div>a = 100</div><br><div>if a &gt;= 0:</div><br><div>     print(a)</div><br><div>else:</div><br><div>     print(-a)</div><br><div><br></div><br><div>&amp; diff &amp;</div><br><div>a = 100</div><br><div>if a &gt;=0:</div><br><div>print(a)</div><br><div>else:</div><br><div>print(-a)</div><br></div><br><ol start=\"4\"><br><li># 开头为注释；: 结尾，缩进的语句视为代码块；Python大小写是敏感的，约定俗成：4个空格的缩进，可以吧tab设置为4个空格。</li><br><li>Python 的数据类型<br><ol><br><li>整数：python可以处理任意大小的整数</li><br><li>浮点数：也就是小数，之所以称之为浮点数，因为按照科学计数法表示时，一个浮点数的小数点位置是可变的</li><br><li>字符串：字符串是以’’和”” 包括起来的任意文本，例如’abc’,”xyz”；如果字符内部同时包含’和”，可以使用\\转义字符来标识。<br><ol><br><li>如果字符串内部有很多换行，用\\n不好阅读，python支持使用’’’…’’’ 的格式表示多行‘</li><br><li>r’…’  python可以使用r’’表示’’以内的字符不转义;多行: r’’’…’’’</li><br></ol><br></li><br><li>布尔值：布尔值和布尔代数表示的完全一致，一个布尔值只有True和False，python支持直接使用True和False表示布尔值，注意大小写，另外最好不要生命变量时使用True等，布尔值，经常用于在条件判断之中。<br><ol><br><li>and : 与运算，所有运算结果都是True，and的结果才是True</li><br><li>or：或运算，只有1个运算结果为True，or的结果就是True</li><br><li>not：他是一个单目运算符，取相反的值</li><br></ol><br></li><br><li>空值：python里的一个特殊值，用None表示，注意None不能理解为0，因为0是有意义的，而None是一个特殊的空值</li><br></ol><br></li><br><li>python的变量<br><ol><br><li>命名规则：必须是大小写英文，数字和的组合，且不能用数字开头；</li><br><li>赋值符号：’=’；等于的符号是’==’</li><br><li>动态语言：变量本身类型不固定的语言称之为动态语言，反之是静态语言，静态语言在定义变量时必须制定变量的数据类型，如果赋值的时候类型不匹配，就会报错；</li><br><li>变量在计算机内存中的表示：a=1,指的是python在内存中创建了整数1，然后在内存创建了变量a，并把它指向了整数1</li><br></ol><br></li><br><li>python的常量<br><ol><br><li>定义：常量就是不能改变的变量，在python中，通常使用全部大写的变量名表示常量</li><br><li>整数的除法是精确的，因为除法计算结果是浮点数，例如 9/3 结果为3.0 ; 另外一种除法是’//‘ 地板除，两个整数的除法任然是整数；余数运算’%’</li><br></ol><br></li><br><li>字符编码：字符串是一种数据类型，但是字符串还涉及到一个编码问题，Python3的字符串是支持多语言的<br><ol><br><li>ord(‘’)函数 获取字符的整数表示；</li><br><li>chr(‘’)函数 把编码转换成对应的字符；</li><br><li>python的字符串类型是str，在内存中以Unicode表示，一个字符对应若干字节，但是如果要在网络传输或者保存到磁盘，就要把str转化为单位的bytes；<br><ol><br><li>python对于bytes的数据类型用带b前缀的单引号或双引号表示：</li><br><li>另外，Unicode表示的str可用encode()函数，指定编码为bytes。 ‘ABC’ .encode(‘utf-8’)</li><br><li>decode() 可以吧bytes转变为str。b’ABC’ .decode(‘ascii’)</li><br><li>要计算str包含了多少个字符使用 len()函数： len(‘hello’) ,结果为5</li><br></ol><br></li><br><li style=\"-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\">#!/usr/bin/env python3<br><br># -<em>- coding: utf-8 -</em>-</li><br></ol><br></li><br><li>格式化： 如何处理格式化输出字符串，在python中使用的格式化方式和C语言是一致的，用’%’实现：<br><ol><br><li>%d 表示整数</li><br><li>%f 表示浮点数</li><br><li>%s 表示字符串，如果不确定用什么，用%s，它会把任何数据类型转换为字符串</li><br><li>%x 表示十六进制整数</li><br><li>%% 表示一个普通的%</li><br></ol><br></li><br><li>数据类型list和tuple<br><ol><br><li>list是python内置的一种数据类型：列表，list是一个有序的集合，可以随时添加和删除其中元素。<br><ol><br><li>classmates = [‘Michael’,’Bob’,’Tracy’]， 可以用len()函数获取这个list的元素的个数</li><br><li>可以用索引来访问list中的每一个位置的元素，记住索引的第一个位置是0：</li><br><li>当索引超出范围的时候，python会报出IndexError错误，记得最后一个索引是len(classmates) -1</li><br><li>如果直接取出最后一个索引可用classmates[-1],以此类推</li><br></ol><br></li><br><li>list是一个可变的有序列表，所以可以去追加，插入指定位置，删除，替换等操作，支持不同数据类型，支持嵌套list<br><ol><br><li>追加: classmates.append(‘Adam’)</li><br><li>插入指定位置: classmates.insert(2,’Jack’)</li><br><li>删除list末尾的元素： classmates.pop()</li><br><li>删除指定位置的元素: classmates.pop(1)</li><br><li>替换元素：classmates[1]=‘Sarch’ ， 直接给相应位置的元素重新赋值即可</li><br><li>list的元素支持不同的数据类型, L = [‘abc’,23,23.4]</li><br><li>list的元素支持嵌套另外一个list： s = [‘abc’,123,[‘XYZ’,2.34]]，注意这个时候len(s)的元素是3个</li><br><li>list也可以没有元素，就是一个空的list，它的长度为0</li><br></ol><br></li><br><li>tuple：元组，也是一种有序列表，但是tuple一旦初始化就不能修改，他没有append()也没有insert()，这样的方法，其他获取元素的方式和list一样，也不能赋值成为另外的元素：<br><ol><br><li>classmates = (‘Michael’,’Bob’,’Tracy’) 注意list用的是’[]’，而tuple用的是’()’</li><br><li>tuple 有个问题，当你定义1个元素的时候，tuple的()和数学公式中的小括号混淆 ，因此python规定，这种情况下面，当定义只有1个tuple时必须增加一个逗号’,’来消除歧义。</li><br><li>tuple的元素也可以为list或者tuple，tuple的元素不会改变，但是list是一个可以改变的有序数列，所以当tuple中包含list时，这个tuple是’可变的’</li><br></ol><br></li><br><li>取出特定元素： L[[‘Apple’,’Google’,’Microsoft’],[‘Java’,’Python’,’C’]] ; L[1][1] = ‘Python’</li><br></ol><br></li><br><li>条件判断<br><ol><br><li>if：根据python的缩进规则，如果if语句的判断是True，就会执行下面的语句，否则什么都不做</li><br><li>else：也可以个if添加else，意思就是，如果if的判断是false，不要执行if的内容，执行else的内容</li><br><li>elif：如果要嵌套多级判断条件的话，使用elif，elif 是else if的缩写</li><br><li>if语句执行有个特点，它是自上而下的判断，如果某个判断的结果是True，那么执行该判断对应的语句，就会忽略掉剩下的所有elif和else，if判断条件还可以简写: if x: 只要x是非零数值、非空字符串、非空list等，就判断为True，</li><br></ol><br></li><br><li>iput(): 需要注意的地方，默认input的返回类型是str，由于str不能直接整数比较，所以在碰到明明输入200，但是不能和201对比时，记住先要把str转化为整数，python提供了int()函数, 转化数据类型为int类型，但是如果输入’abc’则会得到1个ValueError的错误</li><br><li>循环<br><ol><br><li>for…in ： 依次把list或者tuple的每个元素迭代出来，for x in … ：循环就是把每个元素带入变量x，然后执行缩进的语句：</li><br><li>range()函数：用来生成一个整数序列，再通过list()函数转换为list，例如range(5)生成：0,1,2,3,4<br><ol><br><li>list(range(5)) = [0,1,2,3,4]</li><br><li>计算1+…+100的结果： for x in range(101): sum = sum +x</li><br></ol><br></li><br><li>while 循环： 只要条件满足，就不断循环，条件不足时退出循环：<br><ol><br><li>计算100以内所有奇数之和： sum = 0,n = 99, while n &gt; 0: sum =sum +n; n = n-2</li><br></ol><br></li><br><li>break: 在循环中，break语句可以提前退出循环，当程序执行满足break条件的时候，就会退出循环</li><br><li>continue: 在循环过程中，也可以通过continue语句，跳过当前的这次循环。</li><br><li>注意：循环是让计算机做重复任务的有效方法，break语句可以在循环过程总直接退出循环，continue语句可以提前结束本轮循环，并直接进入下一轮循环，这两个语句通常必须配合if语句使用，但是尽量不要滥用这两个语句，因为当break和continue使用过多会导致代码执行逻辑分支过多，容易出错。</li><br></ol><br></li><br><li>dict和set<br><ol><br><li>dict： python内置了字典：dict的支持，全称：dictionary，在其他语言中也称之为map，使用键值存储，具有极快的查找速度。</li><br><li>对比list处理方式：会过滤整个list的元素，这导致list越长，耗时越长；dict实现时，只需要创建key-values对应表，直接根据名字查找，无论这个表有多大，查找速度都不会变慢，但是内存消耗会大，典型用性能(内存空间)换时间。</li><br><li>dict的初始化: d {‘Michael’:95,’Bob’:75,’Tracy’:85}  # 注意dict使用的是大括号’{}‘</li><br><li>dict的数据插入： d [‘Adam’] = 67 </li><br><li>由于dict是根据key检索，所以key是固定的，一个key只能对应1个value,所以当对1个key多次放入value时，后面的值会把前面的值冲掉： （类似变量）</li><br><li>但是如果查询的key不存在,dict会报错，KeyError，可以用in 判断key是否存在: ‘key’ in d  : True/False</li><br><li>通过dict的get方法，如果key不存在，可以返回None，或者自己指定的值，d.get(‘Key’) , d.get(‘key’,-1)</li><br><li>d.pop(‘key’): 删除1个key，注意当key被删除是，相应的value也会被删除。</li><br><li>另外注意：dict内部存放的顺序和key放入的顺序是没有关系的：</li><br><li>dict应在需要高速查找的地方，正确使用dict非常重要，要牢记1点，dict的key必须是不可变的对象，因为dict是根据key来计算value的位置，如果每次计算相同的key得到的结果不一样，那么dict内部就完全混乱了，这个通过key计算位置的算法称之为Hash算法。</li><br><li>要保证hash的准确性，作为key的对象就不能改变，在python中，字符串·整数等都是不可变的，但是list是可以变的所以不能作为key</li><br><li>set： set和dict类似，也是一组key的集合，但是不存储value，由于key不能重复，所以，在set中，没有重复的key值。</li><br><li>要创建一个set，需要提供一个list作为输入集合。 s = set([1,2,3])   : s = {1,2,3}</li><br><li>注意set也不是有序的，而且重复在set存在的元素会被自动过滤： s = set([1,2,3,1,2,3,1,2,3])  s = {1,2,3}</li><br><li>通过s.add(key) 可以增加元素到set中，可以重复添加，但是不会有效果</li><br><li>通过s.remove(key) 可以删除元素</li><br><li>set 可以看成数学意义上的无序和无重复元素的集合，因此两个set可以做数学意义上的交集、并集能操作：<br><ol><br><li>s1 = set([1,2,3]), s2 = set([2,3,4]) ,交集： s1 &amp; s2 = {2,3} ; s1 | s2 = {1,2,3,4}</li><br></ol><br></li><br><li>set和dict的区别仅在于有没有存储对应的value，但是set和dict的原理是一样的，所以，同样不可以放置可变对象，因为无法判断两个对象是否相等，也就无法保证set内部的不会重复元素</li><br><li>不可变对象：str是不变对象，list是可变对象；对于可变对象，例如list，对list进行操作，list的内部会发生变化</li><br><li>a = ‘abc’ , a.replace(‘a’,’A’) # 这个操作是把所有小写的a替换成大写的A，但是注意a的值并没有发生改变，要牢记a是变量，’abc’才是字符对象。</li><br></ol><br></li><br></ol><br></body><br></html>\n","site":{"data":{}},"excerpt":"","more":"<p>&lt;?xml version=”1.0” encoding=”UTF-8”?&gt;<br>&lt;!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Transitional//EN” “<a href=\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</a></p>\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/><meta name=\"exporter-version\" content=\"Evernote Mac 6.10 (454269)\"/><meta name=\"author\" content=\"Alex LU\"/><meta name=\"created\" content=\"2016-09-29 02:27:16 +0000\"/><meta name=\"source\" content=\"desktop.mac\"/><meta name=\"updated\" content=\"2016-09-29 06:27:40 +0000\"/><title>Python学习笔记(1) –Python基础</title></head><body><br><ol><br><li>输出： print<br><ol><br><li>python2：print ‘Hello Python’</li><br><li>python3: print(‘Hello Python’)</li><br><li>python(‘10+20=‘,10+20)</li><br></ol><br></li><br><li>输入：<br><ol><br><li>python2：raw<em>input()</li><br><li>python3: input()</li><br></ol><br></li><br><li>python的语法比较简单，采用缩进的方式：</li><br></ol><br><div style=\"-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><br><div>a = 100</div><br><div>if a &gt;= 0:</div><br><div>     print(a)</div><br><div>else:</div><br><div>     print(-a)</div><br><div><br/></div><br><div>&amp; diff &amp;</div><br><div>a = 100</div><br><div>if a &gt;=0:</div><br><div>print(a)</div><br><div>else:</div><br><div>print(-a)</div><br></div><br><ol start=\"4\"><br><li># 开头为注释；: 结尾，缩进的语句视为代码块；Python大小写是敏感的，约定俗成：4个空格的缩进，可以吧tab设置为4个空格。</li><br><li>Python 的数据类型<br><ol><br><li>整数：python可以处理任意大小的整数</li><br><li>浮点数：也就是小数，之所以称之为浮点数，因为按照科学计数法表示时，一个浮点数的小数点位置是可变的</li><br><li>字符串：字符串是以’’和”” 包括起来的任意文本，例如’abc’,”xyz”；如果字符内部同时包含’和”，可以使用\\转义字符来标识。<br><ol><br><li>如果字符串内部有很多换行，用\\n不好阅读，python支持使用’’’…’’’ 的格式表示多行‘</li><br><li>r’…’  python可以使用r’’表示’’以内的字符不转义;多行: r’’’…’’’</li><br></ol><br></li><br><li>布尔值：布尔值和布尔代数表示的完全一致，一个布尔值只有True和False，python支持直接使用True和False表示布尔值，注意大小写，另外最好不要生命变量时使用True等，布尔值，经常用于在条件判断之中。<br><ol><br><li>and : 与运算，所有运算结果都是True，and的结果才是True</li><br><li>or：或运算，只有1个运算结果为True，or的结果就是True</li><br><li>not：他是一个单目运算符，取相反的值</li><br></ol><br></li><br><li>空值：python里的一个特殊值，用None表示，注意None不能理解为0，因为0是有意义的，而None是一个特殊的空值</li><br></ol><br></li><br><li>python的变量<br><ol><br><li>命名规则：必须是大小写英文，数字和</em>的组合，且不能用数字开头；</li><br><li>赋值符号：’=’；等于的符号是’==’</li><br><li>动态语言：变量本身类型不固定的语言称之为动态语言，反之是静态语言，静态语言在定义变量时必须制定变量的数据类型，如果赋值的时候类型不匹配，就会报错；</li><br><li>变量在计算机内存中的表示：a=1,指的是python在内存中创建了整数1，然后在内存创建了变量a，并把它指向了整数1</li><br></ol><br></li><br><li>python的常量<br><ol><br><li>定义：常量就是不能改变的变量，在python中，通常使用全部大写的变量名表示常量</li><br><li>整数的除法是精确的，因为除法计算结果是浮点数，例如 9/3 结果为3.0 ; 另外一种除法是’//‘ 地板除，两个整数的除法任然是整数；余数运算’%’</li><br></ol><br></li><br><li>字符编码：字符串是一种数据类型，但是字符串还涉及到一个编码问题，Python3的字符串是支持多语言的<br><ol><br><li>ord(‘’)函数 获取字符的整数表示；</li><br><li>chr(‘’)函数 把编码转换成对应的字符；</li><br><li>python的字符串类型是str，在内存中以Unicode表示，一个字符对应若干字节，但是如果要在网络传输或者保存到磁盘，就要把str转化为单位的bytes；<br><ol><br><li>python对于bytes的数据类型用带b前缀的单引号或双引号表示：</li><br><li>另外，Unicode表示的str可用encode()函数，指定编码为bytes。 ‘ABC’ .encode(‘utf-8’)</li><br><li>decode() 可以吧bytes转变为str。b’ABC’ .decode(‘ascii’)</li><br><li>要计算str包含了多少个字符使用 len()函数： len(‘hello’) ,结果为5</li><br></ol><br></li><br><li style=\"-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\">#!/usr/bin/env python3<br/><br># -<em>- coding: utf-8 -</em>-</li><br></ol><br></li><br><li>格式化： 如何处理格式化输出字符串，在python中使用的格式化方式和C语言是一致的，用’%’实现：<br><ol><br><li>%d 表示整数</li><br><li>%f 表示浮点数</li><br><li>%s 表示字符串，如果不确定用什么，用%s，它会把任何数据类型转换为字符串</li><br><li>%x 表示十六进制整数</li><br><li>%% 表示一个普通的%</li><br></ol><br></li><br><li>数据类型list和tuple<br><ol><br><li>list是python内置的一种数据类型：列表，list是一个有序的集合，可以随时添加和删除其中元素。<br><ol><br><li>classmates = [‘Michael’,’Bob’,’Tracy’]， 可以用len()函数获取这个list的元素的个数</li><br><li>可以用索引来访问list中的每一个位置的元素，记住索引的第一个位置是0：</li><br><li>当索引超出范围的时候，python会报出IndexError错误，记得最后一个索引是len(classmates) -1</li><br><li>如果直接取出最后一个索引可用classmates[-1],以此类推</li><br></ol><br></li><br><li>list是一个可变的有序列表，所以可以去追加，插入指定位置，删除，替换等操作，支持不同数据类型，支持嵌套list<br><ol><br><li>追加: classmates.append(‘Adam’)</li><br><li>插入指定位置: classmates.insert(2,’Jack’)</li><br><li>删除list末尾的元素： classmates.pop()</li><br><li>删除指定位置的元素: classmates.pop(1)</li><br><li>替换元素：classmates[1]=‘Sarch’ ， 直接给相应位置的元素重新赋值即可</li><br><li>list的元素支持不同的数据类型, L = [‘abc’,23,23.4]</li><br><li>list的元素支持嵌套另外一个list： s = [‘abc’,123,[‘XYZ’,2.34]]，注意这个时候len(s)的元素是3个</li><br><li>list也可以没有元素，就是一个空的list，它的长度为0</li><br></ol><br></li><br><li>tuple：元组，也是一种有序列表，但是tuple一旦初始化就不能修改，他没有append()也没有insert()，这样的方法，其他获取元素的方式和list一样，也不能赋值成为另外的元素：<br><ol><br><li>classmates = (‘Michael’,’Bob’,’Tracy’) 注意list用的是’[]’，而tuple用的是’()’</li><br><li>tuple 有个问题，当你定义1个元素的时候，tuple的()和数学公式中的小括号混淆 ，因此python规定，这种情况下面，当定义只有1个tuple时必须增加一个逗号’,’来消除歧义。</li><br><li>tuple的元素也可以为list或者tuple，tuple的元素不会改变，但是list是一个可以改变的有序数列，所以当tuple中包含list时，这个tuple是’可变的’</li><br></ol><br></li><br><li>取出特定元素： L[[‘Apple’,’Google’,’Microsoft’],[‘Java’,’Python’,’C’]] ; L[1][1] = ‘Python’</li><br></ol><br></li><br><li>条件判断<br><ol><br><li>if：根据python的缩进规则，如果if语句的判断是True，就会执行下面的语句，否则什么都不做</li><br><li>else：也可以个if添加else，意思就是，如果if的判断是false，不要执行if的内容，执行else的内容</li><br><li>elif：如果要嵌套多级判断条件的话，使用elif，elif 是else if的缩写</li><br><li>if语句执行有个特点，它是自上而下的判断，如果某个判断的结果是True，那么执行该判断对应的语句，就会忽略掉剩下的所有elif和else，if判断条件还可以简写: if x: 只要x是非零数值、非空字符串、非空list等，就判断为True，</li><br></ol><br></li><br><li>iput(): 需要注意的地方，默认input的返回类型是str，由于str不能直接整数比较，所以在碰到明明输入200，但是不能和201对比时，记住先要把str转化为整数，python提供了int()函数, 转化数据类型为int类型，但是如果输入’abc’则会得到1个ValueError的错误</li><br><li>循环<br><ol><br><li>for…in ： 依次把list或者tuple的每个元素迭代出来，for x in … ：循环就是把每个元素带入变量x，然后执行缩进的语句：</li><br><li>range()函数：用来生成一个整数序列，再通过list()函数转换为list，例如range(5)生成：0,1,2,3,4<br><ol><br><li>list(range(5)) = [0,1,2,3,4]</li><br><li>计算1+…+100的结果： for x in range(101): sum = sum +x</li><br></ol><br></li><br><li>while 循环： 只要条件满足，就不断循环，条件不足时退出循环：<br><ol><br><li>计算100以内所有奇数之和： sum = 0,n = 99, while n &gt; 0: sum =sum +n; n = n-2</li><br></ol><br></li><br><li>break: 在循环中，break语句可以提前退出循环，当程序执行满足break条件的时候，就会退出循环</li><br><li>continue: 在循环过程中，也可以通过continue语句，跳过当前的这次循环。</li><br><li>注意：循环是让计算机做重复任务的有效方法，break语句可以在循环过程总直接退出循环，continue语句可以提前结束本轮循环，并直接进入下一轮循环，这两个语句通常必须配合if语句使用，但是尽量不要滥用这两个语句，因为当break和continue使用过多会导致代码执行逻辑分支过多，容易出错。</li><br></ol><br></li><br><li>dict和set<br><ol><br><li>dict： python内置了字典：dict的支持，全称：dictionary，在其他语言中也称之为map，使用键值存储，具有极快的查找速度。</li><br><li>对比list处理方式：会过滤整个list的元素，这导致list越长，耗时越长；dict实现时，只需要创建key-values对应表，直接根据名字查找，无论这个表有多大，查找速度都不会变慢，但是内存消耗会大，典型用性能(内存空间)换时间。</li><br><li>dict的初始化: d {‘Michael’:95,’Bob’:75,’Tracy’:85}  # 注意dict使用的是大括号’{}‘</li><br><li>dict的数据插入： d [‘Adam’] = 67 </li><br><li>由于dict是根据key检索，所以key是固定的，一个key只能对应1个value,所以当对1个key多次放入value时，后面的值会把前面的值冲掉： （类似变量）</li><br><li>但是如果查询的key不存在,dict会报错，KeyError，可以用in 判断key是否存在: ‘key’ in d  : True/False</li><br><li>通过dict的get方法，如果key不存在，可以返回None，或者自己指定的值，d.get(‘Key’) , d.get(‘key’,-1)</li><br><li>d.pop(‘key’): 删除1个key，注意当key被删除是，相应的value也会被删除。</li><br><li>另外注意：dict内部存放的顺序和key放入的顺序是没有关系的：</li><br><li>dict应在需要高速查找的地方，正确使用dict非常重要，要牢记1点，dict的key必须是不可变的对象，因为dict是根据key来计算value的位置，如果每次计算相同的key得到的结果不一样，那么dict内部就完全混乱了，这个通过key计算位置的算法称之为Hash算法。</li><br><li>要保证hash的准确性，作为key的对象就不能改变，在python中，字符串·整数等都是不可变的，但是list是可以变的所以不能作为key</li><br><li>set： set和dict类似，也是一组key的集合，但是不存储value，由于key不能重复，所以，在set中，没有重复的key值。</li><br><li>要创建一个set，需要提供一个list作为输入集合。 s = set([1,2,3])   : s = {1,2,3}</li><br><li>注意set也不是有序的，而且重复在set存在的元素会被自动过滤： s = set([1,2,3,1,2,3,1,2,3])  s = {1,2,3}</li><br><li>通过s.add(key) 可以增加元素到set中，可以重复添加，但是不会有效果</li><br><li>通过s.remove(key) 可以删除元素</li><br><li>set 可以看成数学意义上的无序和无重复元素的集合，因此两个set可以做数学意义上的交集、并集能操作：<br><ol><br><li>s1 = set([1,2,3]), s2 = set([2,3,4]) ,交集： s1 &amp; s2 = {2,3} ; s1 | s2 = {1,2,3,4}</li><br></ol><br></li><br><li>set和dict的区别仅在于有没有存储对应的value，但是set和dict的原理是一样的，所以，同样不可以放置可变对象，因为无法判断两个对象是否相等，也就无法保证set内部的不会重复元素</li><br><li>不可变对象：str是不变对象，list是可变对象；对于可变对象，例如list，对list进行操作，list的内部会发生变化</li><br><li>a = ‘abc’ , a.replace(‘a’,’A’) # 这个操作是把所有小写的a替换成大写的A，但是注意a的值并没有发生改变，要牢记a是变量，’abc’才是字符对象。</li><br></ol><br></li><br></ol><br></body><br></html>\n"},{"title":"SSH LINUX Security Settings","id":"102","updated":"2017-04-21T05:21:32.000Z","date":"2016-10-28T22:23:59.000Z","_content":"\n\n### **SSH 配置安全控制限制登录**\n##### 1. 只允许某个IP登录，拒绝其他所有IP\n在 /etc/hosts.allow 增加:\n```\nsshd: 1.2.3.4\n```\n在 /etc/hosts.deny 增肌:\n```\nsshd: ALL\n```\n用 iptables 也行:\n```\niptables -A INPUT -p tcp --dport 22 -j DROP\niptables -A INPUT -p tcp --dport 22 -s 1.2.3.4 -j ACCEPT\n```\n##### 2. 禁止某个用户通过ssh登录\n在/etc/ssh/sshd_conf添加\n```\nAllowUsers 用户名\n或者\nAllowGroups 组名\n或者\nDenyUsers 用户名\n```\n##### 3. 设定登录黑名单\n```\n[root@6 ~]# vim /etc/pam.d/sshd\nauth required /lib/security/pam_listfile.so item=user sense=deny file=/etc/sshd_user_deny_list onerr=succeed\n# 所有/etc/sshd_user_deny_list里面的用户被拒绝ssh登录\n```\n##### 4. sshd_config配置\n```\n# 关于 SSH Server 的整体设定，包含使用的 port 啦，以及使用的密码演算方式\nPort 22　　　　　　　　　　# SSH 预设使用 22 这个 port，您也可以使用多的 port ！\n　　　　　　　　　　　　　 # 亦即重复使用 port 这个设定项目即可！\nProtocol 2,1　　　　　　　 # 选择的 SSH 协议版本，可以是 1 也可以是 2 ，\n　　　　　　　　　　　　　 # 如果要同时支持两者，就必须要使用 2,1 这个分隔了！\n#ListenAddress 0.0.0.0　　 # 监听的主机适配卡！举个例子来说，如果您有两个 IP，\n　　　　　　　　　　　　　 # 分别是 192.168.0.100 及 192.168.2.20 ，那么只想要\n　　　　　　　　　　　　　 # 开放 192.168.0.100 时，就可以写如同下面的样式：\nListenAddress 192.168.0.100          # 只监听来自 192.168.0.100 这个 IP 的SSH联机。\n　　　　　　　　　　　　　　　　　　 # 如果不使用设定的话，则预设所有接口均接受 SSH\nPidFile /var/run/sshd.pid　　　　　　# 可以放置 SSHD 这个 PID 的档案！左列为默认值\nLoginGraceTime 600　　　　 # 当使用者连上 SSH server 之后，会出现输入密码的画面，\n　　　　　　　　　　　　　 # 在该画面中，在多久时间内没有成功连上 SSH server ，\n　　　　　　　　　　　　　 # 就断线！时间为秒！\nCompression yes　　　　　　# 是否可以使用压缩指令？当然可以啰！\n\n# 说明主机的 Private Key 放置的档案，预设使用下面的档案即可！\nHostKey /etc/ssh/ssh_host_key　　　　# SSH version 1 使用的私钥\nHostKey /etc/ssh/ssh_host_rsa_key　　# SSH version 2 使用的 RSA 私钥\nHostKey /etc/ssh/ssh_host_dsa_key　　# SSH version 2 使用的 DSA 私钥\n# 关于 version 1 的一些设定！\nKeyRegenerationInterval 3600　 　　　# 由前面联机的说明可以知道， version 1 会使用\n　　　　　　　　　　　　　　　　　　 # server 的 Public Key ，那么如果这个 Public\n　　　　　　　　　　　　　　　　　　 # Key 被偷的话，岂不完蛋？所以需要每隔一段时间\n　　　　　　　　　　　　　　　　　　 # 来重新建立一次！这里的时间为秒！\nServerKeyBits 768 　　　　　　　　　 # 没错！这个就是 Server key 的长度！\n\n# 关于登录文件的讯息数据放置与 daemon 的名称！\nSyslogFacility AUTH　　　　　　　　　# 当有人使用 SSH 登入系统的时候，SSH会记录资\n　　　　　　　　　　　　　　　　　　 # 讯，这个信息要记录在什么 daemon name 底下？\n　　　　　　　　　　　　　　　　　　 # 预设是以 AUTH 来设定的，即是 /var/log/secure\n　　　　　　　　　　　　　　　　　　 # 里面！什么？忘记了！回到 Linux 基础去翻一下\n　　　　　　　　　　　　　　　　　　 # 其它可用的 daemon name 为：DAEMON,USER,AUTH,\n　　　　　　　　　　　　　　　　　　 # LOCAL0,LOCAL1,LOCAL2,LOCAL3,LOCAL4,LOCAL5,\nLogLevel INFO　　　　　　　　　　　　# 登录记录的等级！嘿嘿！任何讯息！\n　　　　　　　　　　　　　　　　　　 # 同样的，忘记了就回去参考！\n\n# 登入设定部分\nPermitRootLogin no　　 　　# 是否允许 root 登入！预设是允许的，但是建议设定成 no！\nUserLogin no　　　　　　　 # 在 SSH 底下本来就不接受 login 这个程序的登入！\nStrictModes yes　　　　　　# 当使用者的 host key 改变之后，Server 就不接受联机，\n　　　　　　　　　　　　　 # 可以抵挡部分的木马程序！\n#RSAAuthentication yes　　 # 是否使用纯的 RSA 认证！？仅针对 version 1 ！\nPubkeyAuthentication yes　 # 是否允许 Public Key ？当然允许啦！只有 version 2\nAuthorizedKeysFile      .ssh/authorized_keys\n　　　　　　　　　　　　　 # 上面这个在设定若要使用不需要密码登入的账号时，那么那个\n　　　　　　　　　　　　　 # 账号的存放档案所在档名！\nAllowusers root@222.XX.XX.XX. #设置允许root帐号只能以222.XX.XX.XX这个IP进行ssh连接\n\n# 认证部分\nRhostsAuthentication no　　# 本机系统不止使用 .rhosts ，因为仅使用 .rhosts 太\n　　　　　　　　　　　　　 # 不安全了，所以这里一定要设定为 no ！\nIgnoreRhosts yes　　　　　 # 是否取消使用 ~/.ssh/.rhosts 来做为认证！当然是！\nRhostsRSAAuthentication no # 这个选项是专门给 version 1 用的，使用 rhosts 档案在\n　　　　　　　　　　　　　 # /etc/hosts.equiv配合 RSA 演算方式来进行认证！不要使用\nHostbasedAuthentication no # 这个项目与上面的项目类似，不过是给 version 2 使用的！\nIgnoreUserKnownHosts no　　# 是否忽略家目录内的 ~/.ssh/known_hosts 这个档案所记录\n　　　　　　　　　　　　　 # 的主机内容？当然不要忽略，所以这里就是 no 啦！\nPasswordAuthentication yes # 密码验证当然是需要的！所以这里写 yes 啰！\nPermitEmptyPasswords no　　# 若上面那一项如果设定为 yes 的话，这一项就最好设定\n　　　　　　　　　　　　　 # 为 no ，这个项目在是否允许以空的密码登入！当然不许！\nChallengeResponseAuthentication yes  # 挑战任何的密码认证！所以，任何 login.conf\n　　　　　　　　　　　　　　　　　　 # 规定的认证方式，均可适用！\n#PAMAuthenticationViaKbdInt yes      # 是否启用其它的 PAM 模块！启用这个模块将会\n　　　　　　　　　　　　　　　　　　 # 导致 PasswordAuthentication 设定失效！\n\n# 与 Kerberos 有关的参数设定！因为我们没有 Kerberos 主机，所以底下不用设定！\n#KerberosAuthentication no\n#KerberosOrLocalPasswd yes\n#KerberosTicketCleanup yes\n#KerberosTgtPassing no\n　\n# 底下是有关在 X-Window 底下使用的相关设定！\nX11Forwarding yes\n#X11DisplayOffset 10\n#X11UseLocalhost yes\n# 登入后的项目：\nPrintMotd no              # 登入后是否显示出一些信息呢？例如上次登入的时间、地点等\n　　　　　　　　　　　　　# 等，预设是 yes ，但是，如果为了安全，可以考虑改为 no ！\nPrintLastLog yes　　　　　# 显示上次登入的信息！可以啊！预设也是 yes ！\nKeepAlive yes　　　　　　 # 一般而言，如果设定这项目的话，那么 SSH Server 会传送\n　　　　　　　　　　　　　# KeepAlive 的讯息给 Client 端，以确保两者的联机正常！\n　　　　　　　　　　　　　# 在这个情况下，任何一端死掉后， SSH 可以立刻知道！而不会\n　　　　　　　　　　　　　# 有僵尸程序的发生！\nUsePrivilegeSeparation yes # 使用者的权限设定项目！就设定为 yes 吧！\nMaxStartups 10　　　　　　# 同时允许几个尚未登入的联机画面？当我们连上 SSH ，\n　　　　　　　　　　　　　# 但是尚未输入密码时，这个时候就是我们所谓的联机画面啦！\n　　　　　　　　　　　　　# 在这个联机画面中，为了保护主机，所以需要设定最大值，\n　　　　　　　　　　　　　# 预设最多十个联机画面，而已经建立联机的不计算在这十个当中\n\n# 关于使用者抵挡的设定项目：\nDenyUsers *　　　　　　　 # 设定受抵挡的使用者名称，如果是全部的使用者，那就是全部\n　　　　　　　　　　　　　# 挡吧！若是部分使用者，可以将该账号填入！例如下列！\nDenyUsers test\nDenyGroups test　　　　　 # 与 DenyUsers 相同！仅抵挡几个群组而已！\n\n# 关于 SFTP 服务的设定项目！\nSubsystem       sftp    /usr/lib/ssh/sftp-server\n如果不愿意开放 SFTP 的话，将这一行批注掉即可！\n```\n","source":"_posts/SSH-LINUX-Security-Settings.md","raw":"---\ntitle: SSH LINUX Security Settings\ntags: 'SSH'\ncategories: 'Linux'\npermalink: ssh-config-security\nid: 102\nupdated: '2017-04-21 13:21:32'\ndate: 2016-10-29 06:23:59\n---\n\n\n### **SSH 配置安全控制限制登录**\n##### 1. 只允许某个IP登录，拒绝其他所有IP\n在 /etc/hosts.allow 增加:\n```\nsshd: 1.2.3.4\n```\n在 /etc/hosts.deny 增肌:\n```\nsshd: ALL\n```\n用 iptables 也行:\n```\niptables -A INPUT -p tcp --dport 22 -j DROP\niptables -A INPUT -p tcp --dport 22 -s 1.2.3.4 -j ACCEPT\n```\n##### 2. 禁止某个用户通过ssh登录\n在/etc/ssh/sshd_conf添加\n```\nAllowUsers 用户名\n或者\nAllowGroups 组名\n或者\nDenyUsers 用户名\n```\n##### 3. 设定登录黑名单\n```\n[root@6 ~]# vim /etc/pam.d/sshd\nauth required /lib/security/pam_listfile.so item=user sense=deny file=/etc/sshd_user_deny_list onerr=succeed\n# 所有/etc/sshd_user_deny_list里面的用户被拒绝ssh登录\n```\n##### 4. sshd_config配置\n```\n# 关于 SSH Server 的整体设定，包含使用的 port 啦，以及使用的密码演算方式\nPort 22　　　　　　　　　　# SSH 预设使用 22 这个 port，您也可以使用多的 port ！\n　　　　　　　　　　　　　 # 亦即重复使用 port 这个设定项目即可！\nProtocol 2,1　　　　　　　 # 选择的 SSH 协议版本，可以是 1 也可以是 2 ，\n　　　　　　　　　　　　　 # 如果要同时支持两者，就必须要使用 2,1 这个分隔了！\n#ListenAddress 0.0.0.0　　 # 监听的主机适配卡！举个例子来说，如果您有两个 IP，\n　　　　　　　　　　　　　 # 分别是 192.168.0.100 及 192.168.2.20 ，那么只想要\n　　　　　　　　　　　　　 # 开放 192.168.0.100 时，就可以写如同下面的样式：\nListenAddress 192.168.0.100          # 只监听来自 192.168.0.100 这个 IP 的SSH联机。\n　　　　　　　　　　　　　　　　　　 # 如果不使用设定的话，则预设所有接口均接受 SSH\nPidFile /var/run/sshd.pid　　　　　　# 可以放置 SSHD 这个 PID 的档案！左列为默认值\nLoginGraceTime 600　　　　 # 当使用者连上 SSH server 之后，会出现输入密码的画面，\n　　　　　　　　　　　　　 # 在该画面中，在多久时间内没有成功连上 SSH server ，\n　　　　　　　　　　　　　 # 就断线！时间为秒！\nCompression yes　　　　　　# 是否可以使用压缩指令？当然可以啰！\n\n# 说明主机的 Private Key 放置的档案，预设使用下面的档案即可！\nHostKey /etc/ssh/ssh_host_key　　　　# SSH version 1 使用的私钥\nHostKey /etc/ssh/ssh_host_rsa_key　　# SSH version 2 使用的 RSA 私钥\nHostKey /etc/ssh/ssh_host_dsa_key　　# SSH version 2 使用的 DSA 私钥\n# 关于 version 1 的一些设定！\nKeyRegenerationInterval 3600　 　　　# 由前面联机的说明可以知道， version 1 会使用\n　　　　　　　　　　　　　　　　　　 # server 的 Public Key ，那么如果这个 Public\n　　　　　　　　　　　　　　　　　　 # Key 被偷的话，岂不完蛋？所以需要每隔一段时间\n　　　　　　　　　　　　　　　　　　 # 来重新建立一次！这里的时间为秒！\nServerKeyBits 768 　　　　　　　　　 # 没错！这个就是 Server key 的长度！\n\n# 关于登录文件的讯息数据放置与 daemon 的名称！\nSyslogFacility AUTH　　　　　　　　　# 当有人使用 SSH 登入系统的时候，SSH会记录资\n　　　　　　　　　　　　　　　　　　 # 讯，这个信息要记录在什么 daemon name 底下？\n　　　　　　　　　　　　　　　　　　 # 预设是以 AUTH 来设定的，即是 /var/log/secure\n　　　　　　　　　　　　　　　　　　 # 里面！什么？忘记了！回到 Linux 基础去翻一下\n　　　　　　　　　　　　　　　　　　 # 其它可用的 daemon name 为：DAEMON,USER,AUTH,\n　　　　　　　　　　　　　　　　　　 # LOCAL0,LOCAL1,LOCAL2,LOCAL3,LOCAL4,LOCAL5,\nLogLevel INFO　　　　　　　　　　　　# 登录记录的等级！嘿嘿！任何讯息！\n　　　　　　　　　　　　　　　　　　 # 同样的，忘记了就回去参考！\n\n# 登入设定部分\nPermitRootLogin no　　 　　# 是否允许 root 登入！预设是允许的，但是建议设定成 no！\nUserLogin no　　　　　　　 # 在 SSH 底下本来就不接受 login 这个程序的登入！\nStrictModes yes　　　　　　# 当使用者的 host key 改变之后，Server 就不接受联机，\n　　　　　　　　　　　　　 # 可以抵挡部分的木马程序！\n#RSAAuthentication yes　　 # 是否使用纯的 RSA 认证！？仅针对 version 1 ！\nPubkeyAuthentication yes　 # 是否允许 Public Key ？当然允许啦！只有 version 2\nAuthorizedKeysFile      .ssh/authorized_keys\n　　　　　　　　　　　　　 # 上面这个在设定若要使用不需要密码登入的账号时，那么那个\n　　　　　　　　　　　　　 # 账号的存放档案所在档名！\nAllowusers root@222.XX.XX.XX. #设置允许root帐号只能以222.XX.XX.XX这个IP进行ssh连接\n\n# 认证部分\nRhostsAuthentication no　　# 本机系统不止使用 .rhosts ，因为仅使用 .rhosts 太\n　　　　　　　　　　　　　 # 不安全了，所以这里一定要设定为 no ！\nIgnoreRhosts yes　　　　　 # 是否取消使用 ~/.ssh/.rhosts 来做为认证！当然是！\nRhostsRSAAuthentication no # 这个选项是专门给 version 1 用的，使用 rhosts 档案在\n　　　　　　　　　　　　　 # /etc/hosts.equiv配合 RSA 演算方式来进行认证！不要使用\nHostbasedAuthentication no # 这个项目与上面的项目类似，不过是给 version 2 使用的！\nIgnoreUserKnownHosts no　　# 是否忽略家目录内的 ~/.ssh/known_hosts 这个档案所记录\n　　　　　　　　　　　　　 # 的主机内容？当然不要忽略，所以这里就是 no 啦！\nPasswordAuthentication yes # 密码验证当然是需要的！所以这里写 yes 啰！\nPermitEmptyPasswords no　　# 若上面那一项如果设定为 yes 的话，这一项就最好设定\n　　　　　　　　　　　　　 # 为 no ，这个项目在是否允许以空的密码登入！当然不许！\nChallengeResponseAuthentication yes  # 挑战任何的密码认证！所以，任何 login.conf\n　　　　　　　　　　　　　　　　　　 # 规定的认证方式，均可适用！\n#PAMAuthenticationViaKbdInt yes      # 是否启用其它的 PAM 模块！启用这个模块将会\n　　　　　　　　　　　　　　　　　　 # 导致 PasswordAuthentication 设定失效！\n\n# 与 Kerberos 有关的参数设定！因为我们没有 Kerberos 主机，所以底下不用设定！\n#KerberosAuthentication no\n#KerberosOrLocalPasswd yes\n#KerberosTicketCleanup yes\n#KerberosTgtPassing no\n　\n# 底下是有关在 X-Window 底下使用的相关设定！\nX11Forwarding yes\n#X11DisplayOffset 10\n#X11UseLocalhost yes\n# 登入后的项目：\nPrintMotd no              # 登入后是否显示出一些信息呢？例如上次登入的时间、地点等\n　　　　　　　　　　　　　# 等，预设是 yes ，但是，如果为了安全，可以考虑改为 no ！\nPrintLastLog yes　　　　　# 显示上次登入的信息！可以啊！预设也是 yes ！\nKeepAlive yes　　　　　　 # 一般而言，如果设定这项目的话，那么 SSH Server 会传送\n　　　　　　　　　　　　　# KeepAlive 的讯息给 Client 端，以确保两者的联机正常！\n　　　　　　　　　　　　　# 在这个情况下，任何一端死掉后， SSH 可以立刻知道！而不会\n　　　　　　　　　　　　　# 有僵尸程序的发生！\nUsePrivilegeSeparation yes # 使用者的权限设定项目！就设定为 yes 吧！\nMaxStartups 10　　　　　　# 同时允许几个尚未登入的联机画面？当我们连上 SSH ，\n　　　　　　　　　　　　　# 但是尚未输入密码时，这个时候就是我们所谓的联机画面啦！\n　　　　　　　　　　　　　# 在这个联机画面中，为了保护主机，所以需要设定最大值，\n　　　　　　　　　　　　　# 预设最多十个联机画面，而已经建立联机的不计算在这十个当中\n\n# 关于使用者抵挡的设定项目：\nDenyUsers *　　　　　　　 # 设定受抵挡的使用者名称，如果是全部的使用者，那就是全部\n　　　　　　　　　　　　　# 挡吧！若是部分使用者，可以将该账号填入！例如下列！\nDenyUsers test\nDenyGroups test　　　　　 # 与 DenyUsers 相同！仅抵挡几个群组而已！\n\n# 关于 SFTP 服务的设定项目！\nSubsystem       sftp    /usr/lib/ssh/sftp-server\n如果不愿意开放 SFTP 的话，将这一行批注掉即可！\n```\n","slug":"ssh-config-security","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqc1005t41tpvfibafgw","content":"<h3 id=\"SSH-配置安全控制限制登录\"><a href=\"#SSH-配置安全控制限制登录\" class=\"headerlink\" title=\"SSH 配置安全控制限制登录\"></a><strong>SSH 配置安全控制限制登录</strong></h3><h5 id=\"1-只允许某个IP登录，拒绝其他所有IP\"><a href=\"#1-只允许某个IP登录，拒绝其他所有IP\" class=\"headerlink\" title=\"1. 只允许某个IP登录，拒绝其他所有IP\"></a>1. 只允许某个IP登录，拒绝其他所有IP</h5><p>在 /etc/hosts.allow 增加:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sshd: 1.2.3.4</div></pre></td></tr></table></figure></p>\n<p>在 /etc/hosts.deny 增肌:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sshd: ALL</div></pre></td></tr></table></figure></p>\n<p>用 iptables 也行:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">iptables -A INPUT -p tcp --dport 22 -j DROP</div><div class=\"line\">iptables -A INPUT -p tcp --dport 22 -s 1.2.3.4 -j ACCEPT</div></pre></td></tr></table></figure></p>\n<h5 id=\"2-禁止某个用户通过ssh登录\"><a href=\"#2-禁止某个用户通过ssh登录\" class=\"headerlink\" title=\"2. 禁止某个用户通过ssh登录\"></a>2. 禁止某个用户通过ssh登录</h5><p>在/etc/ssh/sshd_conf添加<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">AllowUsers 用户名</div><div class=\"line\">或者</div><div class=\"line\">AllowGroups 组名</div><div class=\"line\">或者</div><div class=\"line\">DenyUsers 用户名</div></pre></td></tr></table></figure></p>\n<h5 id=\"3-设定登录黑名单\"><a href=\"#3-设定登录黑名单\" class=\"headerlink\" title=\"3. 设定登录黑名单\"></a>3. 设定登录黑名单</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# vim /etc/pam.d/sshd</div><div class=\"line\">auth required /lib/security/pam_listfile.so item=user sense=deny file=/etc/sshd_user_deny_list onerr=succeed</div><div class=\"line\"># 所有/etc/sshd_user_deny_list里面的用户被拒绝ssh登录</div></pre></td></tr></table></figure>\n<h5 id=\"4-sshd-config配置\"><a href=\"#4-sshd-config配置\" class=\"headerlink\" title=\"4. sshd_config配置\"></a>4. sshd_config配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 关于 SSH Server 的整体设定，包含使用的 port 啦，以及使用的密码演算方式</div><div class=\"line\">Port 22　　　　　　　　　　# SSH 预设使用 22 这个 port，您也可以使用多的 port ！</div><div class=\"line\">　　　　　　　　　　　　　 # 亦即重复使用 port 这个设定项目即可！</div><div class=\"line\">Protocol 2,1　　　　　　　 # 选择的 SSH 协议版本，可以是 1 也可以是 2 ，</div><div class=\"line\">　　　　　　　　　　　　　 # 如果要同时支持两者，就必须要使用 2,1 这个分隔了！</div><div class=\"line\">#ListenAddress 0.0.0.0　　 # 监听的主机适配卡！举个例子来说，如果您有两个 IP，</div><div class=\"line\">　　　　　　　　　　　　　 # 分别是 192.168.0.100 及 192.168.2.20 ，那么只想要</div><div class=\"line\">　　　　　　　　　　　　　 # 开放 192.168.0.100 时，就可以写如同下面的样式：</div><div class=\"line\">ListenAddress 192.168.0.100          # 只监听来自 192.168.0.100 这个 IP 的SSH联机。</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 如果不使用设定的话，则预设所有接口均接受 SSH</div><div class=\"line\">PidFile /var/run/sshd.pid　　　　　　# 可以放置 SSHD 这个 PID 的档案！左列为默认值</div><div class=\"line\">LoginGraceTime 600　　　　 # 当使用者连上 SSH server 之后，会出现输入密码的画面，</div><div class=\"line\">　　　　　　　　　　　　　 # 在该画面中，在多久时间内没有成功连上 SSH server ，</div><div class=\"line\">　　　　　　　　　　　　　 # 就断线！时间为秒！</div><div class=\"line\">Compression yes　　　　　　# 是否可以使用压缩指令？当然可以啰！</div><div class=\"line\"></div><div class=\"line\"># 说明主机的 Private Key 放置的档案，预设使用下面的档案即可！</div><div class=\"line\">HostKey /etc/ssh/ssh_host_key　　　　# SSH version 1 使用的私钥</div><div class=\"line\">HostKey /etc/ssh/ssh_host_rsa_key　　# SSH version 2 使用的 RSA 私钥</div><div class=\"line\">HostKey /etc/ssh/ssh_host_dsa_key　　# SSH version 2 使用的 DSA 私钥</div><div class=\"line\"># 关于 version 1 的一些设定！</div><div class=\"line\">KeyRegenerationInterval 3600　 　　　# 由前面联机的说明可以知道， version 1 会使用</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # server 的 Public Key ，那么如果这个 Public</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # Key 被偷的话，岂不完蛋？所以需要每隔一段时间</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 来重新建立一次！这里的时间为秒！</div><div class=\"line\">ServerKeyBits 768 　　　　　　　　　 # 没错！这个就是 Server key 的长度！</div><div class=\"line\"></div><div class=\"line\"># 关于登录文件的讯息数据放置与 daemon 的名称！</div><div class=\"line\">SyslogFacility AUTH　　　　　　　　　# 当有人使用 SSH 登入系统的时候，SSH会记录资</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 讯，这个信息要记录在什么 daemon name 底下？</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 预设是以 AUTH 来设定的，即是 /var/log/secure</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 里面！什么？忘记了！回到 Linux 基础去翻一下</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 其它可用的 daemon name 为：DAEMON,USER,AUTH,</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # LOCAL0,LOCAL1,LOCAL2,LOCAL3,LOCAL4,LOCAL5,</div><div class=\"line\">LogLevel INFO　　　　　　　　　　　　# 登录记录的等级！嘿嘿！任何讯息！</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 同样的，忘记了就回去参考！</div><div class=\"line\"></div><div class=\"line\"># 登入设定部分</div><div class=\"line\">PermitRootLogin no　　 　　# 是否允许 root 登入！预设是允许的，但是建议设定成 no！</div><div class=\"line\">UserLogin no　　　　　　　 # 在 SSH 底下本来就不接受 login 这个程序的登入！</div><div class=\"line\">StrictModes yes　　　　　　# 当使用者的 host key 改变之后，Server 就不接受联机，</div><div class=\"line\">　　　　　　　　　　　　　 # 可以抵挡部分的木马程序！</div><div class=\"line\">#RSAAuthentication yes　　 # 是否使用纯的 RSA 认证！？仅针对 version 1 ！</div><div class=\"line\">PubkeyAuthentication yes　 # 是否允许 Public Key ？当然允许啦！只有 version 2</div><div class=\"line\">AuthorizedKeysFile      .ssh/authorized_keys</div><div class=\"line\">　　　　　　　　　　　　　 # 上面这个在设定若要使用不需要密码登入的账号时，那么那个</div><div class=\"line\">　　　　　　　　　　　　　 # 账号的存放档案所在档名！</div><div class=\"line\">Allowusers root@222.XX.XX.XX. #设置允许root帐号只能以222.XX.XX.XX这个IP进行ssh连接</div><div class=\"line\"></div><div class=\"line\"># 认证部分</div><div class=\"line\">RhostsAuthentication no　　# 本机系统不止使用 .rhosts ，因为仅使用 .rhosts 太</div><div class=\"line\">　　　　　　　　　　　　　 # 不安全了，所以这里一定要设定为 no ！</div><div class=\"line\">IgnoreRhosts yes　　　　　 # 是否取消使用 ~/.ssh/.rhosts 来做为认证！当然是！</div><div class=\"line\">RhostsRSAAuthentication no # 这个选项是专门给 version 1 用的，使用 rhosts 档案在</div><div class=\"line\">　　　　　　　　　　　　　 # /etc/hosts.equiv配合 RSA 演算方式来进行认证！不要使用</div><div class=\"line\">HostbasedAuthentication no # 这个项目与上面的项目类似，不过是给 version 2 使用的！</div><div class=\"line\">IgnoreUserKnownHosts no　　# 是否忽略家目录内的 ~/.ssh/known_hosts 这个档案所记录</div><div class=\"line\">　　　　　　　　　　　　　 # 的主机内容？当然不要忽略，所以这里就是 no 啦！</div><div class=\"line\">PasswordAuthentication yes # 密码验证当然是需要的！所以这里写 yes 啰！</div><div class=\"line\">PermitEmptyPasswords no　　# 若上面那一项如果设定为 yes 的话，这一项就最好设定</div><div class=\"line\">　　　　　　　　　　　　　 # 为 no ，这个项目在是否允许以空的密码登入！当然不许！</div><div class=\"line\">ChallengeResponseAuthentication yes  # 挑战任何的密码认证！所以，任何 login.conf</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 规定的认证方式，均可适用！</div><div class=\"line\">#PAMAuthenticationViaKbdInt yes      # 是否启用其它的 PAM 模块！启用这个模块将会</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 导致 PasswordAuthentication 设定失效！</div><div class=\"line\"></div><div class=\"line\"># 与 Kerberos 有关的参数设定！因为我们没有 Kerberos 主机，所以底下不用设定！</div><div class=\"line\">#KerberosAuthentication no</div><div class=\"line\">#KerberosOrLocalPasswd yes</div><div class=\"line\">#KerberosTicketCleanup yes</div><div class=\"line\">#KerberosTgtPassing no</div><div class=\"line\">　</div><div class=\"line\"># 底下是有关在 X-Window 底下使用的相关设定！</div><div class=\"line\">X11Forwarding yes</div><div class=\"line\">#X11DisplayOffset 10</div><div class=\"line\">#X11UseLocalhost yes</div><div class=\"line\"># 登入后的项目：</div><div class=\"line\">PrintMotd no              # 登入后是否显示出一些信息呢？例如上次登入的时间、地点等</div><div class=\"line\">　　　　　　　　　　　　　# 等，预设是 yes ，但是，如果为了安全，可以考虑改为 no ！</div><div class=\"line\">PrintLastLog yes　　　　　# 显示上次登入的信息！可以啊！预设也是 yes ！</div><div class=\"line\">KeepAlive yes　　　　　　 # 一般而言，如果设定这项目的话，那么 SSH Server 会传送</div><div class=\"line\">　　　　　　　　　　　　　# KeepAlive 的讯息给 Client 端，以确保两者的联机正常！</div><div class=\"line\">　　　　　　　　　　　　　# 在这个情况下，任何一端死掉后， SSH 可以立刻知道！而不会</div><div class=\"line\">　　　　　　　　　　　　　# 有僵尸程序的发生！</div><div class=\"line\">UsePrivilegeSeparation yes # 使用者的权限设定项目！就设定为 yes 吧！</div><div class=\"line\">MaxStartups 10　　　　　　# 同时允许几个尚未登入的联机画面？当我们连上 SSH ，</div><div class=\"line\">　　　　　　　　　　　　　# 但是尚未输入密码时，这个时候就是我们所谓的联机画面啦！</div><div class=\"line\">　　　　　　　　　　　　　# 在这个联机画面中，为了保护主机，所以需要设定最大值，</div><div class=\"line\">　　　　　　　　　　　　　# 预设最多十个联机画面，而已经建立联机的不计算在这十个当中</div><div class=\"line\"></div><div class=\"line\"># 关于使用者抵挡的设定项目：</div><div class=\"line\">DenyUsers *　　　　　　　 # 设定受抵挡的使用者名称，如果是全部的使用者，那就是全部</div><div class=\"line\">　　　　　　　　　　　　　# 挡吧！若是部分使用者，可以将该账号填入！例如下列！</div><div class=\"line\">DenyUsers test</div><div class=\"line\">DenyGroups test　　　　　 # 与 DenyUsers 相同！仅抵挡几个群组而已！</div><div class=\"line\"></div><div class=\"line\"># 关于 SFTP 服务的设定项目！</div><div class=\"line\">Subsystem       sftp    /usr/lib/ssh/sftp-server</div><div class=\"line\">如果不愿意开放 SFTP 的话，将这一行批注掉即可！</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"SSH-配置安全控制限制登录\"><a href=\"#SSH-配置安全控制限制登录\" class=\"headerlink\" title=\"SSH 配置安全控制限制登录\"></a><strong>SSH 配置安全控制限制登录</strong></h3><h5 id=\"1-只允许某个IP登录，拒绝其他所有IP\"><a href=\"#1-只允许某个IP登录，拒绝其他所有IP\" class=\"headerlink\" title=\"1. 只允许某个IP登录，拒绝其他所有IP\"></a>1. 只允许某个IP登录，拒绝其他所有IP</h5><p>在 /etc/hosts.allow 增加:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sshd: 1.2.3.4</div></pre></td></tr></table></figure></p>\n<p>在 /etc/hosts.deny 增肌:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sshd: ALL</div></pre></td></tr></table></figure></p>\n<p>用 iptables 也行:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">iptables -A INPUT -p tcp --dport 22 -j DROP</div><div class=\"line\">iptables -A INPUT -p tcp --dport 22 -s 1.2.3.4 -j ACCEPT</div></pre></td></tr></table></figure></p>\n<h5 id=\"2-禁止某个用户通过ssh登录\"><a href=\"#2-禁止某个用户通过ssh登录\" class=\"headerlink\" title=\"2. 禁止某个用户通过ssh登录\"></a>2. 禁止某个用户通过ssh登录</h5><p>在/etc/ssh/sshd_conf添加<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">AllowUsers 用户名</div><div class=\"line\">或者</div><div class=\"line\">AllowGroups 组名</div><div class=\"line\">或者</div><div class=\"line\">DenyUsers 用户名</div></pre></td></tr></table></figure></p>\n<h5 id=\"3-设定登录黑名单\"><a href=\"#3-设定登录黑名单\" class=\"headerlink\" title=\"3. 设定登录黑名单\"></a>3. 设定登录黑名单</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@6 ~]# vim /etc/pam.d/sshd</div><div class=\"line\">auth required /lib/security/pam_listfile.so item=user sense=deny file=/etc/sshd_user_deny_list onerr=succeed</div><div class=\"line\"># 所有/etc/sshd_user_deny_list里面的用户被拒绝ssh登录</div></pre></td></tr></table></figure>\n<h5 id=\"4-sshd-config配置\"><a href=\"#4-sshd-config配置\" class=\"headerlink\" title=\"4. sshd_config配置\"></a>4. sshd_config配置</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 关于 SSH Server 的整体设定，包含使用的 port 啦，以及使用的密码演算方式</div><div class=\"line\">Port 22　　　　　　　　　　# SSH 预设使用 22 这个 port，您也可以使用多的 port ！</div><div class=\"line\">　　　　　　　　　　　　　 # 亦即重复使用 port 这个设定项目即可！</div><div class=\"line\">Protocol 2,1　　　　　　　 # 选择的 SSH 协议版本，可以是 1 也可以是 2 ，</div><div class=\"line\">　　　　　　　　　　　　　 # 如果要同时支持两者，就必须要使用 2,1 这个分隔了！</div><div class=\"line\">#ListenAddress 0.0.0.0　　 # 监听的主机适配卡！举个例子来说，如果您有两个 IP，</div><div class=\"line\">　　　　　　　　　　　　　 # 分别是 192.168.0.100 及 192.168.2.20 ，那么只想要</div><div class=\"line\">　　　　　　　　　　　　　 # 开放 192.168.0.100 时，就可以写如同下面的样式：</div><div class=\"line\">ListenAddress 192.168.0.100          # 只监听来自 192.168.0.100 这个 IP 的SSH联机。</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 如果不使用设定的话，则预设所有接口均接受 SSH</div><div class=\"line\">PidFile /var/run/sshd.pid　　　　　　# 可以放置 SSHD 这个 PID 的档案！左列为默认值</div><div class=\"line\">LoginGraceTime 600　　　　 # 当使用者连上 SSH server 之后，会出现输入密码的画面，</div><div class=\"line\">　　　　　　　　　　　　　 # 在该画面中，在多久时间内没有成功连上 SSH server ，</div><div class=\"line\">　　　　　　　　　　　　　 # 就断线！时间为秒！</div><div class=\"line\">Compression yes　　　　　　# 是否可以使用压缩指令？当然可以啰！</div><div class=\"line\"></div><div class=\"line\"># 说明主机的 Private Key 放置的档案，预设使用下面的档案即可！</div><div class=\"line\">HostKey /etc/ssh/ssh_host_key　　　　# SSH version 1 使用的私钥</div><div class=\"line\">HostKey /etc/ssh/ssh_host_rsa_key　　# SSH version 2 使用的 RSA 私钥</div><div class=\"line\">HostKey /etc/ssh/ssh_host_dsa_key　　# SSH version 2 使用的 DSA 私钥</div><div class=\"line\"># 关于 version 1 的一些设定！</div><div class=\"line\">KeyRegenerationInterval 3600　 　　　# 由前面联机的说明可以知道， version 1 会使用</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # server 的 Public Key ，那么如果这个 Public</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # Key 被偷的话，岂不完蛋？所以需要每隔一段时间</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 来重新建立一次！这里的时间为秒！</div><div class=\"line\">ServerKeyBits 768 　　　　　　　　　 # 没错！这个就是 Server key 的长度！</div><div class=\"line\"></div><div class=\"line\"># 关于登录文件的讯息数据放置与 daemon 的名称！</div><div class=\"line\">SyslogFacility AUTH　　　　　　　　　# 当有人使用 SSH 登入系统的时候，SSH会记录资</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 讯，这个信息要记录在什么 daemon name 底下？</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 预设是以 AUTH 来设定的，即是 /var/log/secure</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 里面！什么？忘记了！回到 Linux 基础去翻一下</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 其它可用的 daemon name 为：DAEMON,USER,AUTH,</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # LOCAL0,LOCAL1,LOCAL2,LOCAL3,LOCAL4,LOCAL5,</div><div class=\"line\">LogLevel INFO　　　　　　　　　　　　# 登录记录的等级！嘿嘿！任何讯息！</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 同样的，忘记了就回去参考！</div><div class=\"line\"></div><div class=\"line\"># 登入设定部分</div><div class=\"line\">PermitRootLogin no　　 　　# 是否允许 root 登入！预设是允许的，但是建议设定成 no！</div><div class=\"line\">UserLogin no　　　　　　　 # 在 SSH 底下本来就不接受 login 这个程序的登入！</div><div class=\"line\">StrictModes yes　　　　　　# 当使用者的 host key 改变之后，Server 就不接受联机，</div><div class=\"line\">　　　　　　　　　　　　　 # 可以抵挡部分的木马程序！</div><div class=\"line\">#RSAAuthentication yes　　 # 是否使用纯的 RSA 认证！？仅针对 version 1 ！</div><div class=\"line\">PubkeyAuthentication yes　 # 是否允许 Public Key ？当然允许啦！只有 version 2</div><div class=\"line\">AuthorizedKeysFile      .ssh/authorized_keys</div><div class=\"line\">　　　　　　　　　　　　　 # 上面这个在设定若要使用不需要密码登入的账号时，那么那个</div><div class=\"line\">　　　　　　　　　　　　　 # 账号的存放档案所在档名！</div><div class=\"line\">Allowusers root@222.XX.XX.XX. #设置允许root帐号只能以222.XX.XX.XX这个IP进行ssh连接</div><div class=\"line\"></div><div class=\"line\"># 认证部分</div><div class=\"line\">RhostsAuthentication no　　# 本机系统不止使用 .rhosts ，因为仅使用 .rhosts 太</div><div class=\"line\">　　　　　　　　　　　　　 # 不安全了，所以这里一定要设定为 no ！</div><div class=\"line\">IgnoreRhosts yes　　　　　 # 是否取消使用 ~/.ssh/.rhosts 来做为认证！当然是！</div><div class=\"line\">RhostsRSAAuthentication no # 这个选项是专门给 version 1 用的，使用 rhosts 档案在</div><div class=\"line\">　　　　　　　　　　　　　 # /etc/hosts.equiv配合 RSA 演算方式来进行认证！不要使用</div><div class=\"line\">HostbasedAuthentication no # 这个项目与上面的项目类似，不过是给 version 2 使用的！</div><div class=\"line\">IgnoreUserKnownHosts no　　# 是否忽略家目录内的 ~/.ssh/known_hosts 这个档案所记录</div><div class=\"line\">　　　　　　　　　　　　　 # 的主机内容？当然不要忽略，所以这里就是 no 啦！</div><div class=\"line\">PasswordAuthentication yes # 密码验证当然是需要的！所以这里写 yes 啰！</div><div class=\"line\">PermitEmptyPasswords no　　# 若上面那一项如果设定为 yes 的话，这一项就最好设定</div><div class=\"line\">　　　　　　　　　　　　　 # 为 no ，这个项目在是否允许以空的密码登入！当然不许！</div><div class=\"line\">ChallengeResponseAuthentication yes  # 挑战任何的密码认证！所以，任何 login.conf</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 规定的认证方式，均可适用！</div><div class=\"line\">#PAMAuthenticationViaKbdInt yes      # 是否启用其它的 PAM 模块！启用这个模块将会</div><div class=\"line\">　　　　　　　　　　　　　　　　　　 # 导致 PasswordAuthentication 设定失效！</div><div class=\"line\"></div><div class=\"line\"># 与 Kerberos 有关的参数设定！因为我们没有 Kerberos 主机，所以底下不用设定！</div><div class=\"line\">#KerberosAuthentication no</div><div class=\"line\">#KerberosOrLocalPasswd yes</div><div class=\"line\">#KerberosTicketCleanup yes</div><div class=\"line\">#KerberosTgtPassing no</div><div class=\"line\">　</div><div class=\"line\"># 底下是有关在 X-Window 底下使用的相关设定！</div><div class=\"line\">X11Forwarding yes</div><div class=\"line\">#X11DisplayOffset 10</div><div class=\"line\">#X11UseLocalhost yes</div><div class=\"line\"># 登入后的项目：</div><div class=\"line\">PrintMotd no              # 登入后是否显示出一些信息呢？例如上次登入的时间、地点等</div><div class=\"line\">　　　　　　　　　　　　　# 等，预设是 yes ，但是，如果为了安全，可以考虑改为 no ！</div><div class=\"line\">PrintLastLog yes　　　　　# 显示上次登入的信息！可以啊！预设也是 yes ！</div><div class=\"line\">KeepAlive yes　　　　　　 # 一般而言，如果设定这项目的话，那么 SSH Server 会传送</div><div class=\"line\">　　　　　　　　　　　　　# KeepAlive 的讯息给 Client 端，以确保两者的联机正常！</div><div class=\"line\">　　　　　　　　　　　　　# 在这个情况下，任何一端死掉后， SSH 可以立刻知道！而不会</div><div class=\"line\">　　　　　　　　　　　　　# 有僵尸程序的发生！</div><div class=\"line\">UsePrivilegeSeparation yes # 使用者的权限设定项目！就设定为 yes 吧！</div><div class=\"line\">MaxStartups 10　　　　　　# 同时允许几个尚未登入的联机画面？当我们连上 SSH ，</div><div class=\"line\">　　　　　　　　　　　　　# 但是尚未输入密码时，这个时候就是我们所谓的联机画面啦！</div><div class=\"line\">　　　　　　　　　　　　　# 在这个联机画面中，为了保护主机，所以需要设定最大值，</div><div class=\"line\">　　　　　　　　　　　　　# 预设最多十个联机画面，而已经建立联机的不计算在这十个当中</div><div class=\"line\"></div><div class=\"line\"># 关于使用者抵挡的设定项目：</div><div class=\"line\">DenyUsers *　　　　　　　 # 设定受抵挡的使用者名称，如果是全部的使用者，那就是全部</div><div class=\"line\">　　　　　　　　　　　　　# 挡吧！若是部分使用者，可以将该账号填入！例如下列！</div><div class=\"line\">DenyUsers test</div><div class=\"line\">DenyGroups test　　　　　 # 与 DenyUsers 相同！仅抵挡几个群组而已！</div><div class=\"line\"></div><div class=\"line\"># 关于 SFTP 服务的设定项目！</div><div class=\"line\">Subsystem       sftp    /usr/lib/ssh/sftp-server</div><div class=\"line\">如果不愿意开放 SFTP 的话，将这一行批注掉即可！</div></pre></td></tr></table></figure>\n"},{"title":"Script Install LNMP","id":"88","updated":"2017-04-21T05:22:32.000Z","date":"2016-08-12T22:12:43.000Z","_content":"\n```\n#!/bin/bash\n\n#\n\nif [[ $1 == \"uninstall\" ]];then\n\techo \"starting backup data...\"\n\tmkdir -p /www/backup\n\tservice mysqld stop\n\tservice nginxd stop\n\tservice httpd stop\n\tservice wdapache stop\n\tservice pureftpd stop\n\ttar zcvf /www/backup/mysqldatdbk.tar.gz /www/wdlinux/mysql/var\n\ttar zcvf /www/backup/ngconfbk.tar.gz /www/wdlinux/nginx/conf\n\ttar zcvf /www/backup/apconfbk.tar.gz /www/wdlinux/apache/conf\n\trpm -e lanmp_wdcp --nodeps\n\trm -fr /www/wdlinux\n\techo\n\techo \"\tlanmp,wdcp remove is OK\"\n\techo\n\texit 0\nfi\n\necho \"Turn off selinux...\"\nsetenforce 0\nsed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config\nsed -i 's/^exclude=/#exclude=/g' /etc/yum.conf\nyum install -y gcc gcc-c++ make autoconf libtool-ltdl-devel gd-devel freetype-devel libxml2-devel libjpeg-devel libpng-devel openssl-devel curl-devel patch libmcrypt-devel libmhash-devel ncurses-devel sudo bzip2 iptables sendmail iptables unzip\n\n#echo \"Check the network...\"\n#ping -c 2 113.105.167.1\n#if [[ $? != 0 ]];then\n#\techo\n#\techo \"network err\"\n#\texit 1\n#fi\nping -c 3 dl.wdlinux.cn\nif [[ $? == 2 ]];then\n\techo\n\techo \"dns error\"\n\texit 1\nfi\n\nif [[ ! -d /www/wdlinux ]];then\n\techo\n\techo \"rpm remove...\"\n\trpm -e php --nodeps\n\trpm -e httpd --nodeps\n\trpm -e mysql-server --nodeps\n\trpm -e mysql --nodeps\nfi\n\necho \"yum update...\"\nyum install -y make autoconf sudo wget libtool-ltdl-devel gd-devel freetype-devel libxml2-devel libjpeg-devel libpng-devel openssl-devel curl-devel patch libmcrypt-devel libmhash-devel ncurses-devel iptables\n\narch=i386\nAurl=\"http://dl.wdlinux.cn:5180/rpms\"\nif [[ `uname -m` == \"x86_64\" ]];then\n\tarch=\"x86_64\"\nfi\n\nfunction in_finsh {\n        echo\n        echo \"          configuration ,lamp or lnmp,wdcp install is finshed\"\n        echo \"          visit http://ip\"\n        echo \"          wdcp visit http://ip:8080\"\n        echo \"          more infomation please visit http://www.wdlinux.cn\"\n        echo\n}\n\nfunction in_check {\n        if [[ $1 == 1 ]];then\n                echo\n                echo \"============  $2 install error  =============\"\n                echo\n                exit 1\n        else\n                echo\n                echo \"============  $2 install OK  ==============\"\n                echo\n                echo\n        fi\n}\n\ngrep -E 'wdOS 1|5\\.' /etc/redhat-release > /dev/null 2>&1\nv1=$?\ngrep -E 'wdOS 2|6\\.' /etc/redhat-release > /dev/null 2>&1\nv2=$?\nif [ $v1 == 0 ];then\n\tRF=\"lanmp_wdcp-2-5.$arch.rpm\";\nelif [ $v2 == 0 ];then\n\tRF=\"lanmp_wdcp-2-5.el6.$arch.rpm\";\n\tif [ $arch == \"x86_64\" ];then\n\t\twget -c http://dl.wdlinux.cn:5180/soft/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm\n\t\trpm -ivh rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm\n\telse\n\t\twget -c http://dl.wdlinux.cn:5180/soft/rpmforge-release-0.5.2-2.el6.rf.i686.rpm\n\t\trpm -ivh rpmforge-release-0.5.2-2.el6.rf.i686.rpm\n\tfi\n\tyum install -y mhash-devel libmcrypt-devel\nelse\n\techo\n\techo \"The current system does not support\"\n\techo\n\texit\nfi\nwget -c http://dl.wdlinux.cn:5180/rpms/$RF\nrpm -ivh $RF --nodeps\nI_F=$?\nif [ $I_F == 0 ];then\n\techo\nfi\nin_check $I_F lanmp_wdcp\n\nrm -f wdcp_v*\nwget -c http://down.wdlinux.cn/down/wdcp_v2.5.tar.gz > /dev/null 2>&1\ntar zxvf wdcp_v2.5.tar.gz -C / > /dev/null 2>&1\n\nin_finsh\n\n```\n","source":"_posts/Script-Install-LNMP.md","raw":"---\ntitle: Script Install LNMP\ntags: 'Shell-Scripts'\ncategories: 'Shell'\npermalink: use-wdlinux-install-lnmp\nid: 88\nupdated: '2017-04-21 13:22:32'\ndate: 2016-08-13 06:12:43\n---\n\n```\n#!/bin/bash\n\n#\n\nif [[ $1 == \"uninstall\" ]];then\n\techo \"starting backup data...\"\n\tmkdir -p /www/backup\n\tservice mysqld stop\n\tservice nginxd stop\n\tservice httpd stop\n\tservice wdapache stop\n\tservice pureftpd stop\n\ttar zcvf /www/backup/mysqldatdbk.tar.gz /www/wdlinux/mysql/var\n\ttar zcvf /www/backup/ngconfbk.tar.gz /www/wdlinux/nginx/conf\n\ttar zcvf /www/backup/apconfbk.tar.gz /www/wdlinux/apache/conf\n\trpm -e lanmp_wdcp --nodeps\n\trm -fr /www/wdlinux\n\techo\n\techo \"\tlanmp,wdcp remove is OK\"\n\techo\n\texit 0\nfi\n\necho \"Turn off selinux...\"\nsetenforce 0\nsed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config\nsed -i 's/^exclude=/#exclude=/g' /etc/yum.conf\nyum install -y gcc gcc-c++ make autoconf libtool-ltdl-devel gd-devel freetype-devel libxml2-devel libjpeg-devel libpng-devel openssl-devel curl-devel patch libmcrypt-devel libmhash-devel ncurses-devel sudo bzip2 iptables sendmail iptables unzip\n\n#echo \"Check the network...\"\n#ping -c 2 113.105.167.1\n#if [[ $? != 0 ]];then\n#\techo\n#\techo \"network err\"\n#\texit 1\n#fi\nping -c 3 dl.wdlinux.cn\nif [[ $? == 2 ]];then\n\techo\n\techo \"dns error\"\n\texit 1\nfi\n\nif [[ ! -d /www/wdlinux ]];then\n\techo\n\techo \"rpm remove...\"\n\trpm -e php --nodeps\n\trpm -e httpd --nodeps\n\trpm -e mysql-server --nodeps\n\trpm -e mysql --nodeps\nfi\n\necho \"yum update...\"\nyum install -y make autoconf sudo wget libtool-ltdl-devel gd-devel freetype-devel libxml2-devel libjpeg-devel libpng-devel openssl-devel curl-devel patch libmcrypt-devel libmhash-devel ncurses-devel iptables\n\narch=i386\nAurl=\"http://dl.wdlinux.cn:5180/rpms\"\nif [[ `uname -m` == \"x86_64\" ]];then\n\tarch=\"x86_64\"\nfi\n\nfunction in_finsh {\n        echo\n        echo \"          configuration ,lamp or lnmp,wdcp install is finshed\"\n        echo \"          visit http://ip\"\n        echo \"          wdcp visit http://ip:8080\"\n        echo \"          more infomation please visit http://www.wdlinux.cn\"\n        echo\n}\n\nfunction in_check {\n        if [[ $1 == 1 ]];then\n                echo\n                echo \"============  $2 install error  =============\"\n                echo\n                exit 1\n        else\n                echo\n                echo \"============  $2 install OK  ==============\"\n                echo\n                echo\n        fi\n}\n\ngrep -E 'wdOS 1|5\\.' /etc/redhat-release > /dev/null 2>&1\nv1=$?\ngrep -E 'wdOS 2|6\\.' /etc/redhat-release > /dev/null 2>&1\nv2=$?\nif [ $v1 == 0 ];then\n\tRF=\"lanmp_wdcp-2-5.$arch.rpm\";\nelif [ $v2 == 0 ];then\n\tRF=\"lanmp_wdcp-2-5.el6.$arch.rpm\";\n\tif [ $arch == \"x86_64\" ];then\n\t\twget -c http://dl.wdlinux.cn:5180/soft/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm\n\t\trpm -ivh rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm\n\telse\n\t\twget -c http://dl.wdlinux.cn:5180/soft/rpmforge-release-0.5.2-2.el6.rf.i686.rpm\n\t\trpm -ivh rpmforge-release-0.5.2-2.el6.rf.i686.rpm\n\tfi\n\tyum install -y mhash-devel libmcrypt-devel\nelse\n\techo\n\techo \"The current system does not support\"\n\techo\n\texit\nfi\nwget -c http://dl.wdlinux.cn:5180/rpms/$RF\nrpm -ivh $RF --nodeps\nI_F=$?\nif [ $I_F == 0 ];then\n\techo\nfi\nin_check $I_F lanmp_wdcp\n\nrm -f wdcp_v*\nwget -c http://down.wdlinux.cn/down/wdcp_v2.5.tar.gz > /dev/null 2>&1\ntar zxvf wdcp_v2.5.tar.gz -C / > /dev/null 2>&1\n\nin_finsh\n\n```\n","slug":"use-wdlinux-install-lnmp","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqc8005y41tpbysd2ehk","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">if [[ $1 == &quot;uninstall&quot; ]];then</div><div class=\"line\">\techo &quot;starting backup data...&quot;</div><div class=\"line\">\tmkdir -p /www/backup</div><div class=\"line\">\tservice mysqld stop</div><div class=\"line\">\tservice nginxd stop</div><div class=\"line\">\tservice httpd stop</div><div class=\"line\">\tservice wdapache stop</div><div class=\"line\">\tservice pureftpd stop</div><div class=\"line\">\ttar zcvf /www/backup/mysqldatdbk.tar.gz /www/wdlinux/mysql/var</div><div class=\"line\">\ttar zcvf /www/backup/ngconfbk.tar.gz /www/wdlinux/nginx/conf</div><div class=\"line\">\ttar zcvf /www/backup/apconfbk.tar.gz /www/wdlinux/apache/conf</div><div class=\"line\">\trpm -e lanmp_wdcp --nodeps</div><div class=\"line\">\trm -fr /www/wdlinux</div><div class=\"line\">\techo</div><div class=\"line\">\techo &quot;\tlanmp,wdcp remove is OK&quot;</div><div class=\"line\">\techo</div><div class=\"line\">\texit 0</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\">echo &quot;Turn off selinux...&quot;</div><div class=\"line\">setenforce 0</div><div class=\"line\">sed -i &apos;s/SELINUX=enforcing/SELINUX=disabled/g&apos; /etc/selinux/config</div><div class=\"line\">sed -i &apos;s/^exclude=/#exclude=/g&apos; /etc/yum.conf</div><div class=\"line\">yum install -y gcc gcc-c++ make autoconf libtool-ltdl-devel gd-devel freetype-devel libxml2-devel libjpeg-devel libpng-devel openssl-devel curl-devel patch libmcrypt-devel libmhash-devel ncurses-devel sudo bzip2 iptables sendmail iptables unzip</div><div class=\"line\"></div><div class=\"line\">#echo &quot;Check the network...&quot;</div><div class=\"line\">#ping -c 2 113.105.167.1</div><div class=\"line\">#if [[ $? != 0 ]];then</div><div class=\"line\">#\techo</div><div class=\"line\">#\techo &quot;network err&quot;</div><div class=\"line\">#\texit 1</div><div class=\"line\">#fi</div><div class=\"line\">ping -c 3 dl.wdlinux.cn</div><div class=\"line\">if [[ $? == 2 ]];then</div><div class=\"line\">\techo</div><div class=\"line\">\techo &quot;dns error&quot;</div><div class=\"line\">\texit 1</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\">if [[ ! -d /www/wdlinux ]];then</div><div class=\"line\">\techo</div><div class=\"line\">\techo &quot;rpm remove...&quot;</div><div class=\"line\">\trpm -e php --nodeps</div><div class=\"line\">\trpm -e httpd --nodeps</div><div class=\"line\">\trpm -e mysql-server --nodeps</div><div class=\"line\">\trpm -e mysql --nodeps</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\">echo &quot;yum update...&quot;</div><div class=\"line\">yum install -y make autoconf sudo wget libtool-ltdl-devel gd-devel freetype-devel libxml2-devel libjpeg-devel libpng-devel openssl-devel curl-devel patch libmcrypt-devel libmhash-devel ncurses-devel iptables</div><div class=\"line\"></div><div class=\"line\">arch=i386</div><div class=\"line\">Aurl=&quot;http://dl.wdlinux.cn:5180/rpms&quot;</div><div class=\"line\">if [[ `uname -m` == &quot;x86_64&quot; ]];then</div><div class=\"line\">\tarch=&quot;x86_64&quot;</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\">function in_finsh &#123;</div><div class=\"line\">        echo</div><div class=\"line\">        echo &quot;          configuration ,lamp or lnmp,wdcp install is finshed&quot;</div><div class=\"line\">        echo &quot;          visit http://ip&quot;</div><div class=\"line\">        echo &quot;          wdcp visit http://ip:8080&quot;</div><div class=\"line\">        echo &quot;          more infomation please visit http://www.wdlinux.cn&quot;</div><div class=\"line\">        echo</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function in_check &#123;</div><div class=\"line\">        if [[ $1 == 1 ]];then</div><div class=\"line\">                echo</div><div class=\"line\">                echo &quot;============  $2 install error  =============&quot;</div><div class=\"line\">                echo</div><div class=\"line\">                exit 1</div><div class=\"line\">        else</div><div class=\"line\">                echo</div><div class=\"line\">                echo &quot;============  $2 install OK  ==============&quot;</div><div class=\"line\">                echo</div><div class=\"line\">                echo</div><div class=\"line\">        fi</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">grep -E &apos;wdOS 1|5\\.&apos; /etc/redhat-release &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\">v1=$?</div><div class=\"line\">grep -E &apos;wdOS 2|6\\.&apos; /etc/redhat-release &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\">v2=$?</div><div class=\"line\">if [ $v1 == 0 ];then</div><div class=\"line\">\tRF=&quot;lanmp_wdcp-2-5.$arch.rpm&quot;;</div><div class=\"line\">elif [ $v2 == 0 ];then</div><div class=\"line\">\tRF=&quot;lanmp_wdcp-2-5.el6.$arch.rpm&quot;;</div><div class=\"line\">\tif [ $arch == &quot;x86_64&quot; ];then</div><div class=\"line\">\t\twget -c http://dl.wdlinux.cn:5180/soft/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm</div><div class=\"line\">\t\trpm -ivh rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm</div><div class=\"line\">\telse</div><div class=\"line\">\t\twget -c http://dl.wdlinux.cn:5180/soft/rpmforge-release-0.5.2-2.el6.rf.i686.rpm</div><div class=\"line\">\t\trpm -ivh rpmforge-release-0.5.2-2.el6.rf.i686.rpm</div><div class=\"line\">\tfi</div><div class=\"line\">\tyum install -y mhash-devel libmcrypt-devel</div><div class=\"line\">else</div><div class=\"line\">\techo</div><div class=\"line\">\techo &quot;The current system does not support&quot;</div><div class=\"line\">\techo</div><div class=\"line\">\texit</div><div class=\"line\">fi</div><div class=\"line\">wget -c http://dl.wdlinux.cn:5180/rpms/$RF</div><div class=\"line\">rpm -ivh $RF --nodeps</div><div class=\"line\">I_F=$?</div><div class=\"line\">if [ $I_F == 0 ];then</div><div class=\"line\">\techo</div><div class=\"line\">fi</div><div class=\"line\">in_check $I_F lanmp_wdcp</div><div class=\"line\"></div><div class=\"line\">rm -f wdcp_v*</div><div class=\"line\">wget -c http://down.wdlinux.cn/down/wdcp_v2.5.tar.gz &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\">tar zxvf wdcp_v2.5.tar.gz -C / &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\"></div><div class=\"line\">in_finsh</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">if [[ $1 == &quot;uninstall&quot; ]];then</div><div class=\"line\">\techo &quot;starting backup data...&quot;</div><div class=\"line\">\tmkdir -p /www/backup</div><div class=\"line\">\tservice mysqld stop</div><div class=\"line\">\tservice nginxd stop</div><div class=\"line\">\tservice httpd stop</div><div class=\"line\">\tservice wdapache stop</div><div class=\"line\">\tservice pureftpd stop</div><div class=\"line\">\ttar zcvf /www/backup/mysqldatdbk.tar.gz /www/wdlinux/mysql/var</div><div class=\"line\">\ttar zcvf /www/backup/ngconfbk.tar.gz /www/wdlinux/nginx/conf</div><div class=\"line\">\ttar zcvf /www/backup/apconfbk.tar.gz /www/wdlinux/apache/conf</div><div class=\"line\">\trpm -e lanmp_wdcp --nodeps</div><div class=\"line\">\trm -fr /www/wdlinux</div><div class=\"line\">\techo</div><div class=\"line\">\techo &quot;\tlanmp,wdcp remove is OK&quot;</div><div class=\"line\">\techo</div><div class=\"line\">\texit 0</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\">echo &quot;Turn off selinux...&quot;</div><div class=\"line\">setenforce 0</div><div class=\"line\">sed -i &apos;s/SELINUX=enforcing/SELINUX=disabled/g&apos; /etc/selinux/config</div><div class=\"line\">sed -i &apos;s/^exclude=/#exclude=/g&apos; /etc/yum.conf</div><div class=\"line\">yum install -y gcc gcc-c++ make autoconf libtool-ltdl-devel gd-devel freetype-devel libxml2-devel libjpeg-devel libpng-devel openssl-devel curl-devel patch libmcrypt-devel libmhash-devel ncurses-devel sudo bzip2 iptables sendmail iptables unzip</div><div class=\"line\"></div><div class=\"line\">#echo &quot;Check the network...&quot;</div><div class=\"line\">#ping -c 2 113.105.167.1</div><div class=\"line\">#if [[ $? != 0 ]];then</div><div class=\"line\">#\techo</div><div class=\"line\">#\techo &quot;network err&quot;</div><div class=\"line\">#\texit 1</div><div class=\"line\">#fi</div><div class=\"line\">ping -c 3 dl.wdlinux.cn</div><div class=\"line\">if [[ $? == 2 ]];then</div><div class=\"line\">\techo</div><div class=\"line\">\techo &quot;dns error&quot;</div><div class=\"line\">\texit 1</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\">if [[ ! -d /www/wdlinux ]];then</div><div class=\"line\">\techo</div><div class=\"line\">\techo &quot;rpm remove...&quot;</div><div class=\"line\">\trpm -e php --nodeps</div><div class=\"line\">\trpm -e httpd --nodeps</div><div class=\"line\">\trpm -e mysql-server --nodeps</div><div class=\"line\">\trpm -e mysql --nodeps</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\">echo &quot;yum update...&quot;</div><div class=\"line\">yum install -y make autoconf sudo wget libtool-ltdl-devel gd-devel freetype-devel libxml2-devel libjpeg-devel libpng-devel openssl-devel curl-devel patch libmcrypt-devel libmhash-devel ncurses-devel iptables</div><div class=\"line\"></div><div class=\"line\">arch=i386</div><div class=\"line\">Aurl=&quot;http://dl.wdlinux.cn:5180/rpms&quot;</div><div class=\"line\">if [[ `uname -m` == &quot;x86_64&quot; ]];then</div><div class=\"line\">\tarch=&quot;x86_64&quot;</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\">function in_finsh &#123;</div><div class=\"line\">        echo</div><div class=\"line\">        echo &quot;          configuration ,lamp or lnmp,wdcp install is finshed&quot;</div><div class=\"line\">        echo &quot;          visit http://ip&quot;</div><div class=\"line\">        echo &quot;          wdcp visit http://ip:8080&quot;</div><div class=\"line\">        echo &quot;          more infomation please visit http://www.wdlinux.cn&quot;</div><div class=\"line\">        echo</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">function in_check &#123;</div><div class=\"line\">        if [[ $1 == 1 ]];then</div><div class=\"line\">                echo</div><div class=\"line\">                echo &quot;============  $2 install error  =============&quot;</div><div class=\"line\">                echo</div><div class=\"line\">                exit 1</div><div class=\"line\">        else</div><div class=\"line\">                echo</div><div class=\"line\">                echo &quot;============  $2 install OK  ==============&quot;</div><div class=\"line\">                echo</div><div class=\"line\">                echo</div><div class=\"line\">        fi</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">grep -E &apos;wdOS 1|5\\.&apos; /etc/redhat-release &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\">v1=$?</div><div class=\"line\">grep -E &apos;wdOS 2|6\\.&apos; /etc/redhat-release &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\">v2=$?</div><div class=\"line\">if [ $v1 == 0 ];then</div><div class=\"line\">\tRF=&quot;lanmp_wdcp-2-5.$arch.rpm&quot;;</div><div class=\"line\">elif [ $v2 == 0 ];then</div><div class=\"line\">\tRF=&quot;lanmp_wdcp-2-5.el6.$arch.rpm&quot;;</div><div class=\"line\">\tif [ $arch == &quot;x86_64&quot; ];then</div><div class=\"line\">\t\twget -c http://dl.wdlinux.cn:5180/soft/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm</div><div class=\"line\">\t\trpm -ivh rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm</div><div class=\"line\">\telse</div><div class=\"line\">\t\twget -c http://dl.wdlinux.cn:5180/soft/rpmforge-release-0.5.2-2.el6.rf.i686.rpm</div><div class=\"line\">\t\trpm -ivh rpmforge-release-0.5.2-2.el6.rf.i686.rpm</div><div class=\"line\">\tfi</div><div class=\"line\">\tyum install -y mhash-devel libmcrypt-devel</div><div class=\"line\">else</div><div class=\"line\">\techo</div><div class=\"line\">\techo &quot;The current system does not support&quot;</div><div class=\"line\">\techo</div><div class=\"line\">\texit</div><div class=\"line\">fi</div><div class=\"line\">wget -c http://dl.wdlinux.cn:5180/rpms/$RF</div><div class=\"line\">rpm -ivh $RF --nodeps</div><div class=\"line\">I_F=$?</div><div class=\"line\">if [ $I_F == 0 ];then</div><div class=\"line\">\techo</div><div class=\"line\">fi</div><div class=\"line\">in_check $I_F lanmp_wdcp</div><div class=\"line\"></div><div class=\"line\">rm -f wdcp_v*</div><div class=\"line\">wget -c http://down.wdlinux.cn/down/wdcp_v2.5.tar.gz &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\">tar zxvf wdcp_v2.5.tar.gz -C / &gt; /dev/null 2&gt;&amp;1</div><div class=\"line\"></div><div class=\"line\">in_finsh</div></pre></td></tr></table></figure>\n"},{"title":"Tomcat(1) java.lang.OutOfMemoryError","id":"117","updated":"2017-04-21T05:19:42.000Z","date":"2016-11-28T18:19:38.000Z","_content":"\n\n### 1. 什么是 *PermGen space* ?\nPermGen space的全称是Permanent Generation space，是指内存的永久保存区域，这块内存主要是被JVM存放Class和Meta信息的，Class在被Loader时就会被放到PermGen space中，它和存放类实例(Instance)的Heap区域不同，GC(Garbage Collection)不会在主程序运行期对PermGen space进行清理，所以如果你的应用中有很CLASS的话，就很可能出现PermGen space错误，这种错误常见在web服务器对JSP进行pre compile的时候。如果你的WEB APP下都用了大量的第三方jar，其大小超过了jvm默认的大小(4M)那么就会产生此错误信息了。\n\n### 2. 解决方法\n##### 2.1 手动设置MaxPermSize大小\n```\n# 修改$TOMCAT_HOME/bin/catalina.sh，在“echo \"Using CATALINA_BASE:   $CATALINA_BASE\"”上面加入以下行：\nJAVA_OPTS=\"-server -Xms256m -Xmx512m -XX:PermSize=64M -XX:MaxPermSize=128m\"\n```\n\n### 3. Java heap space\n#### 解释：\nHeap size 设置\nJVM堆的设置是指java程序运行过程中JVM可以调配使用的内存空间的设置.JVM在启动的时候会自动设置Heap size的值，其初始空间(即-Xms)是物理内存的1/64，最大空间(-Xmx)是物理内存的1/4。可以利用JVM提供的-Xmn -Xms -Xmx等选项可进行设置。Heap size 的大小是Young Generation 和Tenured Generaion 之和。\n\n* 提示：在JVM中如果98％的时间是用于GC且可用的Heap size 不足2％的时候将抛出此异常信息。\n* 提示：Heap Size 最大不要超过可用物理内存的80％，一般的要将-Xms和-Xmx选项设置为相同，而-Xmn为1/4的-Xmx值。\n\n> 修改设置方法如PermGen space\n","source":"_posts/Tomcat-1-java-lang-OutOfMemoryError.md","raw":"---\ntitle: Tomcat(1) java.lang.OutOfMemoryError\ntags: 'Tomcat'\ncategories: 'Tomcat'\npermalink: tomcat-error-java-lang-outofmemoryerror\nid: 117\nupdated: '2017-04-21 13:19:42'\ndate: 2016-11-29 02:19:38\n---\n\n\n### 1. 什么是 *PermGen space* ?\nPermGen space的全称是Permanent Generation space，是指内存的永久保存区域，这块内存主要是被JVM存放Class和Meta信息的，Class在被Loader时就会被放到PermGen space中，它和存放类实例(Instance)的Heap区域不同，GC(Garbage Collection)不会在主程序运行期对PermGen space进行清理，所以如果你的应用中有很CLASS的话，就很可能出现PermGen space错误，这种错误常见在web服务器对JSP进行pre compile的时候。如果你的WEB APP下都用了大量的第三方jar，其大小超过了jvm默认的大小(4M)那么就会产生此错误信息了。\n\n### 2. 解决方法\n##### 2.1 手动设置MaxPermSize大小\n```\n# 修改$TOMCAT_HOME/bin/catalina.sh，在“echo \"Using CATALINA_BASE:   $CATALINA_BASE\"”上面加入以下行：\nJAVA_OPTS=\"-server -Xms256m -Xmx512m -XX:PermSize=64M -XX:MaxPermSize=128m\"\n```\n\n### 3. Java heap space\n#### 解释：\nHeap size 设置\nJVM堆的设置是指java程序运行过程中JVM可以调配使用的内存空间的设置.JVM在启动的时候会自动设置Heap size的值，其初始空间(即-Xms)是物理内存的1/64，最大空间(-Xmx)是物理内存的1/4。可以利用JVM提供的-Xmn -Xms -Xmx等选项可进行设置。Heap size 的大小是Young Generation 和Tenured Generaion 之和。\n\n* 提示：在JVM中如果98％的时间是用于GC且可用的Heap size 不足2％的时候将抛出此异常信息。\n* 提示：Heap Size 最大不要超过可用物理内存的80％，一般的要将-Xms和-Xmx选项设置为相同，而-Xmn为1/4的-Xmx值。\n\n> 修改设置方法如PermGen space\n","slug":"tomcat-error-java-lang-outofmemoryerror","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqca006141tp2wmamoru","content":"<h3 id=\"1-什么是-PermGen-space\"><a href=\"#1-什么是-PermGen-space\" class=\"headerlink\" title=\"1. 什么是 PermGen space ?\"></a>1. 什么是 <em>PermGen space</em> ?</h3><p>PermGen space的全称是Permanent Generation space，是指内存的永久保存区域，这块内存主要是被JVM存放Class和Meta信息的，Class在被Loader时就会被放到PermGen space中，它和存放类实例(Instance)的Heap区域不同，GC(Garbage Collection)不会在主程序运行期对PermGen space进行清理，所以如果你的应用中有很CLASS的话，就很可能出现PermGen space错误，这种错误常见在web服务器对JSP进行pre compile的时候。如果你的WEB APP下都用了大量的第三方jar，其大小超过了jvm默认的大小(4M)那么就会产生此错误信息了。</p>\n<h3 id=\"2-解决方法\"><a href=\"#2-解决方法\" class=\"headerlink\" title=\"2. 解决方法\"></a>2. 解决方法</h3><h5 id=\"2-1-手动设置MaxPermSize大小\"><a href=\"#2-1-手动设置MaxPermSize大小\" class=\"headerlink\" title=\"2.1 手动设置MaxPermSize大小\"></a>2.1 手动设置MaxPermSize大小</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改$TOMCAT_HOME/bin/catalina.sh，在“echo &quot;Using CATALINA_BASE:   $CATALINA_BASE&quot;”上面加入以下行：</div><div class=\"line\">JAVA_OPTS=&quot;-server -Xms256m -Xmx512m -XX:PermSize=64M -XX:MaxPermSize=128m&quot;</div></pre></td></tr></table></figure>\n<h3 id=\"3-Java-heap-space\"><a href=\"#3-Java-heap-space\" class=\"headerlink\" title=\"3. Java heap space\"></a>3. Java heap space</h3><h4 id=\"解释：\"><a href=\"#解释：\" class=\"headerlink\" title=\"解释：\"></a>解释：</h4><p>Heap size 设置<br>JVM堆的设置是指java程序运行过程中JVM可以调配使用的内存空间的设置.JVM在启动的时候会自动设置Heap size的值，其初始空间(即-Xms)是物理内存的1/64，最大空间(-Xmx)是物理内存的1/4。可以利用JVM提供的-Xmn -Xms -Xmx等选项可进行设置。Heap size 的大小是Young Generation 和Tenured Generaion 之和。</p>\n<ul>\n<li>提示：在JVM中如果98％的时间是用于GC且可用的Heap size 不足2％的时候将抛出此异常信息。</li>\n<li>提示：Heap Size 最大不要超过可用物理内存的80％，一般的要将-Xms和-Xmx选项设置为相同，而-Xmn为1/4的-Xmx值。</li>\n</ul>\n<blockquote>\n<p>修改设置方法如PermGen space</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"1-什么是-PermGen-space\"><a href=\"#1-什么是-PermGen-space\" class=\"headerlink\" title=\"1. 什么是 PermGen space ?\"></a>1. 什么是 <em>PermGen space</em> ?</h3><p>PermGen space的全称是Permanent Generation space，是指内存的永久保存区域，这块内存主要是被JVM存放Class和Meta信息的，Class在被Loader时就会被放到PermGen space中，它和存放类实例(Instance)的Heap区域不同，GC(Garbage Collection)不会在主程序运行期对PermGen space进行清理，所以如果你的应用中有很CLASS的话，就很可能出现PermGen space错误，这种错误常见在web服务器对JSP进行pre compile的时候。如果你的WEB APP下都用了大量的第三方jar，其大小超过了jvm默认的大小(4M)那么就会产生此错误信息了。</p>\n<h3 id=\"2-解决方法\"><a href=\"#2-解决方法\" class=\"headerlink\" title=\"2. 解决方法\"></a>2. 解决方法</h3><h5 id=\"2-1-手动设置MaxPermSize大小\"><a href=\"#2-1-手动设置MaxPermSize大小\" class=\"headerlink\" title=\"2.1 手动设置MaxPermSize大小\"></a>2.1 手动设置MaxPermSize大小</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改$TOMCAT_HOME/bin/catalina.sh，在“echo &quot;Using CATALINA_BASE:   $CATALINA_BASE&quot;”上面加入以下行：</div><div class=\"line\">JAVA_OPTS=&quot;-server -Xms256m -Xmx512m -XX:PermSize=64M -XX:MaxPermSize=128m&quot;</div></pre></td></tr></table></figure>\n<h3 id=\"3-Java-heap-space\"><a href=\"#3-Java-heap-space\" class=\"headerlink\" title=\"3. Java heap space\"></a>3. Java heap space</h3><h4 id=\"解释：\"><a href=\"#解释：\" class=\"headerlink\" title=\"解释：\"></a>解释：</h4><p>Heap size 设置<br>JVM堆的设置是指java程序运行过程中JVM可以调配使用的内存空间的设置.JVM在启动的时候会自动设置Heap size的值，其初始空间(即-Xms)是物理内存的1/64，最大空间(-Xmx)是物理内存的1/4。可以利用JVM提供的-Xmn -Xms -Xmx等选项可进行设置。Heap size 的大小是Young Generation 和Tenured Generaion 之和。</p>\n<ul>\n<li>提示：在JVM中如果98％的时间是用于GC且可用的Heap size 不足2％的时候将抛出此异常信息。</li>\n<li>提示：Heap Size 最大不要超过可用物理内存的80％，一般的要将-Xms和-Xmx选项设置为相同，而-Xmn为1/4的-Xmx值。</li>\n</ul>\n<blockquote>\n<p>修改设置方法如PermGen space</p>\n</blockquote>\n"},{"title":"Tomcat(2) 利用JDK自身keytool实现HTTPS","id":"119","updated":"2017-04-21T05:18:31.000Z","date":"2016-12-03T10:41:13.000Z","_content":"\n因为一个偶然机会，想把自己的webserver通过https加密访问，这里就采用JDK自带的keytool工具实现，tomcat官方也推荐这种方式，英文好的同学走这里：[官方配置](https://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html)\n\n> demo: CentOS 6.6 & Tomcat 7 & JDK 1.7\n\n#### 1. 生成 keystore\n```\n[root@test conf]# keytool -genkey -v -alias tomcat -keyalg RSA -keystore mykeystore\nEnter keystore password:              #设置密码\nRe-enter new password:                #重复一次\nWhat is your first and last name?\n  [Unknown]:  Alex Lu                #随便填\nWhat is the name of your organizational unit?\n  [Unknown]:  visionet                #随便填\nWhat is the name of your organization?\n  [Unknown]:  visionet                #随便填\nWhat is the name of your City or Locality?\n  [Unknown]:  SH                #随便填\nWhat is the name of your State or Province?\n  [Unknown]:  SH                #随便填\nWhat is the two-letter country code for this unit?\n  [Unknown]:  ZH                #随便填\nIs CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH correct?\n  [no]:  Y                    #这里要Y，确认前面信息。\n\nGenerating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA) with a validity of 90 days\n    for: CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH\nEnter key password for <tomcat>\n    (RETURN if same as keystore password):        #默认回车即可，不需要设置太多密码\n[Storing mykeystore]\n[root@test conf]# ls\nCatalina  catalina.policy  catalina.properties  context.xml  logging.properties  mykeystore  server.xml  tomcat-users.xml  web.xml\n```\n>  注意：-keystore是用来指定keystore保存位置，如果不加参数默认保存的当前用户家目录为~/.keystore\n       -validity 可以用来指定证书有效期，单位为天，缺省值为90天。\n\n#### 2. 备份$tomcatdir/conf/server.xml\n```\ncp $tomcatdir/conf/server.xml $tomcatdir/conf/server.xml\n```\n\n#### 3. 修改server.xml\n###### a. 注释以下：（tomcat注释用：<\\!\\-\\- XXXX \\-\\-\\> ）,如何也想保留http访问，可以不注释\n```\n<!--\n<Connector executor=\"tomcatThreadPool\"\n                port=\"80\" protocol=\"HTTP/1.1\"\n                connectionTimeout=\"20000\"\n                redirectPort=\"8443\" />\n-->\n```\n###### b. 取消下面注释\n```\n<Connector port=\"443\" protocol=\"HTTP/1.1\" SSLEnabled=\"true\"\n                maxThreads=\"150\" scheme=\"https\" secure=\"true\"\n                clientAuth=\"false\" sslProtocol=\"TLS\" />\n```\n###### c. 增加keystoreFile和keystorePass\n```\n<Connector port=\"443\" protocol=\"HTTP/1.1\" SSLEnabled=\"true\"\n               maxThreads=\"150\" scheme=\"https\" secure=\"true\"\n               clientAuth=\"false\" sslProtocol=\"TLS\"\n               keystoreFile=\"conf/mykeystore\" keystorePass=\"123456\"/>\n```\n> keystoreFile=跟keystore文件位置\n> keystorePass=跟当时keytool命令执行时输入的密码\n\n\n#### 4. 重启tomcat\n```\n[root@test conf]# ../bin/catalina.sh stop && ../bin/catalina.sh start\nUsing CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44\nUsing CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44\nUsing CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp\nUsing JRE_HOME:        /home/pms/jdk1.7.0_65\nUsing CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar\nUsing CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44\nUsing CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44\nUsing CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp\nUsing JRE_HOME:        /home/pms/jdk1.7.0_65\nUsing CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar\n[root@test conf]# netstat -ntlup | grep -e \"80\\|443\"\ntcp        0      0 0.0.0.0:80         0.0.0.0:*          LISTEN      21960/java\ntcp        0      0 0.0.0.0:443        0.0.0.0:*          LISTEN      21960/java\ntcp        0      0 127.0.0.1:8005     0.0.0.0:*          LISTEN      21960/java\ntcp        0      0 0.0.0.0:8009       0.0.0.0:*          LISTEN      21960/java\n[root@test conf]#\n```\n\nOK !\n","source":"_posts/Tomcat-2-利用JDK自身keytool实现HTTPS.md","raw":"---\ntitle: Tomcat(2) 利用JDK自身keytool实现HTTPS\ntags: 'Tomcat'\ncategories: 'Tomcat'\npermalink: tomcat-keytool-https\nid: 119\nupdated: '2017-04-21 13:18:31'\ndate: 2016-12-03 18:41:13\n---\n\n因为一个偶然机会，想把自己的webserver通过https加密访问，这里就采用JDK自带的keytool工具实现，tomcat官方也推荐这种方式，英文好的同学走这里：[官方配置](https://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html)\n\n> demo: CentOS 6.6 & Tomcat 7 & JDK 1.7\n\n#### 1. 生成 keystore\n```\n[root@test conf]# keytool -genkey -v -alias tomcat -keyalg RSA -keystore mykeystore\nEnter keystore password:              #设置密码\nRe-enter new password:                #重复一次\nWhat is your first and last name?\n  [Unknown]:  Alex Lu                #随便填\nWhat is the name of your organizational unit?\n  [Unknown]:  visionet                #随便填\nWhat is the name of your organization?\n  [Unknown]:  visionet                #随便填\nWhat is the name of your City or Locality?\n  [Unknown]:  SH                #随便填\nWhat is the name of your State or Province?\n  [Unknown]:  SH                #随便填\nWhat is the two-letter country code for this unit?\n  [Unknown]:  ZH                #随便填\nIs CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH correct?\n  [no]:  Y                    #这里要Y，确认前面信息。\n\nGenerating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA) with a validity of 90 days\n    for: CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH\nEnter key password for <tomcat>\n    (RETURN if same as keystore password):        #默认回车即可，不需要设置太多密码\n[Storing mykeystore]\n[root@test conf]# ls\nCatalina  catalina.policy  catalina.properties  context.xml  logging.properties  mykeystore  server.xml  tomcat-users.xml  web.xml\n```\n>  注意：-keystore是用来指定keystore保存位置，如果不加参数默认保存的当前用户家目录为~/.keystore\n       -validity 可以用来指定证书有效期，单位为天，缺省值为90天。\n\n#### 2. 备份$tomcatdir/conf/server.xml\n```\ncp $tomcatdir/conf/server.xml $tomcatdir/conf/server.xml\n```\n\n#### 3. 修改server.xml\n###### a. 注释以下：（tomcat注释用：<\\!\\-\\- XXXX \\-\\-\\> ）,如何也想保留http访问，可以不注释\n```\n<!--\n<Connector executor=\"tomcatThreadPool\"\n                port=\"80\" protocol=\"HTTP/1.1\"\n                connectionTimeout=\"20000\"\n                redirectPort=\"8443\" />\n-->\n```\n###### b. 取消下面注释\n```\n<Connector port=\"443\" protocol=\"HTTP/1.1\" SSLEnabled=\"true\"\n                maxThreads=\"150\" scheme=\"https\" secure=\"true\"\n                clientAuth=\"false\" sslProtocol=\"TLS\" />\n```\n###### c. 增加keystoreFile和keystorePass\n```\n<Connector port=\"443\" protocol=\"HTTP/1.1\" SSLEnabled=\"true\"\n               maxThreads=\"150\" scheme=\"https\" secure=\"true\"\n               clientAuth=\"false\" sslProtocol=\"TLS\"\n               keystoreFile=\"conf/mykeystore\" keystorePass=\"123456\"/>\n```\n> keystoreFile=跟keystore文件位置\n> keystorePass=跟当时keytool命令执行时输入的密码\n\n\n#### 4. 重启tomcat\n```\n[root@test conf]# ../bin/catalina.sh stop && ../bin/catalina.sh start\nUsing CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44\nUsing CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44\nUsing CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp\nUsing JRE_HOME:        /home/pms/jdk1.7.0_65\nUsing CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar\nUsing CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44\nUsing CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44\nUsing CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp\nUsing JRE_HOME:        /home/pms/jdk1.7.0_65\nUsing CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar\n[root@test conf]# netstat -ntlup | grep -e \"80\\|443\"\ntcp        0      0 0.0.0.0:80         0.0.0.0:*          LISTEN      21960/java\ntcp        0      0 0.0.0.0:443        0.0.0.0:*          LISTEN      21960/java\ntcp        0      0 127.0.0.1:8005     0.0.0.0:*          LISTEN      21960/java\ntcp        0      0 0.0.0.0:8009       0.0.0.0:*          LISTEN      21960/java\n[root@test conf]#\n```\n\nOK !\n","slug":"tomcat-keytool-https","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqcd006541tpacvj7ebz","content":"<p>因为一个偶然机会，想把自己的webserver通过https加密访问，这里就采用JDK自带的keytool工具实现，tomcat官方也推荐这种方式，英文好的同学走这里：<a href=\"https://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html\" target=\"_blank\" rel=\"external\">官方配置</a></p>\n<blockquote>\n<p>demo: CentOS 6.6 &amp; Tomcat 7 &amp; JDK 1.7</p>\n</blockquote>\n<h4 id=\"1-生成-keystore\"><a href=\"#1-生成-keystore\" class=\"headerlink\" title=\"1. 生成 keystore\"></a>1. 生成 keystore</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test conf]# keytool -genkey -v -alias tomcat -keyalg RSA -keystore mykeystore</div><div class=\"line\">Enter keystore password:              #设置密码</div><div class=\"line\">Re-enter new password:                #重复一次</div><div class=\"line\">What is your first and last name?</div><div class=\"line\">  [Unknown]:  Alex Lu                #随便填</div><div class=\"line\">What is the name of your organizational unit?</div><div class=\"line\">  [Unknown]:  visionet                #随便填</div><div class=\"line\">What is the name of your organization?</div><div class=\"line\">  [Unknown]:  visionet                #随便填</div><div class=\"line\">What is the name of your City or Locality?</div><div class=\"line\">  [Unknown]:  SH                #随便填</div><div class=\"line\">What is the name of your State or Province?</div><div class=\"line\">  [Unknown]:  SH                #随便填</div><div class=\"line\">What is the two-letter country code for this unit?</div><div class=\"line\">  [Unknown]:  ZH                #随便填</div><div class=\"line\">Is CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH correct?</div><div class=\"line\">  [no]:  Y                    #这里要Y，确认前面信息。</div><div class=\"line\"></div><div class=\"line\">Generating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA) with a validity of 90 days</div><div class=\"line\">    for: CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH</div><div class=\"line\">Enter key password for &lt;tomcat&gt;</div><div class=\"line\">    (RETURN if same as keystore password):        #默认回车即可，不需要设置太多密码</div><div class=\"line\">[Storing mykeystore]</div><div class=\"line\">[root@test conf]# ls</div><div class=\"line\">Catalina  catalina.policy  catalina.properties  context.xml  logging.properties  mykeystore  server.xml  tomcat-users.xml  web.xml</div></pre></td></tr></table></figure>\n<blockquote>\n<p> 注意：-keystore是用来指定keystore保存位置，如果不加参数默认保存的当前用户家目录为~/.keystore<br>       -validity 可以用来指定证书有效期，单位为天，缺省值为90天。</p>\n</blockquote>\n<h4 id=\"2-备份-tomcatdir-conf-server-xml\"><a href=\"#2-备份-tomcatdir-conf-server-xml\" class=\"headerlink\" title=\"2. 备份$tomcatdir/conf/server.xml\"></a>2. 备份$tomcatdir/conf/server.xml</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp $tomcatdir/conf/server.xml $tomcatdir/conf/server.xml</div></pre></td></tr></table></figure>\n<h4 id=\"3-修改server-xml\"><a href=\"#3-修改server-xml\" class=\"headerlink\" title=\"3. 修改server.xml\"></a>3. 修改server.xml</h4><h6 id=\"a-注释以下：（tomcat注释用：-lt-XXXX-）-如何也想保留http访问，可以不注释\"><a href=\"#a-注释以下：（tomcat注释用：-lt-XXXX-）-如何也想保留http访问，可以不注释\" class=\"headerlink\" title=\"a. 注释以下：（tomcat注释用：&lt;!-- XXXX --> ）,如何也想保留http访问，可以不注释\"></a>a. 注释以下：（tomcat注释用：&lt;!-- XXXX --> ）,如何也想保留http访问，可以不注释</h6><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!--</div><div class=\"line\">&lt;Connector executor=&quot;tomcatThreadPool&quot;</div><div class=\"line\">                port=&quot;80&quot; protocol=&quot;HTTP/1.1&quot;</div><div class=\"line\">                connectionTimeout=&quot;20000&quot;</div><div class=\"line\">                redirectPort=&quot;8443&quot; /&gt;</div><div class=\"line\">--&gt;</div></pre></td></tr></table></figure>\n<h6 id=\"b-取消下面注释\"><a href=\"#b-取消下面注释\" class=\"headerlink\" title=\"b. 取消下面注释\"></a>b. 取消下面注释</h6><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;Connector port=&quot;443&quot; protocol=&quot;HTTP/1.1&quot; SSLEnabled=&quot;true&quot;</div><div class=\"line\">                maxThreads=&quot;150&quot; scheme=&quot;https&quot; secure=&quot;true&quot;</div><div class=\"line\">                clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; /&gt;</div></pre></td></tr></table></figure>\n<h6 id=\"c-增加keystoreFile和keystorePass\"><a href=\"#c-增加keystoreFile和keystorePass\" class=\"headerlink\" title=\"c. 增加keystoreFile和keystorePass\"></a>c. 增加keystoreFile和keystorePass</h6><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;Connector port=&quot;443&quot; protocol=&quot;HTTP/1.1&quot; SSLEnabled=&quot;true&quot;</div><div class=\"line\">               maxThreads=&quot;150&quot; scheme=&quot;https&quot; secure=&quot;true&quot;</div><div class=\"line\">               clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot;</div><div class=\"line\">               keystoreFile=&quot;conf/mykeystore&quot; keystorePass=&quot;123456&quot;/&gt;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>keystoreFile=跟keystore文件位置<br>keystorePass=跟当时keytool命令执行时输入的密码</p>\n</blockquote>\n<h4 id=\"4-重启tomcat\"><a href=\"#4-重启tomcat\" class=\"headerlink\" title=\"4. 重启tomcat\"></a>4. 重启tomcat</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test conf]# ../bin/catalina.sh stop &amp;&amp; ../bin/catalina.sh start</div><div class=\"line\">Using CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44</div><div class=\"line\">Using CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44</div><div class=\"line\">Using CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp</div><div class=\"line\">Using JRE_HOME:        /home/pms/jdk1.7.0_65</div><div class=\"line\">Using CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar</div><div class=\"line\">Using CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44</div><div class=\"line\">Using CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44</div><div class=\"line\">Using CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp</div><div class=\"line\">Using JRE_HOME:        /home/pms/jdk1.7.0_65</div><div class=\"line\">Using CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar</div><div class=\"line\">[root@test conf]# netstat -ntlup | grep -e &quot;80\\|443&quot;</div><div class=\"line\">tcp        0      0 0.0.0.0:80         0.0.0.0:*          LISTEN      21960/java</div><div class=\"line\">tcp        0      0 0.0.0.0:443        0.0.0.0:*          LISTEN      21960/java</div><div class=\"line\">tcp        0      0 127.0.0.1:8005     0.0.0.0:*          LISTEN      21960/java</div><div class=\"line\">tcp        0      0 0.0.0.0:8009       0.0.0.0:*          LISTEN      21960/java</div><div class=\"line\">[root@test conf]#</div></pre></td></tr></table></figure>\n<p>OK !</p>\n","site":{"data":{}},"excerpt":"","more":"<p>因为一个偶然机会，想把自己的webserver通过https加密访问，这里就采用JDK自带的keytool工具实现，tomcat官方也推荐这种方式，英文好的同学走这里：<a href=\"https://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html\">官方配置</a></p>\n<blockquote>\n<p>demo: CentOS 6.6 &amp; Tomcat 7 &amp; JDK 1.7</p>\n</blockquote>\n<h4 id=\"1-生成-keystore\"><a href=\"#1-生成-keystore\" class=\"headerlink\" title=\"1. 生成 keystore\"></a>1. 生成 keystore</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test conf]# keytool -genkey -v -alias tomcat -keyalg RSA -keystore mykeystore</div><div class=\"line\">Enter keystore password:              #设置密码</div><div class=\"line\">Re-enter new password:                #重复一次</div><div class=\"line\">What is your first and last name?</div><div class=\"line\">  [Unknown]:  Alex Lu                #随便填</div><div class=\"line\">What is the name of your organizational unit?</div><div class=\"line\">  [Unknown]:  visionet                #随便填</div><div class=\"line\">What is the name of your organization?</div><div class=\"line\">  [Unknown]:  visionet                #随便填</div><div class=\"line\">What is the name of your City or Locality?</div><div class=\"line\">  [Unknown]:  SH                #随便填</div><div class=\"line\">What is the name of your State or Province?</div><div class=\"line\">  [Unknown]:  SH                #随便填</div><div class=\"line\">What is the two-letter country code for this unit?</div><div class=\"line\">  [Unknown]:  ZH                #随便填</div><div class=\"line\">Is CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH correct?</div><div class=\"line\">  [no]:  Y                    #这里要Y，确认前面信息。</div><div class=\"line\"></div><div class=\"line\">Generating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA) with a validity of 90 days</div><div class=\"line\">    for: CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH</div><div class=\"line\">Enter key password for &lt;tomcat&gt;</div><div class=\"line\">    (RETURN if same as keystore password):        #默认回车即可，不需要设置太多密码</div><div class=\"line\">[Storing mykeystore]</div><div class=\"line\">[root@test conf]# ls</div><div class=\"line\">Catalina  catalina.policy  catalina.properties  context.xml  logging.properties  mykeystore  server.xml  tomcat-users.xml  web.xml</div></pre></td></tr></table></figure>\n<blockquote>\n<p> 注意：-keystore是用来指定keystore保存位置，如果不加参数默认保存的当前用户家目录为~/.keystore<br>       -validity 可以用来指定证书有效期，单位为天，缺省值为90天。</p>\n</blockquote>\n<h4 id=\"2-备份-tomcatdir-conf-server-xml\"><a href=\"#2-备份-tomcatdir-conf-server-xml\" class=\"headerlink\" title=\"2. 备份$tomcatdir/conf/server.xml\"></a>2. 备份$tomcatdir/conf/server.xml</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp $tomcatdir/conf/server.xml $tomcatdir/conf/server.xml</div></pre></td></tr></table></figure>\n<h4 id=\"3-修改server-xml\"><a href=\"#3-修改server-xml\" class=\"headerlink\" title=\"3. 修改server.xml\"></a>3. 修改server.xml</h4><h6 id=\"a-注释以下：（tomcat注释用：-lt-XXXX-）-如何也想保留http访问，可以不注释\"><a href=\"#a-注释以下：（tomcat注释用：-lt-XXXX-）-如何也想保留http访问，可以不注释\" class=\"headerlink\" title=\"a. 注释以下：（tomcat注释用：&lt;!-- XXXX --> ）,如何也想保留http访问，可以不注释\"></a>a. 注释以下：（tomcat注释用：&lt;!-- XXXX --> ）,如何也想保留http访问，可以不注释</h6><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!--</div><div class=\"line\">&lt;Connector executor=&quot;tomcatThreadPool&quot;</div><div class=\"line\">                port=&quot;80&quot; protocol=&quot;HTTP/1.1&quot;</div><div class=\"line\">                connectionTimeout=&quot;20000&quot;</div><div class=\"line\">                redirectPort=&quot;8443&quot; /&gt;</div><div class=\"line\">--&gt;</div></pre></td></tr></table></figure>\n<h6 id=\"b-取消下面注释\"><a href=\"#b-取消下面注释\" class=\"headerlink\" title=\"b. 取消下面注释\"></a>b. 取消下面注释</h6><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;Connector port=&quot;443&quot; protocol=&quot;HTTP/1.1&quot; SSLEnabled=&quot;true&quot;</div><div class=\"line\">                maxThreads=&quot;150&quot; scheme=&quot;https&quot; secure=&quot;true&quot;</div><div class=\"line\">                clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; /&gt;</div></pre></td></tr></table></figure>\n<h6 id=\"c-增加keystoreFile和keystorePass\"><a href=\"#c-增加keystoreFile和keystorePass\" class=\"headerlink\" title=\"c. 增加keystoreFile和keystorePass\"></a>c. 增加keystoreFile和keystorePass</h6><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;Connector port=&quot;443&quot; protocol=&quot;HTTP/1.1&quot; SSLEnabled=&quot;true&quot;</div><div class=\"line\">               maxThreads=&quot;150&quot; scheme=&quot;https&quot; secure=&quot;true&quot;</div><div class=\"line\">               clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot;</div><div class=\"line\">               keystoreFile=&quot;conf/mykeystore&quot; keystorePass=&quot;123456&quot;/&gt;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>keystoreFile=跟keystore文件位置<br>keystorePass=跟当时keytool命令执行时输入的密码</p>\n</blockquote>\n<h4 id=\"4-重启tomcat\"><a href=\"#4-重启tomcat\" class=\"headerlink\" title=\"4. 重启tomcat\"></a>4. 重启tomcat</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test conf]# ../bin/catalina.sh stop &amp;&amp; ../bin/catalina.sh start</div><div class=\"line\">Using CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44</div><div class=\"line\">Using CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44</div><div class=\"line\">Using CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp</div><div class=\"line\">Using JRE_HOME:        /home/pms/jdk1.7.0_65</div><div class=\"line\">Using CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar</div><div class=\"line\">Using CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44</div><div class=\"line\">Using CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44</div><div class=\"line\">Using CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp</div><div class=\"line\">Using JRE_HOME:        /home/pms/jdk1.7.0_65</div><div class=\"line\">Using CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar</div><div class=\"line\">[root@test conf]# netstat -ntlup | grep -e &quot;80\\|443&quot;</div><div class=\"line\">tcp        0      0 0.0.0.0:80         0.0.0.0:*          LISTEN      21960/java</div><div class=\"line\">tcp        0      0 0.0.0.0:443        0.0.0.0:*          LISTEN      21960/java</div><div class=\"line\">tcp        0      0 127.0.0.1:8005     0.0.0.0:*          LISTEN      21960/java</div><div class=\"line\">tcp        0      0 0.0.0.0:8009       0.0.0.0:*          LISTEN      21960/java</div><div class=\"line\">[root@test conf]#</div></pre></td></tr></table></figure>\n<p>OK !</p>\n"},{"title":"Tomcat(3) 优化设定","id":"58","updated":"2017-04-21T05:28:19.000Z","date":"2016-06-15T18:28:35.000Z","_content":"\n- 设置JVM空间大小，Xms和Xmx一样大：JVM初始分配的内存由-Xms指定，默认是物理内存的1/64；JVM最大分配的内存由-Xmx指定，默认是物理内存的1/4。默认空余堆内存小于 40%时，JVM就会增大堆直到-Xmx的最大限制；空余堆内存大于70%时，JVM会减少堆直到-Xms的最小限制。因此服务器一般设置-Xms、 -Xmx相等以避免在每次GC 后调整堆的大小。\n- 关闭dns查询\n- 增加线程数量\n- maxThreads、acceptCount ： 增加并发，同时增加这两个的数量\n- 内存优化 ： /tomcatbin/catalina.sh\n\n- JAVA_OPTS=\"-XX:PermSize=64M -XX:MaxPermSize=128m -Xms512m -Xmx1024m -Duser.timezone=Asia/Shanghai\"\n- 缓存优化\n- 并发优化，线程优化\n- <Connector port=\"80\" protocol=\"HTTP/1.1\" maxThreads=\"600\" minSpareThreads=\"100\" maxSpareThreads=\"500\" acceptCount=\"700\"\n- connectionTimeout=\"20000\" redirectPort=\"8443\" />\n- 关闭DNS查询 :修改server.xml文件中的Connector元素，修改属性enableLookups参数值: enableLookups=\"false\"\n- 使用apr插件，提高tomcat响应时间 <br>\n```\n  (1)安装APR tomcat-native\n    apr-1.3.8.tar.gz   安装在/usr/local/apr\n    #tar zxvf apr-1.3.8.tar.gz\n    #cd apr-1.3.8\n    #./configure;make;make install\n\n    apr-util-1.3.9.tar.gz  安装在/usr/local/apr/lib\n    #tar zxvf apr-util-1.3.9.tar.gz\n    #cd apr-util-1.3.9\n    #./configure --with-apr=/usr/local/apr ----with-java-home=JDK;make;make install\n\n    #cd apache-tomcat-6.0.20/bin\n    #tar zxvf tomcat-native.tar.gz\n    #cd tomcat-native/jni/native\n    #./configure --with-apr=/usr/local/apr;make;make install\n\n  (2)设置 Tomcat 整合 APR\n    修改 tomcat 的启动 shell （startup.sh），在该文件中加入启动参数：\n      CATALINA_OPTS=\"$CATALINA_OPTS -Djava.library.path=/usr/local/apr/lib\" 。\n\n  (3)判断安装成功:\n    如果看到下面的启动日志，表示成功。\n      2007-4-26 15:34:32 org.apache.coyote.http11.Http11AprProtocol init\n```\n- 开启manager 管理\n- 使用http://visualvm.Java.net/download.html 工具监控tomcat的性能\n- JAVA_OPTS='-Dcom.sun.management.jmxremote.port=8999 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false'\n- 设置自动更新autodeploy＝false\n","source":"_posts/Tomcat-3-优化设定.md","raw":"---\ntitle: Tomcat(3) 优化设定\ntags: 'Tomcat'\ncategories: 'Tomcat'\npermalink: apache-tomcat-you-hua-she-ding-yi\nid: 58\nupdated: '2017-04-21 13:28:19'\ndate: 2016-06-16 02:28:35\n---\n\n- 设置JVM空间大小，Xms和Xmx一样大：JVM初始分配的内存由-Xms指定，默认是物理内存的1/64；JVM最大分配的内存由-Xmx指定，默认是物理内存的1/4。默认空余堆内存小于 40%时，JVM就会增大堆直到-Xmx的最大限制；空余堆内存大于70%时，JVM会减少堆直到-Xms的最小限制。因此服务器一般设置-Xms、 -Xmx相等以避免在每次GC 后调整堆的大小。\n- 关闭dns查询\n- 增加线程数量\n- maxThreads、acceptCount ： 增加并发，同时增加这两个的数量\n- 内存优化 ： /tomcatbin/catalina.sh\n\n- JAVA_OPTS=\"-XX:PermSize=64M -XX:MaxPermSize=128m -Xms512m -Xmx1024m -Duser.timezone=Asia/Shanghai\"\n- 缓存优化\n- 并发优化，线程优化\n- <Connector port=\"80\" protocol=\"HTTP/1.1\" maxThreads=\"600\" minSpareThreads=\"100\" maxSpareThreads=\"500\" acceptCount=\"700\"\n- connectionTimeout=\"20000\" redirectPort=\"8443\" />\n- 关闭DNS查询 :修改server.xml文件中的Connector元素，修改属性enableLookups参数值: enableLookups=\"false\"\n- 使用apr插件，提高tomcat响应时间 <br>\n```\n  (1)安装APR tomcat-native\n    apr-1.3.8.tar.gz   安装在/usr/local/apr\n    #tar zxvf apr-1.3.8.tar.gz\n    #cd apr-1.3.8\n    #./configure;make;make install\n\n    apr-util-1.3.9.tar.gz  安装在/usr/local/apr/lib\n    #tar zxvf apr-util-1.3.9.tar.gz\n    #cd apr-util-1.3.9\n    #./configure --with-apr=/usr/local/apr ----with-java-home=JDK;make;make install\n\n    #cd apache-tomcat-6.0.20/bin\n    #tar zxvf tomcat-native.tar.gz\n    #cd tomcat-native/jni/native\n    #./configure --with-apr=/usr/local/apr;make;make install\n\n  (2)设置 Tomcat 整合 APR\n    修改 tomcat 的启动 shell （startup.sh），在该文件中加入启动参数：\n      CATALINA_OPTS=\"$CATALINA_OPTS -Djava.library.path=/usr/local/apr/lib\" 。\n\n  (3)判断安装成功:\n    如果看到下面的启动日志，表示成功。\n      2007-4-26 15:34:32 org.apache.coyote.http11.Http11AprProtocol init\n```\n- 开启manager 管理\n- 使用http://visualvm.Java.net/download.html 工具监控tomcat的性能\n- JAVA_OPTS='-Dcom.sun.management.jmxremote.port=8999 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false'\n- 设置自动更新autodeploy＝false\n","slug":"apache-tomcat-you-hua-she-ding-yi","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqci006941tpcg7n4dw9","content":"<ul>\n<li>设置JVM空间大小，Xms和Xmx一样大：JVM初始分配的内存由-Xms指定，默认是物理内存的1/64；JVM最大分配的内存由-Xmx指定，默认是物理内存的1/4。默认空余堆内存小于 40%时，JVM就会增大堆直到-Xmx的最大限制；空余堆内存大于70%时，JVM会减少堆直到-Xms的最小限制。因此服务器一般设置-Xms、 -Xmx相等以避免在每次GC 后调整堆的大小。</li>\n<li>关闭dns查询</li>\n<li>增加线程数量</li>\n<li>maxThreads、acceptCount ： 增加并发，同时增加这两个的数量</li>\n<li><p>内存优化 ： /tomcatbin/catalina.sh</p>\n</li>\n<li><p>JAVA_OPTS=”-XX:PermSize=64M -XX:MaxPermSize=128m -Xms512m -Xmx1024m -Duser.timezone=Asia/Shanghai”</p>\n</li>\n<li>缓存优化</li>\n<li>并发优化，线程优化</li>\n<li>&lt;Connector port=”80” protocol=”HTTP/1.1” maxThreads=”600” minSpareThreads=”100” maxSpareThreads=”500” acceptCount=”700”</li>\n<li>connectionTimeout=”20000” redirectPort=”8443” /&gt;</li>\n<li>关闭DNS查询 :修改server.xml文件中的Connector元素，修改属性enableLookups参数值: enableLookups=”false”</li>\n<li><p>使用apr插件，提高tomcat响应时间 <br></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1)安装APR tomcat-native</div><div class=\"line\">  apr-1.3.8.tar.gz   安装在/usr/local/apr</div><div class=\"line\">  #tar zxvf apr-1.3.8.tar.gz</div><div class=\"line\">  #cd apr-1.3.8</div><div class=\"line\">  #./configure;make;make install</div><div class=\"line\"></div><div class=\"line\">  apr-util-1.3.9.tar.gz  安装在/usr/local/apr/lib</div><div class=\"line\">  #tar zxvf apr-util-1.3.9.tar.gz</div><div class=\"line\">  #cd apr-util-1.3.9</div><div class=\"line\">  #./configure --with-apr=/usr/local/apr ----with-java-home=JDK;make;make install</div><div class=\"line\"></div><div class=\"line\">  #cd apache-tomcat-6.0.20/bin</div><div class=\"line\">  #tar zxvf tomcat-native.tar.gz</div><div class=\"line\">  #cd tomcat-native/jni/native</div><div class=\"line\">  #./configure --with-apr=/usr/local/apr;make;make install</div><div class=\"line\"></div><div class=\"line\">(2)设置 Tomcat 整合 APR</div><div class=\"line\">  修改 tomcat 的启动 shell （startup.sh），在该文件中加入启动参数：</div><div class=\"line\">    CATALINA_OPTS=&quot;$CATALINA_OPTS -Djava.library.path=/usr/local/apr/lib&quot; 。</div><div class=\"line\"></div><div class=\"line\">(3)判断安装成功:</div><div class=\"line\">  如果看到下面的启动日志，表示成功。</div><div class=\"line\">    2007-4-26 15:34:32 org.apache.coyote.http11.Http11AprProtocol init</div></pre></td></tr></table></figure>\n</li>\n<li><p>开启manager 管理</p>\n</li>\n<li>使用<a href=\"http://visualvm.Java.net/download.html\" target=\"_blank\" rel=\"external\">http://visualvm.Java.net/download.html</a> 工具监控tomcat的性能</li>\n<li>JAVA_OPTS=’-Dcom.sun.management.jmxremote.port=8999 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false’</li>\n<li>设置自动更新autodeploy＝false</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li>设置JVM空间大小，Xms和Xmx一样大：JVM初始分配的内存由-Xms指定，默认是物理内存的1/64；JVM最大分配的内存由-Xmx指定，默认是物理内存的1/4。默认空余堆内存小于 40%时，JVM就会增大堆直到-Xmx的最大限制；空余堆内存大于70%时，JVM会减少堆直到-Xms的最小限制。因此服务器一般设置-Xms、 -Xmx相等以避免在每次GC 后调整堆的大小。</li>\n<li>关闭dns查询</li>\n<li>增加线程数量</li>\n<li>maxThreads、acceptCount ： 增加并发，同时增加这两个的数量</li>\n<li><p>内存优化 ： /tomcatbin/catalina.sh</p>\n</li>\n<li><p>JAVA_OPTS=”-XX:PermSize=64M -XX:MaxPermSize=128m -Xms512m -Xmx1024m -Duser.timezone=Asia/Shanghai”</p>\n</li>\n<li>缓存优化</li>\n<li>并发优化，线程优化</li>\n<li>&lt;Connector port=”80” protocol=”HTTP/1.1” maxThreads=”600” minSpareThreads=”100” maxSpareThreads=”500” acceptCount=”700”</li>\n<li>connectionTimeout=”20000” redirectPort=”8443” /&gt;</li>\n<li>关闭DNS查询 :修改server.xml文件中的Connector元素，修改属性enableLookups参数值: enableLookups=”false”</li>\n<li><p>使用apr插件，提高tomcat响应时间 <br></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1)安装APR tomcat-native</div><div class=\"line\">  apr-1.3.8.tar.gz   安装在/usr/local/apr</div><div class=\"line\">  #tar zxvf apr-1.3.8.tar.gz</div><div class=\"line\">  #cd apr-1.3.8</div><div class=\"line\">  #./configure;make;make install</div><div class=\"line\"></div><div class=\"line\">  apr-util-1.3.9.tar.gz  安装在/usr/local/apr/lib</div><div class=\"line\">  #tar zxvf apr-util-1.3.9.tar.gz</div><div class=\"line\">  #cd apr-util-1.3.9</div><div class=\"line\">  #./configure --with-apr=/usr/local/apr ----with-java-home=JDK;make;make install</div><div class=\"line\"></div><div class=\"line\">  #cd apache-tomcat-6.0.20/bin</div><div class=\"line\">  #tar zxvf tomcat-native.tar.gz</div><div class=\"line\">  #cd tomcat-native/jni/native</div><div class=\"line\">  #./configure --with-apr=/usr/local/apr;make;make install</div><div class=\"line\"></div><div class=\"line\">(2)设置 Tomcat 整合 APR</div><div class=\"line\">  修改 tomcat 的启动 shell （startup.sh），在该文件中加入启动参数：</div><div class=\"line\">    CATALINA_OPTS=&quot;$CATALINA_OPTS -Djava.library.path=/usr/local/apr/lib&quot; 。</div><div class=\"line\"></div><div class=\"line\">(3)判断安装成功:</div><div class=\"line\">  如果看到下面的启动日志，表示成功。</div><div class=\"line\">    2007-4-26 15:34:32 org.apache.coyote.http11.Http11AprProtocol init</div></pre></td></tr></table></figure>\n</li>\n<li><p>开启manager 管理</p>\n</li>\n<li>使用<a href=\"http://visualvm.Java.net/download.html\">http://visualvm.Java.net/download.html</a> 工具监控tomcat的性能</li>\n<li>JAVA_OPTS=’-Dcom.sun.management.jmxremote.port=8999 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false’</li>\n<li>设置自动更新autodeploy＝false</li>\n</ul>\n"},{"title":"香香公主","id":"10023","date":"2015-11-03T16:34:54.000Z","_content":"\n​       我喜欢你。\n\n​       不知道从什么时候开始，我好像慢慢多注意你，今天是红色衣裳，今天衣服很漂亮；今天有点不开心，今天好像很开心，过完年换了新发型，高跟鞋身边踢踏踢踏的声响好像是你；有时候早上上班电梯口遇见你，后面就经常想今天是不是还能遇见你；你认真工作，你皱起的眉头，你温柔地笑容，见不到你时想你在哪里，见到你时又极力掩饰不愿被人察觉的喜欢；就这样，不知不觉，好像你的份量一点点在增加，终于增加到占满了我所有心思，你知不知道你笑起来的样子好美，让人不忍心去打搅这一份美好。\n\n​       总会回想起很多美好，在泰国，在大象园，在寺庙，在科技馆的玩耍，最好的是在夜市，那是我最难忘怀的一段时光，当时多希望时间可以慢点，如果可以一直和你走下去，我永远不会觉得那条街那么长，就在那个时候我明白我喜欢上你了，多么美好的感觉。\n\n> 斯人若彩虹，遇上方知有。\n\n​       这是对你说，我谈过一次不长的恋爱，最后是和平分手，挺伤心的，我觉得很难再找到一个喜欢的人；直到遇见了你，喜欢你，我才明白，人生那么长，总有一个合适的人值得你等待，我一直不敢去说去表现，自卑的情绪一直很重，你在我心里是女神，我觉得上帝一定是和我开了个玩笑，送了一个这么美好的你在我身边，却让我如此平庸无奇，真的是让人喜欢的不要不要的，却又不敢上前。\n\n​       和你聊到电影，就恨不得把所有好的电影资源找给你，单独做成收藏夹，还问朋友有什么好看的电影资源，被别人一顿嘲笑啊。你知道么？第一次和你出去看电影我有多紧张，问朋友在人广哪里有适合带女神去的？之前做了很多功课，星期六一大早去买衣服，回来赶紧去理发，路上一直在知乎找：第一次和喜欢的女孩约会攻略？应该注意什么细节？第一次约会千万不要做的事，云云~,最后还是在公交上堵住了，当时心里真的像热锅上的蚂蚁，但是那天很开心，我觉得这一切都是值得的，可以和喜欢的人在一起，已经是很大的运气了，记得你喜欢吃巧克力，所以那天还有一个预备项目到人广一家手工巧克力店里。\n\n​       今晚我也没预料到会对你表白，当时脑子糊涂说了一大堆胡话，那些不是我想的，我想过很多种对你表白的方式，而不是这种，我喜欢你，并不是告诉你一句话就完了，我想成为你生命中守护你的人，也希望你喜欢我，现在不喜欢没关系，我会努力，让你喜欢我；我还做了好多好多的功课，这些计划里面都有你的存在。\n\n​       人生的道路上十分艰辛，而我希望，在今后的人生里，我能有幸陪伴在你的左右。\n","source":"_posts/Xiang-Xiang-Gong-Zhu.md","raw":"---\ntitle: 香香公主\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: XIANG-XIANG-GONG-ZHU\nid: 10023\ndate: 2015-11-04 00:34:54\n---\n\n​       我喜欢你。\n\n​       不知道从什么时候开始，我好像慢慢多注意你，今天是红色衣裳，今天衣服很漂亮；今天有点不开心，今天好像很开心，过完年换了新发型，高跟鞋身边踢踏踢踏的声响好像是你；有时候早上上班电梯口遇见你，后面就经常想今天是不是还能遇见你；你认真工作，你皱起的眉头，你温柔地笑容，见不到你时想你在哪里，见到你时又极力掩饰不愿被人察觉的喜欢；就这样，不知不觉，好像你的份量一点点在增加，终于增加到占满了我所有心思，你知不知道你笑起来的样子好美，让人不忍心去打搅这一份美好。\n\n​       总会回想起很多美好，在泰国，在大象园，在寺庙，在科技馆的玩耍，最好的是在夜市，那是我最难忘怀的一段时光，当时多希望时间可以慢点，如果可以一直和你走下去，我永远不会觉得那条街那么长，就在那个时候我明白我喜欢上你了，多么美好的感觉。\n\n> 斯人若彩虹，遇上方知有。\n\n​       这是对你说，我谈过一次不长的恋爱，最后是和平分手，挺伤心的，我觉得很难再找到一个喜欢的人；直到遇见了你，喜欢你，我才明白，人生那么长，总有一个合适的人值得你等待，我一直不敢去说去表现，自卑的情绪一直很重，你在我心里是女神，我觉得上帝一定是和我开了个玩笑，送了一个这么美好的你在我身边，却让我如此平庸无奇，真的是让人喜欢的不要不要的，却又不敢上前。\n\n​       和你聊到电影，就恨不得把所有好的电影资源找给你，单独做成收藏夹，还问朋友有什么好看的电影资源，被别人一顿嘲笑啊。你知道么？第一次和你出去看电影我有多紧张，问朋友在人广哪里有适合带女神去的？之前做了很多功课，星期六一大早去买衣服，回来赶紧去理发，路上一直在知乎找：第一次和喜欢的女孩约会攻略？应该注意什么细节？第一次约会千万不要做的事，云云~,最后还是在公交上堵住了，当时心里真的像热锅上的蚂蚁，但是那天很开心，我觉得这一切都是值得的，可以和喜欢的人在一起，已经是很大的运气了，记得你喜欢吃巧克力，所以那天还有一个预备项目到人广一家手工巧克力店里。\n\n​       今晚我也没预料到会对你表白，当时脑子糊涂说了一大堆胡话，那些不是我想的，我想过很多种对你表白的方式，而不是这种，我喜欢你，并不是告诉你一句话就完了，我想成为你生命中守护你的人，也希望你喜欢我，现在不喜欢没关系，我会努力，让你喜欢我；我还做了好多好多的功课，这些计划里面都有你的存在。\n\n​       人生的道路上十分艰辛，而我希望，在今后的人生里，我能有幸陪伴在你的左右。\n","slug":"XIANG-XIANG-GONG-ZHU","published":1,"updated":"2017-04-24T14:32:22.571Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqcl006c41tp9e8phryp","content":"<p>​       我喜欢你。</p>\n<p>​       不知道从什么时候开始，我好像慢慢多注意你，今天是红色衣裳，今天衣服很漂亮；今天有点不开心，今天好像很开心，过完年换了新发型，高跟鞋身边踢踏踢踏的声响好像是你；有时候早上上班电梯口遇见你，后面就经常想今天是不是还能遇见你；你认真工作，你皱起的眉头，你温柔地笑容，见不到你时想你在哪里，见到你时又极力掩饰不愿被人察觉的喜欢；就这样，不知不觉，好像你的份量一点点在增加，终于增加到占满了我所有心思，你知不知道你笑起来的样子好美，让人不忍心去打搅这一份美好。</p>\n<p>​       总会回想起很多美好，在泰国，在大象园，在寺庙，在科技馆的玩耍，最好的是在夜市，那是我最难忘怀的一段时光，当时多希望时间可以慢点，如果可以一直和你走下去，我永远不会觉得那条街那么长，就在那个时候我明白我喜欢上你了，多么美好的感觉。</p>\n<blockquote>\n<p>斯人若彩虹，遇上方知有。</p>\n</blockquote>\n<p>​       这是对你说，我谈过一次不长的恋爱，最后是和平分手，挺伤心的，我觉得很难再找到一个喜欢的人；直到遇见了你，喜欢你，我才明白，人生那么长，总有一个合适的人值得你等待，我一直不敢去说去表现，自卑的情绪一直很重，你在我心里是女神，我觉得上帝一定是和我开了个玩笑，送了一个这么美好的你在我身边，却让我如此平庸无奇，真的是让人喜欢的不要不要的，却又不敢上前。</p>\n<p>​       和你聊到电影，就恨不得把所有好的电影资源找给你，单独做成收藏夹，还问朋友有什么好看的电影资源，被别人一顿嘲笑啊。你知道么？第一次和你出去看电影我有多紧张，问朋友在人广哪里有适合带女神去的？之前做了很多功课，星期六一大早去买衣服，回来赶紧去理发，路上一直在知乎找：第一次和喜欢的女孩约会攻略？应该注意什么细节？第一次约会千万不要做的事，云云~,最后还是在公交上堵住了，当时心里真的像热锅上的蚂蚁，但是那天很开心，我觉得这一切都是值得的，可以和喜欢的人在一起，已经是很大的运气了，记得你喜欢吃巧克力，所以那天还有一个预备项目到人广一家手工巧克力店里。</p>\n<p>​       今晚我也没预料到会对你表白，当时脑子糊涂说了一大堆胡话，那些不是我想的，我想过很多种对你表白的方式，而不是这种，我喜欢你，并不是告诉你一句话就完了，我想成为你生命中守护你的人，也希望你喜欢我，现在不喜欢没关系，我会努力，让你喜欢我；我还做了好多好多的功课，这些计划里面都有你的存在。</p>\n<p>​       人生的道路上十分艰辛，而我希望，在今后的人生里，我能有幸陪伴在你的左右。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>​       我喜欢你。</p>\n<p>​       不知道从什么时候开始，我好像慢慢多注意你，今天是红色衣裳，今天衣服很漂亮；今天有点不开心，今天好像很开心，过完年换了新发型，高跟鞋身边踢踏踢踏的声响好像是你；有时候早上上班电梯口遇见你，后面就经常想今天是不是还能遇见你；你认真工作，你皱起的眉头，你温柔地笑容，见不到你时想你在哪里，见到你时又极力掩饰不愿被人察觉的喜欢；就这样，不知不觉，好像你的份量一点点在增加，终于增加到占满了我所有心思，你知不知道你笑起来的样子好美，让人不忍心去打搅这一份美好。</p>\n<p>​       总会回想起很多美好，在泰国，在大象园，在寺庙，在科技馆的玩耍，最好的是在夜市，那是我最难忘怀的一段时光，当时多希望时间可以慢点，如果可以一直和你走下去，我永远不会觉得那条街那么长，就在那个时候我明白我喜欢上你了，多么美好的感觉。</p>\n<blockquote>\n<p>斯人若彩虹，遇上方知有。</p>\n</blockquote>\n<p>​       这是对你说，我谈过一次不长的恋爱，最后是和平分手，挺伤心的，我觉得很难再找到一个喜欢的人；直到遇见了你，喜欢你，我才明白，人生那么长，总有一个合适的人值得你等待，我一直不敢去说去表现，自卑的情绪一直很重，你在我心里是女神，我觉得上帝一定是和我开了个玩笑，送了一个这么美好的你在我身边，却让我如此平庸无奇，真的是让人喜欢的不要不要的，却又不敢上前。</p>\n<p>​       和你聊到电影，就恨不得把所有好的电影资源找给你，单独做成收藏夹，还问朋友有什么好看的电影资源，被别人一顿嘲笑啊。你知道么？第一次和你出去看电影我有多紧张，问朋友在人广哪里有适合带女神去的？之前做了很多功课，星期六一大早去买衣服，回来赶紧去理发，路上一直在知乎找：第一次和喜欢的女孩约会攻略？应该注意什么细节？第一次约会千万不要做的事，云云~,最后还是在公交上堵住了，当时心里真的像热锅上的蚂蚁，但是那天很开心，我觉得这一切都是值得的，可以和喜欢的人在一起，已经是很大的运气了，记得你喜欢吃巧克力，所以那天还有一个预备项目到人广一家手工巧克力店里。</p>\n<p>​       今晚我也没预料到会对你表白，当时脑子糊涂说了一大堆胡话，那些不是我想的，我想过很多种对你表白的方式，而不是这种，我喜欢你，并不是告诉你一句话就完了，我想成为你生命中守护你的人，也希望你喜欢我，现在不喜欢没关系，我会努力，让你喜欢我；我还做了好多好多的功课，这些计划里面都有你的存在。</p>\n<p>​       人生的道路上十分艰辛，而我希望，在今后的人生里，我能有幸陪伴在你的左右。</p>\n"},{"title":"Yum中$releasever和$basearch的取值","id":"73","updated":"2017-04-21T05:25:01.000Z","date":"2016-07-27T02:27:54.000Z","_content":"\n#### 查看/etc/yum.repos.d/CentOS-Base.repo\n\n```\n[base]\nname=CentOS-$releasever - Base\nmirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os&infra=$infra\n#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6\n```\n\n<p>其实在日常使用之中，我们在很多地方，特别是脚本内看到了调用<code>$releasever</code>和<code>$basearch</code></p>\n\n1. $releasever的值,这个表示当前系统的发行版本\n\n```\n[root@ultraera /]# rpm -qi centos-release\nName        : centos-release               Relocations: (not relocatable)\nVersion     : 6                                 Vendor: CentOS\nRelease     : 7.el6.centos.12.3             Build Date: Tue 04 Aug 2015 12:13:46 AM CST\nInstall Date: Sat 21 May 2016 03:31:27 AM CST      Build Host: c6b9.bsys.dev.centos.org\nGroup       : System Environment/Base       Source RPM: centos-release-6-7.el6.centos.12.3.src.rpm\nSize        : 35634                            License: GPLv2\nSignature   : RSA/SHA1, Tue 04 Aug 2015 12:15:08 AM CST, Key ID 0946fca2c105b9de\nPackager    : CentOS BuildSystem <http://bugs.centos.org>\nSummary     : CentOS release file\nDescription :\nCentOS release files\n\n# 其中Version 6 就是我们的版本号\n```\n\n2. $basearch是我们的系统硬件架构(CPU指令集),就是我们常说的i386\\i486\\i586\\i686\\\n\n```\n[root@ultraera /]# arch\ni386\n```\n但是，当我在命令行查看是却发现<code>$releasever</code>和<code>$basearch</code>是空的。\n<br>\nGoogle 一下之后，说明Yum变量的说明可以在这里（5.3.3. Using Yum Variables）找到，说明如下：\n>5.3.3. Using Yum Variables\n\nYou can use and reference the following built-in variables in yum commands and in all Yum configuration files (that is, /etc/yum.conf and all .repo files in the /etc/yum.repos.d/ directory):\n\n$releasever<br>\nYou can use this variable to reference the release version of Red Hat Enterprise Linux. Yum obtains the value of $releasever from the distroverpkg=value line in the /etc/yum.conf configuration file. If there is no such line in /etc/yum.conf, then yum infers the correct value by deriving the version number from the redhat-release package.\n\n$arch<br>\nYou can use this variable to refer to the system’s CPU architecture as returned when calling Python’s os.uname() function. Valid values for $arch include: i586, i686 and x86_64.\n\n$basearch<br>\nYou can use $basearch to reference the base architecture of the system. For example, i686 and i586 machines both have a base architecture of i386, and AMD64 and Intel64 machines have a base architecture of x86_64.\n\n$YUM0-9<br>\nThese ten variables are each replaced with the value of any shell environment variables with the same name. If one of these variables is referenced (in /etc/yum.conf for example) and a shell environment variable with the same name does not exist, then the configuration file variable is not replaced.\n\nTo define a custom variable or to override the value of an existing one, create a file with the same name as the variable (without the “$” sign) in the /etc/yum/vars/ directory, and add the desired value on its first line.\n\nFor example, repository descriptions often include the operating system name. To define a new variable called $osname, create a new file with “Red Hat Enterprise Linux” on the first line and save it as /etc/yum/vars/osname:\n\n<code>echo “Red Hat Enterprise Linux” > /etc/yum/vars/osname</code>\n\nInstead of “Red Hat Enterprise Linux 6”, you can now use the following in the .repo files: name=$osname $releasever\n\n文中说到$releasever的定义可以查看 /etc/yum.conf 文件的事distroverpkg=value 行，打开 /etc/yum.conf 看一下，默认文件（我的是CentOS 6）内容如下：\n\n```\n[main]\ncachedir=/var/cache/yum/$basearch/$releasever\nkeepcache=0\ndebuglevel=2\nlogfile=/var/log/yum.log\nexactarch=1\nobsoletes=1\ngpgcheck=1\nplugins=1\ninstallonly_limit=5\nbugtracker_url=http://bugs.centos.org/set_project.php?project_id=16&ref=http://bugs.centos.org/bug_report_page.php?category=yum\ndistroverpkg=centos-release\n```\n\ndistroverpkg=centos-release 代表什么？ 去哪找 centos-release 。找到这里我再一次表示困惑。\n不过另一篇文章进行了我的视野： yum的$releasever真是太反动了， 关键内空如下：<br>\n在 /etc/yum.repos.d/ 目录下的软件库定义文件中，常常会在 baseurl 的路径中提到 $releasever 这个变量，表示当前发行版的大版本号，但大家知道这个变量是在哪设置的吗？我 grep 了整个 etc 目录都没找到，还是看了 yum.conf 才知道的，是在 yum.conf 文件里 distroverpkg 选项定义的。但这个选项就很有问题：<br>\ndistroverpkg 和 releasever 名字不同，且看不出什么联系\ndistroverpkg 的值，并不是明文，而是“redhat-release”。不知道大家看到这个会有什么想法，反正我是首先想到了 /etc/redhat-release 文件，但我错了。实际上指的是 redhat-release 这个RPM包。所谓“distroverpkg=redhat-release”的意思，其实是将 $releasever 设置为 redhat-release 这个RPM包的版本号.\n\n#####  小结：<br>\nyum中的$releasever变量是取redhat-release-server rpm包的属性值( %{version})。\n[root@ldap01 ~]# rpm -q --qf %{version} redhat-release-server;echo\n6Server\n","source":"_posts/Yum中-releasever和-basearch的取值.md","raw":"---\ntitle: Yum中$releasever和$basearch的取值\ntags: 'Yum'\ncategories: 'CentOS'\npermalink: centosxia-yumzhong-releaseverhe-basearchde-qu-zhi\nid: 73\nupdated: '2017-04-21 13:25:01'\ndate: 2016-07-27 10:27:54\n---\n\n#### 查看/etc/yum.repos.d/CentOS-Base.repo\n\n```\n[base]\nname=CentOS-$releasever - Base\nmirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os&infra=$infra\n#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6\n```\n\n<p>其实在日常使用之中，我们在很多地方，特别是脚本内看到了调用<code>$releasever</code>和<code>$basearch</code></p>\n\n1. $releasever的值,这个表示当前系统的发行版本\n\n```\n[root@ultraera /]# rpm -qi centos-release\nName        : centos-release               Relocations: (not relocatable)\nVersion     : 6                                 Vendor: CentOS\nRelease     : 7.el6.centos.12.3             Build Date: Tue 04 Aug 2015 12:13:46 AM CST\nInstall Date: Sat 21 May 2016 03:31:27 AM CST      Build Host: c6b9.bsys.dev.centos.org\nGroup       : System Environment/Base       Source RPM: centos-release-6-7.el6.centos.12.3.src.rpm\nSize        : 35634                            License: GPLv2\nSignature   : RSA/SHA1, Tue 04 Aug 2015 12:15:08 AM CST, Key ID 0946fca2c105b9de\nPackager    : CentOS BuildSystem <http://bugs.centos.org>\nSummary     : CentOS release file\nDescription :\nCentOS release files\n\n# 其中Version 6 就是我们的版本号\n```\n\n2. $basearch是我们的系统硬件架构(CPU指令集),就是我们常说的i386\\i486\\i586\\i686\\\n\n```\n[root@ultraera /]# arch\ni386\n```\n但是，当我在命令行查看是却发现<code>$releasever</code>和<code>$basearch</code>是空的。\n<br>\nGoogle 一下之后，说明Yum变量的说明可以在这里（5.3.3. Using Yum Variables）找到，说明如下：\n>5.3.3. Using Yum Variables\n\nYou can use and reference the following built-in variables in yum commands and in all Yum configuration files (that is, /etc/yum.conf and all .repo files in the /etc/yum.repos.d/ directory):\n\n$releasever<br>\nYou can use this variable to reference the release version of Red Hat Enterprise Linux. Yum obtains the value of $releasever from the distroverpkg=value line in the /etc/yum.conf configuration file. If there is no such line in /etc/yum.conf, then yum infers the correct value by deriving the version number from the redhat-release package.\n\n$arch<br>\nYou can use this variable to refer to the system’s CPU architecture as returned when calling Python’s os.uname() function. Valid values for $arch include: i586, i686 and x86_64.\n\n$basearch<br>\nYou can use $basearch to reference the base architecture of the system. For example, i686 and i586 machines both have a base architecture of i386, and AMD64 and Intel64 machines have a base architecture of x86_64.\n\n$YUM0-9<br>\nThese ten variables are each replaced with the value of any shell environment variables with the same name. If one of these variables is referenced (in /etc/yum.conf for example) and a shell environment variable with the same name does not exist, then the configuration file variable is not replaced.\n\nTo define a custom variable or to override the value of an existing one, create a file with the same name as the variable (without the “$” sign) in the /etc/yum/vars/ directory, and add the desired value on its first line.\n\nFor example, repository descriptions often include the operating system name. To define a new variable called $osname, create a new file with “Red Hat Enterprise Linux” on the first line and save it as /etc/yum/vars/osname:\n\n<code>echo “Red Hat Enterprise Linux” > /etc/yum/vars/osname</code>\n\nInstead of “Red Hat Enterprise Linux 6”, you can now use the following in the .repo files: name=$osname $releasever\n\n文中说到$releasever的定义可以查看 /etc/yum.conf 文件的事distroverpkg=value 行，打开 /etc/yum.conf 看一下，默认文件（我的是CentOS 6）内容如下：\n\n```\n[main]\ncachedir=/var/cache/yum/$basearch/$releasever\nkeepcache=0\ndebuglevel=2\nlogfile=/var/log/yum.log\nexactarch=1\nobsoletes=1\ngpgcheck=1\nplugins=1\ninstallonly_limit=5\nbugtracker_url=http://bugs.centos.org/set_project.php?project_id=16&ref=http://bugs.centos.org/bug_report_page.php?category=yum\ndistroverpkg=centos-release\n```\n\ndistroverpkg=centos-release 代表什么？ 去哪找 centos-release 。找到这里我再一次表示困惑。\n不过另一篇文章进行了我的视野： yum的$releasever真是太反动了， 关键内空如下：<br>\n在 /etc/yum.repos.d/ 目录下的软件库定义文件中，常常会在 baseurl 的路径中提到 $releasever 这个变量，表示当前发行版的大版本号，但大家知道这个变量是在哪设置的吗？我 grep 了整个 etc 目录都没找到，还是看了 yum.conf 才知道的，是在 yum.conf 文件里 distroverpkg 选项定义的。但这个选项就很有问题：<br>\ndistroverpkg 和 releasever 名字不同，且看不出什么联系\ndistroverpkg 的值，并不是明文，而是“redhat-release”。不知道大家看到这个会有什么想法，反正我是首先想到了 /etc/redhat-release 文件，但我错了。实际上指的是 redhat-release 这个RPM包。所谓“distroverpkg=redhat-release”的意思，其实是将 $releasever 设置为 redhat-release 这个RPM包的版本号.\n\n#####  小结：<br>\nyum中的$releasever变量是取redhat-release-server rpm包的属性值( %{version})。\n[root@ldap01 ~]# rpm -q --qf %{version} redhat-release-server;echo\n6Server\n","slug":"centosxia-yumzhong-releaseverhe-basearchde-qu-zhi","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqco006h41tppdl2qmre","content":"<h4 id=\"查看-etc-yum-repos-d-CentOS-Base-repo\"><a href=\"#查看-etc-yum-repos-d-CentOS-Base-repo\" class=\"headerlink\" title=\"查看/etc/yum.repos.d/CentOS-Base.repo\"></a>查看/etc/yum.repos.d/CentOS-Base.repo</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[base]</div><div class=\"line\">name=CentOS-$releasever - Base</div><div class=\"line\">mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os&amp;infra=$infra</div><div class=\"line\">#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div></pre></td></tr></table></figure>\n<p>其实在日常使用之中，我们在很多地方，特别是脚本内看到了调用<code>$releasever</code>和<code>$basearch</code></p>\n\n<ol>\n<li>$releasever的值,这个表示当前系统的发行版本</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera /]# rpm -qi centos-release</div><div class=\"line\">Name        : centos-release               Relocations: (not relocatable)</div><div class=\"line\">Version     : 6                                 Vendor: CentOS</div><div class=\"line\">Release     : 7.el6.centos.12.3             Build Date: Tue 04 Aug 2015 12:13:46 AM CST</div><div class=\"line\">Install Date: Sat 21 May 2016 03:31:27 AM CST      Build Host: c6b9.bsys.dev.centos.org</div><div class=\"line\">Group       : System Environment/Base       Source RPM: centos-release-6-7.el6.centos.12.3.src.rpm</div><div class=\"line\">Size        : 35634                            License: GPLv2</div><div class=\"line\">Signature   : RSA/SHA1, Tue 04 Aug 2015 12:15:08 AM CST, Key ID 0946fca2c105b9de</div><div class=\"line\">Packager    : CentOS BuildSystem &lt;http://bugs.centos.org&gt;</div><div class=\"line\">Summary     : CentOS release file</div><div class=\"line\">Description :</div><div class=\"line\">CentOS release files</div><div class=\"line\"></div><div class=\"line\"># 其中Version 6 就是我们的版本号</div></pre></td></tr></table></figure>\n<ol>\n<li>$basearch是我们的系统硬件架构(CPU指令集),就是我们常说的i386\\i486\\i586\\i686\\</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera /]# arch</div><div class=\"line\">i386</div></pre></td></tr></table></figure>\n<p>但是，当我在命令行查看是却发现<code>$releasever</code>和<code>$basearch</code>是空的。<br><br><br>Google 一下之后，说明Yum变量的说明可以在这里（5.3.3. Using Yum Variables）找到，说明如下：</p>\n<blockquote>\n<p>5.3.3. Using Yum Variables</p>\n</blockquote>\n<p>You can use and reference the following built-in variables in yum commands and in all Yum configuration files (that is, /etc/yum.conf and all .repo files in the /etc/yum.repos.d/ directory):</p>\n<p>$releasever<br><br>You can use this variable to reference the release version of Red Hat Enterprise Linux. Yum obtains the value of $releasever from the distroverpkg=value line in the /etc/yum.conf configuration file. If there is no such line in /etc/yum.conf, then yum infers the correct value by deriving the version number from the redhat-release package.</p>\n<p>$arch<br><br>You can use this variable to refer to the system’s CPU architecture as returned when calling Python’s os.uname() function. Valid values for $arch include: i586, i686 and x86_64.</p>\n<p>$basearch<br><br>You can use $basearch to reference the base architecture of the system. For example, i686 and i586 machines both have a base architecture of i386, and AMD64 and Intel64 machines have a base architecture of x86_64.</p>\n<p>$YUM0-9<br><br>These ten variables are each replaced with the value of any shell environment variables with the same name. If one of these variables is referenced (in /etc/yum.conf for example) and a shell environment variable with the same name does not exist, then the configuration file variable is not replaced.</p>\n<p>To define a custom variable or to override the value of an existing one, create a file with the same name as the variable (without the “$” sign) in the /etc/yum/vars/ directory, and add the desired value on its first line.</p>\n<p>For example, repository descriptions often include the operating system name. To define a new variable called $osname, create a new file with “Red Hat Enterprise Linux” on the first line and save it as /etc/yum/vars/osname:</p>\n<p><code>echo “Red Hat Enterprise Linux” &gt; /etc/yum/vars/osname</code></p>\n<p>Instead of “Red Hat Enterprise Linux 6”, you can now use the following in the .repo files: name=$osname $releasever</p>\n<p>文中说到$releasever的定义可以查看 /etc/yum.conf 文件的事distroverpkg=value 行，打开 /etc/yum.conf 看一下，默认文件（我的是CentOS 6）内容如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[main]</div><div class=\"line\">cachedir=/var/cache/yum/$basearch/$releasever</div><div class=\"line\">keepcache=0</div><div class=\"line\">debuglevel=2</div><div class=\"line\">logfile=/var/log/yum.log</div><div class=\"line\">exactarch=1</div><div class=\"line\">obsoletes=1</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">plugins=1</div><div class=\"line\">installonly_limit=5</div><div class=\"line\">bugtracker_url=http://bugs.centos.org/set_project.php?project_id=16&amp;ref=http://bugs.centos.org/bug_report_page.php?category=yum</div><div class=\"line\">distroverpkg=centos-release</div></pre></td></tr></table></figure>\n<p>distroverpkg=centos-release 代表什么？ 去哪找 centos-release 。找到这里我再一次表示困惑。<br>不过另一篇文章进行了我的视野： yum的$releasever真是太反动了， 关键内空如下：<br><br>在 /etc/yum.repos.d/ 目录下的软件库定义文件中，常常会在 baseurl 的路径中提到 $releasever 这个变量，表示当前发行版的大版本号，但大家知道这个变量是在哪设置的吗？我 grep 了整个 etc 目录都没找到，还是看了 yum.conf 才知道的，是在 yum.conf 文件里 distroverpkg 选项定义的。但这个选项就很有问题：<br><br>distroverpkg 和 releasever 名字不同，且看不出什么联系<br>distroverpkg 的值，并不是明文，而是“redhat-release”。不知道大家看到这个会有什么想法，反正我是首先想到了 /etc/redhat-release 文件，但我错了。实际上指的是 redhat-release 这个RPM包。所谓“distroverpkg=redhat-release”的意思，其实是将 $releasever 设置为 redhat-release 这个RPM包的版本号.</p>\n<h5 id=\"小结：\"><a href=\"#小结：\" class=\"headerlink\" title=\"小结：\"></a>小结：<br></h5><p>yum中的$releasever变量是取redhat-release-server rpm包的属性值( %{version})。<br>[root@ldap01 ~]# rpm -q –qf %{version} redhat-release-server;echo<br>6Server</p>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"查看-etc-yum-repos-d-CentOS-Base-repo\"><a href=\"#查看-etc-yum-repos-d-CentOS-Base-repo\" class=\"headerlink\" title=\"查看/etc/yum.repos.d/CentOS-Base.repo\"></a>查看/etc/yum.repos.d/CentOS-Base.repo</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[base]</div><div class=\"line\">name=CentOS-$releasever - Base</div><div class=\"line\">mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os&amp;infra=$infra</div><div class=\"line\">#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div></pre></td></tr></table></figure>\n<p>其实在日常使用之中，我们在很多地方，特别是脚本内看到了调用<code>$releasever</code>和<code>$basearch</code></p>\n\n<ol>\n<li>$releasever的值,这个表示当前系统的发行版本</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera /]# rpm -qi centos-release</div><div class=\"line\">Name        : centos-release               Relocations: (not relocatable)</div><div class=\"line\">Version     : 6                                 Vendor: CentOS</div><div class=\"line\">Release     : 7.el6.centos.12.3             Build Date: Tue 04 Aug 2015 12:13:46 AM CST</div><div class=\"line\">Install Date: Sat 21 May 2016 03:31:27 AM CST      Build Host: c6b9.bsys.dev.centos.org</div><div class=\"line\">Group       : System Environment/Base       Source RPM: centos-release-6-7.el6.centos.12.3.src.rpm</div><div class=\"line\">Size        : 35634                            License: GPLv2</div><div class=\"line\">Signature   : RSA/SHA1, Tue 04 Aug 2015 12:15:08 AM CST, Key ID 0946fca2c105b9de</div><div class=\"line\">Packager    : CentOS BuildSystem &lt;http://bugs.centos.org&gt;</div><div class=\"line\">Summary     : CentOS release file</div><div class=\"line\">Description :</div><div class=\"line\">CentOS release files</div><div class=\"line\"></div><div class=\"line\"># 其中Version 6 就是我们的版本号</div></pre></td></tr></table></figure>\n<ol>\n<li>$basearch是我们的系统硬件架构(CPU指令集),就是我们常说的i386\\i486\\i586\\i686\\</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ultraera /]# arch</div><div class=\"line\">i386</div></pre></td></tr></table></figure>\n<p>但是，当我在命令行查看是却发现<code>$releasever</code>和<code>$basearch</code>是空的。<br><br><br>Google 一下之后，说明Yum变量的说明可以在这里（5.3.3. Using Yum Variables）找到，说明如下：</p>\n<blockquote>\n<p>5.3.3. Using Yum Variables</p>\n</blockquote>\n<p>You can use and reference the following built-in variables in yum commands and in all Yum configuration files (that is, /etc/yum.conf and all .repo files in the /etc/yum.repos.d/ directory):</p>\n<p>$releasever<br><br>You can use this variable to reference the release version of Red Hat Enterprise Linux. Yum obtains the value of $releasever from the distroverpkg=value line in the /etc/yum.conf configuration file. If there is no such line in /etc/yum.conf, then yum infers the correct value by deriving the version number from the redhat-release package.</p>\n<p>$arch<br><br>You can use this variable to refer to the system’s CPU architecture as returned when calling Python’s os.uname() function. Valid values for $arch include: i586, i686 and x86_64.</p>\n<p>$basearch<br><br>You can use $basearch to reference the base architecture of the system. For example, i686 and i586 machines both have a base architecture of i386, and AMD64 and Intel64 machines have a base architecture of x86_64.</p>\n<p>$YUM0-9<br><br>These ten variables are each replaced with the value of any shell environment variables with the same name. If one of these variables is referenced (in /etc/yum.conf for example) and a shell environment variable with the same name does not exist, then the configuration file variable is not replaced.</p>\n<p>To define a custom variable or to override the value of an existing one, create a file with the same name as the variable (without the “$” sign) in the /etc/yum/vars/ directory, and add the desired value on its first line.</p>\n<p>For example, repository descriptions often include the operating system name. To define a new variable called $osname, create a new file with “Red Hat Enterprise Linux” on the first line and save it as /etc/yum/vars/osname:</p>\n<p><code>echo “Red Hat Enterprise Linux” &gt; /etc/yum/vars/osname</code></p>\n<p>Instead of “Red Hat Enterprise Linux 6”, you can now use the following in the .repo files: name=$osname $releasever</p>\n<p>文中说到$releasever的定义可以查看 /etc/yum.conf 文件的事distroverpkg=value 行，打开 /etc/yum.conf 看一下，默认文件（我的是CentOS 6）内容如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[main]</div><div class=\"line\">cachedir=/var/cache/yum/$basearch/$releasever</div><div class=\"line\">keepcache=0</div><div class=\"line\">debuglevel=2</div><div class=\"line\">logfile=/var/log/yum.log</div><div class=\"line\">exactarch=1</div><div class=\"line\">obsoletes=1</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">plugins=1</div><div class=\"line\">installonly_limit=5</div><div class=\"line\">bugtracker_url=http://bugs.centos.org/set_project.php?project_id=16&amp;ref=http://bugs.centos.org/bug_report_page.php?category=yum</div><div class=\"line\">distroverpkg=centos-release</div></pre></td></tr></table></figure>\n<p>distroverpkg=centos-release 代表什么？ 去哪找 centos-release 。找到这里我再一次表示困惑。<br>不过另一篇文章进行了我的视野： yum的$releasever真是太反动了， 关键内空如下：<br><br>在 /etc/yum.repos.d/ 目录下的软件库定义文件中，常常会在 baseurl 的路径中提到 $releasever 这个变量，表示当前发行版的大版本号，但大家知道这个变量是在哪设置的吗？我 grep 了整个 etc 目录都没找到，还是看了 yum.conf 才知道的，是在 yum.conf 文件里 distroverpkg 选项定义的。但这个选项就很有问题：<br><br>distroverpkg 和 releasever 名字不同，且看不出什么联系<br>distroverpkg 的值，并不是明文，而是“redhat-release”。不知道大家看到这个会有什么想法，反正我是首先想到了 /etc/redhat-release 文件，但我错了。实际上指的是 redhat-release 这个RPM包。所谓“distroverpkg=redhat-release”的意思，其实是将 $releasever 设置为 redhat-release 这个RPM包的版本号.</p>\n<h5 id=\"小结：\"><a href=\"#小结：\" class=\"headerlink\" title=\"小结：\"></a>小结：<br></h5><p>yum中的$releasever变量是取redhat-release-server rpm包的属性值( %{version})。<br>[root@ldap01 ~]# rpm -q –qf %{version} redhat-release-server;echo<br>6Server</p>\n"},{"title":"Hello World","date":"2012-01-01T14:40:54.000Z","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2012-01-01 22:40:54\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","slug":"hello-world","published":1,"updated":"2017-04-24T15:01:16.305Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqcq006k41tpkowlki6t","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"external\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"external\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"external\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"external\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"external\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"external\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"external\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\">Deployment</a></p>\n"},{"title":"上海天冷了","id":"11","updated":"2017-04-21T05:19:29.000Z","date":"2016-12-17T14:40:54.000Z","_content":"\n上海天冷了啊！上海天冷了啊啊！！上海天冷了啊啊！！！\n\n重要的事情说三遍，这是一个好习惯，有了冬天的感觉，早上起床的时候有感觉，下班路上有感觉，现在坐在键盘前打字也很有感觉；前几天在微博上写了几句话:如今算是最好的季节，褪去夏日的燥热与汗渍，又不像冬日那么干冷凛冽，穿的衣服也是刚刚好，单条牛仔裤加个风衣或冲锋衣既藏住身上的赘肉，又不失潇洒，正是装逼好时节，而最最好的是这个季节的女子，美丽更胜其它季节。朋友嘲笑说其实想看黑丝，哈哈！谁知才过几天，就感受到了那种“干冷凛冽”。但是，我喜欢这种感觉，就像我喜欢这座城市，我说我喜欢冬天，自小就喜欢，我说我喜欢这座城市，就像自小就喜欢；我说不出来为什么喜欢，就像很多说不出来为什么喜欢，就像有些人，就像有些事，就像有些讨厌，人终是要顺了自己的心意，不然不会开心，但是要懂事，不懂事就不可爱了。\n\n<!-- more -->\n\n最近一直比较忙，弄得心烦意乱。\n\n生活上，最近外公有生病，母亲十分挂念，原本外公外婆年岁已高且身体不好，家里几位舅父却又不有作为，也令母亲十分苦恼，本来她身体也有不好，我却不能帮上她一二，内心也是颇为着急挂念，只能尽力安慰。说起外公外婆，也是难过不已，近两年，因些事每年都要回去两三趟，而又匆忙，故无多时间陪陪他们，外婆已多年卧病在床，起居生活全有外公照顾，我一次尝试想搀扶外婆起床，是异常艰难，可外公80多岁老人一扶就是8年多。有时，自己也想，若是自己到了这般年纪，该如何处置，想想也难过不已，想二位老人，到了这个年纪，早已不在乎吃穿用度如何如何，多年孤苦在家，更想要的子女多多陪伴，所以每次母亲打电话回去都哭泣不止；最怕“子欲养而亲不待”的事，我也劝说母亲有空就多多回老家陪陪，而母亲却担心我的婚娶生活，更令我难过不已，暗恨自己无用；昨今两日，父母又相继回老家，也希望外公身体早日恢复。\n\n工作上，自从去年与领导夸下豪言便一直不敢懈怠，但实际做下来的确是要比想象中困难许多，本来自己就不是聪明，这段时间做项目需求，改了许多稿总算通过，开心，感叹领导是好性格，如此耐心指导我；而前段时间，这个项目好几处也是几近失控，和其他公司的人沟通协调处理等一团糟，还好如今都渐回正轨；第一项目还未做完，就打退堂鼓，幸亏领导的指导，同事的帮助，当然还有我的好妹妹，每次感觉扛不住的找她聊聊发发牢骚，都能耐心听并给我加油打气。感谢这些人，当然也感谢自己，总有各种办法给自己恢复元气，今早，用思维导图把最近的烦心事要做的事全部写出来，然后一条一条的分析处理，最后恢复了好心情，又一如既往的工作生活。\n\n又23点过半了，要抓紧早睡了，调整正常作息才能更充沛的工作生活，记录走出了这一段不好的日子，恢复元气的自己，但是不能懈怠，毕竟“革命尚未成功，同志仍需努力”。\n","source":"_posts/上海天冷了.md","raw":"---\ntitle: 上海天冷了\ntags: '我给你讲个故事吧'\npermalink: shanghai-is-cold\nid: 11\nupdated: '2017-04-21 13:19:29'\ndate: 2016-12-17 22:40:54\n---\n\n上海天冷了啊！上海天冷了啊啊！！上海天冷了啊啊！！！\n\n重要的事情说三遍，这是一个好习惯，有了冬天的感觉，早上起床的时候有感觉，下班路上有感觉，现在坐在键盘前打字也很有感觉；前几天在微博上写了几句话:如今算是最好的季节，褪去夏日的燥热与汗渍，又不像冬日那么干冷凛冽，穿的衣服也是刚刚好，单条牛仔裤加个风衣或冲锋衣既藏住身上的赘肉，又不失潇洒，正是装逼好时节，而最最好的是这个季节的女子，美丽更胜其它季节。朋友嘲笑说其实想看黑丝，哈哈！谁知才过几天，就感受到了那种“干冷凛冽”。但是，我喜欢这种感觉，就像我喜欢这座城市，我说我喜欢冬天，自小就喜欢，我说我喜欢这座城市，就像自小就喜欢；我说不出来为什么喜欢，就像很多说不出来为什么喜欢，就像有些人，就像有些事，就像有些讨厌，人终是要顺了自己的心意，不然不会开心，但是要懂事，不懂事就不可爱了。\n\n<!-- more -->\n\n最近一直比较忙，弄得心烦意乱。\n\n生活上，最近外公有生病，母亲十分挂念，原本外公外婆年岁已高且身体不好，家里几位舅父却又不有作为，也令母亲十分苦恼，本来她身体也有不好，我却不能帮上她一二，内心也是颇为着急挂念，只能尽力安慰。说起外公外婆，也是难过不已，近两年，因些事每年都要回去两三趟，而又匆忙，故无多时间陪陪他们，外婆已多年卧病在床，起居生活全有外公照顾，我一次尝试想搀扶外婆起床，是异常艰难，可外公80多岁老人一扶就是8年多。有时，自己也想，若是自己到了这般年纪，该如何处置，想想也难过不已，想二位老人，到了这个年纪，早已不在乎吃穿用度如何如何，多年孤苦在家，更想要的子女多多陪伴，所以每次母亲打电话回去都哭泣不止；最怕“子欲养而亲不待”的事，我也劝说母亲有空就多多回老家陪陪，而母亲却担心我的婚娶生活，更令我难过不已，暗恨自己无用；昨今两日，父母又相继回老家，也希望外公身体早日恢复。\n\n工作上，自从去年与领导夸下豪言便一直不敢懈怠，但实际做下来的确是要比想象中困难许多，本来自己就不是聪明，这段时间做项目需求，改了许多稿总算通过，开心，感叹领导是好性格，如此耐心指导我；而前段时间，这个项目好几处也是几近失控，和其他公司的人沟通协调处理等一团糟，还好如今都渐回正轨；第一项目还未做完，就打退堂鼓，幸亏领导的指导，同事的帮助，当然还有我的好妹妹，每次感觉扛不住的找她聊聊发发牢骚，都能耐心听并给我加油打气。感谢这些人，当然也感谢自己，总有各种办法给自己恢复元气，今早，用思维导图把最近的烦心事要做的事全部写出来，然后一条一条的分析处理，最后恢复了好心情，又一如既往的工作生活。\n\n又23点过半了，要抓紧早睡了，调整正常作息才能更充沛的工作生活，记录走出了这一段不好的日子，恢复元气的自己，但是不能懈怠，毕竟“革命尚未成功，同志仍需努力”。\n","slug":"shanghai-is-cold","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqcu006p41tplbyunnkl","content":"<p>上海天冷了啊！上海天冷了啊啊！！上海天冷了啊啊！！！</p>\n<p>重要的事情说三遍，这是一个好习惯，有了冬天的感觉，早上起床的时候有感觉，下班路上有感觉，现在坐在键盘前打字也很有感觉；前几天在微博上写了几句话:如今算是最好的季节，褪去夏日的燥热与汗渍，又不像冬日那么干冷凛冽，穿的衣服也是刚刚好，单条牛仔裤加个风衣或冲锋衣既藏住身上的赘肉，又不失潇洒，正是装逼好时节，而最最好的是这个季节的女子，美丽更胜其它季节。朋友嘲笑说其实想看黑丝，哈哈！谁知才过几天，就感受到了那种“干冷凛冽”。但是，我喜欢这种感觉，就像我喜欢这座城市，我说我喜欢冬天，自小就喜欢，我说我喜欢这座城市，就像自小就喜欢；我说不出来为什么喜欢，就像很多说不出来为什么喜欢，就像有些人，就像有些事，就像有些讨厌，人终是要顺了自己的心意，不然不会开心，但是要懂事，不懂事就不可爱了。</p>\n<a id=\"more\"></a>\n<p>最近一直比较忙，弄得心烦意乱。</p>\n<p>生活上，最近外公有生病，母亲十分挂念，原本外公外婆年岁已高且身体不好，家里几位舅父却又不有作为，也令母亲十分苦恼，本来她身体也有不好，我却不能帮上她一二，内心也是颇为着急挂念，只能尽力安慰。说起外公外婆，也是难过不已，近两年，因些事每年都要回去两三趟，而又匆忙，故无多时间陪陪他们，外婆已多年卧病在床，起居生活全有外公照顾，我一次尝试想搀扶外婆起床，是异常艰难，可外公80多岁老人一扶就是8年多。有时，自己也想，若是自己到了这般年纪，该如何处置，想想也难过不已，想二位老人，到了这个年纪，早已不在乎吃穿用度如何如何，多年孤苦在家，更想要的子女多多陪伴，所以每次母亲打电话回去都哭泣不止；最怕“子欲养而亲不待”的事，我也劝说母亲有空就多多回老家陪陪，而母亲却担心我的婚娶生活，更令我难过不已，暗恨自己无用；昨今两日，父母又相继回老家，也希望外公身体早日恢复。</p>\n<p>工作上，自从去年与领导夸下豪言便一直不敢懈怠，但实际做下来的确是要比想象中困难许多，本来自己就不是聪明，这段时间做项目需求，改了许多稿总算通过，开心，感叹领导是好性格，如此耐心指导我；而前段时间，这个项目好几处也是几近失控，和其他公司的人沟通协调处理等一团糟，还好如今都渐回正轨；第一项目还未做完，就打退堂鼓，幸亏领导的指导，同事的帮助，当然还有我的好妹妹，每次感觉扛不住的找她聊聊发发牢骚，都能耐心听并给我加油打气。感谢这些人，当然也感谢自己，总有各种办法给自己恢复元气，今早，用思维导图把最近的烦心事要做的事全部写出来，然后一条一条的分析处理，最后恢复了好心情，又一如既往的工作生活。</p>\n<p>又23点过半了，要抓紧早睡了，调整正常作息才能更充沛的工作生活，记录走出了这一段不好的日子，恢复元气的自己，但是不能懈怠，毕竟“革命尚未成功，同志仍需努力”。</p>\n","site":{"data":{}},"excerpt":"<p>上海天冷了啊！上海天冷了啊啊！！上海天冷了啊啊！！！</p>\n<p>重要的事情说三遍，这是一个好习惯，有了冬天的感觉，早上起床的时候有感觉，下班路上有感觉，现在坐在键盘前打字也很有感觉；前几天在微博上写了几句话:如今算是最好的季节，褪去夏日的燥热与汗渍，又不像冬日那么干冷凛冽，穿的衣服也是刚刚好，单条牛仔裤加个风衣或冲锋衣既藏住身上的赘肉，又不失潇洒，正是装逼好时节，而最最好的是这个季节的女子，美丽更胜其它季节。朋友嘲笑说其实想看黑丝，哈哈！谁知才过几天，就感受到了那种“干冷凛冽”。但是，我喜欢这种感觉，就像我喜欢这座城市，我说我喜欢冬天，自小就喜欢，我说我喜欢这座城市，就像自小就喜欢；我说不出来为什么喜欢，就像很多说不出来为什么喜欢，就像有些人，就像有些事，就像有些讨厌，人终是要顺了自己的心意，不然不会开心，但是要懂事，不懂事就不可爱了。</p>","more":"<p>最近一直比较忙，弄得心烦意乱。</p>\n<p>生活上，最近外公有生病，母亲十分挂念，原本外公外婆年岁已高且身体不好，家里几位舅父却又不有作为，也令母亲十分苦恼，本来她身体也有不好，我却不能帮上她一二，内心也是颇为着急挂念，只能尽力安慰。说起外公外婆，也是难过不已，近两年，因些事每年都要回去两三趟，而又匆忙，故无多时间陪陪他们，外婆已多年卧病在床，起居生活全有外公照顾，我一次尝试想搀扶外婆起床，是异常艰难，可外公80多岁老人一扶就是8年多。有时，自己也想，若是自己到了这般年纪，该如何处置，想想也难过不已，想二位老人，到了这个年纪，早已不在乎吃穿用度如何如何，多年孤苦在家，更想要的子女多多陪伴，所以每次母亲打电话回去都哭泣不止；最怕“子欲养而亲不待”的事，我也劝说母亲有空就多多回老家陪陪，而母亲却担心我的婚娶生活，更令我难过不已，暗恨自己无用；昨今两日，父母又相继回老家，也希望外公身体早日恢复。</p>\n<p>工作上，自从去年与领导夸下豪言便一直不敢懈怠，但实际做下来的确是要比想象中困难许多，本来自己就不是聪明，这段时间做项目需求，改了许多稿总算通过，开心，感叹领导是好性格，如此耐心指导我；而前段时间，这个项目好几处也是几近失控，和其他公司的人沟通协调处理等一团糟，还好如今都渐回正轨；第一项目还未做完，就打退堂鼓，幸亏领导的指导，同事的帮助，当然还有我的好妹妹，每次感觉扛不住的找她聊聊发发牢骚，都能耐心听并给我加油打气。感谢这些人，当然也感谢自己，总有各种办法给自己恢复元气，今早，用思维导图把最近的烦心事要做的事全部写出来，然后一条一条的分析处理，最后恢复了好心情，又一如既往的工作生活。</p>\n<p>又23点过半了，要抓紧早睡了，调整正常作息才能更充沛的工作生活，记录走出了这一段不好的日子，恢复元气的自己，但是不能懈怠，毕竟“革命尚未成功，同志仍需努力”。</p>"},{"title":"世界上最没用的东西","id":"10001","date":"2016-11-27T14:40:54.000Z","_content":"\n[知乎](https://www.zhihu.com/question/21905681/answer/93684468)\n\n旧手机的充电器\n暗恋时的独角戏\n情人节后的鲜花\n单身狗的第二杯半价\n\n政客上任的许诺\n渴望理解的诉说\n花前月下的誓言\n回忆里微笑的脸\n\n过期的悔恨\n懦弱的容忍\n寒假前的作息表\n满街的宣传口号\n\n天赋不足的认真\n无疾而终的情深\n所谓寂寞空虚冷\n不可说与人知的疼\n\n失败后的借口\n酒桌上的朋友\n年轻时为你写的诗\n心血来潮时的雄心壮志\n\n收藏夹里的心灵鸡汤\n总结汇报的官样文章\n额度不够的信用卡\n","source":"_posts/世界上最没用的东西.md","raw":"---\ntitle: 世界上最没用的东西\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: sdfwsdserbnssd\nid: 10001\ndate: 2016-11-27 22:40:54\n---\n\n[知乎](https://www.zhihu.com/question/21905681/answer/93684468)\n\n旧手机的充电器\n暗恋时的独角戏\n情人节后的鲜花\n单身狗的第二杯半价\n\n政客上任的许诺\n渴望理解的诉说\n花前月下的誓言\n回忆里微笑的脸\n\n过期的悔恨\n懦弱的容忍\n寒假前的作息表\n满街的宣传口号\n\n天赋不足的认真\n无疾而终的情深\n所谓寂寞空虚冷\n不可说与人知的疼\n\n失败后的借口\n酒桌上的朋友\n年轻时为你写的诗\n心血来潮时的雄心壮志\n\n收藏夹里的心灵鸡汤\n总结汇报的官样文章\n额度不够的信用卡\n","slug":"sdfwsdserbnssd","published":1,"updated":"2017-04-24T14:13:25.366Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqcw006s41tpxkdd098g","content":"<p><a href=\"https://www.zhihu.com/question/21905681/answer/93684468\" target=\"_blank\" rel=\"external\">知乎</a></p>\n<p>旧手机的充电器<br>暗恋时的独角戏<br>情人节后的鲜花<br>单身狗的第二杯半价</p>\n<p>政客上任的许诺<br>渴望理解的诉说<br>花前月下的誓言<br>回忆里微笑的脸</p>\n<p>过期的悔恨<br>懦弱的容忍<br>寒假前的作息表<br>满街的宣传口号</p>\n<p>天赋不足的认真<br>无疾而终的情深<br>所谓寂寞空虚冷<br>不可说与人知的疼</p>\n<p>失败后的借口<br>酒桌上的朋友<br>年轻时为你写的诗<br>心血来潮时的雄心壮志</p>\n<p>收藏夹里的心灵鸡汤<br>总结汇报的官样文章<br>额度不够的信用卡</p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://www.zhihu.com/question/21905681/answer/93684468\">知乎</a></p>\n<p>旧手机的充电器<br>暗恋时的独角戏<br>情人节后的鲜花<br>单身狗的第二杯半价</p>\n<p>政客上任的许诺<br>渴望理解的诉说<br>花前月下的誓言<br>回忆里微笑的脸</p>\n<p>过期的悔恨<br>懦弱的容忍<br>寒假前的作息表<br>满街的宣传口号</p>\n<p>天赋不足的认真<br>无疾而终的情深<br>所谓寂寞空虚冷<br>不可说与人知的疼</p>\n<p>失败后的借口<br>酒桌上的朋友<br>年轻时为你写的诗<br>心血来潮时的雄心壮志</p>\n<p>收藏夹里的心灵鸡汤<br>总结汇报的官样文章<br>额度不够的信用卡</p>\n"},{"title":"二十四岁","id":"10002","date":"2016-08-19T14:17:54.000Z","_content":"\n\n现在时间凌晨2点多，已经记不得这是第几个凌晨2点还没睡觉了，好像早睡已经是很久远的事情了，看书学习，刷视频，发呆，玩手机平板，总之不想睡觉；花在睡觉上的时间越来越少，感觉，其实挺累的，生活在大都市里啊，忙碌工作生活奔波，总感觉时间不够用，要做的事情太多，你总要面对很多事情和责任，与人相处；我很努力么，也不那么见得，一旦你成为这个社会一员，总有人或事再推着你前进，在你耳边脑海嚷嚷着不要停，不要停啊！\n\n每年生日的时候，都会给自己写点东西，回首曾经的岁月又多了一年，我不知道这个习惯会坚持到什么时候，或许写着写着就不想写了，或者自己落入庸俗的圈套，不敢回首过往岁月；我一直坚持的，就是希望在将来回望曾经岁月时不会面带羞愧，我没想过自己会有怎么牛逼的人生，如果回想起今天能觉得，哎哟，不错哦，那就很好了啊；我会坚持去自己想做的事，年岁在增长，不忘初心；就像，这个我喜欢啊，嗯，那就坚持下去咯。\n\n早上醒来的时候，收到前女友的“生日快乐”，挺意外的，然后感动；中午收到爸妈姐姐姐夫外甥的祝福，觉得自己好幸福啊，感恩这些在乎我的人，我爱他们，我想这些会是我生活的动力；今年的生日和往常一样，没有庆祝，我性格不太喜欢仪式感很强烈的事情，没有太多的心思，过的开心就好了，费那么大劲折腾犯不着，生活就是这样。\n\n今年好像没什么好说的，工作没换，现在单位还不错，有自己努力的方向，领导也重视，比之去年也有提升，唯一的感觉就是时间不够用，要学习的东西太多了，但是还学的进去，这一点我很满足，接下来的一年要坚持下去；学业学习上来说，去年报的上外英本，今年上半年都没去上课了，虽然不是翘课，但是关心的力度不够，抽个时间要去趟学校，跟班主任聊聊接下来的学习规划，毕竟还是要考试的；生活上呢，终于感觉到我是爸妈亲生的了啊喂，超幸福美满，这个没得说，还有一个优秀的妹妹，作为谈心的伙伴和学习的榜样也是十分满足；不过，与朋友相处这块近期有些糟糕，这个要好好检讨，以后在这方面要更加成熟；总之目标啊就是努力挣钱啊挣钱啊，上海买房啊买房啊，虽然这座城市生活着挺辛苦的，但是我爱它，所以我要留在这里；至于恋爱结婚什么的，没什么进展也没什么打算，总之先努力工作，努力生活咯。\n\n还是和往年一样，自己从奶奶去世，我一直不喜欢过节，还是会想念她，不愿意听别人提及她，工作累了，与人相处不融洽的时候，很多时候，我都会想起她，想起小时候，为我遮风挡雨，是我最温暖最踏实的依靠，生活虽然艰辛，但那是我一生最快乐的时光，教我做人做事，让我努力，支持我鼓励我教训我，可是我却未能报答这份恩情，每次清明节回去，望着那座坟墓，总是还想听听您喊我的名字；所以呢，我要努力过好自己的人生，才能对得起奶奶的期望，人生的努力，终有一个理由。\n\n好了，接下来要开始走向25岁了。\n","source":"_posts/二十四岁.md","raw":"---\ntitle: 二十四岁\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: er-shi-si-sui\nid: 10002\ndate: 2016-08-19 22:17:54\n---\n\n\n现在时间凌晨2点多，已经记不得这是第几个凌晨2点还没睡觉了，好像早睡已经是很久远的事情了，看书学习，刷视频，发呆，玩手机平板，总之不想睡觉；花在睡觉上的时间越来越少，感觉，其实挺累的，生活在大都市里啊，忙碌工作生活奔波，总感觉时间不够用，要做的事情太多，你总要面对很多事情和责任，与人相处；我很努力么，也不那么见得，一旦你成为这个社会一员，总有人或事再推着你前进，在你耳边脑海嚷嚷着不要停，不要停啊！\n\n每年生日的时候，都会给自己写点东西，回首曾经的岁月又多了一年，我不知道这个习惯会坚持到什么时候，或许写着写着就不想写了，或者自己落入庸俗的圈套，不敢回首过往岁月；我一直坚持的，就是希望在将来回望曾经岁月时不会面带羞愧，我没想过自己会有怎么牛逼的人生，如果回想起今天能觉得，哎哟，不错哦，那就很好了啊；我会坚持去自己想做的事，年岁在增长，不忘初心；就像，这个我喜欢啊，嗯，那就坚持下去咯。\n\n早上醒来的时候，收到前女友的“生日快乐”，挺意外的，然后感动；中午收到爸妈姐姐姐夫外甥的祝福，觉得自己好幸福啊，感恩这些在乎我的人，我爱他们，我想这些会是我生活的动力；今年的生日和往常一样，没有庆祝，我性格不太喜欢仪式感很强烈的事情，没有太多的心思，过的开心就好了，费那么大劲折腾犯不着，生活就是这样。\n\n今年好像没什么好说的，工作没换，现在单位还不错，有自己努力的方向，领导也重视，比之去年也有提升，唯一的感觉就是时间不够用，要学习的东西太多了，但是还学的进去，这一点我很满足，接下来的一年要坚持下去；学业学习上来说，去年报的上外英本，今年上半年都没去上课了，虽然不是翘课，但是关心的力度不够，抽个时间要去趟学校，跟班主任聊聊接下来的学习规划，毕竟还是要考试的；生活上呢，终于感觉到我是爸妈亲生的了啊喂，超幸福美满，这个没得说，还有一个优秀的妹妹，作为谈心的伙伴和学习的榜样也是十分满足；不过，与朋友相处这块近期有些糟糕，这个要好好检讨，以后在这方面要更加成熟；总之目标啊就是努力挣钱啊挣钱啊，上海买房啊买房啊，虽然这座城市生活着挺辛苦的，但是我爱它，所以我要留在这里；至于恋爱结婚什么的，没什么进展也没什么打算，总之先努力工作，努力生活咯。\n\n还是和往年一样，自己从奶奶去世，我一直不喜欢过节，还是会想念她，不愿意听别人提及她，工作累了，与人相处不融洽的时候，很多时候，我都会想起她，想起小时候，为我遮风挡雨，是我最温暖最踏实的依靠，生活虽然艰辛，但那是我一生最快乐的时光，教我做人做事，让我努力，支持我鼓励我教训我，可是我却未能报答这份恩情，每次清明节回去，望着那座坟墓，总是还想听听您喊我的名字；所以呢，我要努力过好自己的人生，才能对得起奶奶的期望，人生的努力，终有一个理由。\n\n好了，接下来要开始走向25岁了。\n","slug":"er-shi-si-sui","published":1,"updated":"2017-04-24T14:13:25.366Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqd0006x41tpft5vfwyb","content":"<p>现在时间凌晨2点多，已经记不得这是第几个凌晨2点还没睡觉了，好像早睡已经是很久远的事情了，看书学习，刷视频，发呆，玩手机平板，总之不想睡觉；花在睡觉上的时间越来越少，感觉，其实挺累的，生活在大都市里啊，忙碌工作生活奔波，总感觉时间不够用，要做的事情太多，你总要面对很多事情和责任，与人相处；我很努力么，也不那么见得，一旦你成为这个社会一员，总有人或事再推着你前进，在你耳边脑海嚷嚷着不要停，不要停啊！</p>\n<p>每年生日的时候，都会给自己写点东西，回首曾经的岁月又多了一年，我不知道这个习惯会坚持到什么时候，或许写着写着就不想写了，或者自己落入庸俗的圈套，不敢回首过往岁月；我一直坚持的，就是希望在将来回望曾经岁月时不会面带羞愧，我没想过自己会有怎么牛逼的人生，如果回想起今天能觉得，哎哟，不错哦，那就很好了啊；我会坚持去自己想做的事，年岁在增长，不忘初心；就像，这个我喜欢啊，嗯，那就坚持下去咯。</p>\n<p>早上醒来的时候，收到前女友的“生日快乐”，挺意外的，然后感动；中午收到爸妈姐姐姐夫外甥的祝福，觉得自己好幸福啊，感恩这些在乎我的人，我爱他们，我想这些会是我生活的动力；今年的生日和往常一样，没有庆祝，我性格不太喜欢仪式感很强烈的事情，没有太多的心思，过的开心就好了，费那么大劲折腾犯不着，生活就是这样。</p>\n<p>今年好像没什么好说的，工作没换，现在单位还不错，有自己努力的方向，领导也重视，比之去年也有提升，唯一的感觉就是时间不够用，要学习的东西太多了，但是还学的进去，这一点我很满足，接下来的一年要坚持下去；学业学习上来说，去年报的上外英本，今年上半年都没去上课了，虽然不是翘课，但是关心的力度不够，抽个时间要去趟学校，跟班主任聊聊接下来的学习规划，毕竟还是要考试的；生活上呢，终于感觉到我是爸妈亲生的了啊喂，超幸福美满，这个没得说，还有一个优秀的妹妹，作为谈心的伙伴和学习的榜样也是十分满足；不过，与朋友相处这块近期有些糟糕，这个要好好检讨，以后在这方面要更加成熟；总之目标啊就是努力挣钱啊挣钱啊，上海买房啊买房啊，虽然这座城市生活着挺辛苦的，但是我爱它，所以我要留在这里；至于恋爱结婚什么的，没什么进展也没什么打算，总之先努力工作，努力生活咯。</p>\n<p>还是和往年一样，自己从奶奶去世，我一直不喜欢过节，还是会想念她，不愿意听别人提及她，工作累了，与人相处不融洽的时候，很多时候，我都会想起她，想起小时候，为我遮风挡雨，是我最温暖最踏实的依靠，生活虽然艰辛，但那是我一生最快乐的时光，教我做人做事，让我努力，支持我鼓励我教训我，可是我却未能报答这份恩情，每次清明节回去，望着那座坟墓，总是还想听听您喊我的名字；所以呢，我要努力过好自己的人生，才能对得起奶奶的期望，人生的努力，终有一个理由。</p>\n<p>好了，接下来要开始走向25岁了。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>现在时间凌晨2点多，已经记不得这是第几个凌晨2点还没睡觉了，好像早睡已经是很久远的事情了，看书学习，刷视频，发呆，玩手机平板，总之不想睡觉；花在睡觉上的时间越来越少，感觉，其实挺累的，生活在大都市里啊，忙碌工作生活奔波，总感觉时间不够用，要做的事情太多，你总要面对很多事情和责任，与人相处；我很努力么，也不那么见得，一旦你成为这个社会一员，总有人或事再推着你前进，在你耳边脑海嚷嚷着不要停，不要停啊！</p>\n<p>每年生日的时候，都会给自己写点东西，回首曾经的岁月又多了一年，我不知道这个习惯会坚持到什么时候，或许写着写着就不想写了，或者自己落入庸俗的圈套，不敢回首过往岁月；我一直坚持的，就是希望在将来回望曾经岁月时不会面带羞愧，我没想过自己会有怎么牛逼的人生，如果回想起今天能觉得，哎哟，不错哦，那就很好了啊；我会坚持去自己想做的事，年岁在增长，不忘初心；就像，这个我喜欢啊，嗯，那就坚持下去咯。</p>\n<p>早上醒来的时候，收到前女友的“生日快乐”，挺意外的，然后感动；中午收到爸妈姐姐姐夫外甥的祝福，觉得自己好幸福啊，感恩这些在乎我的人，我爱他们，我想这些会是我生活的动力；今年的生日和往常一样，没有庆祝，我性格不太喜欢仪式感很强烈的事情，没有太多的心思，过的开心就好了，费那么大劲折腾犯不着，生活就是这样。</p>\n<p>今年好像没什么好说的，工作没换，现在单位还不错，有自己努力的方向，领导也重视，比之去年也有提升，唯一的感觉就是时间不够用，要学习的东西太多了，但是还学的进去，这一点我很满足，接下来的一年要坚持下去；学业学习上来说，去年报的上外英本，今年上半年都没去上课了，虽然不是翘课，但是关心的力度不够，抽个时间要去趟学校，跟班主任聊聊接下来的学习规划，毕竟还是要考试的；生活上呢，终于感觉到我是爸妈亲生的了啊喂，超幸福美满，这个没得说，还有一个优秀的妹妹，作为谈心的伙伴和学习的榜样也是十分满足；不过，与朋友相处这块近期有些糟糕，这个要好好检讨，以后在这方面要更加成熟；总之目标啊就是努力挣钱啊挣钱啊，上海买房啊买房啊，虽然这座城市生活着挺辛苦的，但是我爱它，所以我要留在这里；至于恋爱结婚什么的，没什么进展也没什么打算，总之先努力工作，努力生活咯。</p>\n<p>还是和往年一样，自己从奶奶去世，我一直不喜欢过节，还是会想念她，不愿意听别人提及她，工作累了，与人相处不融洽的时候，很多时候，我都会想起她，想起小时候，为我遮风挡雨，是我最温暖最踏实的依靠，生活虽然艰辛，但那是我一生最快乐的时光，教我做人做事，让我努力，支持我鼓励我教训我，可是我却未能报答这份恩情，每次清明节回去，望着那座坟墓，总是还想听听您喊我的名字；所以呢，我要努力过好自己的人生，才能对得起奶奶的期望，人生的努力，终有一个理由。</p>\n<p>好了，接下来要开始走向25岁了。</p>\n"},{"title":"你好，八月","id":"10003","date":"2016-07-31T16:15:54.000Z","_content":"\n还剩不到1小时就要进入8月，也许写完这篇文章就已经8月，我其实不擅长写作文，自小如此，所以每次都是特别慢；时间慢慢流逝，听着音乐，随心所致，大概也是件快乐的事情吧。\n\n定期自省己身，所行之事，所思之虑，有则改之，无则勉之，坚守吾心，戒嗔戒躁，自打懂得事理之后，便妄以此法施加吾身，奈何小子年幼，定力不坚，常因一时欢愉便抛诸脑后，事后便懊悔不已；虽言，生而为人，便逃不过七情六欲加身，然，时时自省吾身，常思吾之过，常念德行事，方可为人；撰此文，便是警醒己身。\n\n犯错并不是一件可怕的事儿，从小做了不知多少混账事，也没见的把天捅破，可见，所谓捅破天也不是件容易的事儿；首先是工作上的失职，自今年年初，开始搭建自身的团队班子，虽然只有三三两两人，刚开始做小头头，我并没有正确认识到自己的责任，在完成本职工作的同时，也要照顾底下的员工，不光是工作安排，还有学习成长，很多事情吩咐下去之后，自己又要去检查，弄的比自己一人工作时还要劳累；之后，连着手下两名员工都离职了，我开始反省自己，从招聘到工作分配到培养，头大如斗，深感做领导的不易。公司因装修改造，扩展一个会议室，我自己怕麻烦，便将工作推给一个员工，却未考虑他的自身的能力，导致原本清晰简单的事，拖拖拉拉2个月才算弄完，还害得这名员工离职，对行政部门的工作也造成了影响，经此事之后，发觉自身管理能力十分不足。另一事，公司微软云资源的账单，之前一人工作时制定的账单每月资源消耗账单，但是由于后将该事务分配与他人，导致最后帐不对本，弄巧成拙，最后还是花费大量时间，重新制作了所有的账单，问题在于自身没有将事务认真贯彻执行下去，而且任务甩出手之后，缺乏关心。另有很多这样大大小小之事，十分头疼，真应该好好学学如何做一个好领导。\n\n我不太会写叙述的文章，前面一段文字，自己看着都揪心，也是那些复杂的事儿都过去了，才能有闲工夫来写这些东西，两个助手离职之后，拉来之前同事过来帮忙，现在事情都在往好的方向发展，一点点在建立规则，接下来的工作和学习的重心都会放在大数据上，实在的事是公司给了我很好的学习机会，在这家公司也成长了非常的多，感谢的话言之不尽，唯有努力工作方可回报。\n\n谈下关于博客，最近找了一个漂亮的主题，所以一直在折腾怎么弄好看，感觉有点逾越了当初创建博客的初衷；所以，接下来的时间，要整理之前的博文，对知识进行梳理，好记性不如烂笔头，用XMind做思维导图，TodoList工具计划任务清单，博客记录学习内容FAQ等，一直认为好的学习方法才能达到事半功倍的效果，要加快成长，每次参加一些培训和技术的研讨会，都恨不得自己早生十年。\n\n谈下关于减肥，首先这肯定是一个永恒无止尽的话题，之前这段时间因为工作上的乱七八糟导致每天下班时间都到9-10多点钟，再加上公司到家地铁要1小时，所以健身房也一直没去，再加上饮食不规律，体重又回升到了可怕85KG，8月开始，要认真去健身了，该吃吃，该练练，目标体重75KG。\n","source":"_posts/你好，八月.md","raw":"---\ntitle: 你好，八月\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: hey-August\nid: 10003\ndate: 2016-08-01 00:15:54\n---\n\n还剩不到1小时就要进入8月，也许写完这篇文章就已经8月，我其实不擅长写作文，自小如此，所以每次都是特别慢；时间慢慢流逝，听着音乐，随心所致，大概也是件快乐的事情吧。\n\n定期自省己身，所行之事，所思之虑，有则改之，无则勉之，坚守吾心，戒嗔戒躁，自打懂得事理之后，便妄以此法施加吾身，奈何小子年幼，定力不坚，常因一时欢愉便抛诸脑后，事后便懊悔不已；虽言，生而为人，便逃不过七情六欲加身，然，时时自省吾身，常思吾之过，常念德行事，方可为人；撰此文，便是警醒己身。\n\n犯错并不是一件可怕的事儿，从小做了不知多少混账事，也没见的把天捅破，可见，所谓捅破天也不是件容易的事儿；首先是工作上的失职，自今年年初，开始搭建自身的团队班子，虽然只有三三两两人，刚开始做小头头，我并没有正确认识到自己的责任，在完成本职工作的同时，也要照顾底下的员工，不光是工作安排，还有学习成长，很多事情吩咐下去之后，自己又要去检查，弄的比自己一人工作时还要劳累；之后，连着手下两名员工都离职了，我开始反省自己，从招聘到工作分配到培养，头大如斗，深感做领导的不易。公司因装修改造，扩展一个会议室，我自己怕麻烦，便将工作推给一个员工，却未考虑他的自身的能力，导致原本清晰简单的事，拖拖拉拉2个月才算弄完，还害得这名员工离职，对行政部门的工作也造成了影响，经此事之后，发觉自身管理能力十分不足。另一事，公司微软云资源的账单，之前一人工作时制定的账单每月资源消耗账单，但是由于后将该事务分配与他人，导致最后帐不对本，弄巧成拙，最后还是花费大量时间，重新制作了所有的账单，问题在于自身没有将事务认真贯彻执行下去，而且任务甩出手之后，缺乏关心。另有很多这样大大小小之事，十分头疼，真应该好好学学如何做一个好领导。\n\n我不太会写叙述的文章，前面一段文字，自己看着都揪心，也是那些复杂的事儿都过去了，才能有闲工夫来写这些东西，两个助手离职之后，拉来之前同事过来帮忙，现在事情都在往好的方向发展，一点点在建立规则，接下来的工作和学习的重心都会放在大数据上，实在的事是公司给了我很好的学习机会，在这家公司也成长了非常的多，感谢的话言之不尽，唯有努力工作方可回报。\n\n谈下关于博客，最近找了一个漂亮的主题，所以一直在折腾怎么弄好看，感觉有点逾越了当初创建博客的初衷；所以，接下来的时间，要整理之前的博文，对知识进行梳理，好记性不如烂笔头，用XMind做思维导图，TodoList工具计划任务清单，博客记录学习内容FAQ等，一直认为好的学习方法才能达到事半功倍的效果，要加快成长，每次参加一些培训和技术的研讨会，都恨不得自己早生十年。\n\n谈下关于减肥，首先这肯定是一个永恒无止尽的话题，之前这段时间因为工作上的乱七八糟导致每天下班时间都到9-10多点钟，再加上公司到家地铁要1小时，所以健身房也一直没去，再加上饮食不规律，体重又回升到了可怕85KG，8月开始，要认真去健身了，该吃吃，该练练，目标体重75KG。\n","slug":"hey-August","published":1,"updated":"2017-04-24T14:13:25.366Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqd4007041tpl5mv8dst","content":"<p>还剩不到1小时就要进入8月，也许写完这篇文章就已经8月，我其实不擅长写作文，自小如此，所以每次都是特别慢；时间慢慢流逝，听着音乐，随心所致，大概也是件快乐的事情吧。</p>\n<p>定期自省己身，所行之事，所思之虑，有则改之，无则勉之，坚守吾心，戒嗔戒躁，自打懂得事理之后，便妄以此法施加吾身，奈何小子年幼，定力不坚，常因一时欢愉便抛诸脑后，事后便懊悔不已；虽言，生而为人，便逃不过七情六欲加身，然，时时自省吾身，常思吾之过，常念德行事，方可为人；撰此文，便是警醒己身。</p>\n<p>犯错并不是一件可怕的事儿，从小做了不知多少混账事，也没见的把天捅破，可见，所谓捅破天也不是件容易的事儿；首先是工作上的失职，自今年年初，开始搭建自身的团队班子，虽然只有三三两两人，刚开始做小头头，我并没有正确认识到自己的责任，在完成本职工作的同时，也要照顾底下的员工，不光是工作安排，还有学习成长，很多事情吩咐下去之后，自己又要去检查，弄的比自己一人工作时还要劳累；之后，连着手下两名员工都离职了，我开始反省自己，从招聘到工作分配到培养，头大如斗，深感做领导的不易。公司因装修改造，扩展一个会议室，我自己怕麻烦，便将工作推给一个员工，却未考虑他的自身的能力，导致原本清晰简单的事，拖拖拉拉2个月才算弄完，还害得这名员工离职，对行政部门的工作也造成了影响，经此事之后，发觉自身管理能力十分不足。另一事，公司微软云资源的账单，之前一人工作时制定的账单每月资源消耗账单，但是由于后将该事务分配与他人，导致最后帐不对本，弄巧成拙，最后还是花费大量时间，重新制作了所有的账单，问题在于自身没有将事务认真贯彻执行下去，而且任务甩出手之后，缺乏关心。另有很多这样大大小小之事，十分头疼，真应该好好学学如何做一个好领导。</p>\n<p>我不太会写叙述的文章，前面一段文字，自己看着都揪心，也是那些复杂的事儿都过去了，才能有闲工夫来写这些东西，两个助手离职之后，拉来之前同事过来帮忙，现在事情都在往好的方向发展，一点点在建立规则，接下来的工作和学习的重心都会放在大数据上，实在的事是公司给了我很好的学习机会，在这家公司也成长了非常的多，感谢的话言之不尽，唯有努力工作方可回报。</p>\n<p>谈下关于博客，最近找了一个漂亮的主题，所以一直在折腾怎么弄好看，感觉有点逾越了当初创建博客的初衷；所以，接下来的时间，要整理之前的博文，对知识进行梳理，好记性不如烂笔头，用XMind做思维导图，TodoList工具计划任务清单，博客记录学习内容FAQ等，一直认为好的学习方法才能达到事半功倍的效果，要加快成长，每次参加一些培训和技术的研讨会，都恨不得自己早生十年。</p>\n<p>谈下关于减肥，首先这肯定是一个永恒无止尽的话题，之前这段时间因为工作上的乱七八糟导致每天下班时间都到9-10多点钟，再加上公司到家地铁要1小时，所以健身房也一直没去，再加上饮食不规律，体重又回升到了可怕85KG，8月开始，要认真去健身了，该吃吃，该练练，目标体重75KG。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>还剩不到1小时就要进入8月，也许写完这篇文章就已经8月，我其实不擅长写作文，自小如此，所以每次都是特别慢；时间慢慢流逝，听着音乐，随心所致，大概也是件快乐的事情吧。</p>\n<p>定期自省己身，所行之事，所思之虑，有则改之，无则勉之，坚守吾心，戒嗔戒躁，自打懂得事理之后，便妄以此法施加吾身，奈何小子年幼，定力不坚，常因一时欢愉便抛诸脑后，事后便懊悔不已；虽言，生而为人，便逃不过七情六欲加身，然，时时自省吾身，常思吾之过，常念德行事，方可为人；撰此文，便是警醒己身。</p>\n<p>犯错并不是一件可怕的事儿，从小做了不知多少混账事，也没见的把天捅破，可见，所谓捅破天也不是件容易的事儿；首先是工作上的失职，自今年年初，开始搭建自身的团队班子，虽然只有三三两两人，刚开始做小头头，我并没有正确认识到自己的责任，在完成本职工作的同时，也要照顾底下的员工，不光是工作安排，还有学习成长，很多事情吩咐下去之后，自己又要去检查，弄的比自己一人工作时还要劳累；之后，连着手下两名员工都离职了，我开始反省自己，从招聘到工作分配到培养，头大如斗，深感做领导的不易。公司因装修改造，扩展一个会议室，我自己怕麻烦，便将工作推给一个员工，却未考虑他的自身的能力，导致原本清晰简单的事，拖拖拉拉2个月才算弄完，还害得这名员工离职，对行政部门的工作也造成了影响，经此事之后，发觉自身管理能力十分不足。另一事，公司微软云资源的账单，之前一人工作时制定的账单每月资源消耗账单，但是由于后将该事务分配与他人，导致最后帐不对本，弄巧成拙，最后还是花费大量时间，重新制作了所有的账单，问题在于自身没有将事务认真贯彻执行下去，而且任务甩出手之后，缺乏关心。另有很多这样大大小小之事，十分头疼，真应该好好学学如何做一个好领导。</p>\n<p>我不太会写叙述的文章，前面一段文字，自己看着都揪心，也是那些复杂的事儿都过去了，才能有闲工夫来写这些东西，两个助手离职之后，拉来之前同事过来帮忙，现在事情都在往好的方向发展，一点点在建立规则，接下来的工作和学习的重心都会放在大数据上，实在的事是公司给了我很好的学习机会，在这家公司也成长了非常的多，感谢的话言之不尽，唯有努力工作方可回报。</p>\n<p>谈下关于博客，最近找了一个漂亮的主题，所以一直在折腾怎么弄好看，感觉有点逾越了当初创建博客的初衷；所以，接下来的时间，要整理之前的博文，对知识进行梳理，好记性不如烂笔头，用XMind做思维导图，TodoList工具计划任务清单，博客记录学习内容FAQ等，一直认为好的学习方法才能达到事半功倍的效果，要加快成长，每次参加一些培训和技术的研讨会，都恨不得自己早生十年。</p>\n<p>谈下关于减肥，首先这肯定是一个永恒无止尽的话题，之前这段时间因为工作上的乱七八糟导致每天下班时间都到9-10多点钟，再加上公司到家地铁要1小时，所以健身房也一直没去，再加上饮食不规律，体重又回升到了可怕85KG，8月开始，要认真去健身了，该吃吃，该练练，目标体重75KG。</p>\n"},{"title":"使用SoureceTree管理你的git项目","id":"29","updated":"2017-04-21T05:36:47.000Z","date":"2016-04-20T13:31:49.000Z","_content":"\n###### Update\n* <font color=red>update: Windows用户在初始化Souretree工具时，需要用到Atlassian ID，新建用户时需要加载google 验证码，这一步需要VPN的支持，请注意。</font>\n* 找到一个版本的SourceTree工具可以不需要以上验证也能使用，下载链接：[SourceTreeSetup_1.6.14.exe](https://pan.baidu.com/s/1bJOzOq)\n\n<br>\n\n\n##### 补充1 ：Git学习网站\n1. [猴子都能学会的git教程](http://backlogtool.com/git-guide/cn/)\n2. [常用 Git 命令清单](http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html)\n3. [廖雪峰的git教程](http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000)\n4. [Why Git is Better than X](http://zoomq.qiniudn.com/ZQScrapBook/ZqFLOSS/data/20081210180347/)\n\n##### 补充2 ：利用Git协同开发\n1. [团队中的Git实践](https://ourai.ws/posts/working-with-git-in-team/)\n2. [Git 使用规范流程](http://www.ruanyifeng.com/blog/2015/08/git-use-process.html)\n3. [Git分支管理模型](http://nvie.com/files/Git-branching-model.pdf)\n4. [图解Git](http://marklodato.github.io/visual-git-guide/index-zh-cn.html)\n\n<hr>\n\n## 1. 关于 SourceTree\n#### SourceTree 是一款免费且同时支持Windows 和Mac 的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。\n>官网： https://www.sourcetreeapp.com/\n\n## 2. git帐号建立\n### 1. 新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree02.jpg)\n\n### 2. 点击邮件中的 “Click here to set your password”，设置gitlab登陆密码。\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsouretree03.jpg)\n\n### 3. 登陆gitlab帐号，将会出现这个界面：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree05.jpg)\n\n### 4. 设定个人信息：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsouretree06.jpg)\n\n### 5. sshKey\n#### 5.1 在Linux和Mac上生成sshkey：\n\n```\n➜  ~ ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/Users/Alex/.ssh/id_rsa):\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in /Users/Alex/.ssh/id_rsa.\nYour public key has been saved in /Users/Alex/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:98jE3jhBhFT5nQlZRj34a3WOk1t6XF+Dbf/hliXl4WQ Alex@Alex-Mac\nThe key's randomart image is:\n+---[RSA 2048]----+\n|       ..oo. +=. |\n|        ... oo ..|\n|          .. o.o.|\n|         o  . +E+|\n|        S =   **=|\n|         = * .=BB|\n|          * o oOO|\n|           .  +o*|\n|              .oo|\n+----[SHA256]-----+\n➜  ~ cat ~/.ssh/id_rsa.pub\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCvuQAq65b+nLZPqqc3b3Mj9e7Pt8oWKasJFa2QH1VIEkDvxKLFGcHsT7Ur4zXwEi9YiW2tVRrBSjcMALxuBjVm2IxYV6Lk8SLuGadyYy5telWGJmHsQ3VIPRuKwpzTkLN643kjqc6JFSlnZG/XoP9SPtCOsp2ql4u0s7Auc2bZay4RaTDXbcpJVU9OA0xM8Zy4oTTNYdZ4tvGittVmn+wLrhN255J7clORF5126dmDYxV3E8ZboaDdQpdLGIWmDNcBJQvl0CLwpKUCi7EUDqDVtm4bNgwIX9fEIkTxGdaWjBW1iXBk8TGXWkgB+Qp8B1IwaJ4GHUwUhQrefWvw9XeJ Alex@Alex-Mac\n➜  ~\n```\n\n#### 5.2 在Windows上生成sshkey：\n#### 因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen.exe生成sshkey [下载地址](http://the.earth.li/~sgtatham/putty/0.67/x86/puttygen.exe)\n\n#### 步骤如下：\n\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree13.jpg)\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree14.jpg)\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree15.jpg)\n\n#### 当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private.ppk文件\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree12.jpg)\n\n#### 5.3 上传sshkey：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree07.jpg)\n\n### 6. 回到 dashboard ，点击项目名称进入详情：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree08.jpg)\n\n### 7. 使用souretree将项目从git服务器clone到本地\n\n#### 7.1 安装souretree 软件 ［略］\n\n#### 7.2 clone项目到本地\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree09.jpg)\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree10.jpg)\n\n### 8. 进入项目工作台：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree11.jpg)\n\n\n#### 9. 关于sourcetree工具的使用，下面是一些git操作的释疑。\n* 检出仓库: 将在本地创建一个git仓库的克隆版本\n* 工作流: 本地仓库由 git 维护的三棵“树”组成。第一个是 工作目录，它持有实际文件；第二个是 缓存区（Index），它像个缓存区域，临时保存改动；最后是 HEAD，指向最近一次提交后的结果。\n* 提交：可以计划改动（把它们添加到缓存区),将改动提交到了 HEAD，但是还没到提交到远端仓库。\n* 拉取：从远端仓库拉取最新版本状态，特别是在其他人员有所改动之后。\n* 推送：改动现在已经在本地仓库的 HEAD 中了。这时可以使用它将这些改动提交到远端仓库。\n* 分支：分支是用来将特性开发分离出来的。在创建仓库的时候，master 是“默认的”。创建分支将可以从主线开发上分离开来，然后在不影响主线的同时继续工作，完成后再将它们合并到主分支上。\n* 合并： 将分支功能并入主分支。\n\n","source":"_posts/使用SoureceTree管理你的git项目.md","raw":"---\ntitle: 使用SoureceTree管理你的git项目\ntags: 'Git'\ncategories: 'Git'\npermalink: git01-sourcetree\nid: 29\nupdated: '2017-04-21 13:36:47'\ndate: 2016-04-20 21:31:49\n---\n\n###### Update\n* <font color=red>update: Windows用户在初始化Souretree工具时，需要用到Atlassian ID，新建用户时需要加载google 验证码，这一步需要VPN的支持，请注意。</font>\n* 找到一个版本的SourceTree工具可以不需要以上验证也能使用，下载链接：[SourceTreeSetup_1.6.14.exe](https://pan.baidu.com/s/1bJOzOq)\n\n<br>\n\n\n##### 补充1 ：Git学习网站\n1. [猴子都能学会的git教程](http://backlogtool.com/git-guide/cn/)\n2. [常用 Git 命令清单](http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html)\n3. [廖雪峰的git教程](http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000)\n4. [Why Git is Better than X](http://zoomq.qiniudn.com/ZQScrapBook/ZqFLOSS/data/20081210180347/)\n\n##### 补充2 ：利用Git协同开发\n1. [团队中的Git实践](https://ourai.ws/posts/working-with-git-in-team/)\n2. [Git 使用规范流程](http://www.ruanyifeng.com/blog/2015/08/git-use-process.html)\n3. [Git分支管理模型](http://nvie.com/files/Git-branching-model.pdf)\n4. [图解Git](http://marklodato.github.io/visual-git-guide/index-zh-cn.html)\n\n<hr>\n\n## 1. 关于 SourceTree\n#### SourceTree 是一款免费且同时支持Windows 和Mac 的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。\n>官网： https://www.sourcetreeapp.com/\n\n## 2. git帐号建立\n### 1. 新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree02.jpg)\n\n### 2. 点击邮件中的 “Click here to set your password”，设置gitlab登陆密码。\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsouretree03.jpg)\n\n### 3. 登陆gitlab帐号，将会出现这个界面：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree05.jpg)\n\n### 4. 设定个人信息：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsouretree06.jpg)\n\n### 5. sshKey\n#### 5.1 在Linux和Mac上生成sshkey：\n\n```\n➜  ~ ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/Users/Alex/.ssh/id_rsa):\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in /Users/Alex/.ssh/id_rsa.\nYour public key has been saved in /Users/Alex/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:98jE3jhBhFT5nQlZRj34a3WOk1t6XF+Dbf/hliXl4WQ Alex@Alex-Mac\nThe key's randomart image is:\n+---[RSA 2048]----+\n|       ..oo. +=. |\n|        ... oo ..|\n|          .. o.o.|\n|         o  . +E+|\n|        S =   **=|\n|         = * .=BB|\n|          * o oOO|\n|           .  +o*|\n|              .oo|\n+----[SHA256]-----+\n➜  ~ cat ~/.ssh/id_rsa.pub\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCvuQAq65b+nLZPqqc3b3Mj9e7Pt8oWKasJFa2QH1VIEkDvxKLFGcHsT7Ur4zXwEi9YiW2tVRrBSjcMALxuBjVm2IxYV6Lk8SLuGadyYy5telWGJmHsQ3VIPRuKwpzTkLN643kjqc6JFSlnZG/XoP9SPtCOsp2ql4u0s7Auc2bZay4RaTDXbcpJVU9OA0xM8Zy4oTTNYdZ4tvGittVmn+wLrhN255J7clORF5126dmDYxV3E8ZboaDdQpdLGIWmDNcBJQvl0CLwpKUCi7EUDqDVtm4bNgwIX9fEIkTxGdaWjBW1iXBk8TGXWkgB+Qp8B1IwaJ4GHUwUhQrefWvw9XeJ Alex@Alex-Mac\n➜  ~\n```\n\n#### 5.2 在Windows上生成sshkey：\n#### 因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen.exe生成sshkey [下载地址](http://the.earth.li/~sgtatham/putty/0.67/x86/puttygen.exe)\n\n#### 步骤如下：\n\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree13.jpg)\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree14.jpg)\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree15.jpg)\n\n#### 当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private.ppk文件\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree12.jpg)\n\n#### 5.3 上传sshkey：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree07.jpg)\n\n### 6. 回到 dashboard ，点击项目名称进入详情：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree08.jpg)\n\n### 7. 使用souretree将项目从git服务器clone到本地\n\n#### 7.1 安装souretree 软件 ［略］\n\n#### 7.2 clone项目到本地\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree09.jpg)\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree10.jpg)\n\n### 8. 进入项目工作台：\n![image](http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree11.jpg)\n\n\n#### 9. 关于sourcetree工具的使用，下面是一些git操作的释疑。\n* 检出仓库: 将在本地创建一个git仓库的克隆版本\n* 工作流: 本地仓库由 git 维护的三棵“树”组成。第一个是 工作目录，它持有实际文件；第二个是 缓存区（Index），它像个缓存区域，临时保存改动；最后是 HEAD，指向最近一次提交后的结果。\n* 提交：可以计划改动（把它们添加到缓存区),将改动提交到了 HEAD，但是还没到提交到远端仓库。\n* 拉取：从远端仓库拉取最新版本状态，特别是在其他人员有所改动之后。\n* 推送：改动现在已经在本地仓库的 HEAD 中了。这时可以使用它将这些改动提交到远端仓库。\n* 分支：分支是用来将特性开发分离出来的。在创建仓库的时候，master 是“默认的”。创建分支将可以从主线开发上分离开来，然后在不影响主线的同时继续工作，完成后再将它们合并到主分支上。\n* 合并： 将分支功能并入主分支。\n\n","slug":"git01-sourcetree","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqda007541tp5ut57o2i","content":"<h6 id=\"Update\"><a href=\"#Update\" class=\"headerlink\" title=\"Update\"></a>Update</h6><ul>\n<li><font color=\"red\">update: Windows用户在初始化Souretree工具时，需要用到Atlassian ID，新建用户时需要加载google 验证码，这一步需要VPN的支持，请注意。</font></li>\n<li>找到一个版本的SourceTree工具可以不需要以上验证也能使用，下载链接：<a href=\"https://pan.baidu.com/s/1bJOzOq\" target=\"_blank\" rel=\"external\">SourceTreeSetup_1.6.14.exe</a></li>\n</ul>\n<p><br></p>\n<h5 id=\"补充1-：Git学习网站\"><a href=\"#补充1-：Git学习网站\" class=\"headerlink\" title=\"补充1 ：Git学习网站\"></a>补充1 ：Git学习网站</h5><ol>\n<li><a href=\"http://backlogtool.com/git-guide/cn/\" target=\"_blank\" rel=\"external\">猴子都能学会的git教程</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html\" target=\"_blank\" rel=\"external\">常用 Git 命令清单</a></li>\n<li><a href=\"http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000\" target=\"_blank\" rel=\"external\">廖雪峰的git教程</a></li>\n<li><a href=\"http://zoomq.qiniudn.com/ZQScrapBook/ZqFLOSS/data/20081210180347/\" target=\"_blank\" rel=\"external\">Why Git is Better than X</a></li>\n</ol>\n<h5 id=\"补充2-：利用Git协同开发\"><a href=\"#补充2-：利用Git协同开发\" class=\"headerlink\" title=\"补充2 ：利用Git协同开发\"></a>补充2 ：利用Git协同开发</h5><ol>\n<li><a href=\"https://ourai.ws/posts/working-with-git-in-team/\" target=\"_blank\" rel=\"external\">团队中的Git实践</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2015/08/git-use-process.html\" target=\"_blank\" rel=\"external\">Git 使用规范流程</a></li>\n<li><a href=\"http://nvie.com/files/Git-branching-model.pdf\" target=\"_blank\" rel=\"external\">Git分支管理模型</a></li>\n<li><a href=\"http://marklodato.github.io/visual-git-guide/index-zh-cn.html\" target=\"_blank\" rel=\"external\">图解Git</a></li>\n</ol>\n<hr>\n\n<h2 id=\"1-关于-SourceTree\"><a href=\"#1-关于-SourceTree\" class=\"headerlink\" title=\"1. 关于 SourceTree\"></a>1. 关于 SourceTree</h2><h4 id=\"SourceTree-是一款免费且同时支持Windows-和Mac-的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。\"><a href=\"#SourceTree-是一款免费且同时支持Windows-和Mac-的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。\" class=\"headerlink\" title=\"SourceTree 是一款免费且同时支持Windows 和Mac 的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。\"></a>SourceTree 是一款免费且同时支持Windows 和Mac 的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。</h4><blockquote>\n<p>官网： <a href=\"https://www.sourcetreeapp.com/\" target=\"_blank\" rel=\"external\">https://www.sourcetreeapp.com/</a></p>\n</blockquote>\n<h2 id=\"2-git帐号建立\"><a href=\"#2-git帐号建立\" class=\"headerlink\" title=\"2. git帐号建立\"></a>2. git帐号建立</h2><h3 id=\"1-新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：\"><a href=\"#1-新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：\" class=\"headerlink\" title=\"1. 新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：\"></a>1. 新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree02.jpg\" alt=\"image\"></p>\n<h3 id=\"2-点击邮件中的-“Click-here-to-set-your-password”，设置gitlab登陆密码。\"><a href=\"#2-点击邮件中的-“Click-here-to-set-your-password”，设置gitlab登陆密码。\" class=\"headerlink\" title=\"2. 点击邮件中的 “Click here to set your password”，设置gitlab登陆密码。\"></a>2. 点击邮件中的 “Click here to set your password”，设置gitlab登陆密码。</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsouretree03.jpg\" alt=\"image\"></p>\n<h3 id=\"3-登陆gitlab帐号，将会出现这个界面：\"><a href=\"#3-登陆gitlab帐号，将会出现这个界面：\" class=\"headerlink\" title=\"3. 登陆gitlab帐号，将会出现这个界面：\"></a>3. 登陆gitlab帐号，将会出现这个界面：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree05.jpg\" alt=\"image\"></p>\n<h3 id=\"4-设定个人信息：\"><a href=\"#4-设定个人信息：\" class=\"headerlink\" title=\"4. 设定个人信息：\"></a>4. 设定个人信息：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsouretree06.jpg\" alt=\"image\"></p>\n<h3 id=\"5-sshKey\"><a href=\"#5-sshKey\" class=\"headerlink\" title=\"5. sshKey\"></a>5. sshKey</h3><h4 id=\"5-1-在Linux和Mac上生成sshkey：\"><a href=\"#5-1-在Linux和Mac上生成sshkey：\" class=\"headerlink\" title=\"5.1 在Linux和Mac上生成sshkey：\"></a>5.1 在Linux和Mac上生成sshkey：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">➜  ~ ssh-keygen -t rsa</div><div class=\"line\">Generating public/private rsa key pair.</div><div class=\"line\">Enter file in which to save the key (/Users/Alex/.ssh/id_rsa):</div><div class=\"line\">Enter passphrase (empty for no passphrase):</div><div class=\"line\">Enter same passphrase again:</div><div class=\"line\">Your identification has been saved in /Users/Alex/.ssh/id_rsa.</div><div class=\"line\">Your public key has been saved in /Users/Alex/.ssh/id_rsa.pub.</div><div class=\"line\">The key fingerprint is:</div><div class=\"line\">SHA256:98jE3jhBhFT5nQlZRj34a3WOk1t6XF+Dbf/hliXl4WQ Alex@Alex-Mac</div><div class=\"line\">The key&apos;s randomart image is:</div><div class=\"line\">+---[RSA 2048]----+</div><div class=\"line\">|       ..oo. +=. |</div><div class=\"line\">|        ... oo ..|</div><div class=\"line\">|          .. o.o.|</div><div class=\"line\">|         o  . +E+|</div><div class=\"line\">|        S =   **=|</div><div class=\"line\">|         = * .=BB|</div><div class=\"line\">|          * o oOO|</div><div class=\"line\">|           .  +o*|</div><div class=\"line\">|              .oo|</div><div class=\"line\">+----[SHA256]-----+</div><div class=\"line\">➜  ~ cat ~/.ssh/id_rsa.pub</div><div class=\"line\">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCvuQAq65b+nLZPqqc3b3Mj9e7Pt8oWKasJFa2QH1VIEkDvxKLFGcHsT7Ur4zXwEi9YiW2tVRrBSjcMALxuBjVm2IxYV6Lk8SLuGadyYy5telWGJmHsQ3VIPRuKwpzTkLN643kjqc6JFSlnZG/XoP9SPtCOsp2ql4u0s7Auc2bZay4RaTDXbcpJVU9OA0xM8Zy4oTTNYdZ4tvGittVmn+wLrhN255J7clORF5126dmDYxV3E8ZboaDdQpdLGIWmDNcBJQvl0CLwpKUCi7EUDqDVtm4bNgwIX9fEIkTxGdaWjBW1iXBk8TGXWkgB+Qp8B1IwaJ4GHUwUhQrefWvw9XeJ Alex@Alex-Mac</div><div class=\"line\">➜  ~</div></pre></td></tr></table></figure>\n<h4 id=\"5-2-在Windows上生成sshkey：\"><a href=\"#5-2-在Windows上生成sshkey：\" class=\"headerlink\" title=\"5.2 在Windows上生成sshkey：\"></a>5.2 在Windows上生成sshkey：</h4><h4 id=\"因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen-exe生成sshkey-下载地址\"><a href=\"#因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen-exe生成sshkey-下载地址\" class=\"headerlink\" title=\"因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen.exe生成sshkey 下载地址\"></a>因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen.exe生成sshkey <a href=\"http://the.earth.li/~sgtatham/putty/0.67/x86/puttygen.exe\" target=\"_blank\" rel=\"external\">下载地址</a></h4><h4 id=\"步骤如下：\"><a href=\"#步骤如下：\" class=\"headerlink\" title=\"步骤如下：\"></a>步骤如下：</h4><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree13.jpg\" alt=\"image\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree14.jpg\" alt=\"image\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree15.jpg\" alt=\"image\"></p>\n<h4 id=\"当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private-ppk文件\"><a href=\"#当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private-ppk文件\" class=\"headerlink\" title=\"当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private.ppk文件\"></a>当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private.ppk文件</h4><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree12.jpg\" alt=\"image\"></p>\n<h4 id=\"5-3-上传sshkey：\"><a href=\"#5-3-上传sshkey：\" class=\"headerlink\" title=\"5.3 上传sshkey：\"></a>5.3 上传sshkey：</h4><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree07.jpg\" alt=\"image\"></p>\n<h3 id=\"6-回到-dashboard-，点击项目名称进入详情：\"><a href=\"#6-回到-dashboard-，点击项目名称进入详情：\" class=\"headerlink\" title=\"6. 回到 dashboard ，点击项目名称进入详情：\"></a>6. 回到 dashboard ，点击项目名称进入详情：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree08.jpg\" alt=\"image\"></p>\n<h3 id=\"7-使用souretree将项目从git服务器clone到本地\"><a href=\"#7-使用souretree将项目从git服务器clone到本地\" class=\"headerlink\" title=\"7. 使用souretree将项目从git服务器clone到本地\"></a>7. 使用souretree将项目从git服务器clone到本地</h3><h4 id=\"7-1-安装souretree-软件-［略］\"><a href=\"#7-1-安装souretree-软件-［略］\" class=\"headerlink\" title=\"7.1 安装souretree 软件 ［略］\"></a>7.1 安装souretree 软件 ［略］</h4><h4 id=\"7-2-clone项目到本地\"><a href=\"#7-2-clone项目到本地\" class=\"headerlink\" title=\"7.2 clone项目到本地\"></a>7.2 clone项目到本地</h4><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree09.jpg\" alt=\"image\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree10.jpg\" alt=\"image\"></p>\n<h3 id=\"8-进入项目工作台：\"><a href=\"#8-进入项目工作台：\" class=\"headerlink\" title=\"8. 进入项目工作台：\"></a>8. 进入项目工作台：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree11.jpg\" alt=\"image\"></p>\n<h4 id=\"9-关于sourcetree工具的使用，下面是一些git操作的释疑。\"><a href=\"#9-关于sourcetree工具的使用，下面是一些git操作的释疑。\" class=\"headerlink\" title=\"9. 关于sourcetree工具的使用，下面是一些git操作的释疑。\"></a>9. 关于sourcetree工具的使用，下面是一些git操作的释疑。</h4><ul>\n<li>检出仓库: 将在本地创建一个git仓库的克隆版本</li>\n<li>工作流: 本地仓库由 git 维护的三棵“树”组成。第一个是 工作目录，它持有实际文件；第二个是 缓存区（Index），它像个缓存区域，临时保存改动；最后是 HEAD，指向最近一次提交后的结果。</li>\n<li>提交：可以计划改动（把它们添加到缓存区),将改动提交到了 HEAD，但是还没到提交到远端仓库。</li>\n<li>拉取：从远端仓库拉取最新版本状态，特别是在其他人员有所改动之后。</li>\n<li>推送：改动现在已经在本地仓库的 HEAD 中了。这时可以使用它将这些改动提交到远端仓库。</li>\n<li>分支：分支是用来将特性开发分离出来的。在创建仓库的时候，master 是“默认的”。创建分支将可以从主线开发上分离开来，然后在不影响主线的同时继续工作，完成后再将它们合并到主分支上。</li>\n<li>合并： 将分支功能并入主分支。</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h6 id=\"Update\"><a href=\"#Update\" class=\"headerlink\" title=\"Update\"></a>Update</h6><ul>\n<li><font color=red>update: Windows用户在初始化Souretree工具时，需要用到Atlassian ID，新建用户时需要加载google 验证码，这一步需要VPN的支持，请注意。</font></li>\n<li>找到一个版本的SourceTree工具可以不需要以上验证也能使用，下载链接：<a href=\"https://pan.baidu.com/s/1bJOzOq\">SourceTreeSetup_1.6.14.exe</a></li>\n</ul>\n<p><br></p>\n<h5 id=\"补充1-：Git学习网站\"><a href=\"#补充1-：Git学习网站\" class=\"headerlink\" title=\"补充1 ：Git学习网站\"></a>补充1 ：Git学习网站</h5><ol>\n<li><a href=\"http://backlogtool.com/git-guide/cn/\">猴子都能学会的git教程</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html\">常用 Git 命令清单</a></li>\n<li><a href=\"http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000\">廖雪峰的git教程</a></li>\n<li><a href=\"http://zoomq.qiniudn.com/ZQScrapBook/ZqFLOSS/data/20081210180347/\">Why Git is Better than X</a></li>\n</ol>\n<h5 id=\"补充2-：利用Git协同开发\"><a href=\"#补充2-：利用Git协同开发\" class=\"headerlink\" title=\"补充2 ：利用Git协同开发\"></a>补充2 ：利用Git协同开发</h5><ol>\n<li><a href=\"https://ourai.ws/posts/working-with-git-in-team/\">团队中的Git实践</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2015/08/git-use-process.html\">Git 使用规范流程</a></li>\n<li><a href=\"http://nvie.com/files/Git-branching-model.pdf\">Git分支管理模型</a></li>\n<li><a href=\"http://marklodato.github.io/visual-git-guide/index-zh-cn.html\">图解Git</a></li>\n</ol>\n<hr>\n\n<h2 id=\"1-关于-SourceTree\"><a href=\"#1-关于-SourceTree\" class=\"headerlink\" title=\"1. 关于 SourceTree\"></a>1. 关于 SourceTree</h2><h4 id=\"SourceTree-是一款免费且同时支持Windows-和Mac-的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。\"><a href=\"#SourceTree-是一款免费且同时支持Windows-和Mac-的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。\" class=\"headerlink\" title=\"SourceTree 是一款免费且同时支持Windows 和Mac 的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。\"></a>SourceTree 是一款免费且同时支持Windows 和Mac 的git项目管理软件，本文旨在给大家介绍这款应用的基础使用，并用它来管理你的项目。</h4><blockquote>\n<p>官网： <a href=\"https://www.sourcetreeapp.com/\">https://www.sourcetreeapp.com/</a></p>\n</blockquote>\n<h2 id=\"2-git帐号建立\"><a href=\"#2-git帐号建立\" class=\"headerlink\" title=\"2. git帐号建立\"></a>2. git帐号建立</h2><h3 id=\"1-新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：\"><a href=\"#1-新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：\" class=\"headerlink\" title=\"1. 新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：\"></a>1. 新员工入职之后，你的公司邮箱内会收到一封来自Gitlab的邮件，如下图：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree02.jpg\" alt=\"image\"></p>\n<h3 id=\"2-点击邮件中的-“Click-here-to-set-your-password”，设置gitlab登陆密码。\"><a href=\"#2-点击邮件中的-“Click-here-to-set-your-password”，设置gitlab登陆密码。\" class=\"headerlink\" title=\"2. 点击邮件中的 “Click here to set your password”，设置gitlab登陆密码。\"></a>2. 点击邮件中的 “Click here to set your password”，设置gitlab登陆密码。</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsouretree03.jpg\" alt=\"image\"></p>\n<h3 id=\"3-登陆gitlab帐号，将会出现这个界面：\"><a href=\"#3-登陆gitlab帐号，将会出现这个界面：\" class=\"headerlink\" title=\"3. 登陆gitlab帐号，将会出现这个界面：\"></a>3. 登陆gitlab帐号，将会出现这个界面：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree05.jpg\" alt=\"image\"></p>\n<h3 id=\"4-设定个人信息：\"><a href=\"#4-设定个人信息：\" class=\"headerlink\" title=\"4. 设定个人信息：\"></a>4. 设定个人信息：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsouretree06.jpg\" alt=\"image\"></p>\n<h3 id=\"5-sshKey\"><a href=\"#5-sshKey\" class=\"headerlink\" title=\"5. sshKey\"></a>5. sshKey</h3><h4 id=\"5-1-在Linux和Mac上生成sshkey：\"><a href=\"#5-1-在Linux和Mac上生成sshkey：\" class=\"headerlink\" title=\"5.1 在Linux和Mac上生成sshkey：\"></a>5.1 在Linux和Mac上生成sshkey：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">➜  ~ ssh-keygen -t rsa</div><div class=\"line\">Generating public/private rsa key pair.</div><div class=\"line\">Enter file in which to save the key (/Users/Alex/.ssh/id_rsa):</div><div class=\"line\">Enter passphrase (empty for no passphrase):</div><div class=\"line\">Enter same passphrase again:</div><div class=\"line\">Your identification has been saved in /Users/Alex/.ssh/id_rsa.</div><div class=\"line\">Your public key has been saved in /Users/Alex/.ssh/id_rsa.pub.</div><div class=\"line\">The key fingerprint is:</div><div class=\"line\">SHA256:98jE3jhBhFT5nQlZRj34a3WOk1t6XF+Dbf/hliXl4WQ Alex@Alex-Mac</div><div class=\"line\">The key&apos;s randomart image is:</div><div class=\"line\">+---[RSA 2048]----+</div><div class=\"line\">|       ..oo. +=. |</div><div class=\"line\">|        ... oo ..|</div><div class=\"line\">|          .. o.o.|</div><div class=\"line\">|         o  . +E+|</div><div class=\"line\">|        S =   **=|</div><div class=\"line\">|         = * .=BB|</div><div class=\"line\">|          * o oOO|</div><div class=\"line\">|           .  +o*|</div><div class=\"line\">|              .oo|</div><div class=\"line\">+----[SHA256]-----+</div><div class=\"line\">➜  ~ cat ~/.ssh/id_rsa.pub</div><div class=\"line\">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCvuQAq65b+nLZPqqc3b3Mj9e7Pt8oWKasJFa2QH1VIEkDvxKLFGcHsT7Ur4zXwEi9YiW2tVRrBSjcMALxuBjVm2IxYV6Lk8SLuGadyYy5telWGJmHsQ3VIPRuKwpzTkLN643kjqc6JFSlnZG/XoP9SPtCOsp2ql4u0s7Auc2bZay4RaTDXbcpJVU9OA0xM8Zy4oTTNYdZ4tvGittVmn+wLrhN255J7clORF5126dmDYxV3E8ZboaDdQpdLGIWmDNcBJQvl0CLwpKUCi7EUDqDVtm4bNgwIX9fEIkTxGdaWjBW1iXBk8TGXWkgB+Qp8B1IwaJ4GHUwUhQrefWvw9XeJ Alex@Alex-Mac</div><div class=\"line\">➜  ~</div></pre></td></tr></table></figure>\n<h4 id=\"5-2-在Windows上生成sshkey：\"><a href=\"#5-2-在Windows上生成sshkey：\" class=\"headerlink\" title=\"5.2 在Windows上生成sshkey：\"></a>5.2 在Windows上生成sshkey：</h4><h4 id=\"因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen-exe生成sshkey-下载地址\"><a href=\"#因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen-exe生成sshkey-下载地址\" class=\"headerlink\" title=\"因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen.exe生成sshkey 下载地址\"></a>因为windows没有自带openssl模块，所以在Windows环境中使用第三方工具puttygen.exe生成sshkey <a href=\"http://the.earth.li/~sgtatham/putty/0.67/x86/puttygen.exe\">下载地址</a></h4><h4 id=\"步骤如下：\"><a href=\"#步骤如下：\" class=\"headerlink\" title=\"步骤如下：\"></a>步骤如下：</h4><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree13.jpg\" alt=\"image\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree14.jpg\" alt=\"image\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree15.jpg\" alt=\"image\"></p>\n<h4 id=\"当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private-ppk文件\"><a href=\"#当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private-ppk文件\" class=\"headerlink\" title=\"当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private.ppk文件\"></a>当sourcetree首次启动时，会弹出加载sshkey的提示，按提示操作，找到之前保存的private.ppk文件</h4><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree12.jpg\" alt=\"image\"></p>\n<h4 id=\"5-3-上传sshkey：\"><a href=\"#5-3-上传sshkey：\" class=\"headerlink\" title=\"5.3 上传sshkey：\"></a>5.3 上传sshkey：</h4><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree07.jpg\" alt=\"image\"></p>\n<h3 id=\"6-回到-dashboard-，点击项目名称进入详情：\"><a href=\"#6-回到-dashboard-，点击项目名称进入详情：\" class=\"headerlink\" title=\"6. 回到 dashboard ，点击项目名称进入详情：\"></a>6. 回到 dashboard ，点击项目名称进入详情：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree08.jpg\" alt=\"image\"></p>\n<h3 id=\"7-使用souretree将项目从git服务器clone到本地\"><a href=\"#7-使用souretree将项目从git服务器clone到本地\" class=\"headerlink\" title=\"7. 使用souretree将项目从git服务器clone到本地\"></a>7. 使用souretree将项目从git服务器clone到本地</h3><h4 id=\"7-1-安装souretree-软件-［略］\"><a href=\"#7-1-安装souretree-软件-［略］\" class=\"headerlink\" title=\"7.1 安装souretree 软件 ［略］\"></a>7.1 安装souretree 软件 ［略］</h4><h4 id=\"7-2-clone项目到本地\"><a href=\"#7-2-clone项目到本地\" class=\"headerlink\" title=\"7.2 clone项目到本地\"></a>7.2 clone项目到本地</h4><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree09.jpg\" alt=\"image\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree10.jpg\" alt=\"image\"></p>\n<h3 id=\"8-进入项目工作台：\"><a href=\"#8-进入项目工作台：\" class=\"headerlink\" title=\"8. 进入项目工作台：\"></a>8. 进入项目工作台：</h3><p><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2Fsourcetree11.jpg\" alt=\"image\"></p>\n<h4 id=\"9-关于sourcetree工具的使用，下面是一些git操作的释疑。\"><a href=\"#9-关于sourcetree工具的使用，下面是一些git操作的释疑。\" class=\"headerlink\" title=\"9. 关于sourcetree工具的使用，下面是一些git操作的释疑。\"></a>9. 关于sourcetree工具的使用，下面是一些git操作的释疑。</h4><ul>\n<li>检出仓库: 将在本地创建一个git仓库的克隆版本</li>\n<li>工作流: 本地仓库由 git 维护的三棵“树”组成。第一个是 工作目录，它持有实际文件；第二个是 缓存区（Index），它像个缓存区域，临时保存改动；最后是 HEAD，指向最近一次提交后的结果。</li>\n<li>提交：可以计划改动（把它们添加到缓存区),将改动提交到了 HEAD，但是还没到提交到远端仓库。</li>\n<li>拉取：从远端仓库拉取最新版本状态，特别是在其他人员有所改动之后。</li>\n<li>推送：改动现在已经在本地仓库的 HEAD 中了。这时可以使用它将这些改动提交到远端仓库。</li>\n<li>分支：分支是用来将特性开发分离出来的。在创建仓库的时候，master 是“默认的”。创建分支将可以从主线开发上分离开来，然后在不影响主线的同时继续工作，完成后再将它们合并到主分支上。</li>\n<li>合并： 将分支功能并入主分支。</li>\n</ul>\n"},{"title":"使用mosh代替ssh连接服务器","id":"57","updated":"2017-04-21T05:28:36.000Z","date":"2016-06-15T18:28:02.000Z","_content":"\n身为一名服务器运维人员，每天打交道最多的就是服务器了，最常用的连接服务器的工具就是SSH，因为SSH是一个不可持续的连接，当网络出现波动时，SSH断开会导致当前正在运行的服务中断，对工作产生非常大的影响，无意间看到了Mosh这个东西，安装使用下，发现网络波动这种事情不会导致服务器连接断开了，特意查了下，原来Mosh使用的是UDP方式传输：虽然也支持使用SSH配置进行认证登录，但是数据传输本身是使用UDP方式的，Mosh支持在会话中断时，不会立即退出，而是启用一个计时器，当网络恢复后会自动连接，同时会延续之前的会话，不会重新开启一个。\n\n#### Mosh [主页](https://mosh.mit.edu/#getting)\n\n\n#### 1. 安装配置\n需要在服务端和客户端同时安装Mosh：\n```\n＃ 以centos 6.x 为例：\n[user@host ~]$ sudo yum install -y epel-release\n[user@host ~]$ sudo yum install -y mosh\n```\n\n#### 2. 采用SSH配置进行认证登录，只需要将ssh 替换为mosh即可\n```\n[user@host ~]$ mosh user@host\n\n# 如何需要指定特定的ssh port或者使用ssh keyfile. 可以使用-ssh参数：\n[user@host ~]$ mosh -ssh=\"ssh -i ~/.ssh/id_rsa -p 10002\" user@host\n```\n\n#### 3. Other\n另外Mosh还支持使用临时key的方式认证，需要服务器端创建临时key，然后客户端通过这个key进行登录，该key在会话结束的十分钟后自动失效。\n\n```\n# 创建临时key\n[user@host ~]$ mosh-server\nMOSH CONNECT 53371 asdAADfdse234LSDSdIbow\nmosh-server (mosh 1.2.4)\nCopyright 2012 Keith Winstein <mosh-devel@mit.edu>\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n[mosh-server detached, pid = 27290]\n\n# 然后在client定义MOSH_KEY\n[user@host ~]$ export MOSH_KEY=asdAADfdse234LSDSdIbow\n# 注意mosh-client只能跟上具体的ip和临时端口，不支持主机名和域名方式\n\n# 使用临时key连接服务器\n[user@host ~]$ mosh-client 10.0.2.4 53371\n```\n","source":"_posts/使用mosh代替ssh连接服务器.md","raw":"---\ntitle: 使用mosh代替ssh连接服务器\ntags: 'SSH'\ncategories: 'Linux'\npermalink: shi-yong-moshdai-ti-sshlian-jie-fu-wu-qi\nid: 57\nupdated: '2017-04-21 13:28:36'\ndate: 2016-06-16 02:28:02\n---\n\n身为一名服务器运维人员，每天打交道最多的就是服务器了，最常用的连接服务器的工具就是SSH，因为SSH是一个不可持续的连接，当网络出现波动时，SSH断开会导致当前正在运行的服务中断，对工作产生非常大的影响，无意间看到了Mosh这个东西，安装使用下，发现网络波动这种事情不会导致服务器连接断开了，特意查了下，原来Mosh使用的是UDP方式传输：虽然也支持使用SSH配置进行认证登录，但是数据传输本身是使用UDP方式的，Mosh支持在会话中断时，不会立即退出，而是启用一个计时器，当网络恢复后会自动连接，同时会延续之前的会话，不会重新开启一个。\n\n#### Mosh [主页](https://mosh.mit.edu/#getting)\n\n\n#### 1. 安装配置\n需要在服务端和客户端同时安装Mosh：\n```\n＃ 以centos 6.x 为例：\n[user@host ~]$ sudo yum install -y epel-release\n[user@host ~]$ sudo yum install -y mosh\n```\n\n#### 2. 采用SSH配置进行认证登录，只需要将ssh 替换为mosh即可\n```\n[user@host ~]$ mosh user@host\n\n# 如何需要指定特定的ssh port或者使用ssh keyfile. 可以使用-ssh参数：\n[user@host ~]$ mosh -ssh=\"ssh -i ~/.ssh/id_rsa -p 10002\" user@host\n```\n\n#### 3. Other\n另外Mosh还支持使用临时key的方式认证，需要服务器端创建临时key，然后客户端通过这个key进行登录，该key在会话结束的十分钟后自动失效。\n\n```\n# 创建临时key\n[user@host ~]$ mosh-server\nMOSH CONNECT 53371 asdAADfdse234LSDSdIbow\nmosh-server (mosh 1.2.4)\nCopyright 2012 Keith Winstein <mosh-devel@mit.edu>\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n[mosh-server detached, pid = 27290]\n\n# 然后在client定义MOSH_KEY\n[user@host ~]$ export MOSH_KEY=asdAADfdse234LSDSdIbow\n# 注意mosh-client只能跟上具体的ip和临时端口，不支持主机名和域名方式\n\n# 使用临时key连接服务器\n[user@host ~]$ mosh-client 10.0.2.4 53371\n```\n","slug":"shi-yong-moshdai-ti-sshlian-jie-fu-wu-qi","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqde007841tp3kuny36y","content":"<p>身为一名服务器运维人员，每天打交道最多的就是服务器了，最常用的连接服务器的工具就是SSH，因为SSH是一个不可持续的连接，当网络出现波动时，SSH断开会导致当前正在运行的服务中断，对工作产生非常大的影响，无意间看到了Mosh这个东西，安装使用下，发现网络波动这种事情不会导致服务器连接断开了，特意查了下，原来Mosh使用的是UDP方式传输：虽然也支持使用SSH配置进行认证登录，但是数据传输本身是使用UDP方式的，Mosh支持在会话中断时，不会立即退出，而是启用一个计时器，当网络恢复后会自动连接，同时会延续之前的会话，不会重新开启一个。</p>\n<h4 id=\"Mosh-主页\"><a href=\"#Mosh-主页\" class=\"headerlink\" title=\"Mosh 主页\"></a>Mosh <a href=\"https://mosh.mit.edu/#getting\" target=\"_blank\" rel=\"external\">主页</a></h4><h4 id=\"1-安装配置\"><a href=\"#1-安装配置\" class=\"headerlink\" title=\"1. 安装配置\"></a>1. 安装配置</h4><p>需要在服务端和客户端同时安装Mosh：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">＃ 以centos 6.x 为例：</div><div class=\"line\">[user@host ~]$ sudo yum install -y epel-release</div><div class=\"line\">[user@host ~]$ sudo yum install -y mosh</div></pre></td></tr></table></figure></p>\n<h4 id=\"2-采用SSH配置进行认证登录，只需要将ssh-替换为mosh即可\"><a href=\"#2-采用SSH配置进行认证登录，只需要将ssh-替换为mosh即可\" class=\"headerlink\" title=\"2. 采用SSH配置进行认证登录，只需要将ssh 替换为mosh即可\"></a>2. 采用SSH配置进行认证登录，只需要将ssh 替换为mosh即可</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[user@host ~]$ mosh user@host</div><div class=\"line\"></div><div class=\"line\"># 如何需要指定特定的ssh port或者使用ssh keyfile. 可以使用-ssh参数：</div><div class=\"line\">[user@host ~]$ mosh -ssh=&quot;ssh -i ~/.ssh/id_rsa -p 10002&quot; user@host</div></pre></td></tr></table></figure>\n<h4 id=\"3-Other\"><a href=\"#3-Other\" class=\"headerlink\" title=\"3. Other\"></a>3. Other</h4><p>另外Mosh还支持使用临时key的方式认证，需要服务器端创建临时key，然后客户端通过这个key进行登录，该key在会话结束的十分钟后自动失效。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 创建临时key</div><div class=\"line\">[user@host ~]$ mosh-server</div><div class=\"line\">MOSH CONNECT 53371 asdAADfdse234LSDSdIbow</div><div class=\"line\">mosh-server (mosh 1.2.4)</div><div class=\"line\">Copyright 2012 Keith Winstein &lt;mosh-devel@mit.edu&gt;</div><div class=\"line\">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;.</div><div class=\"line\">This is free software: you are free to change and redistribute it.</div><div class=\"line\">There is NO WARRANTY, to the extent permitted by law.</div><div class=\"line\">[mosh-server detached, pid = 27290]</div><div class=\"line\"></div><div class=\"line\"># 然后在client定义MOSH_KEY</div><div class=\"line\">[user@host ~]$ export MOSH_KEY=asdAADfdse234LSDSdIbow</div><div class=\"line\"># 注意mosh-client只能跟上具体的ip和临时端口，不支持主机名和域名方式</div><div class=\"line\"></div><div class=\"line\"># 使用临时key连接服务器</div><div class=\"line\">[user@host ~]$ mosh-client 10.0.2.4 53371</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>身为一名服务器运维人员，每天打交道最多的就是服务器了，最常用的连接服务器的工具就是SSH，因为SSH是一个不可持续的连接，当网络出现波动时，SSH断开会导致当前正在运行的服务中断，对工作产生非常大的影响，无意间看到了Mosh这个东西，安装使用下，发现网络波动这种事情不会导致服务器连接断开了，特意查了下，原来Mosh使用的是UDP方式传输：虽然也支持使用SSH配置进行认证登录，但是数据传输本身是使用UDP方式的，Mosh支持在会话中断时，不会立即退出，而是启用一个计时器，当网络恢复后会自动连接，同时会延续之前的会话，不会重新开启一个。</p>\n<h4 id=\"Mosh-主页\"><a href=\"#Mosh-主页\" class=\"headerlink\" title=\"Mosh 主页\"></a>Mosh <a href=\"https://mosh.mit.edu/#getting\">主页</a></h4><h4 id=\"1-安装配置\"><a href=\"#1-安装配置\" class=\"headerlink\" title=\"1. 安装配置\"></a>1. 安装配置</h4><p>需要在服务端和客户端同时安装Mosh：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">＃ 以centos 6.x 为例：</div><div class=\"line\">[user@host ~]$ sudo yum install -y epel-release</div><div class=\"line\">[user@host ~]$ sudo yum install -y mosh</div></pre></td></tr></table></figure></p>\n<h4 id=\"2-采用SSH配置进行认证登录，只需要将ssh-替换为mosh即可\"><a href=\"#2-采用SSH配置进行认证登录，只需要将ssh-替换为mosh即可\" class=\"headerlink\" title=\"2. 采用SSH配置进行认证登录，只需要将ssh 替换为mosh即可\"></a>2. 采用SSH配置进行认证登录，只需要将ssh 替换为mosh即可</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[user@host ~]$ mosh user@host</div><div class=\"line\"></div><div class=\"line\"># 如何需要指定特定的ssh port或者使用ssh keyfile. 可以使用-ssh参数：</div><div class=\"line\">[user@host ~]$ mosh -ssh=&quot;ssh -i ~/.ssh/id_rsa -p 10002&quot; user@host</div></pre></td></tr></table></figure>\n<h4 id=\"3-Other\"><a href=\"#3-Other\" class=\"headerlink\" title=\"3. Other\"></a>3. Other</h4><p>另外Mosh还支持使用临时key的方式认证，需要服务器端创建临时key，然后客户端通过这个key进行登录，该key在会话结束的十分钟后自动失效。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 创建临时key</div><div class=\"line\">[user@host ~]$ mosh-server</div><div class=\"line\">MOSH CONNECT 53371 asdAADfdse234LSDSdIbow</div><div class=\"line\">mosh-server (mosh 1.2.4)</div><div class=\"line\">Copyright 2012 Keith Winstein &lt;mosh-devel@mit.edu&gt;</div><div class=\"line\">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;.</div><div class=\"line\">This is free software: you are free to change and redistribute it.</div><div class=\"line\">There is NO WARRANTY, to the extent permitted by law.</div><div class=\"line\">[mosh-server detached, pid = 27290]</div><div class=\"line\"></div><div class=\"line\"># 然后在client定义MOSH_KEY</div><div class=\"line\">[user@host ~]$ export MOSH_KEY=asdAADfdse234LSDSdIbow</div><div class=\"line\"># 注意mosh-client只能跟上具体的ip和临时端口，不支持主机名和域名方式</div><div class=\"line\"></div><div class=\"line\"># 使用临时key连接服务器</div><div class=\"line\">[user@host ~]$ mosh-client 10.0.2.4 53371</div></pre></td></tr></table></figure>\n"},{"title":"关于考试","id":"10004","date":"2017-04-11T13:34:54.000Z","_content":"\n\n> 时光飞逝，那大概是世界上最糟糕的一种感觉了吧。\n\n有点记不大清楚，上一次为了考试是什么时间了。\n\n我说的考试不是各种面试等无形的考试，而是，你坐在四四方方的台子前，给你纸笔，限定时间，那种紧张的感觉，那种备考的心态。\n\n所以时光会消磨人的斗志，让你不大能聚精会神的准备考试，让你变得懒散，让你变得不再有血性；所以，时间这种东西，不仅会在你的身上刻下斑驳印记，还会磨去你内心的棱角，一旦这样，你就会停下了脚步，大家的生活成了日复一日的重复，日子也过得索然无味，好像很多很多你想做的事，最后都是选择plan B。\n\n促使我写这篇的动力来自于，最近AWS助理级系统架构师的考试，而就在年前的时候，第一次去参加考试，没有通过，而且我一直在想到底是哪里出了问题，尽管我不愿意承认，问题根本是，我根本没有静下心来去准备考试，其实是，现在真的很难去静下心来去做考试这种事情，心气浮躁，要做的事情很多堆积在面前，你可能会被这些事情唬到，所以你很焦虑，光顾着去焦虑了，却没想着去解决这些问题，所以难道你的不是这些看起来很困难的问题，而是，你丧失了解决这些问题的勇气很血性；一方面反映在这里，另一方面也反映在你生活的各个方面，你好像没有动力去处理这些事情，总是在最后关头，勉勉强强叫上一份拼拼凑凑的答卷，这不会是你想要的样子，这是一种病，拖延。\n\n之前看到过的一个视频，讲述的是在New York的街头方一块黑板，让你写下最后悔的事，很多都是自己真正想要做的，却未曾努力去做的事，“最后总是选择plan B”，“未曾跳出自己的舒适圈”，人生总是带有遗憾，总是想象着自己会多么的闪耀，却没有勇气付出真心努力，对我是这样，学习，考试，减肥，很多自己想做的事，如果不能够鼓足勇气去做，人生过着便没有意义。\n\n所以，很多事情，并非要你一定做到，而是，你是否真的努力去付出过，还是假意的敷衍，拖延妥协，这种感觉只有你自己真的知道，最后的遗憾，也只有自己知道，为什么要放手自己想要的。\n\n不要怀疑，不要犹豫，努力去做自己想做的事，努力成为那个，你想要成为的人，永远怀揣着梦想，永远热泪盈眶。\n","source":"_posts/关于考试.md","raw":"---\ntitle: 关于考试\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: about-exam\nid: 10004\ndate: 2017-04-11 21:34:54\n---\n\n\n> 时光飞逝，那大概是世界上最糟糕的一种感觉了吧。\n\n有点记不大清楚，上一次为了考试是什么时间了。\n\n我说的考试不是各种面试等无形的考试，而是，你坐在四四方方的台子前，给你纸笔，限定时间，那种紧张的感觉，那种备考的心态。\n\n所以时光会消磨人的斗志，让你不大能聚精会神的准备考试，让你变得懒散，让你变得不再有血性；所以，时间这种东西，不仅会在你的身上刻下斑驳印记，还会磨去你内心的棱角，一旦这样，你就会停下了脚步，大家的生活成了日复一日的重复，日子也过得索然无味，好像很多很多你想做的事，最后都是选择plan B。\n\n促使我写这篇的动力来自于，最近AWS助理级系统架构师的考试，而就在年前的时候，第一次去参加考试，没有通过，而且我一直在想到底是哪里出了问题，尽管我不愿意承认，问题根本是，我根本没有静下心来去准备考试，其实是，现在真的很难去静下心来去做考试这种事情，心气浮躁，要做的事情很多堆积在面前，你可能会被这些事情唬到，所以你很焦虑，光顾着去焦虑了，却没想着去解决这些问题，所以难道你的不是这些看起来很困难的问题，而是，你丧失了解决这些问题的勇气很血性；一方面反映在这里，另一方面也反映在你生活的各个方面，你好像没有动力去处理这些事情，总是在最后关头，勉勉强强叫上一份拼拼凑凑的答卷，这不会是你想要的样子，这是一种病，拖延。\n\n之前看到过的一个视频，讲述的是在New York的街头方一块黑板，让你写下最后悔的事，很多都是自己真正想要做的，却未曾努力去做的事，“最后总是选择plan B”，“未曾跳出自己的舒适圈”，人生总是带有遗憾，总是想象着自己会多么的闪耀，却没有勇气付出真心努力，对我是这样，学习，考试，减肥，很多自己想做的事，如果不能够鼓足勇气去做，人生过着便没有意义。\n\n所以，很多事情，并非要你一定做到，而是，你是否真的努力去付出过，还是假意的敷衍，拖延妥协，这种感觉只有你自己真的知道，最后的遗憾，也只有自己知道，为什么要放手自己想要的。\n\n不要怀疑，不要犹豫，努力去做自己想做的事，努力成为那个，你想要成为的人，永远怀揣着梦想，永远热泪盈眶。\n","slug":"about-exam","published":1,"updated":"2017-04-24T14:13:25.366Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqdh007d41tpax2lmy6k","content":"<blockquote>\n<p>时光飞逝，那大概是世界上最糟糕的一种感觉了吧。</p>\n</blockquote>\n<p>有点记不大清楚，上一次为了考试是什么时间了。</p>\n<p>我说的考试不是各种面试等无形的考试，而是，你坐在四四方方的台子前，给你纸笔，限定时间，那种紧张的感觉，那种备考的心态。</p>\n<p>所以时光会消磨人的斗志，让你不大能聚精会神的准备考试，让你变得懒散，让你变得不再有血性；所以，时间这种东西，不仅会在你的身上刻下斑驳印记，还会磨去你内心的棱角，一旦这样，你就会停下了脚步，大家的生活成了日复一日的重复，日子也过得索然无味，好像很多很多你想做的事，最后都是选择plan B。</p>\n<p>促使我写这篇的动力来自于，最近AWS助理级系统架构师的考试，而就在年前的时候，第一次去参加考试，没有通过，而且我一直在想到底是哪里出了问题，尽管我不愿意承认，问题根本是，我根本没有静下心来去准备考试，其实是，现在真的很难去静下心来去做考试这种事情，心气浮躁，要做的事情很多堆积在面前，你可能会被这些事情唬到，所以你很焦虑，光顾着去焦虑了，却没想着去解决这些问题，所以难道你的不是这些看起来很困难的问题，而是，你丧失了解决这些问题的勇气很血性；一方面反映在这里，另一方面也反映在你生活的各个方面，你好像没有动力去处理这些事情，总是在最后关头，勉勉强强叫上一份拼拼凑凑的答卷，这不会是你想要的样子，这是一种病，拖延。</p>\n<p>之前看到过的一个视频，讲述的是在New York的街头方一块黑板，让你写下最后悔的事，很多都是自己真正想要做的，却未曾努力去做的事，“最后总是选择plan B”，“未曾跳出自己的舒适圈”，人生总是带有遗憾，总是想象着自己会多么的闪耀，却没有勇气付出真心努力，对我是这样，学习，考试，减肥，很多自己想做的事，如果不能够鼓足勇气去做，人生过着便没有意义。</p>\n<p>所以，很多事情，并非要你一定做到，而是，你是否真的努力去付出过，还是假意的敷衍，拖延妥协，这种感觉只有你自己真的知道，最后的遗憾，也只有自己知道，为什么要放手自己想要的。</p>\n<p>不要怀疑，不要犹豫，努力去做自己想做的事，努力成为那个，你想要成为的人，永远怀揣着梦想，永远热泪盈眶。</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>时光飞逝，那大概是世界上最糟糕的一种感觉了吧。</p>\n</blockquote>\n<p>有点记不大清楚，上一次为了考试是什么时间了。</p>\n<p>我说的考试不是各种面试等无形的考试，而是，你坐在四四方方的台子前，给你纸笔，限定时间，那种紧张的感觉，那种备考的心态。</p>\n<p>所以时光会消磨人的斗志，让你不大能聚精会神的准备考试，让你变得懒散，让你变得不再有血性；所以，时间这种东西，不仅会在你的身上刻下斑驳印记，还会磨去你内心的棱角，一旦这样，你就会停下了脚步，大家的生活成了日复一日的重复，日子也过得索然无味，好像很多很多你想做的事，最后都是选择plan B。</p>\n<p>促使我写这篇的动力来自于，最近AWS助理级系统架构师的考试，而就在年前的时候，第一次去参加考试，没有通过，而且我一直在想到底是哪里出了问题，尽管我不愿意承认，问题根本是，我根本没有静下心来去准备考试，其实是，现在真的很难去静下心来去做考试这种事情，心气浮躁，要做的事情很多堆积在面前，你可能会被这些事情唬到，所以你很焦虑，光顾着去焦虑了，却没想着去解决这些问题，所以难道你的不是这些看起来很困难的问题，而是，你丧失了解决这些问题的勇气很血性；一方面反映在这里，另一方面也反映在你生活的各个方面，你好像没有动力去处理这些事情，总是在最后关头，勉勉强强叫上一份拼拼凑凑的答卷，这不会是你想要的样子，这是一种病，拖延。</p>\n<p>之前看到过的一个视频，讲述的是在New York的街头方一块黑板，让你写下最后悔的事，很多都是自己真正想要做的，却未曾努力去做的事，“最后总是选择plan B”，“未曾跳出自己的舒适圈”，人生总是带有遗憾，总是想象着自己会多么的闪耀，却没有勇气付出真心努力，对我是这样，学习，考试，减肥，很多自己想做的事，如果不能够鼓足勇气去做，人生过着便没有意义。</p>\n<p>所以，很多事情，并非要你一定做到，而是，你是否真的努力去付出过，还是假意的敷衍，拖延妥协，这种感觉只有你自己真的知道，最后的遗憾，也只有自己知道，为什么要放手自己想要的。</p>\n<p>不要怀疑，不要犹豫，努力去做自己想做的事，努力成为那个，你想要成为的人，永远怀揣着梦想，永远热泪盈眶。</p>\n"},{"title":"写的weibo","id":"10005","date":"2016-10-14T13:34:54.000Z","_content":"\n\n1. 20岁之前我看郭敬明的书很多，真的对我的人生有很大的影响，20岁以后，我开始看韩寒和王路的书，觉得他们的文字很酷，可以够我装逼来用，因为我看不来那些国外名著大师之作啊，文化水平达不到不能怪谁。\n\n2. 我的姑娘，必定是美好的，是完人，是仙女，是温柔的月光，是清晨初露的霞光，是令人心动的春风，是呼啸着穿堂而过的夏日阳光，是踩着红色高跟鞋踢踏踢踏走进我的胸膛，是历经岁月沧桑依然伴随左右的踏实臂膀。[大叔一直问阿姨要不我站起来你躺会，阿姨一直说我不累，却在我和大叔攀谈依靠在座位上睡着了。]\n\n3. 当你准备接受爱情的时候，就要接受爱情带来的苦涩，焦虑和怅然若失的情绪，就像你打算接受一个人，就要学会接受他的前面后面上面下面，可能下面会比较小，但是你都要学会接受，要么你还准备好开始一段爱情和爱上一个人。\n\n4. 如今社会高度发展的经济文化，的确会让很多人的价值观有失颇比，直观体现就是很多挂作家之名写出乌七八糟的东西反而畅销，进而影响更多读者，所以需要筛选文章，读适合自己的，生活如此，对的是自己，其他则毋庸顾虑，凡事需顾虑的，便对自己无甚意义，弃之亦不可惜。\n\n5. sometimes the only way to move forward is to revisit the things in your past.that were holding you back.you have yo deal with them head on, no matter how scary they may be.beacuse once we do , you'll see that you can go further than you ever imageined. 《The Flash》－ S02E17\n\n6. 莱蒙托夫有首诗《一只船》这样写：一只船孤独地航行在海上，它既不寻求幸福，也不逃避幸福，它只是向前航行，底下是沉静碧蓝的大海，而头顶是金色的太阳。\n\n7. 内心是有难过的地方，每次我望见那一方矮矮的坟墓，都感到距离这么近那么远。\n\n8. 我真不喜欢有些人把自己的惰性归咎于出生命运\n\n9. 你没法让自己做到最好，最起码要努力变的更好\n\n10. 我希望我可以像太阳一样，给你温暖，像树一样成为你的依靠\n\n11. 或是彼此太过沉默，曾经一起走过的那段时光也变得模糊了。其实，我们每个人都会经历很多这样的分离，没有海誓山盟，没有悲恸不已，就是那种不可寻的时间；猛然间才发现我早已失去了你，朋友，愿你一切都好！腐朽的生命会令我们忘记许多人，却夺不去那些美好时光，或已忘记，但它永远真切的存在。\n\n12. 踏上西行的列车，我说睡吧睡吧，醒来就是另一片天空，没有让你忧伤的人儿\n\n13. 每一个存在都是有意义的，当我们的时间用来羡慕、嫉妒、,抱怨的时候，我们存在的意义在哪里？“我就是我，是颜色不一样的烟火”——《我》，我们缺乏的是看清自己的勇气，加油！/微笑\u0003\n\n14. 一定是特别的缘分，才可以一路走来变成一家人，所以啊，没什么好忧伤的\n\n15. 这世间有很多个我，所以我泯然于众我，我与我并没有什么不同，不同的是心，得之我幸，失之我命，得失心重，所以不知己身已入局，正所谓当局者迷，所谓难，只是因为你觉得难，若不舍千万不要放手。\n\n16. 我始终觉得每个人在特定的时间都有很多事情要去做，这个世界上没有你想像中的有那么多童话，你不会是这世界的唯一，在每一刻亦或一个瞬间，有人多人，你只是其中的一个，现实就是如此，你可以幻想可是不能沉沦，感情是无法用言语来形容，你感到伤悲，很多年后你一定会忘记你曾经觉得一辈子都无法忘记的\n\n17. 感情是不可以用言语文字来形容的，我们掌控所有，甚至无法掌控自己，我们能做的只是不要迷失自我，做自己该做的，做自己想做的，做了就不会后悔，年轻的时光，是我们最美好的，应该好好珍惜，因为之后，生活不在简单纯洁，每个人都背负了太多，也许曾经触手可及的是现在的梦想。我一直相信，相信自己。\n\n18. 一个人的时候，可以听听歌，看看书，可以站在车水马龙的路边看着霓虹灯在闪烁 ，然后在身边转身看灯光下自己的影子，感谢你一直陪着我，一个人的时候可以把所有忧伤都表现出来 ，一个人的时候可以暴躁任性 ，总之一个人的时候可以无法无天 。\n\n19. 妄思不能静，混事乱七八糟，可汗，自省吾身吾言吾行吾思\n\n20. 我所有的自负都来自我的自卑，所有的英雄气概都来自于我内心的软弱，所有的振振有词都因为心中满是怀疑。我假装无情，其实是痛恨自己的深情。我以为人生的意义在于四处游荡流亡，其实只是掩饰至今没有找到愿意驻足的地方。——马良 《坦白书》\n\n21. 我猜，只是猜，每个人的一生都会遇见某些人，喜欢上她。有些人在合适的时间里遇到，就像是在春天遇到花开，所以一切都很好，他们会相恋、订婚、结婚、一起生活。而有的人在错误的时间遇到 ，就像是在冬天，隔着冰看见浮上来换气的鱼，所以只能看着，鱼换完气，沉到水下去，就看不见了，再也没有后续。但是我们能说在春天遇到花是对的，而在冬天遇到鱼是错的么？在错误的时间里遇到，就能克制自己不喜欢那个人么？是不是仍然会用尽了力气想去接近，想尽办法掩饰自己，甚至伪装成另外一条鱼。——江南 《龙族》\n\n    +\n\n    ​\n\n22. 可人不是断气的时候才真的死了。有人说人会死三次，第一次是他断气的时候 ，从生物学上他死了；第二次是他下葬的时候，人们来参加他的葬礼，怀念他的一生，然后在社会上他死了，不再会有他的位置；第三次是最后一个记得他的人把他忘记的时候，那时候他才真正的死了。——江南 《龙族》\n","source":"_posts/写的微博.md","raw":"---\ntitle: 写的weibo\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: some-weibo\nid: 10005\ndate: 2016-10-14 21:34:54\n---\n\n\n1. 20岁之前我看郭敬明的书很多，真的对我的人生有很大的影响，20岁以后，我开始看韩寒和王路的书，觉得他们的文字很酷，可以够我装逼来用，因为我看不来那些国外名著大师之作啊，文化水平达不到不能怪谁。\n\n2. 我的姑娘，必定是美好的，是完人，是仙女，是温柔的月光，是清晨初露的霞光，是令人心动的春风，是呼啸着穿堂而过的夏日阳光，是踩着红色高跟鞋踢踏踢踏走进我的胸膛，是历经岁月沧桑依然伴随左右的踏实臂膀。[大叔一直问阿姨要不我站起来你躺会，阿姨一直说我不累，却在我和大叔攀谈依靠在座位上睡着了。]\n\n3. 当你准备接受爱情的时候，就要接受爱情带来的苦涩，焦虑和怅然若失的情绪，就像你打算接受一个人，就要学会接受他的前面后面上面下面，可能下面会比较小，但是你都要学会接受，要么你还准备好开始一段爱情和爱上一个人。\n\n4. 如今社会高度发展的经济文化，的确会让很多人的价值观有失颇比，直观体现就是很多挂作家之名写出乌七八糟的东西反而畅销，进而影响更多读者，所以需要筛选文章，读适合自己的，生活如此，对的是自己，其他则毋庸顾虑，凡事需顾虑的，便对自己无甚意义，弃之亦不可惜。\n\n5. sometimes the only way to move forward is to revisit the things in your past.that were holding you back.you have yo deal with them head on, no matter how scary they may be.beacuse once we do , you'll see that you can go further than you ever imageined. 《The Flash》－ S02E17\n\n6. 莱蒙托夫有首诗《一只船》这样写：一只船孤独地航行在海上，它既不寻求幸福，也不逃避幸福，它只是向前航行，底下是沉静碧蓝的大海，而头顶是金色的太阳。\n\n7. 内心是有难过的地方，每次我望见那一方矮矮的坟墓，都感到距离这么近那么远。\n\n8. 我真不喜欢有些人把自己的惰性归咎于出生命运\n\n9. 你没法让自己做到最好，最起码要努力变的更好\n\n10. 我希望我可以像太阳一样，给你温暖，像树一样成为你的依靠\n\n11. 或是彼此太过沉默，曾经一起走过的那段时光也变得模糊了。其实，我们每个人都会经历很多这样的分离，没有海誓山盟，没有悲恸不已，就是那种不可寻的时间；猛然间才发现我早已失去了你，朋友，愿你一切都好！腐朽的生命会令我们忘记许多人，却夺不去那些美好时光，或已忘记，但它永远真切的存在。\n\n12. 踏上西行的列车，我说睡吧睡吧，醒来就是另一片天空，没有让你忧伤的人儿\n\n13. 每一个存在都是有意义的，当我们的时间用来羡慕、嫉妒、,抱怨的时候，我们存在的意义在哪里？“我就是我，是颜色不一样的烟火”——《我》，我们缺乏的是看清自己的勇气，加油！/微笑\u0003\n\n14. 一定是特别的缘分，才可以一路走来变成一家人，所以啊，没什么好忧伤的\n\n15. 这世间有很多个我，所以我泯然于众我，我与我并没有什么不同，不同的是心，得之我幸，失之我命，得失心重，所以不知己身已入局，正所谓当局者迷，所谓难，只是因为你觉得难，若不舍千万不要放手。\n\n16. 我始终觉得每个人在特定的时间都有很多事情要去做，这个世界上没有你想像中的有那么多童话，你不会是这世界的唯一，在每一刻亦或一个瞬间，有人多人，你只是其中的一个，现实就是如此，你可以幻想可是不能沉沦，感情是无法用言语来形容，你感到伤悲，很多年后你一定会忘记你曾经觉得一辈子都无法忘记的\n\n17. 感情是不可以用言语文字来形容的，我们掌控所有，甚至无法掌控自己，我们能做的只是不要迷失自我，做自己该做的，做自己想做的，做了就不会后悔，年轻的时光，是我们最美好的，应该好好珍惜，因为之后，生活不在简单纯洁，每个人都背负了太多，也许曾经触手可及的是现在的梦想。我一直相信，相信自己。\n\n18. 一个人的时候，可以听听歌，看看书，可以站在车水马龙的路边看着霓虹灯在闪烁 ，然后在身边转身看灯光下自己的影子，感谢你一直陪着我，一个人的时候可以把所有忧伤都表现出来 ，一个人的时候可以暴躁任性 ，总之一个人的时候可以无法无天 。\n\n19. 妄思不能静，混事乱七八糟，可汗，自省吾身吾言吾行吾思\n\n20. 我所有的自负都来自我的自卑，所有的英雄气概都来自于我内心的软弱，所有的振振有词都因为心中满是怀疑。我假装无情，其实是痛恨自己的深情。我以为人生的意义在于四处游荡流亡，其实只是掩饰至今没有找到愿意驻足的地方。——马良 《坦白书》\n\n21. 我猜，只是猜，每个人的一生都会遇见某些人，喜欢上她。有些人在合适的时间里遇到，就像是在春天遇到花开，所以一切都很好，他们会相恋、订婚、结婚、一起生活。而有的人在错误的时间遇到 ，就像是在冬天，隔着冰看见浮上来换气的鱼，所以只能看着，鱼换完气，沉到水下去，就看不见了，再也没有后续。但是我们能说在春天遇到花是对的，而在冬天遇到鱼是错的么？在错误的时间里遇到，就能克制自己不喜欢那个人么？是不是仍然会用尽了力气想去接近，想尽办法掩饰自己，甚至伪装成另外一条鱼。——江南 《龙族》\n\n    +\n\n    ​\n\n22. 可人不是断气的时候才真的死了。有人说人会死三次，第一次是他断气的时候 ，从生物学上他死了；第二次是他下葬的时候，人们来参加他的葬礼，怀念他的一生，然后在社会上他死了，不再会有他的位置；第三次是最后一个记得他的人把他忘记的时候，那时候他才真正的死了。——江南 《龙族》\n","slug":"some-weibo","published":1,"updated":"2017-04-24T14:13:25.366Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqdj007g41tpqt4b91jb","content":"<ol>\n<li><p>20岁之前我看郭敬明的书很多，真的对我的人生有很大的影响，20岁以后，我开始看韩寒和王路的书，觉得他们的文字很酷，可以够我装逼来用，因为我看不来那些国外名著大师之作啊，文化水平达不到不能怪谁。</p>\n</li>\n<li><p>我的姑娘，必定是美好的，是完人，是仙女，是温柔的月光，是清晨初露的霞光，是令人心动的春风，是呼啸着穿堂而过的夏日阳光，是踩着红色高跟鞋踢踏踢踏走进我的胸膛，是历经岁月沧桑依然伴随左右的踏实臂膀。[大叔一直问阿姨要不我站起来你躺会，阿姨一直说我不累，却在我和大叔攀谈依靠在座位上睡着了。]</p>\n</li>\n<li><p>当你准备接受爱情的时候，就要接受爱情带来的苦涩，焦虑和怅然若失的情绪，就像你打算接受一个人，就要学会接受他的前面后面上面下面，可能下面会比较小，但是你都要学会接受，要么你还准备好开始一段爱情和爱上一个人。</p>\n</li>\n<li><p>如今社会高度发展的经济文化，的确会让很多人的价值观有失颇比，直观体现就是很多挂作家之名写出乌七八糟的东西反而畅销，进而影响更多读者，所以需要筛选文章，读适合自己的，生活如此，对的是自己，其他则毋庸顾虑，凡事需顾虑的，便对自己无甚意义，弃之亦不可惜。</p>\n</li>\n<li><p>sometimes the only way to move forward is to revisit the things in your past.that were holding you back.you have yo deal with them head on, no matter how scary they may be.beacuse once we do , you’ll see that you can go further than you ever imageined. 《The Flash》－ S02E17</p>\n</li>\n<li><p>莱蒙托夫有首诗《一只船》这样写：一只船孤独地航行在海上，它既不寻求幸福，也不逃避幸福，它只是向前航行，底下是沉静碧蓝的大海，而头顶是金色的太阳。</p>\n</li>\n<li><p>内心是有难过的地方，每次我望见那一方矮矮的坟墓，都感到距离这么近那么远。</p>\n</li>\n<li><p>我真不喜欢有些人把自己的惰性归咎于出生命运</p>\n</li>\n<li><p>你没法让自己做到最好，最起码要努力变的更好</p>\n</li>\n<li><p>我希望我可以像太阳一样，给你温暖，像树一样成为你的依靠</p>\n</li>\n<li><p>或是彼此太过沉默，曾经一起走过的那段时光也变得模糊了。其实，我们每个人都会经历很多这样的分离，没有海誓山盟，没有悲恸不已，就是那种不可寻的时间；猛然间才发现我早已失去了你，朋友，愿你一切都好！腐朽的生命会令我们忘记许多人，却夺不去那些美好时光，或已忘记，但它永远真切的存在。</p>\n</li>\n<li><p>踏上西行的列车，我说睡吧睡吧，醒来就是另一片天空，没有让你忧伤的人儿</p>\n</li>\n<li><p>每一个存在都是有意义的，当我们的时间用来羡慕、嫉妒、,抱怨的时候，我们存在的意义在哪里？“我就是我，是颜色不一样的烟火”——《我》，我们缺乏的是看清自己的勇气，加油！/微笑\u0003</p>\n</li>\n<li><p>一定是特别的缘分，才可以一路走来变成一家人，所以啊，没什么好忧伤的</p>\n</li>\n<li><p>这世间有很多个我，所以我泯然于众我，我与我并没有什么不同，不同的是心，得之我幸，失之我命，得失心重，所以不知己身已入局，正所谓当局者迷，所谓难，只是因为你觉得难，若不舍千万不要放手。</p>\n</li>\n<li><p>我始终觉得每个人在特定的时间都有很多事情要去做，这个世界上没有你想像中的有那么多童话，你不会是这世界的唯一，在每一刻亦或一个瞬间，有人多人，你只是其中的一个，现实就是如此，你可以幻想可是不能沉沦，感情是无法用言语来形容，你感到伤悲，很多年后你一定会忘记你曾经觉得一辈子都无法忘记的</p>\n</li>\n<li><p>感情是不可以用言语文字来形容的，我们掌控所有，甚至无法掌控自己，我们能做的只是不要迷失自我，做自己该做的，做自己想做的，做了就不会后悔，年轻的时光，是我们最美好的，应该好好珍惜，因为之后，生活不在简单纯洁，每个人都背负了太多，也许曾经触手可及的是现在的梦想。我一直相信，相信自己。</p>\n</li>\n<li><p>一个人的时候，可以听听歌，看看书，可以站在车水马龙的路边看着霓虹灯在闪烁 ，然后在身边转身看灯光下自己的影子，感谢你一直陪着我，一个人的时候可以把所有忧伤都表现出来 ，一个人的时候可以暴躁任性 ，总之一个人的时候可以无法无天 。</p>\n</li>\n<li><p>妄思不能静，混事乱七八糟，可汗，自省吾身吾言吾行吾思</p>\n</li>\n<li><p>我所有的自负都来自我的自卑，所有的英雄气概都来自于我内心的软弱，所有的振振有词都因为心中满是怀疑。我假装无情，其实是痛恨自己的深情。我以为人生的意义在于四处游荡流亡，其实只是掩饰至今没有找到愿意驻足的地方。——马良 《坦白书》</p>\n</li>\n<li><p>我猜，只是猜，每个人的一生都会遇见某些人，喜欢上她。有些人在合适的时间里遇到，就像是在春天遇到花开，所以一切都很好，他们会相恋、订婚、结婚、一起生活。而有的人在错误的时间遇到 ，就像是在冬天，隔着冰看见浮上来换气的鱼，所以只能看着，鱼换完气，沉到水下去，就看不见了，再也没有后续。但是我们能说在春天遇到花是对的，而在冬天遇到鱼是错的么？在错误的时间里遇到，就能克制自己不喜欢那个人么？是不是仍然会用尽了力气想去接近，想尽办法掩饰自己，甚至伪装成另外一条鱼。——江南 《龙族》</p>\n<p>+</p>\n<p>​</p>\n</li>\n<li><p>可人不是断气的时候才真的死了。有人说人会死三次，第一次是他断气的时候 ，从生物学上他死了；第二次是他下葬的时候，人们来参加他的葬礼，怀念他的一生，然后在社会上他死了，不再会有他的位置；第三次是最后一个记得他的人把他忘记的时候，那时候他才真正的死了。——江南 《龙族》</p>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<ol>\n<li><p>20岁之前我看郭敬明的书很多，真的对我的人生有很大的影响，20岁以后，我开始看韩寒和王路的书，觉得他们的文字很酷，可以够我装逼来用，因为我看不来那些国外名著大师之作啊，文化水平达不到不能怪谁。</p>\n</li>\n<li><p>我的姑娘，必定是美好的，是完人，是仙女，是温柔的月光，是清晨初露的霞光，是令人心动的春风，是呼啸着穿堂而过的夏日阳光，是踩着红色高跟鞋踢踏踢踏走进我的胸膛，是历经岁月沧桑依然伴随左右的踏实臂膀。[大叔一直问阿姨要不我站起来你躺会，阿姨一直说我不累，却在我和大叔攀谈依靠在座位上睡着了。]</p>\n</li>\n<li><p>当你准备接受爱情的时候，就要接受爱情带来的苦涩，焦虑和怅然若失的情绪，就像你打算接受一个人，就要学会接受他的前面后面上面下面，可能下面会比较小，但是你都要学会接受，要么你还准备好开始一段爱情和爱上一个人。</p>\n</li>\n<li><p>如今社会高度发展的经济文化，的确会让很多人的价值观有失颇比，直观体现就是很多挂作家之名写出乌七八糟的东西反而畅销，进而影响更多读者，所以需要筛选文章，读适合自己的，生活如此，对的是自己，其他则毋庸顾虑，凡事需顾虑的，便对自己无甚意义，弃之亦不可惜。</p>\n</li>\n<li><p>sometimes the only way to move forward is to revisit the things in your past.that were holding you back.you have yo deal with them head on, no matter how scary they may be.beacuse once we do , you’ll see that you can go further than you ever imageined. 《The Flash》－ S02E17</p>\n</li>\n<li><p>莱蒙托夫有首诗《一只船》这样写：一只船孤独地航行在海上，它既不寻求幸福，也不逃避幸福，它只是向前航行，底下是沉静碧蓝的大海，而头顶是金色的太阳。</p>\n</li>\n<li><p>内心是有难过的地方，每次我望见那一方矮矮的坟墓，都感到距离这么近那么远。</p>\n</li>\n<li><p>我真不喜欢有些人把自己的惰性归咎于出生命运</p>\n</li>\n<li><p>你没法让自己做到最好，最起码要努力变的更好</p>\n</li>\n<li><p>我希望我可以像太阳一样，给你温暖，像树一样成为你的依靠</p>\n</li>\n<li><p>或是彼此太过沉默，曾经一起走过的那段时光也变得模糊了。其实，我们每个人都会经历很多这样的分离，没有海誓山盟，没有悲恸不已，就是那种不可寻的时间；猛然间才发现我早已失去了你，朋友，愿你一切都好！腐朽的生命会令我们忘记许多人，却夺不去那些美好时光，或已忘记，但它永远真切的存在。</p>\n</li>\n<li><p>踏上西行的列车，我说睡吧睡吧，醒来就是另一片天空，没有让你忧伤的人儿</p>\n</li>\n<li><p>每一个存在都是有意义的，当我们的时间用来羡慕、嫉妒、,抱怨的时候，我们存在的意义在哪里？“我就是我，是颜色不一样的烟火”——《我》，我们缺乏的是看清自己的勇气，加油！/微笑\u0003</p>\n</li>\n<li><p>一定是特别的缘分，才可以一路走来变成一家人，所以啊，没什么好忧伤的</p>\n</li>\n<li><p>这世间有很多个我，所以我泯然于众我，我与我并没有什么不同，不同的是心，得之我幸，失之我命，得失心重，所以不知己身已入局，正所谓当局者迷，所谓难，只是因为你觉得难，若不舍千万不要放手。</p>\n</li>\n<li><p>我始终觉得每个人在特定的时间都有很多事情要去做，这个世界上没有你想像中的有那么多童话，你不会是这世界的唯一，在每一刻亦或一个瞬间，有人多人，你只是其中的一个，现实就是如此，你可以幻想可是不能沉沦，感情是无法用言语来形容，你感到伤悲，很多年后你一定会忘记你曾经觉得一辈子都无法忘记的</p>\n</li>\n<li><p>感情是不可以用言语文字来形容的，我们掌控所有，甚至无法掌控自己，我们能做的只是不要迷失自我，做自己该做的，做自己想做的，做了就不会后悔，年轻的时光，是我们最美好的，应该好好珍惜，因为之后，生活不在简单纯洁，每个人都背负了太多，也许曾经触手可及的是现在的梦想。我一直相信，相信自己。</p>\n</li>\n<li><p>一个人的时候，可以听听歌，看看书，可以站在车水马龙的路边看着霓虹灯在闪烁 ，然后在身边转身看灯光下自己的影子，感谢你一直陪着我，一个人的时候可以把所有忧伤都表现出来 ，一个人的时候可以暴躁任性 ，总之一个人的时候可以无法无天 。</p>\n</li>\n<li><p>妄思不能静，混事乱七八糟，可汗，自省吾身吾言吾行吾思</p>\n</li>\n<li><p>我所有的自负都来自我的自卑，所有的英雄气概都来自于我内心的软弱，所有的振振有词都因为心中满是怀疑。我假装无情，其实是痛恨自己的深情。我以为人生的意义在于四处游荡流亡，其实只是掩饰至今没有找到愿意驻足的地方。——马良 《坦白书》</p>\n</li>\n<li><p>我猜，只是猜，每个人的一生都会遇见某些人，喜欢上她。有些人在合适的时间里遇到，就像是在春天遇到花开，所以一切都很好，他们会相恋、订婚、结婚、一起生活。而有的人在错误的时间遇到 ，就像是在冬天，隔着冰看见浮上来换气的鱼，所以只能看着，鱼换完气，沉到水下去，就看不见了，再也没有后续。但是我们能说在春天遇到花是对的，而在冬天遇到鱼是错的么？在错误的时间里遇到，就能克制自己不喜欢那个人么？是不是仍然会用尽了力气想去接近，想尽办法掩饰自己，甚至伪装成另外一条鱼。——江南 《龙族》</p>\n<p>+</p>\n<p>​</p>\n</li>\n<li><p>可人不是断气的时候才真的死了。有人说人会死三次，第一次是他断气的时候 ，从生物学上他死了；第二次是他下葬的时候，人们来参加他的葬礼，怀念他的一生，然后在社会上他死了，不再会有他的位置；第三次是最后一个记得他的人把他忘记的时候，那时候他才真正的死了。——江南 《龙族》</p>\n</li>\n</ol>\n"},{"title":"告别","id":"10006","date":"2016-12-17T02:34:54.000Z","_content":"\n\n你们一起看过很多风景\n\n走过很多路\n\n因为小事争吵\n\n为了让对方委曲求全过\n\n你们花光了所有力气\n\n竟还是没有逃过分开的命运\n\n于是从此以后\n\n你走那条路都会想起当时的嬉笑怒骂\n\n你经过街角的那间咖啡馆会记得甜得发腻的糖霜\n\n可是人啊\n\n总要学会告别\n\n无论如何\n\n我们的生命中\n\n都逃脱不了\n\n永无休止的告别\n\n![img](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/pk6qu.JPG)\n","source":"_posts/告别.md","raw":"---\ntitle: 告别\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: i-goodbye\nid: 10006\ndate: 2016-12-17 10:34:54\n---\n\n\n你们一起看过很多风景\n\n走过很多路\n\n因为小事争吵\n\n为了让对方委曲求全过\n\n你们花光了所有力气\n\n竟还是没有逃过分开的命运\n\n于是从此以后\n\n你走那条路都会想起当时的嬉笑怒骂\n\n你经过街角的那间咖啡馆会记得甜得发腻的糖霜\n\n可是人啊\n\n总要学会告别\n\n无论如何\n\n我们的生命中\n\n都逃脱不了\n\n永无休止的告别\n\n![img](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/pk6qu.JPG)\n","slug":"i-goodbye","published":1,"updated":"2017-04-24T14:32:22.571Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqdm007l41tp81mfbpf1","content":"<p>你们一起看过很多风景</p>\n<p>走过很多路</p>\n<p>因为小事争吵</p>\n<p>为了让对方委曲求全过</p>\n<p>你们花光了所有力气</p>\n<p>竟还是没有逃过分开的命运</p>\n<p>于是从此以后</p>\n<p>你走那条路都会想起当时的嬉笑怒骂</p>\n<p>你经过街角的那间咖啡馆会记得甜得发腻的糖霜</p>\n<p>可是人啊</p>\n<p>总要学会告别</p>\n<p>无论如何</p>\n<p>我们的生命中</p>\n<p>都逃脱不了</p>\n<p>永无休止的告别</p>\n<p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/pk6qu.JPG\" alt=\"img\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>你们一起看过很多风景</p>\n<p>走过很多路</p>\n<p>因为小事争吵</p>\n<p>为了让对方委曲求全过</p>\n<p>你们花光了所有力气</p>\n<p>竟还是没有逃过分开的命运</p>\n<p>于是从此以后</p>\n<p>你走那条路都会想起当时的嬉笑怒骂</p>\n<p>你经过街角的那间咖啡馆会记得甜得发腻的糖霜</p>\n<p>可是人啊</p>\n<p>总要学会告别</p>\n<p>无论如何</p>\n<p>我们的生命中</p>\n<p>都逃脱不了</p>\n<p>永无休止的告别</p>\n<p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/pk6qu.JPG\" alt=\"img\"></p>\n"},{"title":"四阶魔方特殊情况之处理","id":"142","updated":"2017-04-21T05:14:39.000Z","date":"2017-03-04T02:57:02.000Z","_content":"\n在还原高阶魔方(四阶及以上)时，采用的处理方法是，将魔方降级为三阶魔方，然后按照三阶魔方的技巧进行还原即可，但是在还原四阶魔方时会遇到2个不可能出现在三阶魔方的特殊情况，下面是针对这两个特殊情况的公式。\n> 注意，本文不是四阶魔方的还原教程。\n\n#### **特殊情况：顶层黄色无法形成“十”或“L”**\n1.手势：黄色面朝上\n2.右边两层旋转180'（这时应该黄色面有右面两层为白色）\n3.后面一层旋转180'\n4.上面一层旋转180'\n5.左边两层靠近你身体旋转90'\n6.上面一层旋转180'\n7.右面两层靠近你身体旋转90'\n8.上面一层旋转180'\n9.右面两层远离你身体旋转90'\n10.上面一层旋转180'\n11.前面一层旋转180'\n12.右面两层远离你身体旋转90'\n13.前面一层旋转180'\n14.左边两层远离你身体旋转90'\n15.前面一层旋转180'\n16.右边两层旋转180'\n\n#### **特殊情况：最后四对棱角只有两对还原**\n1.黄色面已经还原的情况下，黄色面朝上\n2.右面夹层旋转180'\n3.上面一层旋转180‘\n4.右面夹层旋转180'\n5.上面两层旋转180'\n6.右面夹层旋转180'\n7.上面两层旋转180'\n","source":"_posts/四阶魔方特殊情况之处理.md","raw":"---\ntitle: 四阶魔方特殊情况之处理\ntags: '魔方'\ncategories: '魔方'\npermalink: four-magric-spaciew\nid: 142\nupdated: '2017-04-21 13:14:39'\ndate: 2017-03-04 10:57:02\n---\n\n在还原高阶魔方(四阶及以上)时，采用的处理方法是，将魔方降级为三阶魔方，然后按照三阶魔方的技巧进行还原即可，但是在还原四阶魔方时会遇到2个不可能出现在三阶魔方的特殊情况，下面是针对这两个特殊情况的公式。\n> 注意，本文不是四阶魔方的还原教程。\n\n#### **特殊情况：顶层黄色无法形成“十”或“L”**\n1.手势：黄色面朝上\n2.右边两层旋转180'（这时应该黄色面有右面两层为白色）\n3.后面一层旋转180'\n4.上面一层旋转180'\n5.左边两层靠近你身体旋转90'\n6.上面一层旋转180'\n7.右面两层靠近你身体旋转90'\n8.上面一层旋转180'\n9.右面两层远离你身体旋转90'\n10.上面一层旋转180'\n11.前面一层旋转180'\n12.右面两层远离你身体旋转90'\n13.前面一层旋转180'\n14.左边两层远离你身体旋转90'\n15.前面一层旋转180'\n16.右边两层旋转180'\n\n#### **特殊情况：最后四对棱角只有两对还原**\n1.黄色面已经还原的情况下，黄色面朝上\n2.右面夹层旋转180'\n3.上面一层旋转180‘\n4.右面夹层旋转180'\n5.上面两层旋转180'\n6.右面夹层旋转180'\n7.上面两层旋转180'\n","slug":"four-magric-spaciew","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqdp007o41tpzzz2063d","content":"<p>在还原高阶魔方(四阶及以上)时，采用的处理方法是，将魔方降级为三阶魔方，然后按照三阶魔方的技巧进行还原即可，但是在还原四阶魔方时会遇到2个不可能出现在三阶魔方的特殊情况，下面是针对这两个特殊情况的公式。</p>\n<blockquote>\n<p>注意，本文不是四阶魔方的还原教程。</p>\n</blockquote>\n<h4 id=\"特殊情况：顶层黄色无法形成“十”或“L”\"><a href=\"#特殊情况：顶层黄色无法形成“十”或“L”\" class=\"headerlink\" title=\"特殊情况：顶层黄色无法形成“十”或“L”\"></a><strong>特殊情况：顶层黄色无法形成“十”或“L”</strong></h4><p>1.手势：黄色面朝上<br>2.右边两层旋转180’（这时应该黄色面有右面两层为白色）<br>3.后面一层旋转180’<br>4.上面一层旋转180’<br>5.左边两层靠近你身体旋转90’<br>6.上面一层旋转180’<br>7.右面两层靠近你身体旋转90’<br>8.上面一层旋转180’<br>9.右面两层远离你身体旋转90’<br>10.上面一层旋转180’<br>11.前面一层旋转180’<br>12.右面两层远离你身体旋转90’<br>13.前面一层旋转180’<br>14.左边两层远离你身体旋转90’<br>15.前面一层旋转180’<br>16.右边两层旋转180’</p>\n<h4 id=\"特殊情况：最后四对棱角只有两对还原\"><a href=\"#特殊情况：最后四对棱角只有两对还原\" class=\"headerlink\" title=\"特殊情况：最后四对棱角只有两对还原\"></a><strong>特殊情况：最后四对棱角只有两对还原</strong></h4><p>1.黄色面已经还原的情况下，黄色面朝上<br>2.右面夹层旋转180’<br>3.上面一层旋转180‘<br>4.右面夹层旋转180’<br>5.上面两层旋转180’<br>6.右面夹层旋转180’<br>7.上面两层旋转180’</p>\n","site":{"data":{}},"excerpt":"","more":"<p>在还原高阶魔方(四阶及以上)时，采用的处理方法是，将魔方降级为三阶魔方，然后按照三阶魔方的技巧进行还原即可，但是在还原四阶魔方时会遇到2个不可能出现在三阶魔方的特殊情况，下面是针对这两个特殊情况的公式。</p>\n<blockquote>\n<p>注意，本文不是四阶魔方的还原教程。</p>\n</blockquote>\n<h4 id=\"特殊情况：顶层黄色无法形成“十”或“L”\"><a href=\"#特殊情况：顶层黄色无法形成“十”或“L”\" class=\"headerlink\" title=\"特殊情况：顶层黄色无法形成“十”或“L”\"></a><strong>特殊情况：顶层黄色无法形成“十”或“L”</strong></h4><p>1.手势：黄色面朝上<br>2.右边两层旋转180’（这时应该黄色面有右面两层为白色）<br>3.后面一层旋转180’<br>4.上面一层旋转180’<br>5.左边两层靠近你身体旋转90’<br>6.上面一层旋转180’<br>7.右面两层靠近你身体旋转90’<br>8.上面一层旋转180’<br>9.右面两层远离你身体旋转90’<br>10.上面一层旋转180’<br>11.前面一层旋转180’<br>12.右面两层远离你身体旋转90’<br>13.前面一层旋转180’<br>14.左边两层远离你身体旋转90’<br>15.前面一层旋转180’<br>16.右边两层旋转180’</p>\n<h4 id=\"特殊情况：最后四对棱角只有两对还原\"><a href=\"#特殊情况：最后四对棱角只有两对还原\" class=\"headerlink\" title=\"特殊情况：最后四对棱角只有两对还原\"></a><strong>特殊情况：最后四对棱角只有两对还原</strong></h4><p>1.黄色面已经还原的情况下，黄色面朝上<br>2.右面夹层旋转180’<br>3.上面一层旋转180‘<br>4.右面夹层旋转180’<br>5.上面两层旋转180’<br>6.右面夹层旋转180’<br>7.上面两层旋转180’</p>\n"},{"title":"在CentOS中配置 SFTP 环境","id":"10","updated":"2017-04-21T05:39:27.000Z","date":"2016-03-24T06:55:03.000Z","_content":"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;做运维工作的，应该经常会碰到这样的问题，需要新上一个web项目，需要上传文件到服务器上，解决方法有很多种，常见的如sftp和ftp，今天讲如何使用sftp让系统用户用户上传项目的权限，并且实现chroot和无法使用ssh登录到系统。\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SFTP是指SSH文件传输协议（SSH File Transfer protocol）或安全文件传输协议（Secure File Transfer Protocol），它提供了可信数据流下的文件访问、文件传输以及文件管理功能。当我们为SFTP配置chroot环境后，只有被许可的用户可以访问，并被限制到他们的家目录中，换言之：被许可的用户将处于牢笼环境中，在此环境中它们甚至不能切换它们的目录。\n\n### 1. 测试环境\n\n* MacBook Pro 15-inch i7 16GB\n* VMware Fushion 8 Pro\n* Transmit （ SFTP tools for Mac ）\n\n```\n[root@test ~]# cat /etc/issue\nCentOS release 6.6 (Final)\nKernel \\r on an \\m\n[root@test ~]# rpm -qa | grep openssh-server\nopenssh-server-5.3p1-104.el6.i686\n```\n\n### 2. 实验步骤\n\n##### 2.1 增加一个sftpusers用户组\n```\n[root@test ~]# groupadd sftpusers\n```\n\n##### 2.2 创建一个用户user01，并分配给sftpusers用户组\n```\n[root@test ~]# useradd -g sftpusers user01\n```\n\n##### 2.3 修改用户家目录及指定不能登录shell\n```\n[root@test ~]# mkdir /sftp/\n[root@test ~]# usermod -s /sbin/nologin -d /sftp/user01 -m user01\n```\n\n##### 2.4 给用户创建密码（注意密码不明文显示）\n```\n[root@test ~]# passwd user01\nChanging password for user user01.\nNew password:\nBAD PASSWORD: it is too simplistic/systematic\nBAD PASSWORD: is too simple\nRetype new password:\npasswd: all authentication tokens updated successfully.\n[root@test ~]#\n```\n\n#### 2.5 修改ssh的配置文件，如下设置\n```\n[root@test ~]# ll /etc/ssh/sshd_config\n-rw-------. 1 root root 3879 Oct 15  2014 /etc/ssh/sshd_config\n[root@test ~]# vim /etc/ssh/sshd_config\n\n# line 132\n#Subsystem      sftp    /usr/libexec/openssh/sftp-server    #注释\nSubsystem       sftp    internal-sftp        #修改为internal-sftp\n\n# add this lines at the end of file\nMatch Group sftpusers        #指定一下参数仅适用的用户组sftpusers\n    X11Forwarding no\n    AllowTcpForwarding no\n    ChrootDirectory %h       #设置chroot将用户锁在家目录，%h=家目录\n    ForceCommand internal-sftp    #该参数强制执行内部sftp\n```\n\n##### 2.6 重启ssh服务\n```\n[root@test ~]# /etc/init.d/sshd restart\nStopping sshd:                                             [  OK  ]\nStarting sshd:                                             [  OK  ]\n```\n\n##### 2.7 设置用户家目录权限,(注意权限不能大于0755)\n```\n[root@test ~]# chmod 0755 /sftp/user01/\n[root@test ~]# chown root /sftp/user01/\n[root@test ~]# chgrp -R sftpusers /sftp/user01/\n```\n\n##### 2.8 关于上传,根目录无法上传文件。\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为用户家目录属主是root，并且权限最大0755，所以没法写，我的解决方法是在在家目录建立一个文件夹，作为上传目录，并把属主给user01即可。\n\n```\n[root@test ~]# mkdir /sftp/user01/upload\n[root@test ~]# chown user01:sftpusers /sftp/user01/upload/\n```\n\n\n### 3. 测试验证\n##### 3.1 Linux 登录测试\n```\n[root@test ~]# su - user01\nThis account is currently not available.    #su - 切换失败\n\n[root@test ~]# cat /etc/passwd | tail -1\nuser01:x:500:500::/sftp/user01:/sbin/nologin\n\n[root@test ~]# ssh user01@localhost\nThe authenticity of host 'localhost (::1)' can't be established.\nRSA key fingerprint is f3:fc:31:dc:7d:16:d5:ad:8c:bc:eb:69:8f:b2:0b:c9.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added 'localhost' (RSA) to the list of known hosts.\nuser01@localhost's password:\nThis service allows sftp connections only.    #ssh登录也失败，ssh设置成功\nConnection to localhost closed.\n\n[root@test ~]# sftp user01@localhost\nConnecting to localhost...\nuser01@localhost's password:\nsftp> ls\nupload\nsftp> pwd\nRemote working directory: /\nsftp>\n\n```\n\n##### 3.2 SFTP 工具测试\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我这里使用的是Mac，但是传统的文件传输工具都差不多，Windows下有Winscp、Xftp等。\n\n\n\n\n","source":"_posts/在CentOS中配置-SFTP-环境.md","raw":"---\ntitle: 在CentOS中配置 SFTP 环境\ntags: 'SSH'\ncategories: 'CentOS'\npermalink: how-set-sftp-on-centos\nid: 10\nupdated: '2017-04-21 13:39:27'\ndate: 2016-03-24 14:55:03\n---\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;做运维工作的，应该经常会碰到这样的问题，需要新上一个web项目，需要上传文件到服务器上，解决方法有很多种，常见的如sftp和ftp，今天讲如何使用sftp让系统用户用户上传项目的权限，并且实现chroot和无法使用ssh登录到系统。\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SFTP是指SSH文件传输协议（SSH File Transfer protocol）或安全文件传输协议（Secure File Transfer Protocol），它提供了可信数据流下的文件访问、文件传输以及文件管理功能。当我们为SFTP配置chroot环境后，只有被许可的用户可以访问，并被限制到他们的家目录中，换言之：被许可的用户将处于牢笼环境中，在此环境中它们甚至不能切换它们的目录。\n\n### 1. 测试环境\n\n* MacBook Pro 15-inch i7 16GB\n* VMware Fushion 8 Pro\n* Transmit （ SFTP tools for Mac ）\n\n```\n[root@test ~]# cat /etc/issue\nCentOS release 6.6 (Final)\nKernel \\r on an \\m\n[root@test ~]# rpm -qa | grep openssh-server\nopenssh-server-5.3p1-104.el6.i686\n```\n\n### 2. 实验步骤\n\n##### 2.1 增加一个sftpusers用户组\n```\n[root@test ~]# groupadd sftpusers\n```\n\n##### 2.2 创建一个用户user01，并分配给sftpusers用户组\n```\n[root@test ~]# useradd -g sftpusers user01\n```\n\n##### 2.3 修改用户家目录及指定不能登录shell\n```\n[root@test ~]# mkdir /sftp/\n[root@test ~]# usermod -s /sbin/nologin -d /sftp/user01 -m user01\n```\n\n##### 2.4 给用户创建密码（注意密码不明文显示）\n```\n[root@test ~]# passwd user01\nChanging password for user user01.\nNew password:\nBAD PASSWORD: it is too simplistic/systematic\nBAD PASSWORD: is too simple\nRetype new password:\npasswd: all authentication tokens updated successfully.\n[root@test ~]#\n```\n\n#### 2.5 修改ssh的配置文件，如下设置\n```\n[root@test ~]# ll /etc/ssh/sshd_config\n-rw-------. 1 root root 3879 Oct 15  2014 /etc/ssh/sshd_config\n[root@test ~]# vim /etc/ssh/sshd_config\n\n# line 132\n#Subsystem      sftp    /usr/libexec/openssh/sftp-server    #注释\nSubsystem       sftp    internal-sftp        #修改为internal-sftp\n\n# add this lines at the end of file\nMatch Group sftpusers        #指定一下参数仅适用的用户组sftpusers\n    X11Forwarding no\n    AllowTcpForwarding no\n    ChrootDirectory %h       #设置chroot将用户锁在家目录，%h=家目录\n    ForceCommand internal-sftp    #该参数强制执行内部sftp\n```\n\n##### 2.6 重启ssh服务\n```\n[root@test ~]# /etc/init.d/sshd restart\nStopping sshd:                                             [  OK  ]\nStarting sshd:                                             [  OK  ]\n```\n\n##### 2.7 设置用户家目录权限,(注意权限不能大于0755)\n```\n[root@test ~]# chmod 0755 /sftp/user01/\n[root@test ~]# chown root /sftp/user01/\n[root@test ~]# chgrp -R sftpusers /sftp/user01/\n```\n\n##### 2.8 关于上传,根目录无法上传文件。\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为用户家目录属主是root，并且权限最大0755，所以没法写，我的解决方法是在在家目录建立一个文件夹，作为上传目录，并把属主给user01即可。\n\n```\n[root@test ~]# mkdir /sftp/user01/upload\n[root@test ~]# chown user01:sftpusers /sftp/user01/upload/\n```\n\n\n### 3. 测试验证\n##### 3.1 Linux 登录测试\n```\n[root@test ~]# su - user01\nThis account is currently not available.    #su - 切换失败\n\n[root@test ~]# cat /etc/passwd | tail -1\nuser01:x:500:500::/sftp/user01:/sbin/nologin\n\n[root@test ~]# ssh user01@localhost\nThe authenticity of host 'localhost (::1)' can't be established.\nRSA key fingerprint is f3:fc:31:dc:7d:16:d5:ad:8c:bc:eb:69:8f:b2:0b:c9.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added 'localhost' (RSA) to the list of known hosts.\nuser01@localhost's password:\nThis service allows sftp connections only.    #ssh登录也失败，ssh设置成功\nConnection to localhost closed.\n\n[root@test ~]# sftp user01@localhost\nConnecting to localhost...\nuser01@localhost's password:\nsftp> ls\nupload\nsftp> pwd\nRemote working directory: /\nsftp>\n\n```\n\n##### 3.2 SFTP 工具测试\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我这里使用的是Mac，但是传统的文件传输工具都差不多，Windows下有Winscp、Xftp等。\n\n\n\n\n","slug":"how-set-sftp-on-centos","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqds007t41tp90x3r0i5","content":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;做运维工作的，应该经常会碰到这样的问题，需要新上一个web项目，需要上传文件到服务器上，解决方法有很多种，常见的如sftp和ftp，今天讲如何使用sftp让系统用户用户上传项目的权限，并且实现chroot和无法使用ssh登录到系统。</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SFTP是指SSH文件传输协议（SSH File Transfer protocol）或安全文件传输协议（Secure File Transfer Protocol），它提供了可信数据流下的文件访问、文件传输以及文件管理功能。当我们为SFTP配置chroot环境后，只有被许可的用户可以访问，并被限制到他们的家目录中，换言之：被许可的用户将处于牢笼环境中，在此环境中它们甚至不能切换它们的目录。</p>\n<h3 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h3><ul>\n<li>MacBook Pro 15-inch i7 16GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>Transmit （ SFTP tools for Mac ）</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# cat /etc/issue</div><div class=\"line\">CentOS release 6.6 (Final)</div><div class=\"line\">Kernel \\r on an \\m</div><div class=\"line\">[root@test ~]# rpm -qa | grep openssh-server</div><div class=\"line\">openssh-server-5.3p1-104.el6.i686</div></pre></td></tr></table></figure>\n<h3 id=\"2-实验步骤\"><a href=\"#2-实验步骤\" class=\"headerlink\" title=\"2. 实验步骤\"></a>2. 实验步骤</h3><h5 id=\"2-1-增加一个sftpusers用户组\"><a href=\"#2-1-增加一个sftpusers用户组\" class=\"headerlink\" title=\"2.1 增加一个sftpusers用户组\"></a>2.1 增加一个sftpusers用户组</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# groupadd sftpusers</div></pre></td></tr></table></figure>\n<h5 id=\"2-2-创建一个用户user01，并分配给sftpusers用户组\"><a href=\"#2-2-创建一个用户user01，并分配给sftpusers用户组\" class=\"headerlink\" title=\"2.2 创建一个用户user01，并分配给sftpusers用户组\"></a>2.2 创建一个用户user01，并分配给sftpusers用户组</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# useradd -g sftpusers user01</div></pre></td></tr></table></figure>\n<h5 id=\"2-3-修改用户家目录及指定不能登录shell\"><a href=\"#2-3-修改用户家目录及指定不能登录shell\" class=\"headerlink\" title=\"2.3 修改用户家目录及指定不能登录shell\"></a>2.3 修改用户家目录及指定不能登录shell</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# mkdir /sftp/</div><div class=\"line\">[root@test ~]# usermod -s /sbin/nologin -d /sftp/user01 -m user01</div></pre></td></tr></table></figure>\n<h5 id=\"2-4-给用户创建密码（注意密码不明文显示）\"><a href=\"#2-4-给用户创建密码（注意密码不明文显示）\" class=\"headerlink\" title=\"2.4 给用户创建密码（注意密码不明文显示）\"></a>2.4 给用户创建密码（注意密码不明文显示）</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# passwd user01</div><div class=\"line\">Changing password for user user01.</div><div class=\"line\">New password:</div><div class=\"line\">BAD PASSWORD: it is too simplistic/systematic</div><div class=\"line\">BAD PASSWORD: is too simple</div><div class=\"line\">Retype new password:</div><div class=\"line\">passwd: all authentication tokens updated successfully.</div><div class=\"line\">[root@test ~]#</div></pre></td></tr></table></figure>\n<h4 id=\"2-5-修改ssh的配置文件，如下设置\"><a href=\"#2-5-修改ssh的配置文件，如下设置\" class=\"headerlink\" title=\"2.5 修改ssh的配置文件，如下设置\"></a>2.5 修改ssh的配置文件，如下设置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# ll /etc/ssh/sshd_config</div><div class=\"line\">-rw-------. 1 root root 3879 Oct 15  2014 /etc/ssh/sshd_config</div><div class=\"line\">[root@test ~]# vim /etc/ssh/sshd_config</div><div class=\"line\"></div><div class=\"line\"># line 132</div><div class=\"line\">#Subsystem      sftp    /usr/libexec/openssh/sftp-server    #注释</div><div class=\"line\">Subsystem       sftp    internal-sftp        #修改为internal-sftp</div><div class=\"line\"></div><div class=\"line\"># add this lines at the end of file</div><div class=\"line\">Match Group sftpusers        #指定一下参数仅适用的用户组sftpusers</div><div class=\"line\">    X11Forwarding no</div><div class=\"line\">    AllowTcpForwarding no</div><div class=\"line\">    ChrootDirectory %h       #设置chroot将用户锁在家目录，%h=家目录</div><div class=\"line\">    ForceCommand internal-sftp    #该参数强制执行内部sftp</div></pre></td></tr></table></figure>\n<h5 id=\"2-6-重启ssh服务\"><a href=\"#2-6-重启ssh服务\" class=\"headerlink\" title=\"2.6 重启ssh服务\"></a>2.6 重启ssh服务</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# /etc/init.d/sshd restart</div><div class=\"line\">Stopping sshd:                                             [  OK  ]</div><div class=\"line\">Starting sshd:                                             [  OK  ]</div></pre></td></tr></table></figure>\n<h5 id=\"2-7-设置用户家目录权限-注意权限不能大于0755\"><a href=\"#2-7-设置用户家目录权限-注意权限不能大于0755\" class=\"headerlink\" title=\"2.7 设置用户家目录权限,(注意权限不能大于0755)\"></a>2.7 设置用户家目录权限,(注意权限不能大于0755)</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# chmod 0755 /sftp/user01/</div><div class=\"line\">[root@test ~]# chown root /sftp/user01/</div><div class=\"line\">[root@test ~]# chgrp -R sftpusers /sftp/user01/</div></pre></td></tr></table></figure>\n<h5 id=\"2-8-关于上传-根目录无法上传文件。\"><a href=\"#2-8-关于上传-根目录无法上传文件。\" class=\"headerlink\" title=\"2.8 关于上传,根目录无法上传文件。\"></a>2.8 关于上传,根目录无法上传文件。</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为用户家目录属主是root，并且权限最大0755，所以没法写，我的解决方法是在在家目录建立一个文件夹，作为上传目录，并把属主给user01即可。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# mkdir /sftp/user01/upload</div><div class=\"line\">[root@test ~]# chown user01:sftpusers /sftp/user01/upload/</div></pre></td></tr></table></figure>\n<h3 id=\"3-测试验证\"><a href=\"#3-测试验证\" class=\"headerlink\" title=\"3. 测试验证\"></a>3. 测试验证</h3><h5 id=\"3-1-Linux-登录测试\"><a href=\"#3-1-Linux-登录测试\" class=\"headerlink\" title=\"3.1 Linux 登录测试\"></a>3.1 Linux 登录测试</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# su - user01</div><div class=\"line\">This account is currently not available.    #su - 切换失败</div><div class=\"line\"></div><div class=\"line\">[root@test ~]# cat /etc/passwd | tail -1</div><div class=\"line\">user01:x:500:500::/sftp/user01:/sbin/nologin</div><div class=\"line\"></div><div class=\"line\">[root@test ~]# ssh user01@localhost</div><div class=\"line\">The authenticity of host &apos;localhost (::1)&apos; can&apos;t be established.</div><div class=\"line\">RSA key fingerprint is f3:fc:31:dc:7d:16:d5:ad:8c:bc:eb:69:8f:b2:0b:c9.</div><div class=\"line\">Are you sure you want to continue connecting (yes/no)? yes</div><div class=\"line\">Warning: Permanently added &apos;localhost&apos; (RSA) to the list of known hosts.</div><div class=\"line\">user01@localhost&apos;s password:</div><div class=\"line\">This service allows sftp connections only.    #ssh登录也失败，ssh设置成功</div><div class=\"line\">Connection to localhost closed.</div><div class=\"line\"></div><div class=\"line\">[root@test ~]# sftp user01@localhost</div><div class=\"line\">Connecting to localhost...</div><div class=\"line\">user01@localhost&apos;s password:</div><div class=\"line\">sftp&gt; ls</div><div class=\"line\">upload</div><div class=\"line\">sftp&gt; pwd</div><div class=\"line\">Remote working directory: /</div><div class=\"line\">sftp&gt;</div></pre></td></tr></table></figure>\n<h5 id=\"3-2-SFTP-工具测试\"><a href=\"#3-2-SFTP-工具测试\" class=\"headerlink\" title=\"3.2 SFTP 工具测试\"></a>3.2 SFTP 工具测试</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我这里使用的是Mac，但是传统的文件传输工具都差不多，Windows下有Winscp、Xftp等。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;做运维工作的，应该经常会碰到这样的问题，需要新上一个web项目，需要上传文件到服务器上，解决方法有很多种，常见的如sftp和ftp，今天讲如何使用sftp让系统用户用户上传项目的权限，并且实现chroot和无法使用ssh登录到系统。</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SFTP是指SSH文件传输协议（SSH File Transfer protocol）或安全文件传输协议（Secure File Transfer Protocol），它提供了可信数据流下的文件访问、文件传输以及文件管理功能。当我们为SFTP配置chroot环境后，只有被许可的用户可以访问，并被限制到他们的家目录中，换言之：被许可的用户将处于牢笼环境中，在此环境中它们甚至不能切换它们的目录。</p>\n<h3 id=\"1-测试环境\"><a href=\"#1-测试环境\" class=\"headerlink\" title=\"1. 测试环境\"></a>1. 测试环境</h3><ul>\n<li>MacBook Pro 15-inch i7 16GB</li>\n<li>VMware Fushion 8 Pro</li>\n<li>Transmit （ SFTP tools for Mac ）</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# cat /etc/issue</div><div class=\"line\">CentOS release 6.6 (Final)</div><div class=\"line\">Kernel \\r on an \\m</div><div class=\"line\">[root@test ~]# rpm -qa | grep openssh-server</div><div class=\"line\">openssh-server-5.3p1-104.el6.i686</div></pre></td></tr></table></figure>\n<h3 id=\"2-实验步骤\"><a href=\"#2-实验步骤\" class=\"headerlink\" title=\"2. 实验步骤\"></a>2. 实验步骤</h3><h5 id=\"2-1-增加一个sftpusers用户组\"><a href=\"#2-1-增加一个sftpusers用户组\" class=\"headerlink\" title=\"2.1 增加一个sftpusers用户组\"></a>2.1 增加一个sftpusers用户组</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# groupadd sftpusers</div></pre></td></tr></table></figure>\n<h5 id=\"2-2-创建一个用户user01，并分配给sftpusers用户组\"><a href=\"#2-2-创建一个用户user01，并分配给sftpusers用户组\" class=\"headerlink\" title=\"2.2 创建一个用户user01，并分配给sftpusers用户组\"></a>2.2 创建一个用户user01，并分配给sftpusers用户组</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# useradd -g sftpusers user01</div></pre></td></tr></table></figure>\n<h5 id=\"2-3-修改用户家目录及指定不能登录shell\"><a href=\"#2-3-修改用户家目录及指定不能登录shell\" class=\"headerlink\" title=\"2.3 修改用户家目录及指定不能登录shell\"></a>2.3 修改用户家目录及指定不能登录shell</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# mkdir /sftp/</div><div class=\"line\">[root@test ~]# usermod -s /sbin/nologin -d /sftp/user01 -m user01</div></pre></td></tr></table></figure>\n<h5 id=\"2-4-给用户创建密码（注意密码不明文显示）\"><a href=\"#2-4-给用户创建密码（注意密码不明文显示）\" class=\"headerlink\" title=\"2.4 给用户创建密码（注意密码不明文显示）\"></a>2.4 给用户创建密码（注意密码不明文显示）</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# passwd user01</div><div class=\"line\">Changing password for user user01.</div><div class=\"line\">New password:</div><div class=\"line\">BAD PASSWORD: it is too simplistic/systematic</div><div class=\"line\">BAD PASSWORD: is too simple</div><div class=\"line\">Retype new password:</div><div class=\"line\">passwd: all authentication tokens updated successfully.</div><div class=\"line\">[root@test ~]#</div></pre></td></tr></table></figure>\n<h4 id=\"2-5-修改ssh的配置文件，如下设置\"><a href=\"#2-5-修改ssh的配置文件，如下设置\" class=\"headerlink\" title=\"2.5 修改ssh的配置文件，如下设置\"></a>2.5 修改ssh的配置文件，如下设置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# ll /etc/ssh/sshd_config</div><div class=\"line\">-rw-------. 1 root root 3879 Oct 15  2014 /etc/ssh/sshd_config</div><div class=\"line\">[root@test ~]# vim /etc/ssh/sshd_config</div><div class=\"line\"></div><div class=\"line\"># line 132</div><div class=\"line\">#Subsystem      sftp    /usr/libexec/openssh/sftp-server    #注释</div><div class=\"line\">Subsystem       sftp    internal-sftp        #修改为internal-sftp</div><div class=\"line\"></div><div class=\"line\"># add this lines at the end of file</div><div class=\"line\">Match Group sftpusers        #指定一下参数仅适用的用户组sftpusers</div><div class=\"line\">    X11Forwarding no</div><div class=\"line\">    AllowTcpForwarding no</div><div class=\"line\">    ChrootDirectory %h       #设置chroot将用户锁在家目录，%h=家目录</div><div class=\"line\">    ForceCommand internal-sftp    #该参数强制执行内部sftp</div></pre></td></tr></table></figure>\n<h5 id=\"2-6-重启ssh服务\"><a href=\"#2-6-重启ssh服务\" class=\"headerlink\" title=\"2.6 重启ssh服务\"></a>2.6 重启ssh服务</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# /etc/init.d/sshd restart</div><div class=\"line\">Stopping sshd:                                             [  OK  ]</div><div class=\"line\">Starting sshd:                                             [  OK  ]</div></pre></td></tr></table></figure>\n<h5 id=\"2-7-设置用户家目录权限-注意权限不能大于0755\"><a href=\"#2-7-设置用户家目录权限-注意权限不能大于0755\" class=\"headerlink\" title=\"2.7 设置用户家目录权限,(注意权限不能大于0755)\"></a>2.7 设置用户家目录权限,(注意权限不能大于0755)</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# chmod 0755 /sftp/user01/</div><div class=\"line\">[root@test ~]# chown root /sftp/user01/</div><div class=\"line\">[root@test ~]# chgrp -R sftpusers /sftp/user01/</div></pre></td></tr></table></figure>\n<h5 id=\"2-8-关于上传-根目录无法上传文件。\"><a href=\"#2-8-关于上传-根目录无法上传文件。\" class=\"headerlink\" title=\"2.8 关于上传,根目录无法上传文件。\"></a>2.8 关于上传,根目录无法上传文件。</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为用户家目录属主是root，并且权限最大0755，所以没法写，我的解决方法是在在家目录建立一个文件夹，作为上传目录，并把属主给user01即可。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# mkdir /sftp/user01/upload</div><div class=\"line\">[root@test ~]# chown user01:sftpusers /sftp/user01/upload/</div></pre></td></tr></table></figure>\n<h3 id=\"3-测试验证\"><a href=\"#3-测试验证\" class=\"headerlink\" title=\"3. 测试验证\"></a>3. 测试验证</h3><h5 id=\"3-1-Linux-登录测试\"><a href=\"#3-1-Linux-登录测试\" class=\"headerlink\" title=\"3.1 Linux 登录测试\"></a>3.1 Linux 登录测试</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@test ~]# su - user01</div><div class=\"line\">This account is currently not available.    #su - 切换失败</div><div class=\"line\"></div><div class=\"line\">[root@test ~]# cat /etc/passwd | tail -1</div><div class=\"line\">user01:x:500:500::/sftp/user01:/sbin/nologin</div><div class=\"line\"></div><div class=\"line\">[root@test ~]# ssh user01@localhost</div><div class=\"line\">The authenticity of host &apos;localhost (::1)&apos; can&apos;t be established.</div><div class=\"line\">RSA key fingerprint is f3:fc:31:dc:7d:16:d5:ad:8c:bc:eb:69:8f:b2:0b:c9.</div><div class=\"line\">Are you sure you want to continue connecting (yes/no)? yes</div><div class=\"line\">Warning: Permanently added &apos;localhost&apos; (RSA) to the list of known hosts.</div><div class=\"line\">user01@localhost&apos;s password:</div><div class=\"line\">This service allows sftp connections only.    #ssh登录也失败，ssh设置成功</div><div class=\"line\">Connection to localhost closed.</div><div class=\"line\"></div><div class=\"line\">[root@test ~]# sftp user01@localhost</div><div class=\"line\">Connecting to localhost...</div><div class=\"line\">user01@localhost&apos;s password:</div><div class=\"line\">sftp&gt; ls</div><div class=\"line\">upload</div><div class=\"line\">sftp&gt; pwd</div><div class=\"line\">Remote working directory: /</div><div class=\"line\">sftp&gt;</div></pre></td></tr></table></figure>\n<h5 id=\"3-2-SFTP-工具测试\"><a href=\"#3-2-SFTP-工具测试\" class=\"headerlink\" title=\"3.2 SFTP 工具测试\"></a>3.2 SFTP 工具测试</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我这里使用的是Mac，但是传统的文件传输工具都差不多，Windows下有Winscp、Xftp等。</p>\n"},{"title":"在网页中插入歌曲","id":"79","updated":"2017-04-21T05:23:48.000Z","date":"2016-07-31T16:12:29.000Z","_content":"\n纠正下，在下面博文中的错误，关于单曲不能生成外链的问题，现已经纠正。\n\n我试过百度音乐、QQ音乐、虾米音乐和网易云音乐，目前只有网易云音乐有此功能，先在网易云音乐选择歌曲即可：\n#### 分享单曲\n> **歌曲：[安河桥](http://music.163.com/#/song?id=27646205)**\n\n<div align=center>\n<img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/QQ20160731-0@2x.jpg\" alt=\"安河桥\">\n</div>\n<br>\n\n\n#### 分享专辑，歌单\n> **专辑： [安河桥北](http://music.163.com/#/album?id=2646285)**\n\n<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**选定歌单之后，在歌单页面有个生成外链播放器的按钮**\n<div align=center>\n<img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/1-6UcK4gXBrACw.jpg\">\n</div>\n<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**然后，根据页面提示信息，生成你要的html代码，并嵌入到你的页面之中。**\n<div align=center>\n<img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/2-6UcK4gXBrACw.jpg\">\n</div>\n","source":"_posts/在网页中插入歌曲.md","raw":"---\ntitle: 在网页中插入歌曲\ntags: 'Ghost'\ncategories: 'Ghost'\npermalink: insert-music\nid: 79\nupdated: '2017-04-21 13:23:48'\ndate: 2016-08-01 00:12:29\n---\n\n纠正下，在下面博文中的错误，关于单曲不能生成外链的问题，现已经纠正。\n\n我试过百度音乐、QQ音乐、虾米音乐和网易云音乐，目前只有网易云音乐有此功能，先在网易云音乐选择歌曲即可：\n#### 分享单曲\n> **歌曲：[安河桥](http://music.163.com/#/song?id=27646205)**\n\n<div align=center>\n<img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/QQ20160731-0@2x.jpg\" alt=\"安河桥\">\n</div>\n<br>\n\n\n#### 分享专辑，歌单\n> **专辑： [安河桥北](http://music.163.com/#/album?id=2646285)**\n\n<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**选定歌单之后，在歌单页面有个生成外链播放器的按钮**\n<div align=center>\n<img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/1-6UcK4gXBrACw.jpg\">\n</div>\n<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**然后，根据页面提示信息，生成你要的html代码，并嵌入到你的页面之中。**\n<div align=center>\n<img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/2-6UcK4gXBrACw.jpg\">\n</div>\n","slug":"insert-music","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqdu007w41tpirfe84z9","content":"<p>纠正下，在下面博文中的错误，关于单曲不能生成外链的问题，现已经纠正。</p>\n<p>我试过百度音乐、QQ音乐、虾米音乐和网易云音乐，目前只有网易云音乐有此功能，先在网易云音乐选择歌曲即可：</p>\n<h4 id=\"分享单曲\"><a href=\"#分享单曲\" class=\"headerlink\" title=\"分享单曲\"></a>分享单曲</h4><blockquote>\n<p><strong>歌曲：<a href=\"http://music.163.com/#/song?id=27646205\" target=\"_blank\" rel=\"external\">安河桥</a></strong></p>\n</blockquote>\n<div align=\"center\"><br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/QQ20160731-0@2x.jpg\" alt=\"安河桥\"><br></div><br><br><br><br><br>#### 分享专辑，歌单<br>&gt; <strong>专辑： <a href=\"http://music.163.com/#/album?id=2646285\" target=\"_blank\" rel=\"external\">安河桥北</a></strong><br><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>选定歌单之后，在歌单页面有个生成外链播放器的按钮</strong><br><div align=\"center\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/1-6UcK4gXBrACw.jpg\"><br></div><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>然后，根据页面提示信息，生成你要的html代码，并嵌入到你的页面之中。</strong><br><div align=\"center\"><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/2-6UcK4gXBrACw.jpg\"><br></div>\n","site":{"data":{}},"excerpt":"","more":"<p>纠正下，在下面博文中的错误，关于单曲不能生成外链的问题，现已经纠正。</p>\n<p>我试过百度音乐、QQ音乐、虾米音乐和网易云音乐，目前只有网易云音乐有此功能，先在网易云音乐选择歌曲即可：</p>\n<h4 id=\"分享单曲\"><a href=\"#分享单曲\" class=\"headerlink\" title=\"分享单曲\"></a>分享单曲</h4><blockquote>\n<p><strong>歌曲：<a href=\"http://music.163.com/#/song?id=27646205\">安河桥</a></strong></p>\n</blockquote>\n<div align=center><br><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/QQ20160731-0@2x.jpg\" alt=\"安河桥\"><br></div><br><br><br><br><br>#### 分享专辑，歌单<br>&gt; <strong>专辑： <a href=\"http://music.163.com/#/album?id=2646285\">安河桥北</a></strong><br><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>选定歌单之后，在歌单页面有个生成外链播放器的按钮</strong><br><div align=center><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/1-6UcK4gXBrACw.jpg\"><br></div><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>然后，根据页面提示信息，生成你要的html代码，并嵌入到你的页面之中。</strong><br><div align=center><br><img src=\"http://samzong.oss-cn-shenzhen.aliyuncs.com/2016/07/2-6UcK4gXBrACw.jpg\"><br></div>\n"},{"title":"如何在CentOS 6 安装更高版本的PHP","id":"20","updated":"2017-04-21T05:37:32.000Z","date":"2016-04-01T06:57:45.000Z","_content":"\n<p>\nCentOS 6 默认安装的PHP 版本是5.3， 但现在很多应用对于LAMP中，PHP的版本最低5.4，所以本篇文章的主要内容是，如何升级PHP5.3到5.4以及更高版本\n </p>\n\n## 实验环境：CentOS 6.4\n\n解决办法是采用了remi源仓库已经适配的相应php版本\n\n> 经过测试，该升级办法同样适用目前CentOS 6.x 所有版本\n\n#### 1. 安装Remi源\n```\n# 因为remi依赖epel源仓库，所有我们要先安装它。\n[root@visionet8 ~]# yum install -y epel-release\n\n[root@visionet8 ~]# wget http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n[root@visionet8 ~]# rpm -Uvh remi-release-6.rpm\n```\n\n#### 2. 我们看下Remi的的yum配置文件\n```\n# Repository: http://rpms.remirepo.net/\n# Blog:       http://blog.remirepo.net/\n# Forum:      http://forum.remirepo.net/\n\n[remi]\nname=Remi's RPM repository for Enterprise Linux 6 - $basearch\nbaseurl=http://rpms.remirepo.net/enterprise/6/remi/$basearch/\n#mirrorlist=http://rpms.remirepo.net/enterprise/6/remi/mirror\nenabled=1\ngpgcheck=0\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n\n[remi-php55]\nname=Remi's PHP 5.5 RPM repository for Enterprise Linux 6 - $basearch\n#baseurl=http://rpms.remirepo.net/enterprise/6/php55/$basearch/\nmirrorlist=http://rpms.remirepo.net/enterprise/6/php55/mirror\n# NOTICE: common dependencies are in \"remi-safe\"\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n\n[remi-php56]\nname=Remi's PHP 5.6 RPM repository for Enterprise Linux 6 - $basearch\n#baseurl=http://rpms.remirepo.net/enterprise/6/php56/$basearch/\nmirrorlist=http://rpms.remirepo.net/enterprise/6/php56/mirror\n# NOTICE: common dependencies are in \"remi-safe\"\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n```\n\n经过测试，启用remi源之后，默认情况下php版本为5.4,这时我们只需要升级php即可。\n\n```\n[root@visionet8 html]# yum update -y php*\nFailed to set locale, defaulting to C\nLoaded plugins: fastestmirror, refresh-packagekit, security\nLoading mirror speeds from cached hostfile\n * base: mirrors.163.com\n * epel: mirrors.ustc.edu.cn\n * extras: mirrors.aliyun.com\n * remi-safe: mirrors.tuna.tsinghua.edu.cn\n * updates: mirrors.cn99.com\nremi                                                                               | 2.9 kB     00:00\nremi/primary_db                                                                    | 1.6 MB     00:05\nSetting up Update Process\nResolving Dependencies\n--> Running transaction check\n---> Package php.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-cli.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-cli.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-common.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-common.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-gd.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-gd.x86_64 0:5.4.45-12.el6.remi will be an update\n--> Processing Dependency: libt1.so.5()(64bit) for package: php-gd-5.4.45-12.el6.remi.x86_64\n---> Package php-mcrypt.x86_64 0:5.3.3-4.el6 will be updated\n---> Package php-mcrypt.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-mysql.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-mysql.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-pdo.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-pdo.x86_64 0:5.4.45-12.el6.remi will be an update\n--> Running transaction check\n---> Package t1lib.x86_64 0:5.1.2-6.el6_2.1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n==========================================================================================================\n Package                  Arch                 Version                           Repository          Size\n==========================================================================================================\nUpdating:\n php                      x86_64               5.4.45-12.el6.remi                remi               2.8 M\n php-cli                  x86_64               5.4.45-12.el6.remi                remi               4.1 M\n php-common               x86_64               5.4.45-12.el6.remi                remi               968 k\n php-gd                   x86_64               5.4.45-12.el6.remi                remi               152 k\n php-mcrypt               x86_64               5.4.45-12.el6.remi                remi                60 k\n php-mysql                x86_64               5.4.45-12.el6.remi                remi               145 k\n php-pdo                  x86_64               5.4.45-12.el6.remi                remi               129 k\nInstalling for dependencies:\n t1lib                    x86_64               5.1.2-6.el6_2.1                   base               160 k\n\nTransaction Summary\n==========================================================================================================\nInstall       1 Package(s)\nUpgrade       7 Package(s)\n\nTotal download size: 8.5 M\nDownloading Packages:\n(1/8): php-5.4.45-12.el6.remi.x86_64.rpm                                           | 2.8 MB     00:07\n(2/8): php-cli-5.4.45-12.el6.remi.x86_64.rpm                                       | 4.1 MB     00:06\n(3/8): php-common-5.4.45-12.el6.remi.x86_64.rpm                                    | 968 kB     00:02\n(4/8): php-gd-5.4.45-12.el6.remi.x86_64.rpm                                        | 152 kB     00:01\n(5/8): php-mcrypt-5.4.45-12.el6.remi.x86_64.rpm                                    |  60 kB     00:00\n(6/8): php-mysql-5.4.45-12.el6.remi.x86_64.rpm                                     | 145 kB     00:00\n(7/8): php-pdo-5.4.45-12.el6.remi.x86_64.rpm                                       | 129 kB     00:01\n(8/8): t1lib-5.1.2-6.el6_2.1.x86_64.rpm                                            | 160 kB     00:00\n----------------------------------------------------------------------------------------------------------\nTotal                                                                     338 kB/s | 8.5 MB     00:25\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\nWarning: RPMDB altered outside of yum.\n  Updating   : php-common-5.4.45-12.el6.remi.x86_64                                                  1/15\n  Updating   : php-cli-5.4.45-12.el6.remi.x86_64                                                     2/15\n  Updating   : php-pdo-5.4.45-12.el6.remi.x86_64                                                     3/15\n  Installing : t1lib-5.1.2-6.el6_2.1.x86_64                                                          4/15\n  Updating   : php-gd-5.4.45-12.el6.remi.x86_64                                                      5/15\n  Updating   : php-mysql-5.4.45-12.el6.remi.x86_64                                                   6/15\n  Updating   : php-5.4.45-12.el6.remi.x86_64                                                         7/15\n  Updating   : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  8/15\n  Cleanup    : php-5.3.3-48.el6_8.x86_64                                                             9/15\n  Cleanup    : php-mysql-5.3.3-48.el6_8.x86_64                                                      10/15\n  Cleanup    : php-pdo-5.3.3-48.el6_8.x86_64                                                        11/15\n  Cleanup    : php-cli-5.3.3-48.el6_8.x86_64                                                        12/15\n  Cleanup    : php-gd-5.3.3-48.el6_8.x86_64                                                         13/15\n  Cleanup    : php-mcrypt-5.3.3-4.el6.x86_64                                                        14/15\n  Cleanup    : php-common-5.3.3-48.el6_8.x86_64                                                     15/15\n  Verifying  : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  1/15\n  Verifying  : t1lib-5.1.2-6.el6_2.1.x86_64                                                          2/15\n  Verifying  : php-common-5.4.45-12.el6.remi.x86_64                                                  3/15\n  Verifying  : php-gd-5.4.45-12.el6.remi.x86_64                                                      4/15\n  Verifying  : php-cli-5.4.45-12.el6.remi.x86_64                                                     5/15\n  Verifying  : php-pdo-5.4.45-12.el6.remi.x86_64                                                     6/15\n  Verifying  : php-mysql-5.4.45-12.el6.remi.x86_64                                                   7/15\n  Verifying  : php-5.4.45-12.el6.remi.x86_64                                                         8/15\n  Verifying  : php-5.3.3-48.el6_8.x86_64                                                             9/15\n  Verifying  : php-gd-5.3.3-48.el6_8.x86_64                                                         10/15\n  Verifying  : php-cli-5.3.3-48.el6_8.x86_64                                                        11/15\n  Verifying  : php-pdo-5.3.3-48.el6_8.x86_64                                                        12/15\n  Verifying  : php-common-5.3.3-48.el6_8.x86_64                                                     13/15\n  Verifying  : php-mysql-5.3.3-48.el6_8.x86_64                                                      14/15\n  Verifying  : php-mcrypt-5.3.3-4.el6.x86_64                                                        15/15\n\nDependency Installed:\n  t1lib.x86_64 0:5.1.2-6.el6_2.1\n\nUpdated:\n  php.x86_64 0:5.4.45-12.el6.remi                      php-cli.x86_64 0:5.4.45-12.el6.remi\n  php-common.x86_64 0:5.4.45-12.el6.remi               php-gd.x86_64 0:5.4.45-12.el6.remi\n  php-mcrypt.x86_64 0:5.4.45-12.el6.remi               php-mysql.x86_64 0:5.4.45-12.el6.remi\n  php-pdo.x86_64 0:5.4.45-12.el6.remi\n\nComplete!\n```\n\n#### 3. 测试：\n```\n[root@visionet8 html]# php -v\nPHP 5.4.45 (cli) (built: Sep 19 2016 15:31:07)\nCopyright (c) 1997-2014 The PHP Group\nZend Engine v2.4.0, Copyright (c) 1998-2014 Zend Technologies\n```\n\n#### 4. php 5.5 和php5.6\n\n>  若要升级到5.5 或 5.6，根据remi源的配置文件，将php5.5的enable参数设置为1，并将默认enable修改为0,然后<code>yum update php*</code>即可。\n<hr/>\n\n\n#### 5. php 7\n> 安装完成之后发现, 在安装remi源之后，在<code>/etc/yum.repos.d</code>除了<code>remi.repo</code>之外，还有<code>remi-php70.repo</code>和<code>remi-php71.repo</code>，测试下，如果要升级到php7，可以打开相应源仓库的配置文件，之后升级即可。\n\n<br>\n\n> <b>以上功能在升级时，要考虑其他组件的版本兼容性，不要盲目升级。</b>\n","source":"_posts/如何在CentOS-6-安装更高版本的PHP.md","raw":"---\ntitle: 如何在CentOS 6 安装更高版本的PHP\ntags: 'CentOS'\ncategories: 'CentOS'\npermalink: php54-centos6\nid: 20\nupdated: '2017-04-21 13:37:32'\ndate: 2016-04-01 14:57:45\n---\n\n<p>\nCentOS 6 默认安装的PHP 版本是5.3， 但现在很多应用对于LAMP中，PHP的版本最低5.4，所以本篇文章的主要内容是，如何升级PHP5.3到5.4以及更高版本\n </p>\n\n## 实验环境：CentOS 6.4\n\n解决办法是采用了remi源仓库已经适配的相应php版本\n\n> 经过测试，该升级办法同样适用目前CentOS 6.x 所有版本\n\n#### 1. 安装Remi源\n```\n# 因为remi依赖epel源仓库，所有我们要先安装它。\n[root@visionet8 ~]# yum install -y epel-release\n\n[root@visionet8 ~]# wget http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n[root@visionet8 ~]# rpm -Uvh remi-release-6.rpm\n```\n\n#### 2. 我们看下Remi的的yum配置文件\n```\n# Repository: http://rpms.remirepo.net/\n# Blog:       http://blog.remirepo.net/\n# Forum:      http://forum.remirepo.net/\n\n[remi]\nname=Remi's RPM repository for Enterprise Linux 6 - $basearch\nbaseurl=http://rpms.remirepo.net/enterprise/6/remi/$basearch/\n#mirrorlist=http://rpms.remirepo.net/enterprise/6/remi/mirror\nenabled=1\ngpgcheck=0\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n\n[remi-php55]\nname=Remi's PHP 5.5 RPM repository for Enterprise Linux 6 - $basearch\n#baseurl=http://rpms.remirepo.net/enterprise/6/php55/$basearch/\nmirrorlist=http://rpms.remirepo.net/enterprise/6/php55/mirror\n# NOTICE: common dependencies are in \"remi-safe\"\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n\n[remi-php56]\nname=Remi's PHP 5.6 RPM repository for Enterprise Linux 6 - $basearch\n#baseurl=http://rpms.remirepo.net/enterprise/6/php56/$basearch/\nmirrorlist=http://rpms.remirepo.net/enterprise/6/php56/mirror\n# NOTICE: common dependencies are in \"remi-safe\"\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n```\n\n经过测试，启用remi源之后，默认情况下php版本为5.4,这时我们只需要升级php即可。\n\n```\n[root@visionet8 html]# yum update -y php*\nFailed to set locale, defaulting to C\nLoaded plugins: fastestmirror, refresh-packagekit, security\nLoading mirror speeds from cached hostfile\n * base: mirrors.163.com\n * epel: mirrors.ustc.edu.cn\n * extras: mirrors.aliyun.com\n * remi-safe: mirrors.tuna.tsinghua.edu.cn\n * updates: mirrors.cn99.com\nremi                                                                               | 2.9 kB     00:00\nremi/primary_db                                                                    | 1.6 MB     00:05\nSetting up Update Process\nResolving Dependencies\n--> Running transaction check\n---> Package php.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-cli.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-cli.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-common.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-common.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-gd.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-gd.x86_64 0:5.4.45-12.el6.remi will be an update\n--> Processing Dependency: libt1.so.5()(64bit) for package: php-gd-5.4.45-12.el6.remi.x86_64\n---> Package php-mcrypt.x86_64 0:5.3.3-4.el6 will be updated\n---> Package php-mcrypt.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-mysql.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-mysql.x86_64 0:5.4.45-12.el6.remi will be an update\n---> Package php-pdo.x86_64 0:5.3.3-48.el6_8 will be updated\n---> Package php-pdo.x86_64 0:5.4.45-12.el6.remi will be an update\n--> Running transaction check\n---> Package t1lib.x86_64 0:5.1.2-6.el6_2.1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n==========================================================================================================\n Package                  Arch                 Version                           Repository          Size\n==========================================================================================================\nUpdating:\n php                      x86_64               5.4.45-12.el6.remi                remi               2.8 M\n php-cli                  x86_64               5.4.45-12.el6.remi                remi               4.1 M\n php-common               x86_64               5.4.45-12.el6.remi                remi               968 k\n php-gd                   x86_64               5.4.45-12.el6.remi                remi               152 k\n php-mcrypt               x86_64               5.4.45-12.el6.remi                remi                60 k\n php-mysql                x86_64               5.4.45-12.el6.remi                remi               145 k\n php-pdo                  x86_64               5.4.45-12.el6.remi                remi               129 k\nInstalling for dependencies:\n t1lib                    x86_64               5.1.2-6.el6_2.1                   base               160 k\n\nTransaction Summary\n==========================================================================================================\nInstall       1 Package(s)\nUpgrade       7 Package(s)\n\nTotal download size: 8.5 M\nDownloading Packages:\n(1/8): php-5.4.45-12.el6.remi.x86_64.rpm                                           | 2.8 MB     00:07\n(2/8): php-cli-5.4.45-12.el6.remi.x86_64.rpm                                       | 4.1 MB     00:06\n(3/8): php-common-5.4.45-12.el6.remi.x86_64.rpm                                    | 968 kB     00:02\n(4/8): php-gd-5.4.45-12.el6.remi.x86_64.rpm                                        | 152 kB     00:01\n(5/8): php-mcrypt-5.4.45-12.el6.remi.x86_64.rpm                                    |  60 kB     00:00\n(6/8): php-mysql-5.4.45-12.el6.remi.x86_64.rpm                                     | 145 kB     00:00\n(7/8): php-pdo-5.4.45-12.el6.remi.x86_64.rpm                                       | 129 kB     00:01\n(8/8): t1lib-5.1.2-6.el6_2.1.x86_64.rpm                                            | 160 kB     00:00\n----------------------------------------------------------------------------------------------------------\nTotal                                                                     338 kB/s | 8.5 MB     00:25\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\nWarning: RPMDB altered outside of yum.\n  Updating   : php-common-5.4.45-12.el6.remi.x86_64                                                  1/15\n  Updating   : php-cli-5.4.45-12.el6.remi.x86_64                                                     2/15\n  Updating   : php-pdo-5.4.45-12.el6.remi.x86_64                                                     3/15\n  Installing : t1lib-5.1.2-6.el6_2.1.x86_64                                                          4/15\n  Updating   : php-gd-5.4.45-12.el6.remi.x86_64                                                      5/15\n  Updating   : php-mysql-5.4.45-12.el6.remi.x86_64                                                   6/15\n  Updating   : php-5.4.45-12.el6.remi.x86_64                                                         7/15\n  Updating   : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  8/15\n  Cleanup    : php-5.3.3-48.el6_8.x86_64                                                             9/15\n  Cleanup    : php-mysql-5.3.3-48.el6_8.x86_64                                                      10/15\n  Cleanup    : php-pdo-5.3.3-48.el6_8.x86_64                                                        11/15\n  Cleanup    : php-cli-5.3.3-48.el6_8.x86_64                                                        12/15\n  Cleanup    : php-gd-5.3.3-48.el6_8.x86_64                                                         13/15\n  Cleanup    : php-mcrypt-5.3.3-4.el6.x86_64                                                        14/15\n  Cleanup    : php-common-5.3.3-48.el6_8.x86_64                                                     15/15\n  Verifying  : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  1/15\n  Verifying  : t1lib-5.1.2-6.el6_2.1.x86_64                                                          2/15\n  Verifying  : php-common-5.4.45-12.el6.remi.x86_64                                                  3/15\n  Verifying  : php-gd-5.4.45-12.el6.remi.x86_64                                                      4/15\n  Verifying  : php-cli-5.4.45-12.el6.remi.x86_64                                                     5/15\n  Verifying  : php-pdo-5.4.45-12.el6.remi.x86_64                                                     6/15\n  Verifying  : php-mysql-5.4.45-12.el6.remi.x86_64                                                   7/15\n  Verifying  : php-5.4.45-12.el6.remi.x86_64                                                         8/15\n  Verifying  : php-5.3.3-48.el6_8.x86_64                                                             9/15\n  Verifying  : php-gd-5.3.3-48.el6_8.x86_64                                                         10/15\n  Verifying  : php-cli-5.3.3-48.el6_8.x86_64                                                        11/15\n  Verifying  : php-pdo-5.3.3-48.el6_8.x86_64                                                        12/15\n  Verifying  : php-common-5.3.3-48.el6_8.x86_64                                                     13/15\n  Verifying  : php-mysql-5.3.3-48.el6_8.x86_64                                                      14/15\n  Verifying  : php-mcrypt-5.3.3-4.el6.x86_64                                                        15/15\n\nDependency Installed:\n  t1lib.x86_64 0:5.1.2-6.el6_2.1\n\nUpdated:\n  php.x86_64 0:5.4.45-12.el6.remi                      php-cli.x86_64 0:5.4.45-12.el6.remi\n  php-common.x86_64 0:5.4.45-12.el6.remi               php-gd.x86_64 0:5.4.45-12.el6.remi\n  php-mcrypt.x86_64 0:5.4.45-12.el6.remi               php-mysql.x86_64 0:5.4.45-12.el6.remi\n  php-pdo.x86_64 0:5.4.45-12.el6.remi\n\nComplete!\n```\n\n#### 3. 测试：\n```\n[root@visionet8 html]# php -v\nPHP 5.4.45 (cli) (built: Sep 19 2016 15:31:07)\nCopyright (c) 1997-2014 The PHP Group\nZend Engine v2.4.0, Copyright (c) 1998-2014 Zend Technologies\n```\n\n#### 4. php 5.5 和php5.6\n\n>  若要升级到5.5 或 5.6，根据remi源的配置文件，将php5.5的enable参数设置为1，并将默认enable修改为0,然后<code>yum update php*</code>即可。\n<hr/>\n\n\n#### 5. php 7\n> 安装完成之后发现, 在安装remi源之后，在<code>/etc/yum.repos.d</code>除了<code>remi.repo</code>之外，还有<code>remi-php70.repo</code>和<code>remi-php71.repo</code>，测试下，如果要升级到php7，可以打开相应源仓库的配置文件，之后升级即可。\n\n<br>\n\n> <b>以上功能在升级时，要考虑其他组件的版本兼容性，不要盲目升级。</b>\n","slug":"php54-centos6","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqdx008141tpobqskevg","content":"<p><br>CentOS 6 默认安装的PHP 版本是5.3， 但现在很多应用对于LAMP中，PHP的版本最低5.4，所以本篇文章的主要内容是，如何升级PHP5.3到5.4以及更高版本<br> </p>\n\n<h2 id=\"实验环境：CentOS-6-4\"><a href=\"#实验环境：CentOS-6-4\" class=\"headerlink\" title=\"实验环境：CentOS 6.4\"></a>实验环境：CentOS 6.4</h2><p>解决办法是采用了remi源仓库已经适配的相应php版本</p>\n<blockquote>\n<p>经过测试，该升级办法同样适用目前CentOS 6.x 所有版本</p>\n</blockquote>\n<h4 id=\"1-安装Remi源\"><a href=\"#1-安装Remi源\" class=\"headerlink\" title=\"1. 安装Remi源\"></a>1. 安装Remi源</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 因为remi依赖epel源仓库，所有我们要先安装它。</div><div class=\"line\">[root@visionet8 ~]# yum install -y epel-release</div><div class=\"line\"></div><div class=\"line\">[root@visionet8 ~]# wget http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</div><div class=\"line\">[root@visionet8 ~]# rpm -Uvh remi-release-6.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"2-我们看下Remi的的yum配置文件\"><a href=\"#2-我们看下Remi的的yum配置文件\" class=\"headerlink\" title=\"2. 我们看下Remi的的yum配置文件\"></a>2. 我们看下Remi的的yum配置文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Repository: http://rpms.remirepo.net/</div><div class=\"line\"># Blog:       http://blog.remirepo.net/</div><div class=\"line\"># Forum:      http://forum.remirepo.net/</div><div class=\"line\"></div><div class=\"line\">[remi]</div><div class=\"line\">name=Remi&apos;s RPM repository for Enterprise Linux 6 - $basearch</div><div class=\"line\">baseurl=http://rpms.remirepo.net/enterprise/6/remi/$basearch/</div><div class=\"line\">#mirrorlist=http://rpms.remirepo.net/enterprise/6/remi/mirror</div><div class=\"line\">enabled=1</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div><div class=\"line\"></div><div class=\"line\">[remi-php55]</div><div class=\"line\">name=Remi&apos;s PHP 5.5 RPM repository for Enterprise Linux 6 - $basearch</div><div class=\"line\">#baseurl=http://rpms.remirepo.net/enterprise/6/php55/$basearch/</div><div class=\"line\">mirrorlist=http://rpms.remirepo.net/enterprise/6/php55/mirror</div><div class=\"line\"># NOTICE: common dependencies are in &quot;remi-safe&quot;</div><div class=\"line\">enabled=0</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div><div class=\"line\"></div><div class=\"line\">[remi-php56]</div><div class=\"line\">name=Remi&apos;s PHP 5.6 RPM repository for Enterprise Linux 6 - $basearch</div><div class=\"line\">#baseurl=http://rpms.remirepo.net/enterprise/6/php56/$basearch/</div><div class=\"line\">mirrorlist=http://rpms.remirepo.net/enterprise/6/php56/mirror</div><div class=\"line\"># NOTICE: common dependencies are in &quot;remi-safe&quot;</div><div class=\"line\">enabled=0</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div></pre></td></tr></table></figure>\n<p>经过测试，启用remi源之后，默认情况下php版本为5.4,这时我们只需要升级php即可。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@visionet8 html]# yum update -y php*</div><div class=\"line\">Failed to set locale, defaulting to C</div><div class=\"line\">Loaded plugins: fastestmirror, refresh-packagekit, security</div><div class=\"line\">Loading mirror speeds from cached hostfile</div><div class=\"line\"> * base: mirrors.163.com</div><div class=\"line\"> * epel: mirrors.ustc.edu.cn</div><div class=\"line\"> * extras: mirrors.aliyun.com</div><div class=\"line\"> * remi-safe: mirrors.tuna.tsinghua.edu.cn</div><div class=\"line\"> * updates: mirrors.cn99.com</div><div class=\"line\">remi                                                                               | 2.9 kB     00:00</div><div class=\"line\">remi/primary_db                                                                    | 1.6 MB     00:05</div><div class=\"line\">Setting up Update Process</div><div class=\"line\">Resolving Dependencies</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package php.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-cli.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-cli.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-common.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-common.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-gd.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-gd.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">--&gt; Processing Dependency: libt1.so.5()(64bit) for package: php-gd-5.4.45-12.el6.remi.x86_64</div><div class=\"line\">---&gt; Package php-mcrypt.x86_64 0:5.3.3-4.el6 will be updated</div><div class=\"line\">---&gt; Package php-mcrypt.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-mysql.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-mysql.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-pdo.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-pdo.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package t1lib.x86_64 0:5.1.2-6.el6_2.1 will be installed</div><div class=\"line\">--&gt; Finished Dependency Resolution</div><div class=\"line\"></div><div class=\"line\">Dependencies Resolved</div><div class=\"line\"></div><div class=\"line\">==========================================================================================================</div><div class=\"line\"> Package                  Arch                 Version                           Repository          Size</div><div class=\"line\">==========================================================================================================</div><div class=\"line\">Updating:</div><div class=\"line\"> php                      x86_64               5.4.45-12.el6.remi                remi               2.8 M</div><div class=\"line\"> php-cli                  x86_64               5.4.45-12.el6.remi                remi               4.1 M</div><div class=\"line\"> php-common               x86_64               5.4.45-12.el6.remi                remi               968 k</div><div class=\"line\"> php-gd                   x86_64               5.4.45-12.el6.remi                remi               152 k</div><div class=\"line\"> php-mcrypt               x86_64               5.4.45-12.el6.remi                remi                60 k</div><div class=\"line\"> php-mysql                x86_64               5.4.45-12.el6.remi                remi               145 k</div><div class=\"line\"> php-pdo                  x86_64               5.4.45-12.el6.remi                remi               129 k</div><div class=\"line\">Installing for dependencies:</div><div class=\"line\"> t1lib                    x86_64               5.1.2-6.el6_2.1                   base               160 k</div><div class=\"line\"></div><div class=\"line\">Transaction Summary</div><div class=\"line\">==========================================================================================================</div><div class=\"line\">Install       1 Package(s)</div><div class=\"line\">Upgrade       7 Package(s)</div><div class=\"line\"></div><div class=\"line\">Total download size: 8.5 M</div><div class=\"line\">Downloading Packages:</div><div class=\"line\">(1/8): php-5.4.45-12.el6.remi.x86_64.rpm                                           | 2.8 MB     00:07</div><div class=\"line\">(2/8): php-cli-5.4.45-12.el6.remi.x86_64.rpm                                       | 4.1 MB     00:06</div><div class=\"line\">(3/8): php-common-5.4.45-12.el6.remi.x86_64.rpm                                    | 968 kB     00:02</div><div class=\"line\">(4/8): php-gd-5.4.45-12.el6.remi.x86_64.rpm                                        | 152 kB     00:01</div><div class=\"line\">(5/8): php-mcrypt-5.4.45-12.el6.remi.x86_64.rpm                                    |  60 kB     00:00</div><div class=\"line\">(6/8): php-mysql-5.4.45-12.el6.remi.x86_64.rpm                                     | 145 kB     00:00</div><div class=\"line\">(7/8): php-pdo-5.4.45-12.el6.remi.x86_64.rpm                                       | 129 kB     00:01</div><div class=\"line\">(8/8): t1lib-5.1.2-6.el6_2.1.x86_64.rpm                                            | 160 kB     00:00</div><div class=\"line\">----------------------------------------------------------------------------------------------------------</div><div class=\"line\">Total                                                                     338 kB/s | 8.5 MB     00:25</div><div class=\"line\">Running rpm_check_debug</div><div class=\"line\">Running Transaction Test</div><div class=\"line\">Transaction Test Succeeded</div><div class=\"line\">Running Transaction</div><div class=\"line\">Warning: RPMDB altered outside of yum.</div><div class=\"line\">  Updating   : php-common-5.4.45-12.el6.remi.x86_64                                                  1/15</div><div class=\"line\">  Updating   : php-cli-5.4.45-12.el6.remi.x86_64                                                     2/15</div><div class=\"line\">  Updating   : php-pdo-5.4.45-12.el6.remi.x86_64                                                     3/15</div><div class=\"line\">  Installing : t1lib-5.1.2-6.el6_2.1.x86_64                                                          4/15</div><div class=\"line\">  Updating   : php-gd-5.4.45-12.el6.remi.x86_64                                                      5/15</div><div class=\"line\">  Updating   : php-mysql-5.4.45-12.el6.remi.x86_64                                                   6/15</div><div class=\"line\">  Updating   : php-5.4.45-12.el6.remi.x86_64                                                         7/15</div><div class=\"line\">  Updating   : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  8/15</div><div class=\"line\">  Cleanup    : php-5.3.3-48.el6_8.x86_64                                                             9/15</div><div class=\"line\">  Cleanup    : php-mysql-5.3.3-48.el6_8.x86_64                                                      10/15</div><div class=\"line\">  Cleanup    : php-pdo-5.3.3-48.el6_8.x86_64                                                        11/15</div><div class=\"line\">  Cleanup    : php-cli-5.3.3-48.el6_8.x86_64                                                        12/15</div><div class=\"line\">  Cleanup    : php-gd-5.3.3-48.el6_8.x86_64                                                         13/15</div><div class=\"line\">  Cleanup    : php-mcrypt-5.3.3-4.el6.x86_64                                                        14/15</div><div class=\"line\">  Cleanup    : php-common-5.3.3-48.el6_8.x86_64                                                     15/15</div><div class=\"line\">  Verifying  : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  1/15</div><div class=\"line\">  Verifying  : t1lib-5.1.2-6.el6_2.1.x86_64                                                          2/15</div><div class=\"line\">  Verifying  : php-common-5.4.45-12.el6.remi.x86_64                                                  3/15</div><div class=\"line\">  Verifying  : php-gd-5.4.45-12.el6.remi.x86_64                                                      4/15</div><div class=\"line\">  Verifying  : php-cli-5.4.45-12.el6.remi.x86_64                                                     5/15</div><div class=\"line\">  Verifying  : php-pdo-5.4.45-12.el6.remi.x86_64                                                     6/15</div><div class=\"line\">  Verifying  : php-mysql-5.4.45-12.el6.remi.x86_64                                                   7/15</div><div class=\"line\">  Verifying  : php-5.4.45-12.el6.remi.x86_64                                                         8/15</div><div class=\"line\">  Verifying  : php-5.3.3-48.el6_8.x86_64                                                             9/15</div><div class=\"line\">  Verifying  : php-gd-5.3.3-48.el6_8.x86_64                                                         10/15</div><div class=\"line\">  Verifying  : php-cli-5.3.3-48.el6_8.x86_64                                                        11/15</div><div class=\"line\">  Verifying  : php-pdo-5.3.3-48.el6_8.x86_64                                                        12/15</div><div class=\"line\">  Verifying  : php-common-5.3.3-48.el6_8.x86_64                                                     13/15</div><div class=\"line\">  Verifying  : php-mysql-5.3.3-48.el6_8.x86_64                                                      14/15</div><div class=\"line\">  Verifying  : php-mcrypt-5.3.3-4.el6.x86_64                                                        15/15</div><div class=\"line\"></div><div class=\"line\">Dependency Installed:</div><div class=\"line\">  t1lib.x86_64 0:5.1.2-6.el6_2.1</div><div class=\"line\"></div><div class=\"line\">Updated:</div><div class=\"line\">  php.x86_64 0:5.4.45-12.el6.remi                      php-cli.x86_64 0:5.4.45-12.el6.remi</div><div class=\"line\">  php-common.x86_64 0:5.4.45-12.el6.remi               php-gd.x86_64 0:5.4.45-12.el6.remi</div><div class=\"line\">  php-mcrypt.x86_64 0:5.4.45-12.el6.remi               php-mysql.x86_64 0:5.4.45-12.el6.remi</div><div class=\"line\">  php-pdo.x86_64 0:5.4.45-12.el6.remi</div><div class=\"line\"></div><div class=\"line\">Complete!</div></pre></td></tr></table></figure>\n<h4 id=\"3-测试：\"><a href=\"#3-测试：\" class=\"headerlink\" title=\"3. 测试：\"></a>3. 测试：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@visionet8 html]# php -v</div><div class=\"line\">PHP 5.4.45 (cli) (built: Sep 19 2016 15:31:07)</div><div class=\"line\">Copyright (c) 1997-2014 The PHP Group</div><div class=\"line\">Zend Engine v2.4.0, Copyright (c) 1998-2014 Zend Technologies</div></pre></td></tr></table></figure>\n<h4 id=\"4-php-5-5-和php5-6\"><a href=\"#4-php-5-5-和php5-6\" class=\"headerlink\" title=\"4. php 5.5 和php5.6\"></a>4. php 5.5 和php5.6</h4><blockquote>\n<p> 若要升级到5.5 或 5.6，根据remi源的配置文件，将php5.5的enable参数设置为1，并将默认enable修改为0,然后<code>yum update php*</code>即可。</p>\n<hr>\n\n\n</blockquote>\n<h4 id=\"5-php-7\"><a href=\"#5-php-7\" class=\"headerlink\" title=\"5. php 7\"></a>5. php 7</h4><blockquote>\n<p>安装完成之后发现, 在安装remi源之后，在<code>/etc/yum.repos.d</code>除了<code>remi.repo</code>之外，还有<code>remi-php70.repo</code>和<code>remi-php71.repo</code>，测试下，如果要升级到php7，可以打开相应源仓库的配置文件，之后升级即可。</p>\n</blockquote>\n<p><br></p>\n<blockquote>\n<p><b>以上功能在升级时，要考虑其他组件的版本兼容性，不要盲目升级。</b></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p><br>CentOS 6 默认安装的PHP 版本是5.3， 但现在很多应用对于LAMP中，PHP的版本最低5.4，所以本篇文章的主要内容是，如何升级PHP5.3到5.4以及更高版本<br> </p>\n\n<h2 id=\"实验环境：CentOS-6-4\"><a href=\"#实验环境：CentOS-6-4\" class=\"headerlink\" title=\"实验环境：CentOS 6.4\"></a>实验环境：CentOS 6.4</h2><p>解决办法是采用了remi源仓库已经适配的相应php版本</p>\n<blockquote>\n<p>经过测试，该升级办法同样适用目前CentOS 6.x 所有版本</p>\n</blockquote>\n<h4 id=\"1-安装Remi源\"><a href=\"#1-安装Remi源\" class=\"headerlink\" title=\"1. 安装Remi源\"></a>1. 安装Remi源</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 因为remi依赖epel源仓库，所有我们要先安装它。</div><div class=\"line\">[root@visionet8 ~]# yum install -y epel-release</div><div class=\"line\"></div><div class=\"line\">[root@visionet8 ~]# wget http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</div><div class=\"line\">[root@visionet8 ~]# rpm -Uvh remi-release-6.rpm</div></pre></td></tr></table></figure>\n<h4 id=\"2-我们看下Remi的的yum配置文件\"><a href=\"#2-我们看下Remi的的yum配置文件\" class=\"headerlink\" title=\"2. 我们看下Remi的的yum配置文件\"></a>2. 我们看下Remi的的yum配置文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Repository: http://rpms.remirepo.net/</div><div class=\"line\"># Blog:       http://blog.remirepo.net/</div><div class=\"line\"># Forum:      http://forum.remirepo.net/</div><div class=\"line\"></div><div class=\"line\">[remi]</div><div class=\"line\">name=Remi&apos;s RPM repository for Enterprise Linux 6 - $basearch</div><div class=\"line\">baseurl=http://rpms.remirepo.net/enterprise/6/remi/$basearch/</div><div class=\"line\">#mirrorlist=http://rpms.remirepo.net/enterprise/6/remi/mirror</div><div class=\"line\">enabled=1</div><div class=\"line\">gpgcheck=0</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div><div class=\"line\"></div><div class=\"line\">[remi-php55]</div><div class=\"line\">name=Remi&apos;s PHP 5.5 RPM repository for Enterprise Linux 6 - $basearch</div><div class=\"line\">#baseurl=http://rpms.remirepo.net/enterprise/6/php55/$basearch/</div><div class=\"line\">mirrorlist=http://rpms.remirepo.net/enterprise/6/php55/mirror</div><div class=\"line\"># NOTICE: common dependencies are in &quot;remi-safe&quot;</div><div class=\"line\">enabled=0</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div><div class=\"line\"></div><div class=\"line\">[remi-php56]</div><div class=\"line\">name=Remi&apos;s PHP 5.6 RPM repository for Enterprise Linux 6 - $basearch</div><div class=\"line\">#baseurl=http://rpms.remirepo.net/enterprise/6/php56/$basearch/</div><div class=\"line\">mirrorlist=http://rpms.remirepo.net/enterprise/6/php56/mirror</div><div class=\"line\"># NOTICE: common dependencies are in &quot;remi-safe&quot;</div><div class=\"line\">enabled=0</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div></pre></td></tr></table></figure>\n<p>经过测试，启用remi源之后，默认情况下php版本为5.4,这时我们只需要升级php即可。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@visionet8 html]# yum update -y php*</div><div class=\"line\">Failed to set locale, defaulting to C</div><div class=\"line\">Loaded plugins: fastestmirror, refresh-packagekit, security</div><div class=\"line\">Loading mirror speeds from cached hostfile</div><div class=\"line\"> * base: mirrors.163.com</div><div class=\"line\"> * epel: mirrors.ustc.edu.cn</div><div class=\"line\"> * extras: mirrors.aliyun.com</div><div class=\"line\"> * remi-safe: mirrors.tuna.tsinghua.edu.cn</div><div class=\"line\"> * updates: mirrors.cn99.com</div><div class=\"line\">remi                                                                               | 2.9 kB     00:00</div><div class=\"line\">remi/primary_db                                                                    | 1.6 MB     00:05</div><div class=\"line\">Setting up Update Process</div><div class=\"line\">Resolving Dependencies</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package php.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-cli.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-cli.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-common.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-common.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-gd.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-gd.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">--&gt; Processing Dependency: libt1.so.5()(64bit) for package: php-gd-5.4.45-12.el6.remi.x86_64</div><div class=\"line\">---&gt; Package php-mcrypt.x86_64 0:5.3.3-4.el6 will be updated</div><div class=\"line\">---&gt; Package php-mcrypt.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-mysql.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-mysql.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">---&gt; Package php-pdo.x86_64 0:5.3.3-48.el6_8 will be updated</div><div class=\"line\">---&gt; Package php-pdo.x86_64 0:5.4.45-12.el6.remi will be an update</div><div class=\"line\">--&gt; Running transaction check</div><div class=\"line\">---&gt; Package t1lib.x86_64 0:5.1.2-6.el6_2.1 will be installed</div><div class=\"line\">--&gt; Finished Dependency Resolution</div><div class=\"line\"></div><div class=\"line\">Dependencies Resolved</div><div class=\"line\"></div><div class=\"line\">==========================================================================================================</div><div class=\"line\"> Package                  Arch                 Version                           Repository          Size</div><div class=\"line\">==========================================================================================================</div><div class=\"line\">Updating:</div><div class=\"line\"> php                      x86_64               5.4.45-12.el6.remi                remi               2.8 M</div><div class=\"line\"> php-cli                  x86_64               5.4.45-12.el6.remi                remi               4.1 M</div><div class=\"line\"> php-common               x86_64               5.4.45-12.el6.remi                remi               968 k</div><div class=\"line\"> php-gd                   x86_64               5.4.45-12.el6.remi                remi               152 k</div><div class=\"line\"> php-mcrypt               x86_64               5.4.45-12.el6.remi                remi                60 k</div><div class=\"line\"> php-mysql                x86_64               5.4.45-12.el6.remi                remi               145 k</div><div class=\"line\"> php-pdo                  x86_64               5.4.45-12.el6.remi                remi               129 k</div><div class=\"line\">Installing for dependencies:</div><div class=\"line\"> t1lib                    x86_64               5.1.2-6.el6_2.1                   base               160 k</div><div class=\"line\"></div><div class=\"line\">Transaction Summary</div><div class=\"line\">==========================================================================================================</div><div class=\"line\">Install       1 Package(s)</div><div class=\"line\">Upgrade       7 Package(s)</div><div class=\"line\"></div><div class=\"line\">Total download size: 8.5 M</div><div class=\"line\">Downloading Packages:</div><div class=\"line\">(1/8): php-5.4.45-12.el6.remi.x86_64.rpm                                           | 2.8 MB     00:07</div><div class=\"line\">(2/8): php-cli-5.4.45-12.el6.remi.x86_64.rpm                                       | 4.1 MB     00:06</div><div class=\"line\">(3/8): php-common-5.4.45-12.el6.remi.x86_64.rpm                                    | 968 kB     00:02</div><div class=\"line\">(4/8): php-gd-5.4.45-12.el6.remi.x86_64.rpm                                        | 152 kB     00:01</div><div class=\"line\">(5/8): php-mcrypt-5.4.45-12.el6.remi.x86_64.rpm                                    |  60 kB     00:00</div><div class=\"line\">(6/8): php-mysql-5.4.45-12.el6.remi.x86_64.rpm                                     | 145 kB     00:00</div><div class=\"line\">(7/8): php-pdo-5.4.45-12.el6.remi.x86_64.rpm                                       | 129 kB     00:01</div><div class=\"line\">(8/8): t1lib-5.1.2-6.el6_2.1.x86_64.rpm                                            | 160 kB     00:00</div><div class=\"line\">----------------------------------------------------------------------------------------------------------</div><div class=\"line\">Total                                                                     338 kB/s | 8.5 MB     00:25</div><div class=\"line\">Running rpm_check_debug</div><div class=\"line\">Running Transaction Test</div><div class=\"line\">Transaction Test Succeeded</div><div class=\"line\">Running Transaction</div><div class=\"line\">Warning: RPMDB altered outside of yum.</div><div class=\"line\">  Updating   : php-common-5.4.45-12.el6.remi.x86_64                                                  1/15</div><div class=\"line\">  Updating   : php-cli-5.4.45-12.el6.remi.x86_64                                                     2/15</div><div class=\"line\">  Updating   : php-pdo-5.4.45-12.el6.remi.x86_64                                                     3/15</div><div class=\"line\">  Installing : t1lib-5.1.2-6.el6_2.1.x86_64                                                          4/15</div><div class=\"line\">  Updating   : php-gd-5.4.45-12.el6.remi.x86_64                                                      5/15</div><div class=\"line\">  Updating   : php-mysql-5.4.45-12.el6.remi.x86_64                                                   6/15</div><div class=\"line\">  Updating   : php-5.4.45-12.el6.remi.x86_64                                                         7/15</div><div class=\"line\">  Updating   : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  8/15</div><div class=\"line\">  Cleanup    : php-5.3.3-48.el6_8.x86_64                                                             9/15</div><div class=\"line\">  Cleanup    : php-mysql-5.3.3-48.el6_8.x86_64                                                      10/15</div><div class=\"line\">  Cleanup    : php-pdo-5.3.3-48.el6_8.x86_64                                                        11/15</div><div class=\"line\">  Cleanup    : php-cli-5.3.3-48.el6_8.x86_64                                                        12/15</div><div class=\"line\">  Cleanup    : php-gd-5.3.3-48.el6_8.x86_64                                                         13/15</div><div class=\"line\">  Cleanup    : php-mcrypt-5.3.3-4.el6.x86_64                                                        14/15</div><div class=\"line\">  Cleanup    : php-common-5.3.3-48.el6_8.x86_64                                                     15/15</div><div class=\"line\">  Verifying  : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  1/15</div><div class=\"line\">  Verifying  : t1lib-5.1.2-6.el6_2.1.x86_64                                                          2/15</div><div class=\"line\">  Verifying  : php-common-5.4.45-12.el6.remi.x86_64                                                  3/15</div><div class=\"line\">  Verifying  : php-gd-5.4.45-12.el6.remi.x86_64                                                      4/15</div><div class=\"line\">  Verifying  : php-cli-5.4.45-12.el6.remi.x86_64                                                     5/15</div><div class=\"line\">  Verifying  : php-pdo-5.4.45-12.el6.remi.x86_64                                                     6/15</div><div class=\"line\">  Verifying  : php-mysql-5.4.45-12.el6.remi.x86_64                                                   7/15</div><div class=\"line\">  Verifying  : php-5.4.45-12.el6.remi.x86_64                                                         8/15</div><div class=\"line\">  Verifying  : php-5.3.3-48.el6_8.x86_64                                                             9/15</div><div class=\"line\">  Verifying  : php-gd-5.3.3-48.el6_8.x86_64                                                         10/15</div><div class=\"line\">  Verifying  : php-cli-5.3.3-48.el6_8.x86_64                                                        11/15</div><div class=\"line\">  Verifying  : php-pdo-5.3.3-48.el6_8.x86_64                                                        12/15</div><div class=\"line\">  Verifying  : php-common-5.3.3-48.el6_8.x86_64                                                     13/15</div><div class=\"line\">  Verifying  : php-mysql-5.3.3-48.el6_8.x86_64                                                      14/15</div><div class=\"line\">  Verifying  : php-mcrypt-5.3.3-4.el6.x86_64                                                        15/15</div><div class=\"line\"></div><div class=\"line\">Dependency Installed:</div><div class=\"line\">  t1lib.x86_64 0:5.1.2-6.el6_2.1</div><div class=\"line\"></div><div class=\"line\">Updated:</div><div class=\"line\">  php.x86_64 0:5.4.45-12.el6.remi                      php-cli.x86_64 0:5.4.45-12.el6.remi</div><div class=\"line\">  php-common.x86_64 0:5.4.45-12.el6.remi               php-gd.x86_64 0:5.4.45-12.el6.remi</div><div class=\"line\">  php-mcrypt.x86_64 0:5.4.45-12.el6.remi               php-mysql.x86_64 0:5.4.45-12.el6.remi</div><div class=\"line\">  php-pdo.x86_64 0:5.4.45-12.el6.remi</div><div class=\"line\"></div><div class=\"line\">Complete!</div></pre></td></tr></table></figure>\n<h4 id=\"3-测试：\"><a href=\"#3-测试：\" class=\"headerlink\" title=\"3. 测试：\"></a>3. 测试：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@visionet8 html]# php -v</div><div class=\"line\">PHP 5.4.45 (cli) (built: Sep 19 2016 15:31:07)</div><div class=\"line\">Copyright (c) 1997-2014 The PHP Group</div><div class=\"line\">Zend Engine v2.4.0, Copyright (c) 1998-2014 Zend Technologies</div></pre></td></tr></table></figure>\n<h4 id=\"4-php-5-5-和php5-6\"><a href=\"#4-php-5-5-和php5-6\" class=\"headerlink\" title=\"4. php 5.5 和php5.6\"></a>4. php 5.5 和php5.6</h4><blockquote>\n<p> 若要升级到5.5 或 5.6，根据remi源的配置文件，将php5.5的enable参数设置为1，并将默认enable修改为0,然后<code>yum update php*</code>即可。</p>\n<hr/>\n\n\n</blockquote>\n<h4 id=\"5-php-7\"><a href=\"#5-php-7\" class=\"headerlink\" title=\"5. php 7\"></a>5. php 7</h4><blockquote>\n<p>安装完成之后发现, 在安装remi源之后，在<code>/etc/yum.repos.d</code>除了<code>remi.repo</code>之外，还有<code>remi-php70.repo</code>和<code>remi-php71.repo</code>，测试下，如果要升级到php7，可以打开相应源仓库的配置文件，之后升级即可。</p>\n</blockquote>\n<p><br></p>\n<blockquote>\n<p><b>以上功能在升级时，要考虑其他组件的版本兼容性，不要盲目升级。</b></p>\n</blockquote>\n"},{"title":"我是一个最不会写标题的人","id":"10007","date":"2014-03-27T02:34:54.000Z","_content":"\n\n之前一直我以为自己是在纠结到底哪里适合写IT学习的博文，新浪、网易亦或腾讯，折腾了许久，其实自己明白，不是在哪里写的问题，根本在于自己能否坚持下来，我本身是一个不怎么能耐下来性子的人，学习Linux、C还要考学历，总是做做这个，做做那个，没能认真研究，所以这么久时间还是停留在一个“初学者”的位置。\n\n2014年，这一年是一开始就让我悲痛到无以复加的一年，陷入迷茫让我不知道自己未来的路怎么走，能走多久，可是，我也清清楚楚地明白，我要努力改变，人生充满了太多的不可思议以及你无能为力的悲剧，今年已经过了近四个月份了，一直没能好好整理自己的心情，太沉溺过去的人是个弱者，人生会有很多我们无能为力的事，这让我们心生沮丧，可是不敢逃离还是面对，事情都已经发生在了过去，某一个时间点，是一个想起来都会让自己泪眼婆娑的时间点，我失去了一个生命中最最重要的人，往事只能回忆，也许到我将离去的时候，我才能够坦然面对人生旅途中走着走着就消失的人，我怀念，无时不刻。\n\n谈恋爱，是我这个年纪最容易被提及的问题，我一直排斥去谈恋爱，很多人不明白为什么会是这样；其实，是因为害怕失去，所以不敢拥有，有过一段失败的经历，让我不敢再次尝试，因为我没有把握，也没有勇气，小心翼翼；我总是夸夸其谈着别人的经历，却对自己不敢触及，我所说的努力让自己变得更好，才配得上爱我的人，只是害怕因为自己不够好，致使爱我的人离我而去，不是不相信另一半，是不相信自己，这个现实到令人发指的社会，我不能自私的以为爱情可以战胜一切，这种人也许别人会感到可怜，但最终会被人鄙夷，好姑娘都应该有一个好的归宿，在我没有能力肩负起爱情的责任时，抱歉，我不能说“爱”。其实，我缺少的，钱只是一小部分，更多的是缺少的是一颗勇敢的心，不够成熟的自己，当我不能够做好自己时，如何能够不负责任地肆意冲进别人的生活，伤害了别人，也羞辱了自己。\n\n生理年龄不代表心里年龄，明白自己想做什么，就应该努力去做，尽管我这么大了，这里也是一个开始，命运之轮是不可琢磨的，任何事在该发生的时候就会发生，早一点，晚一点，都是悲剧，如果我错过了一个深爱的姑娘，那么对不起，我想是我的修炼不够；生活在别处，我在这里，安静地学习，成长，成熟，对现实的忍耐，对未来的憧憬，不惊奇也不平淡，命运之轮不会偏移一丝一毫，我想做的只是让自己蜕变，尽量去做我想做的自己。\n\n近期一直在看《德川家康》，还没看完，深刻感受到，在大势中人的渺小与乏力，如果想要成为你想要成为的人，那么首先，你要学会忍耐，坚持，是一个足以让人发疯的忍耐，一定要坚持，不然所有的努力都是笑话，在成为你想成为的人之前，需要舍弃很多东西，你必须足够理智，你必须谨小慎微，不然所有的努力还是成为笑话；但是，哪怕你所有的事儿都做了，你也只是有可能成功，毕竟，命运这事儿，谁有说的准呢？\n","source":"_posts/我是一个最不会写标题的人.md","raw":"---\ntitle: 我是一个最不会写标题的人\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: i-was-bad-boy\nid: 10007\ndate: 2014-03-27 10:34:54\n---\n\n\n之前一直我以为自己是在纠结到底哪里适合写IT学习的博文，新浪、网易亦或腾讯，折腾了许久，其实自己明白，不是在哪里写的问题，根本在于自己能否坚持下来，我本身是一个不怎么能耐下来性子的人，学习Linux、C还要考学历，总是做做这个，做做那个，没能认真研究，所以这么久时间还是停留在一个“初学者”的位置。\n\n2014年，这一年是一开始就让我悲痛到无以复加的一年，陷入迷茫让我不知道自己未来的路怎么走，能走多久，可是，我也清清楚楚地明白，我要努力改变，人生充满了太多的不可思议以及你无能为力的悲剧，今年已经过了近四个月份了，一直没能好好整理自己的心情，太沉溺过去的人是个弱者，人生会有很多我们无能为力的事，这让我们心生沮丧，可是不敢逃离还是面对，事情都已经发生在了过去，某一个时间点，是一个想起来都会让自己泪眼婆娑的时间点，我失去了一个生命中最最重要的人，往事只能回忆，也许到我将离去的时候，我才能够坦然面对人生旅途中走着走着就消失的人，我怀念，无时不刻。\n\n谈恋爱，是我这个年纪最容易被提及的问题，我一直排斥去谈恋爱，很多人不明白为什么会是这样；其实，是因为害怕失去，所以不敢拥有，有过一段失败的经历，让我不敢再次尝试，因为我没有把握，也没有勇气，小心翼翼；我总是夸夸其谈着别人的经历，却对自己不敢触及，我所说的努力让自己变得更好，才配得上爱我的人，只是害怕因为自己不够好，致使爱我的人离我而去，不是不相信另一半，是不相信自己，这个现实到令人发指的社会，我不能自私的以为爱情可以战胜一切，这种人也许别人会感到可怜，但最终会被人鄙夷，好姑娘都应该有一个好的归宿，在我没有能力肩负起爱情的责任时，抱歉，我不能说“爱”。其实，我缺少的，钱只是一小部分，更多的是缺少的是一颗勇敢的心，不够成熟的自己，当我不能够做好自己时，如何能够不负责任地肆意冲进别人的生活，伤害了别人，也羞辱了自己。\n\n生理年龄不代表心里年龄，明白自己想做什么，就应该努力去做，尽管我这么大了，这里也是一个开始，命运之轮是不可琢磨的，任何事在该发生的时候就会发生，早一点，晚一点，都是悲剧，如果我错过了一个深爱的姑娘，那么对不起，我想是我的修炼不够；生活在别处，我在这里，安静地学习，成长，成熟，对现实的忍耐，对未来的憧憬，不惊奇也不平淡，命运之轮不会偏移一丝一毫，我想做的只是让自己蜕变，尽量去做我想做的自己。\n\n近期一直在看《德川家康》，还没看完，深刻感受到，在大势中人的渺小与乏力，如果想要成为你想要成为的人，那么首先，你要学会忍耐，坚持，是一个足以让人发疯的忍耐，一定要坚持，不然所有的努力都是笑话，在成为你想成为的人之前，需要舍弃很多东西，你必须足够理智，你必须谨小慎微，不然所有的努力还是成为笑话；但是，哪怕你所有的事儿都做了，你也只是有可能成功，毕竟，命运这事儿，谁有说的准呢？\n","slug":"i-was-bad-boy","published":1,"updated":"2017-04-24T14:32:22.571Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqe0008441tp53u7jcri","content":"<p>之前一直我以为自己是在纠结到底哪里适合写IT学习的博文，新浪、网易亦或腾讯，折腾了许久，其实自己明白，不是在哪里写的问题，根本在于自己能否坚持下来，我本身是一个不怎么能耐下来性子的人，学习Linux、C还要考学历，总是做做这个，做做那个，没能认真研究，所以这么久时间还是停留在一个“初学者”的位置。</p>\n<p>2014年，这一年是一开始就让我悲痛到无以复加的一年，陷入迷茫让我不知道自己未来的路怎么走，能走多久，可是，我也清清楚楚地明白，我要努力改变，人生充满了太多的不可思议以及你无能为力的悲剧，今年已经过了近四个月份了，一直没能好好整理自己的心情，太沉溺过去的人是个弱者，人生会有很多我们无能为力的事，这让我们心生沮丧，可是不敢逃离还是面对，事情都已经发生在了过去，某一个时间点，是一个想起来都会让自己泪眼婆娑的时间点，我失去了一个生命中最最重要的人，往事只能回忆，也许到我将离去的时候，我才能够坦然面对人生旅途中走着走着就消失的人，我怀念，无时不刻。</p>\n<p>谈恋爱，是我这个年纪最容易被提及的问题，我一直排斥去谈恋爱，很多人不明白为什么会是这样；其实，是因为害怕失去，所以不敢拥有，有过一段失败的经历，让我不敢再次尝试，因为我没有把握，也没有勇气，小心翼翼；我总是夸夸其谈着别人的经历，却对自己不敢触及，我所说的努力让自己变得更好，才配得上爱我的人，只是害怕因为自己不够好，致使爱我的人离我而去，不是不相信另一半，是不相信自己，这个现实到令人发指的社会，我不能自私的以为爱情可以战胜一切，这种人也许别人会感到可怜，但最终会被人鄙夷，好姑娘都应该有一个好的归宿，在我没有能力肩负起爱情的责任时，抱歉，我不能说“爱”。其实，我缺少的，钱只是一小部分，更多的是缺少的是一颗勇敢的心，不够成熟的自己，当我不能够做好自己时，如何能够不负责任地肆意冲进别人的生活，伤害了别人，也羞辱了自己。</p>\n<p>生理年龄不代表心里年龄，明白自己想做什么，就应该努力去做，尽管我这么大了，这里也是一个开始，命运之轮是不可琢磨的，任何事在该发生的时候就会发生，早一点，晚一点，都是悲剧，如果我错过了一个深爱的姑娘，那么对不起，我想是我的修炼不够；生活在别处，我在这里，安静地学习，成长，成熟，对现实的忍耐，对未来的憧憬，不惊奇也不平淡，命运之轮不会偏移一丝一毫，我想做的只是让自己蜕变，尽量去做我想做的自己。</p>\n<p>近期一直在看《德川家康》，还没看完，深刻感受到，在大势中人的渺小与乏力，如果想要成为你想要成为的人，那么首先，你要学会忍耐，坚持，是一个足以让人发疯的忍耐，一定要坚持，不然所有的努力都是笑话，在成为你想成为的人之前，需要舍弃很多东西，你必须足够理智，你必须谨小慎微，不然所有的努力还是成为笑话；但是，哪怕你所有的事儿都做了，你也只是有可能成功，毕竟，命运这事儿，谁有说的准呢？</p>\n","site":{"data":{}},"excerpt":"","more":"<p>之前一直我以为自己是在纠结到底哪里适合写IT学习的博文，新浪、网易亦或腾讯，折腾了许久，其实自己明白，不是在哪里写的问题，根本在于自己能否坚持下来，我本身是一个不怎么能耐下来性子的人，学习Linux、C还要考学历，总是做做这个，做做那个，没能认真研究，所以这么久时间还是停留在一个“初学者”的位置。</p>\n<p>2014年，这一年是一开始就让我悲痛到无以复加的一年，陷入迷茫让我不知道自己未来的路怎么走，能走多久，可是，我也清清楚楚地明白，我要努力改变，人生充满了太多的不可思议以及你无能为力的悲剧，今年已经过了近四个月份了，一直没能好好整理自己的心情，太沉溺过去的人是个弱者，人生会有很多我们无能为力的事，这让我们心生沮丧，可是不敢逃离还是面对，事情都已经发生在了过去，某一个时间点，是一个想起来都会让自己泪眼婆娑的时间点，我失去了一个生命中最最重要的人，往事只能回忆，也许到我将离去的时候，我才能够坦然面对人生旅途中走着走着就消失的人，我怀念，无时不刻。</p>\n<p>谈恋爱，是我这个年纪最容易被提及的问题，我一直排斥去谈恋爱，很多人不明白为什么会是这样；其实，是因为害怕失去，所以不敢拥有，有过一段失败的经历，让我不敢再次尝试，因为我没有把握，也没有勇气，小心翼翼；我总是夸夸其谈着别人的经历，却对自己不敢触及，我所说的努力让自己变得更好，才配得上爱我的人，只是害怕因为自己不够好，致使爱我的人离我而去，不是不相信另一半，是不相信自己，这个现实到令人发指的社会，我不能自私的以为爱情可以战胜一切，这种人也许别人会感到可怜，但最终会被人鄙夷，好姑娘都应该有一个好的归宿，在我没有能力肩负起爱情的责任时，抱歉，我不能说“爱”。其实，我缺少的，钱只是一小部分，更多的是缺少的是一颗勇敢的心，不够成熟的自己，当我不能够做好自己时，如何能够不负责任地肆意冲进别人的生活，伤害了别人，也羞辱了自己。</p>\n<p>生理年龄不代表心里年龄，明白自己想做什么，就应该努力去做，尽管我这么大了，这里也是一个开始，命运之轮是不可琢磨的，任何事在该发生的时候就会发生，早一点，晚一点，都是悲剧，如果我错过了一个深爱的姑娘，那么对不起，我想是我的修炼不够；生活在别处，我在这里，安静地学习，成长，成熟，对现实的忍耐，对未来的憧憬，不惊奇也不平淡，命运之轮不会偏移一丝一毫，我想做的只是让自己蜕变，尽量去做我想做的自己。</p>\n<p>近期一直在看《德川家康》，还没看完，深刻感受到，在大势中人的渺小与乏力，如果想要成为你想要成为的人，那么首先，你要学会忍耐，坚持，是一个足以让人发疯的忍耐，一定要坚持，不然所有的努力都是笑话，在成为你想成为的人之前，需要舍弃很多东西，你必须足够理智，你必须谨小慎微，不然所有的努力还是成为笑话；但是，哪怕你所有的事儿都做了，你也只是有可能成功，毕竟，命运这事儿，谁有说的准呢？</p>\n"},{"title":"我的2017","id":"10009","date":"2017-01-01T16:34:54.000Z","_content":"\n\n 人们常说，男人有了爱情，就像有了肋骨和铠甲，无比坚强同时也无比柔软，无比坚强是面对这个世界的风风雨雨，为了自己要守护的人，无比柔软是面对自己深爱的人，这整个世界的美好都因有她而绽放；夏怀香，感谢生命让我遇见你；或许你有担心，或许你有顾虑，这些我知道，我全都知道，我想说：无论前路多么迷惘曲折，我都愿意陪着你；我爱你，就像我说的那样，我要努力挣钱养你和喵大人，我不是轻易许诺的人，因为我知道做人说话要懂得责任，可是我说了，从最开始，从内心最深处，我说了，因为，我爱你，我想给你一个家；我希望我的未来有你！\n\n 上海买房挺不容易的，我知道，但是这不是能不能的问题，而是一定要做的事，就像吃饭睡觉，这对于我来说是一定要做的事情，因为不能让我爱的人陪我颠沛流离，这或许跟我小时候的成长环境有关；其实我很害怕，我怕来不及，就像那句歌词：爱上一匹野马，可我家里没有草原；所以，我真的要努力去做，而不只是说，我讨厌只说不做，我讨厌做不到的自己，所以啊，要拼了命去努力。我一直觉得自己不够优秀，尤其是遇到自己喜欢的人，相形见绌大概就这个意思吧，所以我要努力让自己配得上你，对于已经过去的2016年，我做的挺好，但是不够满意；而2017年，我要让自己更加进步。\n\n 下面是我的2017年要做的事：\n\n 读书，每月读一本书，题材自选，每月只读一本；读书不是一件坏事，我是喜欢读书的，但是有时候读书会耽误本有的计划，所以要限制读书的时间。\n\n 博客，每月2篇技术文章；我一直都有写博客文章的习惯，一年在博客上花费大概700元(服务器+域名+流量)，但是我发现的问题是自己在技术方面的文章比较乱，不成体系，只是当成了笔记记录的东西；2017年，我要更专业和深入研究一些技术，所以文章应该更加注重质量。\n\n 减肥，目标75KG；减肥对我来说应该是个世纪难题了，但是我打算要在2017年克服它(好像16年初我也说过同样的话)，运动和饮食这些是需要认真注意的地方，希望2017年结束之时可以做到(听起来好没信心啊)。\n\n 成熟，这是一个相对的问题；之所以定这个目标，是为了让自己用更加合适的方式的去处理生活中遇到事情；但是成熟不代表妥协；另外一个原因是，我希望给你安全感，要踏实努力，还要稳重。\n\n 单反相机，记录我们的故事；这个应该是最容易最快达成的任务了哈哈，我要记录所有你的美丽，留到今后的岁月里，一起回想昨日时间，而你的美丽未成改变；当然请允许我前期的拍照技巧，我会抓紧练习滴，你以后只允许是我的御用“猫豆”哦。\n\n 建湖话，这是要准备见家长啦；夏同学，这个你要辛苦了啊，这次南京见到姐姐，真心听不懂你们说的；倘若不能好好学习建湖话，以后怎么见家长啊，这是一个很严重的问题(严肃脸)，我们必须严阵以待，夏同学，你的责任很大哦。\n\n 烧饭，不能饿着宝宝啊；烧饭给自己心爱的人吃，不需要理由。\n\n 工作，组建Python开发团队，业务Docker化，运维专业化，微企独立完成大数据项目能力；嘿嘿，从这里你就看不懂啦，我在微企工作这一年多挺开心的，才不是因为有你的呢，/左哼哼！不得不承认我是一个工作狂，我一直不认为自己是一个聪明优秀的人，所以要更加努力才能做得好，但是我也有时间陪你哦(认真脸)；同时作为一个小团队的领导，要合理的安排员工的工作和成长计划，这样才可以让别人觉得跟着你干有奔头，这些能力我还是要锻炼的，毕竟我以后是要做大事的人(拽拽脸)！\n\n 好了，以上是我2017年的规划， 本来已经上床打算睡觉了，可是睡不着，觉得还是要写；我想写好了给你看，但是我在犹豫，因为我是在以一个男朋友的身份写这个东西，但是如果你并没有这个意思，只是当我是好朋友，我就会很囧啊，见你面都会不好意思的，但是如果真的是我误会了，也请你告诉我，我还是会老老实实的做好朋友，现在凌晨1点钟了，我觉得我要鼓起勇气给你看，请原谅我打扰到你睡觉了哦。\n\n 关于买房子，讲些实际的，我的家庭是一个普普通通的家庭，在阜阳市里买的房子还是我和他们一起攒钱的，所以经济上没法太多支撑我，在上海买房子要靠我自己，所以可能17年还买不了房子，我计划在18年可以买房子。\n\n 毛主席说过：不以结婚为目的的恋爱都是耍流氓，我是斯文人，所以不耍流氓。\n\n 我的2017年计划总结下来就是四个字：攒钱，养你。\n","source":"_posts/我的2017.md","raw":"---\ntitle: 我的2017\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: new-year-2017\nid: 10009\ndate: 2017-01-02 00:34:54\n---\n\n\n 人们常说，男人有了爱情，就像有了肋骨和铠甲，无比坚强同时也无比柔软，无比坚强是面对这个世界的风风雨雨，为了自己要守护的人，无比柔软是面对自己深爱的人，这整个世界的美好都因有她而绽放；夏怀香，感谢生命让我遇见你；或许你有担心，或许你有顾虑，这些我知道，我全都知道，我想说：无论前路多么迷惘曲折，我都愿意陪着你；我爱你，就像我说的那样，我要努力挣钱养你和喵大人，我不是轻易许诺的人，因为我知道做人说话要懂得责任，可是我说了，从最开始，从内心最深处，我说了，因为，我爱你，我想给你一个家；我希望我的未来有你！\n\n 上海买房挺不容易的，我知道，但是这不是能不能的问题，而是一定要做的事，就像吃饭睡觉，这对于我来说是一定要做的事情，因为不能让我爱的人陪我颠沛流离，这或许跟我小时候的成长环境有关；其实我很害怕，我怕来不及，就像那句歌词：爱上一匹野马，可我家里没有草原；所以，我真的要努力去做，而不只是说，我讨厌只说不做，我讨厌做不到的自己，所以啊，要拼了命去努力。我一直觉得自己不够优秀，尤其是遇到自己喜欢的人，相形见绌大概就这个意思吧，所以我要努力让自己配得上你，对于已经过去的2016年，我做的挺好，但是不够满意；而2017年，我要让自己更加进步。\n\n 下面是我的2017年要做的事：\n\n 读书，每月读一本书，题材自选，每月只读一本；读书不是一件坏事，我是喜欢读书的，但是有时候读书会耽误本有的计划，所以要限制读书的时间。\n\n 博客，每月2篇技术文章；我一直都有写博客文章的习惯，一年在博客上花费大概700元(服务器+域名+流量)，但是我发现的问题是自己在技术方面的文章比较乱，不成体系，只是当成了笔记记录的东西；2017年，我要更专业和深入研究一些技术，所以文章应该更加注重质量。\n\n 减肥，目标75KG；减肥对我来说应该是个世纪难题了，但是我打算要在2017年克服它(好像16年初我也说过同样的话)，运动和饮食这些是需要认真注意的地方，希望2017年结束之时可以做到(听起来好没信心啊)。\n\n 成熟，这是一个相对的问题；之所以定这个目标，是为了让自己用更加合适的方式的去处理生活中遇到事情；但是成熟不代表妥协；另外一个原因是，我希望给你安全感，要踏实努力，还要稳重。\n\n 单反相机，记录我们的故事；这个应该是最容易最快达成的任务了哈哈，我要记录所有你的美丽，留到今后的岁月里，一起回想昨日时间，而你的美丽未成改变；当然请允许我前期的拍照技巧，我会抓紧练习滴，你以后只允许是我的御用“猫豆”哦。\n\n 建湖话，这是要准备见家长啦；夏同学，这个你要辛苦了啊，这次南京见到姐姐，真心听不懂你们说的；倘若不能好好学习建湖话，以后怎么见家长啊，这是一个很严重的问题(严肃脸)，我们必须严阵以待，夏同学，你的责任很大哦。\n\n 烧饭，不能饿着宝宝啊；烧饭给自己心爱的人吃，不需要理由。\n\n 工作，组建Python开发团队，业务Docker化，运维专业化，微企独立完成大数据项目能力；嘿嘿，从这里你就看不懂啦，我在微企工作这一年多挺开心的，才不是因为有你的呢，/左哼哼！不得不承认我是一个工作狂，我一直不认为自己是一个聪明优秀的人，所以要更加努力才能做得好，但是我也有时间陪你哦(认真脸)；同时作为一个小团队的领导，要合理的安排员工的工作和成长计划，这样才可以让别人觉得跟着你干有奔头，这些能力我还是要锻炼的，毕竟我以后是要做大事的人(拽拽脸)！\n\n 好了，以上是我2017年的规划， 本来已经上床打算睡觉了，可是睡不着，觉得还是要写；我想写好了给你看，但是我在犹豫，因为我是在以一个男朋友的身份写这个东西，但是如果你并没有这个意思，只是当我是好朋友，我就会很囧啊，见你面都会不好意思的，但是如果真的是我误会了，也请你告诉我，我还是会老老实实的做好朋友，现在凌晨1点钟了，我觉得我要鼓起勇气给你看，请原谅我打扰到你睡觉了哦。\n\n 关于买房子，讲些实际的，我的家庭是一个普普通通的家庭，在阜阳市里买的房子还是我和他们一起攒钱的，所以经济上没法太多支撑我，在上海买房子要靠我自己，所以可能17年还买不了房子，我计划在18年可以买房子。\n\n 毛主席说过：不以结婚为目的的恋爱都是耍流氓，我是斯文人，所以不耍流氓。\n\n 我的2017年计划总结下来就是四个字：攒钱，养你。\n","slug":"new-year-2017","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqea008741tpqmd30jsf","content":"<p> 人们常说，男人有了爱情，就像有了肋骨和铠甲，无比坚强同时也无比柔软，无比坚强是面对这个世界的风风雨雨，为了自己要守护的人，无比柔软是面对自己深爱的人，这整个世界的美好都因有她而绽放；夏怀香，感谢生命让我遇见你；或许你有担心，或许你有顾虑，这些我知道，我全都知道，我想说：无论前路多么迷惘曲折，我都愿意陪着你；我爱你，就像我说的那样，我要努力挣钱养你和喵大人，我不是轻易许诺的人，因为我知道做人说话要懂得责任，可是我说了，从最开始，从内心最深处，我说了，因为，我爱你，我想给你一个家；我希望我的未来有你！</p>\n<p> 上海买房挺不容易的，我知道，但是这不是能不能的问题，而是一定要做的事，就像吃饭睡觉，这对于我来说是一定要做的事情，因为不能让我爱的人陪我颠沛流离，这或许跟我小时候的成长环境有关；其实我很害怕，我怕来不及，就像那句歌词：爱上一匹野马，可我家里没有草原；所以，我真的要努力去做，而不只是说，我讨厌只说不做，我讨厌做不到的自己，所以啊，要拼了命去努力。我一直觉得自己不够优秀，尤其是遇到自己喜欢的人，相形见绌大概就这个意思吧，所以我要努力让自己配得上你，对于已经过去的2016年，我做的挺好，但是不够满意；而2017年，我要让自己更加进步。</p>\n<p> 下面是我的2017年要做的事：</p>\n<p> 读书，每月读一本书，题材自选，每月只读一本；读书不是一件坏事，我是喜欢读书的，但是有时候读书会耽误本有的计划，所以要限制读书的时间。</p>\n<p> 博客，每月2篇技术文章；我一直都有写博客文章的习惯，一年在博客上花费大概700元(服务器+域名+流量)，但是我发现的问题是自己在技术方面的文章比较乱，不成体系，只是当成了笔记记录的东西；2017年，我要更专业和深入研究一些技术，所以文章应该更加注重质量。</p>\n<p> 减肥，目标75KG；减肥对我来说应该是个世纪难题了，但是我打算要在2017年克服它(好像16年初我也说过同样的话)，运动和饮食这些是需要认真注意的地方，希望2017年结束之时可以做到(听起来好没信心啊)。</p>\n<p> 成熟，这是一个相对的问题；之所以定这个目标，是为了让自己用更加合适的方式的去处理生活中遇到事情；但是成熟不代表妥协；另外一个原因是，我希望给你安全感，要踏实努力，还要稳重。</p>\n<p> 单反相机，记录我们的故事；这个应该是最容易最快达成的任务了哈哈，我要记录所有你的美丽，留到今后的岁月里，一起回想昨日时间，而你的美丽未成改变；当然请允许我前期的拍照技巧，我会抓紧练习滴，你以后只允许是我的御用“猫豆”哦。</p>\n<p> 建湖话，这是要准备见家长啦；夏同学，这个你要辛苦了啊，这次南京见到姐姐，真心听不懂你们说的；倘若不能好好学习建湖话，以后怎么见家长啊，这是一个很严重的问题(严肃脸)，我们必须严阵以待，夏同学，你的责任很大哦。</p>\n<p> 烧饭，不能饿着宝宝啊；烧饭给自己心爱的人吃，不需要理由。</p>\n<p> 工作，组建Python开发团队，业务Docker化，运维专业化，微企独立完成大数据项目能力；嘿嘿，从这里你就看不懂啦，我在微企工作这一年多挺开心的，才不是因为有你的呢，/左哼哼！不得不承认我是一个工作狂，我一直不认为自己是一个聪明优秀的人，所以要更加努力才能做得好，但是我也有时间陪你哦(认真脸)；同时作为一个小团队的领导，要合理的安排员工的工作和成长计划，这样才可以让别人觉得跟着你干有奔头，这些能力我还是要锻炼的，毕竟我以后是要做大事的人(拽拽脸)！</p>\n<p> 好了，以上是我2017年的规划， 本来已经上床打算睡觉了，可是睡不着，觉得还是要写；我想写好了给你看，但是我在犹豫，因为我是在以一个男朋友的身份写这个东西，但是如果你并没有这个意思，只是当我是好朋友，我就会很囧啊，见你面都会不好意思的，但是如果真的是我误会了，也请你告诉我，我还是会老老实实的做好朋友，现在凌晨1点钟了，我觉得我要鼓起勇气给你看，请原谅我打扰到你睡觉了哦。</p>\n<p> 关于买房子，讲些实际的，我的家庭是一个普普通通的家庭，在阜阳市里买的房子还是我和他们一起攒钱的，所以经济上没法太多支撑我，在上海买房子要靠我自己，所以可能17年还买不了房子，我计划在18年可以买房子。</p>\n<p> 毛主席说过：不以结婚为目的的恋爱都是耍流氓，我是斯文人，所以不耍流氓。</p>\n<p> 我的2017年计划总结下来就是四个字：攒钱，养你。</p>\n","site":{"data":{}},"excerpt":"","more":"<p> 人们常说，男人有了爱情，就像有了肋骨和铠甲，无比坚强同时也无比柔软，无比坚强是面对这个世界的风风雨雨，为了自己要守护的人，无比柔软是面对自己深爱的人，这整个世界的美好都因有她而绽放；夏怀香，感谢生命让我遇见你；或许你有担心，或许你有顾虑，这些我知道，我全都知道，我想说：无论前路多么迷惘曲折，我都愿意陪着你；我爱你，就像我说的那样，我要努力挣钱养你和喵大人，我不是轻易许诺的人，因为我知道做人说话要懂得责任，可是我说了，从最开始，从内心最深处，我说了，因为，我爱你，我想给你一个家；我希望我的未来有你！</p>\n<p> 上海买房挺不容易的，我知道，但是这不是能不能的问题，而是一定要做的事，就像吃饭睡觉，这对于我来说是一定要做的事情，因为不能让我爱的人陪我颠沛流离，这或许跟我小时候的成长环境有关；其实我很害怕，我怕来不及，就像那句歌词：爱上一匹野马，可我家里没有草原；所以，我真的要努力去做，而不只是说，我讨厌只说不做，我讨厌做不到的自己，所以啊，要拼了命去努力。我一直觉得自己不够优秀，尤其是遇到自己喜欢的人，相形见绌大概就这个意思吧，所以我要努力让自己配得上你，对于已经过去的2016年，我做的挺好，但是不够满意；而2017年，我要让自己更加进步。</p>\n<p> 下面是我的2017年要做的事：</p>\n<p> 读书，每月读一本书，题材自选，每月只读一本；读书不是一件坏事，我是喜欢读书的，但是有时候读书会耽误本有的计划，所以要限制读书的时间。</p>\n<p> 博客，每月2篇技术文章；我一直都有写博客文章的习惯，一年在博客上花费大概700元(服务器+域名+流量)，但是我发现的问题是自己在技术方面的文章比较乱，不成体系，只是当成了笔记记录的东西；2017年，我要更专业和深入研究一些技术，所以文章应该更加注重质量。</p>\n<p> 减肥，目标75KG；减肥对我来说应该是个世纪难题了，但是我打算要在2017年克服它(好像16年初我也说过同样的话)，运动和饮食这些是需要认真注意的地方，希望2017年结束之时可以做到(听起来好没信心啊)。</p>\n<p> 成熟，这是一个相对的问题；之所以定这个目标，是为了让自己用更加合适的方式的去处理生活中遇到事情；但是成熟不代表妥协；另外一个原因是，我希望给你安全感，要踏实努力，还要稳重。</p>\n<p> 单反相机，记录我们的故事；这个应该是最容易最快达成的任务了哈哈，我要记录所有你的美丽，留到今后的岁月里，一起回想昨日时间，而你的美丽未成改变；当然请允许我前期的拍照技巧，我会抓紧练习滴，你以后只允许是我的御用“猫豆”哦。</p>\n<p> 建湖话，这是要准备见家长啦；夏同学，这个你要辛苦了啊，这次南京见到姐姐，真心听不懂你们说的；倘若不能好好学习建湖话，以后怎么见家长啊，这是一个很严重的问题(严肃脸)，我们必须严阵以待，夏同学，你的责任很大哦。</p>\n<p> 烧饭，不能饿着宝宝啊；烧饭给自己心爱的人吃，不需要理由。</p>\n<p> 工作，组建Python开发团队，业务Docker化，运维专业化，微企独立完成大数据项目能力；嘿嘿，从这里你就看不懂啦，我在微企工作这一年多挺开心的，才不是因为有你的呢，/左哼哼！不得不承认我是一个工作狂，我一直不认为自己是一个聪明优秀的人，所以要更加努力才能做得好，但是我也有时间陪你哦(认真脸)；同时作为一个小团队的领导，要合理的安排员工的工作和成长计划，这样才可以让别人觉得跟着你干有奔头，这些能力我还是要锻炼的，毕竟我以后是要做大事的人(拽拽脸)！</p>\n<p> 好了，以上是我2017年的规划， 本来已经上床打算睡觉了，可是睡不着，觉得还是要写；我想写好了给你看，但是我在犹豫，因为我是在以一个男朋友的身份写这个东西，但是如果你并没有这个意思，只是当我是好朋友，我就会很囧啊，见你面都会不好意思的，但是如果真的是我误会了，也请你告诉我，我还是会老老实实的做好朋友，现在凌晨1点钟了，我觉得我要鼓起勇气给你看，请原谅我打扰到你睡觉了哦。</p>\n<p> 关于买房子，讲些实际的，我的家庭是一个普普通通的家庭，在阜阳市里买的房子还是我和他们一起攒钱的，所以经济上没法太多支撑我，在上海买房子要靠我自己，所以可能17年还买不了房子，我计划在18年可以买房子。</p>\n<p> 毛主席说过：不以结婚为目的的恋爱都是耍流氓，我是斯文人，所以不耍流氓。</p>\n<p> 我的2017年计划总结下来就是四个字：攒钱，养你。</p>\n"},{"title":"我的约会日记","id":"10008","date":"2015-05-18T02:34:54.000Z","_content":"\n\n我希望可以记录每一件与你做过事，每一个特定的时间，每一个特定的回忆。\n\n- 夏怀香，你就是我的彩虹姑娘\n- 你的生日是每年的农历九月初三\n- 我不喜欢你喝酒\n- 我准备了好多电影，我喜欢看，我喜欢和你一起看\n\n------\n\n- 2015年05月18日，我来到微企，很高兴见到你。\n- 2015年10月29日，公司泰国旅游，那一次，我觉得我想和这个姑娘发生一段故事。\n- 2016年03月12日，第一次约会，逛了上海杜莎夫人蜡像馆，然后看电影《疯狂动物城》。\n- 2016年04月10日，讨论学习计划安排的事情，上海图书馆，一起吃晚饭，你很难过，喝了酒，送你回家，买了只猫咪。我也好难过。\n\n> 我搞不清楚原因，突然我们就不说话了，很长很长时间。\n\n- 2016年09月14日，你又出现在我的生活里了，真好，感谢虾米音乐。\n- 2016年10月02日，你的心情不好，我们聊了很长时间，我在阜阳，你在建湖，我多想飞奔到你身边。\n- **2016年10月03日，你的生日，希望今后你的每一个生日，我都陪你度过，农历九月初三。**\n- 2016年10月03日，你说：我们的生命中都逃脱不了无休止的告别，我说：人生就像一辆列车，中途会有很多人下车，很难有人能自始至终陪你走完，所以，当陪你的人要下车时，即使不舍也该心存感激，然后挥手道别。\n- 2016年10月05日，你说你要去黄山玩的时候叫我当导游，我在上海，你在建湖，我们准备要回上海了；所以，记得叫上我。\n- 2016年11月07日，你很难过，我说我喜欢的女孩一定是很自信很厉害，不会因为一个男生就失魂落魄，你说，明天以后我会好好的，谢谢你陪我，嗯，我希望在你所有不开心的时候都陪着你。\n- 2016年11月07日，我想：弄不明白，为啥在我这宝贝的不行的姑娘，到了别人那儿就啥也不是了呢！\n- 2016年11月16日，你问周末有没有空，一起去接你的小伙伴，你说，把自己整的柔和亲切点，不要有胡子\n- 2016年11月19日，你说，明天不用我去了，你自己安排了，我说好，然后挂了电话，放学的路上一点都不亲切。\n- 2016年12月04里，算第二次正式的约会吧，我们一起看了电影《你的名字》，电影没你好看；想从新认识你，从你叫什么名字开始。\n- 2014年12月24日，平安夜，我最好的平安夜了，因为我们约定元旦去南京玩。\n- 2016年12月30日，第一次约会旅行，南京，你说以后有机会一起去无锡玩，你在那里读的大学，好希望机会可以早点到。\n- 2016年12月31日，距离新的一年只剩几秒了，我躺在你隔壁的房间，我的新年愿望是，成为你的男朋友。\n- 2017年01月02日，我写下了我的2017。\n- 2017年01月05日，我给你看了我的新年计划，你说：从朋友变成男朋友需要一个过程，而这个过程不是让我看到你对我多好，而是让我看到你的好，欣赏你的好，你现在无法给我回应；我说：我等你，我想成为你的避风港，我很晚才睡，写了《有一天，你终会遇到一个彩虹般的姑娘》，你就是我彩虹。\n- 2017年01月14日，我们一起两位喵大人打针，有一针没打好，看着你好心疼，我也很心疼，亲爱的，你真是善良的姑娘；晚上我们一起去看了话剧《火山灰》，挺好的，这是第一次，我们约好以后还要一起看，真好。\n- 2017年01月15日，昨晚我在宾馆睡了一夜，中午吃到了你第一次做给我的午餐，你说喜欢吃泡椒鸡爪，嗯，以后做给你吃；最后和你在一块的时间总是短暂而又幸福。\n- 2017年01月25日，一起到姑姑家寄养猫咪，然后在耶里夏丽吃饭，中间表演时你上台跳舞，你说那是你第一次跳舞，我拍下来了，嗯，动作的确很尴尬啊，哈哈。\n- 2017年01月31日，我听到大猫咪跑掉了，整个人都慌了神，还好最后找到了。\n\n> 今年的春节过得糟糕透了，从一开始就没处理好，原定的计划没能进行，但是上班就要调整好心态，努力工作。\n\n- 2017年02月15日，今天一起吃了左庭右院，西方情人节的后一天，感觉就像，还差一点，第一次情人送你口红，你说不要乱花钱，嗯，我会节约啊，但总归是过节嘛，以后尽量动手做东西给你，中山公园是个好地方，有2号线，有3号线，适合约会。\n- 2017年02月21日，早上听说你昨晚崴了脚，地铁站都没人扶你，好心疼，怨自己离你太远，多想一直给你呵护，永远不要受伤，陪你去看医生，可是去的太晚，耽搁了到医院的时间，幸无大碍，下午回来逛了家乐福和迪卡侬，脚痛还活蹦乱跳像个小孩子，看着是又心疼又喜欢，希望你快快好起来。\n- 2017年03月03日，不知道怎么脑抽约了大晚上一起去看金刚狼3，搞得香香都没休息好，而且电影放映的时候也有点问题，以后再也不做这么傻逼的事情了，我那么喜欢的姑娘，怎么犯傻让她跟我一起在外吹冷风，昨晚还是睡宾馆，上午帮着一起打扫了家里的卫生，两位喵大人还是不给面子，但是比之前好多了；记下香香喜欢吃的东西，以后要记得做。\n- 2017年03月30日，听了一首很好听的歌曲，想分享给你：春风十里，春风十里，桃花灼灼，不如你。\n- 2017年04月02日，好久没见到你了，整整一个星期又4天，最终还是没忍住，冒着把感冒传染给你的风险去找你，今天我们一起骑车走新开发的路线到你的新单位，然后在附近新开的商业区，吃你要吃的“重口味”，哈哈，然后抱怨我点多了，然后一起看了电影，一直在说悄悄话，真幸运邻座的同胞们没起身打死我们嘿嘿，我们一路见到了各种饱受摧残的OFO单车，晚上，第二次吃到你的大餐，喜欢看你，远远躲着油锅的样子，当时我就想，以后烧饭的事情还是交给我来吧，这么可爱的姑娘，我才舍不得让她辛苦呢，感觉你的年龄一点点在变小，我对我们的未来就越有信心，你笑的样子越来越开心，我就越来无法自拔的喜欢你，我们要一起租一个朝南的房子，让阳光可以直接晒到你睡懒觉的屁股上，我每天醒来都能看到你，还有一直捣乱的米饭饭团，我们幸福的生活在一起。香香，我爱你。\n- 2017年04月21日，我们第一次吵架，我现在真的糟糕透了，对不起，我会尽快调整好自己。\n","source":"_posts/我的约会日记.md","raw":"---\ntitle: 我的约会日记\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: with-my-girl\nid: 10008\ndate: 2015-05-18 10:34:54\n---\n\n\n我希望可以记录每一件与你做过事，每一个特定的时间，每一个特定的回忆。\n\n- 夏怀香，你就是我的彩虹姑娘\n- 你的生日是每年的农历九月初三\n- 我不喜欢你喝酒\n- 我准备了好多电影，我喜欢看，我喜欢和你一起看\n\n------\n\n- 2015年05月18日，我来到微企，很高兴见到你。\n- 2015年10月29日，公司泰国旅游，那一次，我觉得我想和这个姑娘发生一段故事。\n- 2016年03月12日，第一次约会，逛了上海杜莎夫人蜡像馆，然后看电影《疯狂动物城》。\n- 2016年04月10日，讨论学习计划安排的事情，上海图书馆，一起吃晚饭，你很难过，喝了酒，送你回家，买了只猫咪。我也好难过。\n\n> 我搞不清楚原因，突然我们就不说话了，很长很长时间。\n\n- 2016年09月14日，你又出现在我的生活里了，真好，感谢虾米音乐。\n- 2016年10月02日，你的心情不好，我们聊了很长时间，我在阜阳，你在建湖，我多想飞奔到你身边。\n- **2016年10月03日，你的生日，希望今后你的每一个生日，我都陪你度过，农历九月初三。**\n- 2016年10月03日，你说：我们的生命中都逃脱不了无休止的告别，我说：人生就像一辆列车，中途会有很多人下车，很难有人能自始至终陪你走完，所以，当陪你的人要下车时，即使不舍也该心存感激，然后挥手道别。\n- 2016年10月05日，你说你要去黄山玩的时候叫我当导游，我在上海，你在建湖，我们准备要回上海了；所以，记得叫上我。\n- 2016年11月07日，你很难过，我说我喜欢的女孩一定是很自信很厉害，不会因为一个男生就失魂落魄，你说，明天以后我会好好的，谢谢你陪我，嗯，我希望在你所有不开心的时候都陪着你。\n- 2016年11月07日，我想：弄不明白，为啥在我这宝贝的不行的姑娘，到了别人那儿就啥也不是了呢！\n- 2016年11月16日，你问周末有没有空，一起去接你的小伙伴，你说，把自己整的柔和亲切点，不要有胡子\n- 2016年11月19日，你说，明天不用我去了，你自己安排了，我说好，然后挂了电话，放学的路上一点都不亲切。\n- 2016年12月04里，算第二次正式的约会吧，我们一起看了电影《你的名字》，电影没你好看；想从新认识你，从你叫什么名字开始。\n- 2014年12月24日，平安夜，我最好的平安夜了，因为我们约定元旦去南京玩。\n- 2016年12月30日，第一次约会旅行，南京，你说以后有机会一起去无锡玩，你在那里读的大学，好希望机会可以早点到。\n- 2016年12月31日，距离新的一年只剩几秒了，我躺在你隔壁的房间，我的新年愿望是，成为你的男朋友。\n- 2017年01月02日，我写下了我的2017。\n- 2017年01月05日，我给你看了我的新年计划，你说：从朋友变成男朋友需要一个过程，而这个过程不是让我看到你对我多好，而是让我看到你的好，欣赏你的好，你现在无法给我回应；我说：我等你，我想成为你的避风港，我很晚才睡，写了《有一天，你终会遇到一个彩虹般的姑娘》，你就是我彩虹。\n- 2017年01月14日，我们一起两位喵大人打针，有一针没打好，看着你好心疼，我也很心疼，亲爱的，你真是善良的姑娘；晚上我们一起去看了话剧《火山灰》，挺好的，这是第一次，我们约好以后还要一起看，真好。\n- 2017年01月15日，昨晚我在宾馆睡了一夜，中午吃到了你第一次做给我的午餐，你说喜欢吃泡椒鸡爪，嗯，以后做给你吃；最后和你在一块的时间总是短暂而又幸福。\n- 2017年01月25日，一起到姑姑家寄养猫咪，然后在耶里夏丽吃饭，中间表演时你上台跳舞，你说那是你第一次跳舞，我拍下来了，嗯，动作的确很尴尬啊，哈哈。\n- 2017年01月31日，我听到大猫咪跑掉了，整个人都慌了神，还好最后找到了。\n\n> 今年的春节过得糟糕透了，从一开始就没处理好，原定的计划没能进行，但是上班就要调整好心态，努力工作。\n\n- 2017年02月15日，今天一起吃了左庭右院，西方情人节的后一天，感觉就像，还差一点，第一次情人送你口红，你说不要乱花钱，嗯，我会节约啊，但总归是过节嘛，以后尽量动手做东西给你，中山公园是个好地方，有2号线，有3号线，适合约会。\n- 2017年02月21日，早上听说你昨晚崴了脚，地铁站都没人扶你，好心疼，怨自己离你太远，多想一直给你呵护，永远不要受伤，陪你去看医生，可是去的太晚，耽搁了到医院的时间，幸无大碍，下午回来逛了家乐福和迪卡侬，脚痛还活蹦乱跳像个小孩子，看着是又心疼又喜欢，希望你快快好起来。\n- 2017年03月03日，不知道怎么脑抽约了大晚上一起去看金刚狼3，搞得香香都没休息好，而且电影放映的时候也有点问题，以后再也不做这么傻逼的事情了，我那么喜欢的姑娘，怎么犯傻让她跟我一起在外吹冷风，昨晚还是睡宾馆，上午帮着一起打扫了家里的卫生，两位喵大人还是不给面子，但是比之前好多了；记下香香喜欢吃的东西，以后要记得做。\n- 2017年03月30日，听了一首很好听的歌曲，想分享给你：春风十里，春风十里，桃花灼灼，不如你。\n- 2017年04月02日，好久没见到你了，整整一个星期又4天，最终还是没忍住，冒着把感冒传染给你的风险去找你，今天我们一起骑车走新开发的路线到你的新单位，然后在附近新开的商业区，吃你要吃的“重口味”，哈哈，然后抱怨我点多了，然后一起看了电影，一直在说悄悄话，真幸运邻座的同胞们没起身打死我们嘿嘿，我们一路见到了各种饱受摧残的OFO单车，晚上，第二次吃到你的大餐，喜欢看你，远远躲着油锅的样子，当时我就想，以后烧饭的事情还是交给我来吧，这么可爱的姑娘，我才舍不得让她辛苦呢，感觉你的年龄一点点在变小，我对我们的未来就越有信心，你笑的样子越来越开心，我就越来无法自拔的喜欢你，我们要一起租一个朝南的房子，让阳光可以直接晒到你睡懒觉的屁股上，我每天醒来都能看到你，还有一直捣乱的米饭饭团，我们幸福的生活在一起。香香，我爱你。\n- 2017年04月21日，我们第一次吵架，我现在真的糟糕透了，对不起，我会尽快调整好自己。\n","slug":"with-my-girl","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqee008b41tp4fcpqz6h","content":"<p>我希望可以记录每一件与你做过事，每一个特定的时间，每一个特定的回忆。</p>\n<ul>\n<li>夏怀香，你就是我的彩虹姑娘</li>\n<li>你的生日是每年的农历九月初三</li>\n<li>我不喜欢你喝酒</li>\n<li>我准备了好多电影，我喜欢看，我喜欢和你一起看</li>\n</ul>\n<hr>\n<ul>\n<li>2015年05月18日，我来到微企，很高兴见到你。</li>\n<li>2015年10月29日，公司泰国旅游，那一次，我觉得我想和这个姑娘发生一段故事。</li>\n<li>2016年03月12日，第一次约会，逛了上海杜莎夫人蜡像馆，然后看电影《疯狂动物城》。</li>\n<li>2016年04月10日，讨论学习计划安排的事情，上海图书馆，一起吃晚饭，你很难过，喝了酒，送你回家，买了只猫咪。我也好难过。</li>\n</ul>\n<blockquote>\n<p>我搞不清楚原因，突然我们就不说话了，很长很长时间。</p>\n</blockquote>\n<ul>\n<li>2016年09月14日，你又出现在我的生活里了，真好，感谢虾米音乐。</li>\n<li>2016年10月02日，你的心情不好，我们聊了很长时间，我在阜阳，你在建湖，我多想飞奔到你身边。</li>\n<li><strong>2016年10月03日，你的生日，希望今后你的每一个生日，我都陪你度过，农历九月初三。</strong></li>\n<li>2016年10月03日，你说：我们的生命中都逃脱不了无休止的告别，我说：人生就像一辆列车，中途会有很多人下车，很难有人能自始至终陪你走完，所以，当陪你的人要下车时，即使不舍也该心存感激，然后挥手道别。</li>\n<li>2016年10月05日，你说你要去黄山玩的时候叫我当导游，我在上海，你在建湖，我们准备要回上海了；所以，记得叫上我。</li>\n<li>2016年11月07日，你很难过，我说我喜欢的女孩一定是很自信很厉害，不会因为一个男生就失魂落魄，你说，明天以后我会好好的，谢谢你陪我，嗯，我希望在你所有不开心的时候都陪着你。</li>\n<li>2016年11月07日，我想：弄不明白，为啥在我这宝贝的不行的姑娘，到了别人那儿就啥也不是了呢！</li>\n<li>2016年11月16日，你问周末有没有空，一起去接你的小伙伴，你说，把自己整的柔和亲切点，不要有胡子</li>\n<li>2016年11月19日，你说，明天不用我去了，你自己安排了，我说好，然后挂了电话，放学的路上一点都不亲切。</li>\n<li>2016年12月04里，算第二次正式的约会吧，我们一起看了电影《你的名字》，电影没你好看；想从新认识你，从你叫什么名字开始。</li>\n<li>2014年12月24日，平安夜，我最好的平安夜了，因为我们约定元旦去南京玩。</li>\n<li>2016年12月30日，第一次约会旅行，南京，你说以后有机会一起去无锡玩，你在那里读的大学，好希望机会可以早点到。</li>\n<li>2016年12月31日，距离新的一年只剩几秒了，我躺在你隔壁的房间，我的新年愿望是，成为你的男朋友。</li>\n<li>2017年01月02日，我写下了我的2017。</li>\n<li>2017年01月05日，我给你看了我的新年计划，你说：从朋友变成男朋友需要一个过程，而这个过程不是让我看到你对我多好，而是让我看到你的好，欣赏你的好，你现在无法给我回应；我说：我等你，我想成为你的避风港，我很晚才睡，写了《有一天，你终会遇到一个彩虹般的姑娘》，你就是我彩虹。</li>\n<li>2017年01月14日，我们一起两位喵大人打针，有一针没打好，看着你好心疼，我也很心疼，亲爱的，你真是善良的姑娘；晚上我们一起去看了话剧《火山灰》，挺好的，这是第一次，我们约好以后还要一起看，真好。</li>\n<li>2017年01月15日，昨晚我在宾馆睡了一夜，中午吃到了你第一次做给我的午餐，你说喜欢吃泡椒鸡爪，嗯，以后做给你吃；最后和你在一块的时间总是短暂而又幸福。</li>\n<li>2017年01月25日，一起到姑姑家寄养猫咪，然后在耶里夏丽吃饭，中间表演时你上台跳舞，你说那是你第一次跳舞，我拍下来了，嗯，动作的确很尴尬啊，哈哈。</li>\n<li>2017年01月31日，我听到大猫咪跑掉了，整个人都慌了神，还好最后找到了。</li>\n</ul>\n<blockquote>\n<p>今年的春节过得糟糕透了，从一开始就没处理好，原定的计划没能进行，但是上班就要调整好心态，努力工作。</p>\n</blockquote>\n<ul>\n<li>2017年02月15日，今天一起吃了左庭右院，西方情人节的后一天，感觉就像，还差一点，第一次情人送你口红，你说不要乱花钱，嗯，我会节约啊，但总归是过节嘛，以后尽量动手做东西给你，中山公园是个好地方，有2号线，有3号线，适合约会。</li>\n<li>2017年02月21日，早上听说你昨晚崴了脚，地铁站都没人扶你，好心疼，怨自己离你太远，多想一直给你呵护，永远不要受伤，陪你去看医生，可是去的太晚，耽搁了到医院的时间，幸无大碍，下午回来逛了家乐福和迪卡侬，脚痛还活蹦乱跳像个小孩子，看着是又心疼又喜欢，希望你快快好起来。</li>\n<li>2017年03月03日，不知道怎么脑抽约了大晚上一起去看金刚狼3，搞得香香都没休息好，而且电影放映的时候也有点问题，以后再也不做这么傻逼的事情了，我那么喜欢的姑娘，怎么犯傻让她跟我一起在外吹冷风，昨晚还是睡宾馆，上午帮着一起打扫了家里的卫生，两位喵大人还是不给面子，但是比之前好多了；记下香香喜欢吃的东西，以后要记得做。</li>\n<li>2017年03月30日，听了一首很好听的歌曲，想分享给你：春风十里，春风十里，桃花灼灼，不如你。</li>\n<li>2017年04月02日，好久没见到你了，整整一个星期又4天，最终还是没忍住，冒着把感冒传染给你的风险去找你，今天我们一起骑车走新开发的路线到你的新单位，然后在附近新开的商业区，吃你要吃的“重口味”，哈哈，然后抱怨我点多了，然后一起看了电影，一直在说悄悄话，真幸运邻座的同胞们没起身打死我们嘿嘿，我们一路见到了各种饱受摧残的OFO单车，晚上，第二次吃到你的大餐，喜欢看你，远远躲着油锅的样子，当时我就想，以后烧饭的事情还是交给我来吧，这么可爱的姑娘，我才舍不得让她辛苦呢，感觉你的年龄一点点在变小，我对我们的未来就越有信心，你笑的样子越来越开心，我就越来无法自拔的喜欢你，我们要一起租一个朝南的房子，让阳光可以直接晒到你睡懒觉的屁股上，我每天醒来都能看到你，还有一直捣乱的米饭饭团，我们幸福的生活在一起。香香，我爱你。</li>\n<li>2017年04月21日，我们第一次吵架，我现在真的糟糕透了，对不起，我会尽快调整好自己。</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>我希望可以记录每一件与你做过事，每一个特定的时间，每一个特定的回忆。</p>\n<ul>\n<li>夏怀香，你就是我的彩虹姑娘</li>\n<li>你的生日是每年的农历九月初三</li>\n<li>我不喜欢你喝酒</li>\n<li>我准备了好多电影，我喜欢看，我喜欢和你一起看</li>\n</ul>\n<hr>\n<ul>\n<li>2015年05月18日，我来到微企，很高兴见到你。</li>\n<li>2015年10月29日，公司泰国旅游，那一次，我觉得我想和这个姑娘发生一段故事。</li>\n<li>2016年03月12日，第一次约会，逛了上海杜莎夫人蜡像馆，然后看电影《疯狂动物城》。</li>\n<li>2016年04月10日，讨论学习计划安排的事情，上海图书馆，一起吃晚饭，你很难过，喝了酒，送你回家，买了只猫咪。我也好难过。</li>\n</ul>\n<blockquote>\n<p>我搞不清楚原因，突然我们就不说话了，很长很长时间。</p>\n</blockquote>\n<ul>\n<li>2016年09月14日，你又出现在我的生活里了，真好，感谢虾米音乐。</li>\n<li>2016年10月02日，你的心情不好，我们聊了很长时间，我在阜阳，你在建湖，我多想飞奔到你身边。</li>\n<li><strong>2016年10月03日，你的生日，希望今后你的每一个生日，我都陪你度过，农历九月初三。</strong></li>\n<li>2016年10月03日，你说：我们的生命中都逃脱不了无休止的告别，我说：人生就像一辆列车，中途会有很多人下车，很难有人能自始至终陪你走完，所以，当陪你的人要下车时，即使不舍也该心存感激，然后挥手道别。</li>\n<li>2016年10月05日，你说你要去黄山玩的时候叫我当导游，我在上海，你在建湖，我们准备要回上海了；所以，记得叫上我。</li>\n<li>2016年11月07日，你很难过，我说我喜欢的女孩一定是很自信很厉害，不会因为一个男生就失魂落魄，你说，明天以后我会好好的，谢谢你陪我，嗯，我希望在你所有不开心的时候都陪着你。</li>\n<li>2016年11月07日，我想：弄不明白，为啥在我这宝贝的不行的姑娘，到了别人那儿就啥也不是了呢！</li>\n<li>2016年11月16日，你问周末有没有空，一起去接你的小伙伴，你说，把自己整的柔和亲切点，不要有胡子</li>\n<li>2016年11月19日，你说，明天不用我去了，你自己安排了，我说好，然后挂了电话，放学的路上一点都不亲切。</li>\n<li>2016年12月04里，算第二次正式的约会吧，我们一起看了电影《你的名字》，电影没你好看；想从新认识你，从你叫什么名字开始。</li>\n<li>2014年12月24日，平安夜，我最好的平安夜了，因为我们约定元旦去南京玩。</li>\n<li>2016年12月30日，第一次约会旅行，南京，你说以后有机会一起去无锡玩，你在那里读的大学，好希望机会可以早点到。</li>\n<li>2016年12月31日，距离新的一年只剩几秒了，我躺在你隔壁的房间，我的新年愿望是，成为你的男朋友。</li>\n<li>2017年01月02日，我写下了我的2017。</li>\n<li>2017年01月05日，我给你看了我的新年计划，你说：从朋友变成男朋友需要一个过程，而这个过程不是让我看到你对我多好，而是让我看到你的好，欣赏你的好，你现在无法给我回应；我说：我等你，我想成为你的避风港，我很晚才睡，写了《有一天，你终会遇到一个彩虹般的姑娘》，你就是我彩虹。</li>\n<li>2017年01月14日，我们一起两位喵大人打针，有一针没打好，看着你好心疼，我也很心疼，亲爱的，你真是善良的姑娘；晚上我们一起去看了话剧《火山灰》，挺好的，这是第一次，我们约好以后还要一起看，真好。</li>\n<li>2017年01月15日，昨晚我在宾馆睡了一夜，中午吃到了你第一次做给我的午餐，你说喜欢吃泡椒鸡爪，嗯，以后做给你吃；最后和你在一块的时间总是短暂而又幸福。</li>\n<li>2017年01月25日，一起到姑姑家寄养猫咪，然后在耶里夏丽吃饭，中间表演时你上台跳舞，你说那是你第一次跳舞，我拍下来了，嗯，动作的确很尴尬啊，哈哈。</li>\n<li>2017年01月31日，我听到大猫咪跑掉了，整个人都慌了神，还好最后找到了。</li>\n</ul>\n<blockquote>\n<p>今年的春节过得糟糕透了，从一开始就没处理好，原定的计划没能进行，但是上班就要调整好心态，努力工作。</p>\n</blockquote>\n<ul>\n<li>2017年02月15日，今天一起吃了左庭右院，西方情人节的后一天，感觉就像，还差一点，第一次情人送你口红，你说不要乱花钱，嗯，我会节约啊，但总归是过节嘛，以后尽量动手做东西给你，中山公园是个好地方，有2号线，有3号线，适合约会。</li>\n<li>2017年02月21日，早上听说你昨晚崴了脚，地铁站都没人扶你，好心疼，怨自己离你太远，多想一直给你呵护，永远不要受伤，陪你去看医生，可是去的太晚，耽搁了到医院的时间，幸无大碍，下午回来逛了家乐福和迪卡侬，脚痛还活蹦乱跳像个小孩子，看着是又心疼又喜欢，希望你快快好起来。</li>\n<li>2017年03月03日，不知道怎么脑抽约了大晚上一起去看金刚狼3，搞得香香都没休息好，而且电影放映的时候也有点问题，以后再也不做这么傻逼的事情了，我那么喜欢的姑娘，怎么犯傻让她跟我一起在外吹冷风，昨晚还是睡宾馆，上午帮着一起打扫了家里的卫生，两位喵大人还是不给面子，但是比之前好多了；记下香香喜欢吃的东西，以后要记得做。</li>\n<li>2017年03月30日，听了一首很好听的歌曲，想分享给你：春风十里，春风十里，桃花灼灼，不如你。</li>\n<li>2017年04月02日，好久没见到你了，整整一个星期又4天，最终还是没忍住，冒着把感冒传染给你的风险去找你，今天我们一起骑车走新开发的路线到你的新单位，然后在附近新开的商业区，吃你要吃的“重口味”，哈哈，然后抱怨我点多了，然后一起看了电影，一直在说悄悄话，真幸运邻座的同胞们没起身打死我们嘿嘿，我们一路见到了各种饱受摧残的OFO单车，晚上，第二次吃到你的大餐，喜欢看你，远远躲着油锅的样子，当时我就想，以后烧饭的事情还是交给我来吧，这么可爱的姑娘，我才舍不得让她辛苦呢，感觉你的年龄一点点在变小，我对我们的未来就越有信心，你笑的样子越来越开心，我就越来无法自拔的喜欢你，我们要一起租一个朝南的房子，让阳光可以直接晒到你睡懒觉的屁股上，我每天醒来都能看到你，还有一直捣乱的米饭饭团，我们幸福的生活在一起。香香，我爱你。</li>\n<li>2017年04月21日，我们第一次吵架，我现在真的糟糕透了，对不起，我会尽快调整好自己。</li>\n</ul>\n"},{"title":"斯人若彩虹，遇上方知有","id":"10010","date":"2017-01-14T16:34:54.000Z","_content":"\n\n> 小时候，爷爷跟我说：有一天，你会遇到一个如彩虹般绚丽的人，那时候，你会觉得其他一切都是浮云。\n\n 我今年26岁，在这个世界上生存了8938天，喜欢过三个如彩虹般的姑娘，却始终没有明白一个道理。\n\n> 怎么样才算喜欢一个人 ?\n\n 从那时个性张扬的我总爱逗气同桌的你，有一次把你气的都哭了，我忐忑了一节课，忍不住写纸条给你问还生不生气，你说刚开始有点，现在不生气了；扭头给了我一个微笑，这个微笑整整充满了我整个的青春岁月，直到看到你扮上美丽的红妆嫁衣，而且新郎不是我，写下“恭喜”二字，便再也没出现在你生活，也没让你出现在我的生活里。我们身边所有的朋友都知道我是多么喜欢你，很难想象最后结婚的不是我们；我那时一直以为人生最幸福的一件事：与我结婚的人就是我的初恋，于是，我之后便开始幻想我们的美好未来，高中辍学之后便从业，我那时想你大到学毕业还要5年时间，我努力奋斗，你大学毕业之后我们就结婚；好像所有的努力都不累，浑身上下像个超人，总是充满力量，可是高考前夕的你告诉我，你在学校谈了一个男生被分手了没心思学习不想读了，我安慰你批评你无论怎样都要完成高考读大学，感情问题放到大学里去谈，你虽然顺利读了大学，却大一还没读完，就休学开始工作了。之后我便经常奔走于上海这座城市中，你换一个工作地方，那个地方就是我常去之处，陪你下班，帮你收拾工作，待收拾完之后，我再顶着茫茫夜色回家，教你不能忘记学习，努力工作，我们一起努力；我总是舍不得放弃你，你是我第一个喜欢的人啊，你是第一个听到我哭泣的人啊，总是有太多太多的回忆拉扯着不让我往前走，可是听到你结婚的消息，我最终还是放弃了；朋友说，为了一个女孩，放弃了自己的大好青春值得吗？我不清楚，我只是明白，我喜欢你，拼了命的喜欢，拼尽全力对她好，可是我输了，我一直不明白为什么你会与一个毫不起眼的人结婚而不是我。\n\n> 现在想起来，那时的我的确很好，只是缺少了点自我。\n\n 第二个彩虹姑娘是在一家公司做了快一年了，第一次去总部，摸索到地址，看到一个姑娘问：这里是xx公司吗？她说是的，我说我们是同事，我从分部过来。之后下班，互加了微信，晚上聊到很晚，我半开玩笑说，我们这么合拍，做我女朋友怎样？她说考虑下；周末收到消息：我在yy上课，如果你能在下课之前到这里我就做你女朋友，我爬起来直接打车过去；然后，我们开始疯狂的约会，每个周末都粘在一起，尝试各种黑暗料理，窝在沙发里看电影，于是，我又开始把某个地方变成我常去之处，为了能节省到她家的时间，我从父母哪里搬出来；可是，随着时间的推移，我们都发现了彼此的问题，我一直不愿意去说，我又开始改变自己去适应她的节奏，我说我可以为你去改变，我说我努力去做，可是，我们最后还是分手了，我是喜欢她的，分手都很温和。于是，我开始拼命工作，拼命去学习，努力去忘记她，没想到就真的忘记了。\n\n> 我开始害怕爱情了，我不太敢拥有，就是不明白什么是：不可爱的时候要适可而止。\n\n 换了几份工作，也开始了新的所有生活，直到一个姑娘走进我的心里，她就好像代表了美好出现在我生活里，可是，我不敢说出来，可是，我喜欢她啊，我怎么能轻易放弃；我记得第一次成功约她出去，我内心的激动，朋友做军师帮我打扮，竭尽所能让自己表现的很好；于是我开始傻傻幻想我们的将来，我要努力做事，我让她幸福，我要为了她奋不顾身，我要...，可是我今年26岁，在这个世界上生存了8938天，喜欢过三个如彩虹般的姑娘，却始终没有明白一个道理；“从朋友变成男朋友需要一个过程，而这个过程不是让我看到你对我好，而是让我看到你的好，欣赏你的好。” 一语惊醒梦中人，我总是在爱情昏了头脑，我一直以为我努力对她好是爱，其实，我更爱的为了这份感情努力的自己，爱一个人，其实不需要改变，努力做好你自己就可以。\n\n> 我说我想给你一个家，其实，我是想给自己一个家。\n\n 可是，我还是会努力，我会耐心等你，我会对爱情一直充满期待，我还是那个充满力量的超人，我会一直努力去守护我爱的人，我希望在她孤单委屈的时候，我是她的依靠，为她阻挡这世界的风风雨雨；为了爱的人，抛头颅洒热血，无非换来一句：你想怎样。\n","source":"_posts/斯人若彩虹，遇上方知有.md","raw":"---\ntitle: 斯人若彩虹，遇上方知有\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: si-ren-ruo-cai-hong\nid: 10010\ndate: 2017-01-15 00:34:54\n---\n\n\n> 小时候，爷爷跟我说：有一天，你会遇到一个如彩虹般绚丽的人，那时候，你会觉得其他一切都是浮云。\n\n 我今年26岁，在这个世界上生存了8938天，喜欢过三个如彩虹般的姑娘，却始终没有明白一个道理。\n\n> 怎么样才算喜欢一个人 ?\n\n 从那时个性张扬的我总爱逗气同桌的你，有一次把你气的都哭了，我忐忑了一节课，忍不住写纸条给你问还生不生气，你说刚开始有点，现在不生气了；扭头给了我一个微笑，这个微笑整整充满了我整个的青春岁月，直到看到你扮上美丽的红妆嫁衣，而且新郎不是我，写下“恭喜”二字，便再也没出现在你生活，也没让你出现在我的生活里。我们身边所有的朋友都知道我是多么喜欢你，很难想象最后结婚的不是我们；我那时一直以为人生最幸福的一件事：与我结婚的人就是我的初恋，于是，我之后便开始幻想我们的美好未来，高中辍学之后便从业，我那时想你大到学毕业还要5年时间，我努力奋斗，你大学毕业之后我们就结婚；好像所有的努力都不累，浑身上下像个超人，总是充满力量，可是高考前夕的你告诉我，你在学校谈了一个男生被分手了没心思学习不想读了，我安慰你批评你无论怎样都要完成高考读大学，感情问题放到大学里去谈，你虽然顺利读了大学，却大一还没读完，就休学开始工作了。之后我便经常奔走于上海这座城市中，你换一个工作地方，那个地方就是我常去之处，陪你下班，帮你收拾工作，待收拾完之后，我再顶着茫茫夜色回家，教你不能忘记学习，努力工作，我们一起努力；我总是舍不得放弃你，你是我第一个喜欢的人啊，你是第一个听到我哭泣的人啊，总是有太多太多的回忆拉扯着不让我往前走，可是听到你结婚的消息，我最终还是放弃了；朋友说，为了一个女孩，放弃了自己的大好青春值得吗？我不清楚，我只是明白，我喜欢你，拼了命的喜欢，拼尽全力对她好，可是我输了，我一直不明白为什么你会与一个毫不起眼的人结婚而不是我。\n\n> 现在想起来，那时的我的确很好，只是缺少了点自我。\n\n 第二个彩虹姑娘是在一家公司做了快一年了，第一次去总部，摸索到地址，看到一个姑娘问：这里是xx公司吗？她说是的，我说我们是同事，我从分部过来。之后下班，互加了微信，晚上聊到很晚，我半开玩笑说，我们这么合拍，做我女朋友怎样？她说考虑下；周末收到消息：我在yy上课，如果你能在下课之前到这里我就做你女朋友，我爬起来直接打车过去；然后，我们开始疯狂的约会，每个周末都粘在一起，尝试各种黑暗料理，窝在沙发里看电影，于是，我又开始把某个地方变成我常去之处，为了能节省到她家的时间，我从父母哪里搬出来；可是，随着时间的推移，我们都发现了彼此的问题，我一直不愿意去说，我又开始改变自己去适应她的节奏，我说我可以为你去改变，我说我努力去做，可是，我们最后还是分手了，我是喜欢她的，分手都很温和。于是，我开始拼命工作，拼命去学习，努力去忘记她，没想到就真的忘记了。\n\n> 我开始害怕爱情了，我不太敢拥有，就是不明白什么是：不可爱的时候要适可而止。\n\n 换了几份工作，也开始了新的所有生活，直到一个姑娘走进我的心里，她就好像代表了美好出现在我生活里，可是，我不敢说出来，可是，我喜欢她啊，我怎么能轻易放弃；我记得第一次成功约她出去，我内心的激动，朋友做军师帮我打扮，竭尽所能让自己表现的很好；于是我开始傻傻幻想我们的将来，我要努力做事，我让她幸福，我要为了她奋不顾身，我要...，可是我今年26岁，在这个世界上生存了8938天，喜欢过三个如彩虹般的姑娘，却始终没有明白一个道理；“从朋友变成男朋友需要一个过程，而这个过程不是让我看到你对我好，而是让我看到你的好，欣赏你的好。” 一语惊醒梦中人，我总是在爱情昏了头脑，我一直以为我努力对她好是爱，其实，我更爱的为了这份感情努力的自己，爱一个人，其实不需要改变，努力做好你自己就可以。\n\n> 我说我想给你一个家，其实，我是想给自己一个家。\n\n 可是，我还是会努力，我会耐心等你，我会对爱情一直充满期待，我还是那个充满力量的超人，我会一直努力去守护我爱的人，我希望在她孤单委屈的时候，我是她的依靠，为她阻挡这世界的风风雨雨；为了爱的人，抛头颅洒热血，无非换来一句：你想怎样。\n","slug":"si-ren-ruo-cai-hong","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqeg008e41tpxe8lvg3i","content":"<blockquote>\n<p>小时候，爷爷跟我说：有一天，你会遇到一个如彩虹般绚丽的人，那时候，你会觉得其他一切都是浮云。</p>\n</blockquote>\n<p> 我今年26岁，在这个世界上生存了8938天，喜欢过三个如彩虹般的姑娘，却始终没有明白一个道理。</p>\n<blockquote>\n<p>怎么样才算喜欢一个人 ?</p>\n</blockquote>\n<p> 从那时个性张扬的我总爱逗气同桌的你，有一次把你气的都哭了，我忐忑了一节课，忍不住写纸条给你问还生不生气，你说刚开始有点，现在不生气了；扭头给了我一个微笑，这个微笑整整充满了我整个的青春岁月，直到看到你扮上美丽的红妆嫁衣，而且新郎不是我，写下“恭喜”二字，便再也没出现在你生活，也没让你出现在我的生活里。我们身边所有的朋友都知道我是多么喜欢你，很难想象最后结婚的不是我们；我那时一直以为人生最幸福的一件事：与我结婚的人就是我的初恋，于是，我之后便开始幻想我们的美好未来，高中辍学之后便从业，我那时想你大到学毕业还要5年时间，我努力奋斗，你大学毕业之后我们就结婚；好像所有的努力都不累，浑身上下像个超人，总是充满力量，可是高考前夕的你告诉我，你在学校谈了一个男生被分手了没心思学习不想读了，我安慰你批评你无论怎样都要完成高考读大学，感情问题放到大学里去谈，你虽然顺利读了大学，却大一还没读完，就休学开始工作了。之后我便经常奔走于上海这座城市中，你换一个工作地方，那个地方就是我常去之处，陪你下班，帮你收拾工作，待收拾完之后，我再顶着茫茫夜色回家，教你不能忘记学习，努力工作，我们一起努力；我总是舍不得放弃你，你是我第一个喜欢的人啊，你是第一个听到我哭泣的人啊，总是有太多太多的回忆拉扯着不让我往前走，可是听到你结婚的消息，我最终还是放弃了；朋友说，为了一个女孩，放弃了自己的大好青春值得吗？我不清楚，我只是明白，我喜欢你，拼了命的喜欢，拼尽全力对她好，可是我输了，我一直不明白为什么你会与一个毫不起眼的人结婚而不是我。</p>\n<blockquote>\n<p>现在想起来，那时的我的确很好，只是缺少了点自我。</p>\n</blockquote>\n<p> 第二个彩虹姑娘是在一家公司做了快一年了，第一次去总部，摸索到地址，看到一个姑娘问：这里是xx公司吗？她说是的，我说我们是同事，我从分部过来。之后下班，互加了微信，晚上聊到很晚，我半开玩笑说，我们这么合拍，做我女朋友怎样？她说考虑下；周末收到消息：我在yy上课，如果你能在下课之前到这里我就做你女朋友，我爬起来直接打车过去；然后，我们开始疯狂的约会，每个周末都粘在一起，尝试各种黑暗料理，窝在沙发里看电影，于是，我又开始把某个地方变成我常去之处，为了能节省到她家的时间，我从父母哪里搬出来；可是，随着时间的推移，我们都发现了彼此的问题，我一直不愿意去说，我又开始改变自己去适应她的节奏，我说我可以为你去改变，我说我努力去做，可是，我们最后还是分手了，我是喜欢她的，分手都很温和。于是，我开始拼命工作，拼命去学习，努力去忘记她，没想到就真的忘记了。</p>\n<blockquote>\n<p>我开始害怕爱情了，我不太敢拥有，就是不明白什么是：不可爱的时候要适可而止。</p>\n</blockquote>\n<p> 换了几份工作，也开始了新的所有生活，直到一个姑娘走进我的心里，她就好像代表了美好出现在我生活里，可是，我不敢说出来，可是，我喜欢她啊，我怎么能轻易放弃；我记得第一次成功约她出去，我内心的激动，朋友做军师帮我打扮，竭尽所能让自己表现的很好；于是我开始傻傻幻想我们的将来，我要努力做事，我让她幸福，我要为了她奋不顾身，我要…，可是我今年26岁，在这个世界上生存了8938天，喜欢过三个如彩虹般的姑娘，却始终没有明白一个道理；“从朋友变成男朋友需要一个过程，而这个过程不是让我看到你对我好，而是让我看到你的好，欣赏你的好。” 一语惊醒梦中人，我总是在爱情昏了头脑，我一直以为我努力对她好是爱，其实，我更爱的为了这份感情努力的自己，爱一个人，其实不需要改变，努力做好你自己就可以。</p>\n<blockquote>\n<p>我说我想给你一个家，其实，我是想给自己一个家。</p>\n</blockquote>\n<p> 可是，我还是会努力，我会耐心等你，我会对爱情一直充满期待，我还是那个充满力量的超人，我会一直努力去守护我爱的人，我希望在她孤单委屈的时候，我是她的依靠，为她阻挡这世界的风风雨雨；为了爱的人，抛头颅洒热血，无非换来一句：你想怎样。</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>小时候，爷爷跟我说：有一天，你会遇到一个如彩虹般绚丽的人，那时候，你会觉得其他一切都是浮云。</p>\n</blockquote>\n<p> 我今年26岁，在这个世界上生存了8938天，喜欢过三个如彩虹般的姑娘，却始终没有明白一个道理。</p>\n<blockquote>\n<p>怎么样才算喜欢一个人 ?</p>\n</blockquote>\n<p> 从那时个性张扬的我总爱逗气同桌的你，有一次把你气的都哭了，我忐忑了一节课，忍不住写纸条给你问还生不生气，你说刚开始有点，现在不生气了；扭头给了我一个微笑，这个微笑整整充满了我整个的青春岁月，直到看到你扮上美丽的红妆嫁衣，而且新郎不是我，写下“恭喜”二字，便再也没出现在你生活，也没让你出现在我的生活里。我们身边所有的朋友都知道我是多么喜欢你，很难想象最后结婚的不是我们；我那时一直以为人生最幸福的一件事：与我结婚的人就是我的初恋，于是，我之后便开始幻想我们的美好未来，高中辍学之后便从业，我那时想你大到学毕业还要5年时间，我努力奋斗，你大学毕业之后我们就结婚；好像所有的努力都不累，浑身上下像个超人，总是充满力量，可是高考前夕的你告诉我，你在学校谈了一个男生被分手了没心思学习不想读了，我安慰你批评你无论怎样都要完成高考读大学，感情问题放到大学里去谈，你虽然顺利读了大学，却大一还没读完，就休学开始工作了。之后我便经常奔走于上海这座城市中，你换一个工作地方，那个地方就是我常去之处，陪你下班，帮你收拾工作，待收拾完之后，我再顶着茫茫夜色回家，教你不能忘记学习，努力工作，我们一起努力；我总是舍不得放弃你，你是我第一个喜欢的人啊，你是第一个听到我哭泣的人啊，总是有太多太多的回忆拉扯着不让我往前走，可是听到你结婚的消息，我最终还是放弃了；朋友说，为了一个女孩，放弃了自己的大好青春值得吗？我不清楚，我只是明白，我喜欢你，拼了命的喜欢，拼尽全力对她好，可是我输了，我一直不明白为什么你会与一个毫不起眼的人结婚而不是我。</p>\n<blockquote>\n<p>现在想起来，那时的我的确很好，只是缺少了点自我。</p>\n</blockquote>\n<p> 第二个彩虹姑娘是在一家公司做了快一年了，第一次去总部，摸索到地址，看到一个姑娘问：这里是xx公司吗？她说是的，我说我们是同事，我从分部过来。之后下班，互加了微信，晚上聊到很晚，我半开玩笑说，我们这么合拍，做我女朋友怎样？她说考虑下；周末收到消息：我在yy上课，如果你能在下课之前到这里我就做你女朋友，我爬起来直接打车过去；然后，我们开始疯狂的约会，每个周末都粘在一起，尝试各种黑暗料理，窝在沙发里看电影，于是，我又开始把某个地方变成我常去之处，为了能节省到她家的时间，我从父母哪里搬出来；可是，随着时间的推移，我们都发现了彼此的问题，我一直不愿意去说，我又开始改变自己去适应她的节奏，我说我可以为你去改变，我说我努力去做，可是，我们最后还是分手了，我是喜欢她的，分手都很温和。于是，我开始拼命工作，拼命去学习，努力去忘记她，没想到就真的忘记了。</p>\n<blockquote>\n<p>我开始害怕爱情了，我不太敢拥有，就是不明白什么是：不可爱的时候要适可而止。</p>\n</blockquote>\n<p> 换了几份工作，也开始了新的所有生活，直到一个姑娘走进我的心里，她就好像代表了美好出现在我生活里，可是，我不敢说出来，可是，我喜欢她啊，我怎么能轻易放弃；我记得第一次成功约她出去，我内心的激动，朋友做军师帮我打扮，竭尽所能让自己表现的很好；于是我开始傻傻幻想我们的将来，我要努力做事，我让她幸福，我要为了她奋不顾身，我要…，可是我今年26岁，在这个世界上生存了8938天，喜欢过三个如彩虹般的姑娘，却始终没有明白一个道理；“从朋友变成男朋友需要一个过程，而这个过程不是让我看到你对我好，而是让我看到你的好，欣赏你的好。” 一语惊醒梦中人，我总是在爱情昏了头脑，我一直以为我努力对她好是爱，其实，我更爱的为了这份感情努力的自己，爱一个人，其实不需要改变，努力做好你自己就可以。</p>\n<blockquote>\n<p>我说我想给你一个家，其实，我是想给自己一个家。</p>\n</blockquote>\n<p> 可是，我还是会努力，我会耐心等你，我会对爱情一直充满期待，我还是那个充满力量的超人，我会一直努力去守护我爱的人，我希望在她孤单委屈的时候，我是她的依靠，为她阻挡这世界的风风雨雨；为了爱的人，抛头颅洒热血，无非换来一句：你想怎样。</p>\n"},{"title":"无法逃离的孤独","id":"10011","date":"2017-02-18T16:34:54.000Z","_content":"\n\n张楚说：孤独是可耻的。\n\n我一直不愿承认的，我是一个孤独的人；或者这个世界上，没有人不会感到孤独吧；我的孤独，就好像在喧闹的人群中，突然就孤独了。\n\n写不出来。\n\n+\n\n自从考试没过，心情一直低落，好多事情要做，却又无从下手，我讨厌自己，讨厌自己的优柔懦弱，我讨厌自己浪费着生命在做无意义的事，于是，今晚回到家，一直在思考反省，把所有要做的事情列出来，一个一个排计划，不积跬步，无以至千里，每一件事情都要踏踏实实去做，尽最大的努力。\n\n我不要做的挺好，我要做的最好。\n\n孙悟空，你可不能认输啊！\n\n![img](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/bo2o0.png)\n\n我的焦虑是在于，遇到了想要守护一生的人，可是自己却一年又一年一事无成。\n\n记得曾在书上看到过了，有些人什么都没做，却总是可以温暖某些人的心窝。\n\n亲爱的香香公主，谢谢你，晚安。\n","source":"_posts/无法逃离的孤独.md","raw":"---\ntitle: 无法逃离的孤独\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: iam-alone\nid: 10011\ndate: 2017-02-19 00:34:54\n---\n\n\n张楚说：孤独是可耻的。\n\n我一直不愿承认的，我是一个孤独的人；或者这个世界上，没有人不会感到孤独吧；我的孤独，就好像在喧闹的人群中，突然就孤独了。\n\n写不出来。\n\n+\n\n自从考试没过，心情一直低落，好多事情要做，却又无从下手，我讨厌自己，讨厌自己的优柔懦弱，我讨厌自己浪费着生命在做无意义的事，于是，今晚回到家，一直在思考反省，把所有要做的事情列出来，一个一个排计划，不积跬步，无以至千里，每一件事情都要踏踏实实去做，尽最大的努力。\n\n我不要做的挺好，我要做的最好。\n\n孙悟空，你可不能认输啊！\n\n![img](https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/bo2o0.png)\n\n我的焦虑是在于，遇到了想要守护一生的人，可是自己却一年又一年一事无成。\n\n记得曾在书上看到过了，有些人什么都没做，却总是可以温暖某些人的心窝。\n\n亲爱的香香公主，谢谢你，晚安。\n","slug":"iam-alone","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqei008i41tp0sm5w04m","content":"<p>张楚说：孤独是可耻的。</p>\n<p>我一直不愿承认的，我是一个孤独的人；或者这个世界上，没有人不会感到孤独吧；我的孤独，就好像在喧闹的人群中，突然就孤独了。</p>\n<p>写不出来。</p>\n<p>+</p>\n<p>自从考试没过，心情一直低落，好多事情要做，却又无从下手，我讨厌自己，讨厌自己的优柔懦弱，我讨厌自己浪费着生命在做无意义的事，于是，今晚回到家，一直在思考反省，把所有要做的事情列出来，一个一个排计划，不积跬步，无以至千里，每一件事情都要踏踏实实去做，尽最大的努力。</p>\n<p>我不要做的挺好，我要做的最好。</p>\n<p>孙悟空，你可不能认输啊！</p>\n<p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/bo2o0.png\" alt=\"img\"></p>\n<p>我的焦虑是在于，遇到了想要守护一生的人，可是自己却一年又一年一事无成。</p>\n<p>记得曾在书上看到过了，有些人什么都没做，却总是可以温暖某些人的心窝。</p>\n<p>亲爱的香香公主，谢谢你，晚安。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>张楚说：孤独是可耻的。</p>\n<p>我一直不愿承认的，我是一个孤独的人；或者这个世界上，没有人不会感到孤独吧；我的孤独，就好像在喧闹的人群中，突然就孤独了。</p>\n<p>写不出来。</p>\n<p>+</p>\n<p>自从考试没过，心情一直低落，好多事情要做，却又无从下手，我讨厌自己，讨厌自己的优柔懦弱，我讨厌自己浪费着生命在做无意义的事，于是，今晚回到家，一直在思考反省，把所有要做的事情列出来，一个一个排计划，不积跬步，无以至千里，每一件事情都要踏踏实实去做，尽最大的努力。</p>\n<p>我不要做的挺好，我要做的最好。</p>\n<p>孙悟空，你可不能认输啊！</p>\n<p><img src=\"https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/bo2o0.png\" alt=\"img\"></p>\n<p>我的焦虑是在于，遇到了想要守护一生的人，可是自己却一年又一年一事无成。</p>\n<p>记得曾在书上看到过了，有些人什么都没做，却总是可以温暖某些人的心窝。</p>\n<p>亲爱的香香公主，谢谢你，晚安。</p>\n"},{"title":"无题","id":"10012","date":"2016-07-17T16:34:54.000Z","_content":"\n\n自家酿造的葡萄酒味道真的不错，喝过一大杯的我这样说的，你们应该去试试。是的我试图这样可以让自己早点睡下，我是这样做的，效果还是有点，至少，伴着微醺的思维，情感在释放；酒是一个令人着迷的味道，就好喝醉之后，所有的胡言乱语都会被原谅，谁会跟一个喝醉的人较劲，谁会在意一个喝醉的人说的话，who care。\n\n是夜，当你的周遭变得安静，内心的你便开始躁动不安，妄图支配你的灵魂，黑夜中另一个目光灼灼生辉，是的，沉默的夜色，让人的思维感性满负荷，到夜晚，每个人都是满腹豪情的大诗人，博古通今的大学者，柔肠寸断的伤心人，在天桥，在屋顶，在夜排档，在酒吧，在灯光闪耀你却尽量走在黑暗的马路上，不尽相同的人却都在夜里，这些情绪才会如月降临到每个人的心里，眼里，只被你看到。\n\n我一直想办法克制自己的负面情绪，每个人心中都会有一道疤，生长在内心深处，在任何黑暗之处浮现，奶奶的离去，那是我人生之中最大的灾难，她是我的信仰啊，我始终无法忘却那慈祥的目光；我不信鬼神，但是那一刻我匍匐在地向上苍期待，止不住的泪水在流淌，世上若有鬼魂，能否再让我看她一眼；我一直坚信着心朝阳光，要无比勇敢，是啊，怎可以怯懦，让生命如此不被珍惜，我真的好想你，现在我想奶奶从未离去，她将永远活在我的心里，我将永远缅怀哪些美好时光。\n\n生活是不易的，生命亦是无常，每当我想放弃的时候，就会想是不是再坚持一会，或许就能成功，于爱情，我一直在想是不是多走一步就能离你更近一些，这些年，我停不下来，我退步，我往前，可以我永远无法摆脱你，也无法靠近你，我热切的爱恋，我伤心的远走他乡，我努力，我放弃，可是，我始终无法琢磨你的心思；不敢放弃，我害怕多年之后听到你说，如果当时你能在坚持一点的话，我会受不了的，所以，我才一直不敢放弃，我一直在坚持是不是再往前走一步就能触摸到你，爱情都是自私的，我热切的爱恋着你，也希望可以被你爱恋，可是我无论怎样却永远无法靠近你，我是不是走错了方向，或许，我并不为你所爱，或是并不值得，这些我都明白，我不怕被拒绝，我只是无法琢磨你的想法。诚然，现在去谈论爱情为时尚早，爱情本来就是一种奢侈品，或终其一生都不能拥有，很早，我就知道，你是我的命数，永远绕不过你，我无法对内心的情感置若罔闻，到现在，已经无所谓结局，我都会是你一辈的的朋友，就像习惯喜欢你，就像每天打开电脑都会看下你的状态，就像当年的大男孩，喜欢傻笑，就这么看着你，不说话，一直傻笑，我不喜欢离你忽近忽远，我不愿辗转不知所措，我希望你可以明明白白的告诉我，我不愿逼迫你，也不允许你因为感动而接受我，任何不理性不成熟的对我的回答，都是莫大的伤害，我一直的信念都是希望你幸福，像一个魔咒束缚着我，或者我或是他，我不知道你何时能看到这篇文章，大多数情况你永远看不到，我只要你答应我，遵从内心的感觉，不爱一个人是不会因为时间而改变，在你准备好的时候，给我一个答案。\n\n晚安，奶奶，晚安，我沉痛的思念；\n\n晚安，初恋，晚安，我爱恋的姑娘；\n\n+\n\n晚安，于我人生道路上如此重要的两个人。\n\n> 补档感言： 当年太年轻，热血又傻逼。\n","source":"_posts/无题.md","raw":"---\ntitle: 无题\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: none-name\nid: 10012\ndate: 2016-07-18 00:34:54\n---\n\n\n自家酿造的葡萄酒味道真的不错，喝过一大杯的我这样说的，你们应该去试试。是的我试图这样可以让自己早点睡下，我是这样做的，效果还是有点，至少，伴着微醺的思维，情感在释放；酒是一个令人着迷的味道，就好喝醉之后，所有的胡言乱语都会被原谅，谁会跟一个喝醉的人较劲，谁会在意一个喝醉的人说的话，who care。\n\n是夜，当你的周遭变得安静，内心的你便开始躁动不安，妄图支配你的灵魂，黑夜中另一个目光灼灼生辉，是的，沉默的夜色，让人的思维感性满负荷，到夜晚，每个人都是满腹豪情的大诗人，博古通今的大学者，柔肠寸断的伤心人，在天桥，在屋顶，在夜排档，在酒吧，在灯光闪耀你却尽量走在黑暗的马路上，不尽相同的人却都在夜里，这些情绪才会如月降临到每个人的心里，眼里，只被你看到。\n\n我一直想办法克制自己的负面情绪，每个人心中都会有一道疤，生长在内心深处，在任何黑暗之处浮现，奶奶的离去，那是我人生之中最大的灾难，她是我的信仰啊，我始终无法忘却那慈祥的目光；我不信鬼神，但是那一刻我匍匐在地向上苍期待，止不住的泪水在流淌，世上若有鬼魂，能否再让我看她一眼；我一直坚信着心朝阳光，要无比勇敢，是啊，怎可以怯懦，让生命如此不被珍惜，我真的好想你，现在我想奶奶从未离去，她将永远活在我的心里，我将永远缅怀哪些美好时光。\n\n生活是不易的，生命亦是无常，每当我想放弃的时候，就会想是不是再坚持一会，或许就能成功，于爱情，我一直在想是不是多走一步就能离你更近一些，这些年，我停不下来，我退步，我往前，可以我永远无法摆脱你，也无法靠近你，我热切的爱恋，我伤心的远走他乡，我努力，我放弃，可是，我始终无法琢磨你的心思；不敢放弃，我害怕多年之后听到你说，如果当时你能在坚持一点的话，我会受不了的，所以，我才一直不敢放弃，我一直在坚持是不是再往前走一步就能触摸到你，爱情都是自私的，我热切的爱恋着你，也希望可以被你爱恋，可是我无论怎样却永远无法靠近你，我是不是走错了方向，或许，我并不为你所爱，或是并不值得，这些我都明白，我不怕被拒绝，我只是无法琢磨你的想法。诚然，现在去谈论爱情为时尚早，爱情本来就是一种奢侈品，或终其一生都不能拥有，很早，我就知道，你是我的命数，永远绕不过你，我无法对内心的情感置若罔闻，到现在，已经无所谓结局，我都会是你一辈的的朋友，就像习惯喜欢你，就像每天打开电脑都会看下你的状态，就像当年的大男孩，喜欢傻笑，就这么看着你，不说话，一直傻笑，我不喜欢离你忽近忽远，我不愿辗转不知所措，我希望你可以明明白白的告诉我，我不愿逼迫你，也不允许你因为感动而接受我，任何不理性不成熟的对我的回答，都是莫大的伤害，我一直的信念都是希望你幸福，像一个魔咒束缚着我，或者我或是他，我不知道你何时能看到这篇文章，大多数情况你永远看不到，我只要你答应我，遵从内心的感觉，不爱一个人是不会因为时间而改变，在你准备好的时候，给我一个答案。\n\n晚安，奶奶，晚安，我沉痛的思念；\n\n晚安，初恋，晚安，我爱恋的姑娘；\n\n+\n\n晚安，于我人生道路上如此重要的两个人。\n\n> 补档感言： 当年太年轻，热血又傻逼。\n","slug":"none-name","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqek008l41tpvuccnntz","content":"<p>自家酿造的葡萄酒味道真的不错，喝过一大杯的我这样说的，你们应该去试试。是的我试图这样可以让自己早点睡下，我是这样做的，效果还是有点，至少，伴着微醺的思维，情感在释放；酒是一个令人着迷的味道，就好喝醉之后，所有的胡言乱语都会被原谅，谁会跟一个喝醉的人较劲，谁会在意一个喝醉的人说的话，who care。</p>\n<p>是夜，当你的周遭变得安静，内心的你便开始躁动不安，妄图支配你的灵魂，黑夜中另一个目光灼灼生辉，是的，沉默的夜色，让人的思维感性满负荷，到夜晚，每个人都是满腹豪情的大诗人，博古通今的大学者，柔肠寸断的伤心人，在天桥，在屋顶，在夜排档，在酒吧，在灯光闪耀你却尽量走在黑暗的马路上，不尽相同的人却都在夜里，这些情绪才会如月降临到每个人的心里，眼里，只被你看到。</p>\n<p>我一直想办法克制自己的负面情绪，每个人心中都会有一道疤，生长在内心深处，在任何黑暗之处浮现，奶奶的离去，那是我人生之中最大的灾难，她是我的信仰啊，我始终无法忘却那慈祥的目光；我不信鬼神，但是那一刻我匍匐在地向上苍期待，止不住的泪水在流淌，世上若有鬼魂，能否再让我看她一眼；我一直坚信着心朝阳光，要无比勇敢，是啊，怎可以怯懦，让生命如此不被珍惜，我真的好想你，现在我想奶奶从未离去，她将永远活在我的心里，我将永远缅怀哪些美好时光。</p>\n<p>生活是不易的，生命亦是无常，每当我想放弃的时候，就会想是不是再坚持一会，或许就能成功，于爱情，我一直在想是不是多走一步就能离你更近一些，这些年，我停不下来，我退步，我往前，可以我永远无法摆脱你，也无法靠近你，我热切的爱恋，我伤心的远走他乡，我努力，我放弃，可是，我始终无法琢磨你的心思；不敢放弃，我害怕多年之后听到你说，如果当时你能在坚持一点的话，我会受不了的，所以，我才一直不敢放弃，我一直在坚持是不是再往前走一步就能触摸到你，爱情都是自私的，我热切的爱恋着你，也希望可以被你爱恋，可是我无论怎样却永远无法靠近你，我是不是走错了方向，或许，我并不为你所爱，或是并不值得，这些我都明白，我不怕被拒绝，我只是无法琢磨你的想法。诚然，现在去谈论爱情为时尚早，爱情本来就是一种奢侈品，或终其一生都不能拥有，很早，我就知道，你是我的命数，永远绕不过你，我无法对内心的情感置若罔闻，到现在，已经无所谓结局，我都会是你一辈的的朋友，就像习惯喜欢你，就像每天打开电脑都会看下你的状态，就像当年的大男孩，喜欢傻笑，就这么看着你，不说话，一直傻笑，我不喜欢离你忽近忽远，我不愿辗转不知所措，我希望你可以明明白白的告诉我，我不愿逼迫你，也不允许你因为感动而接受我，任何不理性不成熟的对我的回答，都是莫大的伤害，我一直的信念都是希望你幸福，像一个魔咒束缚着我，或者我或是他，我不知道你何时能看到这篇文章，大多数情况你永远看不到，我只要你答应我，遵从内心的感觉，不爱一个人是不会因为时间而改变，在你准备好的时候，给我一个答案。</p>\n<p>晚安，奶奶，晚安，我沉痛的思念；</p>\n<p>晚安，初恋，晚安，我爱恋的姑娘；</p>\n<p>+</p>\n<p>晚安，于我人生道路上如此重要的两个人。</p>\n<blockquote>\n<p>补档感言： 当年太年轻，热血又傻逼。</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p>自家酿造的葡萄酒味道真的不错，喝过一大杯的我这样说的，你们应该去试试。是的我试图这样可以让自己早点睡下，我是这样做的，效果还是有点，至少，伴着微醺的思维，情感在释放；酒是一个令人着迷的味道，就好喝醉之后，所有的胡言乱语都会被原谅，谁会跟一个喝醉的人较劲，谁会在意一个喝醉的人说的话，who care。</p>\n<p>是夜，当你的周遭变得安静，内心的你便开始躁动不安，妄图支配你的灵魂，黑夜中另一个目光灼灼生辉，是的，沉默的夜色，让人的思维感性满负荷，到夜晚，每个人都是满腹豪情的大诗人，博古通今的大学者，柔肠寸断的伤心人，在天桥，在屋顶，在夜排档，在酒吧，在灯光闪耀你却尽量走在黑暗的马路上，不尽相同的人却都在夜里，这些情绪才会如月降临到每个人的心里，眼里，只被你看到。</p>\n<p>我一直想办法克制自己的负面情绪，每个人心中都会有一道疤，生长在内心深处，在任何黑暗之处浮现，奶奶的离去，那是我人生之中最大的灾难，她是我的信仰啊，我始终无法忘却那慈祥的目光；我不信鬼神，但是那一刻我匍匐在地向上苍期待，止不住的泪水在流淌，世上若有鬼魂，能否再让我看她一眼；我一直坚信着心朝阳光，要无比勇敢，是啊，怎可以怯懦，让生命如此不被珍惜，我真的好想你，现在我想奶奶从未离去，她将永远活在我的心里，我将永远缅怀哪些美好时光。</p>\n<p>生活是不易的，生命亦是无常，每当我想放弃的时候，就会想是不是再坚持一会，或许就能成功，于爱情，我一直在想是不是多走一步就能离你更近一些，这些年，我停不下来，我退步，我往前，可以我永远无法摆脱你，也无法靠近你，我热切的爱恋，我伤心的远走他乡，我努力，我放弃，可是，我始终无法琢磨你的心思；不敢放弃，我害怕多年之后听到你说，如果当时你能在坚持一点的话，我会受不了的，所以，我才一直不敢放弃，我一直在坚持是不是再往前走一步就能触摸到你，爱情都是自私的，我热切的爱恋着你，也希望可以被你爱恋，可是我无论怎样却永远无法靠近你，我是不是走错了方向，或许，我并不为你所爱，或是并不值得，这些我都明白，我不怕被拒绝，我只是无法琢磨你的想法。诚然，现在去谈论爱情为时尚早，爱情本来就是一种奢侈品，或终其一生都不能拥有，很早，我就知道，你是我的命数，永远绕不过你，我无法对内心的情感置若罔闻，到现在，已经无所谓结局，我都会是你一辈的的朋友，就像习惯喜欢你，就像每天打开电脑都会看下你的状态，就像当年的大男孩，喜欢傻笑，就这么看着你，不说话，一直傻笑，我不喜欢离你忽近忽远，我不愿辗转不知所措，我希望你可以明明白白的告诉我，我不愿逼迫你，也不允许你因为感动而接受我，任何不理性不成熟的对我的回答，都是莫大的伤害，我一直的信念都是希望你幸福，像一个魔咒束缚着我，或者我或是他，我不知道你何时能看到这篇文章，大多数情况你永远看不到，我只要你答应我，遵从内心的感觉，不爱一个人是不会因为时间而改变，在你准备好的时候，给我一个答案。</p>\n<p>晚安，奶奶，晚安，我沉痛的思念；</p>\n<p>晚安，初恋，晚安，我爱恋的姑娘；</p>\n<p>+</p>\n<p>晚安，于我人生道路上如此重要的两个人。</p>\n<blockquote>\n<p>补档感言： 当年太年轻，热血又傻逼。</p>\n</blockquote>\n"},{"title":"极简主义","id":"10013","date":"2015-11-16T16:34:54.000Z","_content":"\n\n在我的理解和认知能力范围内，极简不仅仅是从生活物品上，更重要的思想和情感上做，人才不会那么累，而我自以为，人生在世这一路上，莫不是在追寻心灵的满足，但是，不如意者常七八，可与言者无二三；所以人生绝大多数时间是孤独的，是时间不充足的，所以尽可能做让自己开心的事情，去喜欢让你怦然心动的姑娘；听一个朋友说：一定是特别的缘分，才可以一路走来变成一家人。香香公主变回了原来的名字，难过么？当然难过，但是这没必要去纠结谁，也没什么好纠结的了啊，放弃了么，当然不会啊！毕竟暗暗喜欢那么久的人，如果可以轻易放弃，当初的意义在哪里呢，其实还是喜欢啊，尽管姑娘不喜欢你，但是那又怎样呢？为热爱的人或是事物洒下热血和热泪，最坏的结果无非就是对方一句“你想怎样”。所以啊，又是新的一天，阳光明媚的，嗯，那就好好工作咯。嘿嘿，我这个心机boy！\n\n写作的理由有很多种，牛逼的人为了挣钱养家，有追求的人为了曾经的梦想理想，我也有自己的理由：写给自己看，因为我如果靠这个挣钱养家早就饿死了，并且至到如今也没有对写作有追求；为了自己的喜欢而写。初三以前，上海读书，班干部，整日间器宇轩昂，更是无暇去写这些东西；初三转学回老家，我总是在转学，初恋小姑娘仍然留在上海读书，那时没有手机，联系就这么断了；大概是小狗的爱情发作了，突然想写东西，写文章写诗，上课写，上什么课都写，下课写；也疯狂的读书，省下一顿中饭便可以在街心公园的书店买上一本书，所以身份证上的我最帅了，真的是饿瘦了啊；所以看了很多书，韩寒郭敬明沧月饶雪漫等等等整个80后作家青春文学群体基本全扫了一遍，当然还有杂七杂八的杂志传记，我喜欢翻犄角旮旯，甚至翻出老板深藏的“时尚杂志”，付钱时老板一脸行家啊的神色此生难忘，果不其然当晚就破了修炼多年的童子功；初中毕业，大多数同学收获了一本本几同学纪念册，我收获了别人眼中怪癖的性格和满满写着中饭的几摞书。中考结束，回校，压抑一年的同学们得到释放近乎癫狂，六层教学楼里撒满了支离破碎的真题教材之类；后来有人在教室烧试卷，我的同桌，也算是上海回来唯一的朋友说：把你的试卷拿来烧了，可是我试卷都扔完了，没东西烧，鬼使神差的就把写的几本诗和文章拿出来烧，完事儿就后悔了，但是烧了又能怎样呢，这大概是我为极简主义做出来的第一个贡献吧，也养成了我删文章的习惯。时间辗转，玩QQ的时候用空间写，玩微博的时候写微博，写了删删了写，以至于现在什么都不剩下，但是也算可以吧，回首往事时啥也没有就懒得回首了，人还是要向前看的好，所以在羡慕那些拥有很多回忆的人时，也享受自己潇洒的状态；曾经一个朋友带我参观她的储藏，如数家珍的列出每一件物品和专属的人和故事，羡慕的眼泪都要掉下来了，回想这么多年，我剩下的也只羊一摞摞书了，但是看过的书大多都忘了，所以我什么都不剩下来；有时候觉得自己特别像故事里的小猴子，捡起一个丢下一个，最后什么都没有，小猴子每一个都非常喜欢啊，但最后的舍弃了，我好像懂了什么道理，但又像什么都没懂，这个故事现在看不懂。最后，我想说的是：关于情感的极简我不赞同，我们要做的是内心情感奔涌如潮的人，好的坏的，这些都是你的，做个有故事的人，才会有人给你故事。\n\n关于。我写过很多“关于”的故事，关于工作、关于理想、关于吃饭穿衣、关于我爱的姑娘不爱我啊，关于... ，但是，多数最后都是说先搁着，以后再慢慢写，其实我自己也不知道什么时候会拿出来写，或者根本就忘记了；兴之所至，自然就喷薄着写的欲望。人懒了，不去写也正常。\n\n关于读书。读书，写书评，之前经常做这种事情，读书的时候可谓博览青春文学丛书，不知多少个日日夜夜沉溺其中而感伤感动不已，进而期待自己的爱情；工作几年至今，更多是偏爱纪实历史类的书籍还有不少作者的随笔散文，我是看书特投入的人，经常被感动流泪，如今亦是，早些年间看明晓溪《泡沫之夏》哭了，看饶雪漫《离开》哭了，看读者小文哭了，后来看余华《活着》哭了，看路遥《平凡的世界》和《人生》更是哭的稀里糊涂，当然也会笑；人只要能被伤害或感动就是好的。我看的很感动，但是书评就是写不好，分享给朋友的时候多数都看不上眼，所以后来自己写了也不敢给别人看。\n\n关于听歌，我是一个挺臭屁的人，曾经说过：不要问我为什么这么会装B，因为我听歌只听宋冬野；后来当我喜欢上逼哥，好妹妹，赵雷，我再也不敢这么说话了。当然我听歌喜欢听民谣，朋友说你不懂民谣，民谣一定要到小地方听到得才算好的，我这只能算城市民谣，所以，我听歌喜欢听城市民谣，生活在水泥钢筋的城市里有着一颗不安定的心；另一个朋友说，他不喜欢民谣，因为民谣里的爱情做爱都买不起避孕套，容易出事儿，我觉得他说的很对，总结的很地道，但是我没有女朋友，随着时间的推移，人在变老变丑，有女朋友的几率会更小，用不到避孕套；所以，我听歌喜欢听做爱买不起避孕套的城市民谣。\n\n关于鬼畜，这个是我的最爱毋庸置疑，三个时间段会一直爱下去，就像爱姑娘一样，我爱她们青葱的小手和大白的奶子，我也爱鬼畜的污污污，爱丞相和王朗，爱天朝第一歌姬，爱天朝第一英文歌姬，爱女孩为什么穿短裙。世间恐怕没多少比这个更好地事情了，因为真的很开心，没心没肺的开心，我喜欢听，哎呦，不错哦，好像周杰伦翻唱过这首龙卷基。[Link](http://www.bilibili.com/video/av4172954/)\n\n关于我，我是一个小人物，有着平凡的喜怒哀乐，出身平凡之家没什么好谈的，家人身体安康、和睦相处已是万分幸福了。我不喜欢有些人把自己的惰性归咎于出身，诚然，你没法让自己做到最好，但是最起码你要努力让自己变得更好；我永远相信，当面包掉在地上奶酪一定是朝上的。莱蒙托夫有首诗《一只船》这样写：一只船孤独地航行在海上，它既不寻求幸福，也不逃避幸福，它只是向前航行，底下是沉静碧蓝的大海，而头顶是金色的太阳。我努力工作，努力过好自己的人生，不盲目自大，不自暴自弃，我可能究其一生也不达到我想要的生活，甚至绝大情况会比我想象的要糟糕，但是我会努力去做好自己的，做自己想做的在每一天，挥洒青春，尽量犯错。关于爱情和姑娘话题，永远都说不完啊，我喜欢美好的姑娘，但是我不是见一个喜欢一个，我会在很长的一段时间里喜欢一个人，尽管多数是不会有结果。我喜欢的姑娘，我希望我可以像太阳一样，给你温暖，橡树一样成为你的依靠，你应该怀疑，你也可以拒绝，但是我也会像太阳一样周而复始，像树一样扎根于此，你要知道树一旦落地生根，再拔起来可是要命的事情了。\n\n晚安，这个世界和我和你和他们。\n","source":"_posts/极简主义.md","raw":"---\ntitle: 极简主义\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: easy-life\nid: 10013\ndate: 2015-11-17 00:34:54\n---\n\n\n在我的理解和认知能力范围内，极简不仅仅是从生活物品上，更重要的思想和情感上做，人才不会那么累，而我自以为，人生在世这一路上，莫不是在追寻心灵的满足，但是，不如意者常七八，可与言者无二三；所以人生绝大多数时间是孤独的，是时间不充足的，所以尽可能做让自己开心的事情，去喜欢让你怦然心动的姑娘；听一个朋友说：一定是特别的缘分，才可以一路走来变成一家人。香香公主变回了原来的名字，难过么？当然难过，但是这没必要去纠结谁，也没什么好纠结的了啊，放弃了么，当然不会啊！毕竟暗暗喜欢那么久的人，如果可以轻易放弃，当初的意义在哪里呢，其实还是喜欢啊，尽管姑娘不喜欢你，但是那又怎样呢？为热爱的人或是事物洒下热血和热泪，最坏的结果无非就是对方一句“你想怎样”。所以啊，又是新的一天，阳光明媚的，嗯，那就好好工作咯。嘿嘿，我这个心机boy！\n\n写作的理由有很多种，牛逼的人为了挣钱养家，有追求的人为了曾经的梦想理想，我也有自己的理由：写给自己看，因为我如果靠这个挣钱养家早就饿死了，并且至到如今也没有对写作有追求；为了自己的喜欢而写。初三以前，上海读书，班干部，整日间器宇轩昂，更是无暇去写这些东西；初三转学回老家，我总是在转学，初恋小姑娘仍然留在上海读书，那时没有手机，联系就这么断了；大概是小狗的爱情发作了，突然想写东西，写文章写诗，上课写，上什么课都写，下课写；也疯狂的读书，省下一顿中饭便可以在街心公园的书店买上一本书，所以身份证上的我最帅了，真的是饿瘦了啊；所以看了很多书，韩寒郭敬明沧月饶雪漫等等等整个80后作家青春文学群体基本全扫了一遍，当然还有杂七杂八的杂志传记，我喜欢翻犄角旮旯，甚至翻出老板深藏的“时尚杂志”，付钱时老板一脸行家啊的神色此生难忘，果不其然当晚就破了修炼多年的童子功；初中毕业，大多数同学收获了一本本几同学纪念册，我收获了别人眼中怪癖的性格和满满写着中饭的几摞书。中考结束，回校，压抑一年的同学们得到释放近乎癫狂，六层教学楼里撒满了支离破碎的真题教材之类；后来有人在教室烧试卷，我的同桌，也算是上海回来唯一的朋友说：把你的试卷拿来烧了，可是我试卷都扔完了，没东西烧，鬼使神差的就把写的几本诗和文章拿出来烧，完事儿就后悔了，但是烧了又能怎样呢，这大概是我为极简主义做出来的第一个贡献吧，也养成了我删文章的习惯。时间辗转，玩QQ的时候用空间写，玩微博的时候写微博，写了删删了写，以至于现在什么都不剩下，但是也算可以吧，回首往事时啥也没有就懒得回首了，人还是要向前看的好，所以在羡慕那些拥有很多回忆的人时，也享受自己潇洒的状态；曾经一个朋友带我参观她的储藏，如数家珍的列出每一件物品和专属的人和故事，羡慕的眼泪都要掉下来了，回想这么多年，我剩下的也只羊一摞摞书了，但是看过的书大多都忘了，所以我什么都不剩下来；有时候觉得自己特别像故事里的小猴子，捡起一个丢下一个，最后什么都没有，小猴子每一个都非常喜欢啊，但最后的舍弃了，我好像懂了什么道理，但又像什么都没懂，这个故事现在看不懂。最后，我想说的是：关于情感的极简我不赞同，我们要做的是内心情感奔涌如潮的人，好的坏的，这些都是你的，做个有故事的人，才会有人给你故事。\n\n关于。我写过很多“关于”的故事，关于工作、关于理想、关于吃饭穿衣、关于我爱的姑娘不爱我啊，关于... ，但是，多数最后都是说先搁着，以后再慢慢写，其实我自己也不知道什么时候会拿出来写，或者根本就忘记了；兴之所至，自然就喷薄着写的欲望。人懒了，不去写也正常。\n\n关于读书。读书，写书评，之前经常做这种事情，读书的时候可谓博览青春文学丛书，不知多少个日日夜夜沉溺其中而感伤感动不已，进而期待自己的爱情；工作几年至今，更多是偏爱纪实历史类的书籍还有不少作者的随笔散文，我是看书特投入的人，经常被感动流泪，如今亦是，早些年间看明晓溪《泡沫之夏》哭了，看饶雪漫《离开》哭了，看读者小文哭了，后来看余华《活着》哭了，看路遥《平凡的世界》和《人生》更是哭的稀里糊涂，当然也会笑；人只要能被伤害或感动就是好的。我看的很感动，但是书评就是写不好，分享给朋友的时候多数都看不上眼，所以后来自己写了也不敢给别人看。\n\n关于听歌，我是一个挺臭屁的人，曾经说过：不要问我为什么这么会装B，因为我听歌只听宋冬野；后来当我喜欢上逼哥，好妹妹，赵雷，我再也不敢这么说话了。当然我听歌喜欢听民谣，朋友说你不懂民谣，民谣一定要到小地方听到得才算好的，我这只能算城市民谣，所以，我听歌喜欢听城市民谣，生活在水泥钢筋的城市里有着一颗不安定的心；另一个朋友说，他不喜欢民谣，因为民谣里的爱情做爱都买不起避孕套，容易出事儿，我觉得他说的很对，总结的很地道，但是我没有女朋友，随着时间的推移，人在变老变丑，有女朋友的几率会更小，用不到避孕套；所以，我听歌喜欢听做爱买不起避孕套的城市民谣。\n\n关于鬼畜，这个是我的最爱毋庸置疑，三个时间段会一直爱下去，就像爱姑娘一样，我爱她们青葱的小手和大白的奶子，我也爱鬼畜的污污污，爱丞相和王朗，爱天朝第一歌姬，爱天朝第一英文歌姬，爱女孩为什么穿短裙。世间恐怕没多少比这个更好地事情了，因为真的很开心，没心没肺的开心，我喜欢听，哎呦，不错哦，好像周杰伦翻唱过这首龙卷基。[Link](http://www.bilibili.com/video/av4172954/)\n\n关于我，我是一个小人物，有着平凡的喜怒哀乐，出身平凡之家没什么好谈的，家人身体安康、和睦相处已是万分幸福了。我不喜欢有些人把自己的惰性归咎于出身，诚然，你没法让自己做到最好，但是最起码你要努力让自己变得更好；我永远相信，当面包掉在地上奶酪一定是朝上的。莱蒙托夫有首诗《一只船》这样写：一只船孤独地航行在海上，它既不寻求幸福，也不逃避幸福，它只是向前航行，底下是沉静碧蓝的大海，而头顶是金色的太阳。我努力工作，努力过好自己的人生，不盲目自大，不自暴自弃，我可能究其一生也不达到我想要的生活，甚至绝大情况会比我想象的要糟糕，但是我会努力去做好自己的，做自己想做的在每一天，挥洒青春，尽量犯错。关于爱情和姑娘话题，永远都说不完啊，我喜欢美好的姑娘，但是我不是见一个喜欢一个，我会在很长的一段时间里喜欢一个人，尽管多数是不会有结果。我喜欢的姑娘，我希望我可以像太阳一样，给你温暖，橡树一样成为你的依靠，你应该怀疑，你也可以拒绝，但是我也会像太阳一样周而复始，像树一样扎根于此，你要知道树一旦落地生根，再拔起来可是要命的事情了。\n\n晚安，这个世界和我和你和他们。\n","slug":"easy-life","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqen008p41tpszd68cdx","content":"<p>在我的理解和认知能力范围内，极简不仅仅是从生活物品上，更重要的思想和情感上做，人才不会那么累，而我自以为，人生在世这一路上，莫不是在追寻心灵的满足，但是，不如意者常七八，可与言者无二三；所以人生绝大多数时间是孤独的，是时间不充足的，所以尽可能做让自己开心的事情，去喜欢让你怦然心动的姑娘；听一个朋友说：一定是特别的缘分，才可以一路走来变成一家人。香香公主变回了原来的名字，难过么？当然难过，但是这没必要去纠结谁，也没什么好纠结的了啊，放弃了么，当然不会啊！毕竟暗暗喜欢那么久的人，如果可以轻易放弃，当初的意义在哪里呢，其实还是喜欢啊，尽管姑娘不喜欢你，但是那又怎样呢？为热爱的人或是事物洒下热血和热泪，最坏的结果无非就是对方一句“你想怎样”。所以啊，又是新的一天，阳光明媚的，嗯，那就好好工作咯。嘿嘿，我这个心机boy！</p>\n<p>写作的理由有很多种，牛逼的人为了挣钱养家，有追求的人为了曾经的梦想理想，我也有自己的理由：写给自己看，因为我如果靠这个挣钱养家早就饿死了，并且至到如今也没有对写作有追求；为了自己的喜欢而写。初三以前，上海读书，班干部，整日间器宇轩昂，更是无暇去写这些东西；初三转学回老家，我总是在转学，初恋小姑娘仍然留在上海读书，那时没有手机，联系就这么断了；大概是小狗的爱情发作了，突然想写东西，写文章写诗，上课写，上什么课都写，下课写；也疯狂的读书，省下一顿中饭便可以在街心公园的书店买上一本书，所以身份证上的我最帅了，真的是饿瘦了啊；所以看了很多书，韩寒郭敬明沧月饶雪漫等等等整个80后作家青春文学群体基本全扫了一遍，当然还有杂七杂八的杂志传记，我喜欢翻犄角旮旯，甚至翻出老板深藏的“时尚杂志”，付钱时老板一脸行家啊的神色此生难忘，果不其然当晚就破了修炼多年的童子功；初中毕业，大多数同学收获了一本本几同学纪念册，我收获了别人眼中怪癖的性格和满满写着中饭的几摞书。中考结束，回校，压抑一年的同学们得到释放近乎癫狂，六层教学楼里撒满了支离破碎的真题教材之类；后来有人在教室烧试卷，我的同桌，也算是上海回来唯一的朋友说：把你的试卷拿来烧了，可是我试卷都扔完了，没东西烧，鬼使神差的就把写的几本诗和文章拿出来烧，完事儿就后悔了，但是烧了又能怎样呢，这大概是我为极简主义做出来的第一个贡献吧，也养成了我删文章的习惯。时间辗转，玩QQ的时候用空间写，玩微博的时候写微博，写了删删了写，以至于现在什么都不剩下，但是也算可以吧，回首往事时啥也没有就懒得回首了，人还是要向前看的好，所以在羡慕那些拥有很多回忆的人时，也享受自己潇洒的状态；曾经一个朋友带我参观她的储藏，如数家珍的列出每一件物品和专属的人和故事，羡慕的眼泪都要掉下来了，回想这么多年，我剩下的也只羊一摞摞书了，但是看过的书大多都忘了，所以我什么都不剩下来；有时候觉得自己特别像故事里的小猴子，捡起一个丢下一个，最后什么都没有，小猴子每一个都非常喜欢啊，但最后的舍弃了，我好像懂了什么道理，但又像什么都没懂，这个故事现在看不懂。最后，我想说的是：关于情感的极简我不赞同，我们要做的是内心情感奔涌如潮的人，好的坏的，这些都是你的，做个有故事的人，才会有人给你故事。</p>\n<p>关于。我写过很多“关于”的故事，关于工作、关于理想、关于吃饭穿衣、关于我爱的姑娘不爱我啊，关于… ，但是，多数最后都是说先搁着，以后再慢慢写，其实我自己也不知道什么时候会拿出来写，或者根本就忘记了；兴之所至，自然就喷薄着写的欲望。人懒了，不去写也正常。</p>\n<p>关于读书。读书，写书评，之前经常做这种事情，读书的时候可谓博览青春文学丛书，不知多少个日日夜夜沉溺其中而感伤感动不已，进而期待自己的爱情；工作几年至今，更多是偏爱纪实历史类的书籍还有不少作者的随笔散文，我是看书特投入的人，经常被感动流泪，如今亦是，早些年间看明晓溪《泡沫之夏》哭了，看饶雪漫《离开》哭了，看读者小文哭了，后来看余华《活着》哭了，看路遥《平凡的世界》和《人生》更是哭的稀里糊涂，当然也会笑；人只要能被伤害或感动就是好的。我看的很感动，但是书评就是写不好，分享给朋友的时候多数都看不上眼，所以后来自己写了也不敢给别人看。</p>\n<p>关于听歌，我是一个挺臭屁的人，曾经说过：不要问我为什么这么会装B，因为我听歌只听宋冬野；后来当我喜欢上逼哥，好妹妹，赵雷，我再也不敢这么说话了。当然我听歌喜欢听民谣，朋友说你不懂民谣，民谣一定要到小地方听到得才算好的，我这只能算城市民谣，所以，我听歌喜欢听城市民谣，生活在水泥钢筋的城市里有着一颗不安定的心；另一个朋友说，他不喜欢民谣，因为民谣里的爱情做爱都买不起避孕套，容易出事儿，我觉得他说的很对，总结的很地道，但是我没有女朋友，随着时间的推移，人在变老变丑，有女朋友的几率会更小，用不到避孕套；所以，我听歌喜欢听做爱买不起避孕套的城市民谣。</p>\n<p>关于鬼畜，这个是我的最爱毋庸置疑，三个时间段会一直爱下去，就像爱姑娘一样，我爱她们青葱的小手和大白的奶子，我也爱鬼畜的污污污，爱丞相和王朗，爱天朝第一歌姬，爱天朝第一英文歌姬，爱女孩为什么穿短裙。世间恐怕没多少比这个更好地事情了，因为真的很开心，没心没肺的开心，我喜欢听，哎呦，不错哦，好像周杰伦翻唱过这首龙卷基。<a href=\"http://www.bilibili.com/video/av4172954/\" target=\"_blank\" rel=\"external\">Link</a></p>\n<p>关于我，我是一个小人物，有着平凡的喜怒哀乐，出身平凡之家没什么好谈的，家人身体安康、和睦相处已是万分幸福了。我不喜欢有些人把自己的惰性归咎于出身，诚然，你没法让自己做到最好，但是最起码你要努力让自己变得更好；我永远相信，当面包掉在地上奶酪一定是朝上的。莱蒙托夫有首诗《一只船》这样写：一只船孤独地航行在海上，它既不寻求幸福，也不逃避幸福，它只是向前航行，底下是沉静碧蓝的大海，而头顶是金色的太阳。我努力工作，努力过好自己的人生，不盲目自大，不自暴自弃，我可能究其一生也不达到我想要的生活，甚至绝大情况会比我想象的要糟糕，但是我会努力去做好自己的，做自己想做的在每一天，挥洒青春，尽量犯错。关于爱情和姑娘话题，永远都说不完啊，我喜欢美好的姑娘，但是我不是见一个喜欢一个，我会在很长的一段时间里喜欢一个人，尽管多数是不会有结果。我喜欢的姑娘，我希望我可以像太阳一样，给你温暖，橡树一样成为你的依靠，你应该怀疑，你也可以拒绝，但是我也会像太阳一样周而复始，像树一样扎根于此，你要知道树一旦落地生根，再拔起来可是要命的事情了。</p>\n<p>晚安，这个世界和我和你和他们。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>在我的理解和认知能力范围内，极简不仅仅是从生活物品上，更重要的思想和情感上做，人才不会那么累，而我自以为，人生在世这一路上，莫不是在追寻心灵的满足，但是，不如意者常七八，可与言者无二三；所以人生绝大多数时间是孤独的，是时间不充足的，所以尽可能做让自己开心的事情，去喜欢让你怦然心动的姑娘；听一个朋友说：一定是特别的缘分，才可以一路走来变成一家人。香香公主变回了原来的名字，难过么？当然难过，但是这没必要去纠结谁，也没什么好纠结的了啊，放弃了么，当然不会啊！毕竟暗暗喜欢那么久的人，如果可以轻易放弃，当初的意义在哪里呢，其实还是喜欢啊，尽管姑娘不喜欢你，但是那又怎样呢？为热爱的人或是事物洒下热血和热泪，最坏的结果无非就是对方一句“你想怎样”。所以啊，又是新的一天，阳光明媚的，嗯，那就好好工作咯。嘿嘿，我这个心机boy！</p>\n<p>写作的理由有很多种，牛逼的人为了挣钱养家，有追求的人为了曾经的梦想理想，我也有自己的理由：写给自己看，因为我如果靠这个挣钱养家早就饿死了，并且至到如今也没有对写作有追求；为了自己的喜欢而写。初三以前，上海读书，班干部，整日间器宇轩昂，更是无暇去写这些东西；初三转学回老家，我总是在转学，初恋小姑娘仍然留在上海读书，那时没有手机，联系就这么断了；大概是小狗的爱情发作了，突然想写东西，写文章写诗，上课写，上什么课都写，下课写；也疯狂的读书，省下一顿中饭便可以在街心公园的书店买上一本书，所以身份证上的我最帅了，真的是饿瘦了啊；所以看了很多书，韩寒郭敬明沧月饶雪漫等等等整个80后作家青春文学群体基本全扫了一遍，当然还有杂七杂八的杂志传记，我喜欢翻犄角旮旯，甚至翻出老板深藏的“时尚杂志”，付钱时老板一脸行家啊的神色此生难忘，果不其然当晚就破了修炼多年的童子功；初中毕业，大多数同学收获了一本本几同学纪念册，我收获了别人眼中怪癖的性格和满满写着中饭的几摞书。中考结束，回校，压抑一年的同学们得到释放近乎癫狂，六层教学楼里撒满了支离破碎的真题教材之类；后来有人在教室烧试卷，我的同桌，也算是上海回来唯一的朋友说：把你的试卷拿来烧了，可是我试卷都扔完了，没东西烧，鬼使神差的就把写的几本诗和文章拿出来烧，完事儿就后悔了，但是烧了又能怎样呢，这大概是我为极简主义做出来的第一个贡献吧，也养成了我删文章的习惯。时间辗转，玩QQ的时候用空间写，玩微博的时候写微博，写了删删了写，以至于现在什么都不剩下，但是也算可以吧，回首往事时啥也没有就懒得回首了，人还是要向前看的好，所以在羡慕那些拥有很多回忆的人时，也享受自己潇洒的状态；曾经一个朋友带我参观她的储藏，如数家珍的列出每一件物品和专属的人和故事，羡慕的眼泪都要掉下来了，回想这么多年，我剩下的也只羊一摞摞书了，但是看过的书大多都忘了，所以我什么都不剩下来；有时候觉得自己特别像故事里的小猴子，捡起一个丢下一个，最后什么都没有，小猴子每一个都非常喜欢啊，但最后的舍弃了，我好像懂了什么道理，但又像什么都没懂，这个故事现在看不懂。最后，我想说的是：关于情感的极简我不赞同，我们要做的是内心情感奔涌如潮的人，好的坏的，这些都是你的，做个有故事的人，才会有人给你故事。</p>\n<p>关于。我写过很多“关于”的故事，关于工作、关于理想、关于吃饭穿衣、关于我爱的姑娘不爱我啊，关于… ，但是，多数最后都是说先搁着，以后再慢慢写，其实我自己也不知道什么时候会拿出来写，或者根本就忘记了；兴之所至，自然就喷薄着写的欲望。人懒了，不去写也正常。</p>\n<p>关于读书。读书，写书评，之前经常做这种事情，读书的时候可谓博览青春文学丛书，不知多少个日日夜夜沉溺其中而感伤感动不已，进而期待自己的爱情；工作几年至今，更多是偏爱纪实历史类的书籍还有不少作者的随笔散文，我是看书特投入的人，经常被感动流泪，如今亦是，早些年间看明晓溪《泡沫之夏》哭了，看饶雪漫《离开》哭了，看读者小文哭了，后来看余华《活着》哭了，看路遥《平凡的世界》和《人生》更是哭的稀里糊涂，当然也会笑；人只要能被伤害或感动就是好的。我看的很感动，但是书评就是写不好，分享给朋友的时候多数都看不上眼，所以后来自己写了也不敢给别人看。</p>\n<p>关于听歌，我是一个挺臭屁的人，曾经说过：不要问我为什么这么会装B，因为我听歌只听宋冬野；后来当我喜欢上逼哥，好妹妹，赵雷，我再也不敢这么说话了。当然我听歌喜欢听民谣，朋友说你不懂民谣，民谣一定要到小地方听到得才算好的，我这只能算城市民谣，所以，我听歌喜欢听城市民谣，生活在水泥钢筋的城市里有着一颗不安定的心；另一个朋友说，他不喜欢民谣，因为民谣里的爱情做爱都买不起避孕套，容易出事儿，我觉得他说的很对，总结的很地道，但是我没有女朋友，随着时间的推移，人在变老变丑，有女朋友的几率会更小，用不到避孕套；所以，我听歌喜欢听做爱买不起避孕套的城市民谣。</p>\n<p>关于鬼畜，这个是我的最爱毋庸置疑，三个时间段会一直爱下去，就像爱姑娘一样，我爱她们青葱的小手和大白的奶子，我也爱鬼畜的污污污，爱丞相和王朗，爱天朝第一歌姬，爱天朝第一英文歌姬，爱女孩为什么穿短裙。世间恐怕没多少比这个更好地事情了，因为真的很开心，没心没肺的开心，我喜欢听，哎呦，不错哦，好像周杰伦翻唱过这首龙卷基。<a href=\"http://www.bilibili.com/video/av4172954/\">Link</a></p>\n<p>关于我，我是一个小人物，有着平凡的喜怒哀乐，出身平凡之家没什么好谈的，家人身体安康、和睦相处已是万分幸福了。我不喜欢有些人把自己的惰性归咎于出身，诚然，你没法让自己做到最好，但是最起码你要努力让自己变得更好；我永远相信，当面包掉在地上奶酪一定是朝上的。莱蒙托夫有首诗《一只船》这样写：一只船孤独地航行在海上，它既不寻求幸福，也不逃避幸福，它只是向前航行，底下是沉静碧蓝的大海，而头顶是金色的太阳。我努力工作，努力过好自己的人生，不盲目自大，不自暴自弃，我可能究其一生也不达到我想要的生活，甚至绝大情况会比我想象的要糟糕，但是我会努力去做好自己的，做自己想做的在每一天，挥洒青春，尽量犯错。关于爱情和姑娘话题，永远都说不完啊，我喜欢美好的姑娘，但是我不是见一个喜欢一个，我会在很长的一段时间里喜欢一个人，尽管多数是不会有结果。我喜欢的姑娘，我希望我可以像太阳一样，给你温暖，橡树一样成为你的依靠，你应该怀疑，你也可以拒绝，但是我也会像太阳一样周而复始，像树一样扎根于此，你要知道树一旦落地生根，再拔起来可是要命的事情了。</p>\n<p>晚安，这个世界和我和你和他们。</p>\n"},{"title":"每日备份MySQL单表数据","id":"130","updated":"2017-04-21T05:17:04.000Z","date":"2017-01-15T00:12:55.000Z","_content":"\n最近愈近年底，客户业务涉及对账操作，所以同事提出需求需要单独备份某张表数据，并且每日备份；思考之后解决办法如下：\n\n1. mysqldump导出单张表的表结构及数据\n2. 新增数据库，专做临时每日数据备份库\n3. 导入该表数据到新增数据库内\n4. 重命名导入的表名（预防计划任务下次导入时数据覆盖）\n5. 编写脚本，添加Linux计划任务\n\n\n\n#### 1. mysqldump导出但张表的表结构及数据\n\n```\nmysqldump -h dbServer -PdbServerPort -u db_user -p -d dbName tbName > tbName.sql\n```\n\n\n\n#### 2. 新增数据库，专做临时每日数据备份库\n\n```\n# loginTo your DBserver\nmysql> create database bakdbName character set utf8;\n```\n\n\n\n#### 3. 导入该表数据到新增数据库内\n\n```\nmysql -h dbServer -P dbServerPort -u db_user -p bakdbName < tbName.sql\n```\n\n\n\n#### 4 . 重命名导入的表名\n\n```\nmysql -u db_user -p -e \"rename table bakdbName.tbName to bakdbName.tbName_$DATE\"\n```\n\n\n\n#### 5. 编写脚本\n\n\n\n```\n[root@testServer01 ~]# cat /usr/local/bin/bakTable.sh\n#!/bin/bash\n\n#Create by SAMZONG\n\nDATE=`date +%Y%m%d`\nTMPDIR=/tmp/baksql\n\n# modify your DB configure\nDBSERVER1=localhost\nDBSERVER1_PORT=3306\nDBSERVER1_USER=root\nDBSERVER1_PASSWORD=password\nMASTER_DBNAME=zabbix\nMASTER_TBNAME=users\n\nDBSERVER2=localhost\nDBSERVER2_PORT=3306\nDBSERVER2_USER=root\nDBSERVER2_PASSWORD=password\nBAKDBNAME=z3\n\n# creat tmp folder\nif [ ! -d $TMPDIR ]; then\n\tmkdir $TMPDIR\nfi\n\n# dump tbName\nmysqldump -h $DBSERVER1 -P $DBSERVER1_PORT -u $DBSERVER1_USER -p\"$DBSERVER1_PASSWORD\" -d $MASTER_DBNAME  $MASTER_TBNAME > $TMPDIR/$MASTER_TBNAME.sql\n\n\n# insert tbNAME to bakdbName\nif [ $? -eq 0  ]; then\n\tmysql -h $DBSERVER2 -P $DBSERVER2_PORT -u $DBSERVER2_USER -p\"$DBSERVER2_PASSWORD\" $BAKDBNAME < $TMPDIR/$MASTER_TBNAME.sql\n\n\tif [ $? -eq 0 ]; then\n\t\t# rename tbName\n\t\tmysql -h $DBSERVER2 -P $DBSERVER2_PORT -u $DBSERVER2_USER -p\"$DBSERVER2_PASSWORD\" -e \"rename table \"$BAKDBNAME\".\"$MASTER_TBNAME\" to \"$BAKDBNAME\".\"$MASTER_TBNAME\"_\"$DATE\";\"\n\tfi\n\nfi\n```\n\n\n\n#### 6. 添加到Linux计划任务\n\n```\n00 00 * * * /usr/local/bin/bakTable.sh\n```\n\n","source":"_posts/每日备份MySQL单表数据.md","raw":"---\ntitle: 每日备份MySQL单表数据\ntags: 'MySQL'\ncategories: 'MySQL'\npermalink: sdertfvdsrt\nid: 130\nupdated: '2017-04-21 13:17:04'\ndate: 2017-01-15 08:12:55\n---\n\n最近愈近年底，客户业务涉及对账操作，所以同事提出需求需要单独备份某张表数据，并且每日备份；思考之后解决办法如下：\n\n1. mysqldump导出单张表的表结构及数据\n2. 新增数据库，专做临时每日数据备份库\n3. 导入该表数据到新增数据库内\n4. 重命名导入的表名（预防计划任务下次导入时数据覆盖）\n5. 编写脚本，添加Linux计划任务\n\n\n\n#### 1. mysqldump导出但张表的表结构及数据\n\n```\nmysqldump -h dbServer -PdbServerPort -u db_user -p -d dbName tbName > tbName.sql\n```\n\n\n\n#### 2. 新增数据库，专做临时每日数据备份库\n\n```\n# loginTo your DBserver\nmysql> create database bakdbName character set utf8;\n```\n\n\n\n#### 3. 导入该表数据到新增数据库内\n\n```\nmysql -h dbServer -P dbServerPort -u db_user -p bakdbName < tbName.sql\n```\n\n\n\n#### 4 . 重命名导入的表名\n\n```\nmysql -u db_user -p -e \"rename table bakdbName.tbName to bakdbName.tbName_$DATE\"\n```\n\n\n\n#### 5. 编写脚本\n\n\n\n```\n[root@testServer01 ~]# cat /usr/local/bin/bakTable.sh\n#!/bin/bash\n\n#Create by SAMZONG\n\nDATE=`date +%Y%m%d`\nTMPDIR=/tmp/baksql\n\n# modify your DB configure\nDBSERVER1=localhost\nDBSERVER1_PORT=3306\nDBSERVER1_USER=root\nDBSERVER1_PASSWORD=password\nMASTER_DBNAME=zabbix\nMASTER_TBNAME=users\n\nDBSERVER2=localhost\nDBSERVER2_PORT=3306\nDBSERVER2_USER=root\nDBSERVER2_PASSWORD=password\nBAKDBNAME=z3\n\n# creat tmp folder\nif [ ! -d $TMPDIR ]; then\n\tmkdir $TMPDIR\nfi\n\n# dump tbName\nmysqldump -h $DBSERVER1 -P $DBSERVER1_PORT -u $DBSERVER1_USER -p\"$DBSERVER1_PASSWORD\" -d $MASTER_DBNAME  $MASTER_TBNAME > $TMPDIR/$MASTER_TBNAME.sql\n\n\n# insert tbNAME to bakdbName\nif [ $? -eq 0  ]; then\n\tmysql -h $DBSERVER2 -P $DBSERVER2_PORT -u $DBSERVER2_USER -p\"$DBSERVER2_PASSWORD\" $BAKDBNAME < $TMPDIR/$MASTER_TBNAME.sql\n\n\tif [ $? -eq 0 ]; then\n\t\t# rename tbName\n\t\tmysql -h $DBSERVER2 -P $DBSERVER2_PORT -u $DBSERVER2_USER -p\"$DBSERVER2_PASSWORD\" -e \"rename table \"$BAKDBNAME\".\"$MASTER_TBNAME\" to \"$BAKDBNAME\".\"$MASTER_TBNAME\"_\"$DATE\";\"\n\tfi\n\nfi\n```\n\n\n\n#### 6. 添加到Linux计划任务\n\n```\n00 00 * * * /usr/local/bin/bakTable.sh\n```\n\n","slug":"sdertfvdsrt","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqeo008s41tpyfwlhajh","content":"<p>最近愈近年底，客户业务涉及对账操作，所以同事提出需求需要单独备份某张表数据，并且每日备份；思考之后解决办法如下：</p>\n<ol>\n<li>mysqldump导出单张表的表结构及数据</li>\n<li>新增数据库，专做临时每日数据备份库</li>\n<li>导入该表数据到新增数据库内</li>\n<li>重命名导入的表名（预防计划任务下次导入时数据覆盖）</li>\n<li>编写脚本，添加Linux计划任务</li>\n</ol>\n<h4 id=\"1-mysqldump导出但张表的表结构及数据\"><a href=\"#1-mysqldump导出但张表的表结构及数据\" class=\"headerlink\" title=\"1. mysqldump导出但张表的表结构及数据\"></a>1. mysqldump导出但张表的表结构及数据</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump -h dbServer -PdbServerPort -u db_user -p -d dbName tbName &gt; tbName.sql</div></pre></td></tr></table></figure>\n<h4 id=\"2-新增数据库，专做临时每日数据备份库\"><a href=\"#2-新增数据库，专做临时每日数据备份库\" class=\"headerlink\" title=\"2. 新增数据库，专做临时每日数据备份库\"></a>2. 新增数据库，专做临时每日数据备份库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># loginTo your DBserver</div><div class=\"line\">mysql&gt; create database bakdbName character set utf8;</div></pre></td></tr></table></figure>\n<h4 id=\"3-导入该表数据到新增数据库内\"><a href=\"#3-导入该表数据到新增数据库内\" class=\"headerlink\" title=\"3. 导入该表数据到新增数据库内\"></a>3. 导入该表数据到新增数据库内</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -h dbServer -P dbServerPort -u db_user -p bakdbName &lt; tbName.sql</div></pre></td></tr></table></figure>\n<h4 id=\"4-重命名导入的表名\"><a href=\"#4-重命名导入的表名\" class=\"headerlink\" title=\"4 . 重命名导入的表名\"></a>4 . 重命名导入的表名</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -u db_user -p -e &quot;rename table bakdbName.tbName to bakdbName.tbName_$DATE&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"5-编写脚本\"><a href=\"#5-编写脚本\" class=\"headerlink\" title=\"5. 编写脚本\"></a>5. 编写脚本</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@testServer01 ~]# cat /usr/local/bin/bakTable.sh</div><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">#Create by SAMZONG</div><div class=\"line\"></div><div class=\"line\">DATE=`date +%Y%m%d`</div><div class=\"line\">TMPDIR=/tmp/baksql</div><div class=\"line\"></div><div class=\"line\"># modify your DB configure</div><div class=\"line\">DBSERVER1=localhost</div><div class=\"line\">DBSERVER1_PORT=3306</div><div class=\"line\">DBSERVER1_USER=root</div><div class=\"line\">DBSERVER1_PASSWORD=password</div><div class=\"line\">MASTER_DBNAME=zabbix</div><div class=\"line\">MASTER_TBNAME=users</div><div class=\"line\"></div><div class=\"line\">DBSERVER2=localhost</div><div class=\"line\">DBSERVER2_PORT=3306</div><div class=\"line\">DBSERVER2_USER=root</div><div class=\"line\">DBSERVER2_PASSWORD=password</div><div class=\"line\">BAKDBNAME=z3</div><div class=\"line\"></div><div class=\"line\"># creat tmp folder</div><div class=\"line\">if [ ! -d $TMPDIR ]; then</div><div class=\"line\">\tmkdir $TMPDIR</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\"># dump tbName</div><div class=\"line\">mysqldump -h $DBSERVER1 -P $DBSERVER1_PORT -u $DBSERVER1_USER -p&quot;$DBSERVER1_PASSWORD&quot; -d $MASTER_DBNAME  $MASTER_TBNAME &gt; $TMPDIR/$MASTER_TBNAME.sql</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># insert tbNAME to bakdbName</div><div class=\"line\">if [ $? -eq 0  ]; then</div><div class=\"line\">\tmysql -h $DBSERVER2 -P $DBSERVER2_PORT -u $DBSERVER2_USER -p&quot;$DBSERVER2_PASSWORD&quot; $BAKDBNAME &lt; $TMPDIR/$MASTER_TBNAME.sql</div><div class=\"line\"></div><div class=\"line\">\tif [ $? -eq 0 ]; then</div><div class=\"line\">\t\t# rename tbName</div><div class=\"line\">\t\tmysql -h $DBSERVER2 -P $DBSERVER2_PORT -u $DBSERVER2_USER -p&quot;$DBSERVER2_PASSWORD&quot; -e &quot;rename table &quot;$BAKDBNAME&quot;.&quot;$MASTER_TBNAME&quot; to &quot;$BAKDBNAME&quot;.&quot;$MASTER_TBNAME&quot;_&quot;$DATE&quot;;&quot;</div><div class=\"line\">\tfi</div><div class=\"line\"></div><div class=\"line\">fi</div></pre></td></tr></table></figure>\n<h4 id=\"6-添加到Linux计划任务\"><a href=\"#6-添加到Linux计划任务\" class=\"headerlink\" title=\"6. 添加到Linux计划任务\"></a>6. 添加到Linux计划任务</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">00 00 * * * /usr/local/bin/bakTable.sh</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>最近愈近年底，客户业务涉及对账操作，所以同事提出需求需要单独备份某张表数据，并且每日备份；思考之后解决办法如下：</p>\n<ol>\n<li>mysqldump导出单张表的表结构及数据</li>\n<li>新增数据库，专做临时每日数据备份库</li>\n<li>导入该表数据到新增数据库内</li>\n<li>重命名导入的表名（预防计划任务下次导入时数据覆盖）</li>\n<li>编写脚本，添加Linux计划任务</li>\n</ol>\n<h4 id=\"1-mysqldump导出但张表的表结构及数据\"><a href=\"#1-mysqldump导出但张表的表结构及数据\" class=\"headerlink\" title=\"1. mysqldump导出但张表的表结构及数据\"></a>1. mysqldump导出但张表的表结构及数据</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqldump -h dbServer -PdbServerPort -u db_user -p -d dbName tbName &gt; tbName.sql</div></pre></td></tr></table></figure>\n<h4 id=\"2-新增数据库，专做临时每日数据备份库\"><a href=\"#2-新增数据库，专做临时每日数据备份库\" class=\"headerlink\" title=\"2. 新增数据库，专做临时每日数据备份库\"></a>2. 新增数据库，专做临时每日数据备份库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># loginTo your DBserver</div><div class=\"line\">mysql&gt; create database bakdbName character set utf8;</div></pre></td></tr></table></figure>\n<h4 id=\"3-导入该表数据到新增数据库内\"><a href=\"#3-导入该表数据到新增数据库内\" class=\"headerlink\" title=\"3. 导入该表数据到新增数据库内\"></a>3. 导入该表数据到新增数据库内</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -h dbServer -P dbServerPort -u db_user -p bakdbName &lt; tbName.sql</div></pre></td></tr></table></figure>\n<h4 id=\"4-重命名导入的表名\"><a href=\"#4-重命名导入的表名\" class=\"headerlink\" title=\"4 . 重命名导入的表名\"></a>4 . 重命名导入的表名</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql -u db_user -p -e &quot;rename table bakdbName.tbName to bakdbName.tbName_$DATE&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"5-编写脚本\"><a href=\"#5-编写脚本\" class=\"headerlink\" title=\"5. 编写脚本\"></a>5. 编写脚本</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@testServer01 ~]# cat /usr/local/bin/bakTable.sh</div><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">#Create by SAMZONG</div><div class=\"line\"></div><div class=\"line\">DATE=`date +%Y%m%d`</div><div class=\"line\">TMPDIR=/tmp/baksql</div><div class=\"line\"></div><div class=\"line\"># modify your DB configure</div><div class=\"line\">DBSERVER1=localhost</div><div class=\"line\">DBSERVER1_PORT=3306</div><div class=\"line\">DBSERVER1_USER=root</div><div class=\"line\">DBSERVER1_PASSWORD=password</div><div class=\"line\">MASTER_DBNAME=zabbix</div><div class=\"line\">MASTER_TBNAME=users</div><div class=\"line\"></div><div class=\"line\">DBSERVER2=localhost</div><div class=\"line\">DBSERVER2_PORT=3306</div><div class=\"line\">DBSERVER2_USER=root</div><div class=\"line\">DBSERVER2_PASSWORD=password</div><div class=\"line\">BAKDBNAME=z3</div><div class=\"line\"></div><div class=\"line\"># creat tmp folder</div><div class=\"line\">if [ ! -d $TMPDIR ]; then</div><div class=\"line\">\tmkdir $TMPDIR</div><div class=\"line\">fi</div><div class=\"line\"></div><div class=\"line\"># dump tbName</div><div class=\"line\">mysqldump -h $DBSERVER1 -P $DBSERVER1_PORT -u $DBSERVER1_USER -p&quot;$DBSERVER1_PASSWORD&quot; -d $MASTER_DBNAME  $MASTER_TBNAME &gt; $TMPDIR/$MASTER_TBNAME.sql</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># insert tbNAME to bakdbName</div><div class=\"line\">if [ $? -eq 0  ]; then</div><div class=\"line\">\tmysql -h $DBSERVER2 -P $DBSERVER2_PORT -u $DBSERVER2_USER -p&quot;$DBSERVER2_PASSWORD&quot; $BAKDBNAME &lt; $TMPDIR/$MASTER_TBNAME.sql</div><div class=\"line\"></div><div class=\"line\">\tif [ $? -eq 0 ]; then</div><div class=\"line\">\t\t# rename tbName</div><div class=\"line\">\t\tmysql -h $DBSERVER2 -P $DBSERVER2_PORT -u $DBSERVER2_USER -p&quot;$DBSERVER2_PASSWORD&quot; -e &quot;rename table &quot;$BAKDBNAME&quot;.&quot;$MASTER_TBNAME&quot; to &quot;$BAKDBNAME&quot;.&quot;$MASTER_TBNAME&quot;_&quot;$DATE&quot;;&quot;</div><div class=\"line\">\tfi</div><div class=\"line\"></div><div class=\"line\">fi</div></pre></td></tr></table></figure>\n<h4 id=\"6-添加到Linux计划任务\"><a href=\"#6-添加到Linux计划任务\" class=\"headerlink\" title=\"6. 添加到Linux计划任务\"></a>6. 添加到Linux计划任务</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">00 00 * * * /usr/local/bin/bakTable.sh</div></pre></td></tr></table></figure>\n"},{"title":"民谣是生","id":"10014","date":"2015-06-03T16:34:54.000Z","_content":"\n\n民谣是生，摇滚是死，而我在其中穿梭，生不如死。\n\n我来到这个世界23年，吃过屎，也吃过佳肴，我吹的牛像我，我装的b也像我，但是都不成功遭了雷劈，恍惚觉得，我不应该来到这个世界，这个世界也不是我以为的世界。\n\n我喜欢写诗，就像嗜酒者渴望所有醇香的美酒和女人的奶，我喝过，有酒味；我说：这个是社会会写诗的人不多了，会写诗的又写的比我好的又少了，写的比我好还比我会装逼的那就更少了；我又说：这世界上诗比我写的好比我会装逼，还让我敬佩的人，顾城算一个，海子也算一个，但是他们都死了，所以，我很寂寞。\n\n我喜欢女人，喜欢她们的青葱小手和大白奶子，但是，我更喜欢她们的回眸一笑，沧海沉浮而芳亭傲立，我想我要左手提剑，右手抱着我的女人，对她说：等我前去披荆斩棘，杀得前路朗朗清清，脚踏七彩祥云，带着一身荣光，我就回来娶你，等我。\n\n于是，我心中有火，头上有光，杀佛杀魔，傲立在华山绝巅。我从不把仇人放在眼里，因为，我说我的眼里只有你。但是，这次我的敌人耍懒，他们不用剑用刀，三个人来向我寻仇，我费尽力气杀胜了他们，却跌落山谷。被一个少年救起，我说：少年，给我口水喝吧，少年递过水囊，却把剑插进了我的胸膛，我说为什么？少年说：你是坏人，那为什么救我？我母亲让我来救你，说完，拔出剑，眼神冷漠，像极少年的我。\n\n+\n\n然后，我死了，我的女人等不了我，我死在无名的臭水沟，身体和灵魂一起腐烂。\n","source":"_posts/民谣是生.md","raw":"---\ntitle: 民谣是生\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: music-xiami\nid: 10014\ndate: 2015-06-04 00:34:54\n---\n\n\n民谣是生，摇滚是死，而我在其中穿梭，生不如死。\n\n我来到这个世界23年，吃过屎，也吃过佳肴，我吹的牛像我，我装的b也像我，但是都不成功遭了雷劈，恍惚觉得，我不应该来到这个世界，这个世界也不是我以为的世界。\n\n我喜欢写诗，就像嗜酒者渴望所有醇香的美酒和女人的奶，我喝过，有酒味；我说：这个是社会会写诗的人不多了，会写诗的又写的比我好的又少了，写的比我好还比我会装逼的那就更少了；我又说：这世界上诗比我写的好比我会装逼，还让我敬佩的人，顾城算一个，海子也算一个，但是他们都死了，所以，我很寂寞。\n\n我喜欢女人，喜欢她们的青葱小手和大白奶子，但是，我更喜欢她们的回眸一笑，沧海沉浮而芳亭傲立，我想我要左手提剑，右手抱着我的女人，对她说：等我前去披荆斩棘，杀得前路朗朗清清，脚踏七彩祥云，带着一身荣光，我就回来娶你，等我。\n\n于是，我心中有火，头上有光，杀佛杀魔，傲立在华山绝巅。我从不把仇人放在眼里，因为，我说我的眼里只有你。但是，这次我的敌人耍懒，他们不用剑用刀，三个人来向我寻仇，我费尽力气杀胜了他们，却跌落山谷。被一个少年救起，我说：少年，给我口水喝吧，少年递过水囊，却把剑插进了我的胸膛，我说为什么？少年说：你是坏人，那为什么救我？我母亲让我来救你，说完，拔出剑，眼神冷漠，像极少年的我。\n\n+\n\n然后，我死了，我的女人等不了我，我死在无名的臭水沟，身体和灵魂一起腐烂。\n","slug":"music-xiami","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqer008w41tpqgdxq9bu","content":"<p>民谣是生，摇滚是死，而我在其中穿梭，生不如死。</p>\n<p>我来到这个世界23年，吃过屎，也吃过佳肴，我吹的牛像我，我装的b也像我，但是都不成功遭了雷劈，恍惚觉得，我不应该来到这个世界，这个世界也不是我以为的世界。</p>\n<p>我喜欢写诗，就像嗜酒者渴望所有醇香的美酒和女人的奶，我喝过，有酒味；我说：这个是社会会写诗的人不多了，会写诗的又写的比我好的又少了，写的比我好还比我会装逼的那就更少了；我又说：这世界上诗比我写的好比我会装逼，还让我敬佩的人，顾城算一个，海子也算一个，但是他们都死了，所以，我很寂寞。</p>\n<p>我喜欢女人，喜欢她们的青葱小手和大白奶子，但是，我更喜欢她们的回眸一笑，沧海沉浮而芳亭傲立，我想我要左手提剑，右手抱着我的女人，对她说：等我前去披荆斩棘，杀得前路朗朗清清，脚踏七彩祥云，带着一身荣光，我就回来娶你，等我。</p>\n<p>于是，我心中有火，头上有光，杀佛杀魔，傲立在华山绝巅。我从不把仇人放在眼里，因为，我说我的眼里只有你。但是，这次我的敌人耍懒，他们不用剑用刀，三个人来向我寻仇，我费尽力气杀胜了他们，却跌落山谷。被一个少年救起，我说：少年，给我口水喝吧，少年递过水囊，却把剑插进了我的胸膛，我说为什么？少年说：你是坏人，那为什么救我？我母亲让我来救你，说完，拔出剑，眼神冷漠，像极少年的我。</p>\n<p>+</p>\n<p>然后，我死了，我的女人等不了我，我死在无名的臭水沟，身体和灵魂一起腐烂。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>民谣是生，摇滚是死，而我在其中穿梭，生不如死。</p>\n<p>我来到这个世界23年，吃过屎，也吃过佳肴，我吹的牛像我，我装的b也像我，但是都不成功遭了雷劈，恍惚觉得，我不应该来到这个世界，这个世界也不是我以为的世界。</p>\n<p>我喜欢写诗，就像嗜酒者渴望所有醇香的美酒和女人的奶，我喝过，有酒味；我说：这个是社会会写诗的人不多了，会写诗的又写的比我好的又少了，写的比我好还比我会装逼的那就更少了；我又说：这世界上诗比我写的好比我会装逼，还让我敬佩的人，顾城算一个，海子也算一个，但是他们都死了，所以，我很寂寞。</p>\n<p>我喜欢女人，喜欢她们的青葱小手和大白奶子，但是，我更喜欢她们的回眸一笑，沧海沉浮而芳亭傲立，我想我要左手提剑，右手抱着我的女人，对她说：等我前去披荆斩棘，杀得前路朗朗清清，脚踏七彩祥云，带着一身荣光，我就回来娶你，等我。</p>\n<p>于是，我心中有火，头上有光，杀佛杀魔，傲立在华山绝巅。我从不把仇人放在眼里，因为，我说我的眼里只有你。但是，这次我的敌人耍懒，他们不用剑用刀，三个人来向我寻仇，我费尽力气杀胜了他们，却跌落山谷。被一个少年救起，我说：少年，给我口水喝吧，少年递过水囊，却把剑插进了我的胸膛，我说为什么？少年说：你是坏人，那为什么救我？我母亲让我来救你，说完，拔出剑，眼神冷漠，像极少年的我。</p>\n<p>+</p>\n<p>然后，我死了，我的女人等不了我，我死在无名的臭水沟，身体和灵魂一起腐烂。</p>\n"},{"title":"爱与痛的边缘","id":"10015","date":"2012-07-29T16:34:54.000Z","_content":"\n\n--by 双子丶林夕\n\n从十七岁那个阳光明媚的早晨\n街角的书店，这本书出现在我的眼中\n记忆的碎片在散索地提醒我\n如今，二十岁已然临近了\n许是差不多四年的时光\n伴随了我人生的转折\n在这个日子，也算是对曾经的一个句点\n最后一句台词已然结束\n接下来\n便是另起一行，开始新的篇章\n过去了那个如诗的青春\n但，请不要放弃心中的血热和理想\n\n--索然是了无情趣地读着，闲暇之余，便以此忆起往昔的光景，离时留存下些许散碎的文字。\n\n两年前的文字，生涩，那是一段很长时间不读书的日子，初中时期遇到它，或是少人陪的时候它出现在我的生命中，年少不知愁滋味，为赋新词强说愁，寂寞的时候翻起这本书，内心便能平静下来，无怨言地面对堆积如山的习题挑灯夜战，是那个时候最话少，是那个时候最沉默，是那个时候最自信，有点孤傲，眼神灼灼生辉，那是人生最安静如歌的时光，那是多年一直怀念的时候，我一直想再回到那种状态，我以为拥有同样的这本书便能回到那段时光，同一版，同样的封面，同一个位置，写下了同样的话，可那段时间却不再回来；那段时间，那样懵懂的思念一个人，没有手机，没有QQ，只是在无数思念的时候一遍又一遍写下她的名字，写下我的思念，都慢慢汇成一首首诗，那个时候的木泽，那个时候的流云复苏，还有一只留着的无宇枫，整整两年的时间，写满了三大本的诗和文章，字里行间流淌着你的名字，拿起来都会问到油墨的清香，我闻到那个人微笑的眼睛，我想要问为什么在哪之后人生还一直喜欢你，我想是我人生最安静的那段时光，如歌的青春，把所有的思念都给你了，把你的名字雕刻在我的生命里，怪只怪你那时微笑太美。\n\n我想多年后，我也会翻起这段文字，我也会怀念那时生涩的文笔，怀念那个眼神灼灼生辉的少年，怀念那个微笑太美的你，或许我会为你写一首歌吧，把你写进去，把最好的我也写进去，写阳光璀璨如歌的你，写每个夜晚眼神明亮的我，对了，还有那个皎洁的月光，你说你最喜欢它了，谢谢那段时光它为我向你送去思念，歌名都想好了，就叫：青春是一道明媚的忧伤。Hey 姑娘，如果我不能爱你，那就让我把他铺成曲，在你的婚礼上，用永远走调的歌声唱给你听，或许我会流泪，但那时你一定要微笑，哪些眼泪一辈子只会有一次，都是给你的祝福，如果我爱你，我愿意用一生为你歌唱，待到头发花白牙齿掉光，我们一起再回头看看阳光中盛开的你的我的青春，执子之手，与子偕老。\n\n> 补档感言：最终我没铺成曲，也没去参加你的婚礼，童话毕竟是童话，继续觉得自己傻逼。\n","source":"_posts/爱与痛的边缘.md","raw":"---\ntitle: 爱与痛的边缘\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: ai-you-tong-de-bian-yuan\nid: 10015\ndate: 2012-07-30 00:34:54\n---\n\n\n--by 双子丶林夕\n\n从十七岁那个阳光明媚的早晨\n街角的书店，这本书出现在我的眼中\n记忆的碎片在散索地提醒我\n如今，二十岁已然临近了\n许是差不多四年的时光\n伴随了我人生的转折\n在这个日子，也算是对曾经的一个句点\n最后一句台词已然结束\n接下来\n便是另起一行，开始新的篇章\n过去了那个如诗的青春\n但，请不要放弃心中的血热和理想\n\n--索然是了无情趣地读着，闲暇之余，便以此忆起往昔的光景，离时留存下些许散碎的文字。\n\n两年前的文字，生涩，那是一段很长时间不读书的日子，初中时期遇到它，或是少人陪的时候它出现在我的生命中，年少不知愁滋味，为赋新词强说愁，寂寞的时候翻起这本书，内心便能平静下来，无怨言地面对堆积如山的习题挑灯夜战，是那个时候最话少，是那个时候最沉默，是那个时候最自信，有点孤傲，眼神灼灼生辉，那是人生最安静如歌的时光，那是多年一直怀念的时候，我一直想再回到那种状态，我以为拥有同样的这本书便能回到那段时光，同一版，同样的封面，同一个位置，写下了同样的话，可那段时间却不再回来；那段时间，那样懵懂的思念一个人，没有手机，没有QQ，只是在无数思念的时候一遍又一遍写下她的名字，写下我的思念，都慢慢汇成一首首诗，那个时候的木泽，那个时候的流云复苏，还有一只留着的无宇枫，整整两年的时间，写满了三大本的诗和文章，字里行间流淌着你的名字，拿起来都会问到油墨的清香，我闻到那个人微笑的眼睛，我想要问为什么在哪之后人生还一直喜欢你，我想是我人生最安静的那段时光，如歌的青春，把所有的思念都给你了，把你的名字雕刻在我的生命里，怪只怪你那时微笑太美。\n\n我想多年后，我也会翻起这段文字，我也会怀念那时生涩的文笔，怀念那个眼神灼灼生辉的少年，怀念那个微笑太美的你，或许我会为你写一首歌吧，把你写进去，把最好的我也写进去，写阳光璀璨如歌的你，写每个夜晚眼神明亮的我，对了，还有那个皎洁的月光，你说你最喜欢它了，谢谢那段时光它为我向你送去思念，歌名都想好了，就叫：青春是一道明媚的忧伤。Hey 姑娘，如果我不能爱你，那就让我把他铺成曲，在你的婚礼上，用永远走调的歌声唱给你听，或许我会流泪，但那时你一定要微笑，哪些眼泪一辈子只会有一次，都是给你的祝福，如果我爱你，我愿意用一生为你歌唱，待到头发花白牙齿掉光，我们一起再回头看看阳光中盛开的你的我的青春，执子之手，与子偕老。\n\n> 补档感言：最终我没铺成曲，也没去参加你的婚礼，童话毕竟是童话，继续觉得自己傻逼。\n","slug":"ai-you-tong-de-bian-yuan","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqet008z41tp0c6wrjp6","content":"<p>–by 双子丶林夕</p>\n<p>从十七岁那个阳光明媚的早晨<br>街角的书店，这本书出现在我的眼中<br>记忆的碎片在散索地提醒我<br>如今，二十岁已然临近了<br>许是差不多四年的时光<br>伴随了我人生的转折<br>在这个日子，也算是对曾经的一个句点<br>最后一句台词已然结束<br>接下来<br>便是另起一行，开始新的篇章<br>过去了那个如诗的青春<br>但，请不要放弃心中的血热和理想</p>\n<p>–索然是了无情趣地读着，闲暇之余，便以此忆起往昔的光景，离时留存下些许散碎的文字。</p>\n<p>两年前的文字，生涩，那是一段很长时间不读书的日子，初中时期遇到它，或是少人陪的时候它出现在我的生命中，年少不知愁滋味，为赋新词强说愁，寂寞的时候翻起这本书，内心便能平静下来，无怨言地面对堆积如山的习题挑灯夜战，是那个时候最话少，是那个时候最沉默，是那个时候最自信，有点孤傲，眼神灼灼生辉，那是人生最安静如歌的时光，那是多年一直怀念的时候，我一直想再回到那种状态，我以为拥有同样的这本书便能回到那段时光，同一版，同样的封面，同一个位置，写下了同样的话，可那段时间却不再回来；那段时间，那样懵懂的思念一个人，没有手机，没有QQ，只是在无数思念的时候一遍又一遍写下她的名字，写下我的思念，都慢慢汇成一首首诗，那个时候的木泽，那个时候的流云复苏，还有一只留着的无宇枫，整整两年的时间，写满了三大本的诗和文章，字里行间流淌着你的名字，拿起来都会问到油墨的清香，我闻到那个人微笑的眼睛，我想要问为什么在哪之后人生还一直喜欢你，我想是我人生最安静的那段时光，如歌的青春，把所有的思念都给你了，把你的名字雕刻在我的生命里，怪只怪你那时微笑太美。</p>\n<p>我想多年后，我也会翻起这段文字，我也会怀念那时生涩的文笔，怀念那个眼神灼灼生辉的少年，怀念那个微笑太美的你，或许我会为你写一首歌吧，把你写进去，把最好的我也写进去，写阳光璀璨如歌的你，写每个夜晚眼神明亮的我，对了，还有那个皎洁的月光，你说你最喜欢它了，谢谢那段时光它为我向你送去思念，歌名都想好了，就叫：青春是一道明媚的忧伤。Hey 姑娘，如果我不能爱你，那就让我把他铺成曲，在你的婚礼上，用永远走调的歌声唱给你听，或许我会流泪，但那时你一定要微笑，哪些眼泪一辈子只会有一次，都是给你的祝福，如果我爱你，我愿意用一生为你歌唱，待到头发花白牙齿掉光，我们一起再回头看看阳光中盛开的你的我的青春，执子之手，与子偕老。</p>\n<blockquote>\n<p>补档感言：最终我没铺成曲，也没去参加你的婚礼，童话毕竟是童话，继续觉得自己傻逼。</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p>–by 双子丶林夕</p>\n<p>从十七岁那个阳光明媚的早晨<br>街角的书店，这本书出现在我的眼中<br>记忆的碎片在散索地提醒我<br>如今，二十岁已然临近了<br>许是差不多四年的时光<br>伴随了我人生的转折<br>在这个日子，也算是对曾经的一个句点<br>最后一句台词已然结束<br>接下来<br>便是另起一行，开始新的篇章<br>过去了那个如诗的青春<br>但，请不要放弃心中的血热和理想</p>\n<p>–索然是了无情趣地读着，闲暇之余，便以此忆起往昔的光景，离时留存下些许散碎的文字。</p>\n<p>两年前的文字，生涩，那是一段很长时间不读书的日子，初中时期遇到它，或是少人陪的时候它出现在我的生命中，年少不知愁滋味，为赋新词强说愁，寂寞的时候翻起这本书，内心便能平静下来，无怨言地面对堆积如山的习题挑灯夜战，是那个时候最话少，是那个时候最沉默，是那个时候最自信，有点孤傲，眼神灼灼生辉，那是人生最安静如歌的时光，那是多年一直怀念的时候，我一直想再回到那种状态，我以为拥有同样的这本书便能回到那段时光，同一版，同样的封面，同一个位置，写下了同样的话，可那段时间却不再回来；那段时间，那样懵懂的思念一个人，没有手机，没有QQ，只是在无数思念的时候一遍又一遍写下她的名字，写下我的思念，都慢慢汇成一首首诗，那个时候的木泽，那个时候的流云复苏，还有一只留着的无宇枫，整整两年的时间，写满了三大本的诗和文章，字里行间流淌着你的名字，拿起来都会问到油墨的清香，我闻到那个人微笑的眼睛，我想要问为什么在哪之后人生还一直喜欢你，我想是我人生最安静的那段时光，如歌的青春，把所有的思念都给你了，把你的名字雕刻在我的生命里，怪只怪你那时微笑太美。</p>\n<p>我想多年后，我也会翻起这段文字，我也会怀念那时生涩的文笔，怀念那个眼神灼灼生辉的少年，怀念那个微笑太美的你，或许我会为你写一首歌吧，把你写进去，把最好的我也写进去，写阳光璀璨如歌的你，写每个夜晚眼神明亮的我，对了，还有那个皎洁的月光，你说你最喜欢它了，谢谢那段时光它为我向你送去思念，歌名都想好了，就叫：青春是一道明媚的忧伤。Hey 姑娘，如果我不能爱你，那就让我把他铺成曲，在你的婚礼上，用永远走调的歌声唱给你听，或许我会流泪，但那时你一定要微笑，哪些眼泪一辈子只会有一次，都是给你的祝福，如果我爱你，我愿意用一生为你歌唱，待到头发花白牙齿掉光，我们一起再回头看看阳光中盛开的你的我的青春，执子之手，与子偕老。</p>\n<blockquote>\n<p>补档感言：最终我没铺成曲，也没去参加你的婚礼，童话毕竟是童话，继续觉得自己傻逼。</p>\n</blockquote>\n"},{"title":"理解 Linux 的硬链接与软链接","id":"3","updated":"2017-04-21T05:40:43.000Z","date":"2016-03-18T06:52:13.000Z","_content":"\n<h2> 从inode了解Linux文件系统</h2>\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;硬链接与软链接是 Linux 文件系统中的一个重要概念，其涉及文件系统中的索引节点 (index node 又称 inode)，而索引节点对象是 Linux 虚拟文件系统 (VFS) 的四个基本概念之一。通过剖析硬链接与软链接的联系与区别，我们可更好的了解 Linux 中 VFS 这一通用文件模型。并让 Linux 普通用户和系统管理员正确使用硬链接与软链接，帮助文件系统开发者获取 inode 的相关知识。\n\n\n<h3> Linux的文件系统与目录 </h3>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;现代操作系统为解决信息能独立于进程之外被长期存储引入了文件，文件作为进程创建信息的逻辑单元可被多个进程并发使用。在 UNIX 系统中，操作系统为磁盘上的文本与图像、鼠标与键盘等输入设备及网络交互等 I/O 操作设计了一组通用 API，使他们被处理时均可统一使用字节流方式。换言之，UNIX 系统中除进程之外的一切皆是文件，而 Linux 保持了这一特性。为了便于文件的管理，Linux 还引入了目录（有时亦被称为文件夹）这一概念。目录使文件可被分类管理，且目录的引入使 Linux 的文件系统形成一个层级结构的目录树。<a href=\"#list1\">清单1.</a>所示的是普通 Linux 系统的顶层目录结构，其中 /dev 是存放了设备相关文件的目录。\n\n <h4 id='list1'> 清单 1. Linux系统的顶层目录结构</h4>\n\n```\n /              根目录\n├── bin     存放用户二进制文件\n├── boot    存放内核引导配置文件\n├── dev     存放设备文件\n├── etc     存放系统配置文件\n├── home    用户主目录\n├── lib     动态共享库\n├── lost+found \t文件系统恢复时的恢复文件\n├── media   可卸载存储介质挂载点\n├── mnt     文件系统临时挂载点\n├── opt     附加的应用程序包\n├── proc    系统内存的映射目录，提供内核与进程信息\n├── root    root 用户主目录\n├── sbin    存放系统二进制文件\n├── srv     存放服务相关数据\n├── sys     sys 虚拟文件系统挂载点\n├── tmp     存放临时文件\n├── usr     存放用户应用程序\n└── var     存放邮件、系统日志等变化文件\n\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux 将设备当做文件进行处理，<a href=\"#list2\">清单 2.</a>展示了如何打开设备文件 /dev/input/event5 并读取文件内容。文件 event5 表示一种输入设备，其可能是鼠标或键盘等。查看文件 /proc/bus/input/devices 可知 event5 对应设备的类型。设备文件 /dev/input/event5 使用 read() 以字符流的方式被读取。结构体 input_event 被定义在内核头文件 linux/input.h 中。\n\n<h4 id='list2'> 清单 2.  打开并读取设备文件 </h4>\n\n```\n int fd;\n struct input_event ie;\n fd = open(\"/dev/input/event5\", O_RDONLY);\n read(fd, &ie, sizeof(struct input_event));\n printf(\"type = %d  code = %d  value = %d\\n\",\n\t\t\t ie.type, ie.code, ie.value);\n close(fd);\n```\n\n\n<br />\n### 硬链接与软链接的联系与区别\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们知道文件都有文件名与数据，这在 Linux 上被分成两个部分：用户数据 (user data) 与元数据 (metadata)。用户数据，即文件数据块 (data block)，数据块是记录文件真实内容的地方；而元数据则是文件的附加属性，如文件大小、创建时间、所有者等信息。在 Linux 中，元数据中的 inode 号（inode 是文件元数据的一部分但其并不包含文件名，inode 号即索引节点号）才是文件的唯一标识而非文件名。文件名仅是为了方便人们的记忆和使用，系统或程序通过 inode 号寻找正确的文件数据块。<a href=\"#p1\">图 1.</a>展示了程序通过文件名获取文件内容的过程。\n\n<h4 id=\"p1\"> 图 1. 通过文件名打开文件 </h4>\n![](http://120.24.251.209/content/images/2016/03/image001.jpg)\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在Linux 系统中查看 inode号可使用命令stat 或 ls -i（若是 AIX 系统，则使用命令 istat）。<a href=\"#list3\">清单 3.</a>中使用命令 mv 移动并重命名文件 glibc-2.16.0.tar.xz，其结果不影响文件的用户数据及 inode 号，文件移动前后 inode 号均为：2485677。\n\n<h4 id='list3'> 清单 3.  移动或重命名文件 </h4>\n```\n# stat /home/harris/source/glibc-2.16.0.tar.xz\n  File: `/home/harris/source/glibc-2.16.0.tar.xz'\n  Size: 9990512   \t Blocks: 19520      IO Block: 4096   regular file\n Device: 807h/2055d \t Inode: 2485677     Links: 1\n Access: (0600/-rw-------)  Uid: ( 1000/  harris)   Gid: ( 1000/  harris)\n ...\n ...\n// 经网友指出，使用mv移动时不跨磁盘inode号不变，如果跨磁盘inode会改变。\n # mv /home/harris/source/glibc-2.16.0.tar.xz /home/harris/Desktop/glibc.tar.xz\n # ls -i -F /home/harris/Desktop/glibc.tar.xz\n 2485677 /home/harris/Desktop/glibc.tar.xz\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为解决文件的共享使用，Linux 系统引入了两种链接：硬链接 (hard link) 与软链接（又称符号链接，即 soft link 或 symbolic link）。链接为 Linux 系统解决了文件的共享使用，还带来了隐藏文件路径、增加权限安全及节省存储等好处。若一个 inode 号对应多个文件名，则称这些文件为硬链接。换言之，硬链接就是同一个文件使用了多个别名（见 <a href=\"#p2\">图 2.</a>hard link 就是 file 的一个别名，他们有共同的 inode）。硬链接可由命令 link 或 ln 创建。如下是对文件 oldfile 创建硬链接。\n\n```\n link oldfile newfile\n ln oldfile newfile\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于硬链接是有着相同 inode 号仅文件名不同的文件，因此硬链接存在以下几点特性：\n\n* 文件有相同的 inode 及 data block；\n* 只能对已存在的文件进行创建；\n* 不能交叉文件系统进行硬链接的创建；\n* 不能对目录进行创建，只可对文件创建；\n* 删除一个硬链接文件并不影响其他有相同 inode 号的文件。\n\n<h4 id='list4'> 清单 4.  硬链接特性展示 </h4>\n\n```\n# ls -li\n total 0\n\n // 只能对已存在的文件创建硬连接\n # link old.file hard.link\n link: cannot create link `hard.link' to `old.file': No such file or directory\n\n # echo \"This is an original file\" > old.file\n # cat old.file\n This is an original file\n # stat old.file\n  File: `old.file'\n  Size: 25        \t Blocks: 8          IO Block: 4096   regular file\n Device: 807h/2055d \t Inode: 660650      Links: 2\n Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)\n ...\n // 文件有相同的 inode 号以及 data block\n # link old.file hard.link | ls -li\n total 8\n 660650 -rw-r--r-- 2 root root 25 Sep  1 17:44 hard.link\n 660650 -rw-r--r-- 2 root root 25 Sep  1 17:44 old.file\n\n // 不能交叉文件系统\n # ln /dev/input/event5 /root/bfile.txt\n ln: failed to create hard link `/root/bfile.txt' => `/dev/input/event5':\n Invalid cross-device link\n\n // 不能对目录进行创建硬连接\n # mkdir -p old.dir/test\n # ln old.dir/ hardlink.dir\n ln: `old.dir/': hard link not allowed for directory\n # ls -iF\n 660650 hard.link  657948 old.dir/  660650 old.file\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;文件 old.file 与 hard.link 有着相同的 inode 号：660650 及文件权限，inode 是随着文件的存在而存在，因此只有当文件存在时才可创建硬链接，即当 inode 存在且链接计数器（link count）不为 0 时。inode 号仅在各文件系统下是唯一的，当 Linux 挂载多个文件系统后将出现 inode 号重复的现象（如<a href=\"#list5\">清单 5.</a>所示，文件 t3.jpg、sync 及 123.txt 并无关联，却有着相同的 inode 号），因此硬链接创建时不可跨文件系统。设备文件目录 /dev 使用的文件系统是 devtmpfs，而 /root（与根目录 / 一致）使用的是磁盘文件系统 ext4。<a href=\"#list5\">清单 5.</a>展示了使用命令 df 查看当前系统中挂载的文件系统类型、各文件系统 inode 使用情况及文件系统挂载点。\n\n<h4 id='list5'> 清单 5.  查找有相同 inode 号的文件 </h4>\n```\n# df -i --print-type\n Filesystem     Type       Inodes  IUsed    IFree IUse% Mounted on\n /dev/sda7      ext4      3147760 283483  2864277   10% /\n udev           devtmpfs   496088    553   495535    1% /dev\n tmpfs          tmpfs      499006    491   498515    1% /run\n none           tmpfs      499006      3   499003    1% /run/lock\n none           tmpfs      499006     15   498991    1% /run/shm\n /dev/sda6      fuseblk  74383900   4786 74379114    1% /media/DiskE\n /dev/sda8      fuseblk  29524592  19939 29504653    1% /media/DiskF\n\n # find / -inum 1114\n /media/DiskE/Pictures/t3.jpg\n /media/DiskF/123.txt\n /bin/sync\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;值得一提的是，Linux 系统存在 inode 号被用完但磁盘空间还有剩余的情况。我们创建一个 5M 大小的 ext4 类型的 mo.img 文件，并将其挂载至目录 /mnt。然后我们使用一个 shell 脚本将挂载在 /mnt 下 ext4 文件系统的 indoe 耗尽（见<a href=\"#list6\">清单 6.</a>）。\n\n<h4 id='list6'> 清单 6.  测试文件系统 inode 耗尽但仍有磁盘空间的情景 </h4>\n\n```\n # dd if=/dev/zero of=mo.img bs=5120k count=1\n # ls -lh mo.img\n -rw-r--r-- 1 root root 5.0M Sep  1 17:54 mo.img\n # mkfs -t ext4  -F ./mo.img\n ...\n OS type: Linux\n Block size=1024 (log=0)\n Fragment size=1024 (log=0)\n Stride=0 blocks, Stripe width=0 blocks\n 1280 inodes, 5120 blocks\n 256 blocks (5.00%) reserved for the super user\n ...\n ...\n Writing superblocks and filesystem accounting information: done\n\n # mount -o loop ./mo.img /mnt\n # cat /mnt/inode_test.sh\n #!/bin/bash\n\n for ((i = 1; ; i++))\n do\n    if [ $? -eq 0 ]; then\n        echo  \"This is file_$i\" > file_$i\n    else\n        exit 0\n    fi\n done\n\n # ./inode_test.sh\n ./inode_test.sh: line 6: file_1269: No space left on device\n\n # df -iT /mnt/; du -sh /mnt/\n Filesystem     Type Inodes IUsed IFree IUse% Mounted on\n /dev/loop0     ext4   1280  1280     0  100% /mnt\n 1.3M \t /mnt/\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;硬链接不能对目录创建是受限于文件系统的设计（见 <a href=\"#list4\">清单 4.</a>对目录创建硬链接将失败）。现 Linux 文件系统中的目录均隐藏了两个个特殊的目录：当前目录（.）与父目录（..）。查看这两个特殊目录的 inode 号可知其实这两目录就是两个硬链接（注意目录 /mnt/lost+found/ 的 inode 号）。若系统允许对目录创建硬链接，则会产生目录环。\n\n```\n # ls -aliF /mnt/lost+found\n total 44\n 11 drwx------ 2 root root 12288 Sep  1 17:54 ./\n 2 drwxr-xr-x 3 root root 31744 Sep  1 17:57 ../\n\n # stat  /mnt/lost+found/\n  File: `/mnt/lost+found/'\n  Size: 12288     \t Blocks: 24         IO Block: 1024   directory\n Device: 700h/1792d \t Inode: 11          Links: 2\n Access: (0700/drwx------)  Uid: (    0/    root)   Gid: (    0/    root)\n Access: 2012-09-01 17:57:17.000000000 +0800\n Modify: 2012-09-01 17:54:49.000000000 +0800\n Change: 2012-09-01 17:54:49.000000000 +0800\n Birth: -\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;软链接与硬链接不同，若文件用户数据块中存放的内容是另一文件的路径名的指向，则该文件就是软连接。软链接就是一个普通文件，只是数据块内容有点特殊。软链接有着自己的 inode 号以及用户数据块（见 <a href=\"#p2\">图 2.</a>）。因此软链接的创建与使用没有类似硬链接的诸多限制：\n\n* 软链接有自己的文件属性及权限等；\n* 可对不存在的文件或目录创建软链接；\n* 软链接可交叉文件系统；\n* 软链接可对文件或目录创建；\n* 创建软链接时，链接计数 i_nlink 不会增加；\n* 删除软链接并不影响被指向的文件，但若被指向的原文件被删除，则相关软连接被称为死链接（即 dangling link，若被指向路径文件被重新创建，死链接可恢复为正常的软链接）。\n\n<h4 id=\"p2\">  图 2. 软链接的访问 </h4>\n![](http://120.24.251.209/content/images/2016/03/image002.jpg)\n\n<h4 id='list7'> 清单 7. 软链接特性展示 </h4>\n\n```\n# ls -li\n total 0\n\n // 可对不存在的文件创建软链接\n # ln -s old.file soft.link\n # ls -liF\n total 0\n 789467 lrwxrwxrwx 1 root root 8 Sep  1 18:00 soft.link -> old.file\n\n // 由于被指向的文件不存在，此时的软链接 soft.link 就是死链接\n # cat soft.link\n cat: soft.link: No such file or directory\n\n // 创建被指向的文件 old.file，soft.link 恢复成正常的软链接\n # echo \"This is an original file_A\" >> old.file\n # cat soft.link\n This is an original file_A\n\n // 对不存在的目录创建软链接\n # ln -s old.dir soft.link.dir\n # mkdir -p old.dir/test\n # tree . -F --inodes\n .\n├── [ 789497]  old.dir/\n│   └── [ 789498]  test/\n├── [ 789495]  old.file\n├── [ 789495]  soft.link -> old.file\n└── [ 789497]  soft.link.dir -> old.dir/\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当然软链接的用户数据也可以是另一个软链接的路径，其解析过程是递归的。但需注意：软链接创建时原文件的路径指向使用绝对路径较好。使用相对路径创建的软链接被移动后该软链接文件将成为一个死链接（如下所示的软链接 a 使用了相对路径，因此不宜被移动），因为链接数据块中记录的亦是相对路径指向。\n\n```\n $ ls -li\n total 2136\n 656627 lrwxrwxrwx 1 harris harris       8 Sep  1 14:37 a -> data.txt\n 656662 lrwxrwxrwx 1 harris harris       1 Sep  1 14:37 b -> a\n 656228 -rw------- 1 harris harris 2186738 Sep  1 14:37 data.txt 6\n```\n\n\n### 链接相关的命令\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在 Linux 中查看当前系统已挂着的文件系统类型，除上述使用的命令 df，还可使用命令 mount 或查看文件 /proc/mounts。\n\n```\n # mount\n /dev/sda7 on / type ext4 (rw,errors=remount-ro)\n proc on /proc type proc (rw,noexec,nosuid,nodev)\n sysfs on /sys type sysfs (rw,noexec,nosuid,nodev)\n ...\n ...\n none on /run/shm type tmpfs (rw,nosuid,nodev)\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;命令 ls 或 stat 可帮助我们区分软链接与其他文件并查看文件 inode 号，但较好的方式还是使用 find 命令，其不仅可查找某文件的软链接，还可以用于查找相同 inode 的所有硬链接。（见 <a href=\"#list8\">清单 8.</a>）\n\n<h4 id='list8'> 清单 8. 使用命令 find 查找软链接与硬链接 </h4>\n\n```\n// 查找在路径 /home 下的文件 data.txt 的软链接\n # find /home -lname data.txt\n /home/harris/debug/test2/a\n\n // 查看路径 /home 有相同 inode 的所有硬链接\n # find /home -samefile /home/harris/debug/test3/old.file\n /home/harris/debug/test3/hard.link\n /home/harris/debug/test3/old.file\n\n # find /home -inum 660650\n /home/harris/debug/test3/hard.link\n /home/harris/debug/test3/old.file\n\n // 列出路径 /home/harris/debug/ 下的所有软链接文件\n # find /home/harris/debug/ -type l -ls\n 656662 0 lrwxrwxrwx 1 harris harris 1 Sep 1 14:37 /home/harris/debug/test2/b -> a\n 656627 0 lrwxrwxrwx 1 harris harris 8 Sep 1 14:37 /home/harris/debug/test2/a ->\n data.txt\n 789467 0 lrwxrwxrwx 1 root root 8 Sep 1 18:00 /home/harris/debug/test/soft.link ->\n old.file\n 789496    0 lrwxrwxrwx   1 root     root            7 Sep  1 18:01\n /home/harris/debug/test/soft.link.dir -> old.dir\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;系统根据磁盘的大小默认设定了 inode 的值（见<a href=\"#list9\">清单 9.</a>），如若必要，可在格式文件系统前对该值进行修改。如键入命令 mkfs -t ext4 -I 512/dev/sda4，将使磁盘设备 /dev/sda4 格式成 inode 大小是 512 字节的 ext4 文件系统。\n\n<h4 id='list9'> 清单 9. 查看系统的 inode 值 </h4>\n\n```\n // 查看磁盘分区 /dev/sda7 上的 inode 值\n # dumpe2fs -h /dev/sda7 | grep \"Inode size\"\n dumpe2fs 1.42 (29-Nov-2011)\n Inode size: \t          256\n\n # tune2fs -l /dev/sda7 | grep \"Inode size\"\n Inode size: \t          256\n```\n\n### Linux VFS\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux 有着极其丰富的文件系统，大体上可分如下几类：\n\n1. 网络文件系统，如 nfs、cifs 等；\n2. 磁盘文件系统，如 ext4、ext3 等；\n3. 特殊文件系统，如 proc、sysfs、ramfs、tmpfs 等。\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实现以上这些文件系统并在 Linux 下共存的基础就是 Linux VFS（Virtual File System 又称 Virtual Filesystem Switch），即虚拟文件系统。VFS 作为一个通用的文件系统，抽象了文件系统的四个基本概念：文件、目录项 (dentry)、索引节点 (inode) 及挂载点，其在内核中为用户空间层的文件系统提供了相关的接口（见 <a href=\"#p3\">图 3.</a>所示 VFS 在 Linux 系统的架构）。VFS 实现了 open()、read() 等系统调并使得 cp 等用户空间程序可跨文件系统。VFS 真正实现了上述内容中：在 Linux 中除进程之外一切皆是文件。\n\n<h4 id='p3'> 图 3. VFS 在系统中的架构 </h4>\n![](http://120.24.251.209/content/images/2016/03/image003.jpg)\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux VFS 存在四个基本对象：超级块对象 (superblock object)、索引节点对象 (inode object)、目录项对象 (dentry object) 及文件对象 (file object)。超级块对象代表一个已安装的文件系统；索引节点对象代表一个文件；目录项对象代表一个目录项，如设备文件 event5 在路径 /dev/input/event5 中，其存在四个目录项对象：/ 、dev/ 、input/ 及 event5。文件对象代表由进程打开的文件。这四个对象与进程及磁盘文件间的关系如<a href=\"#p4\">图 4.</a> 所示，其中 d_inode 即为硬链接。为文件路径的快速解析，Linux VFS 设计了目录项缓存（Directory Entry Cache，即 dcache）。\n\n<h4 id='p4'> 图 4. VFS 的对象之间的处理 </h4>\n![](http://120.24.251.209/content/images/2016/03/image004.jpg)\n\n\n### Linux 文件系统中的 inode\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在 Linux 中，索引节点结构存在于系统内存及磁盘，其可区分成 VFS inode 与实际文件系统的 inode。VFS inode 作为实际文件系统中 inode 的抽象，定义了结构体 inode 与其相关的操作 inode_operations（见内核源码 include/linux/fs.h）。\n\n<h4 id='list10'> 清单 10. VFS 中的 inode 与 inode_operations 结构体 </h4>\n\n```\nstruct inode {\n    ...\n    const struct inode_operations   *i_op; // 索引节点操作\n    unsigned long           i_ino;      // 索引节点号\n    atomic_t                i_count;    // 引用计数器\n    unsigned int            i_nlink;    // 硬链接数目\n    ...\n }\n\n struct inode_operations {\n    ...\n    int (*create) (struct inode *,struct dentry *,int, struct nameidata *);\n    int (*link) (struct dentry *,struct inode *,struct dentry *);\n    int (*unlink) (struct inode *,struct dentry *);\n    int (*symlink) (struct inode *,struct dentry *,const char *);\n    int (*mkdir) (struct inode *,struct dentry *,int);\n    int (*rmdir) (struct inode *,struct dentry *);\n    ...\n }\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如<a href=\"#list10\">清单 10.</a> 所见，每个文件存在两个计数器：i_count 与 i_nlink，即引用计数与硬链接计数。结构体 inode 中的 i_count 用于跟踪文件被访问的数量，而 i_nlink 则是上述使用 ls -l 等命令查看到的文件硬链接数。或者说 i_count 跟踪文件在内存中的情况，而 i_nlink 则是磁盘计数器。当文件被删除时，则 i_nlink 先被设置成 0。文件的这两个计数器使得 Linux 系统升级或程序更新变的容易。系统或程序可在不关闭的情况下（即文件 i_count 不为 0），将新文件以同样的文件名进行替换，新文件有自己的 inode 及 data block，旧文件会在相关进程关闭后被完整的删除。\n\n<h4 id='list11'> 清单 11. 文件系统 ext4 中的 inode </h4>\n\n```\nstruct ext4_inode {\n    ...\n    __le32  i_atime;        // 文件内容最后一次访问时间\n    __le32  i_ctime;        // inode 修改时间\n    __le32  i_mtime;        // 文件内容最后一次修改时间\n    __le16  i_links_count;  // 硬链接计数\n    __le32  i_blocks_lo;    // Block 计数\n    __le32  i_block[EXT4_N_BLOCKS];  // 指向具体的 block\n    ...\n };\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"#list11\">清单 11.</a> 展示的是文件系统 ext4 中对 inode 的定义（见内核源码 fs/ext4/ext4.h）。其中三个时间的定义可对应与命令 stat 中查看到三个时间。i_links_count 不仅用于文件的硬链接计数，也用于目录的子目录数跟踪（目录并不显示硬链接数，命令 ls -ld 查看到的是子目录数）。由于文件系统 ext3 对 i_links_count 有限制，其最大数为：32000（该限制在 ext4 中被取消）。尝试在 ext3 文件系统上验证目录子目录及普通文件硬链接最大数可见 <a href=\"#list12\">清单 12.</a>的错误信息。因此实际文件系统的 inode 之间及与 VFS inode 相较是有差异的。\n\n<h4 id='list12'> 清单 12. 文件系统 ext3 中 i_links_count 的限制 </h4>\n\n```\n # ./dirtest.sh\n mkdir: cannot create directory `dir_31999': Too many links\n\n # ./linkcount.sh\n ln: failed to create hard link to `old.file': Too many links\n```\n\n### 结束语\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文最初描述了 Linux 系统中文件与目录被引入的原因及 Linux 处理文件的方式，然后我们通过区分硬链接与软链接的不同，了解 Linux 中的索引节点的相关知识，并以此引出了 inode 的结构体。索引节点结构体存在在于 Linux VFS 以及实际文件系统中，VFS 作为通用文件模型是 Linux 中“一切皆是文件”实现的基础。文章并未深入 Linux VFS，也没涉及实际文件系统的实现，文章只是从 inode 了解 Linux 的文件系统的相关内容。若想深入文件系统的内容，查看内核文档 Documentation/filesystems/ 是一个不错的方式。\n","source":"_posts/理解-Linux-的硬链接与软链接.md","raw":"---\ntitle: 理解 Linux 的硬链接与软链接\ntags: 'Linux'\ncategories: 'Linux'\npermalink: lfs\nid: 3\nupdated: '2017-04-21 13:40:43'\ndate: 2016-03-18 14:52:13\n---\n\n<h2> 从inode了解Linux文件系统</h2>\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;硬链接与软链接是 Linux 文件系统中的一个重要概念，其涉及文件系统中的索引节点 (index node 又称 inode)，而索引节点对象是 Linux 虚拟文件系统 (VFS) 的四个基本概念之一。通过剖析硬链接与软链接的联系与区别，我们可更好的了解 Linux 中 VFS 这一通用文件模型。并让 Linux 普通用户和系统管理员正确使用硬链接与软链接，帮助文件系统开发者获取 inode 的相关知识。\n\n\n<h3> Linux的文件系统与目录 </h3>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;现代操作系统为解决信息能独立于进程之外被长期存储引入了文件，文件作为进程创建信息的逻辑单元可被多个进程并发使用。在 UNIX 系统中，操作系统为磁盘上的文本与图像、鼠标与键盘等输入设备及网络交互等 I/O 操作设计了一组通用 API，使他们被处理时均可统一使用字节流方式。换言之，UNIX 系统中除进程之外的一切皆是文件，而 Linux 保持了这一特性。为了便于文件的管理，Linux 还引入了目录（有时亦被称为文件夹）这一概念。目录使文件可被分类管理，且目录的引入使 Linux 的文件系统形成一个层级结构的目录树。<a href=\"#list1\">清单1.</a>所示的是普通 Linux 系统的顶层目录结构，其中 /dev 是存放了设备相关文件的目录。\n\n <h4 id='list1'> 清单 1. Linux系统的顶层目录结构</h4>\n\n```\n /              根目录\n├── bin     存放用户二进制文件\n├── boot    存放内核引导配置文件\n├── dev     存放设备文件\n├── etc     存放系统配置文件\n├── home    用户主目录\n├── lib     动态共享库\n├── lost+found \t文件系统恢复时的恢复文件\n├── media   可卸载存储介质挂载点\n├── mnt     文件系统临时挂载点\n├── opt     附加的应用程序包\n├── proc    系统内存的映射目录，提供内核与进程信息\n├── root    root 用户主目录\n├── sbin    存放系统二进制文件\n├── srv     存放服务相关数据\n├── sys     sys 虚拟文件系统挂载点\n├── tmp     存放临时文件\n├── usr     存放用户应用程序\n└── var     存放邮件、系统日志等变化文件\n\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux 将设备当做文件进行处理，<a href=\"#list2\">清单 2.</a>展示了如何打开设备文件 /dev/input/event5 并读取文件内容。文件 event5 表示一种输入设备，其可能是鼠标或键盘等。查看文件 /proc/bus/input/devices 可知 event5 对应设备的类型。设备文件 /dev/input/event5 使用 read() 以字符流的方式被读取。结构体 input_event 被定义在内核头文件 linux/input.h 中。\n\n<h4 id='list2'> 清单 2.  打开并读取设备文件 </h4>\n\n```\n int fd;\n struct input_event ie;\n fd = open(\"/dev/input/event5\", O_RDONLY);\n read(fd, &ie, sizeof(struct input_event));\n printf(\"type = %d  code = %d  value = %d\\n\",\n\t\t\t ie.type, ie.code, ie.value);\n close(fd);\n```\n\n\n<br />\n### 硬链接与软链接的联系与区别\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们知道文件都有文件名与数据，这在 Linux 上被分成两个部分：用户数据 (user data) 与元数据 (metadata)。用户数据，即文件数据块 (data block)，数据块是记录文件真实内容的地方；而元数据则是文件的附加属性，如文件大小、创建时间、所有者等信息。在 Linux 中，元数据中的 inode 号（inode 是文件元数据的一部分但其并不包含文件名，inode 号即索引节点号）才是文件的唯一标识而非文件名。文件名仅是为了方便人们的记忆和使用，系统或程序通过 inode 号寻找正确的文件数据块。<a href=\"#p1\">图 1.</a>展示了程序通过文件名获取文件内容的过程。\n\n<h4 id=\"p1\"> 图 1. 通过文件名打开文件 </h4>\n![](http://120.24.251.209/content/images/2016/03/image001.jpg)\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在Linux 系统中查看 inode号可使用命令stat 或 ls -i（若是 AIX 系统，则使用命令 istat）。<a href=\"#list3\">清单 3.</a>中使用命令 mv 移动并重命名文件 glibc-2.16.0.tar.xz，其结果不影响文件的用户数据及 inode 号，文件移动前后 inode 号均为：2485677。\n\n<h4 id='list3'> 清单 3.  移动或重命名文件 </h4>\n```\n# stat /home/harris/source/glibc-2.16.0.tar.xz\n  File: `/home/harris/source/glibc-2.16.0.tar.xz'\n  Size: 9990512   \t Blocks: 19520      IO Block: 4096   regular file\n Device: 807h/2055d \t Inode: 2485677     Links: 1\n Access: (0600/-rw-------)  Uid: ( 1000/  harris)   Gid: ( 1000/  harris)\n ...\n ...\n// 经网友指出，使用mv移动时不跨磁盘inode号不变，如果跨磁盘inode会改变。\n # mv /home/harris/source/glibc-2.16.0.tar.xz /home/harris/Desktop/glibc.tar.xz\n # ls -i -F /home/harris/Desktop/glibc.tar.xz\n 2485677 /home/harris/Desktop/glibc.tar.xz\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为解决文件的共享使用，Linux 系统引入了两种链接：硬链接 (hard link) 与软链接（又称符号链接，即 soft link 或 symbolic link）。链接为 Linux 系统解决了文件的共享使用，还带来了隐藏文件路径、增加权限安全及节省存储等好处。若一个 inode 号对应多个文件名，则称这些文件为硬链接。换言之，硬链接就是同一个文件使用了多个别名（见 <a href=\"#p2\">图 2.</a>hard link 就是 file 的一个别名，他们有共同的 inode）。硬链接可由命令 link 或 ln 创建。如下是对文件 oldfile 创建硬链接。\n\n```\n link oldfile newfile\n ln oldfile newfile\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于硬链接是有着相同 inode 号仅文件名不同的文件，因此硬链接存在以下几点特性：\n\n* 文件有相同的 inode 及 data block；\n* 只能对已存在的文件进行创建；\n* 不能交叉文件系统进行硬链接的创建；\n* 不能对目录进行创建，只可对文件创建；\n* 删除一个硬链接文件并不影响其他有相同 inode 号的文件。\n\n<h4 id='list4'> 清单 4.  硬链接特性展示 </h4>\n\n```\n# ls -li\n total 0\n\n // 只能对已存在的文件创建硬连接\n # link old.file hard.link\n link: cannot create link `hard.link' to `old.file': No such file or directory\n\n # echo \"This is an original file\" > old.file\n # cat old.file\n This is an original file\n # stat old.file\n  File: `old.file'\n  Size: 25        \t Blocks: 8          IO Block: 4096   regular file\n Device: 807h/2055d \t Inode: 660650      Links: 2\n Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)\n ...\n // 文件有相同的 inode 号以及 data block\n # link old.file hard.link | ls -li\n total 8\n 660650 -rw-r--r-- 2 root root 25 Sep  1 17:44 hard.link\n 660650 -rw-r--r-- 2 root root 25 Sep  1 17:44 old.file\n\n // 不能交叉文件系统\n # ln /dev/input/event5 /root/bfile.txt\n ln: failed to create hard link `/root/bfile.txt' => `/dev/input/event5':\n Invalid cross-device link\n\n // 不能对目录进行创建硬连接\n # mkdir -p old.dir/test\n # ln old.dir/ hardlink.dir\n ln: `old.dir/': hard link not allowed for directory\n # ls -iF\n 660650 hard.link  657948 old.dir/  660650 old.file\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;文件 old.file 与 hard.link 有着相同的 inode 号：660650 及文件权限，inode 是随着文件的存在而存在，因此只有当文件存在时才可创建硬链接，即当 inode 存在且链接计数器（link count）不为 0 时。inode 号仅在各文件系统下是唯一的，当 Linux 挂载多个文件系统后将出现 inode 号重复的现象（如<a href=\"#list5\">清单 5.</a>所示，文件 t3.jpg、sync 及 123.txt 并无关联，却有着相同的 inode 号），因此硬链接创建时不可跨文件系统。设备文件目录 /dev 使用的文件系统是 devtmpfs，而 /root（与根目录 / 一致）使用的是磁盘文件系统 ext4。<a href=\"#list5\">清单 5.</a>展示了使用命令 df 查看当前系统中挂载的文件系统类型、各文件系统 inode 使用情况及文件系统挂载点。\n\n<h4 id='list5'> 清单 5.  查找有相同 inode 号的文件 </h4>\n```\n# df -i --print-type\n Filesystem     Type       Inodes  IUsed    IFree IUse% Mounted on\n /dev/sda7      ext4      3147760 283483  2864277   10% /\n udev           devtmpfs   496088    553   495535    1% /dev\n tmpfs          tmpfs      499006    491   498515    1% /run\n none           tmpfs      499006      3   499003    1% /run/lock\n none           tmpfs      499006     15   498991    1% /run/shm\n /dev/sda6      fuseblk  74383900   4786 74379114    1% /media/DiskE\n /dev/sda8      fuseblk  29524592  19939 29504653    1% /media/DiskF\n\n # find / -inum 1114\n /media/DiskE/Pictures/t3.jpg\n /media/DiskF/123.txt\n /bin/sync\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;值得一提的是，Linux 系统存在 inode 号被用完但磁盘空间还有剩余的情况。我们创建一个 5M 大小的 ext4 类型的 mo.img 文件，并将其挂载至目录 /mnt。然后我们使用一个 shell 脚本将挂载在 /mnt 下 ext4 文件系统的 indoe 耗尽（见<a href=\"#list6\">清单 6.</a>）。\n\n<h4 id='list6'> 清单 6.  测试文件系统 inode 耗尽但仍有磁盘空间的情景 </h4>\n\n```\n # dd if=/dev/zero of=mo.img bs=5120k count=1\n # ls -lh mo.img\n -rw-r--r-- 1 root root 5.0M Sep  1 17:54 mo.img\n # mkfs -t ext4  -F ./mo.img\n ...\n OS type: Linux\n Block size=1024 (log=0)\n Fragment size=1024 (log=0)\n Stride=0 blocks, Stripe width=0 blocks\n 1280 inodes, 5120 blocks\n 256 blocks (5.00%) reserved for the super user\n ...\n ...\n Writing superblocks and filesystem accounting information: done\n\n # mount -o loop ./mo.img /mnt\n # cat /mnt/inode_test.sh\n #!/bin/bash\n\n for ((i = 1; ; i++))\n do\n    if [ $? -eq 0 ]; then\n        echo  \"This is file_$i\" > file_$i\n    else\n        exit 0\n    fi\n done\n\n # ./inode_test.sh\n ./inode_test.sh: line 6: file_1269: No space left on device\n\n # df -iT /mnt/; du -sh /mnt/\n Filesystem     Type Inodes IUsed IFree IUse% Mounted on\n /dev/loop0     ext4   1280  1280     0  100% /mnt\n 1.3M \t /mnt/\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;硬链接不能对目录创建是受限于文件系统的设计（见 <a href=\"#list4\">清单 4.</a>对目录创建硬链接将失败）。现 Linux 文件系统中的目录均隐藏了两个个特殊的目录：当前目录（.）与父目录（..）。查看这两个特殊目录的 inode 号可知其实这两目录就是两个硬链接（注意目录 /mnt/lost+found/ 的 inode 号）。若系统允许对目录创建硬链接，则会产生目录环。\n\n```\n # ls -aliF /mnt/lost+found\n total 44\n 11 drwx------ 2 root root 12288 Sep  1 17:54 ./\n 2 drwxr-xr-x 3 root root 31744 Sep  1 17:57 ../\n\n # stat  /mnt/lost+found/\n  File: `/mnt/lost+found/'\n  Size: 12288     \t Blocks: 24         IO Block: 1024   directory\n Device: 700h/1792d \t Inode: 11          Links: 2\n Access: (0700/drwx------)  Uid: (    0/    root)   Gid: (    0/    root)\n Access: 2012-09-01 17:57:17.000000000 +0800\n Modify: 2012-09-01 17:54:49.000000000 +0800\n Change: 2012-09-01 17:54:49.000000000 +0800\n Birth: -\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;软链接与硬链接不同，若文件用户数据块中存放的内容是另一文件的路径名的指向，则该文件就是软连接。软链接就是一个普通文件，只是数据块内容有点特殊。软链接有着自己的 inode 号以及用户数据块（见 <a href=\"#p2\">图 2.</a>）。因此软链接的创建与使用没有类似硬链接的诸多限制：\n\n* 软链接有自己的文件属性及权限等；\n* 可对不存在的文件或目录创建软链接；\n* 软链接可交叉文件系统；\n* 软链接可对文件或目录创建；\n* 创建软链接时，链接计数 i_nlink 不会增加；\n* 删除软链接并不影响被指向的文件，但若被指向的原文件被删除，则相关软连接被称为死链接（即 dangling link，若被指向路径文件被重新创建，死链接可恢复为正常的软链接）。\n\n<h4 id=\"p2\">  图 2. 软链接的访问 </h4>\n![](http://120.24.251.209/content/images/2016/03/image002.jpg)\n\n<h4 id='list7'> 清单 7. 软链接特性展示 </h4>\n\n```\n# ls -li\n total 0\n\n // 可对不存在的文件创建软链接\n # ln -s old.file soft.link\n # ls -liF\n total 0\n 789467 lrwxrwxrwx 1 root root 8 Sep  1 18:00 soft.link -> old.file\n\n // 由于被指向的文件不存在，此时的软链接 soft.link 就是死链接\n # cat soft.link\n cat: soft.link: No such file or directory\n\n // 创建被指向的文件 old.file，soft.link 恢复成正常的软链接\n # echo \"This is an original file_A\" >> old.file\n # cat soft.link\n This is an original file_A\n\n // 对不存在的目录创建软链接\n # ln -s old.dir soft.link.dir\n # mkdir -p old.dir/test\n # tree . -F --inodes\n .\n├── [ 789497]  old.dir/\n│   └── [ 789498]  test/\n├── [ 789495]  old.file\n├── [ 789495]  soft.link -> old.file\n└── [ 789497]  soft.link.dir -> old.dir/\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当然软链接的用户数据也可以是另一个软链接的路径，其解析过程是递归的。但需注意：软链接创建时原文件的路径指向使用绝对路径较好。使用相对路径创建的软链接被移动后该软链接文件将成为一个死链接（如下所示的软链接 a 使用了相对路径，因此不宜被移动），因为链接数据块中记录的亦是相对路径指向。\n\n```\n $ ls -li\n total 2136\n 656627 lrwxrwxrwx 1 harris harris       8 Sep  1 14:37 a -> data.txt\n 656662 lrwxrwxrwx 1 harris harris       1 Sep  1 14:37 b -> a\n 656228 -rw------- 1 harris harris 2186738 Sep  1 14:37 data.txt 6\n```\n\n\n### 链接相关的命令\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在 Linux 中查看当前系统已挂着的文件系统类型，除上述使用的命令 df，还可使用命令 mount 或查看文件 /proc/mounts。\n\n```\n # mount\n /dev/sda7 on / type ext4 (rw,errors=remount-ro)\n proc on /proc type proc (rw,noexec,nosuid,nodev)\n sysfs on /sys type sysfs (rw,noexec,nosuid,nodev)\n ...\n ...\n none on /run/shm type tmpfs (rw,nosuid,nodev)\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;命令 ls 或 stat 可帮助我们区分软链接与其他文件并查看文件 inode 号，但较好的方式还是使用 find 命令，其不仅可查找某文件的软链接，还可以用于查找相同 inode 的所有硬链接。（见 <a href=\"#list8\">清单 8.</a>）\n\n<h4 id='list8'> 清单 8. 使用命令 find 查找软链接与硬链接 </h4>\n\n```\n// 查找在路径 /home 下的文件 data.txt 的软链接\n # find /home -lname data.txt\n /home/harris/debug/test2/a\n\n // 查看路径 /home 有相同 inode 的所有硬链接\n # find /home -samefile /home/harris/debug/test3/old.file\n /home/harris/debug/test3/hard.link\n /home/harris/debug/test3/old.file\n\n # find /home -inum 660650\n /home/harris/debug/test3/hard.link\n /home/harris/debug/test3/old.file\n\n // 列出路径 /home/harris/debug/ 下的所有软链接文件\n # find /home/harris/debug/ -type l -ls\n 656662 0 lrwxrwxrwx 1 harris harris 1 Sep 1 14:37 /home/harris/debug/test2/b -> a\n 656627 0 lrwxrwxrwx 1 harris harris 8 Sep 1 14:37 /home/harris/debug/test2/a ->\n data.txt\n 789467 0 lrwxrwxrwx 1 root root 8 Sep 1 18:00 /home/harris/debug/test/soft.link ->\n old.file\n 789496    0 lrwxrwxrwx   1 root     root            7 Sep  1 18:01\n /home/harris/debug/test/soft.link.dir -> old.dir\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;系统根据磁盘的大小默认设定了 inode 的值（见<a href=\"#list9\">清单 9.</a>），如若必要，可在格式文件系统前对该值进行修改。如键入命令 mkfs -t ext4 -I 512/dev/sda4，将使磁盘设备 /dev/sda4 格式成 inode 大小是 512 字节的 ext4 文件系统。\n\n<h4 id='list9'> 清单 9. 查看系统的 inode 值 </h4>\n\n```\n // 查看磁盘分区 /dev/sda7 上的 inode 值\n # dumpe2fs -h /dev/sda7 | grep \"Inode size\"\n dumpe2fs 1.42 (29-Nov-2011)\n Inode size: \t          256\n\n # tune2fs -l /dev/sda7 | grep \"Inode size\"\n Inode size: \t          256\n```\n\n### Linux VFS\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux 有着极其丰富的文件系统，大体上可分如下几类：\n\n1. 网络文件系统，如 nfs、cifs 等；\n2. 磁盘文件系统，如 ext4、ext3 等；\n3. 特殊文件系统，如 proc、sysfs、ramfs、tmpfs 等。\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实现以上这些文件系统并在 Linux 下共存的基础就是 Linux VFS（Virtual File System 又称 Virtual Filesystem Switch），即虚拟文件系统。VFS 作为一个通用的文件系统，抽象了文件系统的四个基本概念：文件、目录项 (dentry)、索引节点 (inode) 及挂载点，其在内核中为用户空间层的文件系统提供了相关的接口（见 <a href=\"#p3\">图 3.</a>所示 VFS 在 Linux 系统的架构）。VFS 实现了 open()、read() 等系统调并使得 cp 等用户空间程序可跨文件系统。VFS 真正实现了上述内容中：在 Linux 中除进程之外一切皆是文件。\n\n<h4 id='p3'> 图 3. VFS 在系统中的架构 </h4>\n![](http://120.24.251.209/content/images/2016/03/image003.jpg)\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux VFS 存在四个基本对象：超级块对象 (superblock object)、索引节点对象 (inode object)、目录项对象 (dentry object) 及文件对象 (file object)。超级块对象代表一个已安装的文件系统；索引节点对象代表一个文件；目录项对象代表一个目录项，如设备文件 event5 在路径 /dev/input/event5 中，其存在四个目录项对象：/ 、dev/ 、input/ 及 event5。文件对象代表由进程打开的文件。这四个对象与进程及磁盘文件间的关系如<a href=\"#p4\">图 4.</a> 所示，其中 d_inode 即为硬链接。为文件路径的快速解析，Linux VFS 设计了目录项缓存（Directory Entry Cache，即 dcache）。\n\n<h4 id='p4'> 图 4. VFS 的对象之间的处理 </h4>\n![](http://120.24.251.209/content/images/2016/03/image004.jpg)\n\n\n### Linux 文件系统中的 inode\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在 Linux 中，索引节点结构存在于系统内存及磁盘，其可区分成 VFS inode 与实际文件系统的 inode。VFS inode 作为实际文件系统中 inode 的抽象，定义了结构体 inode 与其相关的操作 inode_operations（见内核源码 include/linux/fs.h）。\n\n<h4 id='list10'> 清单 10. VFS 中的 inode 与 inode_operations 结构体 </h4>\n\n```\nstruct inode {\n    ...\n    const struct inode_operations   *i_op; // 索引节点操作\n    unsigned long           i_ino;      // 索引节点号\n    atomic_t                i_count;    // 引用计数器\n    unsigned int            i_nlink;    // 硬链接数目\n    ...\n }\n\n struct inode_operations {\n    ...\n    int (*create) (struct inode *,struct dentry *,int, struct nameidata *);\n    int (*link) (struct dentry *,struct inode *,struct dentry *);\n    int (*unlink) (struct inode *,struct dentry *);\n    int (*symlink) (struct inode *,struct dentry *,const char *);\n    int (*mkdir) (struct inode *,struct dentry *,int);\n    int (*rmdir) (struct inode *,struct dentry *);\n    ...\n }\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如<a href=\"#list10\">清单 10.</a> 所见，每个文件存在两个计数器：i_count 与 i_nlink，即引用计数与硬链接计数。结构体 inode 中的 i_count 用于跟踪文件被访问的数量，而 i_nlink 则是上述使用 ls -l 等命令查看到的文件硬链接数。或者说 i_count 跟踪文件在内存中的情况，而 i_nlink 则是磁盘计数器。当文件被删除时，则 i_nlink 先被设置成 0。文件的这两个计数器使得 Linux 系统升级或程序更新变的容易。系统或程序可在不关闭的情况下（即文件 i_count 不为 0），将新文件以同样的文件名进行替换，新文件有自己的 inode 及 data block，旧文件会在相关进程关闭后被完整的删除。\n\n<h4 id='list11'> 清单 11. 文件系统 ext4 中的 inode </h4>\n\n```\nstruct ext4_inode {\n    ...\n    __le32  i_atime;        // 文件内容最后一次访问时间\n    __le32  i_ctime;        // inode 修改时间\n    __le32  i_mtime;        // 文件内容最后一次修改时间\n    __le16  i_links_count;  // 硬链接计数\n    __le32  i_blocks_lo;    // Block 计数\n    __le32  i_block[EXT4_N_BLOCKS];  // 指向具体的 block\n    ...\n };\n```\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"#list11\">清单 11.</a> 展示的是文件系统 ext4 中对 inode 的定义（见内核源码 fs/ext4/ext4.h）。其中三个时间的定义可对应与命令 stat 中查看到三个时间。i_links_count 不仅用于文件的硬链接计数，也用于目录的子目录数跟踪（目录并不显示硬链接数，命令 ls -ld 查看到的是子目录数）。由于文件系统 ext3 对 i_links_count 有限制，其最大数为：32000（该限制在 ext4 中被取消）。尝试在 ext3 文件系统上验证目录子目录及普通文件硬链接最大数可见 <a href=\"#list12\">清单 12.</a>的错误信息。因此实际文件系统的 inode 之间及与 VFS inode 相较是有差异的。\n\n<h4 id='list12'> 清单 12. 文件系统 ext3 中 i_links_count 的限制 </h4>\n\n```\n # ./dirtest.sh\n mkdir: cannot create directory `dir_31999': Too many links\n\n # ./linkcount.sh\n ln: failed to create hard link to `old.file': Too many links\n```\n\n### 结束语\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文最初描述了 Linux 系统中文件与目录被引入的原因及 Linux 处理文件的方式，然后我们通过区分硬链接与软链接的不同，了解 Linux 中的索引节点的相关知识，并以此引出了 inode 的结构体。索引节点结构体存在在于 Linux VFS 以及实际文件系统中，VFS 作为通用文件模型是 Linux 中“一切皆是文件”实现的基础。文章并未深入 Linux VFS，也没涉及实际文件系统的实现，文章只是从 inode 了解 Linux 的文件系统的相关内容。若想深入文件系统的内容，查看内核文档 Documentation/filesystems/ 是一个不错的方式。\n","slug":"lfs","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqev009341tp9qox72ay","content":"<h2> 从inode了解Linux文件系统</h2>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;硬链接与软链接是 Linux 文件系统中的一个重要概念，其涉及文件系统中的索引节点 (index node 又称 inode)，而索引节点对象是 Linux 虚拟文件系统 (VFS) 的四个基本概念之一。通过剖析硬链接与软链接的联系与区别，我们可更好的了解 Linux 中 VFS 这一通用文件模型。并让 Linux 普通用户和系统管理员正确使用硬链接与软链接，帮助文件系统开发者获取 inode 的相关知识。</p>\n<p></p><h3> Linux的文件系统与目录 </h3><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;现代操作系统为解决信息能独立于进程之外被长期存储引入了文件，文件作为进程创建信息的逻辑单元可被多个进程并发使用。在 UNIX 系统中，操作系统为磁盘上的文本与图像、鼠标与键盘等输入设备及网络交互等 I/O 操作设计了一组通用 API，使他们被处理时均可统一使用字节流方式。换言之，UNIX 系统中除进程之外的一切皆是文件，而 Linux 保持了这一特性。为了便于文件的管理，Linux 还引入了目录（有时亦被称为文件夹）这一概念。目录使文件可被分类管理，且目录的引入使 Linux 的文件系统形成一个层级结构的目录树。<a href=\"#list1\">清单1.</a>所示的是普通 Linux 系统的顶层目录结构，其中 /dev 是存放了设备相关文件的目录。<p></p>\n <h4 id=\"list1\"> 清单 1. Linux系统的顶层目录结构</h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"> /              根目录</div><div class=\"line\">├── bin     存放用户二进制文件</div><div class=\"line\">├── boot    存放内核引导配置文件</div><div class=\"line\">├── dev     存放设备文件</div><div class=\"line\">├── etc     存放系统配置文件</div><div class=\"line\">├── home    用户主目录</div><div class=\"line\">├── lib     动态共享库</div><div class=\"line\">├── lost+found \t文件系统恢复时的恢复文件</div><div class=\"line\">├── media   可卸载存储介质挂载点</div><div class=\"line\">├── mnt     文件系统临时挂载点</div><div class=\"line\">├── opt     附加的应用程序包</div><div class=\"line\">├── proc    系统内存的映射目录，提供内核与进程信息</div><div class=\"line\">├── root    root 用户主目录</div><div class=\"line\">├── sbin    存放系统二进制文件</div><div class=\"line\">├── srv     存放服务相关数据</div><div class=\"line\">├── sys     sys 虚拟文件系统挂载点</div><div class=\"line\">├── tmp     存放临时文件</div><div class=\"line\">├── usr     存放用户应用程序</div><div class=\"line\">└── var     存放邮件、系统日志等变化文件</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux 将设备当做文件进行处理，<a href=\"#list2\">清单 2.</a>展示了如何打开设备文件 /dev/input/event5 并读取文件内容。文件 event5 表示一种输入设备，其可能是鼠标或键盘等。查看文件 /proc/bus/input/devices 可知 event5 对应设备的类型。设备文件 /dev/input/event5 使用 read() 以字符流的方式被读取。结构体 input_event 被定义在内核头文件 linux/input.h 中。</p>\n<h4 id=\"list2\"> 清单 2.  打开并读取设备文件 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">int fd;</div><div class=\"line\">struct input_event ie;</div><div class=\"line\">fd = open(&quot;/dev/input/event5&quot;, O_RDONLY);</div><div class=\"line\">read(fd, &amp;ie, sizeof(struct input_event));</div><div class=\"line\">printf(&quot;type = %d  code = %d  value = %d\\n&quot;,</div><div class=\"line\">\t\t ie.type, ie.code, ie.value);</div><div class=\"line\">close(fd);</div></pre></td></tr></table></figure>\n<p><br></p>\n<h3 id=\"硬链接与软链接的联系与区别\"><a href=\"#硬链接与软链接的联系与区别\" class=\"headerlink\" title=\"硬链接与软链接的联系与区别\"></a>硬链接与软链接的联系与区别</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们知道文件都有文件名与数据，这在 Linux 上被分成两个部分：用户数据 (user data) 与元数据 (metadata)。用户数据，即文件数据块 (data block)，数据块是记录文件真实内容的地方；而元数据则是文件的附加属性，如文件大小、创建时间、所有者等信息。在 Linux 中，元数据中的 inode 号（inode 是文件元数据的一部分但其并不包含文件名，inode 号即索引节点号）才是文件的唯一标识而非文件名。文件名仅是为了方便人们的记忆和使用，系统或程序通过 inode 号寻找正确的文件数据块。<a href=\"#p1\">图 1.</a>展示了程序通过文件名获取文件内容的过程。</p>\n<h4 id=\"p1\"> 图 1. 通过文件名打开文件 </h4><br><img src=\"http://120.24.251.209/content/images/2016/03/image001.jpg\" alt=\"\"><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在Linux 系统中查看 inode号可使用命令stat 或 ls -i（若是 AIX 系统，则使用命令 istat）。<a href=\"#list3\">清单 3.</a>中使用命令 mv 移动并重命名文件 glibc-2.16.0.tar.xz，其结果不影响文件的用户数据及 inode 号，文件移动前后 inode 号均为：2485677。<br><br><h4 id=\"list3\"> 清单 3.  移动或重命名文件 </h4><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># stat /home/harris/source/glibc-2.16.0.tar.xz</div><div class=\"line\">  File: `/home/harris/source/glibc-2.16.0.tar.xz&apos;</div><div class=\"line\">  Size: 9990512   \t Blocks: 19520      IO Block: 4096   regular file</div><div class=\"line\"> Device: 807h/2055d \t Inode: 2485677     Links: 1</div><div class=\"line\"> Access: (0600/-rw-------)  Uid: ( 1000/  harris)   Gid: ( 1000/  harris)</div><div class=\"line\"> ...</div><div class=\"line\"> ...</div><div class=\"line\">// 经网友指出，使用mv移动时不跨磁盘inode号不变，如果跨磁盘inode会改变。</div><div class=\"line\"> # mv /home/harris/source/glibc-2.16.0.tar.xz /home/harris/Desktop/glibc.tar.xz</div><div class=\"line\"> # ls -i -F /home/harris/Desktop/glibc.tar.xz</div><div class=\"line\"> 2485677 /home/harris/Desktop/glibc.tar.xz</div></pre></td></tr></table></figure><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为解决文件的共享使用，Linux 系统引入了两种链接：硬链接 (hard link) 与软链接（又称符号链接，即 soft link 或 symbolic link）。链接为 Linux 系统解决了文件的共享使用，还带来了隐藏文件路径、增加权限安全及节省存储等好处。若一个 inode 号对应多个文件名，则称这些文件为硬链接。换言之，硬链接就是同一个文件使用了多个别名（见 <a href=\"#p2\">图 2.</a>hard link 就是 file 的一个别名，他们有共同的 inode）。硬链接可由命令 link 或 ln 创建。如下是对文件 oldfile 创建硬链接。<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">link oldfile newfile</div><div class=\"line\">ln oldfile newfile</div></pre></td></tr></table></figure><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于硬链接是有着相同 inode 号仅文件名不同的文件，因此硬链接存在以下几点特性：<br><br><em> 文件有相同的 inode 及 data block；\n</em> 只能对已存在的文件进行创建；<br><em> 不能交叉文件系统进行硬链接的创建；\n</em> 不能对目录进行创建，只可对文件创建；<br>* 删除一个硬链接文件并不影响其他有相同 inode 号的文件。<br><br><h4 id=\"list4\"> 清单 4.  硬链接特性展示 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ls -li</div><div class=\"line\"> total 0</div><div class=\"line\"></div><div class=\"line\"> // 只能对已存在的文件创建硬连接</div><div class=\"line\"> # link old.file hard.link</div><div class=\"line\"> link: cannot create link `hard.link&apos; to `old.file&apos;: No such file or directory</div><div class=\"line\"></div><div class=\"line\"> # echo &quot;This is an original file&quot; &gt; old.file</div><div class=\"line\"> # cat old.file</div><div class=\"line\"> This is an original file</div><div class=\"line\"> # stat old.file</div><div class=\"line\">  File: `old.file&apos;</div><div class=\"line\">  Size: 25        \t Blocks: 8          IO Block: 4096   regular file</div><div class=\"line\"> Device: 807h/2055d \t Inode: 660650      Links: 2</div><div class=\"line\"> Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class=\"line\"> ...</div><div class=\"line\"> // 文件有相同的 inode 号以及 data block</div><div class=\"line\"> # link old.file hard.link | ls -li</div><div class=\"line\"> total 8</div><div class=\"line\"> 660650 -rw-r--r-- 2 root root 25 Sep  1 17:44 hard.link</div><div class=\"line\"> 660650 -rw-r--r-- 2 root root 25 Sep  1 17:44 old.file</div><div class=\"line\"></div><div class=\"line\"> // 不能交叉文件系统</div><div class=\"line\"> # ln /dev/input/event5 /root/bfile.txt</div><div class=\"line\"> ln: failed to create hard link `/root/bfile.txt&apos; =&gt; `/dev/input/event5&apos;:</div><div class=\"line\"> Invalid cross-device link</div><div class=\"line\"></div><div class=\"line\"> // 不能对目录进行创建硬连接</div><div class=\"line\"> # mkdir -p old.dir/test</div><div class=\"line\"> # ln old.dir/ hardlink.dir</div><div class=\"line\"> ln: `old.dir/&apos;: hard link not allowed for directory</div><div class=\"line\"> # ls -iF</div><div class=\"line\"> 660650 hard.link  657948 old.dir/  660650 old.file</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;文件 old.file 与 hard.link 有着相同的 inode 号：660650 及文件权限，inode 是随着文件的存在而存在，因此只有当文件存在时才可创建硬链接，即当 inode 存在且链接计数器（link count）不为 0 时。inode 号仅在各文件系统下是唯一的，当 Linux 挂载多个文件系统后将出现 inode 号重复的现象（如<a href=\"#list5\">清单 5.</a>所示，文件 t3.jpg、sync 及 123.txt 并无关联，却有着相同的 inode 号），因此硬链接创建时不可跨文件系统。设备文件目录 /dev 使用的文件系统是 devtmpfs，而 /root（与根目录 / 一致）使用的是磁盘文件系统 ext4。<a href=\"#list5\">清单 5.</a>展示了使用命令 df 查看当前系统中挂载的文件系统类型、各文件系统 inode 使用情况及文件系统挂载点。</p>\n<h4 id=\"list5\"> 清单 5.  查找有相同 inode 号的文件 </h4><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"># df -i --print-type</div><div class=\"line\"> Filesystem     Type       Inodes  IUsed    IFree IUse% Mounted on</div><div class=\"line\"> /dev/sda7      ext4      3147760 283483  2864277   10% /</div><div class=\"line\"> udev           devtmpfs   496088    553   495535    1% /dev</div><div class=\"line\"> tmpfs          tmpfs      499006    491   498515    1% /run</div><div class=\"line\"> none           tmpfs      499006      3   499003    1% /run/lock</div><div class=\"line\"> none           tmpfs      499006     15   498991    1% /run/shm</div><div class=\"line\"> /dev/sda6      fuseblk  74383900   4786 74379114    1% /media/DiskE</div><div class=\"line\"> /dev/sda8      fuseblk  29524592  19939 29504653    1% /media/DiskF</div><div class=\"line\"></div><div class=\"line\"> # find / -inum 1114</div><div class=\"line\"> /media/DiskE/Pictures/t3.jpg</div><div class=\"line\"> /media/DiskF/123.txt</div><div class=\"line\"> /bin/sync</div></pre></td></tr></table></figure><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;值得一提的是，Linux 系统存在 inode 号被用完但磁盘空间还有剩余的情况。我们创建一个 5M 大小的 ext4 类型的 mo.img 文件，并将其挂载至目录 /mnt。然后我们使用一个 shell 脚本将挂载在 /mnt 下 ext4 文件系统的 indoe 耗尽（见<a href=\"#list6\">清单 6.</a>）。<br><br><h4 id=\"list6\"> 清单 6.  测试文件系统 inode 耗尽但仍有磁盘空间的情景 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"># dd if=/dev/zero of=mo.img bs=5120k count=1</div><div class=\"line\"># ls -lh mo.img</div><div class=\"line\">-rw-r--r-- 1 root root 5.0M Sep  1 17:54 mo.img</div><div class=\"line\"># mkfs -t ext4  -F ./mo.img</div><div class=\"line\">...</div><div class=\"line\">OS type: Linux</div><div class=\"line\">Block size=1024 (log=0)</div><div class=\"line\">Fragment size=1024 (log=0)</div><div class=\"line\">Stride=0 blocks, Stripe width=0 blocks</div><div class=\"line\">1280 inodes, 5120 blocks</div><div class=\"line\">256 blocks (5.00%) reserved for the super user</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\">Writing superblocks and filesystem accounting information: done</div><div class=\"line\"></div><div class=\"line\"># mount -o loop ./mo.img /mnt</div><div class=\"line\"># cat /mnt/inode_test.sh</div><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">for ((i = 1; ; i++))</div><div class=\"line\">do</div><div class=\"line\">   if [ $? -eq 0 ]; then</div><div class=\"line\">       echo  &quot;This is file_$i&quot; &gt; file_$i</div><div class=\"line\">   else</div><div class=\"line\">       exit 0</div><div class=\"line\">   fi</div><div class=\"line\">done</div><div class=\"line\"></div><div class=\"line\"># ./inode_test.sh</div><div class=\"line\">./inode_test.sh: line 6: file_1269: No space left on device</div><div class=\"line\"></div><div class=\"line\"># df -iT /mnt/; du -sh /mnt/</div><div class=\"line\">Filesystem     Type Inodes IUsed IFree IUse% Mounted on</div><div class=\"line\">/dev/loop0     ext4   1280  1280     0  100% /mnt</div><div class=\"line\">1.3M \t /mnt/</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;硬链接不能对目录创建是受限于文件系统的设计（见 <a href=\"#list4\">清单 4.</a>对目录创建硬链接将失败）。现 Linux 文件系统中的目录均隐藏了两个个特殊的目录：当前目录（.）与父目录（..）。查看这两个特殊目录的 inode 号可知其实这两目录就是两个硬链接（注意目录 /mnt/lost+found/ 的 inode 号）。若系统允许对目录创建硬链接，则会产生目录环。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ls -aliF /mnt/lost+found</div><div class=\"line\">total 44</div><div class=\"line\">11 drwx------ 2 root root 12288 Sep  1 17:54 ./</div><div class=\"line\">2 drwxr-xr-x 3 root root 31744 Sep  1 17:57 ../</div><div class=\"line\"></div><div class=\"line\"># stat  /mnt/lost+found/</div><div class=\"line\"> File: `/mnt/lost+found/&apos;</div><div class=\"line\"> Size: 12288     \t Blocks: 24         IO Block: 1024   directory</div><div class=\"line\">Device: 700h/1792d \t Inode: 11          Links: 2</div><div class=\"line\">Access: (0700/drwx------)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class=\"line\">Access: 2012-09-01 17:57:17.000000000 +0800</div><div class=\"line\">Modify: 2012-09-01 17:54:49.000000000 +0800</div><div class=\"line\">Change: 2012-09-01 17:54:49.000000000 +0800</div><div class=\"line\">Birth: -</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;软链接与硬链接不同，若文件用户数据块中存放的内容是另一文件的路径名的指向，则该文件就是软连接。软链接就是一个普通文件，只是数据块内容有点特殊。软链接有着自己的 inode 号以及用户数据块（见 <a href=\"#p2\">图 2.</a>）。因此软链接的创建与使用没有类似硬链接的诸多限制：</p>\n<ul>\n<li>软链接有自己的文件属性及权限等；</li>\n<li>可对不存在的文件或目录创建软链接；</li>\n<li>软链接可交叉文件系统；</li>\n<li>软链接可对文件或目录创建；</li>\n<li>创建软链接时，链接计数 i_nlink 不会增加；</li>\n<li>删除软链接并不影响被指向的文件，但若被指向的原文件被删除，则相关软连接被称为死链接（即 dangling link，若被指向路径文件被重新创建，死链接可恢复为正常的软链接）。</li>\n</ul>\n<h4 id=\"p2\">  图 2. 软链接的访问 </h4><br><img src=\"http://120.24.251.209/content/images/2016/03/image002.jpg\" alt=\"\"><br><br><h4 id=\"list7\"> 清单 7. 软链接特性展示 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ls -li</div><div class=\"line\"> total 0</div><div class=\"line\"></div><div class=\"line\"> // 可对不存在的文件创建软链接</div><div class=\"line\"> # ln -s old.file soft.link</div><div class=\"line\"> # ls -liF</div><div class=\"line\"> total 0</div><div class=\"line\"> 789467 lrwxrwxrwx 1 root root 8 Sep  1 18:00 soft.link -&gt; old.file</div><div class=\"line\"></div><div class=\"line\"> // 由于被指向的文件不存在，此时的软链接 soft.link 就是死链接</div><div class=\"line\"> # cat soft.link</div><div class=\"line\"> cat: soft.link: No such file or directory</div><div class=\"line\"></div><div class=\"line\"> // 创建被指向的文件 old.file，soft.link 恢复成正常的软链接</div><div class=\"line\"> # echo &quot;This is an original file_A&quot; &gt;&gt; old.file</div><div class=\"line\"> # cat soft.link</div><div class=\"line\"> This is an original file_A</div><div class=\"line\"></div><div class=\"line\"> // 对不存在的目录创建软链接</div><div class=\"line\"> # ln -s old.dir soft.link.dir</div><div class=\"line\"> # mkdir -p old.dir/test</div><div class=\"line\"> # tree . -F --inodes</div><div class=\"line\"> .</div><div class=\"line\">├── [ 789497]  old.dir/</div><div class=\"line\">│   └── [ 789498]  test/</div><div class=\"line\">├── [ 789495]  old.file</div><div class=\"line\">├── [ 789495]  soft.link -&gt; old.file</div><div class=\"line\">└── [ 789497]  soft.link.dir -&gt; old.dir/</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当然软链接的用户数据也可以是另一个软链接的路径，其解析过程是递归的。但需注意：软链接创建时原文件的路径指向使用绝对路径较好。使用相对路径创建的软链接被移动后该软链接文件将成为一个死链接（如下所示的软链接 a 使用了相对路径，因此不宜被移动），因为链接数据块中记录的亦是相对路径指向。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ ls -li</div><div class=\"line\">total 2136</div><div class=\"line\">656627 lrwxrwxrwx 1 harris harris       8 Sep  1 14:37 a -&gt; data.txt</div><div class=\"line\">656662 lrwxrwxrwx 1 harris harris       1 Sep  1 14:37 b -&gt; a</div><div class=\"line\">656228 -rw------- 1 harris harris 2186738 Sep  1 14:37 data.txt 6</div></pre></td></tr></table></figure>\n<h3 id=\"链接相关的命令\"><a href=\"#链接相关的命令\" class=\"headerlink\" title=\"链接相关的命令\"></a>链接相关的命令</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在 Linux 中查看当前系统已挂着的文件系统类型，除上述使用的命令 df，还可使用命令 mount 或查看文件 /proc/mounts。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"># mount</div><div class=\"line\">/dev/sda7 on / type ext4 (rw,errors=remount-ro)</div><div class=\"line\">proc on /proc type proc (rw,noexec,nosuid,nodev)</div><div class=\"line\">sysfs on /sys type sysfs (rw,noexec,nosuid,nodev)</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\">none on /run/shm type tmpfs (rw,nosuid,nodev)</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;命令 ls 或 stat 可帮助我们区分软链接与其他文件并查看文件 inode 号，但较好的方式还是使用 find 命令，其不仅可查找某文件的软链接，还可以用于查找相同 inode 的所有硬链接。（见 <a href=\"#list8\">清单 8.</a>）</p>\n<h4 id=\"list8\"> 清单 8. 使用命令 find 查找软链接与硬链接 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">// 查找在路径 /home 下的文件 data.txt 的软链接</div><div class=\"line\"> # find /home -lname data.txt</div><div class=\"line\"> /home/harris/debug/test2/a</div><div class=\"line\"></div><div class=\"line\"> // 查看路径 /home 有相同 inode 的所有硬链接</div><div class=\"line\"> # find /home -samefile /home/harris/debug/test3/old.file</div><div class=\"line\"> /home/harris/debug/test3/hard.link</div><div class=\"line\"> /home/harris/debug/test3/old.file</div><div class=\"line\"></div><div class=\"line\"> # find /home -inum 660650</div><div class=\"line\"> /home/harris/debug/test3/hard.link</div><div class=\"line\"> /home/harris/debug/test3/old.file</div><div class=\"line\"></div><div class=\"line\"> // 列出路径 /home/harris/debug/ 下的所有软链接文件</div><div class=\"line\"> # find /home/harris/debug/ -type l -ls</div><div class=\"line\"> 656662 0 lrwxrwxrwx 1 harris harris 1 Sep 1 14:37 /home/harris/debug/test2/b -&gt; a</div><div class=\"line\"> 656627 0 lrwxrwxrwx 1 harris harris 8 Sep 1 14:37 /home/harris/debug/test2/a -&gt;</div><div class=\"line\"> data.txt</div><div class=\"line\"> 789467 0 lrwxrwxrwx 1 root root 8 Sep 1 18:00 /home/harris/debug/test/soft.link -&gt;</div><div class=\"line\"> old.file</div><div class=\"line\"> 789496    0 lrwxrwxrwx   1 root     root            7 Sep  1 18:01</div><div class=\"line\"> /home/harris/debug/test/soft.link.dir -&gt; old.dir</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;系统根据磁盘的大小默认设定了 inode 的值（见<a href=\"#list9\">清单 9.</a>），如若必要，可在格式文件系统前对该值进行修改。如键入命令 mkfs -t ext4 -I 512/dev/sda4，将使磁盘设备 /dev/sda4 格式成 inode 大小是 512 字节的 ext4 文件系统。</p>\n<h4 id=\"list9\"> 清单 9. 查看系统的 inode 值 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">// 查看磁盘分区 /dev/sda7 上的 inode 值</div><div class=\"line\"># dumpe2fs -h /dev/sda7 | grep &quot;Inode size&quot;</div><div class=\"line\">dumpe2fs 1.42 (29-Nov-2011)</div><div class=\"line\">Inode size: \t          256</div><div class=\"line\"></div><div class=\"line\"># tune2fs -l /dev/sda7 | grep &quot;Inode size&quot;</div><div class=\"line\">Inode size: \t          256</div></pre></td></tr></table></figure>\n<h3 id=\"Linux-VFS\"><a href=\"#Linux-VFS\" class=\"headerlink\" title=\"Linux VFS\"></a>Linux VFS</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux 有着极其丰富的文件系统，大体上可分如下几类：</p>\n<ol>\n<li>网络文件系统，如 nfs、cifs 等；</li>\n<li>磁盘文件系统，如 ext4、ext3 等；</li>\n<li>特殊文件系统，如 proc、sysfs、ramfs、tmpfs 等。</li>\n</ol>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实现以上这些文件系统并在 Linux 下共存的基础就是 Linux VFS（Virtual File System 又称 Virtual Filesystem Switch），即虚拟文件系统。VFS 作为一个通用的文件系统，抽象了文件系统的四个基本概念：文件、目录项 (dentry)、索引节点 (inode) 及挂载点，其在内核中为用户空间层的文件系统提供了相关的接口（见 <a href=\"#p3\">图 3.</a>所示 VFS 在 Linux 系统的架构）。VFS 实现了 open()、read() 等系统调并使得 cp 等用户空间程序可跨文件系统。VFS 真正实现了上述内容中：在 Linux 中除进程之外一切皆是文件。</p>\n<h4 id=\"p3\"> 图 3. VFS 在系统中的架构 </h4><br><img src=\"http://120.24.251.209/content/images/2016/03/image003.jpg\" alt=\"\"><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux VFS 存在四个基本对象：超级块对象 (superblock object)、索引节点对象 (inode object)、目录项对象 (dentry object) 及文件对象 (file object)。超级块对象代表一个已安装的文件系统；索引节点对象代表一个文件；目录项对象代表一个目录项，如设备文件 event5 在路径 /dev/input/event5 中，其存在四个目录项对象：/ 、dev/ 、input/ 及 event5。文件对象代表由进程打开的文件。这四个对象与进程及磁盘文件间的关系如<a href=\"#p4\">图 4.</a> 所示，其中 d_inode 即为硬链接。为文件路径的快速解析，Linux VFS 设计了目录项缓存（Directory Entry Cache，即 dcache）。<br><br><h4 id=\"p4\"> 图 4. VFS 的对象之间的处理 </h4><br><img src=\"http://120.24.251.209/content/images/2016/03/image004.jpg\" alt=\"\"><br><br><br>### Linux 文件系统中的 inode<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在 Linux 中，索引节点结构存在于系统内存及磁盘，其可区分成 VFS inode 与实际文件系统的 inode。VFS inode 作为实际文件系统中 inode 的抽象，定义了结构体 inode 与其相关的操作 inode_operations（见内核源码 include/linux/fs.h）。<br><br><h4 id=\"list10\"> 清单 10. VFS 中的 inode 与 inode_operations 结构体 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">struct inode &#123;</div><div class=\"line\">    ...</div><div class=\"line\">    const struct inode_operations   *i_op; // 索引节点操作</div><div class=\"line\">    unsigned long           i_ino;      // 索引节点号</div><div class=\"line\">    atomic_t                i_count;    // 引用计数器</div><div class=\"line\">    unsigned int            i_nlink;    // 硬链接数目</div><div class=\"line\">    ...</div><div class=\"line\"> &#125;</div><div class=\"line\"></div><div class=\"line\"> struct inode_operations &#123;</div><div class=\"line\">    ...</div><div class=\"line\">    int (*create) (struct inode *,struct dentry *,int, struct nameidata *);</div><div class=\"line\">    int (*link) (struct dentry *,struct inode *,struct dentry *);</div><div class=\"line\">    int (*unlink) (struct inode *,struct dentry *);</div><div class=\"line\">    int (*symlink) (struct inode *,struct dentry *,const char *);</div><div class=\"line\">    int (*mkdir) (struct inode *,struct dentry *,int);</div><div class=\"line\">    int (*rmdir) (struct inode *,struct dentry *);</div><div class=\"line\">    ...</div><div class=\"line\"> &#125;</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如<a href=\"#list10\">清单 10.</a> 所见，每个文件存在两个计数器：i_count 与 i_nlink，即引用计数与硬链接计数。结构体 inode 中的 i_count 用于跟踪文件被访问的数量，而 i_nlink 则是上述使用 ls -l 等命令查看到的文件硬链接数。或者说 i_count 跟踪文件在内存中的情况，而 i_nlink 则是磁盘计数器。当文件被删除时，则 i_nlink 先被设置成 0。文件的这两个计数器使得 Linux 系统升级或程序更新变的容易。系统或程序可在不关闭的情况下（即文件 i_count 不为 0），将新文件以同样的文件名进行替换，新文件有自己的 inode 及 data block，旧文件会在相关进程关闭后被完整的删除。</p>\n<h4 id=\"list11\"> 清单 11. 文件系统 ext4 中的 inode </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">struct ext4_inode &#123;</div><div class=\"line\">    ...</div><div class=\"line\">    __le32  i_atime;        // 文件内容最后一次访问时间</div><div class=\"line\">    __le32  i_ctime;        // inode 修改时间</div><div class=\"line\">    __le32  i_mtime;        // 文件内容最后一次修改时间</div><div class=\"line\">    __le16  i_links_count;  // 硬链接计数</div><div class=\"line\">    __le32  i_blocks_lo;    // Block 计数</div><div class=\"line\">    __le32  i_block[EXT4_N_BLOCKS];  // 指向具体的 block</div><div class=\"line\">    ...</div><div class=\"line\"> &#125;;</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"#list11\">清单 11.</a> 展示的是文件系统 ext4 中对 inode 的定义（见内核源码 fs/ext4/ext4.h）。其中三个时间的定义可对应与命令 stat 中查看到三个时间。i_links_count 不仅用于文件的硬链接计数，也用于目录的子目录数跟踪（目录并不显示硬链接数，命令 ls -ld 查看到的是子目录数）。由于文件系统 ext3 对 i_links_count 有限制，其最大数为：32000（该限制在 ext4 中被取消）。尝试在 ext3 文件系统上验证目录子目录及普通文件硬链接最大数可见 <a href=\"#list12\">清单 12.</a>的错误信息。因此实际文件系统的 inode 之间及与 VFS inode 相较是有差异的。</p>\n<h4 id=\"list12\"> 清单 12. 文件系统 ext3 中 i_links_count 的限制 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ./dirtest.sh</div><div class=\"line\">mkdir: cannot create directory `dir_31999&apos;: Too many links</div><div class=\"line\"></div><div class=\"line\"># ./linkcount.sh</div><div class=\"line\">ln: failed to create hard link to `old.file&apos;: Too many links</div></pre></td></tr></table></figure>\n<h3 id=\"结束语\"><a href=\"#结束语\" class=\"headerlink\" title=\"结束语\"></a>结束语</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文最初描述了 Linux 系统中文件与目录被引入的原因及 Linux 处理文件的方式，然后我们通过区分硬链接与软链接的不同，了解 Linux 中的索引节点的相关知识，并以此引出了 inode 的结构体。索引节点结构体存在在于 Linux VFS 以及实际文件系统中，VFS 作为通用文件模型是 Linux 中“一切皆是文件”实现的基础。文章并未深入 Linux VFS，也没涉及实际文件系统的实现，文章只是从 inode 了解 Linux 的文件系统的相关内容。若想深入文件系统的内容，查看内核文档 Documentation/filesystems/ 是一个不错的方式。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2> 从inode了解Linux文件系统</h2>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;硬链接与软链接是 Linux 文件系统中的一个重要概念，其涉及文件系统中的索引节点 (index node 又称 inode)，而索引节点对象是 Linux 虚拟文件系统 (VFS) 的四个基本概念之一。通过剖析硬链接与软链接的联系与区别，我们可更好的了解 Linux 中 VFS 这一通用文件模型。并让 Linux 普通用户和系统管理员正确使用硬链接与软链接，帮助文件系统开发者获取 inode 的相关知识。</p>\n<p><h3> Linux的文件系统与目录 </h3><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;现代操作系统为解决信息能独立于进程之外被长期存储引入了文件，文件作为进程创建信息的逻辑单元可被多个进程并发使用。在 UNIX 系统中，操作系统为磁盘上的文本与图像、鼠标与键盘等输入设备及网络交互等 I/O 操作设计了一组通用 API，使他们被处理时均可统一使用字节流方式。换言之，UNIX 系统中除进程之外的一切皆是文件，而 Linux 保持了这一特性。为了便于文件的管理，Linux 还引入了目录（有时亦被称为文件夹）这一概念。目录使文件可被分类管理，且目录的引入使 Linux 的文件系统形成一个层级结构的目录树。<a href=\"#list1\">清单1.</a>所示的是普通 Linux 系统的顶层目录结构，其中 /dev 是存放了设备相关文件的目录。</p>\n <h4 id='list1'> 清单 1. Linux系统的顶层目录结构</h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"> /              根目录</div><div class=\"line\">├── bin     存放用户二进制文件</div><div class=\"line\">├── boot    存放内核引导配置文件</div><div class=\"line\">├── dev     存放设备文件</div><div class=\"line\">├── etc     存放系统配置文件</div><div class=\"line\">├── home    用户主目录</div><div class=\"line\">├── lib     动态共享库</div><div class=\"line\">├── lost+found \t文件系统恢复时的恢复文件</div><div class=\"line\">├── media   可卸载存储介质挂载点</div><div class=\"line\">├── mnt     文件系统临时挂载点</div><div class=\"line\">├── opt     附加的应用程序包</div><div class=\"line\">├── proc    系统内存的映射目录，提供内核与进程信息</div><div class=\"line\">├── root    root 用户主目录</div><div class=\"line\">├── sbin    存放系统二进制文件</div><div class=\"line\">├── srv     存放服务相关数据</div><div class=\"line\">├── sys     sys 虚拟文件系统挂载点</div><div class=\"line\">├── tmp     存放临时文件</div><div class=\"line\">├── usr     存放用户应用程序</div><div class=\"line\">└── var     存放邮件、系统日志等变化文件</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux 将设备当做文件进行处理，<a href=\"#list2\">清单 2.</a>展示了如何打开设备文件 /dev/input/event5 并读取文件内容。文件 event5 表示一种输入设备，其可能是鼠标或键盘等。查看文件 /proc/bus/input/devices 可知 event5 对应设备的类型。设备文件 /dev/input/event5 使用 read() 以字符流的方式被读取。结构体 input_event 被定义在内核头文件 linux/input.h 中。</p>\n<h4 id='list2'> 清单 2.  打开并读取设备文件 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">int fd;</div><div class=\"line\">struct input_event ie;</div><div class=\"line\">fd = open(&quot;/dev/input/event5&quot;, O_RDONLY);</div><div class=\"line\">read(fd, &amp;ie, sizeof(struct input_event));</div><div class=\"line\">printf(&quot;type = %d  code = %d  value = %d\\n&quot;,</div><div class=\"line\">\t\t ie.type, ie.code, ie.value);</div><div class=\"line\">close(fd);</div></pre></td></tr></table></figure>\n<p><br /></p>\n<h3 id=\"硬链接与软链接的联系与区别\"><a href=\"#硬链接与软链接的联系与区别\" class=\"headerlink\" title=\"硬链接与软链接的联系与区别\"></a>硬链接与软链接的联系与区别</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们知道文件都有文件名与数据，这在 Linux 上被分成两个部分：用户数据 (user data) 与元数据 (metadata)。用户数据，即文件数据块 (data block)，数据块是记录文件真实内容的地方；而元数据则是文件的附加属性，如文件大小、创建时间、所有者等信息。在 Linux 中，元数据中的 inode 号（inode 是文件元数据的一部分但其并不包含文件名，inode 号即索引节点号）才是文件的唯一标识而非文件名。文件名仅是为了方便人们的记忆和使用，系统或程序通过 inode 号寻找正确的文件数据块。<a href=\"#p1\">图 1.</a>展示了程序通过文件名获取文件内容的过程。</p>\n<h4 id=\"p1\"> 图 1. 通过文件名打开文件 </h4><br><img src=\"http://120.24.251.209/content/images/2016/03/image001.jpg\" alt=\"\"><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在Linux 系统中查看 inode号可使用命令stat 或 ls -i（若是 AIX 系统，则使用命令 istat）。<a href=\"#list3\">清单 3.</a>中使用命令 mv 移动并重命名文件 glibc-2.16.0.tar.xz，其结果不影响文件的用户数据及 inode 号，文件移动前后 inode 号均为：2485677。<br><br><h4 id='list3'> 清单 3.  移动或重命名文件 </h4><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># stat /home/harris/source/glibc-2.16.0.tar.xz</div><div class=\"line\">  File: `/home/harris/source/glibc-2.16.0.tar.xz&apos;</div><div class=\"line\">  Size: 9990512   \t Blocks: 19520      IO Block: 4096   regular file</div><div class=\"line\"> Device: 807h/2055d \t Inode: 2485677     Links: 1</div><div class=\"line\"> Access: (0600/-rw-------)  Uid: ( 1000/  harris)   Gid: ( 1000/  harris)</div><div class=\"line\"> ...</div><div class=\"line\"> ...</div><div class=\"line\">// 经网友指出，使用mv移动时不跨磁盘inode号不变，如果跨磁盘inode会改变。</div><div class=\"line\"> # mv /home/harris/source/glibc-2.16.0.tar.xz /home/harris/Desktop/glibc.tar.xz</div><div class=\"line\"> # ls -i -F /home/harris/Desktop/glibc.tar.xz</div><div class=\"line\"> 2485677 /home/harris/Desktop/glibc.tar.xz</div></pre></td></tr></table></figure><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为解决文件的共享使用，Linux 系统引入了两种链接：硬链接 (hard link) 与软链接（又称符号链接，即 soft link 或 symbolic link）。链接为 Linux 系统解决了文件的共享使用，还带来了隐藏文件路径、增加权限安全及节省存储等好处。若一个 inode 号对应多个文件名，则称这些文件为硬链接。换言之，硬链接就是同一个文件使用了多个别名（见 <a href=\"#p2\">图 2.</a>hard link 就是 file 的一个别名，他们有共同的 inode）。硬链接可由命令 link 或 ln 创建。如下是对文件 oldfile 创建硬链接。<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">link oldfile newfile</div><div class=\"line\">ln oldfile newfile</div></pre></td></tr></table></figure><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于硬链接是有着相同 inode 号仅文件名不同的文件，因此硬链接存在以下几点特性：<br><br><em> 文件有相同的 inode 及 data block；\n</em> 只能对已存在的文件进行创建；<br><em> 不能交叉文件系统进行硬链接的创建；\n</em> 不能对目录进行创建，只可对文件创建；<br>* 删除一个硬链接文件并不影响其他有相同 inode 号的文件。<br><br><h4 id='list4'> 清单 4.  硬链接特性展示 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ls -li</div><div class=\"line\"> total 0</div><div class=\"line\"></div><div class=\"line\"> // 只能对已存在的文件创建硬连接</div><div class=\"line\"> # link old.file hard.link</div><div class=\"line\"> link: cannot create link `hard.link&apos; to `old.file&apos;: No such file or directory</div><div class=\"line\"></div><div class=\"line\"> # echo &quot;This is an original file&quot; &gt; old.file</div><div class=\"line\"> # cat old.file</div><div class=\"line\"> This is an original file</div><div class=\"line\"> # stat old.file</div><div class=\"line\">  File: `old.file&apos;</div><div class=\"line\">  Size: 25        \t Blocks: 8          IO Block: 4096   regular file</div><div class=\"line\"> Device: 807h/2055d \t Inode: 660650      Links: 2</div><div class=\"line\"> Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class=\"line\"> ...</div><div class=\"line\"> // 文件有相同的 inode 号以及 data block</div><div class=\"line\"> # link old.file hard.link | ls -li</div><div class=\"line\"> total 8</div><div class=\"line\"> 660650 -rw-r--r-- 2 root root 25 Sep  1 17:44 hard.link</div><div class=\"line\"> 660650 -rw-r--r-- 2 root root 25 Sep  1 17:44 old.file</div><div class=\"line\"></div><div class=\"line\"> // 不能交叉文件系统</div><div class=\"line\"> # ln /dev/input/event5 /root/bfile.txt</div><div class=\"line\"> ln: failed to create hard link `/root/bfile.txt&apos; =&gt; `/dev/input/event5&apos;:</div><div class=\"line\"> Invalid cross-device link</div><div class=\"line\"></div><div class=\"line\"> // 不能对目录进行创建硬连接</div><div class=\"line\"> # mkdir -p old.dir/test</div><div class=\"line\"> # ln old.dir/ hardlink.dir</div><div class=\"line\"> ln: `old.dir/&apos;: hard link not allowed for directory</div><div class=\"line\"> # ls -iF</div><div class=\"line\"> 660650 hard.link  657948 old.dir/  660650 old.file</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;文件 old.file 与 hard.link 有着相同的 inode 号：660650 及文件权限，inode 是随着文件的存在而存在，因此只有当文件存在时才可创建硬链接，即当 inode 存在且链接计数器（link count）不为 0 时。inode 号仅在各文件系统下是唯一的，当 Linux 挂载多个文件系统后将出现 inode 号重复的现象（如<a href=\"#list5\">清单 5.</a>所示，文件 t3.jpg、sync 及 123.txt 并无关联，却有着相同的 inode 号），因此硬链接创建时不可跨文件系统。设备文件目录 /dev 使用的文件系统是 devtmpfs，而 /root（与根目录 / 一致）使用的是磁盘文件系统 ext4。<a href=\"#list5\">清单 5.</a>展示了使用命令 df 查看当前系统中挂载的文件系统类型、各文件系统 inode 使用情况及文件系统挂载点。</p>\n<h4 id='list5'> 清单 5.  查找有相同 inode 号的文件 </h4><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"># df -i --print-type</div><div class=\"line\"> Filesystem     Type       Inodes  IUsed    IFree IUse% Mounted on</div><div class=\"line\"> /dev/sda7      ext4      3147760 283483  2864277   10% /</div><div class=\"line\"> udev           devtmpfs   496088    553   495535    1% /dev</div><div class=\"line\"> tmpfs          tmpfs      499006    491   498515    1% /run</div><div class=\"line\"> none           tmpfs      499006      3   499003    1% /run/lock</div><div class=\"line\"> none           tmpfs      499006     15   498991    1% /run/shm</div><div class=\"line\"> /dev/sda6      fuseblk  74383900   4786 74379114    1% /media/DiskE</div><div class=\"line\"> /dev/sda8      fuseblk  29524592  19939 29504653    1% /media/DiskF</div><div class=\"line\"></div><div class=\"line\"> # find / -inum 1114</div><div class=\"line\"> /media/DiskE/Pictures/t3.jpg</div><div class=\"line\"> /media/DiskF/123.txt</div><div class=\"line\"> /bin/sync</div></pre></td></tr></table></figure><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;值得一提的是，Linux 系统存在 inode 号被用完但磁盘空间还有剩余的情况。我们创建一个 5M 大小的 ext4 类型的 mo.img 文件，并将其挂载至目录 /mnt。然后我们使用一个 shell 脚本将挂载在 /mnt 下 ext4 文件系统的 indoe 耗尽（见<a href=\"#list6\">清单 6.</a>）。<br><br><h4 id='list6'> 清单 6.  测试文件系统 inode 耗尽但仍有磁盘空间的情景 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"># dd if=/dev/zero of=mo.img bs=5120k count=1</div><div class=\"line\"># ls -lh mo.img</div><div class=\"line\">-rw-r--r-- 1 root root 5.0M Sep  1 17:54 mo.img</div><div class=\"line\"># mkfs -t ext4  -F ./mo.img</div><div class=\"line\">...</div><div class=\"line\">OS type: Linux</div><div class=\"line\">Block size=1024 (log=0)</div><div class=\"line\">Fragment size=1024 (log=0)</div><div class=\"line\">Stride=0 blocks, Stripe width=0 blocks</div><div class=\"line\">1280 inodes, 5120 blocks</div><div class=\"line\">256 blocks (5.00%) reserved for the super user</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\">Writing superblocks and filesystem accounting information: done</div><div class=\"line\"></div><div class=\"line\"># mount -o loop ./mo.img /mnt</div><div class=\"line\"># cat /mnt/inode_test.sh</div><div class=\"line\">#!/bin/bash</div><div class=\"line\"></div><div class=\"line\">for ((i = 1; ; i++))</div><div class=\"line\">do</div><div class=\"line\">   if [ $? -eq 0 ]; then</div><div class=\"line\">       echo  &quot;This is file_$i&quot; &gt; file_$i</div><div class=\"line\">   else</div><div class=\"line\">       exit 0</div><div class=\"line\">   fi</div><div class=\"line\">done</div><div class=\"line\"></div><div class=\"line\"># ./inode_test.sh</div><div class=\"line\">./inode_test.sh: line 6: file_1269: No space left on device</div><div class=\"line\"></div><div class=\"line\"># df -iT /mnt/; du -sh /mnt/</div><div class=\"line\">Filesystem     Type Inodes IUsed IFree IUse% Mounted on</div><div class=\"line\">/dev/loop0     ext4   1280  1280     0  100% /mnt</div><div class=\"line\">1.3M \t /mnt/</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;硬链接不能对目录创建是受限于文件系统的设计（见 <a href=\"#list4\">清单 4.</a>对目录创建硬链接将失败）。现 Linux 文件系统中的目录均隐藏了两个个特殊的目录：当前目录（.）与父目录（..）。查看这两个特殊目录的 inode 号可知其实这两目录就是两个硬链接（注意目录 /mnt/lost+found/ 的 inode 号）。若系统允许对目录创建硬链接，则会产生目录环。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ls -aliF /mnt/lost+found</div><div class=\"line\">total 44</div><div class=\"line\">11 drwx------ 2 root root 12288 Sep  1 17:54 ./</div><div class=\"line\">2 drwxr-xr-x 3 root root 31744 Sep  1 17:57 ../</div><div class=\"line\"></div><div class=\"line\"># stat  /mnt/lost+found/</div><div class=\"line\"> File: `/mnt/lost+found/&apos;</div><div class=\"line\"> Size: 12288     \t Blocks: 24         IO Block: 1024   directory</div><div class=\"line\">Device: 700h/1792d \t Inode: 11          Links: 2</div><div class=\"line\">Access: (0700/drwx------)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class=\"line\">Access: 2012-09-01 17:57:17.000000000 +0800</div><div class=\"line\">Modify: 2012-09-01 17:54:49.000000000 +0800</div><div class=\"line\">Change: 2012-09-01 17:54:49.000000000 +0800</div><div class=\"line\">Birth: -</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;软链接与硬链接不同，若文件用户数据块中存放的内容是另一文件的路径名的指向，则该文件就是软连接。软链接就是一个普通文件，只是数据块内容有点特殊。软链接有着自己的 inode 号以及用户数据块（见 <a href=\"#p2\">图 2.</a>）。因此软链接的创建与使用没有类似硬链接的诸多限制：</p>\n<ul>\n<li>软链接有自己的文件属性及权限等；</li>\n<li>可对不存在的文件或目录创建软链接；</li>\n<li>软链接可交叉文件系统；</li>\n<li>软链接可对文件或目录创建；</li>\n<li>创建软链接时，链接计数 i_nlink 不会增加；</li>\n<li>删除软链接并不影响被指向的文件，但若被指向的原文件被删除，则相关软连接被称为死链接（即 dangling link，若被指向路径文件被重新创建，死链接可恢复为正常的软链接）。</li>\n</ul>\n<h4 id=\"p2\">  图 2. 软链接的访问 </h4><br><img src=\"http://120.24.251.209/content/images/2016/03/image002.jpg\" alt=\"\"><br><br><h4 id='list7'> 清单 7. 软链接特性展示 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ls -li</div><div class=\"line\"> total 0</div><div class=\"line\"></div><div class=\"line\"> // 可对不存在的文件创建软链接</div><div class=\"line\"> # ln -s old.file soft.link</div><div class=\"line\"> # ls -liF</div><div class=\"line\"> total 0</div><div class=\"line\"> 789467 lrwxrwxrwx 1 root root 8 Sep  1 18:00 soft.link -&gt; old.file</div><div class=\"line\"></div><div class=\"line\"> // 由于被指向的文件不存在，此时的软链接 soft.link 就是死链接</div><div class=\"line\"> # cat soft.link</div><div class=\"line\"> cat: soft.link: No such file or directory</div><div class=\"line\"></div><div class=\"line\"> // 创建被指向的文件 old.file，soft.link 恢复成正常的软链接</div><div class=\"line\"> # echo &quot;This is an original file_A&quot; &gt;&gt; old.file</div><div class=\"line\"> # cat soft.link</div><div class=\"line\"> This is an original file_A</div><div class=\"line\"></div><div class=\"line\"> // 对不存在的目录创建软链接</div><div class=\"line\"> # ln -s old.dir soft.link.dir</div><div class=\"line\"> # mkdir -p old.dir/test</div><div class=\"line\"> # tree . -F --inodes</div><div class=\"line\"> .</div><div class=\"line\">├── [ 789497]  old.dir/</div><div class=\"line\">│   └── [ 789498]  test/</div><div class=\"line\">├── [ 789495]  old.file</div><div class=\"line\">├── [ 789495]  soft.link -&gt; old.file</div><div class=\"line\">└── [ 789497]  soft.link.dir -&gt; old.dir/</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当然软链接的用户数据也可以是另一个软链接的路径，其解析过程是递归的。但需注意：软链接创建时原文件的路径指向使用绝对路径较好。使用相对路径创建的软链接被移动后该软链接文件将成为一个死链接（如下所示的软链接 a 使用了相对路径，因此不宜被移动），因为链接数据块中记录的亦是相对路径指向。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ ls -li</div><div class=\"line\">total 2136</div><div class=\"line\">656627 lrwxrwxrwx 1 harris harris       8 Sep  1 14:37 a -&gt; data.txt</div><div class=\"line\">656662 lrwxrwxrwx 1 harris harris       1 Sep  1 14:37 b -&gt; a</div><div class=\"line\">656228 -rw------- 1 harris harris 2186738 Sep  1 14:37 data.txt 6</div></pre></td></tr></table></figure>\n<h3 id=\"链接相关的命令\"><a href=\"#链接相关的命令\" class=\"headerlink\" title=\"链接相关的命令\"></a>链接相关的命令</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在 Linux 中查看当前系统已挂着的文件系统类型，除上述使用的命令 df，还可使用命令 mount 或查看文件 /proc/mounts。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"># mount</div><div class=\"line\">/dev/sda7 on / type ext4 (rw,errors=remount-ro)</div><div class=\"line\">proc on /proc type proc (rw,noexec,nosuid,nodev)</div><div class=\"line\">sysfs on /sys type sysfs (rw,noexec,nosuid,nodev)</div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\">none on /run/shm type tmpfs (rw,nosuid,nodev)</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;命令 ls 或 stat 可帮助我们区分软链接与其他文件并查看文件 inode 号，但较好的方式还是使用 find 命令，其不仅可查找某文件的软链接，还可以用于查找相同 inode 的所有硬链接。（见 <a href=\"#list8\">清单 8.</a>）</p>\n<h4 id='list8'> 清单 8. 使用命令 find 查找软链接与硬链接 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">// 查找在路径 /home 下的文件 data.txt 的软链接</div><div class=\"line\"> # find /home -lname data.txt</div><div class=\"line\"> /home/harris/debug/test2/a</div><div class=\"line\"></div><div class=\"line\"> // 查看路径 /home 有相同 inode 的所有硬链接</div><div class=\"line\"> # find /home -samefile /home/harris/debug/test3/old.file</div><div class=\"line\"> /home/harris/debug/test3/hard.link</div><div class=\"line\"> /home/harris/debug/test3/old.file</div><div class=\"line\"></div><div class=\"line\"> # find /home -inum 660650</div><div class=\"line\"> /home/harris/debug/test3/hard.link</div><div class=\"line\"> /home/harris/debug/test3/old.file</div><div class=\"line\"></div><div class=\"line\"> // 列出路径 /home/harris/debug/ 下的所有软链接文件</div><div class=\"line\"> # find /home/harris/debug/ -type l -ls</div><div class=\"line\"> 656662 0 lrwxrwxrwx 1 harris harris 1 Sep 1 14:37 /home/harris/debug/test2/b -&gt; a</div><div class=\"line\"> 656627 0 lrwxrwxrwx 1 harris harris 8 Sep 1 14:37 /home/harris/debug/test2/a -&gt;</div><div class=\"line\"> data.txt</div><div class=\"line\"> 789467 0 lrwxrwxrwx 1 root root 8 Sep 1 18:00 /home/harris/debug/test/soft.link -&gt;</div><div class=\"line\"> old.file</div><div class=\"line\"> 789496    0 lrwxrwxrwx   1 root     root            7 Sep  1 18:01</div><div class=\"line\"> /home/harris/debug/test/soft.link.dir -&gt; old.dir</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;系统根据磁盘的大小默认设定了 inode 的值（见<a href=\"#list9\">清单 9.</a>），如若必要，可在格式文件系统前对该值进行修改。如键入命令 mkfs -t ext4 -I 512/dev/sda4，将使磁盘设备 /dev/sda4 格式成 inode 大小是 512 字节的 ext4 文件系统。</p>\n<h4 id='list9'> 清单 9. 查看系统的 inode 值 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">// 查看磁盘分区 /dev/sda7 上的 inode 值</div><div class=\"line\"># dumpe2fs -h /dev/sda7 | grep &quot;Inode size&quot;</div><div class=\"line\">dumpe2fs 1.42 (29-Nov-2011)</div><div class=\"line\">Inode size: \t          256</div><div class=\"line\"></div><div class=\"line\"># tune2fs -l /dev/sda7 | grep &quot;Inode size&quot;</div><div class=\"line\">Inode size: \t          256</div></pre></td></tr></table></figure>\n<h3 id=\"Linux-VFS\"><a href=\"#Linux-VFS\" class=\"headerlink\" title=\"Linux VFS\"></a>Linux VFS</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux 有着极其丰富的文件系统，大体上可分如下几类：</p>\n<ol>\n<li>网络文件系统，如 nfs、cifs 等；</li>\n<li>磁盘文件系统，如 ext4、ext3 等；</li>\n<li>特殊文件系统，如 proc、sysfs、ramfs、tmpfs 等。</li>\n</ol>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实现以上这些文件系统并在 Linux 下共存的基础就是 Linux VFS（Virtual File System 又称 Virtual Filesystem Switch），即虚拟文件系统。VFS 作为一个通用的文件系统，抽象了文件系统的四个基本概念：文件、目录项 (dentry)、索引节点 (inode) 及挂载点，其在内核中为用户空间层的文件系统提供了相关的接口（见 <a href=\"#p3\">图 3.</a>所示 VFS 在 Linux 系统的架构）。VFS 实现了 open()、read() 等系统调并使得 cp 等用户空间程序可跨文件系统。VFS 真正实现了上述内容中：在 Linux 中除进程之外一切皆是文件。</p>\n<h4 id='p3'> 图 3. VFS 在系统中的架构 </h4><br><img src=\"http://120.24.251.209/content/images/2016/03/image003.jpg\" alt=\"\"><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linux VFS 存在四个基本对象：超级块对象 (superblock object)、索引节点对象 (inode object)、目录项对象 (dentry object) 及文件对象 (file object)。超级块对象代表一个已安装的文件系统；索引节点对象代表一个文件；目录项对象代表一个目录项，如设备文件 event5 在路径 /dev/input/event5 中，其存在四个目录项对象：/ 、dev/ 、input/ 及 event5。文件对象代表由进程打开的文件。这四个对象与进程及磁盘文件间的关系如<a href=\"#p4\">图 4.</a> 所示，其中 d_inode 即为硬链接。为文件路径的快速解析，Linux VFS 设计了目录项缓存（Directory Entry Cache，即 dcache）。<br><br><h4 id='p4'> 图 4. VFS 的对象之间的处理 </h4><br><img src=\"http://120.24.251.209/content/images/2016/03/image004.jpg\" alt=\"\"><br><br><br>### Linux 文件系统中的 inode<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在 Linux 中，索引节点结构存在于系统内存及磁盘，其可区分成 VFS inode 与实际文件系统的 inode。VFS inode 作为实际文件系统中 inode 的抽象，定义了结构体 inode 与其相关的操作 inode_operations（见内核源码 include/linux/fs.h）。<br><br><h4 id='list10'> 清单 10. VFS 中的 inode 与 inode_operations 结构体 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">struct inode &#123;</div><div class=\"line\">    ...</div><div class=\"line\">    const struct inode_operations   *i_op; // 索引节点操作</div><div class=\"line\">    unsigned long           i_ino;      // 索引节点号</div><div class=\"line\">    atomic_t                i_count;    // 引用计数器</div><div class=\"line\">    unsigned int            i_nlink;    // 硬链接数目</div><div class=\"line\">    ...</div><div class=\"line\"> &#125;</div><div class=\"line\"></div><div class=\"line\"> struct inode_operations &#123;</div><div class=\"line\">    ...</div><div class=\"line\">    int (*create) (struct inode *,struct dentry *,int, struct nameidata *);</div><div class=\"line\">    int (*link) (struct dentry *,struct inode *,struct dentry *);</div><div class=\"line\">    int (*unlink) (struct inode *,struct dentry *);</div><div class=\"line\">    int (*symlink) (struct inode *,struct dentry *,const char *);</div><div class=\"line\">    int (*mkdir) (struct inode *,struct dentry *,int);</div><div class=\"line\">    int (*rmdir) (struct inode *,struct dentry *);</div><div class=\"line\">    ...</div><div class=\"line\"> &#125;</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如<a href=\"#list10\">清单 10.</a> 所见，每个文件存在两个计数器：i_count 与 i_nlink，即引用计数与硬链接计数。结构体 inode 中的 i_count 用于跟踪文件被访问的数量，而 i_nlink 则是上述使用 ls -l 等命令查看到的文件硬链接数。或者说 i_count 跟踪文件在内存中的情况，而 i_nlink 则是磁盘计数器。当文件被删除时，则 i_nlink 先被设置成 0。文件的这两个计数器使得 Linux 系统升级或程序更新变的容易。系统或程序可在不关闭的情况下（即文件 i_count 不为 0），将新文件以同样的文件名进行替换，新文件有自己的 inode 及 data block，旧文件会在相关进程关闭后被完整的删除。</p>\n<h4 id='list11'> 清单 11. 文件系统 ext4 中的 inode </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">struct ext4_inode &#123;</div><div class=\"line\">    ...</div><div class=\"line\">    __le32  i_atime;        // 文件内容最后一次访问时间</div><div class=\"line\">    __le32  i_ctime;        // inode 修改时间</div><div class=\"line\">    __le32  i_mtime;        // 文件内容最后一次修改时间</div><div class=\"line\">    __le16  i_links_count;  // 硬链接计数</div><div class=\"line\">    __le32  i_blocks_lo;    // Block 计数</div><div class=\"line\">    __le32  i_block[EXT4_N_BLOCKS];  // 指向具体的 block</div><div class=\"line\">    ...</div><div class=\"line\"> &#125;;</div></pre></td></tr></table></figure>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"#list11\">清单 11.</a> 展示的是文件系统 ext4 中对 inode 的定义（见内核源码 fs/ext4/ext4.h）。其中三个时间的定义可对应与命令 stat 中查看到三个时间。i_links_count 不仅用于文件的硬链接计数，也用于目录的子目录数跟踪（目录并不显示硬链接数，命令 ls -ld 查看到的是子目录数）。由于文件系统 ext3 对 i_links_count 有限制，其最大数为：32000（该限制在 ext4 中被取消）。尝试在 ext3 文件系统上验证目录子目录及普通文件硬链接最大数可见 <a href=\"#list12\">清单 12.</a>的错误信息。因此实际文件系统的 inode 之间及与 VFS inode 相较是有差异的。</p>\n<h4 id='list12'> 清单 12. 文件系统 ext3 中 i_links_count 的限制 </h4>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># ./dirtest.sh</div><div class=\"line\">mkdir: cannot create directory `dir_31999&apos;: Too many links</div><div class=\"line\"></div><div class=\"line\"># ./linkcount.sh</div><div class=\"line\">ln: failed to create hard link to `old.file&apos;: Too many links</div></pre></td></tr></table></figure>\n<h3 id=\"结束语\"><a href=\"#结束语\" class=\"headerlink\" title=\"结束语\"></a>结束语</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文最初描述了 Linux 系统中文件与目录被引入的原因及 Linux 处理文件的方式，然后我们通过区分硬链接与软链接的不同，了解 Linux 中的索引节点的相关知识，并以此引出了 inode 的结构体。索引节点结构体存在在于 Linux VFS 以及实际文件系统中，VFS 作为通用文件模型是 Linux 中“一切皆是文件”实现的基础。文章并未深入 Linux VFS，也没涉及实际文件系统的实现，文章只是从 inode 了解 Linux 的文件系统的相关内容。若想深入文件系统的内容，查看内核文档 Documentation/filesystems/ 是一个不错的方式。</p>\n"},{"title":"生活在别处","id":"10016","date":"2017-01-09T16:34:54.000Z","_content":"\n\n生活在别处，第一次看到这句话的时候是初中，便在之后的许多年间未曾忘记。\n\n第一我不懂为何“生活在别处”，生活如何在别处？生活不应再当下？生活如影随行，在你忙忙碌碌烦烦烦烦时，生活就在这里，在你快快乐乐时，生活还在这里，我一直以为所见所行就是生活；可是，随着生长，你依旧在这里，而生活早已飘落别处。\n\n“生活在别处”是法国诗人兰波的一句名言，而他用一生践行了这句话，他一生都在出走，从法国到英国而后非洲，兰波一生都在出走，直到最后死去；他是一位无法被归类的诗人，放荡不羁，与魏尔伦的爱情，新世界的开创者，兰波一生都在尝试不同的人生，就像他说的：“我愿成为任何人”。\n\n> *《全蝕狂愛》 1995 ，描述了兰波的故事，与魏尔伦的爱情。由李奥纳多扮演。*\n\n我不会写故事，更多的用来记录我的生活，本来今天晚上准备写些什么，如何关于整理笔记之类，下班日常刷知乎，看到《这个杀手不太冷》中一句话，“生活一直是那么艰难吗？还是只有小时候是这样？” “一直是。”脑海里就浮现了“生活在别处”这句话，随着人生阅历的成长，对这几句话的理解，也是不断加深； 所以，回来写下这段文字。\n\n我一直试着找出自身的问题，我一直努力和生活更好地相处，我其实并不知道如何规划，我能感受到生命中特别重要的东西，要拼尽所有力气去抓住；我不喜欢去做承诺，我所能做的就是一直努力去做；在我们的人生中肯定会存在一些望不到顶的大山，可能我穷尽一生也无法看到山顶的景色和山的那边的一切，这的确是一件想想就很难过的事情，并且这一切无法逃避，听起来是那么地令人绝望，但是，亲爱的，我们总要去面对，或是大步向前，冲向那满是荆棘望不到顶的大山，要打败可以吃掉我们的大老虎，一次又一次，我们会经常失败，摔倒，伤痕累累，可是我总要爬起来，一次又一次，每次都像是用尽整个生命的力量，也许我们真的最后跌倒爬不起来了，也许我们最后真的无法凝聚一丝力量，那至少，我们明白我是真的做不到，而不是说从一开始就放弃，努力让自己变更好；嗯，方向也很重要。\n\n好了，我还要去整理笔记，然后早点睡觉，今天心情不太好，可身边总有些美丽的人，谢谢！\n\n最后，生活一直是那么艰难吗？\n","source":"_posts/生活在别处.md","raw":"---\ntitle: 生活在别处\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: sheng-huo-zai-bie-chu\nid: 10016\ndate: 2017-01-10 00:34:54\n---\n\n\n生活在别处，第一次看到这句话的时候是初中，便在之后的许多年间未曾忘记。\n\n第一我不懂为何“生活在别处”，生活如何在别处？生活不应再当下？生活如影随行，在你忙忙碌碌烦烦烦烦时，生活就在这里，在你快快乐乐时，生活还在这里，我一直以为所见所行就是生活；可是，随着生长，你依旧在这里，而生活早已飘落别处。\n\n“生活在别处”是法国诗人兰波的一句名言，而他用一生践行了这句话，他一生都在出走，从法国到英国而后非洲，兰波一生都在出走，直到最后死去；他是一位无法被归类的诗人，放荡不羁，与魏尔伦的爱情，新世界的开创者，兰波一生都在尝试不同的人生，就像他说的：“我愿成为任何人”。\n\n> *《全蝕狂愛》 1995 ，描述了兰波的故事，与魏尔伦的爱情。由李奥纳多扮演。*\n\n我不会写故事，更多的用来记录我的生活，本来今天晚上准备写些什么，如何关于整理笔记之类，下班日常刷知乎，看到《这个杀手不太冷》中一句话，“生活一直是那么艰难吗？还是只有小时候是这样？” “一直是。”脑海里就浮现了“生活在别处”这句话，随着人生阅历的成长，对这几句话的理解，也是不断加深； 所以，回来写下这段文字。\n\n我一直试着找出自身的问题，我一直努力和生活更好地相处，我其实并不知道如何规划，我能感受到生命中特别重要的东西，要拼尽所有力气去抓住；我不喜欢去做承诺，我所能做的就是一直努力去做；在我们的人生中肯定会存在一些望不到顶的大山，可能我穷尽一生也无法看到山顶的景色和山的那边的一切，这的确是一件想想就很难过的事情，并且这一切无法逃避，听起来是那么地令人绝望，但是，亲爱的，我们总要去面对，或是大步向前，冲向那满是荆棘望不到顶的大山，要打败可以吃掉我们的大老虎，一次又一次，我们会经常失败，摔倒，伤痕累累，可是我总要爬起来，一次又一次，每次都像是用尽整个生命的力量，也许我们真的最后跌倒爬不起来了，也许我们最后真的无法凝聚一丝力量，那至少，我们明白我是真的做不到，而不是说从一开始就放弃，努力让自己变更好；嗯，方向也很重要。\n\n好了，我还要去整理笔记，然后早点睡觉，今天心情不太好，可身边总有些美丽的人，谢谢！\n\n最后，生活一直是那么艰难吗？\n","slug":"sheng-huo-zai-bie-chu","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqf0009641tpgi1jz7ff","content":"<p>生活在别处，第一次看到这句话的时候是初中，便在之后的许多年间未曾忘记。</p>\n<p>第一我不懂为何“生活在别处”，生活如何在别处？生活不应再当下？生活如影随行，在你忙忙碌碌烦烦烦烦时，生活就在这里，在你快快乐乐时，生活还在这里，我一直以为所见所行就是生活；可是，随着生长，你依旧在这里，而生活早已飘落别处。</p>\n<p>“生活在别处”是法国诗人兰波的一句名言，而他用一生践行了这句话，他一生都在出走，从法国到英国而后非洲，兰波一生都在出走，直到最后死去；他是一位无法被归类的诗人，放荡不羁，与魏尔伦的爱情，新世界的开创者，兰波一生都在尝试不同的人生，就像他说的：“我愿成为任何人”。</p>\n<blockquote>\n<p><em>《全蝕狂愛》 1995 ，描述了兰波的故事，与魏尔伦的爱情。由李奥纳多扮演。</em></p>\n</blockquote>\n<p>我不会写故事，更多的用来记录我的生活，本来今天晚上准备写些什么，如何关于整理笔记之类，下班日常刷知乎，看到《这个杀手不太冷》中一句话，“生活一直是那么艰难吗？还是只有小时候是这样？” “一直是。”脑海里就浮现了“生活在别处”这句话，随着人生阅历的成长，对这几句话的理解，也是不断加深； 所以，回来写下这段文字。</p>\n<p>我一直试着找出自身的问题，我一直努力和生活更好地相处，我其实并不知道如何规划，我能感受到生命中特别重要的东西，要拼尽所有力气去抓住；我不喜欢去做承诺，我所能做的就是一直努力去做；在我们的人生中肯定会存在一些望不到顶的大山，可能我穷尽一生也无法看到山顶的景色和山的那边的一切，这的确是一件想想就很难过的事情，并且这一切无法逃避，听起来是那么地令人绝望，但是，亲爱的，我们总要去面对，或是大步向前，冲向那满是荆棘望不到顶的大山，要打败可以吃掉我们的大老虎，一次又一次，我们会经常失败，摔倒，伤痕累累，可是我总要爬起来，一次又一次，每次都像是用尽整个生命的力量，也许我们真的最后跌倒爬不起来了，也许我们最后真的无法凝聚一丝力量，那至少，我们明白我是真的做不到，而不是说从一开始就放弃，努力让自己变更好；嗯，方向也很重要。</p>\n<p>好了，我还要去整理笔记，然后早点睡觉，今天心情不太好，可身边总有些美丽的人，谢谢！</p>\n<p>最后，生活一直是那么艰难吗？</p>\n","site":{"data":{}},"excerpt":"","more":"<p>生活在别处，第一次看到这句话的时候是初中，便在之后的许多年间未曾忘记。</p>\n<p>第一我不懂为何“生活在别处”，生活如何在别处？生活不应再当下？生活如影随行，在你忙忙碌碌烦烦烦烦时，生活就在这里，在你快快乐乐时，生活还在这里，我一直以为所见所行就是生活；可是，随着生长，你依旧在这里，而生活早已飘落别处。</p>\n<p>“生活在别处”是法国诗人兰波的一句名言，而他用一生践行了这句话，他一生都在出走，从法国到英国而后非洲，兰波一生都在出走，直到最后死去；他是一位无法被归类的诗人，放荡不羁，与魏尔伦的爱情，新世界的开创者，兰波一生都在尝试不同的人生，就像他说的：“我愿成为任何人”。</p>\n<blockquote>\n<p><em>《全蝕狂愛》 1995 ，描述了兰波的故事，与魏尔伦的爱情。由李奥纳多扮演。</em></p>\n</blockquote>\n<p>我不会写故事，更多的用来记录我的生活，本来今天晚上准备写些什么，如何关于整理笔记之类，下班日常刷知乎，看到《这个杀手不太冷》中一句话，“生活一直是那么艰难吗？还是只有小时候是这样？” “一直是。”脑海里就浮现了“生活在别处”这句话，随着人生阅历的成长，对这几句话的理解，也是不断加深； 所以，回来写下这段文字。</p>\n<p>我一直试着找出自身的问题，我一直努力和生活更好地相处，我其实并不知道如何规划，我能感受到生命中特别重要的东西，要拼尽所有力气去抓住；我不喜欢去做承诺，我所能做的就是一直努力去做；在我们的人生中肯定会存在一些望不到顶的大山，可能我穷尽一生也无法看到山顶的景色和山的那边的一切，这的确是一件想想就很难过的事情，并且这一切无法逃避，听起来是那么地令人绝望，但是，亲爱的，我们总要去面对，或是大步向前，冲向那满是荆棘望不到顶的大山，要打败可以吃掉我们的大老虎，一次又一次，我们会经常失败，摔倒，伤痕累累，可是我总要爬起来，一次又一次，每次都像是用尽整个生命的力量，也许我们真的最后跌倒爬不起来了，也许我们最后真的无法凝聚一丝力量，那至少，我们明白我是真的做不到，而不是说从一开始就放弃，努力让自己变更好；嗯，方向也很重要。</p>\n<p>好了，我还要去整理笔记，然后早点睡觉，今天心情不太好，可身边总有些美丽的人，谢谢！</p>\n<p>最后，生活一直是那么艰难吗？</p>\n"},{"title":"生者孤独","id":"10017","date":"2016-09-19T16:34:54.000Z","_content":"\n\n小王子说：有一天，我看了四十四次日落！\n\n李寻欢问阿飞：你看这棵树上的梅花已经开了，你可知道已经开了多少朵？\n\n孔乙己问：你可知道茴的四种写法？\n\n鲁迅说：楼下一个男人病的要死，那间壁的一家唱着留声机；对面是弄孩子，楼上有两人狂笑，还有打牌声，河中的穿上有女人哭着她死去的母亲，人类的悲欢并不相通，我只是觉得她们吵闹。\n\n大话西游中说：你看那个人，好像一条狗！\n\n一千个读者，有一千个哈姆雷特！\n\n一个人走的太远太久了，便看腻了人潮似海。\n\n如果问，你所理解的孤独是什么？大概每个人都有自己的答案吧。\n\n突然觉得，原本以为亲密无间的伙伴并没有把我当朋友。\n\n小心翼翼地与人相处，把她当作真诚的伙伴，害怕隔阂，害怕犯错。\n\n或许，你所害怕的不是失去某个朋友，而是不够勇敢地去面对一个人的孤独。\n\n有人说，最孤独的事，不是不能跟一个人在一起，而是你根本不知道想跟谁在一起...\n\n其实，我们生来就是孤独;\n\n生命的本质就是孤独，不管你拥有什么，我们生来就是孤独。\n\n出现在这个世界本来就是一个偶然的事，谣言嘈杂的社会，人来人往，浮光掠影，匆匆碌碌。\n\n这个世界永远都是陌生的，理解是奢侈的，你永远想不起来来时的路，你永远无法让一个人不离你而去。\n\n不管你拥有什么，我们生来就是孤独。\n\n当我年轻的时候我想变成任何人除了我自己。\n","source":"_posts/生者孤独.md","raw":"---\ntitle: 生者孤独\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: life-is-alone\nid: 10017\ndate: 2016-09-20 00:34:54\n---\n\n\n小王子说：有一天，我看了四十四次日落！\n\n李寻欢问阿飞：你看这棵树上的梅花已经开了，你可知道已经开了多少朵？\n\n孔乙己问：你可知道茴的四种写法？\n\n鲁迅说：楼下一个男人病的要死，那间壁的一家唱着留声机；对面是弄孩子，楼上有两人狂笑，还有打牌声，河中的穿上有女人哭着她死去的母亲，人类的悲欢并不相通，我只是觉得她们吵闹。\n\n大话西游中说：你看那个人，好像一条狗！\n\n一千个读者，有一千个哈姆雷特！\n\n一个人走的太远太久了，便看腻了人潮似海。\n\n如果问，你所理解的孤独是什么？大概每个人都有自己的答案吧。\n\n突然觉得，原本以为亲密无间的伙伴并没有把我当朋友。\n\n小心翼翼地与人相处，把她当作真诚的伙伴，害怕隔阂，害怕犯错。\n\n或许，你所害怕的不是失去某个朋友，而是不够勇敢地去面对一个人的孤独。\n\n有人说，最孤独的事，不是不能跟一个人在一起，而是你根本不知道想跟谁在一起...\n\n其实，我们生来就是孤独;\n\n生命的本质就是孤独，不管你拥有什么，我们生来就是孤独。\n\n出现在这个世界本来就是一个偶然的事，谣言嘈杂的社会，人来人往，浮光掠影，匆匆碌碌。\n\n这个世界永远都是陌生的，理解是奢侈的，你永远想不起来来时的路，你永远无法让一个人不离你而去。\n\n不管你拥有什么，我们生来就是孤独。\n\n当我年轻的时候我想变成任何人除了我自己。\n","slug":"life-is-alone","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqf4009a41tpmgyi83yt","content":"<p>小王子说：有一天，我看了四十四次日落！</p>\n<p>李寻欢问阿飞：你看这棵树上的梅花已经开了，你可知道已经开了多少朵？</p>\n<p>孔乙己问：你可知道茴的四种写法？</p>\n<p>鲁迅说：楼下一个男人病的要死，那间壁的一家唱着留声机；对面是弄孩子，楼上有两人狂笑，还有打牌声，河中的穿上有女人哭着她死去的母亲，人类的悲欢并不相通，我只是觉得她们吵闹。</p>\n<p>大话西游中说：你看那个人，好像一条狗！</p>\n<p>一千个读者，有一千个哈姆雷特！</p>\n<p>一个人走的太远太久了，便看腻了人潮似海。</p>\n<p>如果问，你所理解的孤独是什么？大概每个人都有自己的答案吧。</p>\n<p>突然觉得，原本以为亲密无间的伙伴并没有把我当朋友。</p>\n<p>小心翼翼地与人相处，把她当作真诚的伙伴，害怕隔阂，害怕犯错。</p>\n<p>或许，你所害怕的不是失去某个朋友，而是不够勇敢地去面对一个人的孤独。</p>\n<p>有人说，最孤独的事，不是不能跟一个人在一起，而是你根本不知道想跟谁在一起…</p>\n<p>其实，我们生来就是孤独;</p>\n<p>生命的本质就是孤独，不管你拥有什么，我们生来就是孤独。</p>\n<p>出现在这个世界本来就是一个偶然的事，谣言嘈杂的社会，人来人往，浮光掠影，匆匆碌碌。</p>\n<p>这个世界永远都是陌生的，理解是奢侈的，你永远想不起来来时的路，你永远无法让一个人不离你而去。</p>\n<p>不管你拥有什么，我们生来就是孤独。</p>\n<p>当我年轻的时候我想变成任何人除了我自己。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>小王子说：有一天，我看了四十四次日落！</p>\n<p>李寻欢问阿飞：你看这棵树上的梅花已经开了，你可知道已经开了多少朵？</p>\n<p>孔乙己问：你可知道茴的四种写法？</p>\n<p>鲁迅说：楼下一个男人病的要死，那间壁的一家唱着留声机；对面是弄孩子，楼上有两人狂笑，还有打牌声，河中的穿上有女人哭着她死去的母亲，人类的悲欢并不相通，我只是觉得她们吵闹。</p>\n<p>大话西游中说：你看那个人，好像一条狗！</p>\n<p>一千个读者，有一千个哈姆雷特！</p>\n<p>一个人走的太远太久了，便看腻了人潮似海。</p>\n<p>如果问，你所理解的孤独是什么？大概每个人都有自己的答案吧。</p>\n<p>突然觉得，原本以为亲密无间的伙伴并没有把我当朋友。</p>\n<p>小心翼翼地与人相处，把她当作真诚的伙伴，害怕隔阂，害怕犯错。</p>\n<p>或许，你所害怕的不是失去某个朋友，而是不够勇敢地去面对一个人的孤独。</p>\n<p>有人说，最孤独的事，不是不能跟一个人在一起，而是你根本不知道想跟谁在一起…</p>\n<p>其实，我们生来就是孤独;</p>\n<p>生命的本质就是孤独，不管你拥有什么，我们生来就是孤独。</p>\n<p>出现在这个世界本来就是一个偶然的事，谣言嘈杂的社会，人来人往，浮光掠影，匆匆碌碌。</p>\n<p>这个世界永远都是陌生的，理解是奢侈的，你永远想不起来来时的路，你永远无法让一个人不离你而去。</p>\n<p>不管你拥有什么，我们生来就是孤独。</p>\n<p>当我年轻的时候我想变成任何人除了我自己。</p>\n"},{"title":"血战钢锯岭","id":"10018","date":"2016-12-10T16:34:54.000Z","_content":"\n\n历史才是最好的教科书，我们从一段又一段历史中汲取经验和教训，尽量让人生走得不去更加艰难，而这毫无疑问战争是最好的老师，最残酷的史实，人类从千百的历史中依然没能学会和平，战争，让这个世界变得满目疮痍。\n\n今天去看了《血战钢锯岭》，有多久没有感动到流下眼泪，很好，前半段在讲述道斯如何与军队抗争，坚守自己的信仰，信仰是个好东西，但愿你我都有。后半段战争的场面极其的血腥暴力，电影尚是如此，真实又怎样想象，人生从来没有NG，因为真实，才最有力量；我们都喜欢甜美的故事，我也为了道斯的爱情而感动，也因战争的残酷而愤怒。\n\n> 道斯和未婚妻吻别\n> ![img](https://img1.doubanio.com/view/thing_review/large/public/p384087.jpg)\n>\n> 道斯冒着枪林弹雨拯救受伤的士兵\n> ![img](https://img1.doubanio.com/view/thing_review/large/public/p384109.jpg)\n\n这是我最喜欢的电影了，最让我感动的话是在军事法庭上道斯说：世界已经分崩离析，我要把它拼成原来的样子。看到这里心都碎了，这个世界上总有些人，哪怕与所有人为敌，所有人不信任，经受磨难羞辱，也坚持自己的信仰，这才是英雄；放下枪的人才是勇敢，他教会我们，我们应该成为怎样的人，不能忘记历史带给我们的伤痛，不能忘记而不是去恨，珍惜美好生活，不要战争。\n\n在这段时期，同样想起的是南京大屠杀，同样是二战时期日军留下的暴行，他们是魔鬼，他们终将会受到应有的惩罚；首先，我们都不能忘记，这是我们的伤痛，真实的历史远比想象的更加残酷，哪些被迫害的人，哪些南京大屠杀纪念馆的人名册，这些人是多么的绝望啊，数以千万计的道斯奋战的美好世界，怎能让战争败类去迫害，我不喜欢战争，任何一个国家。\n\n同样的选择给我，我会选择拿起枪，鲁迅先生说过：学医是救不了中国的，我终于不是道斯，看到咫尺近前的战友被日本人用刺刀刺死，却选择不拿起枪，我做不到；实际上，我也是一个有信仰的人，我的信仰的是我在乎的人，我愿意为了他们奋不顾身直到死亡，因为，他们是我的逆鳞啊！\n\n小时候，常听老人家说，要忆苦思甜，实际上应该是要铭记战争带给我们的伤痛，要铭记那段时期，勇敢的坚持的信仰，更加重要的是珍惜现在的美好。\n","source":"_posts/血战钢锯岭.md","raw":"---\ntitle: 血战钢锯岭\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: moive-xue-zhan-gang-ju-ling\nid: 10018\ndate: 2016-12-11 00:34:54\n---\n\n\n历史才是最好的教科书，我们从一段又一段历史中汲取经验和教训，尽量让人生走得不去更加艰难，而这毫无疑问战争是最好的老师，最残酷的史实，人类从千百的历史中依然没能学会和平，战争，让这个世界变得满目疮痍。\n\n今天去看了《血战钢锯岭》，有多久没有感动到流下眼泪，很好，前半段在讲述道斯如何与军队抗争，坚守自己的信仰，信仰是个好东西，但愿你我都有。后半段战争的场面极其的血腥暴力，电影尚是如此，真实又怎样想象，人生从来没有NG，因为真实，才最有力量；我们都喜欢甜美的故事，我也为了道斯的爱情而感动，也因战争的残酷而愤怒。\n\n> 道斯和未婚妻吻别\n> ![img](https://img1.doubanio.com/view/thing_review/large/public/p384087.jpg)\n>\n> 道斯冒着枪林弹雨拯救受伤的士兵\n> ![img](https://img1.doubanio.com/view/thing_review/large/public/p384109.jpg)\n\n这是我最喜欢的电影了，最让我感动的话是在军事法庭上道斯说：世界已经分崩离析，我要把它拼成原来的样子。看到这里心都碎了，这个世界上总有些人，哪怕与所有人为敌，所有人不信任，经受磨难羞辱，也坚持自己的信仰，这才是英雄；放下枪的人才是勇敢，他教会我们，我们应该成为怎样的人，不能忘记历史带给我们的伤痛，不能忘记而不是去恨，珍惜美好生活，不要战争。\n\n在这段时期，同样想起的是南京大屠杀，同样是二战时期日军留下的暴行，他们是魔鬼，他们终将会受到应有的惩罚；首先，我们都不能忘记，这是我们的伤痛，真实的历史远比想象的更加残酷，哪些被迫害的人，哪些南京大屠杀纪念馆的人名册，这些人是多么的绝望啊，数以千万计的道斯奋战的美好世界，怎能让战争败类去迫害，我不喜欢战争，任何一个国家。\n\n同样的选择给我，我会选择拿起枪，鲁迅先生说过：学医是救不了中国的，我终于不是道斯，看到咫尺近前的战友被日本人用刺刀刺死，却选择不拿起枪，我做不到；实际上，我也是一个有信仰的人，我的信仰的是我在乎的人，我愿意为了他们奋不顾身直到死亡，因为，他们是我的逆鳞啊！\n\n小时候，常听老人家说，要忆苦思甜，实际上应该是要铭记战争带给我们的伤痛，要铭记那段时期，勇敢的坚持的信仰，更加重要的是珍惜现在的美好。\n","slug":"moive-xue-zhan-gang-ju-ling","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqf6009d41tp9ortuqe3","content":"<p>历史才是最好的教科书，我们从一段又一段历史中汲取经验和教训，尽量让人生走得不去更加艰难，而这毫无疑问战争是最好的老师，最残酷的史实，人类从千百的历史中依然没能学会和平，战争，让这个世界变得满目疮痍。</p>\n<p>今天去看了《血战钢锯岭》，有多久没有感动到流下眼泪，很好，前半段在讲述道斯如何与军队抗争，坚守自己的信仰，信仰是个好东西，但愿你我都有。后半段战争的场面极其的血腥暴力，电影尚是如此，真实又怎样想象，人生从来没有NG，因为真实，才最有力量；我们都喜欢甜美的故事，我也为了道斯的爱情而感动，也因战争的残酷而愤怒。</p>\n<blockquote>\n<p>道斯和未婚妻吻别<br><img src=\"https://img1.doubanio.com/view/thing_review/large/public/p384087.jpg\" alt=\"img\"></p>\n<p>道斯冒着枪林弹雨拯救受伤的士兵<br><img src=\"https://img1.doubanio.com/view/thing_review/large/public/p384109.jpg\" alt=\"img\"></p>\n</blockquote>\n<p>这是我最喜欢的电影了，最让我感动的话是在军事法庭上道斯说：世界已经分崩离析，我要把它拼成原来的样子。看到这里心都碎了，这个世界上总有些人，哪怕与所有人为敌，所有人不信任，经受磨难羞辱，也坚持自己的信仰，这才是英雄；放下枪的人才是勇敢，他教会我们，我们应该成为怎样的人，不能忘记历史带给我们的伤痛，不能忘记而不是去恨，珍惜美好生活，不要战争。</p>\n<p>在这段时期，同样想起的是南京大屠杀，同样是二战时期日军留下的暴行，他们是魔鬼，他们终将会受到应有的惩罚；首先，我们都不能忘记，这是我们的伤痛，真实的历史远比想象的更加残酷，哪些被迫害的人，哪些南京大屠杀纪念馆的人名册，这些人是多么的绝望啊，数以千万计的道斯奋战的美好世界，怎能让战争败类去迫害，我不喜欢战争，任何一个国家。</p>\n<p>同样的选择给我，我会选择拿起枪，鲁迅先生说过：学医是救不了中国的，我终于不是道斯，看到咫尺近前的战友被日本人用刺刀刺死，却选择不拿起枪，我做不到；实际上，我也是一个有信仰的人，我的信仰的是我在乎的人，我愿意为了他们奋不顾身直到死亡，因为，他们是我的逆鳞啊！</p>\n<p>小时候，常听老人家说，要忆苦思甜，实际上应该是要铭记战争带给我们的伤痛，要铭记那段时期，勇敢的坚持的信仰，更加重要的是珍惜现在的美好。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>历史才是最好的教科书，我们从一段又一段历史中汲取经验和教训，尽量让人生走得不去更加艰难，而这毫无疑问战争是最好的老师，最残酷的史实，人类从千百的历史中依然没能学会和平，战争，让这个世界变得满目疮痍。</p>\n<p>今天去看了《血战钢锯岭》，有多久没有感动到流下眼泪，很好，前半段在讲述道斯如何与军队抗争，坚守自己的信仰，信仰是个好东西，但愿你我都有。后半段战争的场面极其的血腥暴力，电影尚是如此，真实又怎样想象，人生从来没有NG，因为真实，才最有力量；我们都喜欢甜美的故事，我也为了道斯的爱情而感动，也因战争的残酷而愤怒。</p>\n<blockquote>\n<p>道斯和未婚妻吻别<br><img src=\"https://img1.doubanio.com/view/thing_review/large/public/p384087.jpg\" alt=\"img\"></p>\n<p>道斯冒着枪林弹雨拯救受伤的士兵<br><img src=\"https://img1.doubanio.com/view/thing_review/large/public/p384109.jpg\" alt=\"img\"></p>\n</blockquote>\n<p>这是我最喜欢的电影了，最让我感动的话是在军事法庭上道斯说：世界已经分崩离析，我要把它拼成原来的样子。看到这里心都碎了，这个世界上总有些人，哪怕与所有人为敌，所有人不信任，经受磨难羞辱，也坚持自己的信仰，这才是英雄；放下枪的人才是勇敢，他教会我们，我们应该成为怎样的人，不能忘记历史带给我们的伤痛，不能忘记而不是去恨，珍惜美好生活，不要战争。</p>\n<p>在这段时期，同样想起的是南京大屠杀，同样是二战时期日军留下的暴行，他们是魔鬼，他们终将会受到应有的惩罚；首先，我们都不能忘记，这是我们的伤痛，真实的历史远比想象的更加残酷，哪些被迫害的人，哪些南京大屠杀纪念馆的人名册，这些人是多么的绝望啊，数以千万计的道斯奋战的美好世界，怎能让战争败类去迫害，我不喜欢战争，任何一个国家。</p>\n<p>同样的选择给我，我会选择拿起枪，鲁迅先生说过：学医是救不了中国的，我终于不是道斯，看到咫尺近前的战友被日本人用刺刀刺死，却选择不拿起枪，我做不到；实际上，我也是一个有信仰的人，我的信仰的是我在乎的人，我愿意为了他们奋不顾身直到死亡，因为，他们是我的逆鳞啊！</p>\n<p>小时候，常听老人家说，要忆苦思甜，实际上应该是要铭记战争带给我们的伤痛，要铭记那段时期，勇敢的坚持的信仰，更加重要的是珍惜现在的美好。</p>\n"},{"title":"路途上","id":"10019","date":"2015-04-02T16:34:54.000Z","_content":"\n\n旅途，我一直觉着是个挺感性的词儿，喜欢在路上的状态，长途喜欢火车，短途喜欢公交，每个人都挤在狭小的空间，亲密而陌生，这个时候无事可做，玩手机、听歌，看书，或者看着窗外的风景。人在快速移动的状态下，更容易内心平静下来，我喜欢这种状态，难得能有机会停下来思考，生活一直在不停地不停地催促着你，像个烦人的小精灵，于是，每个人都在紧促的节奏中长大，多数是忙碌，多数做的事无甚意义，多数悲伤的情绪还没来得及释放就又陷入尘土飞扬的生活中；于是，我们开始怀念从前，开始在旅途之中，开始在昼夜之初，多愁善感，深思熟虑；所以，我第二喜欢夜晚一人宁静，第三喜欢旅途路上，第一呢，与喜欢的人在一起。\n\n我是一个话多的人，也是个喜欢听故事的人，路上时间久了，便忍不住与身边的人搭讪；有一次，路上遇到一对年轻男女，与我年龄相若，男生第一次到女方家里，一路谈及二人感情，神采奕奕，羡煞他人；有一次与一位外出寻友的大叔，大叔慷慨与我分享所携特产，又一斤白酒，二人畅饮畅谈，第一次出门去上海，如今年岁已过半百，子女皆成家立业，静极思动，念及多年未见的好友，人生便当如此，足矣；前几日，清明时节，回家扫墓，归途，对面而坐，一对夫妻，大叔年纪轻轻便以离家闯荡江湖，妻子一生相随，其中温情动人自不用言语，膝下两女一儿也已成家；如今，在家务农，平凡快乐，一路大叔慷慨激昂与我讲述走南闯北的故事，阿姨始终静静凝望不语，大叔一直问阿姨要不我站起来你躺会，阿姨一直说我不累，却在我和大叔攀谈时倚在座位上睡着了，而后，大叔起身说去抽根烟，但却久久未归；爱情便当如此，平凡夫妻，爱从不用口来说。\n\n我们一生追寻为何，多数情况自身也不能辨别，或是一生荣光，杀退各路豪杰；或是平淡无奇，一生尽是柴米油盐；或是万花丛中而过，爱尽世间女子；或者从一而终，生死相依；但都是对的，都是好的，只要是我们想要的，但不应伤害他人，这是原则！生活多是苦难，磨砺众生；吃腻山珍海味的人渴望农家小菜，久经沧桑的羡慕新手的初生牛犊的拼劲，经历过爱情的人害怕什么呢？害怕再经历爱情；过往的回忆就像一个躲在黑暗里的蛇，总是在你伤口发热时再咬上一口，其实它没毒，但是肯定会疼，勇敢的你，终会杀了蛇，只要你足够勇敢；当你准备接受爱情的时候，就要接受爱情带来的苦涩，焦虑和怅然若失的情绪，就像你打算接受一个人，就要学会接受他的前面后面上面下面，但是你都要学会接受，要么你还没准备好开始一段爱情和爱上一个人。我一直在想我的姑娘，必定是美好的，因为是我喜欢的，是完人，是仙女，是温柔的月光，是清晨初露的霞光，是令人心动的春色，是呼啸着穿堂而过的清风，是踩着红色高跟鞋踢踏踢踏走进我的胸膛，而我则是历经岁月沧桑依然伴随她左右的踏实臂膀，只要我足够勇敢，我真的足够勇敢了。\n\n20岁之前我看郭敬明的书很多，真的对我的人生有很大的影响，十分感谢；辍学工作之后，无心向学，不读书，生活更是糟糕，再拾起，亦无当年之感；如今，我开始看韩寒和王路的书，觉得他们的文字很酷，可以够我装逼来用，但是我的内心很正，热情好学，积极向上；其实，如今高度发展的商业模式，的确会让很多人的价值观有失颇比，有一些人投机取巧只为赚钱不顾影响，直观体现就是很多挂作家之名写出乌七八糟的东西反而畅销，快餐式的心灵鸡汤盛行，进而影响更多读者，所以需要筛选文章，但不是否定任何书，文学不应有贵贱之分，区分在读者，读适合自己的书即可；生活如此，对的是自己，其他则毋庸顾虑，凡事需顾虑的，便对自己无甚意义，弃之亦不可惜。\n\n最后套用韩寒的话结尾：\n\n**\\*为热爱的人或事物洒下热血和热泪，最坏的结果无非就是对方一句“你想怎样”。***\n","source":"_posts/路途上.md","raw":"---\ntitle: 路途上\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: on-the-road\nid: 10019\ndate: 2015-04-03 00:34:54\n---\n\n\n旅途，我一直觉着是个挺感性的词儿，喜欢在路上的状态，长途喜欢火车，短途喜欢公交，每个人都挤在狭小的空间，亲密而陌生，这个时候无事可做，玩手机、听歌，看书，或者看着窗外的风景。人在快速移动的状态下，更容易内心平静下来，我喜欢这种状态，难得能有机会停下来思考，生活一直在不停地不停地催促着你，像个烦人的小精灵，于是，每个人都在紧促的节奏中长大，多数是忙碌，多数做的事无甚意义，多数悲伤的情绪还没来得及释放就又陷入尘土飞扬的生活中；于是，我们开始怀念从前，开始在旅途之中，开始在昼夜之初，多愁善感，深思熟虑；所以，我第二喜欢夜晚一人宁静，第三喜欢旅途路上，第一呢，与喜欢的人在一起。\n\n我是一个话多的人，也是个喜欢听故事的人，路上时间久了，便忍不住与身边的人搭讪；有一次，路上遇到一对年轻男女，与我年龄相若，男生第一次到女方家里，一路谈及二人感情，神采奕奕，羡煞他人；有一次与一位外出寻友的大叔，大叔慷慨与我分享所携特产，又一斤白酒，二人畅饮畅谈，第一次出门去上海，如今年岁已过半百，子女皆成家立业，静极思动，念及多年未见的好友，人生便当如此，足矣；前几日，清明时节，回家扫墓，归途，对面而坐，一对夫妻，大叔年纪轻轻便以离家闯荡江湖，妻子一生相随，其中温情动人自不用言语，膝下两女一儿也已成家；如今，在家务农，平凡快乐，一路大叔慷慨激昂与我讲述走南闯北的故事，阿姨始终静静凝望不语，大叔一直问阿姨要不我站起来你躺会，阿姨一直说我不累，却在我和大叔攀谈时倚在座位上睡着了，而后，大叔起身说去抽根烟，但却久久未归；爱情便当如此，平凡夫妻，爱从不用口来说。\n\n我们一生追寻为何，多数情况自身也不能辨别，或是一生荣光，杀退各路豪杰；或是平淡无奇，一生尽是柴米油盐；或是万花丛中而过，爱尽世间女子；或者从一而终，生死相依；但都是对的，都是好的，只要是我们想要的，但不应伤害他人，这是原则！生活多是苦难，磨砺众生；吃腻山珍海味的人渴望农家小菜，久经沧桑的羡慕新手的初生牛犊的拼劲，经历过爱情的人害怕什么呢？害怕再经历爱情；过往的回忆就像一个躲在黑暗里的蛇，总是在你伤口发热时再咬上一口，其实它没毒，但是肯定会疼，勇敢的你，终会杀了蛇，只要你足够勇敢；当你准备接受爱情的时候，就要接受爱情带来的苦涩，焦虑和怅然若失的情绪，就像你打算接受一个人，就要学会接受他的前面后面上面下面，但是你都要学会接受，要么你还没准备好开始一段爱情和爱上一个人。我一直在想我的姑娘，必定是美好的，因为是我喜欢的，是完人，是仙女，是温柔的月光，是清晨初露的霞光，是令人心动的春色，是呼啸着穿堂而过的清风，是踩着红色高跟鞋踢踏踢踏走进我的胸膛，而我则是历经岁月沧桑依然伴随她左右的踏实臂膀，只要我足够勇敢，我真的足够勇敢了。\n\n20岁之前我看郭敬明的书很多，真的对我的人生有很大的影响，十分感谢；辍学工作之后，无心向学，不读书，生活更是糟糕，再拾起，亦无当年之感；如今，我开始看韩寒和王路的书，觉得他们的文字很酷，可以够我装逼来用，但是我的内心很正，热情好学，积极向上；其实，如今高度发展的商业模式，的确会让很多人的价值观有失颇比，有一些人投机取巧只为赚钱不顾影响，直观体现就是很多挂作家之名写出乌七八糟的东西反而畅销，快餐式的心灵鸡汤盛行，进而影响更多读者，所以需要筛选文章，但不是否定任何书，文学不应有贵贱之分，区分在读者，读适合自己的书即可；生活如此，对的是自己，其他则毋庸顾虑，凡事需顾虑的，便对自己无甚意义，弃之亦不可惜。\n\n最后套用韩寒的话结尾：\n\n**\\*为热爱的人或事物洒下热血和热泪，最坏的结果无非就是对方一句“你想怎样”。***\n","slug":"on-the-road","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqf8009h41tpu1trxp6m","content":"<p>旅途，我一直觉着是个挺感性的词儿，喜欢在路上的状态，长途喜欢火车，短途喜欢公交，每个人都挤在狭小的空间，亲密而陌生，这个时候无事可做，玩手机、听歌，看书，或者看着窗外的风景。人在快速移动的状态下，更容易内心平静下来，我喜欢这种状态，难得能有机会停下来思考，生活一直在不停地不停地催促着你，像个烦人的小精灵，于是，每个人都在紧促的节奏中长大，多数是忙碌，多数做的事无甚意义，多数悲伤的情绪还没来得及释放就又陷入尘土飞扬的生活中；于是，我们开始怀念从前，开始在旅途之中，开始在昼夜之初，多愁善感，深思熟虑；所以，我第二喜欢夜晚一人宁静，第三喜欢旅途路上，第一呢，与喜欢的人在一起。</p>\n<p>我是一个话多的人，也是个喜欢听故事的人，路上时间久了，便忍不住与身边的人搭讪；有一次，路上遇到一对年轻男女，与我年龄相若，男生第一次到女方家里，一路谈及二人感情，神采奕奕，羡煞他人；有一次与一位外出寻友的大叔，大叔慷慨与我分享所携特产，又一斤白酒，二人畅饮畅谈，第一次出门去上海，如今年岁已过半百，子女皆成家立业，静极思动，念及多年未见的好友，人生便当如此，足矣；前几日，清明时节，回家扫墓，归途，对面而坐，一对夫妻，大叔年纪轻轻便以离家闯荡江湖，妻子一生相随，其中温情动人自不用言语，膝下两女一儿也已成家；如今，在家务农，平凡快乐，一路大叔慷慨激昂与我讲述走南闯北的故事，阿姨始终静静凝望不语，大叔一直问阿姨要不我站起来你躺会，阿姨一直说我不累，却在我和大叔攀谈时倚在座位上睡着了，而后，大叔起身说去抽根烟，但却久久未归；爱情便当如此，平凡夫妻，爱从不用口来说。</p>\n<p>我们一生追寻为何，多数情况自身也不能辨别，或是一生荣光，杀退各路豪杰；或是平淡无奇，一生尽是柴米油盐；或是万花丛中而过，爱尽世间女子；或者从一而终，生死相依；但都是对的，都是好的，只要是我们想要的，但不应伤害他人，这是原则！生活多是苦难，磨砺众生；吃腻山珍海味的人渴望农家小菜，久经沧桑的羡慕新手的初生牛犊的拼劲，经历过爱情的人害怕什么呢？害怕再经历爱情；过往的回忆就像一个躲在黑暗里的蛇，总是在你伤口发热时再咬上一口，其实它没毒，但是肯定会疼，勇敢的你，终会杀了蛇，只要你足够勇敢；当你准备接受爱情的时候，就要接受爱情带来的苦涩，焦虑和怅然若失的情绪，就像你打算接受一个人，就要学会接受他的前面后面上面下面，但是你都要学会接受，要么你还没准备好开始一段爱情和爱上一个人。我一直在想我的姑娘，必定是美好的，因为是我喜欢的，是完人，是仙女，是温柔的月光，是清晨初露的霞光，是令人心动的春色，是呼啸着穿堂而过的清风，是踩着红色高跟鞋踢踏踢踏走进我的胸膛，而我则是历经岁月沧桑依然伴随她左右的踏实臂膀，只要我足够勇敢，我真的足够勇敢了。</p>\n<p>20岁之前我看郭敬明的书很多，真的对我的人生有很大的影响，十分感谢；辍学工作之后，无心向学，不读书，生活更是糟糕，再拾起，亦无当年之感；如今，我开始看韩寒和王路的书，觉得他们的文字很酷，可以够我装逼来用，但是我的内心很正，热情好学，积极向上；其实，如今高度发展的商业模式，的确会让很多人的价值观有失颇比，有一些人投机取巧只为赚钱不顾影响，直观体现就是很多挂作家之名写出乌七八糟的东西反而畅销，快餐式的心灵鸡汤盛行，进而影响更多读者，所以需要筛选文章，但不是否定任何书，文学不应有贵贱之分，区分在读者，读适合自己的书即可；生活如此，对的是自己，其他则毋庸顾虑，凡事需顾虑的，便对自己无甚意义，弃之亦不可惜。</p>\n<p>最后套用韩寒的话结尾：</p>\n<p><strong>*为热爱的人或事物洒下热血和热泪，最坏的结果无非就是对方一句“你想怎样”。*</strong></p>\n","site":{"data":{}},"excerpt":"","more":"<p>旅途，我一直觉着是个挺感性的词儿，喜欢在路上的状态，长途喜欢火车，短途喜欢公交，每个人都挤在狭小的空间，亲密而陌生，这个时候无事可做，玩手机、听歌，看书，或者看着窗外的风景。人在快速移动的状态下，更容易内心平静下来，我喜欢这种状态，难得能有机会停下来思考，生活一直在不停地不停地催促着你，像个烦人的小精灵，于是，每个人都在紧促的节奏中长大，多数是忙碌，多数做的事无甚意义，多数悲伤的情绪还没来得及释放就又陷入尘土飞扬的生活中；于是，我们开始怀念从前，开始在旅途之中，开始在昼夜之初，多愁善感，深思熟虑；所以，我第二喜欢夜晚一人宁静，第三喜欢旅途路上，第一呢，与喜欢的人在一起。</p>\n<p>我是一个话多的人，也是个喜欢听故事的人，路上时间久了，便忍不住与身边的人搭讪；有一次，路上遇到一对年轻男女，与我年龄相若，男生第一次到女方家里，一路谈及二人感情，神采奕奕，羡煞他人；有一次与一位外出寻友的大叔，大叔慷慨与我分享所携特产，又一斤白酒，二人畅饮畅谈，第一次出门去上海，如今年岁已过半百，子女皆成家立业，静极思动，念及多年未见的好友，人生便当如此，足矣；前几日，清明时节，回家扫墓，归途，对面而坐，一对夫妻，大叔年纪轻轻便以离家闯荡江湖，妻子一生相随，其中温情动人自不用言语，膝下两女一儿也已成家；如今，在家务农，平凡快乐，一路大叔慷慨激昂与我讲述走南闯北的故事，阿姨始终静静凝望不语，大叔一直问阿姨要不我站起来你躺会，阿姨一直说我不累，却在我和大叔攀谈时倚在座位上睡着了，而后，大叔起身说去抽根烟，但却久久未归；爱情便当如此，平凡夫妻，爱从不用口来说。</p>\n<p>我们一生追寻为何，多数情况自身也不能辨别，或是一生荣光，杀退各路豪杰；或是平淡无奇，一生尽是柴米油盐；或是万花丛中而过，爱尽世间女子；或者从一而终，生死相依；但都是对的，都是好的，只要是我们想要的，但不应伤害他人，这是原则！生活多是苦难，磨砺众生；吃腻山珍海味的人渴望农家小菜，久经沧桑的羡慕新手的初生牛犊的拼劲，经历过爱情的人害怕什么呢？害怕再经历爱情；过往的回忆就像一个躲在黑暗里的蛇，总是在你伤口发热时再咬上一口，其实它没毒，但是肯定会疼，勇敢的你，终会杀了蛇，只要你足够勇敢；当你准备接受爱情的时候，就要接受爱情带来的苦涩，焦虑和怅然若失的情绪，就像你打算接受一个人，就要学会接受他的前面后面上面下面，但是你都要学会接受，要么你还没准备好开始一段爱情和爱上一个人。我一直在想我的姑娘，必定是美好的，因为是我喜欢的，是完人，是仙女，是温柔的月光，是清晨初露的霞光，是令人心动的春色，是呼啸着穿堂而过的清风，是踩着红色高跟鞋踢踏踢踏走进我的胸膛，而我则是历经岁月沧桑依然伴随她左右的踏实臂膀，只要我足够勇敢，我真的足够勇敢了。</p>\n<p>20岁之前我看郭敬明的书很多，真的对我的人生有很大的影响，十分感谢；辍学工作之后，无心向学，不读书，生活更是糟糕，再拾起，亦无当年之感；如今，我开始看韩寒和王路的书，觉得他们的文字很酷，可以够我装逼来用，但是我的内心很正，热情好学，积极向上；其实，如今高度发展的商业模式，的确会让很多人的价值观有失颇比，有一些人投机取巧只为赚钱不顾影响，直观体现就是很多挂作家之名写出乌七八糟的东西反而畅销，快餐式的心灵鸡汤盛行，进而影响更多读者，所以需要筛选文章，但不是否定任何书，文学不应有贵贱之分，区分在读者，读适合自己的书即可；生活如此，对的是自己，其他则毋庸顾虑，凡事需顾虑的，便对自己无甚意义，弃之亦不可惜。</p>\n<p>最后套用韩寒的话结尾：</p>\n<p><strong>*为热爱的人或事物洒下热血和热泪，最坏的结果无非就是对方一句“你想怎样”。*</strong></p>\n"},{"title":"这是一道鬼门关","id":"10020","date":"2015-04-11T16:34:54.000Z","_content":"\n\n生活的节奏在慢慢恢复正常，像是经历了一道鬼门关，感谢将我带出来的人。\n\n湄公河行动，最近很火的一部电影，前两天，我也去看了；关于炫技，关于剧情，关于赞扬，已经有很多人在说了，所以我想谈的是“你的归属感来自于哪里”以及“方新武杀人事件”。\n\n湄公河行动，我更愿称之为“湄公河事件”，这是一个真实的事件，所以踏入影院的我是带着复杂情绪的，我不喜欢谈政治，熟悉我的朋友应该会有所了解，因为我不懂政治，我不研究这些，我不能仅凭自己的感觉来判断当权者执政者的好坏，这个社会的稳定需要有太多因素；我所要做的是自己想要做的事，但是，不谈政治，我想说说关于“你的归属感来自于哪里”，这是一个很简单的问题，你有一所房子，房子里有你的父母、爱人和子女，无论你在外多少艰苦劳累，到了家看着你爱的人，你所有的苦累都消失殆尽，燃烧熊熊热火，为了他们去奋斗，这就是你的归属感，对于一个人、一个家庭是这样，对于一个国家，要让自己的国民有归属感，像我这样的市井小民，当“湄公河事件”发生，所有人的焦点都在这件事，正如电影中说到：“要给死去的13位船员一个公道，要给全国人民一个公道”；电影就像一个情绪放大器，艺术的手段让每一个情绪都被放大，开心会更开心，伤心会更伤心，愤怒也能更愤怒，所以我喜欢看电影和看书听音乐，写书音乐也是艺术的形式，鲍勃迪伦都拿了诺贝尔文学奖；所以在电影情节上国家的态度如此坚决，果敢，令我几度热泪盈眶，燃起对这个国家的希望和热爱，就如某个姑娘说的“我爱中华”，这就是归属感，让我觉得作为一个中国人而无比自豪，无论我将来漂泊何方，那个地方始终如灯塔照亮我的生命，前进和归途的路，所以，我爱你，中国。\n\n方新武杀人事件，相对于高刚，方新武更像是一个孤胆英雄是的人物，这个人物角色也应该是电影中才有的人物，女友因吸毒自杀，凶手潜逃，带着满身的伤远走他乡，伪装不同的角色，逃避着内心的伤痕和过去，将一生献给缉毒事业，他是一个抱着必死之志的人，这样的人最可怕也最可怜，所以当再次遇到占蓬的时候，方新武一直就决定杀他了，其实他在十年前就已经做了这个决定，所以最后在方新武追占蓬时，他把手枪换成了真枪，他一定是要杀了占蓬的了，这是一个复仇式的结尾，他已经无所畏惧了，所以啊，这样的人最可怕也最可怜，可怕是他不怕生死，可怜的是他的人生已经被毁了，除了复仇别无他事，可是我喜欢这样的人物，我不是伪君子，我是真小人，所有时间可以让人放心的话都是屁话，无论时间走过多久，伤害你的人和事永远存在，这就像一个鬼门关啊，现在的结局就是方新武最好的解决了，导演已经给了我们了；如果他没死，那么今后就是另外一个故事了。\n\n我们都喜欢英雄式的人物，因为英雄是有仇必报，不论错与对，这符合我们的价值观。\n","source":"_posts/这是一道鬼门关.md","raw":"---\ntitle: 这是一道鬼门关\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: dead-door\nid: 10020\ndate: 2015-04-12 00:34:54\n---\n\n\n生活的节奏在慢慢恢复正常，像是经历了一道鬼门关，感谢将我带出来的人。\n\n湄公河行动，最近很火的一部电影，前两天，我也去看了；关于炫技，关于剧情，关于赞扬，已经有很多人在说了，所以我想谈的是“你的归属感来自于哪里”以及“方新武杀人事件”。\n\n湄公河行动，我更愿称之为“湄公河事件”，这是一个真实的事件，所以踏入影院的我是带着复杂情绪的，我不喜欢谈政治，熟悉我的朋友应该会有所了解，因为我不懂政治，我不研究这些，我不能仅凭自己的感觉来判断当权者执政者的好坏，这个社会的稳定需要有太多因素；我所要做的是自己想要做的事，但是，不谈政治，我想说说关于“你的归属感来自于哪里”，这是一个很简单的问题，你有一所房子，房子里有你的父母、爱人和子女，无论你在外多少艰苦劳累，到了家看着你爱的人，你所有的苦累都消失殆尽，燃烧熊熊热火，为了他们去奋斗，这就是你的归属感，对于一个人、一个家庭是这样，对于一个国家，要让自己的国民有归属感，像我这样的市井小民，当“湄公河事件”发生，所有人的焦点都在这件事，正如电影中说到：“要给死去的13位船员一个公道，要给全国人民一个公道”；电影就像一个情绪放大器，艺术的手段让每一个情绪都被放大，开心会更开心，伤心会更伤心，愤怒也能更愤怒，所以我喜欢看电影和看书听音乐，写书音乐也是艺术的形式，鲍勃迪伦都拿了诺贝尔文学奖；所以在电影情节上国家的态度如此坚决，果敢，令我几度热泪盈眶，燃起对这个国家的希望和热爱，就如某个姑娘说的“我爱中华”，这就是归属感，让我觉得作为一个中国人而无比自豪，无论我将来漂泊何方，那个地方始终如灯塔照亮我的生命，前进和归途的路，所以，我爱你，中国。\n\n方新武杀人事件，相对于高刚，方新武更像是一个孤胆英雄是的人物，这个人物角色也应该是电影中才有的人物，女友因吸毒自杀，凶手潜逃，带着满身的伤远走他乡，伪装不同的角色，逃避着内心的伤痕和过去，将一生献给缉毒事业，他是一个抱着必死之志的人，这样的人最可怕也最可怜，所以当再次遇到占蓬的时候，方新武一直就决定杀他了，其实他在十年前就已经做了这个决定，所以最后在方新武追占蓬时，他把手枪换成了真枪，他一定是要杀了占蓬的了，这是一个复仇式的结尾，他已经无所畏惧了，所以啊，这样的人最可怕也最可怜，可怕是他不怕生死，可怜的是他的人生已经被毁了，除了复仇别无他事，可是我喜欢这样的人物，我不是伪君子，我是真小人，所有时间可以让人放心的话都是屁话，无论时间走过多久，伤害你的人和事永远存在，这就像一个鬼门关啊，现在的结局就是方新武最好的解决了，导演已经给了我们了；如果他没死，那么今后就是另外一个故事了。\n\n我们都喜欢英雄式的人物，因为英雄是有仇必报，不论错与对，这符合我们的价值观。\n","slug":"dead-door","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqfb009k41tpub0xzmqo","content":"<p>生活的节奏在慢慢恢复正常，像是经历了一道鬼门关，感谢将我带出来的人。</p>\n<p>湄公河行动，最近很火的一部电影，前两天，我也去看了；关于炫技，关于剧情，关于赞扬，已经有很多人在说了，所以我想谈的是“你的归属感来自于哪里”以及“方新武杀人事件”。</p>\n<p>湄公河行动，我更愿称之为“湄公河事件”，这是一个真实的事件，所以踏入影院的我是带着复杂情绪的，我不喜欢谈政治，熟悉我的朋友应该会有所了解，因为我不懂政治，我不研究这些，我不能仅凭自己的感觉来判断当权者执政者的好坏，这个社会的稳定需要有太多因素；我所要做的是自己想要做的事，但是，不谈政治，我想说说关于“你的归属感来自于哪里”，这是一个很简单的问题，你有一所房子，房子里有你的父母、爱人和子女，无论你在外多少艰苦劳累，到了家看着你爱的人，你所有的苦累都消失殆尽，燃烧熊熊热火，为了他们去奋斗，这就是你的归属感，对于一个人、一个家庭是这样，对于一个国家，要让自己的国民有归属感，像我这样的市井小民，当“湄公河事件”发生，所有人的焦点都在这件事，正如电影中说到：“要给死去的13位船员一个公道，要给全国人民一个公道”；电影就像一个情绪放大器，艺术的手段让每一个情绪都被放大，开心会更开心，伤心会更伤心，愤怒也能更愤怒，所以我喜欢看电影和看书听音乐，写书音乐也是艺术的形式，鲍勃迪伦都拿了诺贝尔文学奖；所以在电影情节上国家的态度如此坚决，果敢，令我几度热泪盈眶，燃起对这个国家的希望和热爱，就如某个姑娘说的“我爱中华”，这就是归属感，让我觉得作为一个中国人而无比自豪，无论我将来漂泊何方，那个地方始终如灯塔照亮我的生命，前进和归途的路，所以，我爱你，中国。</p>\n<p>方新武杀人事件，相对于高刚，方新武更像是一个孤胆英雄是的人物，这个人物角色也应该是电影中才有的人物，女友因吸毒自杀，凶手潜逃，带着满身的伤远走他乡，伪装不同的角色，逃避着内心的伤痕和过去，将一生献给缉毒事业，他是一个抱着必死之志的人，这样的人最可怕也最可怜，所以当再次遇到占蓬的时候，方新武一直就决定杀他了，其实他在十年前就已经做了这个决定，所以最后在方新武追占蓬时，他把手枪换成了真枪，他一定是要杀了占蓬的了，这是一个复仇式的结尾，他已经无所畏惧了，所以啊，这样的人最可怕也最可怜，可怕是他不怕生死，可怜的是他的人生已经被毁了，除了复仇别无他事，可是我喜欢这样的人物，我不是伪君子，我是真小人，所有时间可以让人放心的话都是屁话，无论时间走过多久，伤害你的人和事永远存在，这就像一个鬼门关啊，现在的结局就是方新武最好的解决了，导演已经给了我们了；如果他没死，那么今后就是另外一个故事了。</p>\n<p>我们都喜欢英雄式的人物，因为英雄是有仇必报，不论错与对，这符合我们的价值观。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>生活的节奏在慢慢恢复正常，像是经历了一道鬼门关，感谢将我带出来的人。</p>\n<p>湄公河行动，最近很火的一部电影，前两天，我也去看了；关于炫技，关于剧情，关于赞扬，已经有很多人在说了，所以我想谈的是“你的归属感来自于哪里”以及“方新武杀人事件”。</p>\n<p>湄公河行动，我更愿称之为“湄公河事件”，这是一个真实的事件，所以踏入影院的我是带着复杂情绪的，我不喜欢谈政治，熟悉我的朋友应该会有所了解，因为我不懂政治，我不研究这些，我不能仅凭自己的感觉来判断当权者执政者的好坏，这个社会的稳定需要有太多因素；我所要做的是自己想要做的事，但是，不谈政治，我想说说关于“你的归属感来自于哪里”，这是一个很简单的问题，你有一所房子，房子里有你的父母、爱人和子女，无论你在外多少艰苦劳累，到了家看着你爱的人，你所有的苦累都消失殆尽，燃烧熊熊热火，为了他们去奋斗，这就是你的归属感，对于一个人、一个家庭是这样，对于一个国家，要让自己的国民有归属感，像我这样的市井小民，当“湄公河事件”发生，所有人的焦点都在这件事，正如电影中说到：“要给死去的13位船员一个公道，要给全国人民一个公道”；电影就像一个情绪放大器，艺术的手段让每一个情绪都被放大，开心会更开心，伤心会更伤心，愤怒也能更愤怒，所以我喜欢看电影和看书听音乐，写书音乐也是艺术的形式，鲍勃迪伦都拿了诺贝尔文学奖；所以在电影情节上国家的态度如此坚决，果敢，令我几度热泪盈眶，燃起对这个国家的希望和热爱，就如某个姑娘说的“我爱中华”，这就是归属感，让我觉得作为一个中国人而无比自豪，无论我将来漂泊何方，那个地方始终如灯塔照亮我的生命，前进和归途的路，所以，我爱你，中国。</p>\n<p>方新武杀人事件，相对于高刚，方新武更像是一个孤胆英雄是的人物，这个人物角色也应该是电影中才有的人物，女友因吸毒自杀，凶手潜逃，带着满身的伤远走他乡，伪装不同的角色，逃避着内心的伤痕和过去，将一生献给缉毒事业，他是一个抱着必死之志的人，这样的人最可怕也最可怜，所以当再次遇到占蓬的时候，方新武一直就决定杀他了，其实他在十年前就已经做了这个决定，所以最后在方新武追占蓬时，他把手枪换成了真枪，他一定是要杀了占蓬的了，这是一个复仇式的结尾，他已经无所畏惧了，所以啊，这样的人最可怕也最可怜，可怕是他不怕生死，可怜的是他的人生已经被毁了，除了复仇别无他事，可是我喜欢这样的人物，我不是伪君子，我是真小人，所有时间可以让人放心的话都是屁话，无论时间走过多久，伤害你的人和事永远存在，这就像一个鬼门关啊，现在的结局就是方新武最好的解决了，导演已经给了我们了；如果他没死，那么今后就是另外一个故事了。</p>\n<p>我们都喜欢英雄式的人物，因为英雄是有仇必报，不论错与对，这符合我们的价值观。</p>\n"},{"title":"龙族路明非","id":"10021","date":"2016-03-06T16:34:54.000Z","_content":"\n\n大概是多久了，没有在看完一本书之后写写读后感了；看书就行吃面包，饿的时候觉得特别美味，吃饱了也就炮诸脑后。\n\n今年一直都挺忙碌地，正好伴着腿伤在家里休息半个月，于是，一股脑地把《龙族》三部曲看完了，这是一部很好的书，我喜欢，很多人可能会觉得这是一个讲神秘、冒险、还有魔幻的小说，这里面有很多牛逼的任务，牛逼到打个喷嚏就能在太平洋引起一场海啸；可是，在我看来，这是一个看起来有点悲伤的故事。\n\n有个叫路明非的Loser主角，他身边有很多牛逼的朋友，可是这些都和他没有关系，没有理想，没有原则，没有底线，好像这个世界硬一点，他就缩一点，懦弱、犹豫、像个傻逼，虽然整本书的人都在帮他，可是这不是他想要的，刚开始看的时候，一直想主角什么时候牛逼起来啊，作者怎么不按套路出牌啊，后来，我开始不想让他牛逼，他要是一直懦弱下去该多好啊，这样，看着像真实地我们，这样，至少可以好好活下去；是啊，作为一个力挽狂澜的弑龙者多牛逼啊，像所有牛逼的角色，可这都是拿命换来的啊，“人是自私的生物，但是却愿意有那么一瞬间为了很少的人放弃一切甚至生命。”说的多好，听的人是那么的心疼；人的一生中总归有几个人是我们的逆鳞，我们希望她好胜过自己好，我们希望把所有一切都给她甚至生命，可是，那又怎样，那又怎样呢?\n\n另一个我很喜欢的人物，上杉越，一个隐世的牛逼老头子，在龙王复苏，整个东京城都要毁灭的时候，他选择了怯懦的逃离，很没骨气啊，可谁明白他呢，他是一个没有逆鳞的人了，活着只有自己，的确，我们都喜欢孤胆英雄式的角色，我们也渴望能够扮演这个角色，但是拯救世界这个事儿对我们来说太他妈难了，所以我们只能自私地保护自己重要的人；可是，最后一刻，老头留下来了，因为这里有他的逆鳞了，这很好，符合我们的价值观。\n\n最终，这一切都是一个梦，最起码是在路明非的世界，甚至路明非本身就是一个梦，一个提线木偶，一个，孤独又带点悲伤的角色，让人心疼。虽然这个小说也有瑕疵，就好像我不太喜欢第二部，但是不会妨碍我对这个小说的赞赏。\n\n所以，江南，我喜欢这个作者。\n","source":"_posts/龙族路明非.md","raw":"---\ntitle: 龙族路明非\ntags: '我给你讲个故事吧'\ncategories: '似水年华'\npermalink: dargon-boy\nid: 10021\ndate: 2016-03-07 00:34:54\n---\n\n\n大概是多久了，没有在看完一本书之后写写读后感了；看书就行吃面包，饿的时候觉得特别美味，吃饱了也就炮诸脑后。\n\n今年一直都挺忙碌地，正好伴着腿伤在家里休息半个月，于是，一股脑地把《龙族》三部曲看完了，这是一部很好的书，我喜欢，很多人可能会觉得这是一个讲神秘、冒险、还有魔幻的小说，这里面有很多牛逼的任务，牛逼到打个喷嚏就能在太平洋引起一场海啸；可是，在我看来，这是一个看起来有点悲伤的故事。\n\n有个叫路明非的Loser主角，他身边有很多牛逼的朋友，可是这些都和他没有关系，没有理想，没有原则，没有底线，好像这个世界硬一点，他就缩一点，懦弱、犹豫、像个傻逼，虽然整本书的人都在帮他，可是这不是他想要的，刚开始看的时候，一直想主角什么时候牛逼起来啊，作者怎么不按套路出牌啊，后来，我开始不想让他牛逼，他要是一直懦弱下去该多好啊，这样，看着像真实地我们，这样，至少可以好好活下去；是啊，作为一个力挽狂澜的弑龙者多牛逼啊，像所有牛逼的角色，可这都是拿命换来的啊，“人是自私的生物，但是却愿意有那么一瞬间为了很少的人放弃一切甚至生命。”说的多好，听的人是那么的心疼；人的一生中总归有几个人是我们的逆鳞，我们希望她好胜过自己好，我们希望把所有一切都给她甚至生命，可是，那又怎样，那又怎样呢?\n\n另一个我很喜欢的人物，上杉越，一个隐世的牛逼老头子，在龙王复苏，整个东京城都要毁灭的时候，他选择了怯懦的逃离，很没骨气啊，可谁明白他呢，他是一个没有逆鳞的人了，活着只有自己，的确，我们都喜欢孤胆英雄式的角色，我们也渴望能够扮演这个角色，但是拯救世界这个事儿对我们来说太他妈难了，所以我们只能自私地保护自己重要的人；可是，最后一刻，老头留下来了，因为这里有他的逆鳞了，这很好，符合我们的价值观。\n\n最终，这一切都是一个梦，最起码是在路明非的世界，甚至路明非本身就是一个梦，一个提线木偶，一个，孤独又带点悲伤的角色，让人心疼。虽然这个小说也有瑕疵，就好像我不太喜欢第二部，但是不会妨碍我对这个小说的赞赏。\n\n所以，江南，我喜欢这个作者。\n","slug":"dargon-boy","published":1,"updated":"2017-04-24T14:32:22.572Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj1wytqfd009o41tp5gpchs5y","content":"<p>大概是多久了，没有在看完一本书之后写写读后感了；看书就行吃面包，饿的时候觉得特别美味，吃饱了也就炮诸脑后。</p>\n<p>今年一直都挺忙碌地，正好伴着腿伤在家里休息半个月，于是，一股脑地把《龙族》三部曲看完了，这是一部很好的书，我喜欢，很多人可能会觉得这是一个讲神秘、冒险、还有魔幻的小说，这里面有很多牛逼的任务，牛逼到打个喷嚏就能在太平洋引起一场海啸；可是，在我看来，这是一个看起来有点悲伤的故事。</p>\n<p>有个叫路明非的Loser主角，他身边有很多牛逼的朋友，可是这些都和他没有关系，没有理想，没有原则，没有底线，好像这个世界硬一点，他就缩一点，懦弱、犹豫、像个傻逼，虽然整本书的人都在帮他，可是这不是他想要的，刚开始看的时候，一直想主角什么时候牛逼起来啊，作者怎么不按套路出牌啊，后来，我开始不想让他牛逼，他要是一直懦弱下去该多好啊，这样，看着像真实地我们，这样，至少可以好好活下去；是啊，作为一个力挽狂澜的弑龙者多牛逼啊，像所有牛逼的角色，可这都是拿命换来的啊，“人是自私的生物，但是却愿意有那么一瞬间为了很少的人放弃一切甚至生命。”说的多好，听的人是那么的心疼；人的一生中总归有几个人是我们的逆鳞，我们希望她好胜过自己好，我们希望把所有一切都给她甚至生命，可是，那又怎样，那又怎样呢?</p>\n<p>另一个我很喜欢的人物，上杉越，一个隐世的牛逼老头子，在龙王复苏，整个东京城都要毁灭的时候，他选择了怯懦的逃离，很没骨气啊，可谁明白他呢，他是一个没有逆鳞的人了，活着只有自己，的确，我们都喜欢孤胆英雄式的角色，我们也渴望能够扮演这个角色，但是拯救世界这个事儿对我们来说太他妈难了，所以我们只能自私地保护自己重要的人；可是，最后一刻，老头留下来了，因为这里有他的逆鳞了，这很好，符合我们的价值观。</p>\n<p>最终，这一切都是一个梦，最起码是在路明非的世界，甚至路明非本身就是一个梦，一个提线木偶，一个，孤独又带点悲伤的角色，让人心疼。虽然这个小说也有瑕疵，就好像我不太喜欢第二部，但是不会妨碍我对这个小说的赞赏。</p>\n<p>所以，江南，我喜欢这个作者。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>大概是多久了，没有在看完一本书之后写写读后感了；看书就行吃面包，饿的时候觉得特别美味，吃饱了也就炮诸脑后。</p>\n<p>今年一直都挺忙碌地，正好伴着腿伤在家里休息半个月，于是，一股脑地把《龙族》三部曲看完了，这是一部很好的书，我喜欢，很多人可能会觉得这是一个讲神秘、冒险、还有魔幻的小说，这里面有很多牛逼的任务，牛逼到打个喷嚏就能在太平洋引起一场海啸；可是，在我看来，这是一个看起来有点悲伤的故事。</p>\n<p>有个叫路明非的Loser主角，他身边有很多牛逼的朋友，可是这些都和他没有关系，没有理想，没有原则，没有底线，好像这个世界硬一点，他就缩一点，懦弱、犹豫、像个傻逼，虽然整本书的人都在帮他，可是这不是他想要的，刚开始看的时候，一直想主角什么时候牛逼起来啊，作者怎么不按套路出牌啊，后来，我开始不想让他牛逼，他要是一直懦弱下去该多好啊，这样，看着像真实地我们，这样，至少可以好好活下去；是啊，作为一个力挽狂澜的弑龙者多牛逼啊，像所有牛逼的角色，可这都是拿命换来的啊，“人是自私的生物，但是却愿意有那么一瞬间为了很少的人放弃一切甚至生命。”说的多好，听的人是那么的心疼；人的一生中总归有几个人是我们的逆鳞，我们希望她好胜过自己好，我们希望把所有一切都给她甚至生命，可是，那又怎样，那又怎样呢?</p>\n<p>另一个我很喜欢的人物，上杉越，一个隐世的牛逼老头子，在龙王复苏，整个东京城都要毁灭的时候，他选择了怯懦的逃离，很没骨气啊，可谁明白他呢，他是一个没有逆鳞的人了，活着只有自己，的确，我们都喜欢孤胆英雄式的角色，我们也渴望能够扮演这个角色，但是拯救世界这个事儿对我们来说太他妈难了，所以我们只能自私地保护自己重要的人；可是，最后一刻，老头留下来了，因为这里有他的逆鳞了，这很好，符合我们的价值观。</p>\n<p>最终，这一切都是一个梦，最起码是在路明非的世界，甚至路明非本身就是一个梦，一个提线木偶，一个，孤独又带点悲伤的角色，让人心疼。虽然这个小说也有瑕疵，就好像我不太喜欢第二部，但是不会妨碍我对这个小说的赞赏。</p>\n<p>所以，江南，我喜欢这个作者。</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cj1wytq3z000041tpfpu837nf","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytq5m000d41tp61fzpuz8"},{"post_id":"cj1wytq4k000241tp30wk8l03","category_id":"cj1wytq5i000941tptr9o9fki","_id":"cj1wytq65000k41tpi3rhh6z8"},{"post_id":"cj1wytq57000641tpiyd1f559","category_id":"cj1wytq5i000941tptr9o9fki","_id":"cj1wytq6d000q41tp96gd7iuv"},{"post_id":"cj1wytq5a000741tpiirppxgx","category_id":"cj1wytq5i000941tptr9o9fki","_id":"cj1wytq6l000w41tp7d9s8ck6"},{"post_id":"cj1wytq5e000841tpz1smgvgk","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq6r001241tpsdbxg6zo"},{"post_id":"cj1wytq6i000v41tp37oj9v5n","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytq6z001741tp77ba2usm"},{"post_id":"cj1wytq6n000z41tpo9xokckp","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytq73001a41tpw5juadl4"},{"post_id":"cj1wytq5n000e41tpig0mm3bl","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq76001f41tp19lx89n3"},{"post_id":"cj1wytq6y001641tpjlr4ultm","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq79001i41tp9c1y55q6"},{"post_id":"cj1wytq60000h41tpymvy98fx","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq7d001m41tpqjv9dv7v"},{"post_id":"cj1wytq63000j41tpeae7ixc2","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq7f001p41tpcjl9xi2v"},{"post_id":"cj1wytq78001h41tp2o505z5g","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq7k001s41tpqce0hlac"},{"post_id":"cj1wytq6a000n41tpdgmr07dy","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq7n001w41tpc68ypbds"},{"post_id":"cj1wytq7g001r41tpxr4ow1gf","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq7t002041tpg628bh7e"},{"post_id":"cj1wytq6c000p41tposkfrl02","category_id":"cj1wytq7f001q41tpwf64piys","_id":"cj1wytq7v002341tp14px9419"},{"post_id":"cj1wytq7u002141tpx3ngt7nl","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq82002941tp9fnnzp71"},{"post_id":"cj1wytq6g000t41tp3es8xczr","category_id":"cj1wytq7o001x41tp8lk7qvvi","_id":"cj1wytq84002c41tpxg861u0m"},{"post_id":"cj1wytq7w002441tp9t58e6hc","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq86002f41tpxbpaxd4y"},{"post_id":"cj1wytq6p001141tpsctduonw","category_id":"cj1wytq7o001x41tp8lk7qvvi","_id":"cj1wytq8d002j41tpx9ym8xij"},{"post_id":"cj1wytq71001941tp7h7zlszq","category_id":"cj1wytq83002b41tpb3k5n5ci","_id":"cj1wytq8r002n41tpb0x89rdc"},{"post_id":"cj1wytq86002h41tp67t1zrv4","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytq8z002r41tpu0aew3v0"},{"post_id":"cj1wytq75001d41tpxctajc9f","category_id":"cj1wytq7f001q41tpwf64piys","_id":"cj1wytq91002u41tpl43r9uwq"},{"post_id":"cj1wytq8s002q41tp8f2e4zvn","category_id":"cj1wytq7o001x41tp8lk7qvvi","_id":"cj1wytq9a003041tpywumxfgv"},{"post_id":"cj1wytq7b001k41tpw8oyc739","category_id":"cj1wytq8r002p41tp52ezwcl0","_id":"cj1wytq9e003341tpy79ciftx"},{"post_id":"cj1wytq7e001o41tpel8jujny","category_id":"cj1wytq94002w41tpoj52axx6","_id":"cj1wytq9l003941tpbk6bj4hk"},{"post_id":"cj1wytq9j003741tpfdv5rb94","category_id":"cj1wytq5i000941tptr9o9fki","_id":"cj1wytq9r003f41tp5mzn1u3h"},{"post_id":"cj1wytq7m001u41tpba8qjofg","category_id":"cj1wytq9e003441tphxisxvtr","_id":"cj1wytq9t003j41tpckcvnlrk"},{"post_id":"cj1wytq9p003e41tpzonnx3wv","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytq9y003n41tppx9f2hw5"},{"post_id":"cj1wytq7q001y41tp452sfdmo","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqa0003r41tpwa1inn49"},{"post_id":"cj1wytq9r003h41tp4jfhc9he","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytqa5003v41tp3u721e4n"},{"post_id":"cj1wytq9t003k41tpjv4j888t","category_id":"cj1wytq7o001x41tp8lk7qvvi","_id":"cj1wytqaa003y41tpu1v877qk"},{"post_id":"cj1wytq7y002741tpi1lzi4n4","category_id":"cj1wytq9s003i41tp5qs784k7","_id":"cj1wytqae004341tptf68wwcd"},{"post_id":"cj1wytq9y003o41tpszfd9zs3","category_id":"cj1wytq7f001q41tpwf64piys","_id":"cj1wytqag004641tp0ip1c8nh"},{"post_id":"cj1wytqa1003s41tp1vuactuw","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytqal004a41tpourqqz5w"},{"post_id":"cj1wytq82002a41tpbwaykvob","category_id":"cj1wytqa0003p41tp7pz5zjgq","_id":"cj1wytqap004e41tpo09403g3"},{"post_id":"cj1wytqab004041tpt7i02c17","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqat004h41tpyr46arzv"},{"post_id":"cj1wytq84002d41tp7ulnkkav","category_id":"cj1wytqa0003p41tp7pz5zjgq","_id":"cj1wytqax004k41tpfedf480m"},{"post_id":"cj1wytqae004441tpd20sjy9i","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytqaz004o41tptc8e530z"},{"post_id":"cj1wytq8e002k41tp0mxkvfpw","category_id":"cj1wytqai004741tpcgmpihtz","_id":"cj1wytqb2004r41tprsqaz82y"},{"post_id":"cj1wytq8l002m41tpjidzd0x4","category_id":"cj1wytqar004g41tpfeu01ooz","_id":"cj1wytqb4004v41tpofl4l4if"},{"post_id":"cj1wytq90002t41tpw0ceisfs","category_id":"cj1wytqai004741tpcgmpihtz","_id":"cj1wytqb8004z41tp3xut0yit"},{"post_id":"cj1wytqb4004w41tpt595zb4x","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqbb005441tpzvxr2smh"},{"post_id":"cj1wytq98002x41tp8b41zf9b","category_id":"cj1wytqai004741tpcgmpihtz","_id":"cj1wytqbd005941tptdicicud"},{"post_id":"cj1wytqb7004y41tptgm60y8o","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqbg005c41tpdtgdmxf0"},{"post_id":"cj1wytqb9005241tpa1zk9l8l","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqbm005h41tp3qvd4dmu"},{"post_id":"cj1wytq9b003141tp4sn1jt1f","category_id":"cj1wytqb8005041tpkltmckl2","_id":"cj1wytqbo005k41tpnozp2ve5"},{"post_id":"cj1wytqbb005641tpf9wxhcgz","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqby005o41tpr5vu309j"},{"post_id":"cj1wytqbe005a41tpl4u1tg6w","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqc1005s41tpwo15i050"},{"post_id":"cj1wytq9l003a41tplki8berm","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqc7005w41tpyhx0ru4h"},{"post_id":"cj1wytqbg005d41tprzi7ffn6","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqc9006041tpfy58lcji"},{"post_id":"cj1wytqbm005i41tp14ebcmne","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqcc006341tphlgemrum"},{"post_id":"cj1wytqa6003w41tp2mulh1k5","category_id":"cj1wytqbl005g41tp6tiy612b","_id":"cj1wytqci006841tpk14iqvem"},{"post_id":"cj1wytqbz005q41tpm0vm4m30","category_id":"cj1wytqa0003p41tp7pz5zjgq","_id":"cj1wytqck006b41tpxfkuzmnf"},{"post_id":"cj1wytqaj004841tpu6cf03g5","category_id":"cj1wytqar004g41tpfeu01ooz","_id":"cj1wytqcn006g41tpnnksiuzv"},{"post_id":"cj1wytqca006141tp2wmamoru","category_id":"cj1wytqar004g41tpfeu01ooz","_id":"cj1wytqcq006j41tp663d1ucy"},{"post_id":"cj1wytqal004c41tp6f8ldkpg","category_id":"cj1wytqc7005x41tp4g4d7evh","_id":"cj1wytqct006o41tpstacaw1g"},{"post_id":"cj1wytqcd006541tpacvj7ebz","category_id":"cj1wytqar004g41tpfeu01ooz","_id":"cj1wytqcw006r41tp5elirfne"},{"post_id":"cj1wytqci006941tpcg7n4dw9","category_id":"cj1wytqar004g41tpfeu01ooz","_id":"cj1wytqd0006w41tpqq3q7fg7"},{"post_id":"cj1wytqaq004f41tp4e4i4xk4","category_id":"cj1wytqc7005x41tp4g4d7evh","_id":"cj1wytqd4006z41tp75afz3go"},{"post_id":"cj1wytqcl006c41tp9e8phryp","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqd9007441tpe6ytbtvk"},{"post_id":"cj1wytqco006h41tppdl2qmre","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytqdd007741tp698os2zl"},{"post_id":"cj1wytqat004i41tp8qivpnns","category_id":"cj1wytqcm006d41tpdicz01s3","_id":"cj1wytqdg007c41tpbk25bg9m"},{"post_id":"cj1wytqax004m41tpuxcydbe5","category_id":"cj1wytqcm006d41tpdicz01s3","_id":"cj1wytqdj007f41tp7xty0t1b"},{"post_id":"cj1wytqcw006s41tpxkdd098g","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqdl007j41tpqtl198fa"},{"post_id":"cj1wytqd0006x41tpft5vfwyb","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqdo007n41tp2k84aauu"},{"post_id":"cj1wytqb0004p41tpo7pq8qat","category_id":"cj1wytqcm006d41tpdicz01s3","_id":"cj1wytqdr007q41tpiz2cccz4"},{"post_id":"cj1wytqd4007041tpl5mv8dst","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqdu007v41tplnyq2ldy"},{"post_id":"cj1wytqda007541tp5ut57o2i","category_id":"cj1wytq8r002p41tp52ezwcl0","_id":"cj1wytqdw007y41tpd67ru966"},{"post_id":"cj1wytqb2004s41tpkak5nn71","category_id":"cj1wytqd8007141tp3eiiv8lt","_id":"cj1wytqe0008341tpe1els0di"},{"post_id":"cj1wytqde007841tp3kuny36y","category_id":"cj1wytqc7005x41tp4g4d7evh","_id":"cj1wytqe3008641tphsr1v98u"},{"post_id":"cj1wytqdh007d41tpax2lmy6k","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqed008a41tp19ieqb06"},{"post_id":"cj1wytqbp005l41tpvbshcns0","category_id":"cj1wytqdg007b41tpkbxvzy09","_id":"cj1wytqeg008d41tp763c8nxm"},{"post_id":"cj1wytqdj007g41tpqt4b91jb","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqei008h41tpupmquuh9"},{"post_id":"cj1wytqdm007l41tp81mfbpf1","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqek008k41tph1pt1702"},{"post_id":"cj1wytqc1005t41tpvfibafgw","category_id":"cj1wytqc7005x41tp4g4d7evh","_id":"cj1wytqem008o41tparhy40b3"},{"post_id":"cj1wytqds007t41tp90x3r0i5","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytqeo008r41tptbmrl3vi"},{"post_id":"cj1wytqc8005y41tpbysd2ehk","category_id":"cj1wytqd8007141tp3eiiv8lt","_id":"cj1wytqer008v41tpxhxzn7vs"},{"post_id":"cj1wytqdu007w41tpirfe84z9","category_id":"cj1wytq7o001x41tp8lk7qvvi","_id":"cj1wytqet008y41tphtgj5mfb"},{"post_id":"cj1wytqdx008141tpobqskevg","category_id":"cj1wytq6f000r41tph2u68u76","_id":"cj1wytqev009241tp8zs62my6"},{"post_id":"cj1wytqe0008441tp53u7jcri","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqex009541tprxdfpcqc"},{"post_id":"cj1wytqdp007o41tpzzz2063d","category_id":"cj1wytqdw007z41tpwc33042h","_id":"cj1wytqf4009941tphmvo4b7w"},{"post_id":"cj1wytqea008741tpqmd30jsf","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqf6009c41tpnv8v2lg6"},{"post_id":"cj1wytqee008b41tp4fcpqz6h","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqf8009g41tp3bu3esj4"},{"post_id":"cj1wytqeg008e41tpxe8lvg3i","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfb009j41tpi2mzbto2"},{"post_id":"cj1wytqei008i41tp0sm5w04m","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfd009m41tp6i44afdo"},{"post_id":"cj1wytqek008l41tpvuccnntz","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqff009q41tppekwc647"},{"post_id":"cj1wytqen008p41tpszd68cdx","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfg009s41tp71ks6685"},{"post_id":"cj1wytqeo008s41tpyfwlhajh","category_id":"cj1wytq9m003b41tpbl9xr3o9","_id":"cj1wytqfh009v41tpzab15xto"},{"post_id":"cj1wytqer008w41tpqgdxq9bu","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfh009x41tpeo2zvh76"},{"post_id":"cj1wytqet008z41tp0c6wrjp6","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfi00a041tpay4z3iyf"},{"post_id":"cj1wytqev009341tp9qox72ay","category_id":"cj1wytqc7005x41tp4g4d7evh","_id":"cj1wytqfi00a241tp3vqh7exf"},{"post_id":"cj1wytqf0009641tpgi1jz7ff","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfj00a541tpqk0gzs6k"},{"post_id":"cj1wytqf4009a41tpmgyi83yt","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfj00a741tprrcbr2jn"},{"post_id":"cj1wytqf6009d41tp9ortuqe3","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfk00aa41tpumbxuehb"},{"post_id":"cj1wytqf8009h41tpu1trxp6m","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfk00ac41tpjz5jja68"},{"post_id":"cj1wytqfb009k41tpub0xzmqo","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfl00af41tpa10ikgj5"},{"post_id":"cj1wytqfd009o41tp5gpchs5y","category_id":"cj1wytq4v000441tp944hcujk","_id":"cj1wytqfl00ah41tphjtf1y6m"}],"PostTag":[{"post_id":"cj1wytq3z000041tpfpu837nf","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytq5j000b41tpxmcv6zfw"},{"post_id":"cj1wytq4k000241tp30wk8l03","tag_id":"cj1wytq5i000a41tp68d3l5z2","_id":"cj1wytq61000i41tpu49nla00"},{"post_id":"cj1wytq57000641tpiyd1f559","tag_id":"cj1wytq5i000a41tp68d3l5z2","_id":"cj1wytq6b000o41tpthqly637"},{"post_id":"cj1wytq5a000741tpiirppxgx","tag_id":"cj1wytq5i000a41tp68d3l5z2","_id":"cj1wytq6h000u41tp4bkw76r1"},{"post_id":"cj1wytq5e000841tpz1smgvgk","tag_id":"cj1wytq6f000s41tpywngb1nb","_id":"cj1wytq6o001041tp041p3140"},{"post_id":"cj1wytq6i000v41tp37oj9v5n","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytq6r001341tp2y5ylmtw"},{"post_id":"cj1wytq6n000z41tpo9xokckp","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytq70001841tp7hh4vysy"},{"post_id":"cj1wytq5k000c41tpxy5eus3h","tag_id":"cj1wytq6m000y41tpzkj63igu","_id":"cj1wytq73001b41tptbpuy78o"},{"post_id":"cj1wytq5n000e41tpig0mm3bl","tag_id":"cj1wytq6w001541tpj97vtw47","_id":"cj1wytq77001g41tp207qyjun"},{"post_id":"cj1wytq60000h41tpymvy98fx","tag_id":"cj1wytq6w001541tpj97vtw47","_id":"cj1wytq7d001n41tp7ri7rupv"},{"post_id":"cj1wytq63000j41tpeae7ixc2","tag_id":"cj1wytq7c001l41tpm4k0jfd9","_id":"cj1wytq7n001v41tpecf4xfxv"},{"post_id":"cj1wytq6a000n41tpdgmr07dy","tag_id":"cj1wytq7k001t41tprv6nd1qx","_id":"cj1wytq7v002241tp1emolk9e"},{"post_id":"cj1wytq6c000p41tposkfrl02","tag_id":"cj1wytq7t001z41tpqwr5xyob","_id":"cj1wytq81002841tp5lv2wut9"},{"post_id":"cj1wytq6g000t41tp3es8xczr","tag_id":"cj1wytq7y002641tp1umlvgxh","_id":"cj1wytq86002g41tpfdw43cno"},{"post_id":"cj1wytq6p001141tpsctduonw","tag_id":"cj1wytq85002e41tpxz66drx5","_id":"cj1wytq8r002o41tpz281mwa7"},{"post_id":"cj1wytq6y001641tpjlr4ultm","tag_id":"cj1wytq6w001541tpj97vtw47","_id":"cj1wytq91002v41tpt98x0g07"},{"post_id":"cj1wytq8s002q41tp8f2e4zvn","tag_id":"cj1wytq85002e41tpxz66drx5","_id":"cj1wytq9a002y41tpi55nfi88"},{"post_id":"cj1wytq71001941tp7h7zlszq","tag_id":"cj1wytq8z002s41tpuy864fnb","_id":"cj1wytq9e003241tpg92lbb2b"},{"post_id":"cj1wytq75001d41tpxctajc9f","tag_id":"cj1wytq7t001z41tpqwr5xyob","_id":"cj1wytq9l003841tpk6yfk8iw"},{"post_id":"cj1wytq9j003741tpfdv5rb94","tag_id":"cj1wytq5i000a41tp68d3l5z2","_id":"cj1wytq9o003c41tpcnaybaha"},{"post_id":"cj1wytq78001h41tp2o505z5g","tag_id":"cj1wytq9j003641tpzi72l6sd","_id":"cj1wytq9r003g41tpqktc9rpn"},{"post_id":"cj1wytq9r003h41tp4jfhc9he","tag_id":"cj1wytq6w001541tpj97vtw47","_id":"cj1wytq9v003m41tpggl9m97i"},{"post_id":"cj1wytq7b001k41tpw8oyc739","tag_id":"cj1wytq9o003d41tp0i5xce8q","_id":"cj1wytqa0003q41tp53rs3evi"},{"post_id":"cj1wytq9t003k41tpjv4j888t","tag_id":"cj1wytq7y002641tp1umlvgxh","_id":"cj1wytqa4003u41tp5cqtv704"},{"post_id":"cj1wytq9y003o41tpszfd9zs3","tag_id":"cj1wytq7t001z41tpqwr5xyob","_id":"cj1wytqaa003x41tpnjem8ktn"},{"post_id":"cj1wytq7e001o41tpel8jujny","tag_id":"cj1wytq9u003l41tp3s2eu346","_id":"cj1wytqae004241tpy2ci22zn"},{"post_id":"cj1wytqa6003w41tp2mulh1k5","tag_id":"cj1wytq6f000s41tpywngb1nb","_id":"cj1wytqag004541tpoldqua7a"},{"post_id":"cj1wytq7g001r41tpxr4ow1gf","tag_id":"cj1wytqa4003t41tp0nwti8qu","_id":"cj1wytqak004941tpzf9zjyqe"},{"post_id":"cj1wytq7m001u41tpba8qjofg","tag_id":"cj1wytqad004141tp5a1ns9ls","_id":"cj1wytqap004d41tpf1cvyz6l"},{"post_id":"cj1wytq7q001y41tp452sfdmo","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqax004l41tpzpg0pokr"},{"post_id":"cj1wytq7u002141tpx3ngt7nl","tag_id":"cj1wytqau004j41tprea15mvm","_id":"cj1wytqb3004t41tpm9rag2v2"},{"post_id":"cj1wytq7w002441tp9t58e6hc","tag_id":"cj1wytqb1004q41tprf4svil6","_id":"cj1wytqb8005141tpi7msnztz"},{"post_id":"cj1wytqb4004w41tpt595zb4x","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqba005341tpmtewr7hb"},{"post_id":"cj1wytqb7004y41tptgm60y8o","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqbd005741tpd5kbae00"},{"post_id":"cj1wytq7y002741tpi1lzi4n4","tag_id":"cj1wytqb6004x41tpmxbvu3zi","_id":"cj1wytqbf005b41tprq0yn5c7"},{"post_id":"cj1wytqb9005241tpa1zk9l8l","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqbl005f41tp5kncsmha"},{"post_id":"cj1wytqbb005641tpf9wxhcgz","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqbo005j41tpzv570ohw"},{"post_id":"cj1wytqbe005a41tpl4u1tg6w","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqby005n41tp4jr8p2o0"},{"post_id":"cj1wytq82002a41tpbwaykvob","tag_id":"cj1wytqbb005541tpyca4ybuq","_id":"cj1wytqc0005r41tpz7xxzrtd"},{"post_id":"cj1wytqbg005d41tprzi7ffn6","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqc4005u41tpw0np069n"},{"post_id":"cj1wytqbm005i41tp14ebcmne","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqc9005z41tpxwqjlq20"},{"post_id":"cj1wytq84002d41tp7ulnkkav","tag_id":"cj1wytqbh005e41tpiomgwvcl","_id":"cj1wytqcc006241tpw0jhph7c"},{"post_id":"cj1wytqbz005q41tpm0vm4m30","tag_id":"cj1wytqbb005541tpyca4ybuq","_id":"cj1wytqch006741tp6wf2y4jm"},{"post_id":"cj1wytq86002h41tp67t1zrv4","tag_id":"cj1wytqby005m41tp6fdocvwu","_id":"cj1wytqck006a41tp7t6q3h8j"},{"post_id":"cj1wytq8e002k41tp0mxkvfpw","tag_id":"cj1wytqc7005v41tphmp06fuj","_id":"cj1wytqcn006f41tpm6ka9tdt"},{"post_id":"cj1wytqci006941tpcg7n4dw9","tag_id":"cj1wytqcc006441tpxbk5cdty","_id":"cj1wytqcp006i41tpwohpovsu"},{"post_id":"cj1wytq8l002m41tpjidzd0x4","tag_id":"cj1wytqcc006441tpxbk5cdty","_id":"cj1wytqct006n41tphn9pyi7t"},{"post_id":"cj1wytqcl006c41tp9e8phryp","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqcv006q41tpk902it4d"},{"post_id":"cj1wytqco006h41tppdl2qmre","tag_id":"cj1wytq6f000s41tpywngb1nb","_id":"cj1wytqcz006v41tp55qqlxxa"},{"post_id":"cj1wytq90002t41tpw0ceisfs","tag_id":"cj1wytqc7005v41tphmp06fuj","_id":"cj1wytqd4006y41tpty9hecu2"},{"post_id":"cj1wytqcu006p41tplbyunnkl","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqd9007341tpwoy1d1hv"},{"post_id":"cj1wytq98002x41tp8b41zf9b","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqdd007641tpz6wvmlhs"},{"post_id":"cj1wytqcw006s41tpxkdd098g","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqdg007a41tpt49pq5v6"},{"post_id":"cj1wytqd0006x41tpft5vfwyb","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqdi007e41tp72rrspyz"},{"post_id":"cj1wytq9b003141tp4sn1jt1f","tag_id":"cj1wytqcy006t41tpziyxfzl6","_id":"cj1wytqdl007h41tpyv9t037f"},{"post_id":"cj1wytqd4007041tpl5mv8dst","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqdo007m41tpxxge7c2s"},{"post_id":"cj1wytq9l003a41tplki8berm","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqdq007p41tpj4dylhj3"},{"post_id":"cj1wytqdh007d41tpax2lmy6k","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqdu007u41tpvbbn6lec"},{"post_id":"cj1wytq9p003e41tpzonnx3wv","tag_id":"cj1wytqdg007941tpuqvqm3f0","_id":"cj1wytqdw007x41tpq12lrpzy"},{"post_id":"cj1wytqdj007g41tpqt4b91jb","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqdz008241tpn6er2ans"},{"post_id":"cj1wytqdm007l41tp81mfbpf1","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqe3008541tpma0yuxrh"},{"post_id":"cj1wytqa1003s41tp1vuactuw","tag_id":"cj1wytqdl007i41tpw4jqp3i2","_id":"cj1wytqed008941tpihezrilt"},{"post_id":"cj1wytqds007t41tp90x3r0i5","tag_id":"cj1wytqdl007i41tpw4jqp3i2","_id":"cj1wytqef008c41tps3sh5o32"},{"post_id":"cj1wytqab004041tpt7i02c17","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqei008g41tp44jfhrn6"},{"post_id":"cj1wytqdu007w41tpirfe84z9","tag_id":"cj1wytq7y002641tp1umlvgxh","_id":"cj1wytqek008j41tp03dlg7l7"},{"post_id":"cj1wytqdx008141tpobqskevg","tag_id":"cj1wytq6w001541tpj97vtw47","_id":"cj1wytqem008n41tp1jw0dqad"},{"post_id":"cj1wytqe0008441tp53u7jcri","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqeo008q41tpi1i08p8k"},{"post_id":"cj1wytqae004441tpd20sjy9i","tag_id":"cj1wytqdw008041tp4y0ibfhj","_id":"cj1wytqeq008u41tpa3t85xjl"},{"post_id":"cj1wytqea008741tpqmd30jsf","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqet008x41tpix6mktv8"},{"post_id":"cj1wytqee008b41tp4fcpqz6h","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqev009041tpvlrsids2"},{"post_id":"cj1wytqaj004841tpu6cf03g5","tag_id":"cj1wytqcc006441tpxbk5cdty","_id":"cj1wytqex009441tp0ucrgczv"},{"post_id":"cj1wytqeg008e41tpxe8lvg3i","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqf3009741tpcv82hn29"},{"post_id":"cj1wytqei008i41tp0sm5w04m","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqf6009b41tpdnjwy4d7"},{"post_id":"cj1wytqal004c41tp6f8ldkpg","tag_id":"cj1wytqeh008f41tpw5qf7v1b","_id":"cj1wytqf8009e41tp7l13jnye"},{"post_id":"cj1wytqek008l41tpvuccnntz","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfa009i41tpdr9luhza"},{"post_id":"cj1wytqen008p41tpszd68cdx","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfd009l41tpbqz37i9n"},{"post_id":"cj1wytqaq004f41tp4e4i4xk4","tag_id":"cj1wytqeh008f41tpw5qf7v1b","_id":"cj1wytqff009p41tpc1d8ngif"},{"post_id":"cj1wytqeo008s41tpyfwlhajh","tag_id":"cj1wytqal004b41tp5hz3g0zx","_id":"cj1wytqfg009r41tp6js2rf0g"},{"post_id":"cj1wytqer008w41tpqgdxq9bu","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfh009u41tpdujv8u8v"},{"post_id":"cj1wytqat004i41tp8qivpnns","tag_id":"cj1wytqeq008t41tpnrp8lki9","_id":"cj1wytqfh009w41tpyl621dha"},{"post_id":"cj1wytqet008z41tp0c6wrjp6","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfi009z41tp27bz9dy8"},{"post_id":"cj1wytqev009341tp9qox72ay","tag_id":"cj1wytqeh008f41tpw5qf7v1b","_id":"cj1wytqfi00a141tp2srfly0t"},{"post_id":"cj1wytqax004m41tpuxcydbe5","tag_id":"cj1wytqeq008t41tpnrp8lki9","_id":"cj1wytqfj00a441tpglje6kox"},{"post_id":"cj1wytqf0009641tpgi1jz7ff","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfj00a641tpor1llivg"},{"post_id":"cj1wytqf4009a41tpmgyi83yt","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfk00a941tpnse8t4d5"},{"post_id":"cj1wytqb0004p41tpo7pq8qat","tag_id":"cj1wytqeq008t41tpnrp8lki9","_id":"cj1wytqfk00ab41tp1li29tp4"},{"post_id":"cj1wytqf6009d41tp9ortuqe3","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfl00ae41tpiima0lk6"},{"post_id":"cj1wytqf8009h41tpu1trxp6m","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfl00ag41tp3f1n3hj2"},{"post_id":"cj1wytqb2004s41tpkak5nn71","tag_id":"cj1wytqf8009f41tponqtgi06","_id":"cj1wytqfm00aj41tp0z19yy3p"},{"post_id":"cj1wytqfb009k41tpub0xzmqo","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfp00ak41tp8w7faged"},{"post_id":"cj1wytqfd009o41tp5gpchs5y","tag_id":"cj1wytq54000541tp4h1s2rte","_id":"cj1wytqfq00am41tpkfr2amm4"},{"post_id":"cj1wytqbp005l41tpvbshcns0","tag_id":"cj1wytqfd009n41tphb0vlh0h","_id":"cj1wytqfq00an41tpea3bviph"},{"post_id":"cj1wytqc1005t41tpvfibafgw","tag_id":"cj1wytqdl007i41tpw4jqp3i2","_id":"cj1wytqfq00ao41tpcqs96xec"},{"post_id":"cj1wytqc8005y41tpbysd2ehk","tag_id":"cj1wytqf8009f41tponqtgi06","_id":"cj1wytqfr00ap41tppr5228dq"},{"post_id":"cj1wytqca006141tp2wmamoru","tag_id":"cj1wytqcc006441tpxbk5cdty","_id":"cj1wytqfr00aq41tpick0hnkz"},{"post_id":"cj1wytqcd006541tpacvj7ebz","tag_id":"cj1wytqcc006441tpxbk5cdty","_id":"cj1wytqfr00ar41tpgvk9v4hd"},{"post_id":"cj1wytqda007541tp5ut57o2i","tag_id":"cj1wytqfk00ad41tpc3rvipb6","_id":"cj1wytqfr00as41tpskmau0rp"},{"post_id":"cj1wytqde007841tp3kuny36y","tag_id":"cj1wytqdl007i41tpw4jqp3i2","_id":"cj1wytqfr00at41tp11s2d0cu"},{"post_id":"cj1wytqdp007o41tpzzz2063d","tag_id":"cj1wytqfq00al41tp0rcssk04","_id":"cj1wytqfr00au41tpkzx09fdp"}],"Tag":[{"name":"我给你讲个故事吧","_id":"cj1wytq54000541tp4h1s2rte"},{"name":"Azure","_id":"cj1wytq5i000a41tp68d3l5z2"},{"name":"Yum","_id":"cj1wytq6f000s41tpywngb1nb"},{"name":" - CentOS 6 - Linux - CentOS","_id":"cj1wytq6m000y41tpzkj63igu"},{"name":"CentOS","_id":"cj1wytq6w001541tpj97vtw47"},{"name":"LVM","_id":"cj1wytq7c001l41tpm4k0jfd9"},{"name":"DenyHosts","_id":"cj1wytq7k001t41tprv6nd1qx"},{"name":"Docker","_id":"cj1wytq7t001z41tpqwr5xyob"},{"name":"Ghost","_id":"cj1wytq7y002641tp1umlvgxh"},{"name":"Piwik","_id":"cj1wytq85002e41tpxz66drx5"},{"name":"CloudStack","_id":"cj1wytq8z002s41tpuy864fnb"},{"name":"Fabric","_id":"cj1wytq9j003641tpzi72l6sd"},{"name":"Gitlab","_id":"cj1wytq9o003d41tp0i5xce8q"},{"name":"KVM","_id":"cj1wytq9u003l41tp3s2eu346"},{"name":"LNMP","_id":"cj1wytqa4003t41tp0nwti8qu"},{"name":"MongoDB","_id":"cj1wytqad004141tp5a1ns9ls"},{"name":"MySQL","_id":"cj1wytqal004b41tp5hz3g0zx"},{"name":"NextCloud","_id":"cj1wytqau004j41tprea15mvm"},{"name":"Openfire","_id":"cj1wytqb1004q41tprf4svil6"},{"name":"PostgreSQL","_id":"cj1wytqb6004x41tpmxbvu3zi"},{"name":"Python","_id":"cj1wytqbb005541tpyca4ybuq"},{"name":"Python3","_id":"cj1wytqbh005e41tpiomgwvcl"},{"name":"Redmine","_id":"cj1wytqby005m41tp6fdocvwu"},{"name":"Zabbix","_id":"cj1wytqc7005v41tphmp06fuj"},{"name":"Tomcat","_id":"cj1wytqcc006441tpxbk5cdty"},{"name":"AliCloud","_id":"cj1wytqcy006t41tpziyxfzl6"},{"name":"MariaDB","_id":"cj1wytqdg007941tpuqvqm3f0"},{"name":"SSH","_id":"cj1wytqdl007i41tpw4jqp3i2"},{"name":"Zoomdata","_id":"cj1wytqdw008041tp4y0ibfhj"},{"name":"Linux","_id":"cj1wytqeh008f41tpw5qf7v1b"},{"name":"Mac","_id":"cj1wytqeq008t41tpnrp8lki9"},{"name":"Shell-Scripts","_id":"cj1wytqf8009f41tponqtgi06"},{"name":" - OpenStack","_id":"cj1wytqfd009n41tphb0vlh0h"},{"name":"Git","_id":"cj1wytqfk00ad41tpc3rvipb6"},{"name":"魔方","_id":"cj1wytqfq00al41tp0rcssk04"}]}}